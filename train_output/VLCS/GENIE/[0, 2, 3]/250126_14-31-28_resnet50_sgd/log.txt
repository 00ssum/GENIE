[37m[36mINFO[0m[0m 01/26 14:31:28 | Command :: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm gsnr1224 --test_envs 0 2 3 --dataset VLCS --trial_seed 2 --hparams_seed 5
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: gsnr1224
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 5
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/VLCS/gsnr1224/[0, 2, 3]/250126_14-31-28_resnet50_sgd
	out_root: train_output/VLCS/gsnr1224/[0, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 2, 3]
	trial_seed: 2
	unique_name: 250126_14-31-28_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 0.0002982828768978312
	batch_size: 9
	weight_decay: 0.0003180957897867641
	momentum: 0.8904627167531411
	convergence_rate: 0.00346423000837165
	moving_avg: 0.9394248867967866
	p: 0.7427011929432814
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 01/26 14:31:28 | n_steps = 5001
[37m[36mINFO[0m[0m 01/26 14:31:28 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/26 14:31:28 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/26 14:31:28 | 
[37m[36mINFO[0m[0m 01/26 14:31:28 | Testenv name escaping te_C_S_V -> te_C_S_V
[37m[36mINFO[0m[0m 01/26 14:31:28 | Test envs = [0, 2, 3], name = te_C_S_V
[37m[36mINFO[0m[0m 01/26 14:31:28 | Train environments: [1], Test environments: [0, 2, 3]
[37m[36mINFO[0m[0m 01/26 14:31:28 | Batch sizes for each domain: [0, 9, 0, 0] (total=9)
[37m[36mINFO[0m[0m 01/26 14:31:28 | steps-per-epoch for each domain: 236.11 -> min = 236.11
[37m[36mINFO[0m[0m 01/26 14:31:29 | # of params = 23518277
[37m[36mINFO[0m[0m 01/26 14:33:35 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/26 14:33:35 | 0.176375    0.175722    0.496941    0.442561    1.303163    0.041519    0.024735    0.496941    0.442561    0.306931    0.323171    0.180674    0.179259    0           0.000000    1.905353    1.223100    125.209074 
[37m[36mINFO[0m[0m 01/26 14:36:54 | 0.571270    0.560301    0.713412    0.717514    0.687557    0.688163    0.671378    0.713412    0.717514    0.470297    0.443598    0.555350    0.565926    200         0.847059    0.818661    0.340527    129.839283 
[37m[36mINFO[0m[0m 01/26 14:40:02 | 0.644361    0.615626    0.752941    0.730697    0.641349    0.805654    0.759717    0.752941    0.730697    0.495811    0.464939    0.631618    0.622222    400         1.694118    0.723628    0.315702    124.710126 
[37m[36mINFO[0m[0m 01/26 14:43:05 | 0.632085    0.600603    0.783529    0.766478    0.600489    0.779152    0.752650    0.783529    0.766478    0.523991    0.483232    0.593114    0.565926    600         2.541176    0.648704    0.314813    119.985054 
[37m[36mINFO[0m[0m 01/26 14:46:13 | 0.685428    0.653154    0.771294    0.732580    0.613609    0.871025    0.830389    0.771294    0.732580    0.525133    0.480183    0.660126    0.648889    800         3.388235    0.602481    0.328857    122.504202 
[37m[36mINFO[0m[0m 01/26 14:49:22 | 0.686846    0.662655    0.761882    0.730697    0.682302    0.874558    0.833922    0.761882    0.730697    0.511043    0.472561    0.674935    0.681481    1000        4.235294    0.564009    0.329152    122.553527 
[37m[36mINFO[0m[0m 01/26 14:52:32 | 0.742324    0.714897    0.819294    0.764595    0.577016    0.910777    0.862191    0.819294    0.764595    0.600533    0.562500    0.715661    0.720000    1200        5.082353    0.574855    0.322074    125.070329 
[37m[36mINFO[0m[0m 01/26 14:55:40 | 0.742955    0.722614    0.746824    0.709981    0.667853    0.917845    0.876325    0.746824    0.709981    0.600914    0.567073    0.710107    0.724444    1400        5.929412    0.544899    0.321832    124.169315 
[37m[36mINFO[0m[0m 01/26 14:58:51 | 0.751273    0.727084    0.769412    0.745763    0.628838    0.919611    0.879859    0.769412    0.745763    0.635948    0.602134    0.698260    0.699259    1600        6.776471    0.493858    0.327735    124.674428 
[37m[36mINFO[0m[0m 01/26 15:02:01 | 0.734502    0.704736    0.825412    0.768362    0.564210    0.929329    0.876325    0.825412    0.768362    0.594059    0.556402    0.680118    0.681481    1800        7.623529    0.505593    0.320185    126.240104 
[37m[36mINFO[0m[0m 01/26 15:05:20 | 0.702442    0.689612    0.787765    0.749529    0.625412    0.783569    0.777385    0.787765    0.749529    0.646230    0.617378    0.677527    0.674074    2000        8.470588    0.469175    0.340555    131.019572 
[37m[36mINFO[0m[0m 01/26 15:08:43 | 0.721188    0.706193    0.847529    0.783427    0.598173    0.789753    0.763251    0.847529    0.783427    0.648896    0.623476    0.724917    0.731852    2200        9.317647    0.449176    0.349035    133.198796 
[37m[36mINFO[0m[0m 01/26 15:12:08 | 0.741367    0.719081    0.857412    0.783427    0.613310    0.929329    0.890459    0.857412    0.783427    0.575781    0.530488    0.718993    0.736296    2400        10.164706   0.431156    0.358196    132.643940 
[37m[36mINFO[0m[0m 01/26 15:15:44 | 0.765547    0.747870    0.874824    0.787194    0.661846    0.930212    0.893993    0.874824    0.787194    0.649657    0.631098    0.716772    0.718519    2600        11.011765   0.407245    0.364109    143.016420 
[37m[36mINFO[0m[0m 01/26 15:19:31 | 0.754210    0.743682    0.877176    0.783427    0.678665    0.881625    0.886926    0.877176    0.783427    0.667936    0.646341    0.713069    0.697778    2800        11.858824   0.441400    0.383491    150.862195 
[37m[36mINFO[0m[0m 01/26 15:23:15 | 0.718697    0.689183    0.872471    0.783427    0.589854    0.783569    0.734982    0.872471    0.783427    0.682407    0.657012    0.690115    0.675556    3000        12.705882   0.385653    0.387340    146.498257 
[37m[36mINFO[0m[0m 01/26 15:27:00 | 0.735834    0.698685    0.902118    0.766478    0.662456    0.904594    0.855124    0.902118    0.766478    0.615385    0.559451    0.687523    0.681481    3200        13.552941   0.356432    0.385861    147.651439 
[37m[36mINFO[0m[0m 01/26 15:30:46 | 0.745180    0.717980    0.904471    0.781544    0.702552    0.916078    0.872792    0.904471    0.781544    0.598248    0.567073    0.721214    0.714074    3400        14.400000   0.282326    0.381465    149.748734 
[37m[36mINFO[0m[0m 01/26 15:34:23 | 0.725735    0.692340    0.888000    0.760829    0.653638    0.861307    0.802120    0.888000    0.760829    0.629855    0.608232    0.686042    0.666667    3600        15.247059   0.323670    0.374306    142.331404 
[37m[36mINFO[0m[0m 01/26 15:37:48 | 0.740421    0.721188    0.910118    0.774011    0.710509    0.857774    0.819788    0.910118    0.774011    0.637091    0.634146    0.726398    0.709630    3800        16.094118   0.313811    0.356334    133.259295 
[37m[36mINFO[0m[0m 01/26 15:41:11 | 0.723951    0.688627    0.915765    0.775895    0.677514    0.787102    0.742049    0.915765    0.775895    0.656131    0.609756    0.728619    0.714074    4000        16.941176   0.342968    0.343812    134.299562 
[37m[36mINFO[0m[0m 01/26 15:44:37 | 0.736941    0.703648    0.919529    0.755179    0.851203    0.906360    0.851590    0.919529    0.755179    0.618050    0.582317    0.686412    0.677037    4200        17.788235   0.279527    0.355566    134.921745 
[37m[36mINFO[0m[0m 01/26 15:48:03 | 0.675728    0.667009    0.926118    0.770245    0.866155    0.646643    0.671378    0.926118    0.770245    0.677837    0.658537    0.702703    0.671111    4400        18.635294   0.260528    0.345995    137.247932 
[37m[36mINFO[0m[0m 01/26 15:51:30 | 0.488770    0.498380    0.893176    0.713748    0.782721    0.318021    0.360424    0.893176    0.713748    0.607007    0.628049    0.541281    0.506667    4600        19.482353   0.280088    0.349534    136.378544 
[37m[36mINFO[0m[0m 01/26 15:54:57 | 0.713406    0.691786    0.884706    0.760829    1.126255    0.786219    0.763251    0.884706    0.760829    0.642041    0.614329    0.711959    0.697778    4800        20.329412   0.237246    0.343253    138.307977 
[37m[36mINFO[0m[0m 01/26 15:58:19 | 0.688479    0.661873    0.906824    0.747646    0.789557    0.848940    0.826855    0.906824    0.747646    0.570069    0.535061    0.646427    0.623704    5000        21.176471   0.316135    0.349244    132.296187 
[37m[36mINFO[0m[0m 01/26 15:58:19 | Cumulative gradient change saved at train_output/VLCS/gsnr1224/[0, 2, 3]/250126_14-31-28_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/26 15:58:20 | ---
[37m[36mINFO[0m[0m 01/26 15:58:20 | test-domain validation(oracle) = 76.555%
[37m[36mINFO[0m[0m 01/26 15:58:20 | training-domain validation(iid) = 76.555%
[37m[36mINFO[0m[0m 01/26 15:58:20 | last = 68.848%
[37m[36mINFO[0m[0m 01/26 15:58:20 | last (inD) = 74.765%
[37m[36mINFO[0m[0m 01/26 15:58:20 | training-domain validation (iid, inD) = 78.719%
[37m[36mINFO[0m[0m 01/26 15:58:20 | === Summary ===
[37m[36mINFO[0m[0m 01/26 15:58:20 | Command: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm gsnr1224 --test_envs 0 2 3 --dataset VLCS --trial_seed 2 --hparams_seed 5
[37m[36mINFO[0m[0m 01/26 15:58:20 | Unique name: 250126_14-31-28_resnet50_sgd
[37m[36mINFO[0m[0m 01/26 15:58:20 | Out path: train_output/VLCS/gsnr1224/[0, 2, 3]/250126_14-31-28_resnet50_sgd
[37m[36mINFO[0m[0m 01/26 15:58:20 | Algorithm: gsnr1224
[37m[36mINFO[0m[0m 01/26 15:58:20 | Dataset: VLCS

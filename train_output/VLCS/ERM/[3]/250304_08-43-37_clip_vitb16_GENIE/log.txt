[37m[36mINFO[0m[0m 03/04 08:43:37 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 3 --dataset VLCS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/VLCS/ERM/[3]/250304_08-43-37_clip_vitb16_GENIE
	out_root: train_output/VLCS/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250304_08-43-37_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: clip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/04 08:43:37 | n_steps = 5001
[37m[36mINFO[0m[0m 03/04 08:43:37 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/04 08:43:37 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/04 08:43:37 | 
[37m[36mINFO[0m[0m 03/04 08:43:37 | Testenv name escaping te_V -> te_V
[37m[36mINFO[0m[0m 03/04 08:43:37 | Test envs = [3], name = te_V
[37m[36mINFO[0m[0m 03/04 08:43:37 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/04 08:43:37 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 03/04 08:43:37 | steps-per-epoch for each domain: 35.38, 66.41, 82.06 -> min = 35.38
[37m[36mINFO[0m[0m 03/04 08:43:40 | # of params = 86195205
[37m[36mINFO[0m[0m 03/04 08:45:47 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/04 08:45:47 | 0.438726    0.451852    0.487946    0.509769    1.364040    0.602473    0.611307    0.472941    0.521657    0.388423    0.396341    0.438726    0.451852    0           0.000000    1.649576    1.113029    125.857071 
[37m[36mINFO[0m[0m 03/04 08:51:35 | 0.573491    0.574815    0.736004    0.748168    0.640478    0.922261    0.922261    0.673412    0.659134    0.612338    0.663110    0.573491    0.574815    200         5.653710    0.980144    1.098270    128.480178 
[37m[36mINFO[0m[0m 03/04 08:57:17 | 0.701222    0.712593    0.848737    0.837546    0.419514    0.985866    0.975265    0.761412    0.772128    0.798934    0.765244    0.701222    0.712593    400         11.307420   0.512259    1.085954    125.196709 
[37m[36mINFO[0m[0m 03/04 09:02:56 | 0.724176    0.718519    0.868988    0.850118    0.382699    0.995583    0.989399    0.777412    0.775895    0.833968    0.785061    0.724176    0.718519    600         16.961131   0.379290    1.068978    124.799578 
[37m[36mINFO[0m[0m 03/04 09:08:37 | 0.693077    0.688889    0.887852    0.846938    0.417193    0.993816    0.985866    0.793882    0.768362    0.875857    0.786585    0.693077    0.688889    800         22.614841   0.332476    1.069395    127.824411 
[37m[36mINFO[0m[0m 03/04 09:14:25 | 0.690855    0.675556    0.904396    0.848648    0.408660    0.995583    0.996466    0.845176    0.779661    0.872430    0.769817    0.690855    0.675556    1000        28.268551   0.290166    1.090199    129.283203 
[37m[36mINFO[0m[0m 03/04 09:20:06 | 0.677157    0.700741    0.933712    0.844600    0.447397    0.996466    0.992933    0.882353    0.766478    0.922315    0.774390    0.677157    0.700741    1200        33.922261   0.246428    1.081220    124.706924 
[37m[36mINFO[0m[0m 03/04 09:25:50 | 0.677527    0.678519    0.939730    0.841898    0.462537    0.998233    0.989399    0.889882    0.766478    0.931074    0.769817    0.677527    0.678519    1400        39.575972   0.195484    1.078958    128.952338 
[37m[36mINFO[0m[0m 03/04 09:31:31 | 0.699000    0.694815    0.942004    0.834455    0.470377    0.999117    0.989399    0.895059    0.753296    0.931835    0.760671    0.699000    0.694815    1600        45.229682   0.173530    1.068009    126.621656 
[37m[36mINFO[0m[0m 03/04 09:37:17 | 0.639763    0.650370    0.944233    0.832082    0.523896    1.000000    0.985866    0.903529    0.766478    0.929170    0.743902    0.639763    0.650370    1800        50.883392   0.137058    1.096024    126.702787 
[37m[36mINFO[0m[0m 03/04 09:43:02 | 0.680859    0.681481    0.957796    0.841247    0.547238    1.000000    0.982332    0.925176    0.785311    0.948210    0.756098    0.680859    0.681481    2000        56.537102   0.127879    1.091994    126.776670 
[37m[36mINFO[0m[0m 03/04 09:48:46 | 0.669752    0.671111    0.965443    0.834390    0.614112    0.997350    0.996466    0.951529    0.755179    0.947449    0.751524    0.669752    0.671111    2200        62.190813   0.102482    1.086965    126.744803 
[37m[36mINFO[0m[0m 03/04 09:54:29 | 0.674565    0.672593    0.966961    0.823862    0.630566    1.000000    0.985866    0.951529    0.757062    0.949353    0.728659    0.674565    0.672593    2400        67.844523   0.085703    1.082519    126.959244 
[37m[36mINFO[0m[0m 03/04 10:00:13 | 0.667531    0.665185    0.975348    0.823634    0.658478    0.998233    0.971731    0.960941    0.747646    0.966870    0.751524    0.667531    0.665185    2600        73.498233   0.077290    1.075056    128.725272 
[37m[36mINFO[0m[0m 03/04 10:05:55 | 0.650130    0.653333    0.976974    0.826945    0.680932    0.989399    0.961131    0.968941    0.751412    0.972582    0.768293    0.650130    0.653333    2800        79.151943   0.065865    1.071353    127.459443 
[37m[36mINFO[0m[0m 03/04 10:11:38 | 0.652351    0.654815    0.976413    0.827006    0.635239    0.997350    0.978799    0.962353    0.747646    0.969535    0.754573    0.652351    0.654815    3000        84.805654   0.070248    1.085056    126.180645 
[37m[36mINFO[0m[0m 03/04 10:17:21 | 0.689374    0.663704    0.984854    0.826492    0.689569    1.000000    0.985866    0.977412    0.734463    0.977152    0.759146    0.689374    0.663704    3200        90.459364   0.051059    1.084451    125.911584 
[37m[36mINFO[0m[0m 03/04 10:23:04 | 0.651981    0.651852    0.990056    0.837624    0.666569    0.999117    0.989399    0.984000    0.755179    0.987053    0.768293    0.651981    0.651852    3400        96.113074   0.052800    1.087206    125.584441 
[37m[36mINFO[0m[0m 03/04 10:28:45 | 0.646427    0.640000    0.982550    0.829326    0.717346    0.999117    0.992933    0.963765    0.741996    0.984768    0.753049    0.646427    0.640000    3600        101.766784  0.045095    1.069620    126.919373 
[37m[36mINFO[0m[0m 03/04 10:34:23 | 0.656424    0.638519    0.986273    0.833002    0.760207    1.000000    0.992933    0.979765    0.743879    0.979056    0.762195    0.656424    0.638519    3800        107.420495  0.037670    1.069606    123.964222 
[37m[36mINFO[0m[0m 03/04 10:40:00 | 0.659385    0.663704    0.991255    0.843291    0.718788    1.000000    0.985866    0.988235    0.758945    0.985529    0.785061    0.659385    0.663704    4000        113.074205  0.030596    1.063726    124.802558 
[37m[36mINFO[0m[0m 03/04 10:45:42 | 0.686042    0.657778    0.985599    0.826445    0.763126    0.997350    0.989399    0.975059    0.755179    0.984387    0.734756    0.686042    0.657778    4200        118.727915  0.040702    1.076996    126.447539 
[37m[36mINFO[0m[0m 03/04 10:51:28 | 0.653091    0.642963    0.990605    0.835532    0.745758    1.000000    0.989399    0.984000    0.770245    0.987814    0.746951    0.653091    0.642963    4400        124.381625  0.037259    1.094836    126.645819 
[37m[36mINFO[0m[0m 03/04 10:57:10 | 0.621251    0.616296    0.991486    0.818446    0.796380    1.000000    0.992933    0.985882    0.730697    0.988576    0.731707    0.621251    0.616296    4600        130.035336  0.026230    1.085973    125.027575 
[37m[36mINFO[0m[0m 03/04 11:02:55 | 0.680859    0.657778    0.994130    0.834784    0.774654    1.000000    0.989399    0.991529    0.766478    0.990861    0.748476    0.680859    0.657778    4800        135.689046  0.025075    1.096930    125.644445 
[37m[36mINFO[0m[0m 03/04 11:08:36 | 0.671233    0.648889    0.993166    0.840451    0.777292    1.000000    0.985866    0.986353    0.770245    0.993145    0.765244    0.671233    0.648889    5000        141.342756  0.024764    1.074810    126.028578 
[37m[36mINFO[0m[0m 03/04 11:08:36 | Cumulative gradient change saved at train_output/VLCS/ERM/[3]/250304_08-43-37_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/04 11:08:38 | ---
[37m[36mINFO[0m[0m 03/04 11:08:38 | test-domain validation(oracle) = 72.418%
[37m[36mINFO[0m[0m 03/04 11:08:38 | training-domain validation(iid) = 72.418%
[37m[36mINFO[0m[0m 03/04 11:08:38 | last = 67.123%
[37m[36mINFO[0m[0m 03/04 11:08:38 | last (inD) = 84.045%
[37m[36mINFO[0m[0m 03/04 11:08:38 | training-domain validation (iid, inD) = 85.012%
[37m[36mINFO[0m[0m 03/04 11:08:38 | === Summary ===
[37m[36mINFO[0m[0m 03/04 11:08:38 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 3 --dataset VLCS
[37m[36mINFO[0m[0m 03/04 11:08:38 | Unique name: 250304_08-43-37_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/04 11:08:38 | Out path: train_output/VLCS/ERM/[3]/250304_08-43-37_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/04 11:08:38 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/04 11:08:38 | Dataset: VLCS

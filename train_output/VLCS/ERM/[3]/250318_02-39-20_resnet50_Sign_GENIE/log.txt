[37m[36mINFO[0m[0m 03/18 02:39:20 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --trial_seed 0 --hparams_seed 18 --algorithm ERM --test_envs 3 --dataset VLCS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 18
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[3]/250318_02-39-20_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250318_02-39-20_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00021894640154701087
	batch_size: 13
	weight_decay: 7.1565884139944e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/18 02:39:20 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 02:39:20 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 02:39:20 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 02:39:20 | 
[37m[36mINFO[0m[0m 03/18 02:39:20 | Testenv name escaping te_V -> te_V
[37m[36mINFO[0m[0m 03/18 02:39:20 | Test envs = [3], name = te_V
[37m[36mINFO[0m[0m 03/18 02:39:20 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/18 02:39:20 | Batch sizes for each domain: [13, 13, 13, 0] (total=39)
[37m[36mINFO[0m[0m 03/18 02:39:20 | steps-per-epoch for each domain: 87.08, 163.46, 202.00 -> min = 87.08
[37m[36mINFO[0m[0m 03/18 02:39:21 | # of params = 23518277
[37m[36mINFO[0m[0m 03/18 02:41:35 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 02:41:35 | 0.492040    0.494815    0.561199    0.565638    1.263486    0.698763    0.699647    0.523294    0.521657    0.461538    0.475610    0.492040    0.494815    0           0.000000    1.863750    1.413502    131.988193 
[37m[36mINFO[0m[0m 03/18 02:45:19 | 0.794891    0.802963    0.849228    0.833804    0.415110    0.997350    1.000000    0.762824    0.751412    0.787510    0.750000    0.794891    0.802963    200         2.296820    0.521776    0.475325    129.523433 
[37m[36mINFO[0m[0m 03/18 02:49:06 | 0.760089    0.757037    0.856860    0.838395    0.435277    0.996466    0.996466    0.739765    0.738230    0.834349    0.780488    0.760089    0.757037    400         4.593640    0.382196    0.470678    132.949623 
[37m[36mINFO[0m[0m 03/18 02:52:53 | 0.798593    0.788148    0.874563    0.849855    0.385070    0.999117    1.000000    0.772706    0.740113    0.851866    0.809451    0.798593    0.788148    600         6.890459    0.368306    0.482700    129.794868 
[37m[36mINFO[0m[0m 03/18 02:56:42 | 0.746760    0.760000    0.869708    0.839949    0.413536    0.999117    0.996466    0.764235    0.730697    0.845773    0.792683    0.746760    0.760000    800         9.187279    0.316965    0.481903    132.505359 
[37m[36mINFO[0m[0m 03/18 03:00:29 | 0.783043    0.800000    0.883246    0.841367    0.414032    1.000000    1.000000    0.802824    0.766478    0.846915    0.757622    0.783043    0.800000    1000        11.484099   0.315848    0.467636    134.203333 
[37m[36mINFO[0m[0m 03/18 03:04:16 | 0.785265    0.804444    0.874791    0.822026    0.426935    0.998233    1.000000    0.768941    0.709981    0.857197    0.756098    0.785265    0.804444    1200        13.780919   0.291172    0.470744    132.255376 
[37m[36mINFO[0m[0m 03/18 03:08:05 | 0.718252    0.718519    0.903463    0.844553    0.405409    0.996466    0.996466    0.817882    0.755179    0.896040    0.782012    0.718252    0.718519    1400        16.077739   0.272928    0.474716    133.737823 
[37m[36mINFO[0m[0m 03/18 03:11:49 | 0.735283    0.736296    0.887942    0.829290    0.455462    1.000000    1.000000    0.794824    0.736347    0.869002    0.751524    0.735283    0.736296    1600        18.374558   0.246938    0.460265    132.015121 
[37m[36mINFO[0m[0m 03/18 03:15:34 | 0.754906    0.754074    0.903540    0.844237    0.423345    0.996466    1.000000    0.839059    0.779661    0.875095    0.753049    0.754906    0.754074    1800        20.671378   0.251786    0.465406    132.587696 
[37m[36mINFO[0m[0m 03/18 03:19:19 | 0.708626    0.702222    0.928445    0.850782    0.434292    1.000000    1.000000    0.874824    0.762712    0.910510    0.789634    0.708626    0.702222    2000        22.968198   0.231280    0.468642    130.651448 
[37m[36mINFO[0m[0m 03/18 03:23:06 | 0.761200    0.765926    0.931302    0.841844    0.466316    1.000000    1.000000    0.857882    0.741996    0.936024    0.783537    0.761200    0.765926    2200        25.265018   0.202376    0.472112    133.143021 
[37m[36mINFO[0m[0m 03/18 03:26:52 | 0.724176    0.733333    0.932032    0.845282    0.498463    0.999117    1.000000    0.864000    0.740113    0.932978    0.795732    0.724176    0.733333    2400        27.561837   0.203037    0.469621    132.034878 
[37m[36mINFO[0m[0m 03/18 03:30:42 | 0.754535    0.737778    0.931545    0.841785    0.514245    1.000000    1.000000    0.885647    0.757062    0.908987    0.768293    0.754535    0.737778    2600        29.858657   0.184558    0.492240    131.726218 
[37m[36mINFO[0m[0m 03/18 03:34:31 | 0.718993    0.746667    0.937372    0.824657    0.483605    0.999117    1.000000    0.878118    0.719397    0.934882    0.754573    0.718993    0.746667    2800        32.155477   0.177890    0.487903    130.841376 
[37m[36mINFO[0m[0m 03/18 03:38:17 | 0.655313    0.666667    0.933278    0.825853    0.606741    1.000000    1.000000    0.896941    0.738230    0.902894    0.739329    0.655313    0.666667    3000        34.452297   0.163179    0.478509    130.676202 
[37m[36mINFO[0m[0m 03/18 03:42:03 | 0.753425    0.767407    0.957624    0.846627    0.502050    1.000000    1.000000    0.928471    0.753296    0.944402    0.786585    0.753425    0.767407    3200        36.749117   0.150346    0.475713    130.964495 
[37m[36mINFO[0m[0m 03/18 03:45:50 | 0.755276    0.746667    0.965503    0.842173    0.504533    1.000000    1.000000    0.934588    0.755179    0.961919    0.771341    0.755276    0.746667    3400        39.045936   0.154219    0.474837    132.007231 
[37m[36mINFO[0m[0m 03/18 03:49:34 | 0.739356    0.748148    0.948481    0.827527    0.625841    1.000000    1.000000    0.896471    0.732580    0.948972    0.750000    0.739356    0.748148    3600        41.342756   0.126176    0.480379    128.018826 
[37m[36mINFO[0m[0m 03/18 03:53:21 | 0.743799    0.733333    0.964085    0.837331    0.690610    1.000000    1.000000    0.940235    0.758945    0.952018    0.753049    0.743799    0.733333    3800        43.639576   0.121261    0.473330    132.178402 
[37m[36mINFO[0m[0m 03/18 03:57:07 | 0.752684    0.764444    0.968670    0.848212    0.579133    1.000000    1.000000    0.944471    0.770245    0.961538    0.774390    0.752684    0.764444    4000        45.936396   0.127257    0.474438    131.132447 
[37m[36mINFO[0m[0m 03/18 04:00:53 | 0.693447    0.696296    0.961215    0.818995    0.684192    1.000000    0.996466    0.919059    0.696798    0.964585    0.763720    0.693447    0.696296    4200        48.233216   0.088821    0.472796    131.190318 
[37m[36mINFO[0m[0m 03/18 04:04:37 | 0.728989    0.728889    0.971673    0.841695    0.650248    0.998233    1.000000    0.951059    0.747646    0.965727    0.777439    0.728989    0.728889    4400        50.530035   0.105253    0.474811    128.960619 
[37m[36mINFO[0m[0m 03/18 04:08:24 | 0.691596    0.690370    0.959394    0.838497    0.703129    1.000000    1.000000    0.930353    0.753296    0.947829    0.762195    0.691596    0.690370    4600        52.826855   0.102721    0.488117    129.124193 
[37m[36mINFO[0m[0m 03/18 04:12:05 | 0.680489    0.659259    0.968458    0.820980    0.639644    0.999117    1.000000    0.947765    0.717514    0.958492    0.745427    0.680489    0.659259    4800        55.123675   0.085965    0.464035    128.056617 
[37m[36mINFO[0m[0m 03/18 04:15:46 | 0.738245    0.715556    0.977624    0.832686    0.685780    1.000000    0.996466    0.959529    0.736347    0.973343    0.765244    0.738245    0.715556    5000        57.420495   0.088009    0.456322    129.965214 
[37m[36mINFO[0m[0m 03/18 04:15:46 | Cumulative gradient change saved at train_output/VLCS/ERM/[3]/250318_02-39-20_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 04:15:48 | ---
[37m[36mINFO[0m[0m 03/18 04:15:48 | test-domain validation(oracle) = 78.526%
[37m[36mINFO[0m[0m 03/18 04:15:48 | training-domain validation(iid) = 70.863%
[37m[36mINFO[0m[0m 03/18 04:15:48 | last = 73.825%
[37m[36mINFO[0m[0m 03/18 04:15:48 | last (inD) = 83.269%
[37m[36mINFO[0m[0m 03/18 04:15:48 | training-domain validation (iid, inD) = 85.078%
[37m[36mINFO[0m[0m 03/18 04:15:48 | === Summary ===
[37m[36mINFO[0m[0m 03/18 04:15:48 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --trial_seed 0 --hparams_seed 18 --algorithm ERM --test_envs 3 --dataset VLCS
[37m[36mINFO[0m[0m 03/18 04:15:48 | Unique name: 250318_02-39-20_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 04:15:48 | Out path: train_output/VLCS/ERM/[3]/250318_02-39-20_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 04:15:48 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 04:15:48 | Dataset: VLCS

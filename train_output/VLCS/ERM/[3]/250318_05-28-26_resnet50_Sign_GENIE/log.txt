[37m[36mINFO[0m[0m 03/18 05:28:26 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset VLCS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[3]/250318_05-28-26_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250318_05-28-26_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/18 05:28:26 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 05:28:26 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 05:28:26 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 05:28:26 | 
[37m[36mINFO[0m[0m 03/18 05:28:26 | Testenv name escaping te_V -> te_V
[37m[36mINFO[0m[0m 03/18 05:28:26 | Test envs = [3], name = te_V
[37m[36mINFO[0m[0m 03/18 05:28:26 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/18 05:28:26 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 03/18 05:28:26 | steps-per-epoch for each domain: 35.38, 66.41, 82.06 -> min = 35.38
[37m[36mINFO[0m[0m 03/18 05:28:27 | # of params = 23518277
[37m[36mINFO[0m[0m 03/18 05:30:40 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 05:30:40 | 0.452795    0.451852    0.485594    0.502338    1.196813    0.613074    0.632509    0.460235    0.493409    0.383473    0.381098    0.452795    0.451852    0           0.000000    1.809193    1.309626    131.652385 
[37m[36mINFO[0m[0m 03/18 05:36:34 | 0.794150    0.800000    0.867970    0.850662    0.384700    0.999117    1.000000    0.778824    0.760829    0.825971    0.791159    0.794150    0.800000    200         5.653710    0.446101    1.123837    128.993874 
[37m[36mINFO[0m[0m 03/18 05:42:27 | 0.787116    0.774815    0.873222    0.846716    0.393562    1.000000    1.000000    0.768941    0.730697    0.850724    0.809451    0.787116    0.774815    400         11.307420   0.323878    1.111852    131.029022 
[37m[36mINFO[0m[0m 03/18 05:48:21 | 0.763421    0.757037    0.902022    0.856073    0.415727    0.998233    1.000000    0.825882    0.774011    0.881950    0.794207    0.763421    0.757037    600         16.961131   0.281853    1.121201    129.310966 
[37m[36mINFO[0m[0m 03/18 05:54:14 | 0.772677    0.779259    0.923843    0.851559    0.424014    1.000000    1.000000    0.858353    0.758945    0.913176    0.795732    0.772677    0.779259    800         22.614841   0.235066    1.112073    130.662201 
[37m[36mINFO[0m[0m 03/18 06:00:07 | 0.746390    0.752593    0.936003    0.855535    0.466674    1.000000    1.000000    0.889882    0.781544    0.918126    0.785061    0.746390    0.752593    1000        28.268551   0.203818    1.134300    126.824608 
[37m[36mINFO[0m[0m 03/18 06:06:01 | 0.766013    0.776296    0.954636    0.855834    0.480249    1.000000    1.000000    0.913412    0.770245    0.950495    0.797256    0.766013    0.776296    1200        33.922261   0.168588    1.116873    130.150318 
[37m[36mINFO[0m[0m 03/18 06:11:53 | 0.725287    0.727407    0.954755    0.846986    0.533599    1.000000    1.000000    0.915294    0.758945    0.948972    0.782012    0.725287    0.727407    1400        39.575972   0.150687    1.104293    131.100945 
[37m[36mINFO[0m[0m 03/18 06:17:45 | 0.737505    0.730370    0.962201    0.846238    0.647781    1.000000    1.000000    0.926588    0.755179    0.960015    0.783537    0.737505    0.730370    1600        45.229682   0.118962    1.104932    131.338097 
[37m[36mINFO[0m[0m 03/18 06:23:35 | 0.713069    0.691852    0.962192    0.838694    0.677406    0.999117    0.996466    0.935059    0.758945    0.952399    0.760671    0.713069    0.691852    1800        50.883392   0.103132    1.094978    130.563399 
[37m[36mINFO[0m[0m 03/18 06:29:21 | 0.776379    0.788148    0.963511    0.851082    0.646594    1.000000    1.000000    0.949176    0.783427    0.941356    0.769817    0.776379    0.788148    2000        56.537102   0.088493    1.097158    126.937645 
[37m[36mINFO[0m[0m 03/18 06:35:06 | 0.762680    0.752593    0.952909    0.845163    0.723434    0.999117    1.000000    0.922824    0.770245    0.936786    0.765244    0.762680    0.752593    2200        62.190813   0.076092    1.084163    128.324178 
[37m[36mINFO[0m[0m 03/18 06:40:52 | 0.751573    0.742222    0.974771    0.835262    0.905290    1.000000    0.989399    0.950588    0.741996    0.973724    0.774390    0.751573    0.742222    2400        67.844523   0.055154    1.087153    128.521246 
[37m[36mINFO[0m[0m 03/18 06:46:41 | 0.716772    0.720000    0.987439    0.840559    0.770475    1.000000    1.000000    0.982118    0.745763    0.980198    0.775915    0.716772    0.720000    2600        73.498233   0.054380    1.107352    127.544153 
[37m[36mINFO[0m[0m 03/18 06:52:25 | 0.747871    0.758519    0.988095    0.858076    0.735158    1.000000    1.000000    0.976471    0.781544    0.987814    0.792683    0.747871    0.758519    2800        79.151943   0.061248    1.086829    126.544532 
[37m[36mINFO[0m[0m 03/18 06:58:13 | 0.733432    0.746667    0.979639    0.829678    0.937224    1.000000    1.000000    0.947294    0.702448    0.991622    0.786585    0.733432    0.746667    3000        84.805654   0.040993    1.093412    129.041349 
[37m[36mINFO[0m[0m 03/18 07:03:58 | 0.691225    0.688889    0.984486    0.841982    0.814306    0.999117    0.996466    0.980235    0.762712    0.974105    0.766768    0.691225    0.688889    3200        90.459364   0.048847    1.087644    127.523467 
[37m[36mINFO[0m[0m 03/18 07:09:44 | 0.753795    0.749630    0.987475    0.843954    0.841187    1.000000    0.996466    0.972706    0.745763    0.989718    0.789634    0.753795    0.749630    3400        96.113074   0.032882    1.089042    128.258751 
[37m[36mINFO[0m[0m 03/18 07:15:31 | 0.715291    0.714074    0.994892    0.843847    0.897515    1.000000    1.000000    0.991529    0.749529    0.993145    0.782012    0.715291    0.714074    3600        101.766784  0.025981    1.088931    129.353029 
[37m[36mINFO[0m[0m 03/18 07:21:14 | 0.744169    0.746667    0.991315    0.839549    0.923927    1.000000    0.992933    0.989176    0.758945    0.984768    0.766768    0.744169    0.746667    3800        107.420495  0.036035    1.079990    126.383354 
[37m[36mINFO[0m[0m 03/18 07:26:58 | 0.752684    0.749630    0.992486    0.841067    0.995089    1.000000    1.000000    0.981647    0.745763    0.995811    0.777439    0.752684    0.749630    4000        113.074205  0.026901    1.081676    127.657807 
[37m[36mINFO[0m[0m 03/18 07:32:42 | 0.715291    0.736296    0.991590    0.832907    0.956427    1.000000    1.000000    0.983529    0.721281    0.991241    0.777439    0.715291    0.736296    4200        118.727915  0.030695    1.089891    126.240548 
[37m[36mINFO[0m[0m 03/18 07:38:25 | 0.749352    0.751111    0.996729    0.857238    0.907384    1.000000    1.000000    0.992471    0.768362    0.997715    0.803354    0.749352    0.751111    4400        124.381625  0.024738    1.082170    126.816500 
[37m[36mINFO[0m[0m 03/18 07:44:12 | 0.637542    0.651852    0.977280    0.820388    1.071645    0.999117    0.992933    0.980706    0.721281    0.952018    0.746951    0.637542    0.651852    4600        130.035336  0.013864    1.094159    128.332315 
[37m[36mINFO[0m[0m 03/18 07:49:58 | 0.677157    0.666667    0.991502    0.841695    0.975513    1.000000    1.000000    0.990118    0.747646    0.984387    0.777439    0.677157    0.666667    4800        135.689046  0.025591    1.075012    130.752332 
[37m[36mINFO[0m[0m 03/18 07:55:42 | 0.694928    0.687407    0.995459    0.834706    0.987857    1.000000    0.992933    0.992471    0.730697    0.993907    0.780488    0.694928    0.687407    5000        141.342756  0.016455    1.089915    125.729729 
[37m[36mINFO[0m[0m 03/18 07:55:42 | Cumulative gradient change saved at train_output/VLCS/ERM/[3]/250318_05-28-26_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 07:55:43 | ---
[37m[36mINFO[0m[0m 03/18 07:55:43 | test-domain validation(oracle) = 79.415%
[37m[36mINFO[0m[0m 03/18 07:55:43 | training-domain validation(iid) = 74.787%
[37m[36mINFO[0m[0m 03/18 07:55:43 | last = 69.493%
[37m[36mINFO[0m[0m 03/18 07:55:43 | last (inD) = 83.471%
[37m[36mINFO[0m[0m 03/18 07:55:43 | training-domain validation (iid, inD) = 85.808%
[37m[36mINFO[0m[0m 03/18 07:55:43 | === Summary ===
[37m[36mINFO[0m[0m 03/18 07:55:43 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset VLCS
[37m[36mINFO[0m[0m 03/18 07:55:43 | Unique name: 250318_05-28-26_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 07:55:43 | Out path: train_output/VLCS/ERM/[3]/250318_05-28-26_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 07:55:43 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 07:55:43 | Dataset: VLCS

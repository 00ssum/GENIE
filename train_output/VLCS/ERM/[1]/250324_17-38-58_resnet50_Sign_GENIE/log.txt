[37m[36mINFO[0m[0m 03/24 17:38:58 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 0 --hparams_seed 17
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 17
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[1]/250324_17-38-58_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250324_17-38-58_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00025159202447589334
	batch_size: 8
	weight_decay: 0.007781932002143384
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/24 17:38:58 | n_steps = 5001
[37m[36mINFO[0m[0m 03/24 17:38:58 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/24 17:38:58 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/24 17:38:58 | 
[37m[36mINFO[0m[0m 03/24 17:38:58 | Testenv name escaping te_L -> te_L
[37m[36mINFO[0m[0m 03/24 17:38:58 | Test envs = [1], name = te_L
[37m[36mINFO[0m[0m 03/24 17:38:58 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/24 17:38:58 | Batch sizes for each domain: [8, 0, 8, 8] (total=24)
[37m[36mINFO[0m[0m 03/24 17:38:58 | steps-per-epoch for each domain: 141.50, 328.25, 337.62 -> min = 141.50
[37m[36mINFO[0m[0m 03/24 17:38:59 | # of params = 23518277
[37m[36mINFO[0m[0m 03/24 17:41:16 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/24 17:41:16 | 0.468706    0.491525    0.575279    0.590429    1.241606    0.666078    0.664311    0.468706    0.491525    0.552171    0.589939    0.507590    0.517037    0           0.000000    1.661705    0.916398    136.771201 
[37m[36mINFO[0m[0m 03/24 17:44:02 | 0.655059    0.632768    0.872705    0.863342    0.378643    0.986749    0.989399    0.655059    0.632768    0.790937    0.759146    0.840429    0.841481    200         1.413428    0.447406    0.137504    138.074733 
[37m[36mINFO[0m[0m 03/24 17:46:41 | 0.646588    0.647834    0.870454    0.864378    0.378006    0.989399    1.000000    0.646588    0.647834    0.785605    0.756098    0.836357    0.837037    400         2.826855    0.345239    0.132322    132.179778 
[37m[36mINFO[0m[0m 03/24 17:49:23 | 0.528471    0.516008    0.853810    0.829904    0.442554    0.999117    1.000000    0.528471    0.516008    0.744097    0.713415    0.818215    0.776296    600         4.240283    0.321325    0.128153    136.973172 
[37m[36mINFO[0m[0m 03/24 17:52:09 | 0.653647    0.668550    0.856570    0.842188    0.453197    0.961131    0.978799    0.653647    0.668550    0.823686    0.775915    0.784894    0.771852    800         5.653710    0.295529    0.144191    137.395036 
[37m[36mINFO[0m[0m 03/24 17:54:49 | 0.644706    0.657250    0.898789    0.873971    0.368894    0.996466    0.996466    0.644706    0.657250    0.845773    0.798780    0.854128    0.826667    1000        7.067138    0.308747    0.116532    136.585134 
[37m[36mINFO[0m[0m 03/24 17:57:31 | 0.637647    0.655367    0.890219    0.858932    0.399333    0.997350    1.000000    0.637647    0.655367    0.821401    0.754573    0.851907    0.822222    1200        8.480565    0.278444    0.134028    134.915642 
[37m[36mINFO[0m[0m 03/24 18:00:09 | 0.584471    0.566855    0.887781    0.860062    0.398840    0.998233    1.000000    0.584471    0.566855    0.806169    0.769817    0.858941    0.810370    1400        9.893993    0.276672    0.125166    132.409424 
[37m[36mINFO[0m[0m 03/24 18:02:46 | 0.628235    0.595104    0.903657    0.860585    0.367239    0.999117    1.000000    0.628235    0.595104    0.836253    0.772866    0.875602    0.808889    1600        11.307420   0.244243    0.115561    134.361848 
[37m[36mINFO[0m[0m 03/24 18:05:31 | 0.658824    0.668550    0.905316    0.866610    0.383432    0.996466    0.992933    0.658824    0.668550    0.844250    0.771341    0.875231    0.835556    1800        12.720848   0.281237    0.142830    135.977114 
[37m[36mINFO[0m[0m 03/24 18:08:11 | 0.658353    0.668550    0.911873    0.872275    0.378744    0.999117    0.996466    0.658353    0.668550    0.843869    0.775915    0.892632    0.844444    2000        14.134276   0.253336    0.138141    133.150787 
[37m[36mINFO[0m[0m 03/24 18:10:48 | 0.677176    0.711864    0.853693    0.834580    0.495637    0.992049    0.996466    0.677176    0.711864    0.746002    0.705793    0.823029    0.801481    2200        15.547703   0.301590    0.116475    133.668295 
[37m[36mINFO[0m[0m 03/24 18:13:32 | 0.585412    0.561205    0.890766    0.854629    0.443823    0.993816    0.992933    0.585412    0.561205    0.821021    0.757622    0.857460    0.813333    2400        16.961131   0.288137    0.142304    135.578719 
[37m[36mINFO[0m[0m 03/24 18:16:14 | 0.624471    0.625235    0.916821    0.870195    0.376812    0.998233    0.992933    0.624471    0.625235    0.863671    0.785061    0.888560    0.832593    2600        18.374558   0.266390    0.136167    134.542871 
[37m[36mINFO[0m[0m 03/24 18:18:51 | 0.641882    0.653484    0.877970    0.837901    0.502005    0.999117    0.996466    0.641882    0.653484    0.807692    0.743902    0.827101    0.773333    2800        19.787986   0.278684    0.116513    133.437706 
[37m[36mINFO[0m[0m 03/24 18:21:32 | 0.599529    0.583804    0.912791    0.845935    0.401457    0.996466    1.000000    0.599529    0.583804    0.865194    0.737805    0.876712    0.800000    3000        21.201413   0.289398    0.138517    133.448881 
[37m[36mINFO[0m[0m 03/24 18:24:13 | 0.664471    0.698682    0.894204    0.848300    0.453359    0.995583    0.996466    0.664471    0.698682    0.822163    0.746951    0.864865    0.801481    3200        22.614841   0.273208    0.132423    134.110443 
[37m[36mINFO[0m[0m 03/24 18:26:55 | 0.625412    0.630885    0.891120    0.841661    0.432400    0.991166    0.992933    0.625412    0.630885    0.834730    0.743902    0.847464    0.788148    3400        24.028269   0.265683    0.133247    135.856555 
[37m[36mINFO[0m[0m 03/24 18:29:38 | 0.654118    0.670433    0.882597    0.833189    0.452396    0.987633    0.982332    0.654118    0.670433    0.827875    0.743902    0.832284    0.773333    3600        25.441696   0.324612    0.139177    134.685186 
[37m[36mINFO[0m[0m 03/24 18:32:14 | 0.625412    0.612053    0.895889    0.845754    0.439977    0.993816    0.985866    0.625412    0.612053    0.841203    0.746951    0.852647    0.804444    3800        26.855124   0.329252    0.112565    133.989684 
[37m[36mINFO[0m[0m 03/24 18:34:54 | 0.669176    0.679849    0.906049    0.852959    0.394243    0.998233    0.996466    0.669176    0.679849    0.846535    0.769817    0.873380    0.792593    4000        28.268551   0.289207    0.128185    134.251661 
[37m[36mINFO[0m[0m 03/24 18:37:32 | 0.654588    0.672316    0.871157    0.822311    0.468310    0.983216    0.982332    0.654588    0.672316    0.817593    0.742378    0.812662    0.742222    4200        29.681979   0.319269    0.132775    131.696987 
[37m[36mINFO[0m[0m 03/24 18:40:07 | 0.660235    0.694915    0.826558    0.801562    0.514791    0.937279    0.950530    0.660235    0.694915    0.760091    0.713415    0.782303    0.740741    4400        31.095406   0.330423    0.112152    131.946613 
[37m[36mINFO[0m[0m 03/24 18:42:48 | 0.553412    0.551789    0.839197    0.792725    0.515546    0.977915    0.964664    0.553412    0.551789    0.755522    0.690549    0.784154    0.722963    4600        32.508834   0.355320    0.134985    133.882916 
[37m[36mINFO[0m[0m 03/24 18:45:28 | 0.562353    0.546139    0.818703    0.773520    0.635633    0.958481    0.943463    0.562353    0.546139    0.721249    0.660061    0.776379    0.717037    4800        33.922261   0.370380    0.129985    134.302953 
[37m[36mINFO[0m[0m 03/24 18:48:07 | 0.666824    0.679849    0.892068    0.840888    0.417919    0.992933    0.992933    0.666824    0.679849    0.846915    0.766768    0.836357    0.762963    5000        35.335689   0.351674    0.117114    135.638148 
[37m[36mINFO[0m[0m 03/24 18:48:07 | Cumulative gradient change saved at train_output/VLCS/ERM/[1]/250324_17-38-58_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/24 18:48:09 | ---
[37m[36mINFO[0m[0m 03/24 18:48:09 | test-domain validation(oracle) = 67.718%
[37m[36mINFO[0m[0m 03/24 18:48:09 | training-domain validation(iid) = 64.471%
[37m[36mINFO[0m[0m 03/24 18:48:09 | last = 66.682%
[37m[36mINFO[0m[0m 03/24 18:48:09 | last (inD) = 84.089%
[37m[36mINFO[0m[0m 03/24 18:48:09 | training-domain validation (iid, inD) = 87.397%
[37m[36mINFO[0m[0m 03/24 18:48:09 | === Summary ===
[37m[36mINFO[0m[0m 03/24 18:48:09 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 0 --hparams_seed 17
[37m[36mINFO[0m[0m 03/24 18:48:09 | Unique name: 250324_17-38-58_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 18:48:09 | Out path: train_output/VLCS/ERM/[1]/250324_17-38-58_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 18:48:09 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/24 18:48:09 | Dataset: VLCS

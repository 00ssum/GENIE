[37m[36mINFO[0m[0m 03/24 10:15:41 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 0 --hparams_seed 11
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 11
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[1]/250324_10-15-41_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250324_10-15-41_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5.962562271631622e-05
	batch_size: 11
	weight_decay: 0.001114945719897867
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/24 10:15:41 | n_steps = 5001
[37m[36mINFO[0m[0m 03/24 10:15:41 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/24 10:15:41 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/24 10:15:41 | 
[37m[36mINFO[0m[0m 03/24 10:15:41 | Testenv name escaping te_L -> te_L
[37m[36mINFO[0m[0m 03/24 10:15:41 | Test envs = [1], name = te_L
[37m[36mINFO[0m[0m 03/24 10:15:41 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/24 10:15:41 | Batch sizes for each domain: [11, 0, 11, 11] (total=33)
[37m[36mINFO[0m[0m 03/24 10:15:41 | steps-per-epoch for each domain: 102.91, 238.73, 245.55 -> min = 102.91
[37m[36mINFO[0m[0m 03/24 10:15:42 | # of params = 23518277
[37m[36mINFO[0m[0m 03/24 10:17:52 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/24 10:17:52 | 0.457882    0.478343    0.485926    0.497471    1.242727    0.612191    0.628975    0.457882    0.478343    0.399086    0.411585    0.446501    0.451852    0           0.000000    1.706690    0.965179    129.589777 
[37m[36mINFO[0m[0m 03/24 10:20:27 | 0.635294    0.629002    0.877794    0.857973    0.377189    0.999117    1.000000    0.635294    0.629002    0.788652    0.757622    0.845613    0.816296    200         1.943463    0.432832    0.126714    129.455177 
[37m[36mINFO[0m[0m 03/24 10:23:01 | 0.666824    0.659134    0.892171    0.874493    0.319221    0.989399    0.989399    0.666824    0.659134    0.825209    0.789634    0.861903    0.844444    400         3.886926    0.299487    0.127449    128.161364 
[37m[36mINFO[0m[0m 03/24 10:25:55 | 0.560000    0.548023    0.884669    0.859336    0.370897    0.995583    0.996466    0.560000    0.548023    0.805407    0.765244    0.853017    0.816296    600         5.830389    0.276797    0.210987    132.403716 
[37m[36mINFO[0m[0m 03/24 10:28:39 | 0.648471    0.642185    0.915517    0.874698    0.316333    0.998233    1.000000    0.648471    0.642185    0.856055    0.803354    0.892262    0.820741    800         7.773852    0.259060    0.155510    132.253712 
[37m[36mINFO[0m[0m 03/24 10:31:28 | 0.668706    0.666667    0.931250    0.897657    0.294293    1.000000    1.000000    0.668706    0.666667    0.878903    0.829268    0.914846    0.863704    1000        9.717314    0.224154    0.189210    131.746874 
[37m[36mINFO[0m[0m 03/24 10:34:22 | 0.624471    0.612053    0.931128    0.884327    0.335035    0.997350    0.996466    0.624471    0.612053    0.881188    0.797256    0.914846    0.859259    1200        11.660777   0.201405    0.203780    132.777653 
[37m[36mINFO[0m[0m 03/24 10:37:18 | 0.646588    0.640301    0.931777    0.886156    0.339278    0.997350    1.000000    0.646588    0.640301    0.884615    0.814024    0.913365    0.844444    1400        13.604240   0.205896    0.221586    131.554409 
[37m[36mINFO[0m[0m 03/24 10:40:18 | 0.683765    0.711864    0.912891    0.871041    0.385527    0.995583    1.000000    0.683765    0.711864    0.867860    0.782012    0.875231    0.831111    1600        15.547703   0.178345    0.250895    130.443604 
[37m[36mINFO[0m[0m 03/24 10:43:20 | 0.608941    0.604520    0.933933    0.876924    0.360767    0.998233    1.000000    0.608941    0.604520    0.885758    0.777439    0.917808    0.853333    1800        17.491166   0.172812    0.250042    131.923321 
[37m[36mINFO[0m[0m 03/24 10:46:21 | 0.652706    0.632768    0.941204    0.883705    0.342741    1.000000    0.996466    0.652706    0.632768    0.900990    0.783537    0.922621    0.871111    2000        19.434629   0.172167    0.255006    129.972710 
[37m[36mINFO[0m[0m 03/24 10:49:28 | 0.598588    0.604520    0.939557    0.873491    0.386595    0.998233    0.989399    0.598588    0.604520    0.880046    0.788110    0.940392    0.842963    2200        21.378092   0.144961    0.255603    135.447502 
[37m[36mINFO[0m[0m 03/24 10:52:29 | 0.648471    0.653484    0.955449    0.876065    0.385190    1.000000    1.000000    0.648471    0.653484    0.920030    0.791159    0.946316    0.837037    2400        23.321555   0.168885    0.236055    133.757966 
[37m[36mINFO[0m[0m 03/24 10:55:28 | 0.624941    0.634652    0.942759    0.872888    0.416722    1.000000    1.000000    0.624941    0.634652    0.882331    0.768293    0.945946    0.850370    2600        25.265018   0.136222    0.228711    133.471227 
[37m[36mINFO[0m[0m 03/24 10:58:26 | 0.632471    0.630885    0.969006    0.884835    0.382901    1.000000    0.996466    0.632471    0.630885    0.944783    0.798780    0.962236    0.859259    2800        27.208481   0.142321    0.235443    130.553201 
[37m[36mINFO[0m[0m 03/24 11:01:28 | 0.648000    0.659134    0.962853    0.875428    0.398888    1.000000    1.000000    0.648000    0.659134    0.933359    0.775915    0.955202    0.850370    3000        29.151943   0.120771    0.249158    132.905988 
[37m[36mINFO[0m[0m 03/24 11:04:32 | 0.646118    0.645951    0.975533    0.884983    0.386623    1.000000    1.000000    0.646118    0.645951    0.956588    0.794207    0.970011    0.860741    3200        31.095406   0.102696    0.256144    132.475207 
[37m[36mINFO[0m[0m 03/24 11:07:41 | 0.662118    0.644068    0.967635    0.873424    0.417635    1.000000    1.000000    0.662118    0.644068    0.943260    0.772866    0.959645    0.847407    3400        33.038869   0.099541    0.274460    133.983444 
[37m[36mINFO[0m[0m 03/24 11:10:29 | 0.663529    0.662900    0.975928    0.874511    0.486470    1.000000    0.992933    0.663529    0.662900    0.959254    0.771341    0.968530    0.859259    3600        34.982332   0.086550    0.183493    131.788108 
[37m[36mINFO[0m[0m 03/24 11:13:15 | 0.641412    0.638418    0.957642    0.871824    0.407783    1.000000    0.996466    0.641412    0.638418    0.930312    0.780488    0.942614    0.838519    3800        36.925795   0.090749    0.156460    133.907919 
[37m[36mINFO[0m[0m 03/24 11:16:15 | 0.600471    0.606403    0.980854    0.874541    0.438567    1.000000    1.000000    0.600471    0.606403    0.971439    0.786585    0.971122    0.837037    4000        38.869258   0.097968    0.227163    134.715130 
[37m[36mINFO[0m[0m 03/24 11:19:27 | 0.627765    0.647834    0.954939    0.863267    0.564582    0.997350    0.985866    0.627765    0.647834    0.920411    0.771341    0.947057    0.832593    4200        40.812721   0.079585    0.293113    133.965874 
[37m[36mINFO[0m[0m 03/24 11:22:19 | 0.672000    0.668550    0.971594    0.875220    0.470152    0.998233    0.992933    0.672000    0.668550    0.954684    0.794207    0.961866    0.838519    4400        42.756184   0.073557    0.195993    132.911695 
[37m[36mINFO[0m[0m 03/24 11:25:03 | 0.607059    0.606403    0.980223    0.874274    0.481896    0.998233    0.985866    0.607059    0.606403    0.966870    0.786585    0.975565    0.850370    4600        44.699647   0.076736    0.149751    133.881130 
[37m[36mINFO[0m[0m 03/24 11:27:59 | 0.575059    0.546139    0.969086    0.858699    0.535627    0.999117    0.996466    0.575059    0.546139    0.931835    0.750000    0.976305    0.829630    4800        46.643110   0.067052    0.211450    133.158818 
[37m[36mINFO[0m[0m 03/24 11:31:12 | 0.615529    0.621469    0.980089    0.873363    0.546721    1.000000    0.996466    0.615529    0.621469    0.968774    0.786585    0.971492    0.837037    5000        48.586572   0.054536    0.312172    130.391845 
[37m[36mINFO[0m[0m 03/24 11:31:12 | Cumulative gradient change saved at train_output/VLCS/ERM/[1]/250324_10-15-41_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/24 11:31:13 | ---
[37m[36mINFO[0m[0m 03/24 11:31:13 | test-domain validation(oracle) = 68.376%
[37m[36mINFO[0m[0m 03/24 11:31:13 | training-domain validation(iid) = 66.871%
[37m[36mINFO[0m[0m 03/24 11:31:13 | last = 61.553%
[37m[36mINFO[0m[0m 03/24 11:31:13 | last (inD) = 87.336%
[37m[36mINFO[0m[0m 03/24 11:31:13 | training-domain validation (iid, inD) = 89.766%
[37m[36mINFO[0m[0m 03/24 11:31:13 | === Summary ===
[37m[36mINFO[0m[0m 03/24 11:31:13 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 0 --hparams_seed 11
[37m[36mINFO[0m[0m 03/24 11:31:13 | Unique name: 250324_10-15-41_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 11:31:13 | Out path: train_output/VLCS/ERM/[1]/250324_10-15-41_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 11:31:13 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/24 11:31:13 | Dataset: VLCS

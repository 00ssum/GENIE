[37m[36mINFO[0m[0m 03/24 16:26:31 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 0 --hparams_seed 16
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 16
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[1]/250324_16-26-31_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250324_16-26-31_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 4.249952708249365e-05
	batch_size: 17
	weight_decay: 9.786966598736845e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/24 16:26:31 | n_steps = 5001
[37m[36mINFO[0m[0m 03/24 16:26:31 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/24 16:26:31 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/24 16:26:31 | 
[37m[36mINFO[0m[0m 03/24 16:26:31 | Testenv name escaping te_L -> te_L
[37m[36mINFO[0m[0m 03/24 16:26:31 | Test envs = [1], name = te_L
[37m[36mINFO[0m[0m 03/24 16:26:31 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/24 16:26:31 | Batch sizes for each domain: [17, 0, 17, 17] (total=51)
[37m[36mINFO[0m[0m 03/24 16:26:31 | steps-per-epoch for each domain: 66.59, 154.47, 158.88 -> min = 66.59
[37m[36mINFO[0m[0m 03/24 16:26:32 | # of params = 23518277
[37m[36mINFO[0m[0m 03/24 16:28:46 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/24 16:28:46 | 0.459294    0.489642    0.480068    0.487365    1.291698    0.611307    0.628975    0.459294    0.489642    0.384615    0.387195    0.444280    0.445926    0           0.000000    1.752589    1.373584    132.207746 
[37m[36mINFO[0m[0m 03/24 16:31:32 | 0.552941    0.540490    0.884742    0.877461    0.330846    0.996466    1.000000    0.552941    0.540490    0.794745    0.782012    0.863014    0.850370    200         3.003534    0.395001    0.165412    132.875547 
[37m[36mINFO[0m[0m 03/24 16:34:22 | 0.617882    0.613936    0.908073    0.880889    0.324128    0.998233    1.000000    0.617882    0.613936    0.838538    0.778963    0.887449    0.863704    400         6.007067    0.260019    0.178039    134.331794 
[37m[36mINFO[0m[0m 03/24 16:37:11 | 0.699294    0.700565    0.898606    0.865802    0.382558    0.998233    1.000000    0.699294    0.700565    0.815689    0.750000    0.881896    0.847407    600         9.010601    0.214776    0.171571    134.686546 
[37m[36mINFO[0m[0m 03/24 16:40:02 | 0.696941    0.700565    0.935735    0.888382    0.305695    1.000000    1.000000    0.696941    0.700565    0.883473    0.788110    0.923732    0.877037    800         12.014134   0.198407    0.175478    135.739197 
[37m[36mINFO[0m[0m 03/24 16:42:45 | 0.645176    0.642185    0.940216    0.882352    0.368706    0.998233    0.996466    0.645176    0.642185    0.897944    0.797256    0.924472    0.853333    1000        15.017668   0.164038    0.156860    132.049942 
[37m[36mINFO[0m[0m 03/24 16:45:36 | 0.671059    0.685499    0.943698    0.894394    0.351566    0.999117    1.000000    0.671059    0.685499    0.895659    0.797256    0.936320    0.885926    1200        18.021201   0.152743    0.176863    135.899597 
[37m[36mINFO[0m[0m 03/24 16:48:19 | 0.626824    0.621469    0.953640    0.875495    0.392233    1.000000    0.989399    0.626824    0.621469    0.911272    0.791159    0.949648    0.845926    1400        21.024735   0.131218    0.150422    132.545494 
[37m[36mINFO[0m[0m 03/24 16:51:08 | 0.616941    0.606403    0.965322    0.885548    0.358265    1.000000    1.000000    0.616941    0.606403    0.933359    0.801829    0.962606    0.854815    1600        24.028269   0.120781    0.173471    134.039023 
[37m[36mINFO[0m[0m 03/24 16:53:56 | 0.645647    0.634652    0.965225    0.888173    0.359994    0.997350    0.992933    0.645647    0.634652    0.938309    0.806402    0.960015    0.865185    1800        27.031802   0.114141    0.154267    137.454991 
[37m[36mINFO[0m[0m 03/24 16:56:48 | 0.640941    0.627119    0.953132    0.873566    0.404210    0.998233    0.992933    0.640941    0.627119    0.906702    0.775915    0.954461    0.851852    2000        30.035336   0.106591    0.164513    139.428826 
[37m[36mINFO[0m[0m 03/24 16:59:36 | 0.623059    0.608286    0.962494    0.887495    0.444900    0.998233    1.000000    0.623059    0.608286    0.944783    0.798780    0.944465    0.863704    2200        33.038869   0.093799    0.170234    133.751719 
[37m[36mINFO[0m[0m 03/24 17:02:23 | 0.629176    0.638418    0.981859    0.891412    0.394020    0.998233    0.996466    0.629176    0.638418    0.970297    0.815549    0.977046    0.862222    2400        36.042403   0.095699    0.157992    134.670689 
[37m[36mINFO[0m[0m 03/24 17:05:11 | 0.609882    0.608286    0.977735    0.885182    0.464122    0.999117    0.992933    0.609882    0.608286    0.959634    0.803354    0.974454    0.859259    2600        39.045936   0.068910    0.174943    133.190835 
[37m[36mINFO[0m[0m 03/24 17:07:58 | 0.666824    0.668550    0.961041    0.879099    0.478464    0.998233    0.992933    0.666824    0.668550    0.934501    0.786585    0.950389    0.857778    2800        42.049470   0.079304    0.150573    137.487527 
[37m[36mINFO[0m[0m 03/24 17:10:51 | 0.628706    0.632768    0.984801    0.877807    0.489619    0.999117    0.996466    0.628706    0.632768    0.976390    0.786585    0.978897    0.850370    3000        45.053004   0.058533    0.180343    136.787852 
[37m[36mINFO[0m[0m 03/24 17:13:40 | 0.671059    0.670433    0.946126    0.861775    0.671065    1.000000    0.989399    0.671059    0.670433    0.899467    0.750000    0.938912    0.845926    3200        48.056537   0.056049    0.149340    139.219092 
[37m[36mINFO[0m[0m 03/24 17:16:29 | 0.577882    0.576271    0.980602    0.869151    0.490747    0.999117    0.992933    0.577882    0.576271    0.962681    0.778963    0.980007    0.835556    3400        51.060071   0.058465    0.167857    135.393711 
[37m[36mINFO[0m[0m 03/24 17:19:13 | 0.627765    0.636535    0.984399    0.881478    0.538943    0.999117    0.989399    0.627765    0.636535    0.972963    0.797256    0.981118    0.857778    3600        54.063604   0.045453    0.147205    134.229775 
[37m[36mINFO[0m[0m 03/24 17:22:01 | 0.650353    0.642185    0.992740    0.887214    0.605321    1.000000    0.992933    0.650353    0.642185    0.988957    0.809451    0.989263    0.859259    3800        57.067138   0.041312    0.164989    134.549107 
[37m[36mINFO[0m[0m 03/24 17:24:45 | 0.637176    0.661017    0.982285    0.874644    0.569643    1.000000    0.996466    0.637176    0.661017    0.966108    0.765244    0.980748    0.862222    4000        60.070671   0.046886    0.149344    134.273062 
[37m[36mINFO[0m[0m 03/24 17:27:33 | 0.601412    0.589454    0.989184    0.881815    0.599373    0.999117    0.996466    0.601412    0.589454    0.983244    0.792683    0.985191    0.856296    4200        63.074205   0.031221    0.165738    134.786218 
[37m[36mINFO[0m[0m 03/24 17:30:21 | 0.626824    0.645951    0.978116    0.870513    0.506942    0.995583    0.989399    0.626824    0.645951    0.968012    0.786585    0.970752    0.835556    4400        66.077739   0.050716    0.167182    135.192989 
[37m[36mINFO[0m[0m 03/24 17:33:11 | 0.642353    0.644068    0.987384    0.885794    0.575336    1.000000    0.996466    0.642353    0.644068    0.970297    0.795732    0.991855    0.865185    4600        69.081272   0.035411    0.170883    135.340482 
[37m[36mINFO[0m[0m 03/24 17:35:59 | 0.624471    0.602637    0.990744    0.880842    0.518126    1.000000    0.996466    0.624471    0.602637    0.986672    0.794207    0.985561    0.851852    4800        72.084806   0.037046    0.171275    134.261608 
[37m[36mINFO[0m[0m 03/24 17:38:52 | 0.603294    0.606403    0.992126    0.880813    0.571021    1.000000    0.996466    0.603294    0.606403    0.989337    0.791159    0.987042    0.854815    5000        75.088339   0.026131    0.164485    140.006437 
[37m[36mINFO[0m[0m 03/24 17:38:52 | Cumulative gradient change saved at train_output/VLCS/ERM/[1]/250324_16-26-31_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/24 17:38:54 | ---
[37m[36mINFO[0m[0m 03/24 17:38:54 | test-domain validation(oracle) = 69.929%
[37m[36mINFO[0m[0m 03/24 17:38:54 | training-domain validation(iid) = 67.106%
[37m[36mINFO[0m[0m 03/24 17:38:54 | last = 60.329%
[37m[36mINFO[0m[0m 03/24 17:38:54 | last (inD) = 88.081%
[37m[36mINFO[0m[0m 03/24 17:38:54 | training-domain validation (iid, inD) = 89.439%
[37m[36mINFO[0m[0m 03/24 17:38:54 | === Summary ===
[37m[36mINFO[0m[0m 03/24 17:38:54 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 0 --hparams_seed 16
[37m[36mINFO[0m[0m 03/24 17:38:54 | Unique name: 250324_16-26-31_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 17:38:54 | Out path: train_output/VLCS/ERM/[1]/250324_16-26-31_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 17:38:54 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/24 17:38:54 | Dataset: VLCS

[37m[36mINFO[0m[0m 03/25 13:54:25 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 1 --hparams_seed 12
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 12
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[1]/250325_13-54-25_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250325_13-54-25_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 3.0065625733392338e-05
	batch_size: 34
	weight_decay: 4.89485556145273e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/25 13:54:25 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 13:54:25 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 13:54:25 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 13:54:25 | 
[37m[36mINFO[0m[0m 03/25 13:54:25 | Testenv name escaping te_L -> te_L
[37m[36mINFO[0m[0m 03/25 13:54:25 | Test envs = [1], name = te_L
[37m[36mINFO[0m[0m 03/25 13:54:25 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/25 13:54:25 | Batch sizes for each domain: [34, 0, 34, 34] (total=102)
[37m[36mINFO[0m[0m 03/25 13:54:25 | steps-per-epoch for each domain: 33.29, 77.24, 79.44 -> min = 33.29
[37m[36mINFO[0m[0m 03/25 13:54:27 | # of params = 23518277
[37m[36mINFO[0m[0m 03/25 13:57:09 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 13:57:09 | 0.466824    0.461394    0.481371    0.481169    1.404416    0.613958    0.618375    0.466824    0.461394    0.376618    0.419207    0.453536    0.405926    0           0.000000    1.791954    1.308509    160.569890 
[37m[36mINFO[0m[0m 03/25 14:01:07 | 0.665882    0.638418    0.904145    0.900426    0.294745    0.998233    0.992933    0.665882    0.638418    0.827494    0.849085    0.886709    0.859259    200         6.007067    0.371821    0.406692    156.673249 
[37m[36mINFO[0m[0m 03/25 14:05:05 | 0.676235    0.664783    0.930793    0.910232    0.258079    0.999117    1.000000    0.676235    0.664783    0.874714    0.853659    0.918549    0.877037    400         12.014134   0.222684    0.403480    157.637330 
[37m[36mINFO[0m[0m 03/25 14:08:58 | 0.650353    0.638418    0.931495    0.887229    0.312482    0.997350    0.992933    0.650353    0.638418    0.880807    0.810976    0.916327    0.857778    600         18.021201   0.186968    0.373961    158.824339 
[37m[36mINFO[0m[0m 03/25 14:13:00 | 0.618353    0.598870    0.943989    0.896898    0.308314    1.000000    0.992933    0.618353    0.598870    0.895278    0.841463    0.936690    0.856296    800         24.028269   0.158749    0.417069    158.377093 
[37m[36mINFO[0m[0m 03/25 14:16:50 | 0.608941    0.591337    0.961029    0.890136    0.331740    0.999117    1.000000    0.608941    0.591337    0.928027    0.817073    0.955942    0.853333    1000        30.035336   0.124280    0.362013    157.783997 
[37m[36mINFO[0m[0m 03/25 14:20:55 | 0.673412    0.657250    0.971736    0.891788    0.339236    1.000000    0.992933    0.673412    0.657250    0.946306    0.823171    0.968900    0.859259    1200        36.042403   0.102317    0.447914    154.559458 
[37m[36mINFO[0m[0m 03/25 14:24:42 | 0.604706    0.593220    0.969562    0.894370    0.351080    0.999117    0.985866    0.604706    0.593220    0.943260    0.823171    0.966309    0.874074    1400        42.049470   0.089931    0.358356    155.750539 
[37m[36mINFO[0m[0m 03/25 14:28:38 | 0.614588    0.606403    0.981541    0.888667    0.416827    1.000000    0.992933    0.614588    0.606403    0.965727    0.806402    0.978897    0.866667    1600        48.056537   0.070096    0.388257    158.658607 
[37m[36mINFO[0m[0m 03/25 14:32:33 | 0.671529    0.642185    0.985547    0.896261    0.402858    1.000000    0.992933    0.671529    0.642185    0.971820    0.826220    0.984820    0.869630    1800        54.063604   0.056856    0.393894    155.751875 
[37m[36mINFO[0m[0m 03/25 14:36:32 | 0.656000    0.636535    0.981633    0.896898    0.385448    1.000000    0.992933    0.656000    0.636535    0.962300    0.841463    0.982599    0.856296    2000        60.070671   0.048958    0.456069    148.122702 
[37m[36mINFO[0m[0m 03/25 14:40:18 | 0.655059    0.634652    0.990452    0.894793    0.483520    1.000000    0.992933    0.655059    0.634652    0.981721    0.827744    0.989633    0.863704    2200        66.077739   0.037886    0.373110    150.725783 
[37m[36mINFO[0m[0m 03/25 14:44:09 | 0.656941    0.644068    0.992712    0.894865    0.523821    1.000000    0.992933    0.656941    0.644068    0.985910    0.835366    0.992225    0.856296    2400        72.084806   0.040122    0.404475    150.539758 
[37m[36mINFO[0m[0m 03/25 14:48:13 | 0.648941    0.638418    0.991220    0.893925    0.486328    1.000000    0.996466    0.648941    0.638418    0.984768    0.820122    0.988893    0.865185    2600        78.091873   0.030819    0.469496    149.830235 
[37m[36mINFO[0m[0m 03/25 14:52:03 | 0.640471    0.623352    0.995607    0.893398    0.498725    1.000000    0.992933    0.640471    0.623352    0.992003    0.836890    0.994817    0.850370    2800        84.098940   0.026390    0.397784    150.207068 
[37m[36mINFO[0m[0m 03/25 14:55:45 | 0.666824    0.649718    0.994572    0.892642    0.554694    0.999117    0.989399    0.666824    0.649718    0.992003    0.829268    0.992595    0.859259    3000        90.106007   0.021198    0.364079    149.824208 
[37m[36mINFO[0m[0m 03/25 14:59:42 | 0.658353    0.649718    0.995480    0.893892    0.570445    1.000000    0.992933    0.658353    0.649718    0.991622    0.836890    0.994817    0.851852    3200        96.113074   0.025407    0.438888    148.906886 
[37m[36mINFO[0m[0m 03/25 15:03:29 | 0.643765    0.617702    0.993519    0.893730    0.581680    0.998233    0.989399    0.643765    0.617702    0.990099    0.839939    0.992225    0.851852    3400        102.120141  0.033637    0.416057    143.863515 
[37m[36mINFO[0m[0m 03/25 15:07:13 | 0.554353    0.544256    0.989302    0.881203    0.662091    1.000000    0.992933    0.554353    0.544256    0.977532    0.800305    0.990374    0.850370    3600        108.127208  0.018752    0.376106    149.215316 
[37m[36mINFO[0m[0m 03/25 15:10:50 | 0.622588    0.602637    0.995229    0.884788    0.605315    1.000000    0.992933    0.622588    0.602637    0.991241    0.814024    0.994447    0.847407    3800        114.134276  0.016671    0.349459    146.290278 
[37m[36mINFO[0m[0m 03/25 15:14:42 | 0.632471    0.619586    0.998069    0.894010    0.628559    0.999117    0.996466    0.632471    0.619586    0.996573    0.829268    0.998519    0.856296    4000        120.141343  0.014913    0.414367    149.238290 
[37m[36mINFO[0m[0m 03/25 15:18:28 | 0.630588    0.612053    0.997602    0.902548    0.490471    1.000000    0.996466    0.630588    0.612053    0.994288    0.844512    0.998519    0.866667    4200        126.148410  0.024054    0.376178    151.208309 
[37m[36mINFO[0m[0m 03/25 15:22:19 | 0.596235    0.587571    0.994510    0.886664    0.631106    1.000000    1.000000    0.596235    0.587571    0.993526    0.815549    0.990004    0.844444    4400        132.155477  0.016117    0.404847    149.865377 
[37m[36mINFO[0m[0m 03/25 15:25:58 | 0.654118    0.634652    0.995987    0.894709    0.627136    1.000000    1.000000    0.654118    0.634652    0.993145    0.830793    0.994817    0.853333    4600        138.162544  0.011213    0.381133    142.333306 
[37m[36mINFO[0m[0m 03/25 15:29:26 | 0.610824    0.602637    0.995508    0.889437    0.606643    1.000000    0.996466    0.610824    0.602637    0.994669    0.815549    0.991855    0.856296    4800        144.169611  0.010366    0.360070    136.083818 
[37m[36mINFO[0m[0m 03/25 15:33:08 | 0.652235    0.613936    0.995882    0.892599    0.661569    1.000000    0.989399    0.652235    0.613936    0.995050    0.824695    0.992595    0.863704    5000        150.176678  0.010404    0.425514    137.617043 
[37m[36mINFO[0m[0m 03/25 15:33:08 | Cumulative gradient change saved at train_output/VLCS/ERM/[1]/250325_13-54-25_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 15:33:10 | ---
[37m[36mINFO[0m[0m 03/25 15:33:10 | test-domain validation(oracle) = 67.624%
[37m[36mINFO[0m[0m 03/25 15:33:10 | training-domain validation(iid) = 67.624%
[37m[36mINFO[0m[0m 03/25 15:33:10 | last = 65.224%
[37m[36mINFO[0m[0m 03/25 15:33:10 | last (inD) = 89.260%
[37m[36mINFO[0m[0m 03/25 15:33:10 | training-domain validation (iid, inD) = 91.023%
[37m[36mINFO[0m[0m 03/25 15:33:10 | === Summary ===
[37m[36mINFO[0m[0m 03/25 15:33:10 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 1 --hparams_seed 12
[37m[36mINFO[0m[0m 03/25 15:33:10 | Unique name: 250325_13-54-25_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 15:33:10 | Out path: train_output/VLCS/ERM/[1]/250325_13-54-25_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 15:33:10 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 15:33:10 | Dataset: VLCS

[37m[36mINFO[0m[0m 03/26 09:43:49 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 2 --hparams_seed 9
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 9
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[1]/250326_09-43-49_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 2
	unique_name: 250326_09-43-49_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.716671579524612e-05
	batch_size: 29
	weight_decay: 1.71368232883332e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/26 09:43:49 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 09:43:49 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 09:43:49 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 09:43:49 | 
[37m[36mINFO[0m[0m 03/26 09:43:49 | Testenv name escaping te_L -> te_L
[37m[36mINFO[0m[0m 03/26 09:43:49 | Test envs = [1], name = te_L
[37m[36mINFO[0m[0m 03/26 09:43:49 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/26 09:43:49 | Batch sizes for each domain: [29, 0, 29, 29] (total=87)
[37m[36mINFO[0m[0m 03/26 09:43:49 | steps-per-epoch for each domain: 39.03, 90.55, 93.14 -> min = 39.03
[37m[36mINFO[0m[0m 03/26 09:43:50 | # of params = 23518277
[37m[36mINFO[0m[0m 03/26 09:46:04 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 09:46:04 | 0.467294    0.459510    0.484066    0.470377    1.346522    0.620141    0.593640    0.467294    0.459510    0.391851    0.358232    0.440207    0.459259    0           0.000000    1.812847    1.231132    133.007233 
[37m[36mINFO[0m[0m 03/26 09:49:00 | 0.598588    0.638418    0.905870    0.894959    0.280592    1.000000    1.000000    0.598588    0.638418    0.843488    0.804878    0.874121    0.880000    200         5.123675    0.373573    0.215440    132.366472 
[37m[36mINFO[0m[0m 03/26 09:51:57 | 0.663529    0.693032    0.916338    0.898123    0.293079    1.000000    1.000000    0.663529    0.693032    0.854532    0.826220    0.894484    0.868148    400         10.247350   0.224184    0.217828    133.327065 
[37m[36mINFO[0m[0m 03/26 09:54:54 | 0.653647    0.672316    0.935366    0.890876    0.293023    0.999117    0.996466    0.653647    0.672316    0.888804    0.810976    0.918178    0.865185    600         15.371025   0.199874    0.220642    133.378194 
[37m[36mINFO[0m[0m 03/26 09:57:50 | 0.661176    0.687382    0.933910    0.890557    0.323767    0.999117    0.992933    0.661176    0.687382    0.878142    0.797256    0.924472    0.881481    800         20.494700   0.162936    0.217961    131.799324 
[37m[36mINFO[0m[0m 03/26 10:00:47 | 0.606118    0.627119    0.949871    0.895263    0.350247    1.000000    0.996466    0.606118    0.627119    0.904037    0.804878    0.945576    0.884444    1000        25.618375   0.136163    0.217680    133.767655 
[37m[36mINFO[0m[0m 03/26 10:03:45 | 0.601882    0.625235    0.960823    0.885267    0.350232    1.000000    0.985866    0.601882    0.625235    0.927266    0.800305    0.955202    0.869630    1200        30.742049   0.106803    0.223937    132.978757 
[37m[36mINFO[0m[0m 03/26 10:06:42 | 0.672471    0.694915    0.973132    0.897410    0.355853    1.000000    0.996466    0.672471    0.694915    0.950495    0.823171    0.968900    0.872593    1400        35.865724   0.095943    0.213906    134.193119 
[37m[36mINFO[0m[0m 03/26 10:09:37 | 0.594353    0.630885    0.970050    0.891935    0.381094    1.000000    0.996466    0.594353    0.630885    0.950876    0.818598    0.959274    0.860741    1600        40.989399   0.072276    0.208731    133.890087 
[37m[36mINFO[0m[0m 03/26 10:12:33 | 0.647059    0.691149    0.983470    0.893981    0.382802    0.998233    0.989399    0.647059    0.691149    0.971059    0.814024    0.981118    0.878519    1800        46.113074   0.058931    0.214626    132.786082 
[37m[36mINFO[0m[0m 03/26 10:15:33 | 0.560471    0.580038    0.976321    0.882347    0.456645    0.999117    0.985866    0.560471    0.580038    0.953542    0.804878    0.976305    0.856296    2000        51.236749   0.064062    0.220543    135.727091 
[37m[36mINFO[0m[0m 03/26 10:18:29 | 0.638588    0.661017    0.974234    0.894024    0.461015    0.999117    0.989399    0.638588    0.661017    0.954684    0.818598    0.968900    0.874074    2200        56.360424   0.042026    0.212106    133.372081 
[37m[36mINFO[0m[0m 03/26 10:21:25 | 0.668235    0.696798    0.985815    0.887214    0.513864    1.000000    0.992933    0.668235    0.696798    0.974105    0.809451    0.983340    0.859259    2400        61.484099   0.044032    0.213350    133.533106 
[37m[36mINFO[0m[0m 03/26 10:24:23 | 0.587294    0.604520    0.984962    0.890452    0.529284    1.000000    0.989399    0.587294    0.604520    0.975248    0.806402    0.979637    0.875556    2600        66.607774   0.038029    0.221750    133.908556 
[37m[36mINFO[0m[0m 03/26 10:27:21 | 0.629647    0.668550    0.993498    0.897990    0.548560    1.000000    0.996466    0.629647    0.668550    0.990861    0.832317    0.989633    0.865185    2800        71.731449   0.032515    0.224087    133.003904 
[37m[36mINFO[0m[0m 03/26 10:30:24 | 0.638588    0.666667    0.992474    0.893891    0.525339    0.999117    0.985866    0.638588    0.666667    0.992003    0.824695    0.986301    0.871111    3000        76.855124   0.024079    0.225574    137.590533 
[37m[36mINFO[0m[0m 03/26 10:33:23 | 0.595294    0.619586    0.993131    0.893098    0.483116    0.998233    1.000000    0.595294    0.619586    0.988195    0.817073    0.992966    0.862222    3200        81.978799   0.023244    0.227245    133.637971 
[37m[36mINFO[0m[0m 03/26 10:36:17 | 0.624000    0.657250    0.996619    0.895767    0.551034    1.000000    0.992933    0.624000    0.657250    0.994669    0.826220    0.995187    0.868148    3400        87.102473   0.018424    0.212736    131.207324 
[37m[36mINFO[0m[0m 03/26 10:39:14 | 0.650353    0.689266    0.993406    0.896289    0.519567    1.000000    0.992933    0.650353    0.689266    0.994288    0.829268    0.985931    0.866667    3600        92.226148   0.015868    0.217993    133.398222 
[37m[36mINFO[0m[0m 03/26 10:42:11 | 0.620235    0.651601    0.996883    0.901793    0.540095    1.000000    0.992933    0.620235    0.651601    0.996573    0.836890    0.994076    0.875556    3800        97.349823   0.022186    0.220755    133.032513 
[37m[36mINFO[0m[0m 03/26 10:45:08 | 0.626824    0.655367    0.994894    0.899500    0.593386    1.000000    0.996466    0.626824    0.655367    0.995050    0.835366    0.989633    0.866667    4000        102.473498  0.022676    0.215236    133.672344 
[37m[36mINFO[0m[0m 03/26 10:48:02 | 0.642824    0.672316    0.990806    0.884688    0.570971    0.999117    0.992933    0.642824    0.672316    0.985149    0.803354    0.988153    0.857778    4200        107.597173  0.018671    0.216940    131.148039 
[37m[36mINFO[0m[0m 03/26 10:50:57 | 0.659765    0.681733    0.987974    0.889973    0.647740    0.997350    0.989399    0.659765    0.681733    0.982864    0.807927    0.983710    0.872593    4400        112.720848  0.016793    0.217667    131.200978 
[37m[36mINFO[0m[0m 03/26 10:53:54 | 0.640000    0.670433    0.994836    0.895130    0.565472    0.999117    0.992933    0.640000    0.670433    0.993907    0.810976    0.991485    0.881481    4600        117.844523  0.019196    0.216486    133.680947 
[37m[36mINFO[0m[0m 03/26 10:56:46 | 0.653176    0.679849    0.996615    0.896670    0.554663    1.000000    1.000000    0.653176    0.679849    0.994288    0.829268    0.995557    0.860741    4800        122.968198  0.016797    0.210557    130.598458 
[37m[36mINFO[0m[0m 03/26 10:59:42 | 0.645647    0.664783    0.998382    0.902695    0.589371    1.000000    0.992933    0.645647    0.664783    0.998477    0.827744    0.996668    0.887407    5000        128.091873  0.008921    0.218643    131.782662 
[37m[36mINFO[0m[0m 03/26 10:59:42 | Cumulative gradient change saved at train_output/VLCS/ERM/[1]/250326_09-43-49_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 10:59:44 | ---
[37m[36mINFO[0m[0m 03/26 10:59:44 | test-domain validation(oracle) = 66.824%
[37m[36mINFO[0m[0m 03/26 10:59:44 | training-domain validation(iid) = 64.565%
[37m[36mINFO[0m[0m 03/26 10:59:44 | last = 64.565%
[37m[36mINFO[0m[0m 03/26 10:59:44 | last (inD) = 90.269%
[37m[36mINFO[0m[0m 03/26 10:59:44 | training-domain validation (iid, inD) = 90.269%
[37m[36mINFO[0m[0m 03/26 10:59:44 | === Summary ===
[37m[36mINFO[0m[0m 03/26 10:59:44 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 2 --hparams_seed 9
[37m[36mINFO[0m[0m 03/26 10:59:44 | Unique name: 250326_09-43-49_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 10:59:44 | Out path: train_output/VLCS/ERM/[1]/250326_09-43-49_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 10:59:44 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 10:59:44 | Dataset: VLCS

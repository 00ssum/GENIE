[37m[36mINFO[0m[0m 03/25 09:34:15 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 1 --hparams_seed 9
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 9
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[1]/250325_09-34-15_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250325_09-34-15_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.7532223448653515e-05
	batch_size: 36
	weight_decay: 0.007511403320794324
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/25 09:34:15 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 09:34:15 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 09:34:15 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 09:34:15 | 
[37m[36mINFO[0m[0m 03/25 09:34:15 | Testenv name escaping te_L -> te_L
[37m[36mINFO[0m[0m 03/25 09:34:15 | Test envs = [1], name = te_L
[37m[36mINFO[0m[0m 03/25 09:34:15 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/25 09:34:15 | Batch sizes for each domain: [36, 0, 36, 36] (total=108)
[37m[36mINFO[0m[0m 03/25 09:34:15 | steps-per-epoch for each domain: 31.44, 72.94, 75.03 -> min = 31.44
[37m[36mINFO[0m[0m 03/25 09:34:17 | # of params = 23518277
[37m[36mINFO[0m[0m 03/25 09:36:53 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 09:36:53 | 0.466824    0.461394    0.481371    0.481169    1.416977    0.613958    0.618375    0.466824    0.461394    0.376618    0.419207    0.453536    0.405926    0           0.000000    1.818775    1.221041    155.023003 
[37m[36mINFO[0m[0m 03/25 09:40:28 | 0.627294    0.606403    0.905901    0.897149    0.290093    1.000000    1.000000    0.627294    0.606403    0.833587    0.827744    0.884117    0.863704    200         6.360424    0.405338    0.309292    153.545877 
[37m[36mINFO[0m[0m 03/25 09:44:16 | 0.692235    0.668550    0.918909    0.898859    0.284656    0.998233    0.992933    0.692235    0.668550    0.862529    0.839939    0.895964    0.863704    400         12.720848   0.238881    0.341736    159.661737 
[37m[36mINFO[0m[0m 03/25 09:48:05 | 0.692706    0.664783    0.921509    0.891408    0.316299    0.999117    0.992933    0.692706    0.664783    0.858340    0.835366    0.907071    0.845926    600         19.081272   0.216003    0.338105    160.983183 
[37m[36mINFO[0m[0m 03/25 09:51:45 | 0.669176    0.653484    0.947551    0.893701    0.302515    0.998233    0.989399    0.669176    0.653484    0.903656    0.836890    0.940763    0.854815    800         25.441696   0.185315    0.316557    156.943224 
[37m[36mINFO[0m[0m 03/25 09:55:26 | 0.690824    0.677966    0.929436    0.889941    0.367017    0.997350    0.992933    0.690824    0.677966    0.871668    0.836890    0.919289    0.840000    1000        31.802120   0.161377    0.295307    162.001285 
[37m[36mINFO[0m[0m 03/25 09:59:11 | 0.653176    0.653484    0.943443    0.889594    0.380380    0.998233    0.989399    0.653176    0.653484    0.899848    0.820122    0.932247    0.859259    1200        38.162544   0.143783    0.326199    159.161583 
[37m[36mINFO[0m[0m 03/25 10:02:47 | 0.676706    0.677966    0.952885    0.875244    0.368910    0.998233    0.989399    0.676706    0.677966    0.920030    0.817073    0.940392    0.819259    1400        44.522968   0.128862    0.316104    153.554295 
[37m[36mINFO[0m[0m 03/25 10:06:24 | 0.655529    0.647834    0.965695    0.887966    0.357639    1.000000    0.992933    0.655529    0.647834    0.933740    0.836890    0.963347    0.834074    1600        50.883392   0.130507    0.298171    157.348831 
[37m[36mINFO[0m[0m 03/25 10:10:11 | 0.617882    0.604520    0.970658    0.872832    0.369146    0.999117    0.989399    0.617882    0.604520    0.955065    0.823171    0.957793    0.805926    1800        57.243816   0.117505    0.319500    163.068147 
[37m[36mINFO[0m[0m 03/25 10:13:52 | 0.656471    0.655367    0.959012    0.878905    0.419268    0.999117    0.992933    0.656471    0.655367    0.936786    0.818598    0.941133    0.825185    2000        63.604240   0.119903    0.308074    158.461804 
[37m[36mINFO[0m[0m 03/25 10:17:31 | 0.657882    0.655367    0.961854    0.876374    0.411126    0.997350    0.982332    0.657882    0.655367    0.934120    0.820122    0.954091    0.826667    2200        69.964664   0.119257    0.311030    157.072743 
[37m[36mINFO[0m[0m 03/25 10:21:09 | 0.652235    0.653484    0.967508    0.884637    0.410218    1.000000    0.985866    0.652235    0.653484    0.942879    0.838415    0.959645    0.829630    2400        76.325088   0.098997    0.320851    154.244290 
[37m[36mINFO[0m[0m 03/25 10:24:44 | 0.633882    0.632768    0.954911    0.875315    0.475365    0.999117    0.989399    0.633882    0.632768    0.920411    0.824695    0.945205    0.811852    2600        82.685512   0.095994    0.295101    155.502841 
[37m[36mINFO[0m[0m 03/25 10:28:11 | 0.656941    0.653484    0.971693    0.872062    0.436874    1.000000    0.985866    0.656941    0.653484    0.955065    0.814024    0.960015    0.816296    2800        89.045936   0.112001    0.321724    143.150157 
[37m[36mINFO[0m[0m 03/25 10:31:24 | 0.585412    0.574388    0.956768    0.853695    0.471774    1.000000    0.989399    0.585412    0.574388    0.929170    0.783537    0.941133    0.788148    3000        95.406360   0.095630    0.294733    133.320958 
[37m[36mINFO[0m[0m 03/25 10:34:29 | 0.616471    0.615819    0.979301    0.865495    0.474449    0.999117    0.982332    0.616471    0.615819    0.968774    0.818598    0.970011    0.795556    3200        101.766784  0.093968    0.265098    132.662703 
[37m[36mINFO[0m[0m 03/25 10:37:34 | 0.601412    0.580038    0.944502    0.845180    0.512492    0.999117    0.978799    0.601412    0.580038    0.915842    0.778963    0.918549    0.777778    3400        108.127208  0.108309    0.267121    131.095847 
[37m[36mINFO[0m[0m 03/25 10:40:44 | 0.680471    0.685499    0.944287    0.848466    0.469189    0.999117    0.985866    0.680471    0.685499    0.892612    0.772866    0.941133    0.786667    3600        114.487633  0.113223    0.264903    136.908538 
[37m[36mINFO[0m[0m 03/25 10:43:52 | 0.636706    0.638418    0.962778    0.863562    0.406762    0.997350    0.975265    0.636706    0.638418    0.940594    0.810976    0.950389    0.804444    3800        120.848057  0.140288    0.272397    133.894544 
[37m[36mINFO[0m[0m 03/25 10:46:59 | 0.632941    0.630885    0.960227    0.858263    0.427946    1.000000    0.978799    0.632941    0.630885    0.929551    0.804878    0.951129    0.791111    4000        127.208481  0.129480    0.277371    131.739429 
[37m[36mINFO[0m[0m 03/25 10:50:13 | 0.599059    0.566855    0.937984    0.848120    0.601216    1.000000    0.971731    0.599059    0.566855    0.926504    0.817073    0.887449    0.755556    4200        133.568905  0.132678    0.285901    136.297468 
[37m[36mINFO[0m[0m 03/25 10:53:37 | 0.642353    0.642185    0.962952    0.866198    0.458570    1.000000    0.989399    0.642353    0.642185    0.930693    0.800305    0.958164    0.808889    4400        139.929329  0.131665    0.301106    144.348726 
[37m[36mINFO[0m[0m 03/25 10:57:22 | 0.611765    0.596987    0.965249    0.856505    0.480420    0.999117    0.975265    0.611765    0.596987    0.944021    0.795732    0.952610    0.798519    4600        146.289753  0.135873    0.312463    162.462483 
[37m[36mINFO[0m[0m 03/25 11:01:02 | 0.573176    0.555556    0.961836    0.840232    0.514526    0.999117    0.982332    0.573176    0.555556    0.921935    0.757622    0.964458    0.780741    4800        152.650177  0.120844    0.316633    156.901566 
[37m[36mINFO[0m[0m 03/25 11:04:34 | 0.604235    0.589454    0.957335    0.843305    0.464112    0.998233    0.978799    0.604235    0.589454    0.934120    0.789634    0.939652    0.761481    5000        159.010601  0.156741    0.316140    148.725058 
[37m[36mINFO[0m[0m 03/25 11:04:35 | Cumulative gradient change saved at train_output/VLCS/ERM/[1]/250325_09-34-15_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 11:04:36 | ---
[37m[36mINFO[0m[0m 03/25 11:04:36 | test-domain validation(oracle) = 68.047%
[37m[36mINFO[0m[0m 03/25 11:04:36 | training-domain validation(iid) = 69.224%
[37m[36mINFO[0m[0m 03/25 11:04:36 | last = 60.424%
[37m[36mINFO[0m[0m 03/25 11:04:36 | last (inD) = 84.330%
[37m[36mINFO[0m[0m 03/25 11:04:36 | training-domain validation (iid, inD) = 89.886%
[37m[36mINFO[0m[0m 03/25 11:04:36 | === Summary ===
[37m[36mINFO[0m[0m 03/25 11:04:36 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 1 --hparams_seed 9
[37m[36mINFO[0m[0m 03/25 11:04:36 | Unique name: 250325_09-34-15_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 11:04:36 | Out path: train_output/VLCS/ERM/[1]/250325_09-34-15_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 11:04:36 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 11:04:36 | Dataset: VLCS

[37m[36mINFO[0m[0m 03/25 19:26:31 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 1 --hparams_seed 16
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 16
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[1]/250325_19-26-31_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250325_19-26-31_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 1.3198033474735314e-05
	batch_size: 10
	weight_decay: 0.001844990356992375
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/25 19:26:31 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 19:26:31 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 19:26:31 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 19:26:31 | 
[37m[36mINFO[0m[0m 03/25 19:26:31 | Testenv name escaping te_L -> te_L
[37m[36mINFO[0m[0m 03/25 19:26:31 | Test envs = [1], name = te_L
[37m[36mINFO[0m[0m 03/25 19:26:31 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/25 19:26:31 | Batch sizes for each domain: [10, 0, 10, 10] (total=30)
[37m[36mINFO[0m[0m 03/25 19:26:31 | steps-per-epoch for each domain: 113.20, 262.60, 270.10 -> min = 113.20
[37m[36mINFO[0m[0m 03/25 19:26:32 | # of params = 23518277
[37m[36mINFO[0m[0m 03/25 19:28:47 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 19:28:47 | 0.466824    0.461394    0.481498    0.481677    1.345981    0.613958    0.618375    0.466824    0.461394    0.376999    0.420732    0.453536    0.405926    0           0.000000    1.807246    1.064306    133.508050 
[37m[36mINFO[0m[0m 03/25 19:31:31 | 0.644235    0.608286    0.867421    0.873938    0.374792    0.969965    0.992933    0.644235    0.608286    0.811120    0.815549    0.821177    0.813333    200         1.766784    0.425007    0.136486    136.319603 
[37m[36mINFO[0m[0m 03/25 19:34:08 | 0.641412    0.623352    0.892527    0.882714    0.335487    0.991166    1.000000    0.641412    0.623352    0.826733    0.815549    0.859682    0.832593    400         3.533569    0.342654    0.123988    132.686871 
[37m[36mINFO[0m[0m 03/25 19:36:49 | 0.640000    0.627119    0.891713    0.870742    0.357593    0.998233    0.989399    0.640000    0.627119    0.804265    0.810976    0.872640    0.811852    600         5.300353    0.288109    0.129243    134.964597 
[37m[36mINFO[0m[0m 03/25 19:39:29 | 0.695059    0.687382    0.899130    0.879180    0.348934    0.997350    0.989399    0.695059    0.687382    0.810739    0.815549    0.889300    0.832593    800         7.067138    0.294677    0.133789    133.372413 
[37m[36mINFO[0m[0m 03/25 19:42:10 | 0.628235    0.617702    0.904591    0.880430    0.320796    0.995583    0.992933    0.628235    0.617702    0.837776    0.823171    0.880415    0.825185    1000        8.833922    0.259705    0.138222    133.527869 
[37m[36mINFO[0m[0m 03/25 19:44:51 | 0.560471    0.564972    0.914632    0.862223    0.379804    0.996466    0.992933    0.560471    0.564972    0.850724    0.777439    0.896705    0.816296    1200        10.600707   0.233293    0.120538    136.258153 
[37m[36mINFO[0m[0m 03/25 19:47:31 | 0.645647    0.632768    0.940356    0.896233    0.298065    0.999117    1.000000    0.645647    0.632768    0.894516    0.835366    0.927434    0.853333    1400        12.367491   0.217780    0.133870    133.183491 
[37m[36mINFO[0m[0m 03/25 19:50:09 | 0.664941    0.659134    0.937812    0.895725    0.323625    1.000000    1.000000    0.664941    0.659134    0.881188    0.833841    0.932247    0.853333    1600        14.134276   0.176600    0.130187    132.628301 
[37m[36mINFO[0m[0m 03/25 19:52:49 | 0.616941    0.615819    0.900737    0.849578    0.391709    0.997350    1.000000    0.616941    0.615819    0.824448    0.757622    0.880415    0.791111    1800        15.901060   0.219011    0.134253    132.475112 
[37m[36mINFO[0m[0m 03/25 19:55:27 | 0.652235    0.645951    0.942258    0.880624    0.336053    1.000000    1.000000    0.652235    0.645951    0.894897    0.803354    0.931877    0.838519    2000        17.667845   0.198680    0.139563    130.282424 
[37m[36mINFO[0m[0m 03/25 19:58:10 | 0.602824    0.613936    0.949795    0.882533    0.328537    0.999117    0.985866    0.602824    0.613936    0.900990    0.824695    0.949278    0.837037    2200        19.434629   0.172639    0.123637    138.657711 
[37m[36mINFO[0m[0m 03/25 20:00:54 | 0.624941    0.627119    0.927674    0.872723    0.394776    1.000000    1.000000    0.624941    0.627119    0.879284    0.803354    0.903739    0.814815    2400        21.201413   0.153689    0.137166    136.378356 
[37m[36mINFO[0m[0m 03/25 20:03:35 | 0.657412    0.651601    0.957067    0.892486    0.341218    1.000000    0.996466    0.657412    0.651601    0.921554    0.824695    0.949648    0.856296    2600        22.968198   0.140014    0.135461    133.645971 
[37m[36mINFO[0m[0m 03/25 20:06:10 | 0.681882    0.674200    0.950070    0.886166    0.402877    0.997350    0.996466    0.681882    0.674200    0.914318    0.835366    0.938541    0.826667    2800        24.734982   0.139381    0.117786    132.059793 
[37m[36mINFO[0m[0m 03/25 20:08:53 | 0.627294    0.629002    0.963065    0.887040    0.349416    1.000000    0.996466    0.627294    0.629002    0.929551    0.823171    0.959645    0.841481    3000        26.501767   0.149124    0.142123    134.299502 
[37m[36mINFO[0m[0m 03/25 20:11:37 | 0.671059    0.668550    0.962765    0.895459    0.356866    1.000000    0.992933    0.671059    0.668550    0.923839    0.846037    0.964458    0.847407    3200        28.268551   0.134719    0.133242    137.249860 
[37m[36mINFO[0m[0m 03/25 20:14:16 | 0.640941    0.621469    0.969609    0.888996    0.359891    1.000000    0.992933    0.640941    0.621469    0.943260    0.841463    0.965568    0.832593    3400        30.035336   0.118521    0.116085    135.568897 
[37m[36mINFO[0m[0m 03/25 20:17:08 | 0.679059    0.674200    0.949538    0.866478    0.426270    0.999117    0.996466    0.679059    0.674200    0.899848    0.789634    0.949648    0.813333    3600        31.802120   0.098274    0.142714    143.816341 
[37m[36mINFO[0m[0m 03/25 20:19:50 | 0.651294    0.644068    0.969193    0.887614    0.418542    1.000000    0.985866    0.651294    0.644068    0.938309    0.839939    0.969271    0.837037    3800        33.568905   0.113084    0.139590    133.700582 
[37m[36mINFO[0m[0m 03/25 20:22:28 | 0.672941    0.674200    0.959035    0.881099    0.422291    1.000000    0.996466    0.672941    0.674200    0.920792    0.821646    0.956312    0.825185    4000        35.335689   0.119733    0.126369    133.270041 
[37m[36mINFO[0m[0m 03/25 20:25:15 | 0.647059    0.638418    0.966226    0.884813    0.380219    0.997350    0.989399    0.647059    0.638418    0.939832    0.836890    0.961496    0.828148    4200        37.102473   0.131128    0.136589    139.820941 
[37m[36mINFO[0m[0m 03/25 20:28:05 | 0.587765    0.580038    0.958756    0.872295    0.423507    0.998233    0.989399    0.587765    0.580038    0.927647    0.818598    0.950389    0.808889    4400        38.869258   0.117219    0.141885    141.564327 
[37m[36mINFO[0m[0m 03/25 20:30:42 | 0.622588    0.610169    0.975346    0.886166    0.402275    1.000000    0.996466    0.622588    0.610169    0.949733    0.835366    0.976305    0.826667    4600        40.636042   0.107233    0.116591    133.581486 
[37m[36mINFO[0m[0m 03/25 20:33:24 | 0.624941    0.632768    0.975413    0.886251    0.416965    0.998233    0.989399    0.624941    0.632768    0.953922    0.832317    0.974084    0.837037    4800        42.402827   0.101274    0.137874    134.374878 
[37m[36mINFO[0m[0m 03/25 20:36:11 | 0.624471    0.610169    0.975337    0.880956    0.421637    0.999117    0.996466    0.624471    0.610169    0.953922    0.806402    0.972973    0.840000    5000        44.169611   0.081359    0.136289    139.246038 
[37m[36mINFO[0m[0m 03/25 20:36:11 | Cumulative gradient change saved at train_output/VLCS/ERM/[1]/250325_19-26-31_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 20:36:12 | ---
[37m[36mINFO[0m[0m 03/25 20:36:12 | test-domain validation(oracle) = 69.506%
[37m[36mINFO[0m[0m 03/25 20:36:12 | training-domain validation(iid) = 64.565%
[37m[36mINFO[0m[0m 03/25 20:36:12 | last = 62.447%
[37m[36mINFO[0m[0m 03/25 20:36:12 | last (inD) = 88.096%
[37m[36mINFO[0m[0m 03/25 20:36:12 | training-domain validation (iid, inD) = 89.623%
[37m[36mINFO[0m[0m 03/25 20:36:12 | === Summary ===
[37m[36mINFO[0m[0m 03/25 20:36:12 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 1 --hparams_seed 16
[37m[36mINFO[0m[0m 03/25 20:36:12 | Unique name: 250325_19-26-31_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 20:36:12 | Out path: train_output/VLCS/ERM/[1]/250325_19-26-31_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 20:36:12 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 20:36:12 | Dataset: VLCS

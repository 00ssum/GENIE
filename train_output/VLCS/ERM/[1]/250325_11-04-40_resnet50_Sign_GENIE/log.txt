[37m[36mINFO[0m[0m 03/25 11:04:40 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 1 --hparams_seed 10
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 10
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[1]/250325_11-04-40_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250325_11-04-40_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.2128485336217652e-05
	batch_size: 9
	weight_decay: 0.00030907441430549757
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/25 11:04:40 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 11:04:40 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 11:04:40 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 11:04:40 | 
[37m[36mINFO[0m[0m 03/25 11:04:40 | Testenv name escaping te_L -> te_L
[37m[36mINFO[0m[0m 03/25 11:04:40 | Test envs = [1], name = te_L
[37m[36mINFO[0m[0m 03/25 11:04:40 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/25 11:04:40 | Batch sizes for each domain: [9, 0, 9, 9] (total=27)
[37m[36mINFO[0m[0m 03/25 11:04:40 | steps-per-epoch for each domain: 125.78, 291.78, 300.11 -> min = 125.78
[37m[36mINFO[0m[0m 03/25 11:04:42 | # of params = 23518277
[37m[36mINFO[0m[0m 03/25 11:07:25 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 11:07:25 | 0.466824    0.461394    0.484537    0.486716    1.344533    0.613958    0.618375    0.466824    0.461394    0.385377    0.431402    0.454276    0.410370    0           0.000000    1.910421    1.217222    161.637139 
[37m[36mINFO[0m[0m 03/25 11:10:29 | 0.585882    0.581921    0.876896    0.871621    0.342129    0.996466    1.000000    0.585882    0.581921    0.800457    0.791159    0.833765    0.823704    200         1.590106    0.500224    0.133953    157.616527 
[37m[36mINFO[0m[0m 03/25 11:13:37 | 0.565647    0.570621    0.886029    0.861297    0.374072    1.000000    0.996466    0.565647    0.570621    0.793222    0.763720    0.864865    0.823704    400         3.180212    0.344195    0.139420    159.828866 
[37m[36mINFO[0m[0m 03/25 11:16:42 | 0.580235    0.576271    0.887116    0.864241    0.373315    0.993816    0.992933    0.580235    0.576271    0.813404    0.782012    0.854128    0.817778    600         4.770318    0.324776    0.134971    158.596426 
[37m[36mINFO[0m[0m 03/25 11:19:48 | 0.647059    0.632768    0.905171    0.885468    0.334132    0.994700    0.992933    0.647059    0.632768    0.838919    0.833841    0.881896    0.829630    800         6.360424    0.301414    0.133226    158.944550 
[37m[36mINFO[0m[0m 03/25 11:22:48 | 0.612235    0.580038    0.911903    0.894252    0.307772    0.996466    0.989399    0.612235    0.580038    0.835872    0.842988    0.903369    0.850370    1000        7.950530    0.303395    0.133096    153.630429 
[37m[36mINFO[0m[0m 03/25 11:25:57 | 0.638588    0.615819    0.904336    0.873112    0.355324    1.000000    0.996466    0.638588    0.615819    0.824448    0.812500    0.888560    0.810370    1200        9.540636    0.258026    0.134330    161.969655 
[37m[36mINFO[0m[0m 03/25 11:28:57 | 0.664941    0.666667    0.921982    0.885130    0.344592    0.997350    0.985866    0.664941    0.666667    0.866337    0.838415    0.902258    0.831111    1400        11.130742   0.234789    0.134201    153.320739 
[37m[36mINFO[0m[0m 03/25 11:31:59 | 0.664471    0.666667    0.933288    0.886632    0.326176    1.000000    0.996466    0.664471    0.666667    0.885758    0.832317    0.914106    0.831111    1600        12.720848   0.231371    0.132309    155.740598 
[37m[36mINFO[0m[0m 03/25 11:34:59 | 0.675765    0.662900    0.910854    0.873904    0.357349    0.997350    0.982332    0.675765    0.662900    0.837395    0.820122    0.897816    0.819259    1800        14.310954   0.220430    0.132380    152.624923 
[37m[36mINFO[0m[0m 03/25 11:37:58 | 0.627294    0.608286    0.937399    0.884323    0.328224    0.996466    0.992933    0.627294    0.608286    0.897182    0.817073    0.918549    0.842963    2000        15.901060   0.185113    0.126665    153.856351 
[37m[36mINFO[0m[0m 03/25 11:40:58 | 0.631529    0.625235    0.931796    0.872893    0.346189    0.998233    0.992933    0.631529    0.625235    0.881569    0.809451    0.915587    0.816296    2200        17.491166   0.182774    0.139011    152.048201 
[37m[36mINFO[0m[0m 03/25 11:44:00 | 0.666353    0.644068    0.934520    0.875823    0.353733    0.997350    0.982332    0.666353    0.644068    0.887662    0.814024    0.918549    0.831111    2400        19.081272   0.202756    0.134085    155.318534 
[37m[36mINFO[0m[0m 03/25 11:46:57 | 0.648471    0.634652    0.947272    0.883753    0.365727    0.994700    0.989399    0.648471    0.634652    0.907464    0.829268    0.939652    0.832593    2600        20.671378   0.169939    0.128347    151.171655 
[37m[36mINFO[0m[0m 03/25 11:50:44 | 0.676706    0.655367    0.947256    0.887695    0.363014    0.999117    1.000000    0.676706    0.655367    0.906702    0.820122    0.935950    0.842963    2800        22.261484   0.172335    0.334968    160.437675 
[37m[36mINFO[0m[0m 03/25 11:54:12 | 0.659294    0.642185    0.946630    0.883288    0.351154    1.000000    0.989399    0.659294    0.642185    0.900609    0.832317    0.939282    0.828148    3000        23.851590   0.175422    0.274730    153.237680 
[37m[36mINFO[0m[0m 03/25 11:57:38 | 0.596706    0.581921    0.946472    0.873506    0.391173    1.000000    0.996466    0.596706    0.581921    0.896801    0.801829    0.942614    0.822222    3200        25.441696   0.173963    0.229817    159.383341 
[37m[36mINFO[0m[0m 03/25 12:00:59 | 0.663059    0.647834    0.952018    0.885624    0.393738    1.000000    0.985866    0.663059    0.647834    0.922696    0.838415    0.933358    0.832593    3400        27.031802   0.135750    0.219721    157.316500 
[37m[36mINFO[0m[0m 03/25 12:04:18 | 0.630588    0.632768    0.954832    0.876744    0.351905    1.000000    0.992933    0.630588    0.632768    0.920030    0.798780    0.944465    0.838519    3600        28.621908   0.130600    0.212729    156.124541 
[37m[36mINFO[0m[0m 03/25 12:07:37 | 0.662588    0.634652    0.945178    0.882405    0.430807    1.000000    0.992933    0.662588    0.634652    0.903656    0.823171    0.931877    0.831111    3800        30.212014   0.146027    0.216997    155.669884 
[37m[36mINFO[0m[0m 03/25 12:10:59 | 0.622118    0.619586    0.968488    0.889257    0.362520    1.000000    0.989399    0.622118    0.619586    0.942117    0.836890    0.963347    0.841481    4000        31.802120   0.132363    0.236108    155.403776 
[37m[36mINFO[0m[0m 03/25 12:14:27 | 0.658353    0.649718    0.967947    0.887234    0.384246    0.999117    0.978799    0.658353    0.649718    0.942117    0.839939    0.962606    0.842963    4200        33.392226   0.123550    0.241952    159.836265 
[37m[36mINFO[0m[0m 03/25 12:17:50 | 0.612706    0.612053    0.956352    0.872023    0.506890    1.000000    0.989399    0.612706    0.612053    0.924219    0.789634    0.944835    0.837037    4400        34.982332   0.121431    0.220535    158.049120 
[37m[36mINFO[0m[0m 03/25 12:21:09 | 0.673882    0.672316    0.939684    0.870319    0.459041    0.996466    0.982332    0.673882    0.672316    0.890708    0.806402    0.931877    0.822222    4600        36.572438   0.142430    0.207630    157.362499 
[37m[36mINFO[0m[0m 03/25 12:24:30 | 0.616000    0.617702    0.957956    0.877200    0.450707    1.000000    0.978799    0.616000    0.617702    0.924219    0.823171    0.949648    0.829630    4800        38.162544   0.121887    0.222296    157.442918 
[37m[36mINFO[0m[0m 03/25 12:27:46 | 0.614588    0.613936    0.961186    0.868117    0.377117    0.998233    0.996466    0.614588    0.613936    0.936786    0.806402    0.948538    0.801481    5000        39.752650   0.116414    0.205922    154.410352 
[37m[36mINFO[0m[0m 03/25 12:27:46 | Cumulative gradient change saved at train_output/VLCS/ERM/[1]/250325_11-04-40_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 12:27:48 | ---
[37m[36mINFO[0m[0m 03/25 12:27:48 | test-domain validation(oracle) = 67.388%
[37m[36mINFO[0m[0m 03/25 12:27:48 | training-domain validation(iid) = 61.224%
[37m[36mINFO[0m[0m 03/25 12:27:48 | last = 61.459%
[37m[36mINFO[0m[0m 03/25 12:27:48 | last (inD) = 86.812%
[37m[36mINFO[0m[0m 03/25 12:27:48 | training-domain validation (iid, inD) = 89.425%
[37m[36mINFO[0m[0m 03/25 12:27:48 | === Summary ===
[37m[36mINFO[0m[0m 03/25 12:27:48 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 1 --hparams_seed 10
[37m[36mINFO[0m[0m 03/25 12:27:48 | Unique name: 250325_11-04-40_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 12:27:48 | Out path: train_output/VLCS/ERM/[1]/250325_11-04-40_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 12:27:48 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 12:27:48 | Dataset: VLCS

[37m[36mINFO[0m[0m 03/25 18:03:13 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 1 --hparams_seed 15
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 15
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[1]/250325_18-03-13_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250325_18-03-13_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 1.7812453400894684e-05
	batch_size: 36
	weight_decay: 3.1651536009272826e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/25 18:03:13 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 18:03:13 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 18:03:13 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 18:03:13 | 
[37m[36mINFO[0m[0m 03/25 18:03:13 | Testenv name escaping te_L -> te_L
[37m[36mINFO[0m[0m 03/25 18:03:13 | Test envs = [1], name = te_L
[37m[36mINFO[0m[0m 03/25 18:03:13 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/25 18:03:13 | Batch sizes for each domain: [36, 0, 36, 36] (total=108)
[37m[36mINFO[0m[0m 03/25 18:03:13 | steps-per-epoch for each domain: 31.44, 72.94, 75.03 -> min = 31.44
[37m[36mINFO[0m[0m 03/25 18:03:15 | # of params = 23518277
[37m[36mINFO[0m[0m 03/25 18:05:35 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 18:05:35 | 0.466824    0.461394    0.481371    0.481169    1.437528    0.613958    0.618375    0.466824    0.461394    0.376618    0.419207    0.453536    0.405926    0           0.000000    1.797880    1.083505    139.783077 
[37m[36mINFO[0m[0m 03/25 18:08:51 | 0.626353    0.608286    0.912268    0.901243    0.278151    0.999117    1.000000    0.626353    0.608286    0.846535    0.842988    0.891151    0.860741    200         6.360424    0.372853    0.293678    137.278405 
[37m[36mINFO[0m[0m 03/25 18:12:03 | 0.702118    0.689266    0.913549    0.893008    0.298801    0.998233    0.996466    0.702118    0.689266    0.843488    0.827744    0.898926    0.854815    400         12.720848   0.219413    0.284408    134.691984 
[37m[36mINFO[0m[0m 03/25 18:15:24 | 0.684706    0.677966    0.932981    0.901864    0.319942    0.998233    0.992933    0.684706    0.677966    0.876238    0.844512    0.924472    0.868148    600         19.081272   0.180912    0.299055    141.351615 
[37m[36mINFO[0m[0m 03/25 18:18:43 | 0.656941    0.632768    0.952875    0.901647    0.298390    0.998233    0.996466    0.656941    0.632768    0.918888    0.853659    0.941503    0.854815    800         25.441696   0.151844    0.272917    143.935256 
[37m[36mINFO[0m[0m 03/25 18:21:59 | 0.700235    0.698682    0.944222    0.888882    0.391205    0.998233    0.992933    0.700235    0.698682    0.890708    0.829268    0.943725    0.844444    1000        31.802120   0.115944    0.290047    137.968665 
[37m[36mINFO[0m[0m 03/25 18:25:13 | 0.664000    0.647834    0.972508    0.897306    0.361438    0.998233    0.992933    0.664000    0.647834    0.946687    0.832317    0.972603    0.866667    1200        38.162544   0.089947    0.281009    137.718146 
[37m[36mINFO[0m[0m 03/25 18:28:35 | 0.688000    0.676083    0.977405    0.900645    0.430613    1.000000    0.996466    0.688000    0.676083    0.958873    0.852134    0.973343    0.853333    1400        44.522968   0.075761    0.298773    143.041416 
[37m[36mINFO[0m[0m 03/25 18:31:47 | 0.685176    0.655367    0.974339    0.887533    0.473899    0.999117    0.996466    0.685176    0.655367    0.952780    0.823171    0.971122    0.842963    1600        50.883392   0.063510    0.274665    136.440617 
[37m[36mINFO[0m[0m 03/25 18:35:02 | 0.667765    0.647834    0.981150    0.886835    0.456382    1.000000    0.992933    0.667765    0.647834    0.963442    0.821646    0.980007    0.845926    1800        57.243816   0.053347    0.287840    137.847107 
[37m[36mINFO[0m[0m 03/25 18:38:16 | 0.600941    0.593220    0.987962    0.884485    0.443981    1.000000    0.996466    0.600941    0.593220    0.979436    0.814024    0.984450    0.842963    2000        63.604240   0.042034    0.274298    138.643564 
[37m[36mINFO[0m[0m 03/25 18:41:28 | 0.640471    0.627119    0.988964    0.885354    0.474001    1.000000    0.992933    0.640471    0.627119    0.980960    0.821646    0.985931    0.841481    2200        69.964664   0.035858    0.282756    135.233701 
[37m[36mINFO[0m[0m 03/25 18:44:46 | 0.626824    0.604520    0.990813    0.881283    0.551544    0.999117    0.982332    0.626824    0.604520    0.985910    0.817073    0.987412    0.844444    2400        76.325088   0.022163    0.282991    141.475958 
[37m[36mINFO[0m[0m 03/25 18:48:01 | 0.677647    0.666667    0.993227    0.896057    0.551476    1.000000    0.996466    0.677647    0.666667    0.988195    0.836890    0.991485    0.854815    2600        82.685512   0.023907    0.282687    139.365833 
[37m[36mINFO[0m[0m 03/25 18:51:14 | 0.628706    0.610169    0.995494    0.897899    0.571626    1.000000    0.992933    0.628706    0.610169    0.993145    0.842988    0.993336    0.857778    2800        89.045936   0.030670    0.271849    137.965290 
[37m[36mINFO[0m[0m 03/25 18:54:26 | 0.594353    0.578154    0.992222    0.880229    0.566806    1.000000    0.992933    0.594353    0.578154    0.986291    0.801829    0.990374    0.845926    3000        95.406360   0.019280    0.282340    135.934274 
[37m[36mINFO[0m[0m 03/25 18:57:34 | 0.620235    0.608286    0.990818    0.892832    0.591212    1.000000    0.992933    0.620235    0.608286    0.981340    0.829268    0.991114    0.856296    3200        101.766784  0.022120    0.267258    133.959763 
[37m[36mINFO[0m[0m 03/25 19:00:45 | 0.656941    0.636535    0.991114    0.895795    0.661233    1.000000    0.992933    0.656941    0.636535    0.986672    0.829268    0.986672    0.865185    3400        108.127208  0.023188    0.283370    134.619984 
[37m[36mINFO[0m[0m 03/25 19:03:54 | 0.603294    0.591337    0.995127    0.882594    0.609475    1.000000    0.989399    0.603294    0.591337    0.993526    0.810976    0.991855    0.847407    3600        114.487633  0.016003    0.265256    135.521106 
[37m[36mINFO[0m[0m 03/25 19:07:05 | 0.649412    0.634652    0.998004    0.895578    0.646190    1.000000    0.996466    0.649412    0.634652    0.997715    0.838415    0.996298    0.851852    3800        120.848057  0.012976    0.281438    135.265327 
[37m[36mINFO[0m[0m 03/25 19:10:16 | 0.648000    0.634652    0.997819    0.888155    0.681988    0.999117    0.989399    0.648000    0.634652    0.996192    0.824695    0.998149    0.850370    4000        127.208481  0.010043    0.278916    134.681048 
[37m[36mINFO[0m[0m 03/25 19:13:28 | 0.642353    0.621469    0.996594    0.888141    0.651701    1.000000    0.989399    0.642353    0.621469    0.992003    0.823171    0.997779    0.851852    4200        133.568905  0.013127    0.289512    134.202906 
[37m[36mINFO[0m[0m 03/25 19:16:44 | 0.606118    0.598870    0.996858    0.882015    0.685325    1.000000    0.996466    0.606118    0.598870    0.993907    0.814024    0.996668    0.835556    4400        139.929329  0.007072    0.288116    139.032621 
[37m[36mINFO[0m[0m 03/25 19:19:57 | 0.652706    0.629002    0.998121    0.885529    0.649996    1.000000    0.996466    0.652706    0.629002    0.996954    0.820122    0.997408    0.840000    4600        146.289753  0.011690    0.300706    132.433637 
[37m[36mINFO[0m[0m 03/25 19:23:11 | 0.657882    0.636535    0.998001    0.895012    0.727485    1.000000    0.996466    0.657882    0.636535    0.997334    0.830793    0.996668    0.857778    4800        152.650177  0.007052    0.283854    136.897305 
[37m[36mINFO[0m[0m 03/25 19:26:26 | 0.587294    0.574388    0.986725    0.865737    0.861440    1.000000    0.992933    0.587294    0.574388    0.979056    0.783537    0.981118    0.820741    5000        159.010601  0.007772    0.293562    136.310170 
[37m[36mINFO[0m[0m 03/25 19:26:26 | Cumulative gradient change saved at train_output/VLCS/ERM/[1]/250325_18-03-13_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 19:26:27 | ---
[37m[36mINFO[0m[0m 03/25 19:26:27 | test-domain validation(oracle) = 70.024%
[37m[36mINFO[0m[0m 03/25 19:26:27 | training-domain validation(iid) = 68.471%
[37m[36mINFO[0m[0m 03/25 19:26:27 | last = 58.729%
[37m[36mINFO[0m[0m 03/25 19:26:27 | last (inD) = 86.574%
[37m[36mINFO[0m[0m 03/25 19:26:27 | training-domain validation (iid, inD) = 90.186%
[37m[36mINFO[0m[0m 03/25 19:26:27 | === Summary ===
[37m[36mINFO[0m[0m 03/25 19:26:27 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 1 --hparams_seed 15
[37m[36mINFO[0m[0m 03/25 19:26:27 | Unique name: 250325_18-03-13_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 19:26:27 | Out path: train_output/VLCS/ERM/[1]/250325_18-03-13_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 19:26:27 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 19:26:27 | Dataset: VLCS

[37m[36mINFO[0m[0m 03/26 03:53:11 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 2 --hparams_seed 4
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 4
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[1]/250326_03-53-11_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 2
	unique_name: 250326_03-53-11_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 6.164076981615215e-05
	batch_size: 11
	weight_decay: 3.184710792983041e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/26 03:53:11 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 03:53:11 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 03:53:11 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 03:53:11 | 
[37m[36mINFO[0m[0m 03/26 03:53:11 | Testenv name escaping te_L -> te_L
[37m[36mINFO[0m[0m 03/26 03:53:11 | Test envs = [1], name = te_L
[37m[36mINFO[0m[0m 03/26 03:53:11 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/26 03:53:11 | Batch sizes for each domain: [11, 0, 11, 11] (total=33)
[37m[36mINFO[0m[0m 03/26 03:53:11 | steps-per-epoch for each domain: 102.91, 238.73, 245.55 -> min = 102.91
[37m[36mINFO[0m[0m 03/26 03:53:12 | # of params = 23518277
[37m[36mINFO[0m[0m 03/26 03:55:30 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 03:55:30 | 0.467294    0.459510    0.484066    0.470377    1.302174    0.620141    0.593640    0.467294    0.459510    0.391851    0.358232    0.440207    0.459259    0           0.000000    1.856874    0.998586    136.695739 
[37m[36mINFO[0m[0m 03/26 03:58:11 | 0.645647    0.674200    0.881094    0.881098    0.334999    0.993816    0.989399    0.645647    0.674200    0.829398    0.809451    0.820067    0.844444    200         1.943463    0.442269    0.121723    137.112905 
[37m[36mINFO[0m[0m 03/26 04:00:57 | 0.586353    0.617702    0.897441    0.888540    0.324812    0.999117    1.000000    0.586353    0.617702    0.831302    0.804878    0.861903    0.860741    400         3.886926    0.292946    0.152818    135.569511 
[37m[36mINFO[0m[0m 03/26 04:03:40 | 0.562824    0.576271    0.862288    0.848338    0.453288    0.994700    0.992933    0.562824    0.576271    0.779132    0.771341    0.813032    0.780741    600         5.830389    0.269541    0.134193    135.685168 
[37m[36mINFO[0m[0m 03/26 04:06:20 | 0.624941    0.642185    0.915083    0.889731    0.332318    1.000000    0.996466    0.624941    0.642185    0.852247    0.794207    0.893003    0.878519    800         7.773852    0.246716    0.124524    135.017314 
[37m[36mINFO[0m[0m 03/26 04:09:07 | 0.622118    0.647834    0.914503    0.874839    0.350449    0.995583    0.985866    0.622118    0.647834    0.868621    0.794207    0.879304    0.844444    1000        9.717314    0.224601    0.158251    135.297876 
[37m[36mINFO[0m[0m 03/26 04:11:50 | 0.671059    0.687382    0.924168    0.887926    0.336636    0.997350    0.989399    0.671059    0.687382    0.875857    0.800305    0.899297    0.874074    1200        11.660777   0.201810    0.131582    136.733495 
[37m[36mINFO[0m[0m 03/26 04:14:32 | 0.638588    0.666667    0.934515    0.891820    0.315221    1.000000    0.996466    0.638588    0.666667    0.884996    0.806402    0.918549    0.872593    1400        13.604240   0.194776    0.128234    137.161937 
[37m[36mINFO[0m[0m 03/26 04:17:18 | 0.641412    0.672316    0.947071    0.894722    0.304764    1.000000    0.992933    0.641412    0.672316    0.908225    0.820122    0.932988    0.871111    1600        15.547703   0.181246    0.148679    135.980366 
[37m[36mINFO[0m[0m 03/26 04:19:59 | 0.620706    0.640301    0.936008    0.880921    0.344026    0.995583    0.978799    0.620706    0.640301    0.885377    0.798780    0.927064    0.865185    1800        17.491166   0.176487    0.129956    134.910057 
[37m[36mINFO[0m[0m 03/26 04:22:41 | 0.672000    0.706215    0.935931    0.885211    0.375854    0.999117    0.992933    0.672000    0.706215    0.896420    0.806402    0.912255    0.856296    2000        19.434629   0.162462    0.124639    136.780309 
[37m[36mINFO[0m[0m 03/26 04:25:29 | 0.615529    0.638418    0.953164    0.887604    0.330246    1.000000    0.989399    0.615529    0.638418    0.913176    0.818598    0.946316    0.854815    2200        21.378092   0.133225    0.155773    137.210255 
[37m[36mINFO[0m[0m 03/26 04:28:13 | 0.573647    0.600753    0.945156    0.884038    0.392462    1.000000    1.000000    0.573647    0.600753    0.901371    0.798780    0.934098    0.853333    2400        23.321555   0.142459    0.137448    135.863854 
[37m[36mINFO[0m[0m 03/26 04:30:54 | 0.584941    0.617702    0.944878    0.871402    0.414744    1.000000    0.996466    0.584941    0.617702    0.897944    0.788110    0.936690    0.829630    2600        25.265018   0.138471    0.133637    134.911472 
[37m[36mINFO[0m[0m 03/26 04:33:46 | 0.614588    0.655367    0.957645    0.891745    0.352514    0.998233    0.992933    0.614588    0.655367    0.927647    0.818598    0.947057    0.863704    2800        27.208481   0.132238    0.154340    141.000113 
[37m[36mINFO[0m[0m 03/26 04:36:30 | 0.578824    0.596987    0.964858    0.886645    0.393163    0.999117    0.989399    0.578824    0.596987    0.941736    0.821646    0.953721    0.848889    3000        29.151943   0.120762    0.128222    138.147215 
[37m[36mINFO[0m[0m 03/26 04:39:13 | 0.681882    0.713748    0.951152    0.876572    0.459555    0.999117    0.992933    0.681882    0.713748    0.914318    0.780488    0.940022    0.856296    3200        31.095406   0.109683    0.122238    138.438607 
[37m[36mINFO[0m[0m 03/26 04:41:58 | 0.591529    0.619586    0.970611    0.888815    0.365367    1.000000    0.996466    0.591529    0.619586    0.944783    0.801829    0.967049    0.868148    3400        33.038869   0.116025    0.147499    136.159892 
[37m[36mINFO[0m[0m 03/26 04:44:43 | 0.672471    0.693032    0.938102    0.870466    0.507733    0.993816    0.985866    0.672471    0.693032    0.908606    0.801829    0.911884    0.823704    3600        34.982332   0.090276    0.139298    136.792191 
[37m[36mINFO[0m[0m 03/26 04:47:24 | 0.658353    0.674200    0.973160    0.890904    0.353582    1.000000    0.996466    0.658353    0.674200    0.953542    0.814024    0.965939    0.862222    3800        36.925795   0.092806    0.129684    134.813721 
[37m[36mINFO[0m[0m 03/26 04:50:11 | 0.632000    0.661017    0.975089    0.887054    0.400124    0.998233    0.996466    0.632000    0.661017    0.958873    0.824695    0.968160    0.840000    4000        38.869258   0.112963    0.155384    136.321636 
[37m[36mINFO[0m[0m 03/26 04:52:54 | 0.629647    0.644068    0.980945    0.885922    0.484106    1.000000    0.989399    0.629647    0.644068    0.968012    0.797256    0.974824    0.871111    4200        40.812721   0.091390    0.124785    137.823577 
[37m[36mINFO[0m[0m 03/26 04:55:37 | 0.651765    0.685499    0.979091    0.894546    0.525440    0.998233    0.989399    0.651765    0.685499    0.964585    0.821646    0.974454    0.872593    4400        42.756184   0.075701    0.123847    137.992383 
[37m[36mINFO[0m[0m 03/26 04:58:24 | 0.649412    0.677966    0.986344    0.889418    0.440926    1.000000    0.985866    0.649412    0.677966    0.977913    0.821646    0.981118    0.860741    4600        44.699647   0.063720    0.149589    136.819577 
[37m[36mINFO[0m[0m 03/26 05:01:07 | 0.587765    0.600753    0.974637    0.876412    0.465195    1.000000    0.996466    0.587765    0.600753    0.953161    0.795732    0.970752    0.837037    4800        46.643110   0.061848    0.129726    137.524976 
[37m[36mINFO[0m[0m 03/26 05:03:54 | 0.568471    0.600753    0.961344    0.855062    0.471516    1.000000    0.989399    0.568471    0.600753    0.930312    0.771341    0.953721    0.804444    5000        48.586572   0.070589    0.142382    138.186652 
[37m[36mINFO[0m[0m 03/26 05:03:54 | Cumulative gradient change saved at train_output/VLCS/ERM/[1]/250326_03-53-11_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 05:03:55 | ---
[37m[36mINFO[0m[0m 03/26 05:03:55 | test-domain validation(oracle) = 68.188%
[37m[36mINFO[0m[0m 03/26 05:03:55 | training-domain validation(iid) = 64.141%
[37m[36mINFO[0m[0m 03/26 05:03:55 | last = 56.847%
[37m[36mINFO[0m[0m 03/26 05:03:55 | last (inD) = 85.506%
[37m[36mINFO[0m[0m 03/26 05:03:55 | training-domain validation (iid, inD) = 89.472%
[37m[36mINFO[0m[0m 03/26 05:03:55 | === Summary ===
[37m[36mINFO[0m[0m 03/26 05:03:55 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 2 --hparams_seed 4
[37m[36mINFO[0m[0m 03/26 05:03:55 | Unique name: 250326_03-53-11_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 05:03:55 | Out path: train_output/VLCS/ERM/[1]/250326_03-53-11_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 05:03:55 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 05:03:55 | Dataset: VLCS

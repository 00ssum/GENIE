[37m[36mINFO[0m[0m 03/24 20:00:11 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 0 --hparams_seed 19
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 19
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[1]/250324_20-00-11_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250324_20-00-11_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5.513854977685438e-05
	batch_size: 27
	weight_decay: 0.0014556716107047517
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/24 20:00:11 | n_steps = 5001
[37m[36mINFO[0m[0m 03/24 20:00:11 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/24 20:00:11 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/24 20:00:11 | 
[37m[36mINFO[0m[0m 03/24 20:00:11 | Testenv name escaping te_L -> te_L
[37m[36mINFO[0m[0m 03/24 20:00:11 | Test envs = [1], name = te_L
[37m[36mINFO[0m[0m 03/24 20:00:11 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/24 20:00:11 | Batch sizes for each domain: [27, 0, 27, 27] (total=81)
[37m[36mINFO[0m[0m 03/24 20:00:11 | steps-per-epoch for each domain: 41.93, 97.26, 100.04 -> min = 41.93
[37m[36mINFO[0m[0m 03/24 20:00:12 | # of params = 23518277
[37m[36mINFO[0m[0m 03/24 20:02:43 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/24 20:02:43 | 0.459765    0.489642    0.479821    0.487365    1.403203    0.611307    0.628975    0.459765    0.489642    0.384615    0.387195    0.443539    0.445926    0           0.000000    1.794660    1.142147    150.032224 
[37m[36mINFO[0m[0m 03/24 20:05:59 | 0.675765    0.670433    0.906085    0.887884    0.306993    0.996466    0.996466    0.675765    0.670433    0.847296    0.807927    0.874491    0.859259    200         4.770318    0.374870    0.239253    148.633009 
[37m[36mINFO[0m[0m 03/24 20:09:15 | 0.650353    0.644068    0.922696    0.887030    0.310836    1.000000    1.000000    0.650353    0.644068    0.861386    0.801829    0.906701    0.859259    400         9.540636    0.227738    0.236260    148.115956 
[37m[36mINFO[0m[0m 03/24 20:12:26 | 0.607059    0.596987    0.930495    0.881944    0.361412    0.998233    0.996466    0.607059    0.596987    0.887662    0.806402    0.905591    0.842963    600         14.310954   0.184913    0.227230    145.998780 
[37m[36mINFO[0m[0m 03/24 20:15:44 | 0.654118    0.644068    0.951232    0.888991    0.326252    1.000000    1.000000    0.654118    0.644068    0.917746    0.800305    0.935950    0.866667    800         19.081272   0.163438    0.241625    149.282281 
[37m[36mINFO[0m[0m 03/24 20:18:49 | 0.610824    0.600753    0.950008    0.880362    0.350124    1.000000    0.996466    0.610824    0.600753    0.918888    0.795732    0.931137    0.848889    1000        23.851590   0.130526    0.249783    135.493908 
[37m[36mINFO[0m[0m 03/24 20:21:57 | 0.649412    0.664783    0.959386    0.892343    0.373981    0.997350    0.996466    0.649412    0.664783    0.934120    0.809451    0.946686    0.871111    1200        28.621908   0.109393    0.248621    137.921341 
[37m[36mINFO[0m[0m 03/24 20:25:09 | 0.617412    0.606403    0.978830    0.884384    0.392633    1.000000    0.996466    0.617412    0.606403    0.966108    0.803354    0.970381    0.853333    1400        33.392226   0.102534    0.244627    142.705666 
[37m[36mINFO[0m[0m 03/24 20:28:12 | 0.643765    0.636535    0.979278    0.898545    0.370065    1.000000    1.000000    0.643765    0.636535    0.961158    0.818598    0.976675    0.877037    1600        38.162544   0.077913    0.225412    137.998202 
[37m[36mINFO[0m[0m 03/24 20:31:15 | 0.600000    0.615819    0.978860    0.884327    0.440638    0.999117    0.996466    0.600000    0.615819    0.961158    0.797256    0.976305    0.859259    1800        42.932862   0.069276    0.238287    135.812730 
[37m[36mINFO[0m[0m 03/24 20:34:23 | 0.657412    0.659134    0.983756    0.886972    0.438787    0.998233    1.000000    0.657412    0.659134    0.975248    0.795732    0.977786    0.865185    2000        47.703180   0.062481    0.231718    141.924087 
[37m[36mINFO[0m[0m 03/24 20:37:29 | 0.654118    0.651601    0.979404    0.878938    0.485021    0.998233    0.996466    0.654118    0.651601    0.971820    0.801829    0.968160    0.838519    2200        52.473498   0.049580    0.237534    137.740558 
[37m[36mINFO[0m[0m 03/24 20:40:35 | 0.655059    0.666667    0.983435    0.881569    0.525693    1.000000    1.000000    0.655059    0.666667    0.970297    0.798780    0.980007    0.845926    2400        57.243816   0.050744    0.238858    139.031778 
[37m[36mINFO[0m[0m 03/24 20:43:39 | 0.628706    0.629002    0.989565    0.885215    0.549381    0.999117    0.996466    0.628706    0.629002    0.984387    0.786585    0.985191    0.872593    2600        62.014134   0.039307    0.225664    137.944838 
[37m[36mINFO[0m[0m 03/24 20:46:42 | 0.610353    0.602637    0.992334    0.884037    0.537736    1.000000    0.992933    0.610353    0.602637    0.985149    0.786585    0.991855    0.872593    2800        66.784452   0.035887    0.232228    137.229613 
[37m[36mINFO[0m[0m 03/24 20:49:46 | 0.617412    0.613936    0.993487    0.885026    0.582295    1.000000    1.000000    0.617412    0.613936    0.989718    0.798780    0.990744    0.856296    3000        71.554770   0.031949    0.221778    139.409040 
[37m[36mINFO[0m[0m 03/24 20:52:44 | 0.639059    0.621469    0.983562    0.886056    0.545796    1.000000    1.000000    0.639059    0.621469    0.970678    0.803354    0.980007    0.854815    3200        76.325088   0.032540    0.211986    135.534370 
[37m[36mINFO[0m[0m 03/24 20:55:46 | 0.617882    0.610169    0.989838    0.873771    0.636357    1.000000    0.996466    0.617882    0.610169    0.982102    0.777439    0.987412    0.847407    3400        81.095406   0.027085    0.226610    136.999014 
[37m[36mINFO[0m[0m 03/24 20:58:44 | 0.607059    0.604520    0.991608    0.879184    0.624193    1.000000    0.992933    0.607059    0.604520    0.986672    0.795732    0.988153    0.848889    3600        85.865724   0.024608    0.216559    134.723630 
[37m[36mINFO[0m[0m 03/24 21:01:47 | 0.646118    0.638418    0.994471    0.886915    0.589992    1.000000    1.000000    0.646118    0.638418    0.989337    0.789634    0.994076    0.871111    3800        90.636042   0.020703    0.219305    138.885192 
[37m[36mINFO[0m[0m 03/24 21:04:54 | 0.618824    0.600753    0.994859    0.886839    0.624225    1.000000    0.996466    0.618824    0.600753    0.991241    0.801829    0.993336    0.862222    4000        95.406360   0.026724    0.222593    141.994943 
[37m[36mINFO[0m[0m 03/24 21:07:51 | 0.616471    0.606403    0.992754    0.878895    0.619526    1.000000    0.996466    0.616471    0.606403    0.990480    0.797256    0.987782    0.842963    4200        100.176678  0.015679    0.205650    136.208639 
[37m[36mINFO[0m[0m 03/24 21:10:49 | 0.630588    0.634652    0.994383    0.890325    0.579716    1.000000    0.996466    0.630588    0.634652    0.993145    0.804878    0.990004    0.869630    4400        104.946996  0.023292    0.211986    135.197975 
[37m[36mINFO[0m[0m 03/24 21:13:44 | 0.638118    0.638418    0.994238    0.890529    0.549307    1.000000    1.000000    0.638118    0.638418    0.990861    0.806402    0.991855    0.865185    4600        109.717314  0.023553    0.206360    134.587644 
[37m[36mINFO[0m[0m 03/24 21:16:48 | 0.658824    0.662900    0.996728    0.883415    0.596523    1.000000    1.000000    0.658824    0.662900    0.993145    0.785061    0.997038    0.865185    4800        114.487633  0.016216    0.221859    139.587545 
[37m[36mINFO[0m[0m 03/24 21:20:02 | 0.624941    0.613936    0.982038    0.863063    0.720459    0.998233    0.989399    0.624941    0.613936    0.989718    0.782012    0.958164    0.817778    5000        119.257951  0.011015    0.227172    148.174321 
[37m[36mINFO[0m[0m 03/24 21:20:02 | Cumulative gradient change saved at train_output/VLCS/ERM/[1]/250324_20-00-11_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/24 21:20:03 | ---
[37m[36mINFO[0m[0m 03/24 21:20:03 | test-domain validation(oracle) = 67.576%
[37m[36mINFO[0m[0m 03/24 21:20:03 | training-domain validation(iid) = 64.376%
[37m[36mINFO[0m[0m 03/24 21:20:03 | last = 62.494%
[37m[36mINFO[0m[0m 03/24 21:20:03 | last (inD) = 86.306%
[37m[36mINFO[0m[0m 03/24 21:20:03 | training-domain validation (iid, inD) = 89.854%
[37m[36mINFO[0m[0m 03/24 21:20:04 | === Summary ===
[37m[36mINFO[0m[0m 03/24 21:20:04 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 0 --hparams_seed 19
[37m[36mINFO[0m[0m 03/24 21:20:04 | Unique name: 250324_20-00-11_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 21:20:04 | Out path: train_output/VLCS/ERM/[1]/250324_20-00-11_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 21:20:04 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/24 21:20:04 | Dataset: VLCS

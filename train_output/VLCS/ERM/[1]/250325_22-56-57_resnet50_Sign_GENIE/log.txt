[37m[36mINFO[0m[0m 03/25 22:56:57 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 1 --hparams_seed 20
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 20
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[1]/250325_22-56-57_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250325_22-56-57_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 1.6701621650738547e-05
	batch_size: 28
	weight_decay: 2.09977539257237e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/25 22:56:57 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 22:56:57 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 22:56:57 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 22:56:57 | 
[37m[36mINFO[0m[0m 03/25 22:56:57 | Testenv name escaping te_L -> te_L
[37m[36mINFO[0m[0m 03/25 22:56:57 | Test envs = [1], name = te_L
[37m[36mINFO[0m[0m 03/25 22:56:57 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/25 22:56:57 | Batch sizes for each domain: [28, 0, 28, 28] (total=84)
[37m[36mINFO[0m[0m 03/25 22:56:57 | steps-per-epoch for each domain: 40.43, 93.79, 96.46 -> min = 40.43
[37m[36mINFO[0m[0m 03/25 22:56:58 | # of params = 23518277
[37m[36mINFO[0m[0m 03/25 22:59:15 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 22:59:15 | 0.466824    0.461394    0.481371    0.481169    1.436905    0.613958    0.618375    0.466824    0.461394    0.376618    0.419207    0.453536    0.405926    0           0.000000    1.798708    1.103058    135.874564 
[37m[36mINFO[0m[0m 03/25 23:02:20 | 0.610824    0.596987    0.884047    0.860048    0.340871    1.000000    1.000000    0.610824    0.596987    0.792460    0.768293    0.859682    0.811852    200         4.946996    0.385929    0.240128    136.700841 
[37m[36mINFO[0m[0m 03/25 23:05:32 | 0.646588    0.629002    0.929813    0.903085    0.276660    0.999117    0.996466    0.646588    0.629002    0.875476    0.849085    0.914846    0.863704    400         9.893993    0.237796    0.258857    140.466995 
[37m[36mINFO[0m[0m 03/25 23:08:35 | 0.671059    0.664783    0.924489    0.890644    0.295230    0.999117    1.000000    0.671059    0.664783    0.860244    0.818598    0.914106    0.853333    600         14.840989   0.190903    0.238814    135.042840 
[37m[36mINFO[0m[0m 03/25 23:11:35 | 0.582588    0.578154    0.930633    0.876573    0.322233    1.000000    1.000000    0.582588    0.578154    0.878903    0.792683    0.912995    0.837037    800         19.787986   0.173438    0.223156    135.436905 
[37m[36mINFO[0m[0m 03/25 23:14:40 | 0.617412    0.610169    0.954130    0.895853    0.332571    0.998233    0.992933    0.617412    0.610169    0.907845    0.835366    0.956312    0.859259    1000        24.734982   0.141778    0.255623    133.683471 
[37m[36mINFO[0m[0m 03/25 23:17:38 | 0.641412    0.649718    0.957681    0.895473    0.330728    0.998233    0.992933    0.641412    0.649718    0.918126    0.847561    0.956683    0.845926    1200        29.681979   0.118698    0.222754    133.903678 
[37m[36mINFO[0m[0m 03/25 23:20:46 | 0.640471    0.623352    0.970976    0.894955    0.335028    0.999117    0.996466    0.640471    0.623352    0.949353    0.824695    0.964458    0.863704    1400        34.628975   0.101776    0.228244    142.082615 
[37m[36mINFO[0m[0m 03/25 23:23:54 | 0.648000    0.640301    0.981210    0.894039    0.395377    1.000000    0.996466    0.648000    0.640301    0.969916    0.832317    0.973713    0.853333    1600        39.575972   0.078378    0.260177    135.845784 
[37m[36mINFO[0m[0m 03/25 23:26:58 | 0.657882    0.640301    0.978528    0.893664    0.406843    0.999117    1.000000    0.657882    0.640301    0.965347    0.824695    0.971122    0.856296    1800        44.522968   0.078285    0.225288    139.563993 
[37m[36mINFO[0m[0m 03/25 23:29:58 | 0.626353    0.617702    0.984401    0.899713    0.410740    1.000000    0.989399    0.626353    0.617702    0.968012    0.846037    0.985191    0.863704    2000        49.469965   0.061936    0.207957    137.863928 
[37m[36mINFO[0m[0m 03/25 23:33:10 | 0.586824    0.574388    0.986093    0.887419    0.503501    1.000000    0.996466    0.586824    0.574388    0.977532    0.810976    0.980748    0.854815    2200        54.416961   0.047687    0.259612    140.287651 
[37m[36mINFO[0m[0m 03/25 23:36:21 | 0.663529    0.651601    0.988551    0.893863    0.450648    1.000000    0.992933    0.663529    0.651601    0.976390    0.833841    0.989263    0.854815    2400        59.363958   0.055654    0.243155    142.255928 
[37m[36mINFO[0m[0m 03/25 23:39:23 | 0.659294    0.645951    0.989704    0.891816    0.476559    1.000000    0.992933    0.659294    0.645951    0.980960    0.826220    0.988153    0.856296    2600        64.310954   0.038907    0.232535    135.842010 
[37m[36mINFO[0m[0m 03/25 23:42:28 | 0.592471    0.587571    0.978780    0.865057    0.592882    1.000000    0.992933    0.592471    0.587571    0.960777    0.763720    0.975565    0.838519    2800        69.257951   0.030548    0.255808    133.808871 
[37m[36mINFO[0m[0m 03/25 23:45:32 | 0.666824    0.644068    0.988082    0.895387    0.482339    1.000000    0.992933    0.666824    0.644068    0.979056    0.838415    0.985191    0.854815    3000        74.204947   0.043795    0.255375    132.535785 
[37m[36mINFO[0m[0m 03/25 23:48:35 | 0.640941    0.617702    0.984094    0.888820    0.553230    1.000000    0.989399    0.640941    0.617702    0.974867    0.842988    0.977416    0.834074    3200        79.151943   0.031459    0.222657    138.525869 
[37m[36mINFO[0m[0m 03/25 23:51:42 | 0.639529    0.636535    0.995741    0.889114    0.521785    1.000000    0.989399    0.639529    0.636535    0.993145    0.821646    0.994076    0.856296    3400        84.098940   0.025780    0.253751    136.650997 
[37m[36mINFO[0m[0m 03/25 23:54:48 | 0.632941    0.621469    0.995501    0.894533    0.532375    1.000000    0.996466    0.632941    0.621469    0.993907    0.832317    0.992595    0.854815    3600        89.045936   0.026041    0.250203    135.446610 
[37m[36mINFO[0m[0m 03/25 23:57:51 | 0.665882    0.659134    0.993974    0.895578    0.575336    1.000000    0.996466    0.665882    0.659134    0.988957    0.838415    0.992966    0.851852    3800        93.992933   0.032113    0.221373    138.876184 
[37m[36mINFO[0m[0m 03/26 00:00:53 | 0.621647    0.581921    0.993625    0.886345    0.530124    1.000000    0.996466    0.621647    0.581921    0.991241    0.801829    0.989633    0.860741    4000        98.939929   0.020755    0.239011    134.560941 
[37m[36mINFO[0m[0m 03/26 00:03:57 | 0.629647    0.610169    0.995349    0.885268    0.643449    1.000000    0.992933    0.629647    0.610169    0.990861    0.812500    0.995187    0.850370    4200        103.886926  0.015971    0.254701    132.851928 
[37m[36mINFO[0m[0m 03/26 00:07:01 | 0.617412    0.593220    0.996738    0.893312    0.541103    1.000000    0.992933    0.617412    0.593220    0.994288    0.827744    0.995927    0.859259    4400        108.833922  0.017973    0.228255    138.103441 
[37m[36mINFO[0m[0m 03/26 00:10:08 | 0.642353    0.630885    0.996612    0.892396    0.655930    1.000000    0.992933    0.642353    0.630885    0.993907    0.835366    0.995927    0.848889    4600        113.780919  0.012541    0.237922    139.135211 
[37m[36mINFO[0m[0m 03/26 00:13:15 | 0.646588    0.625235    0.997613    0.890990    0.611258    1.000000    0.996466    0.646588    0.625235    0.995430    0.823171    0.997408    0.853333    4800        118.727915  0.017662    0.253481    136.623473 
[37m[36mINFO[0m[0m 03/26 00:16:19 | 0.622588    0.598870    0.996858    0.884194    0.573346    1.000000    0.992933    0.622588    0.598870    0.993907    0.803354    0.996668    0.856296    5000        123.674912  0.017719    0.225125    139.522306 
[37m[36mINFO[0m[0m 03/26 00:16:20 | Cumulative gradient change saved at train_output/VLCS/ERM/[1]/250325_22-56-57_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 00:16:21 | ---
[37m[36mINFO[0m[0m 03/26 00:16:21 | test-domain validation(oracle) = 67.106%
[37m[36mINFO[0m[0m 03/26 00:16:21 | training-domain validation(iid) = 64.659%
[37m[36mINFO[0m[0m 03/26 00:16:21 | last = 62.259%
[37m[36mINFO[0m[0m 03/26 00:16:21 | last (inD) = 88.419%
[37m[36mINFO[0m[0m 03/26 00:16:21 | training-domain validation (iid, inD) = 90.309%
[37m[36mINFO[0m[0m 03/26 00:16:21 | === Summary ===
[37m[36mINFO[0m[0m 03/26 00:16:21 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 1 --hparams_seed 20
[37m[36mINFO[0m[0m 03/26 00:16:21 | Unique name: 250325_22-56-57_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 00:16:21 | Out path: train_output/VLCS/ERM/[1]/250325_22-56-57_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 00:16:21 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 00:16:21 | Dataset: VLCS

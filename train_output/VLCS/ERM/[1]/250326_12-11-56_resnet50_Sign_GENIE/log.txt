[37m[36mINFO[0m[0m 03/26 12:11:56 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 2 --hparams_seed 11
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 11
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[1]/250326_12-11-56_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 2
	unique_name: 250326_12-11-56_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00030079935666912124
	batch_size: 16
	weight_decay: 6.276702207693199e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/26 12:11:56 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 12:11:56 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 12:11:56 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 12:11:56 | 
[37m[36mINFO[0m[0m 03/26 12:11:56 | Testenv name escaping te_L -> te_L
[37m[36mINFO[0m[0m 03/26 12:11:56 | Test envs = [1], name = te_L
[37m[36mINFO[0m[0m 03/26 12:11:56 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/26 12:11:56 | Batch sizes for each domain: [16, 0, 16, 16] (total=48)
[37m[36mINFO[0m[0m 03/26 12:11:56 | steps-per-epoch for each domain: 70.75, 164.12, 168.81 -> min = 70.75
[37m[36mINFO[0m[0m 03/26 12:11:57 | # of params = 23518277
[37m[36mINFO[0m[0m 03/26 12:14:11 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 12:14:11 | 0.467294    0.459510    0.484066    0.470377    1.301959    0.620141    0.593640    0.467294    0.459510    0.391851    0.358232    0.440207    0.459259    0           0.000000    1.881104    0.935758    132.934691 
[37m[36mINFO[0m[0m 03/26 12:16:54 | 0.649412    0.668550    0.893967    0.882555    0.322474    0.997350    0.992933    0.649412    0.668550    0.826352    0.786585    0.858201    0.868148    200         2.826855    0.400047    0.132956    137.350879 
[37m[36mINFO[0m[0m 03/26 12:19:33 | 0.697882    0.713748    0.887452    0.868704    0.368664    0.999117    0.996466    0.697882    0.713748    0.805407    0.763720    0.857830    0.845926    400         5.653710    0.272563    0.131812    132.031472 
[37m[36mINFO[0m[0m 03/26 12:22:13 | 0.634353    0.645951    0.923785    0.884095    0.338033    1.000000    1.000000    0.634353    0.645951    0.872430    0.804878    0.898926    0.847407    600         8.480565    0.238595    0.135350    132.924689 
[37m[36mINFO[0m[0m 03/26 12:24:56 | 0.625412    0.647834    0.934704    0.900054    0.296196    0.999117    0.992933    0.625412    0.647834    0.883854    0.809451    0.921140    0.897778    800         11.307420   0.208497    0.141896    134.706774 
[37m[36mINFO[0m[0m 03/26 12:27:39 | 0.590118    0.608286    0.939772    0.887940    0.312418    1.000000    0.989399    0.590118    0.608286    0.892993    0.801829    0.926324    0.872593    1000        14.134276   0.191937    0.148541    132.963177 
[37m[36mINFO[0m[0m 03/26 12:30:17 | 0.573647    0.593220    0.927384    0.873173    0.358861    0.999117    0.992933    0.573647    0.593220    0.866337    0.786585    0.916698    0.840000    1200        16.961131   0.176173    0.134232    131.953258 
[37m[36mINFO[0m[0m 03/26 12:32:59 | 0.656941    0.668550    0.952018    0.890353    0.330694    1.000000    0.996466    0.656941    0.668550    0.909368    0.807927    0.946686    0.866667    1400        19.787986   0.161766    0.133968    134.622191 
[37m[36mINFO[0m[0m 03/26 12:35:41 | 0.661647    0.683616    0.952854    0.886340    0.360288    1.000000    0.985866    0.661647    0.683616    0.919650    0.809451    0.938912    0.863704    1600        22.614841   0.140446    0.136757    134.610970 
[37m[36mINFO[0m[0m 03/26 12:38:21 | 0.628235    0.657250    0.959201    0.890002    0.344727    1.000000    0.989399    0.628235    0.657250    0.925362    0.810976    0.952240    0.869630    1800        25.441696   0.122477    0.135786    132.747044 
[37m[36mINFO[0m[0m 03/26 12:40:58 | 0.636706    0.666667    0.946341    0.884689    0.346594    1.000000    1.000000    0.636706    0.666667    0.909368    0.815549    0.929656    0.838519    2000        28.268551   0.124861    0.130484    130.960887 
[37m[36mINFO[0m[0m 03/26 12:43:38 | 0.631059    0.653484    0.970787    0.884731    0.355148    1.000000    0.992933    0.631059    0.653484    0.950495    0.807927    0.961866    0.853333    2200        31.095406   0.119636    0.142582    131.916760 
[37m[36mINFO[0m[0m 03/26 12:46:18 | 0.611294    0.657250    0.970609    0.891930    0.378971    0.999117    0.985866    0.611294    0.657250    0.949733    0.826220    0.962977    0.863704    2400        33.922261   0.102713    0.136786    132.592497 
[37m[36mINFO[0m[0m 03/26 12:49:01 | 0.630588    0.659134    0.969999    0.897742    0.330761    0.999117    0.992933    0.630588    0.659134    0.950495    0.826220    0.960385    0.874074    2600        36.749117   0.087774    0.140512    134.543099 
[37m[36mINFO[0m[0m 03/26 12:51:42 | 0.618824    0.630885    0.979666    0.890856    0.394174    1.000000    0.985866    0.618824    0.630885    0.963062    0.817073    0.975935    0.869630    2800        39.575972   0.089229    0.132576    135.104719 
[37m[36mINFO[0m[0m 03/26 12:54:24 | 0.623059    0.649718    0.982299    0.886792    0.376695    1.000000    0.992933    0.623059    0.649718    0.967631    0.817073    0.979267    0.850370    3000        42.402827   0.076282    0.135623    134.306784 
[37m[36mINFO[0m[0m 03/26 12:57:07 | 0.606588    0.627119    0.970787    0.876083    0.436351    0.996466    0.978799    0.606588    0.627119    0.957730    0.809451    0.958164    0.840000    3200        45.229682   0.070889    0.138712    135.373208 
[37m[36mINFO[0m[0m 03/26 12:59:48 | 0.675294    0.719397    0.963504    0.879630    0.536810    0.999117    0.982332    0.675294    0.719397    0.942117    0.798780    0.949278    0.857778    3400        48.056537   0.059436    0.133822    134.015675 
[37m[36mINFO[0m[0m 03/26 13:02:28 | 0.581647    0.598870    0.983519    0.878140    0.475973    1.000000    0.992933    0.581647    0.598870    0.966108    0.789634    0.984450    0.851852    3600        50.883392   0.056539    0.137003    132.957375 
[37m[36mINFO[0m[0m 03/26 13:05:09 | 0.620706    0.647834    0.988833    0.894270    0.418860    1.000000    0.985866    0.620706    0.647834    0.980198    0.812500    0.986301    0.884444    3800        53.710247   0.065271    0.138655    133.126843 
[37m[36mINFO[0m[0m 03/26 13:07:49 | 0.657882    0.674200    0.977783    0.886112    0.530888    1.000000    0.992933    0.657882    0.674200    0.959634    0.797256    0.973713    0.868148    4000        56.537102   0.045256    0.133638    132.739811 
[37m[36mINFO[0m[0m 03/26 13:10:27 | 0.674824    0.702448    0.990430    0.892281    0.499507    1.000000    0.992933    0.674824    0.702448    0.979436    0.823171    0.991855    0.860741    4200        59.363958   0.040442    0.132113    132.502581 
[37m[36mINFO[0m[0m 03/26 13:13:07 | 0.612706    0.630885    0.987536    0.892790    0.427446    1.000000    0.992933    0.612706    0.630885    0.973343    0.824695    0.989263    0.860741    4400        62.190813   0.068391    0.137678    131.557030 
[37m[36mINFO[0m[0m 03/26 13:15:47 | 0.617882    0.612053    0.991739    0.884555    0.473986    1.000000    0.989399    0.617882    0.612053    0.987433    0.809451    0.987782    0.854815    4600        65.017668   0.047947    0.137999    132.940962 
[37m[36mINFO[0m[0m 03/26 13:18:30 | 0.627765    0.651601    0.993956    0.890553    0.509736    1.000000    0.989399    0.627765    0.651601    0.987053    0.817073    0.994817    0.865185    4800        67.844523   0.033830    0.144213    133.790296 
[37m[36mINFO[0m[0m 03/26 13:21:10 | 0.621647    0.647834    0.991739    0.887153    0.461796    1.000000    0.989399    0.621647    0.647834    0.987433    0.823171    0.987782    0.848889    5000        70.671378   0.035214    0.129004    134.377310 
[37m[36mINFO[0m[0m 03/26 13:21:10 | Cumulative gradient change saved at train_output/VLCS/ERM/[1]/250326_12-11-56_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 13:21:11 | ---
[37m[36mINFO[0m[0m 03/26 13:21:11 | test-domain validation(oracle) = 67.529%
[37m[36mINFO[0m[0m 03/26 13:21:11 | training-domain validation(iid) = 62.541%
[37m[36mINFO[0m[0m 03/26 13:21:11 | last = 62.165%
[37m[36mINFO[0m[0m 03/26 13:21:11 | last (inD) = 88.715%
[37m[36mINFO[0m[0m 03/26 13:21:11 | training-domain validation (iid, inD) = 90.005%
[37m[36mINFO[0m[0m 03/26 13:21:11 | === Summary ===
[37m[36mINFO[0m[0m 03/26 13:21:11 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 2 --hparams_seed 11
[37m[36mINFO[0m[0m 03/26 13:21:11 | Unique name: 250326_12-11-56_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 13:21:11 | Out path: train_output/VLCS/ERM/[1]/250326_12-11-56_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 13:21:11 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 13:21:11 | Dataset: VLCS

[37m[36mINFO[0m[0m 03/26 05:04:00 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 2 --hparams_seed 5
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 5
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[1]/250326_05-04-00_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 2
	unique_name: 250326_05-04-00_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.0002982828768978312
	batch_size: 9
	weight_decay: 0.0003180957897867641
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/26 05:04:00 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 05:04:00 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 05:04:00 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 05:04:00 | 
[37m[36mINFO[0m[0m 03/26 05:04:00 | Testenv name escaping te_L -> te_L
[37m[36mINFO[0m[0m 03/26 05:04:00 | Test envs = [1], name = te_L
[37m[36mINFO[0m[0m 03/26 05:04:00 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/26 05:04:00 | Batch sizes for each domain: [9, 0, 9, 9] (total=27)
[37m[36mINFO[0m[0m 03/26 05:04:00 | steps-per-epoch for each domain: 125.78, 291.78, 300.11 -> min = 125.78
[37m[36mINFO[0m[0m 03/26 05:04:01 | # of params = 23518277
[37m[36mINFO[0m[0m 03/26 05:06:19 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 05:06:19 | 0.466824    0.459510    0.484574    0.469854    1.306472    0.620141    0.593640    0.466824    0.459510    0.393374    0.355183    0.440207    0.460741    0           0.000000    1.903886    1.232067    136.931922 
[37m[36mINFO[0m[0m 03/26 05:09:03 | 0.587765    0.604520    0.862397    0.864882    0.382625    0.996466    0.996466    0.587765    0.604520    0.780655    0.777439    0.810070    0.820741    200         1.590106    0.527238    0.135019    136.734223 
[37m[36mINFO[0m[0m 03/26 05:11:44 | 0.618353    0.644068    0.876492    0.866444    0.361498    0.986749    0.985866    0.618353    0.644068    0.813404    0.794207    0.829322    0.819259    400         3.180212    0.326595    0.134723    134.161249 
[37m[36mINFO[0m[0m 03/26 05:14:33 | 0.605647    0.619586    0.901011    0.885723    0.299576    0.998233    0.996466    0.605647    0.619586    0.835491    0.788110    0.869308    0.872593    600         4.770318    0.292391    0.159343    137.127877 
[37m[36mINFO[0m[0m 03/26 05:17:18 | 0.681882    0.709981    0.890366    0.866163    0.385515    0.998233    0.996466    0.681882    0.709981    0.805407    0.756098    0.867456    0.845926    800         6.360424    0.308353    0.138755    137.264840 
[37m[36mINFO[0m[0m 03/26 05:20:02 | 0.615529    0.612053    0.913755    0.882214    0.308898    0.990283    0.982332    0.615529    0.612053    0.872049    0.810976    0.878934    0.853333    1000        7.950530    0.296719    0.133230    137.251844 
[37m[36mINFO[0m[0m 03/26 05:22:44 | 0.642353    0.653484    0.925335    0.886417    0.314554    0.999117    0.996466    0.642353    0.653484    0.871668    0.809451    0.905220    0.853333    1200        9.540636    0.263998    0.123460    137.572198 
[37m[36mINFO[0m[0m 03/26 05:25:25 | 0.640941    0.638418    0.918091    0.894347    0.298451    1.000000    0.996466    0.640941    0.638418    0.843869    0.812500    0.910404    0.874074    1400        11.130742   0.230767    0.122624    136.661648 
[37m[36mINFO[0m[0m 03/26 05:28:09 | 0.685176    0.713748    0.885272    0.864529    0.404015    0.988516    0.982332    0.685176    0.713748    0.818355    0.768293    0.848945    0.842963    1600        12.720848   0.241271    0.150169    133.223833 
[37m[36mINFO[0m[0m 03/26 05:30:53 | 0.670588    0.687382    0.919455    0.881754    0.309123    0.998233    0.992933    0.670588    0.687382    0.868241    0.806402    0.891892    0.845926    1800        14.310954   0.230788    0.154195    133.804488 
[37m[36mINFO[0m[0m 03/26 05:33:36 | 0.624471    0.649718    0.935345    0.892457    0.318980    0.999117    0.996466    0.624471    0.649718    0.886519    0.821646    0.920400    0.859259    2000        15.901060   0.200210    0.124946    138.286040 
[37m[36mINFO[0m[0m 03/26 05:36:19 | 0.680941    0.691149    0.925467    0.880234    0.369083    1.000000    0.996466    0.680941    0.691149    0.867479    0.782012    0.908923    0.862222    2200        17.491166   0.208298    0.123038    137.843580 
[37m[36mINFO[0m[0m 03/26 05:38:58 | 0.648941    0.664783    0.935338    0.890034    0.360491    0.997350    0.992933    0.648941    0.664783    0.882711    0.794207    0.925953    0.882963    2400        19.081272   0.219766    0.128160    133.091943 
[37m[36mINFO[0m[0m 03/26 05:41:39 | 0.589176    0.598870    0.936107    0.884062    0.359157    0.999117    0.996466    0.589176    0.598870    0.888804    0.821646    0.920400    0.834074    2600        20.671378   0.183354    0.128160    135.717716 
[37m[36mINFO[0m[0m 03/26 05:44:21 | 0.624941    0.644068    0.929409    0.878250    0.394511    0.998233    0.989399    0.624941    0.644068    0.890327    0.821646    0.899667    0.823704    2800        22.261484   0.177758    0.147937    132.529562 
[37m[36mINFO[0m[0m 03/26 05:47:04 | 0.667294    0.689266    0.946204    0.886417    0.364204    1.000000    0.996466    0.667294    0.689266    0.907845    0.809451    0.930766    0.853333    3000        23.851590   0.156388    0.143942    133.936507 
[37m[36mINFO[0m[0m 03/26 05:49:43 | 0.634353    0.657250    0.944687    0.889812    0.351982    0.998233    0.992933    0.634353    0.657250    0.914318    0.823171    0.921511    0.853333    3200        25.441696   0.156128    0.129102    133.424877 
[37m[36mINFO[0m[0m 03/26 05:52:23 | 0.620235    0.623352    0.949656    0.885105    0.322736    0.998233    0.982332    0.620235    0.623352    0.917746    0.803354    0.932988    0.869630    3400        27.031802   0.171634    0.122395    135.259155 
[37m[36mINFO[0m[0m 03/26 05:54:59 | 0.654588    0.664783    0.955935    0.886778    0.374324    1.000000    0.992933    0.654588    0.664783    0.932597    0.815549    0.935209    0.851852    3600        28.621908   0.151470    0.124702    131.625483 
[37m[36mINFO[0m[0m 03/26 05:57:43 | 0.623059    0.653484    0.948079    0.878824    0.343528    1.000000    0.996466    0.623059    0.653484    0.923839    0.789634    0.920400    0.850370    3800        30.212014   0.156919    0.142863    134.783518 
[37m[36mINFO[0m[0m 03/26 06:00:29 | 0.668706    0.709981    0.962180    0.891673    0.384893    0.998233    0.992933    0.668706    0.709981    0.937548    0.810976    0.950759    0.871111    4000        31.802120   0.119473    0.152594    135.387033 
[37m[36mINFO[0m[0m 03/26 06:03:09 | 0.569412    0.581921    0.946690    0.866040    0.424985    0.998233    0.989399    0.569412    0.581921    0.904037    0.783537    0.937801    0.825185    4200        33.392226   0.148336    0.138299    132.491900 
[37m[36mINFO[0m[0m 03/26 06:05:49 | 0.656000    0.687382    0.963107    0.890335    0.421041    0.996466    0.992933    0.656000    0.687382    0.941356    0.826220    0.951499    0.851852    4400        34.982332   0.156234    0.129163    134.288075 
[37m[36mINFO[0m[0m 03/26 06:08:26 | 0.569882    0.589454    0.961983    0.879588    0.373734    1.000000    0.989399    0.569882    0.589454    0.932597    0.806402    0.953351    0.842963    4600        36.572438   0.125533    0.124492    132.435764 
[37m[36mINFO[0m[0m 03/26 06:11:04 | 0.591529    0.619586    0.965953    0.884717    0.359492    1.000000    0.992933    0.591529    0.619586    0.934882    0.806402    0.962977    0.854815    4800        38.162544   0.126203    0.124314    133.148682 
[37m[36mINFO[0m[0m 03/26 06:13:49 | 0.634824    0.668550    0.972423    0.895377    0.391622    1.000000    0.996466    0.634824    0.668550    0.953922    0.817073    0.963347    0.872593    5000        39.752650   0.089850    0.148635    135.018946 
[37m[36mINFO[0m[0m 03/26 06:13:49 | Cumulative gradient change saved at train_output/VLCS/ERM/[1]/250326_05-04-00_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 06:13:51 | ---
[37m[36mINFO[0m[0m 03/26 06:13:51 | test-domain validation(oracle) = 68.518%
[37m[36mINFO[0m[0m 03/26 06:13:51 | training-domain validation(iid) = 63.482%
[37m[36mINFO[0m[0m 03/26 06:13:51 | last = 63.482%
[37m[36mINFO[0m[0m 03/26 06:13:51 | last (inD) = 89.538%
[37m[36mINFO[0m[0m 03/26 06:13:51 | training-domain validation (iid, inD) = 89.538%
[37m[36mINFO[0m[0m 03/26 06:13:51 | === Summary ===
[37m[36mINFO[0m[0m 03/26 06:13:51 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 2 --hparams_seed 5
[37m[36mINFO[0m[0m 03/26 06:13:51 | Unique name: 250326_05-04-00_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 06:13:51 | Out path: train_output/VLCS/ERM/[1]/250326_05-04-00_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 06:13:51 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 06:13:51 | Dataset: VLCS

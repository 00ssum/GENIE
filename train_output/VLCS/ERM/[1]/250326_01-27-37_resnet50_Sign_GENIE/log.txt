[37m[36mINFO[0m[0m 03/26 01:27:37 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 2 --hparams_seed 2
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 2
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[1]/250326_01-27-37_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 2
	unique_name: 250326_01-27-37_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 7.73819221686661e-05
	batch_size: 10
	weight_decay: 8.231814847964724e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/26 01:27:37 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 01:27:37 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 01:27:37 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 01:27:37 | 
[37m[36mINFO[0m[0m 03/26 01:27:37 | Testenv name escaping te_L -> te_L
[37m[36mINFO[0m[0m 03/26 01:27:37 | Test envs = [1], name = te_L
[37m[36mINFO[0m[0m 03/26 01:27:37 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/26 01:27:37 | Batch sizes for each domain: [10, 0, 10, 10] (total=30)
[37m[36mINFO[0m[0m 03/26 01:27:37 | steps-per-epoch for each domain: 113.20, 262.60, 270.10 -> min = 113.20
[37m[36mINFO[0m[0m 03/26 01:27:38 | # of params = 23518277
[37m[36mINFO[0m[0m 03/26 01:29:53 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 01:29:54 | 0.467294    0.459510    0.484066    0.470377    1.341343    0.620141    0.593640    0.467294    0.459510    0.391851    0.358232    0.440207    0.459259    0           0.000000    1.947108    1.103023    133.954918 
[37m[36mINFO[0m[0m 03/26 01:32:36 | 0.632000    0.647834    0.878051    0.873320    0.371697    0.997350    0.996466    0.632000    0.647834    0.800076    0.782012    0.836727    0.841481    200         1.766784    0.506063    0.122877    137.560201 
[37m[36mINFO[0m[0m 03/26 01:35:20 | 0.587765    0.598870    0.867147    0.852160    0.382494    1.000000    0.992933    0.587765    0.598870    0.766565    0.757622    0.834876    0.805926    400         3.533569    0.316823    0.147322    135.306496 
[37m[36mINFO[0m[0m 03/26 01:38:08 | 0.548706    0.555556    0.883388    0.862270    0.375974    0.996466    0.996466    0.548706    0.555556    0.795126    0.762195    0.858571    0.828148    600         5.300353    0.315086    0.142065    139.594485 
[37m[36mINFO[0m[0m 03/26 01:40:58 | 0.671059    0.679849    0.911379    0.884996    0.313826    0.997350    0.992933    0.671059    0.679849    0.854151    0.783537    0.882636    0.878519    800         7.067138    0.276839    0.154502    138.845694 
[37m[36mINFO[0m[0m 03/26 01:43:46 | 0.643765    0.666667    0.915546    0.880666    0.319579    0.993816    0.992933    0.643765    0.666667    0.858340    0.795732    0.894484    0.853333    1000        8.833922    0.253223    0.144917    138.940682 
[37m[36mINFO[0m[0m 03/26 01:46:34 | 0.608471    0.612053    0.922118    0.890833    0.314325    1.000000    0.996466    0.608471    0.612053    0.865575    0.806402    0.900777    0.869630    1200        10.600707   0.241785    0.140514    139.881093 
[37m[36mINFO[0m[0m 03/26 01:49:20 | 0.623059    0.649718    0.908304    0.878358    0.355287    0.993816    0.996466    0.623059    0.649718    0.835872    0.792683    0.895224    0.845926    1400        12.367491   0.222884    0.147190    136.588945 
[37m[36mINFO[0m[0m 03/26 01:52:01 | 0.646118    0.662900    0.930520    0.887475    0.314115    0.996466    0.989399    0.646118    0.662900    0.887281    0.804878    0.907812    0.868148    1600        14.134276   0.208640    0.118177    137.661524 
[37m[36mINFO[0m[0m 03/26 01:54:48 | 0.625882    0.653484    0.934776    0.889992    0.334801    1.000000    1.000000    0.625882    0.653484    0.886519    0.801829    0.917808    0.868148    1800        15.901060   0.212323    0.143455    137.981723 
[37m[36mINFO[0m[0m 03/26 01:57:32 | 0.663529    0.685499    0.940379    0.891327    0.308863    1.000000    0.996466    0.663529    0.685499    0.891851    0.806402    0.929285    0.871111    2000        17.667845   0.202691    0.128470    138.477515 
[37m[36mINFO[0m[0m 03/26 02:00:19 | 0.626353    0.645951    0.929111    0.886137    0.341966    0.993816    0.989399    0.626353    0.645951    0.883854    0.820122    0.909663    0.848889    2200        19.434629   0.183456    0.149572    136.304588 
[37m[36mINFO[0m[0m 03/26 02:03:00 | 0.585412    0.596987    0.950095    0.883862    0.373222    0.999117    0.996466    0.585412    0.596987    0.906702    0.800305    0.944465    0.854815    2400        21.201413   0.177383    0.121006    137.256196 
[37m[36mINFO[0m[0m 03/26 02:05:44 | 0.648471    0.664783    0.940120    0.883411    0.376556    0.999117    0.996466    0.648471    0.664783    0.895659    0.804878    0.925583    0.848889    2600        22.968198   0.168466    0.141877    135.161697 
[37m[36mINFO[0m[0m 03/26 02:08:28 | 0.643294    0.659134    0.954426    0.894095    0.350641    1.000000    0.989399    0.643294    0.659134    0.916222    0.826220    0.947057    0.866667    2800        24.734982   0.146301    0.122801    139.563239 
[37m[36mINFO[0m[0m 03/26 02:11:13 | 0.680471    0.694915    0.945220    0.877789    0.499835    0.998233    0.992933    0.680471    0.694915    0.905179    0.804878    0.932247    0.835556    3000        26.501767   0.139279    0.158022    134.246106 
[37m[36mINFO[0m[0m 03/26 02:13:58 | 0.590118    0.612053    0.961642    0.892561    0.374433    0.999117    0.992933    0.590118    0.612053    0.927647    0.800305    0.958164    0.884444    3200        28.268551   0.141455    0.145464    135.537834 
[37m[36mINFO[0m[0m 03/26 02:16:44 | 0.648941    0.681733    0.944694    0.881548    0.422284    0.992933    0.982332    0.648941    0.681733    0.905941    0.792683    0.935209    0.869630    3400        30.035336   0.120280    0.137806    138.665749 
[37m[36mINFO[0m[0m 03/26 02:19:29 | 0.644706    0.676083    0.939127    0.872096    0.509675    1.000000    0.996466    0.644706    0.676083    0.903275    0.809451    0.914106    0.810370    3600        31.802120   0.124130    0.139886    136.721863 
[37m[36mINFO[0m[0m 03/26 02:22:14 | 0.632471    0.664783    0.962612    0.887827    0.381300    0.999117    0.996466    0.632471    0.664783    0.939071    0.801829    0.949648    0.865185    3800        33.568905   0.139899    0.142161    136.875166 
[37m[36mINFO[0m[0m 03/26 02:24:58 | 0.575059    0.598870    0.951891    0.881074    0.373912    1.000000    0.992933    0.575059    0.598870    0.908987    0.786585    0.946686    0.863704    4000        35.335689   0.129397    0.137409    136.029441 
[37m[36mINFO[0m[0m 03/26 02:27:41 | 0.578824    0.598870    0.960993    0.865646    0.479309    0.997350    0.982332    0.578824    0.598870    0.934501    0.782012    0.951129    0.832593    4200        37.102473   0.123926    0.132946    136.876204 
[37m[36mINFO[0m[0m 03/26 02:30:27 | 0.632471    0.644068    0.965064    0.882375    0.397595    0.998233    0.985866    0.632471    0.644068    0.942498    0.807927    0.954461    0.853333    4400        38.869258   0.104171    0.149977    136.036088 
[37m[36mINFO[0m[0m 03/26 02:33:10 | 0.660235    0.681733    0.952046    0.882799    0.527868    1.000000    0.992933    0.660235    0.681733    0.925743    0.812500    0.930396    0.842963    4600        40.636042   0.123521    0.129921    136.131622 
[37m[36mINFO[0m[0m 03/26 02:35:51 | 0.624941    0.644068    0.973973    0.877865    0.398435    0.999117    0.996466    0.624941    0.644068    0.953161    0.792683    0.969641    0.844444    4800        42.402827   0.091355    0.148108    132.054422 
[37m[36mINFO[0m[0m 03/26 02:38:34 | 0.644235    0.689266    0.976496    0.888843    0.454501    1.000000    0.996466    0.644235    0.689266    0.953922    0.804878    0.975565    0.865185    5000        44.169611   0.099753    0.130254    137.061881 
[37m[36mINFO[0m[0m 03/26 02:38:34 | Cumulative gradient change saved at train_output/VLCS/ERM/[1]/250326_01-27-37_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 02:38:36 | ---
[37m[36mINFO[0m[0m 03/26 02:38:36 | test-domain validation(oracle) = 68.047%
[37m[36mINFO[0m[0m 03/26 02:38:36 | training-domain validation(iid) = 64.329%
[37m[36mINFO[0m[0m 03/26 02:38:36 | last = 64.424%
[37m[36mINFO[0m[0m 03/26 02:38:36 | last (inD) = 88.884%
[37m[36mINFO[0m[0m 03/26 02:38:36 | training-domain validation (iid, inD) = 89.410%
[37m[36mINFO[0m[0m 03/26 02:38:36 | === Summary ===
[37m[36mINFO[0m[0m 03/26 02:38:36 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 2 --hparams_seed 2
[37m[36mINFO[0m[0m 03/26 02:38:36 | Unique name: 250326_01-27-37_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 02:38:36 | Out path: train_output/VLCS/ERM/[1]/250326_01-27-37_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 02:38:36 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 02:38:36 | Dataset: VLCS

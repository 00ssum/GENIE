[37m[36mINFO[0m[0m 03/25 20:36:16 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 1 --hparams_seed 17
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 17
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[1]/250325_20-36-16_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250325_20-36-16_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.0002990700776954947
	batch_size: 8
	weight_decay: 4.0966675521600606e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/25 20:36:16 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 20:36:16 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 20:36:16 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 20:36:16 | 
[37m[36mINFO[0m[0m 03/25 20:36:16 | Testenv name escaping te_L -> te_L
[37m[36mINFO[0m[0m 03/25 20:36:16 | Test envs = [1], name = te_L
[37m[36mINFO[0m[0m 03/25 20:36:16 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/25 20:36:16 | Batch sizes for each domain: [8, 0, 8, 8] (total=24)
[37m[36mINFO[0m[0m 03/25 20:36:16 | steps-per-epoch for each domain: 141.50, 328.25, 337.62 -> min = 141.50
[37m[36mINFO[0m[0m 03/25 20:36:18 | # of params = 23518277
[37m[36mINFO[0m[0m 03/25 20:38:34 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 20:38:34 | 0.467765    0.463277    0.507805    0.512953    1.279497    0.613958    0.618375    0.467765    0.463277    0.445925    0.490854    0.463532    0.429630    0           0.000000    1.713505    0.917968    135.158227 
[37m[36mINFO[0m[0m 03/25 20:41:21 | 0.641412    0.619586    0.868562    0.865837    0.349803    0.993816    0.992933    0.641412    0.619586    0.782178    0.794207    0.829693    0.810370    200         1.413428    0.514114    0.132742    140.878881 
[37m[36mINFO[0m[0m 03/25 20:44:09 | 0.534588    0.525424    0.880692    0.864853    0.387146    0.997350    0.996466    0.534588    0.525424    0.792079    0.774390    0.852647    0.823704    400         2.826855    0.356060    0.131325    141.072291 
[37m[36mINFO[0m[0m 03/25 20:46:50 | 0.654118    0.642185    0.891875    0.875111    0.342701    0.998233    0.985866    0.654118    0.642185    0.808454    0.823171    0.868937    0.816296    600         4.240283    0.343057    0.130258    135.114887 
[37m[36mINFO[0m[0m 03/25 20:49:33 | 0.671529    0.661017    0.884583    0.867509    0.347695    1.000000    0.996466    0.671529    0.661017    0.797030    0.794207    0.856720    0.811852    800         5.653710    0.319636    0.145533    134.083102 
[37m[36mINFO[0m[0m 03/25 20:52:15 | 0.580235    0.581921    0.886886    0.854258    0.428173    0.996466    0.975265    0.580235    0.581921    0.786367    0.766768    0.877823    0.820741    1000        7.067138    0.281340    0.122925    137.511873 
[37m[36mINFO[0m[0m 03/25 20:55:00 | 0.690824    0.711864    0.883601    0.861629    0.372337    0.997350    0.992933    0.690824    0.711864    0.786367    0.766768    0.867086    0.825185    1200        8.480565    0.278080    0.143663    135.808840 
[37m[36mINFO[0m[0m 03/25 20:57:48 | 0.618824    0.600753    0.916181    0.883188    0.324631    0.999117    0.989399    0.618824    0.600753    0.856055    0.821646    0.893373    0.838519    1400        9.893993    0.266566    0.133428    141.201364 
[37m[36mINFO[0m[0m 03/25 21:00:25 | 0.617882    0.598870    0.926409    0.883074    0.320445    1.000000    0.989399    0.617882    0.598870    0.862529    0.809451    0.916698    0.850370    1600        11.307420   0.248895    0.115152    134.477476 
[37m[36mINFO[0m[0m 03/25 21:03:05 | 0.584471    0.568738    0.926012    0.869412    0.336932    0.999117    0.996466    0.584471    0.568738    0.864813    0.786585    0.914106    0.825185    1800        12.720848   0.240537    0.128412    134.358595 
[37m[36mINFO[0m[0m 03/25 21:05:48 | 0.687529    0.685499    0.919156    0.891959    0.351919    1.000000    0.992933    0.687529    0.685499    0.852247    0.841463    0.905220    0.841481    2000        14.134276   0.234805    0.131248    136.901865 
[37m[36mINFO[0m[0m 03/25 21:08:27 | 0.691294    0.679849    0.936315    0.883540    0.326179    0.999117    0.996466    0.691294    0.679849    0.884615    0.818598    0.925213    0.835556    2200        15.547703   0.212220    0.122154    134.739085 
[37m[36mINFO[0m[0m 03/25 21:11:10 | 0.572235    0.564972    0.909492    0.859507    0.397800    0.997350    0.996466    0.572235    0.564972    0.850343    0.783537    0.880785    0.798519    2400        16.961131   0.228867    0.135364    135.123988 
[37m[36mINFO[0m[0m 03/25 21:13:54 | 0.602824    0.596987    0.941780    0.884134    0.374197    0.997350    0.996466    0.602824    0.596987    0.898705    0.829268    0.929285    0.826667    2600        18.374558   0.177576    0.145659    135.355099 
[37m[36mINFO[0m[0m 03/25 21:16:37 | 0.671529    0.666667    0.916275    0.865167    0.393073    0.996466    0.989399    0.671529    0.666667    0.854912    0.795732    0.897445    0.810370    2800        19.787986   0.199353    0.124793    137.807462 
[37m[36mINFO[0m[0m 03/25 21:19:25 | 0.623529    0.619586    0.942579    0.889865    0.329338    0.996466    0.989399    0.623529    0.619586    0.896801    0.849085    0.934469    0.831111    3000        21.201413   0.198184    0.137908    140.799304 
[37m[36mINFO[0m[0m 03/25 21:22:09 | 0.654118    0.649718    0.942662    0.883497    0.362321    0.999117    0.996466    0.654118    0.649718    0.890327    0.814024    0.938541    0.840000    3200        22.614841   0.176334    0.139340    136.336544 
[37m[36mINFO[0m[0m 03/25 21:24:50 | 0.665412    0.651601    0.923011    0.865428    0.422139    0.997350    0.985866    0.665412    0.651601    0.857578    0.791159    0.914106    0.819259    3400        24.028269   0.179211    0.120508    136.468219 
[37m[36mINFO[0m[0m 03/25 21:27:34 | 0.620235    0.613936    0.937570    0.871473    0.411930    0.997350    0.996466    0.620235    0.613936    0.883854    0.795732    0.931507    0.822222    3600        25.441696   0.148403    0.131337    137.613123 
[37m[36mINFO[0m[0m 03/25 21:30:24 | 0.629647    0.621469    0.939896    0.871754    0.392482    1.000000    0.985866    0.629647    0.621469    0.892993    0.833841    0.926694    0.795556    3800        26.855124   0.174276    0.129659    144.006183 
[37m[36mINFO[0m[0m 03/25 21:33:11 | 0.624941    0.625235    0.956450    0.876165    0.396692    1.000000    1.000000    0.624941    0.625235    0.921554    0.801829    0.947797    0.826667    4000        28.268551   0.133531    0.143488    138.063642 
[37m[36mINFO[0m[0m 03/25 21:35:59 | 0.531294    0.510358    0.917538    0.852540    0.448105    0.988516    0.975265    0.531294    0.510358    0.864433    0.794207    0.899667    0.788148    4200        29.681979   0.147739    0.138315    140.385266 
[37m[36mINFO[0m[0m 03/25 21:38:39 | 0.584000    0.589454    0.941844    0.850826    0.531866    0.999117    0.971731    0.584000    0.589454    0.895278    0.789634    0.931137    0.791111    4400        31.095406   0.145785    0.113300    137.394859 
[37m[36mINFO[0m[0m 03/25 21:41:21 | 0.621176    0.625235    0.953677    0.867470    0.423689    0.999117    0.982332    0.621176    0.625235    0.920411    0.818598    0.941503    0.801481    4600        32.508834   0.122101    0.129683    136.318017 
[37m[36mINFO[0m[0m 03/25 21:44:06 | 0.661647    0.657250    0.968079    0.884005    0.429811    1.000000    0.996466    0.661647    0.657250    0.937928    0.815549    0.966309    0.840000    4800        33.922261   0.120905    0.133078    138.258069 
[37m[36mINFO[0m[0m 03/25 21:46:41 | 0.637647    0.640301    0.957274    0.869670    0.474802    0.999117    0.996466    0.637647    0.640301    0.922315    0.814024    0.950389    0.798519    5000        35.335689   0.126623    0.116846    131.545378 
[37m[36mINFO[0m[0m 03/25 21:46:41 | Cumulative gradient change saved at train_output/VLCS/ERM/[1]/250325_20-36-16_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 21:46:42 | ---
[37m[36mINFO[0m[0m 03/25 21:46:42 | test-domain validation(oracle) = 69.082%
[37m[36mINFO[0m[0m 03/25 21:46:42 | training-domain validation(iid) = 68.753%
[37m[36mINFO[0m[0m 03/25 21:46:42 | last = 63.765%
[37m[36mINFO[0m[0m 03/25 21:46:42 | last (inD) = 86.967%
[37m[36mINFO[0m[0m 03/25 21:46:42 | training-domain validation (iid, inD) = 89.196%
[37m[36mINFO[0m[0m 03/25 21:46:42 | === Summary ===
[37m[36mINFO[0m[0m 03/25 21:46:42 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 1 --hparams_seed 17
[37m[36mINFO[0m[0m 03/25 21:46:42 | Unique name: 250325_20-36-16_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 21:46:42 | Out path: train_output/VLCS/ERM/[1]/250325_20-36-16_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 21:46:42 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 21:46:42 | Dataset: VLCS

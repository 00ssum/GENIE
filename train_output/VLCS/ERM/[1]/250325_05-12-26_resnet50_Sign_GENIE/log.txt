[37m[36mINFO[0m[0m 03/25 05:12:26 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 1 --hparams_seed 6
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 6
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[1]/250325_05-12-26_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250325_05-12-26_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00016409882498047177
	batch_size: 16
	weight_decay: 0.00012909833738066306
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/25 05:12:26 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 05:12:26 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 05:12:26 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 05:12:26 | 
[37m[36mINFO[0m[0m 03/25 05:12:26 | Testenv name escaping te_L -> te_L
[37m[36mINFO[0m[0m 03/25 05:12:26 | Test envs = [1], name = te_L
[37m[36mINFO[0m[0m 03/25 05:12:26 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/25 05:12:26 | Batch sizes for each domain: [16, 0, 16, 16] (total=48)
[37m[36mINFO[0m[0m 03/25 05:12:26 | steps-per-epoch for each domain: 70.75, 164.12, 168.81 -> min = 70.75
[37m[36mINFO[0m[0m 03/25 05:12:27 | # of params = 23518277
[37m[36mINFO[0m[0m 03/25 05:15:09 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 05:15:09 | 0.466824    0.461394    0.481371    0.481169    1.452169    0.613958    0.618375    0.466824    0.461394    0.376618    0.419207    0.453536    0.405926    0           0.000000    1.834079    1.342229    160.464976 
[37m[36mINFO[0m[0m 03/25 05:18:29 | 0.543059    0.536723    0.876593    0.856272    0.352856    0.998233    0.996466    0.543059    0.536723    0.784082    0.754573    0.847464    0.817778    200         2.826855    0.425375    0.165405    166.549525 
[37m[36mINFO[0m[0m 03/25 05:21:35 | 0.701176    0.676083    0.910721    0.896319    0.309848    0.998233    1.000000    0.701176    0.676083    0.844631    0.844512    0.889300    0.844444    400         5.653710    0.270007    0.157390    154.689535 
[37m[36mINFO[0m[0m 03/25 05:24:46 | 0.572706    0.563089    0.908778    0.870908    0.331304    0.996466    0.996466    0.572706    0.563089    0.845011    0.788110    0.884857    0.828148    600         8.480565    0.244578    0.161874    158.107823 
[37m[36mINFO[0m[0m 03/25 05:27:55 | 0.580706    0.578154    0.930707    0.886997    0.293123    0.998233    0.996466    0.580706    0.578154    0.870526    0.818598    0.923362    0.845926    800         11.307420   0.224190    0.169412    155.523048 
[37m[36mINFO[0m[0m 03/25 05:30:59 | 0.660235    0.640301    0.945260    0.907976    0.293249    0.999117    0.992933    0.660235    0.640301    0.904417    0.864329    0.932247    0.866667    1000        14.134276   0.197832    0.158189    152.060228 
[37m[36mINFO[0m[0m 03/25 05:34:03 | 0.681882    0.647834    0.935340    0.896285    0.337970    0.994700    0.989399    0.681882    0.647834    0.884996    0.849085    0.926324    0.850370    1200        16.961131   0.160313    0.152285    153.975415 
[37m[36mINFO[0m[0m 03/25 05:37:15 | 0.632941    0.612053    0.949472    0.895036    0.312115    0.996466    0.985866    0.632941    0.612053    0.908225    0.841463    0.943725    0.857778    1400        19.787986   0.165103    0.170732    157.548117 
[37m[36mINFO[0m[0m 03/25 05:40:27 | 0.577882    0.572505    0.956815    0.886606    0.338814    0.999117    0.992933    0.577882    0.572505    0.912795    0.797256    0.958534    0.869630    1600        22.614841   0.141163    0.171426    158.184295 
[37m[36mINFO[0m[0m 03/25 05:43:36 | 0.641412    0.632768    0.957342    0.882580    0.363245    1.000000    0.989399    0.641412    0.632768    0.924600    0.809451    0.947427    0.848889    1800        25.441696   0.141212    0.161055    156.603239 
[37m[36mINFO[0m[0m 03/25 05:46:46 | 0.646588    0.632768    0.960558    0.888754    0.386558    1.000000    1.000000    0.646588    0.632768    0.925362    0.827744    0.956312    0.838519    2000        28.268551   0.118864    0.155675    158.592383 
[37m[36mINFO[0m[0m 03/25 05:49:56 | 0.634353    0.623352    0.974532    0.890786    0.374856    1.000000    0.992933    0.634353    0.623352    0.955065    0.821646    0.968530    0.857778    2200        31.095406   0.108831    0.167537    157.082928 
[37m[36mINFO[0m[0m 03/25 05:53:11 | 0.622118    0.608286    0.975471    0.889314    0.394837    0.999117    0.989399    0.622118    0.608286    0.955065    0.842988    0.972233    0.835556    2400        33.922261   0.093639    0.169063    160.238029 
[37m[36mINFO[0m[0m 03/25 05:56:19 | 0.632471    0.615819    0.972615    0.892552    0.406790    0.999117    0.985866    0.632471    0.615819    0.939832    0.839939    0.978897    0.851852    2600        36.749117   0.083086    0.163529    155.874346 
[37m[36mINFO[0m[0m 03/25 05:59:23 | 0.684235    0.674200    0.966503    0.882956    0.434834    1.000000    0.992933    0.684235    0.674200    0.940975    0.829268    0.958534    0.826667    2800        39.575972   0.081834    0.160720    152.229406 
[37m[36mINFO[0m[0m 03/25 06:02:38 | 0.640941    0.636535    0.977502    0.879921    0.407682    0.999117    0.992933    0.640941    0.636535    0.961158    0.821646    0.972233    0.825185    3000        42.402827   0.073413    0.166012    161.041672 
[37m[36mINFO[0m[0m 03/25 06:05:55 | 0.616941    0.604520    0.983202    0.881954    0.448394    1.000000    0.992933    0.616941    0.604520    0.971820    0.827744    0.977786    0.825185    3200        45.229682   0.072820    0.160079    164.929030 
[37m[36mINFO[0m[0m 03/25 06:09:07 | 0.627765    0.617702    0.972490    0.875814    0.434115    0.998233    0.992933    0.627765    0.617702    0.958111    0.804878    0.961126    0.829630    3400        48.056537   0.064123    0.159699    160.055376 
[37m[36mINFO[0m[0m 03/25 06:12:12 | 0.657412    0.655367    0.982582    0.882667    0.478420    1.000000    0.996466    0.657412    0.655367    0.971439    0.830793    0.976305    0.820741    3600        50.883392   0.062393    0.162769    152.865526 
[37m[36mINFO[0m[0m 03/25 06:15:17 | 0.596706    0.608286    0.984487    0.878051    0.497955    0.999117    0.996466    0.596706    0.608286    0.969155    0.812500    0.985191    0.825185    3800        53.710247   0.052386    0.166537    151.374193 
[37m[36mINFO[0m[0m 03/25 06:18:25 | 0.591529    0.583804    0.989969    0.887239    0.452081    1.000000    0.989399    0.591529    0.583804    0.982864    0.832317    0.987042    0.840000    4000        56.537102   0.046471    0.160154    156.542772 
[37m[36mINFO[0m[0m 03/25 06:21:33 | 0.641882    0.632768    0.984059    0.893013    0.603736    1.000000    0.982332    0.641882    0.632768    0.971059    0.856707    0.981118    0.840000    4200        59.363958   0.036769    0.163659    154.819003 
[37m[36mINFO[0m[0m 03/25 06:24:48 | 0.607059    0.591337    0.991587    0.886194    0.585724    1.000000    0.989399    0.607059    0.591337    0.984387    0.826220    0.990374    0.842963    4400        62.190813   0.043977    0.165962    162.350983 
[37m[36mINFO[0m[0m 03/25 06:27:54 | 0.640471    0.627119    0.989191    0.892557    0.553133    0.999117    0.996466    0.640471    0.627119    0.984006    0.832317    0.984450    0.848889    4600        65.017668   0.035162    0.158737    153.955724 
[37m[36mINFO[0m[0m 03/25 06:31:00 | 0.625412    0.613936    0.993175    0.892439    0.581063    0.999117    0.992933    0.625412    0.613936    0.987814    0.839939    0.992595    0.844444    4800        67.844523   0.029997    0.160494    153.390646 
[37m[36mINFO[0m[0m 03/25 06:34:02 | 0.620706    0.621469    0.981673    0.865234    0.616699    0.995583    0.985866    0.620706    0.621469    0.979056    0.823171    0.970381    0.786667    5000        70.671378   0.032328    0.158966    150.189516 
[37m[36mINFO[0m[0m 03/25 06:34:02 | Cumulative gradient change saved at train_output/VLCS/ERM/[1]/250325_05-12-26_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 06:34:03 | ---
[37m[36mINFO[0m[0m 03/25 06:34:03 | test-domain validation(oracle) = 70.118%
[37m[36mINFO[0m[0m 03/25 06:34:03 | training-domain validation(iid) = 66.024%
[37m[36mINFO[0m[0m 03/25 06:34:03 | last = 62.071%
[37m[36mINFO[0m[0m 03/25 06:34:03 | last (inD) = 86.523%
[37m[36mINFO[0m[0m 03/25 06:34:03 | training-domain validation (iid, inD) = 90.798%
[37m[36mINFO[0m[0m 03/25 06:34:03 | === Summary ===
[37m[36mINFO[0m[0m 03/25 06:34:03 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 1 --hparams_seed 6
[37m[36mINFO[0m[0m 03/25 06:34:03 | Unique name: 250325_05-12-26_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 06:34:03 | Out path: train_output/VLCS/ERM/[1]/250325_05-12-26_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 06:34:03 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 06:34:03 | Dataset: VLCS

[37m[36mINFO[0m[0m 03/26 00:16:25 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 2 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[1]/250326_00-16-25_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 2
	unique_name: 250326_00-16-25_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 3.1159521264763664e-05
	batch_size: 11
	weight_decay: 1.4650833494643601e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/26 00:16:25 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 00:16:25 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 00:16:25 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 00:16:25 | 
[37m[36mINFO[0m[0m 03/26 00:16:25 | Testenv name escaping te_L -> te_L
[37m[36mINFO[0m[0m 03/26 00:16:25 | Test envs = [1], name = te_L
[37m[36mINFO[0m[0m 03/26 00:16:25 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/26 00:16:25 | Batch sizes for each domain: [11, 0, 11, 11] (total=33)
[37m[36mINFO[0m[0m 03/26 00:16:25 | steps-per-epoch for each domain: 102.91, 238.73, 245.55 -> min = 102.91
[37m[36mINFO[0m[0m 03/26 00:16:26 | # of params = 23518277
[37m[36mINFO[0m[0m 03/26 00:18:45 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 00:18:45 | 0.467294    0.459510    0.484066    0.470377    1.294731    0.620141    0.593640    0.467294    0.459510    0.391851    0.358232    0.440207    0.459259    0           0.000000    1.972280    1.164867    137.767335 
[37m[36mINFO[0m[0m 03/26 00:21:29 | 0.656471    0.674200    0.888065    0.878330    0.331942    0.995583    0.996466    0.656471    0.674200    0.825590    0.789634    0.843021    0.848889    200         1.943463    0.487717    0.136108    136.607817 
[37m[36mINFO[0m[0m 03/26 00:24:13 | 0.601882    0.630885    0.901032    0.881639    0.328132    0.996466    0.992933    0.601882    0.630885    0.834730    0.794207    0.871899    0.857778    400         3.886926    0.312327    0.127235    138.446545 
[37m[36mINFO[0m[0m 03/26 00:26:57 | 0.555765    0.593220    0.891480    0.862821    0.371162    1.000000    0.996466    0.555765    0.593220    0.808835    0.768293    0.865605    0.823704    600         5.830389    0.304202    0.155295    133.068803 
[37m[36mINFO[0m[0m 03/26 00:29:39 | 0.597647    0.623352    0.910654    0.887043    0.322472    1.000000    0.992933    0.597647    0.623352    0.840442    0.791159    0.891522    0.877037    800         7.773852    0.269741    0.132536    135.656147 
[37m[36mINFO[0m[0m 03/26 00:32:26 | 0.608941    0.634652    0.919704    0.887622    0.313234    0.999117    0.992933    0.608941    0.634652    0.863290    0.800305    0.896705    0.869630    1000        9.717314    0.239416    0.148462    137.151236 
[37m[36mINFO[0m[0m 03/26 00:35:15 | 0.654118    0.685499    0.909436    0.879621    0.333589    0.992049    0.992933    0.654118    0.685499    0.848439    0.789634    0.887819    0.856296    1200        11.660777   0.236231    0.153235    138.444920 
[37m[36mINFO[0m[0m 03/26 00:37:56 | 0.612706    0.636535    0.935864    0.885504    0.303842    0.999117    0.992933    0.612706    0.636535    0.889185    0.785061    0.919289    0.878519    1400        13.604240   0.224693    0.121052    136.423728 
[37m[36mINFO[0m[0m 03/26 00:40:42 | 0.658824    0.689266    0.937339    0.888492    0.323087    1.000000    0.996466    0.658824    0.689266    0.896801    0.820122    0.915217    0.848889    1600        15.547703   0.214355    0.144430    137.413048 
[37m[36mINFO[0m[0m 03/26 00:43:27 | 0.625882    0.647834    0.948157    0.893763    0.311778    1.000000    0.992933    0.625882    0.647834    0.905560    0.823171    0.938912    0.865185    1800        17.491166   0.195182    0.136301    137.123679 
[37m[36mINFO[0m[0m 03/26 00:46:12 | 0.652235    0.677966    0.923418    0.879170    0.412496    0.994700    0.992933    0.652235    0.677966    0.890327    0.794207    0.885228    0.850370    2000        19.434629   0.180273    0.126176    140.115073 
[37m[36mINFO[0m[0m 03/26 00:48:58 | 0.591529    0.619586    0.947226    0.884702    0.359237    1.000000    0.992933    0.591529    0.619586    0.898324    0.804878    0.943354    0.856296    2200        21.378092   0.158382    0.140213    137.515742 
[37m[36mINFO[0m[0m 03/26 00:51:43 | 0.623529    0.638418    0.947238    0.888407    0.352601    0.997350    0.996466    0.623529    0.638418    0.915080    0.810976    0.929285    0.857778    2400        23.321555   0.153502    0.130910    138.917490 
[37m[36mINFO[0m[0m 03/26 00:54:30 | 0.586353    0.613936    0.935885    0.871952    0.394618    0.999117    0.989399    0.586353    0.613936    0.878142    0.782012    0.930396    0.844444    2600        25.265018   0.159683    0.145404    137.920897 
[37m[36mINFO[0m[0m 03/26 00:57:12 | 0.640000    0.674200    0.959722    0.898150    0.292182    1.000000    0.992933    0.640000    0.674200    0.928408    0.817073    0.950759    0.884444    2800        27.208481   0.153189    0.124430    137.268522 
[37m[36mINFO[0m[0m 03/26 00:59:57 | 0.537412    0.570621    0.937554    0.871288    0.382734    1.000000    0.996466    0.537412    0.570621    0.880046    0.775915    0.932618    0.841481    3000        29.151943   0.125097    0.144090    136.076378 
[37m[36mINFO[0m[0m 03/26 01:02:40 | 0.656941    0.693032    0.953171    0.887926    0.379934    0.998233    0.989399    0.656941    0.693032    0.910891    0.800305    0.950389    0.874074    3200        31.095406   0.132899    0.120863    138.827980 
[37m[36mINFO[0m[0m 03/26 01:05:26 | 0.628235    0.649718    0.961424    0.884717    0.337986    0.999117    0.992933    0.628235    0.649718    0.930693    0.806402    0.954461    0.854815    3400        33.038869   0.141846    0.148340    137.004457 
[37m[36mINFO[0m[0m 03/26 01:08:09 | 0.688000    0.719397    0.953060    0.882541    0.458765    0.999117    0.992933    0.688000    0.719397    0.907083    0.785061    0.952980    0.869630    3600        34.982332   0.104172    0.143114    134.211321 
[37m[36mINFO[0m[0m 03/26 01:10:57 | 0.672000    0.709981    0.946974    0.886602    0.361320    0.992049    0.989399    0.672000    0.709981    0.917365    0.817073    0.931507    0.853333    3800        36.925795   0.122274    0.148768    137.874541 
[37m[36mINFO[0m[0m 03/26 01:13:45 | 0.634353    0.638418    0.972398    0.892604    0.363780    1.000000    0.992933    0.634353    0.638418    0.951257    0.804878    0.965939    0.880000    4000        38.869258   0.126995    0.142849    139.218310 
[37m[36mINFO[0m[0m 03/26 01:16:30 | 0.623059    0.640301    0.975882    0.885675    0.427506    1.000000    0.985866    0.623059    0.640301    0.954303    0.791159    0.973343    0.880000    4200        40.812721   0.106343    0.133839    138.228736 
[37m[36mINFO[0m[0m 03/26 01:19:18 | 0.641412    0.672316    0.923330    0.864068    0.570889    0.994700    0.985866    0.641412    0.672316    0.867479    0.751524    0.907812    0.854815    4400        42.756184   0.092853    0.150424    138.322274 
[37m[36mINFO[0m[0m 03/26 01:22:02 | 0.603765    0.615819    0.966781    0.875148    0.465467    1.000000    0.992933    0.603765    0.615819    0.944402    0.786585    0.955942    0.845926    4600        44.699647   0.092653    0.121450    139.267172 
[37m[36mINFO[0m[0m 03/26 01:24:46 | 0.631059    0.659134    0.975328    0.884033    0.492947    1.000000    0.989399    0.631059    0.659134    0.961158    0.806402    0.964828    0.856296    4800        46.643110   0.080340    0.144414    135.843466 
[37m[36mINFO[0m[0m 03/26 01:27:32 | 0.621176    0.642185    0.962908    0.869033    0.457627    0.999117    0.996466    0.621176    0.642185    0.931074    0.798780    0.958534    0.811852    5000        48.586572   0.071686    0.128332    139.623099 
[37m[36mINFO[0m[0m 03/26 01:27:32 | Cumulative gradient change saved at train_output/VLCS/ERM/[1]/250326_00-16-25_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 01:27:33 | ---
[37m[36mINFO[0m[0m 03/26 01:27:33 | test-domain validation(oracle) = 68.800%
[37m[36mINFO[0m[0m 03/26 01:27:33 | training-domain validation(iid) = 64.000%
[37m[36mINFO[0m[0m 03/26 01:27:33 | last = 62.118%
[37m[36mINFO[0m[0m 03/26 01:27:33 | last (inD) = 86.903%
[37m[36mINFO[0m[0m 03/26 01:27:33 | training-domain validation (iid, inD) = 89.815%
[37m[36mINFO[0m[0m 03/26 01:27:33 | === Summary ===
[37m[36mINFO[0m[0m 03/26 01:27:33 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 2 --hparams_seed 1
[37m[36mINFO[0m[0m 03/26 01:27:33 | Unique name: 250326_00-16-25_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 01:27:33 | Out path: train_output/VLCS/ERM/[1]/250326_00-16-25_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 01:27:33 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 01:27:33 | Dataset: VLCS

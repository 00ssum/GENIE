[37m[36mINFO[0m[0m 03/25 01:19:42 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 1 --hparams_seed 3
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 3
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[1]/250325_01-19-42_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250325_01-19-42_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00018664964766736356
	batch_size: 13
	weight_decay: 0.0001969969539389593
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/25 01:19:42 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 01:19:42 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 01:19:42 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 01:19:42 | 
[37m[36mINFO[0m[0m 03/25 01:19:42 | Testenv name escaping te_L -> te_L
[37m[36mINFO[0m[0m 03/25 01:19:42 | Test envs = [1], name = te_L
[37m[36mINFO[0m[0m 03/25 01:19:42 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/25 01:19:42 | Batch sizes for each domain: [13, 0, 13, 13] (total=39)
[37m[36mINFO[0m[0m 03/25 01:19:42 | steps-per-epoch for each domain: 87.08, 202.00, 207.77 -> min = 87.08
[37m[36mINFO[0m[0m 03/25 01:19:43 | # of params = 23518277
[37m[36mINFO[0m[0m 03/25 01:22:04 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 01:22:04 | 0.466824    0.461394    0.481878    0.481677    1.319431    0.613958    0.618375    0.466824    0.461394    0.378142    0.420732    0.453536    0.405926    0           0.000000    1.876466    0.972208    140.105054 
[37m[36mINFO[0m[0m 03/25 01:25:00 | 0.669647    0.645951    0.876603    0.878886    0.351049    0.984099    0.982332    0.669647    0.645951    0.814166    0.824695    0.831544    0.829630    200         2.296820    0.461735    0.132609    148.763702 
[37m[36mINFO[0m[0m 03/25 01:27:53 | 0.661176    0.647834    0.901928    0.895782    0.303350    0.998233    1.000000    0.661176    0.647834    0.827875    0.839939    0.879674    0.847407    400         4.593640    0.320492    0.137544    145.814665 
[37m[36mINFO[0m[0m 03/25 01:30:41 | 0.637176    0.625235    0.907312    0.875889    0.308157    1.000000    0.996466    0.637176    0.625235    0.825971    0.792683    0.895964    0.838519    600         6.890459    0.295690    0.130340    142.112282 
[37m[36mINFO[0m[0m 03/25 01:33:34 | 0.655059    0.644068    0.929198    0.897377    0.272808    1.000000    0.992933    0.655059    0.644068    0.870526    0.839939    0.917068    0.859259    800         9.187279    0.235686    0.127339    147.827111 
[37m[36mINFO[0m[0m 03/25 01:36:38 | 0.643765    0.630885    0.926296    0.888027    0.311479    1.000000    0.996466    0.643765    0.630885    0.863671    0.823171    0.915217    0.844444    1000        11.484099   0.220505    0.130987    157.558728 
[37m[36mINFO[0m[0m 03/25 01:39:37 | 0.618824    0.606403    0.934850    0.895387    0.301371    1.000000    0.992933    0.618824    0.606403    0.881188    0.838415    0.923362    0.854815    1200        13.780919   0.223461    0.139346    150.784079 
[37m[36mINFO[0m[0m 03/25 01:42:42 | 0.616941    0.604520    0.932170    0.883772    0.353170    1.000000    0.992933    0.616941    0.604520    0.871668    0.810976    0.924843    0.847407    1400        16.077739   0.200088    0.138716    157.381990 
[37m[36mINFO[0m[0m 03/25 01:45:43 | 0.629176    0.619586    0.929392    0.875149    0.390801    1.000000    1.000000    0.629176    0.619586    0.878142    0.798780    0.910033    0.826667    1600        18.374558   0.204956    0.144510    152.281531 
[37m[36mINFO[0m[0m 03/25 01:48:47 | 0.652235    0.638418    0.944918    0.883378    0.329671    0.999117    0.992933    0.652235    0.638418    0.894136    0.821646    0.941503    0.835556    1800        20.671378   0.174505    0.143250    155.141598 
[37m[36mINFO[0m[0m 03/25 01:51:42 | 0.610353    0.596987    0.944709    0.874061    0.328042    1.000000    1.000000    0.610353    0.596987    0.892993    0.788110    0.941133    0.834074    2000        22.968198   0.181311    0.137454    147.027036 
[37m[36mINFO[0m[0m 03/25 01:54:25 | 0.631059    0.621469    0.955987    0.901604    0.343822    0.999117    0.996466    0.631059    0.621469    0.916603    0.849085    0.952240    0.859259    2200        25.265018   0.159874    0.131935    137.146930 
[37m[36mINFO[0m[0m 03/25 01:57:12 | 0.587294    0.581921    0.933559    0.858899    0.428383    1.000000    0.996466    0.587294    0.581921    0.875095    0.771341    0.925583    0.808889    2400        27.561837   0.131328    0.136622    139.277298 
[37m[36mINFO[0m[0m 03/25 02:00:07 | 0.614118    0.600753    0.950685    0.874379    0.391405    1.000000    0.996466    0.614118    0.600753    0.912034    0.789634    0.940022    0.837037    2600        29.858657   0.129931    0.141798    147.023446 
[37m[36mINFO[0m[0m 03/25 02:02:56 | 0.640471    0.629002    0.955837    0.894812    0.339745    1.000000    0.996466    0.640471    0.629002    0.908606    0.809451    0.958904    0.878519    2800        32.155477   0.135463    0.137565    141.163975 
[37m[36mINFO[0m[0m 03/25 02:05:54 | 0.646588    0.651601    0.964133    0.898208    0.382540    0.998233    1.000000    0.646588    0.651601    0.935263    0.835366    0.958904    0.859259    3000        34.452297   0.121986    0.134241    150.959168 
[37m[36mINFO[0m[0m 03/25 02:09:00 | 0.672471    0.661017    0.950356    0.871649    0.441396    0.999117    1.000000    0.672471    0.661017    0.908225    0.794207    0.943725    0.820741    3200        36.749117   0.115049    0.146613    157.136273 
[37m[36mINFO[0m[0m 03/25 02:12:06 | 0.624471    0.615819    0.972196    0.885691    0.408498    0.999117    1.000000    0.624471    0.615819    0.947829    0.817073    0.969641    0.840000    3400        39.045936   0.100267    0.143409    157.475909 
[37m[36mINFO[0m[0m 03/25 02:15:13 | 0.600471    0.591337    0.977590    0.882581    0.429723    0.999117    0.996466    0.600471    0.591337    0.957350    0.821646    0.976305    0.829630    3600        41.342756   0.089063    0.146070    157.983384 
[37m[36mINFO[0m[0m 03/25 02:18:07 | 0.659765    0.661017    0.972511    0.887343    0.464348    1.000000    0.992933    0.659765    0.661017    0.950114    0.823171    0.967419    0.845926    3800        43.639576   0.082137    0.144580    144.583847 
[37m[36mINFO[0m[0m 03/25 02:21:06 | 0.648471    0.649718    0.978132    0.884556    0.389590    1.000000    0.996466    0.648471    0.649718    0.957350    0.821646    0.977046    0.835556    4000        45.936396   0.084527    0.133122    152.043660 
[37m[36mINFO[0m[0m 03/25 02:24:04 | 0.600000    0.608286    0.981030    0.881579    0.438038    1.000000    0.996466    0.600000    0.608286    0.963823    0.820122    0.979267    0.828148    4200        48.233216   0.066722    0.140073    150.793051 
[37m[36mINFO[0m[0m 03/25 02:27:06 | 0.680471    0.679849    0.973008    0.880315    0.473705    1.000000    0.992933    0.680471    0.679849    0.950495    0.810976    0.968530    0.837037    4400        50.530035   0.087530    0.141158    153.015605 
[37m[36mINFO[0m[0m 03/25 02:30:09 | 0.622588    0.600753    0.980064    0.886632    0.451705    1.000000    0.996466    0.622588    0.600753    0.966108    0.832317    0.974084    0.831111    4600        52.826855   0.070426    0.145806    154.118342 
[37m[36mINFO[0m[0m 03/25 02:32:59 | 0.682353    0.666667    0.984433    0.894186    0.465816    1.000000    1.000000    0.682353    0.666667    0.971439    0.827744    0.981859    0.854815    4800        55.123675   0.070239    0.140161    142.333435 
[37m[36mINFO[0m[0m 03/25 02:35:47 | 0.624941    0.596987    0.982798    0.885714    0.433525    0.999117    0.989399    0.624941    0.596987    0.973343    0.827744    0.975935    0.840000    5000        57.420495   0.052445    0.133765    141.133056 
[37m[36mINFO[0m[0m 03/25 02:35:47 | Cumulative gradient change saved at train_output/VLCS/ERM/[1]/250325_01-19-42_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 02:35:49 | ---
[37m[36mINFO[0m[0m 03/25 02:35:49 | test-domain validation(oracle) = 68.047%
[37m[36mINFO[0m[0m 03/25 02:35:49 | training-domain validation(iid) = 63.106%
[37m[36mINFO[0m[0m 03/25 02:35:49 | last = 62.494%
[37m[36mINFO[0m[0m 03/25 02:35:49 | last (inD) = 88.571%
[37m[36mINFO[0m[0m 03/25 02:35:49 | training-domain validation (iid, inD) = 90.160%
[37m[36mINFO[0m[0m 03/25 02:35:49 | === Summary ===
[37m[36mINFO[0m[0m 03/25 02:35:49 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS --trial_seed 1 --hparams_seed 3
[37m[36mINFO[0m[0m 03/25 02:35:49 | Unique name: 250325_01-19-42_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 02:35:49 | Out path: train_output/VLCS/ERM/[1]/250325_01-19-42_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 02:35:49 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 02:35:49 | Dataset: VLCS

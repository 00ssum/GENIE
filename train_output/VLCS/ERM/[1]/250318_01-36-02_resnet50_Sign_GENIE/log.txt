[37m[36mINFO[0m[0m 03/18 01:36:02 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[1]/250318_01-36-02_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250318_01-36-02_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/18 01:36:02 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 01:36:02 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 01:36:02 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 01:36:02 | 
[37m[36mINFO[0m[0m 03/18 01:36:02 | Testenv name escaping te_L -> te_L
[37m[36mINFO[0m[0m 03/18 01:36:02 | Test envs = [1], name = te_L
[37m[36mINFO[0m[0m 03/18 01:36:02 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/18 01:36:02 | Batch sizes for each domain: [32, 0, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/18 01:36:02 | steps-per-epoch for each domain: 35.38, 82.06, 84.41 -> min = 35.38
[37m[36mINFO[0m[0m 03/18 01:36:04 | # of params = 23518277
[37m[36mINFO[0m[0m 03/18 01:38:21 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 01:38:21 | 0.459765    0.489642    0.479821    0.487365    1.413653    0.611307    0.628975    0.459765    0.489642    0.384615    0.387195    0.443539    0.445926    0           0.000000    1.800293    2.184011    135.184303 
[37m[36mINFO[0m[0m 03/18 01:41:50 | 0.629176    0.623352    0.913049    0.890601    0.291024    0.998233    1.000000    0.629176    0.623352    0.856055    0.814024    0.884857    0.857778    200         5.653710    0.379059    0.380554    132.307309 
[37m[36mINFO[0m[0m 03/18 01:45:10 | 0.656471    0.647834    0.925002    0.889950    0.308684    0.998233    1.000000    0.656471    0.647834    0.867479    0.797256    0.909293    0.872593    400         11.307420   0.225024    0.330096    134.329100 
[37m[36mINFO[0m[0m 03/18 01:48:19 | 0.617882    0.612053    0.944982    0.889323    0.324497    0.999117    0.996466    0.617882    0.612053    0.900990    0.803354    0.934839    0.868148    600         16.961131   0.180062    0.269286    135.436803 
[37m[36mINFO[0m[0m 03/18 01:51:20 | 0.661176    0.674200    0.956537    0.894361    0.318380    0.999117    0.996466    0.661176    0.674200    0.922696    0.814024    0.947797    0.872593    800         22.614841   0.145651    0.241542    132.479565 
[37m[36mINFO[0m[0m 03/18 01:54:22 | 0.620706    0.608286    0.960280    0.894812    0.336914    1.000000    0.996466    0.620706    0.608286    0.921935    0.809451    0.958904    0.878519    1000        28.268551   0.123352    0.244857    132.526242 
[37m[36mINFO[0m[0m 03/18 01:57:23 | 0.657412    0.662900    0.973273    0.883311    0.439683    1.000000    0.996466    0.657412    0.662900    0.952399    0.794207    0.967419    0.859259    1200        33.922261   0.091836    0.240810    132.677310 
[37m[36mINFO[0m[0m 03/18 02:00:35 | 0.634353    0.627119    0.983611    0.886464    0.394987    0.998233    1.000000    0.634353    0.627119    0.972963    0.794207    0.979637    0.865185    1400        39.575972   0.082650    0.296799    133.087911 
[37m[36mINFO[0m[0m 03/18 02:04:04 | 0.666353    0.668550    0.978170    0.893506    0.434559    1.000000    1.000000    0.666353    0.668550    0.961538    0.807927    0.972973    0.872593    1600        45.229682   0.061117    0.378408    133.276186 
[37m[36mINFO[0m[0m 03/18 02:07:42 | 0.590118    0.570621    0.971448    0.886987    0.450132    0.999117    1.000000    0.590118    0.570621    0.947068    0.797256    0.968160    0.863704    1800        50.883392   0.063904    0.410322    135.707239 
[37m[36mINFO[0m[0m 03/18 02:11:04 | 0.621647    0.610169    0.986950    0.889817    0.481635    1.000000    0.996466    0.621647    0.610169    0.976771    0.803354    0.984080    0.869630    2000        56.537102   0.052402    0.336978    134.515522 
[37m[36mINFO[0m[0m 03/18 02:14:09 | 0.631529    0.632768    0.989619    0.894609    0.479138    1.000000    1.000000    0.631529    0.632768    0.985149    0.820122    0.983710    0.863704    2200        62.190813   0.036496    0.277352    129.844110 
[37m[36mINFO[0m[0m 03/18 02:17:15 | 0.625412    0.606403    0.987712    0.879578    0.614601    1.000000    0.992933    0.625412    0.606403    0.979056    0.785061    0.984080    0.860741    2400        67.844523   0.035705    0.253760    135.287972 
[37m[36mINFO[0m[0m 03/18 02:20:20 | 0.594353    0.595104    0.993368    0.891066    0.479863    1.000000    1.000000    0.594353    0.595104    0.990099    0.810976    0.990004    0.862222    2600        73.498233   0.032098    0.249313    135.476345 
[37m[36mINFO[0m[0m 03/18 02:23:21 | 0.613176    0.608286    0.979576    0.877955    0.551028    0.999117    1.000000    0.613176    0.608286    0.958492    0.782012    0.981118    0.851852    2800        79.151943   0.024644    0.244778    132.033939 
[37m[36mINFO[0m[0m 03/18 02:26:26 | 0.645647    0.647834    0.990963    0.888962    0.566967    1.000000    1.000000    0.645647    0.647834    0.983625    0.797256    0.989263    0.869630    3000        84.805654   0.023762    0.252634    134.516312 
[37m[36mINFO[0m[0m 03/18 02:29:48 | 0.659294    0.668550    0.990850    0.881440    0.685904    1.000000    1.000000    0.659294    0.668550    0.984768    0.785061    0.987782    0.859259    3200        90.459364   0.023134    0.332886    134.537220 
[37m[36mINFO[0m[0m 03/18 02:33:24 | 0.664471    0.664783    0.995929    0.890966    0.557669    0.999117    1.000000    0.664471    0.664783    0.992003    0.800305    0.996668    0.872593    3400        96.113074   0.022868    0.415427    133.784805 
[37m[36mINFO[0m[0m 03/18 02:36:56 | 0.650353    0.638418    0.994224    0.884850    0.654749    1.000000    0.996466    0.650353    0.638418    0.989337    0.800305    0.993336    0.857778    3600        101.766784  0.015519    0.384587    134.308537 
[37m[36mINFO[0m[0m 03/18 02:39:56 | 0.649882    0.636535    0.993854    0.884284    0.611243    1.000000    0.996466    0.649882    0.636535    0.989337    0.792683    0.992225    0.863704    3800        107.420495  0.017766    0.240409    132.430841 
[37m[36mINFO[0m[0m 03/18 02:43:15 | 0.608000    0.600753    0.996368    0.892880    0.631800    1.000000    0.996466    0.608000    0.600753    0.994288    0.814024    0.994817    0.868148    4000        113.074205  0.014746    0.319863    134.927738 
[37m[36mINFO[0m[0m 03/18 02:46:53 | 0.635294    0.632768    0.997253    0.892955    0.600468    1.000000    1.000000    0.635294    0.632768    0.996573    0.801829    0.995187    0.877037    4200        118.727915  0.015948    0.423191    132.924565 
[37m[36mINFO[0m[0m 03/18 02:50:05 | 0.620706    0.617702    0.997877    0.887466    0.647444    1.000000    1.000000    0.620706    0.617702    0.997334    0.795732    0.996298    0.866667    4400        124.381625  0.012872    0.300510    132.567821 
[37m[36mINFO[0m[0m 03/18 02:53:08 | 0.589647    0.583804    0.989309    0.877998    0.673552    1.000000    1.000000    0.589647    0.583804    0.978294    0.786585    0.989633    0.847407    4600        130.035336  0.014781    0.241388    134.730748 
[37m[36mINFO[0m[0m 03/18 02:56:10 | 0.606118    0.600753    0.997856    0.885344    0.623073    1.000000    0.996466    0.606118    0.600753    0.995050    0.800305    0.998519    0.859259    4800        135.689046  0.012384    0.245526    132.112482 
[37m[36mINFO[0m[0m 03/18 02:59:10 | 0.657412    0.661017    0.998491    0.892576    0.618869    1.000000    1.000000    0.657412    0.661017    0.996954    0.814024    0.998519    0.863704    5000        141.342756  0.009809    0.246399    131.420480 
[37m[36mINFO[0m[0m 03/18 02:59:10 | Cumulative gradient change saved at train_output/VLCS/ERM/[1]/250318_01-36-02_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 02:59:12 | ---
[37m[36mINFO[0m[0m 03/18 02:59:12 | test-domain validation(oracle) = 66.118%
[37m[36mINFO[0m[0m 03/18 02:59:12 | training-domain validation(iid) = 62.071%
[37m[36mINFO[0m[0m 03/18 02:59:12 | last = 65.741%
[37m[36mINFO[0m[0m 03/18 02:59:12 | last (inD) = 89.258%
[37m[36mINFO[0m[0m 03/18 02:59:12 | training-domain validation (iid, inD) = 89.481%
[37m[36mINFO[0m[0m 03/18 02:59:12 | === Summary ===
[37m[36mINFO[0m[0m 03/18 02:59:12 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset VLCS
[37m[36mINFO[0m[0m 03/18 02:59:12 | Unique name: 250318_01-36-02_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 02:59:12 | Out path: train_output/VLCS/ERM/[1]/250318_01-36-02_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 02:59:12 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 02:59:12 | Dataset: VLCS

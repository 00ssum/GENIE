[37m[36mINFO[0m[0m 03/25 04:16:50 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 2 --dataset VLCS --trial_seed 0 --hparams_seed 17
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 17
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[2]/250325_04-16-50_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250325_04-16-50_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00025159202447589334
	batch_size: 8
	weight_decay: 0.007781932002143384
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/25 04:16:50 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 04:16:50 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 04:16:50 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 04:16:50 | 
[37m[36mINFO[0m[0m 03/25 04:16:50 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 03/25 04:16:50 | Test envs = [2], name = te_S
[37m[36mINFO[0m[0m 03/25 04:16:50 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 03/25 04:16:50 | Batch sizes for each domain: [8, 8, 0, 8] (total=24)
[37m[36mINFO[0m[0m 03/25 04:16:50 | steps-per-epoch for each domain: 141.50, 265.62, 337.62 -> min = 141.50
[37m[36mINFO[0m[0m 03/25 04:16:52 | # of params = 23518277
[37m[36mINFO[0m[0m 03/25 04:19:26 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 04:19:26 | 0.397563    0.396341    0.505117    0.522502    1.266475    0.611307    0.628975    0.459765    0.489642    0.397563    0.396341    0.444280    0.448889    0           0.000000    1.743360    1.388951    152.234754 
[37m[36mINFO[0m[0m 03/25 04:23:14 | 0.725819    0.689024    0.846446    0.840167    0.405561    0.998233    1.000000    0.698824    0.696798    0.725819    0.689024    0.842281    0.823704    200         1.413428    0.498205    0.366470    155.172379 
[37m[36mINFO[0m[0m 03/25 04:26:53 | 0.763519    0.727134    0.859673    0.856759    0.383858    0.992933    0.996466    0.737882    0.717514    0.763519    0.727134    0.848204    0.856296    400         2.826855    0.381434    0.341439    150.983625 
[37m[36mINFO[0m[0m 03/25 04:30:34 | 0.626428    0.591463    0.855477    0.842471    0.456576    0.995583    0.996466    0.756706    0.745763    0.626428    0.591463    0.814143    0.785185    600         4.240283    0.370477    0.336439    153.158654 
[37m[36mINFO[0m[0m 03/25 04:34:16 | 0.625666    0.592988    0.834549    0.819069    0.469951    0.999117    0.996466    0.664471    0.666667    0.625666    0.592988    0.840059    0.794074    800         5.653710    0.347409    0.347619    152.827079 
[37m[36mINFO[0m[0m 03/25 04:37:57 | 0.680883    0.681402    0.877631    0.863168    0.363485    0.997350    1.000000    0.778824    0.770245    0.680883    0.681402    0.856720    0.819259    1000        7.067138    0.335371    0.328180    155.676679 
[37m[36mINFO[0m[0m 03/25 04:41:38 | 0.713633    0.679878    0.883524    0.856391    0.394419    0.999117    0.996466    0.784000    0.740113    0.713633    0.679878    0.867456    0.832593    1200        8.480565    0.310261    0.349578    151.053997 
[37m[36mINFO[0m[0m 03/25 04:45:21 | 0.593298    0.557927    0.862018    0.834826    0.430069    0.995583    0.989399    0.756706    0.726930    0.593298    0.557927    0.833765    0.788148    1400        9.893993    0.301589    0.324271    157.672008 
[37m[36mINFO[0m[0m 03/25 04:49:04 | 0.638233    0.603659    0.868072    0.833740    0.436367    0.992933    0.985866    0.772706    0.721281    0.638233    0.603659    0.838578    0.794074    1600        11.307420   0.315211    0.324444    158.026844 
[37m[36mINFO[0m[0m 03/25 04:52:47 | 0.623382    0.611280    0.813221    0.780415    0.491865    0.982332    0.985866    0.648000    0.589454    0.623382    0.611280    0.809330    0.765926    1800        12.720848   0.351531    0.334235    156.182337 
[37m[36mINFO[0m[0m 03/25 04:56:23 | 0.628332    0.628049    0.869293    0.852016    0.411797    0.991166    0.978799    0.765176    0.768362    0.628332    0.628049    0.851536    0.808889    2000        14.134276   0.323512    0.324553    151.479106 
[37m[36mINFO[0m[0m 03/25 05:00:04 | 0.717441    0.699695    0.886408    0.857920    0.378536    1.000000    1.000000    0.789176    0.758945    0.717441    0.699695    0.870048    0.814815    2200        15.547703   0.342327    0.339304    153.297055 
[37m[36mINFO[0m[0m 03/25 05:03:48 | 0.677075    0.661585    0.879542    0.858132    0.391557    0.999117    0.996466    0.783529    0.764595    0.677075    0.661585    0.855979    0.813333    2400        16.961131   0.324556    0.363657    151.051767 
[37m[36mINFO[0m[0m 03/25 05:07:25 | 0.644707    0.602134    0.870023    0.839812    0.431122    0.995583    0.992933    0.770353    0.745763    0.644707    0.602134    0.844132    0.780741    2600        18.374558   0.348591    0.323335    152.413248 
[37m[36mINFO[0m[0m 03/25 05:11:08 | 0.677837    0.679878    0.869470    0.843085    0.415111    0.992049    0.992933    0.777412    0.757062    0.677837    0.679878    0.838949    0.779259    2800        19.787986   0.364726    0.333330    155.877093 
[37m[36mINFO[0m[0m 03/25 05:14:46 | 0.638614    0.618902    0.864420    0.841561    0.437649    0.997350    0.992933    0.766588    0.749529    0.638614    0.618902    0.829322    0.782222    3000        21.201413   0.336165    0.324398    153.098432 
[37m[36mINFO[0m[0m 03/25 05:18:27 | 0.671744    0.649390    0.861527    0.835037    0.436533    0.997350    0.985866    0.762353    0.732580    0.671744    0.649390    0.824880    0.786667    3200        22.614841   0.364573    0.339515    153.481350 
[37m[36mINFO[0m[0m 03/25 05:22:09 | 0.699543    0.667683    0.847234    0.819612    0.450033    0.990283    0.985866    0.712471    0.689266    0.699543    0.667683    0.838949    0.783704    3400        24.028269   0.373673    0.328050    156.090336 
[37m[36mINFO[0m[0m 03/25 05:25:47 | 0.664128    0.637195    0.889327    0.840384    0.399855    0.996466    0.989399    0.810353    0.749529    0.664128    0.637195    0.861163    0.782222    3600        25.441696   0.371784    0.340656    149.678113 
[37m[36mINFO[0m[0m 03/25 05:29:38 | 0.592155    0.573171    0.849366    0.834958    0.489084    0.987633    0.978799    0.744471    0.764595    0.592155    0.573171    0.815994    0.761481    3800        26.855124   0.366732    0.369819    156.797668 
[37m[36mINFO[0m[0m 03/25 05:33:17 | 0.634425    0.600610    0.861968    0.843261    0.442473    0.999117    0.992933    0.768941    0.766478    0.634425    0.600610    0.817845    0.770370    4000        28.268551   0.373656    0.337878    151.432392 
[37m[36mINFO[0m[0m 03/25 05:37:01 | 0.688500    0.667683    0.829230    0.788468    0.508805    0.984099    0.971731    0.713882    0.664783    0.688500    0.667683    0.789708    0.728889    4200        29.681979   0.376356    0.341720    155.880060 
[37m[36mINFO[0m[0m 03/25 05:40:39 | 0.678218    0.667683    0.842593    0.814221    0.480035    0.992933    0.985866    0.723294    0.696798    0.678218    0.667683    0.811551    0.760000    4400        31.095406   0.417942    0.343110    149.126425 
[37m[36mINFO[0m[0m 03/25 05:44:25 | 0.681264    0.653963    0.862371    0.832604    0.434880    0.984099    0.982332    0.765176    0.728814    0.681264    0.653963    0.837838    0.786667    4600        32.508834   0.417100    0.332663    159.509338 
[37m[36mINFO[0m[0m 03/25 05:48:08 | 0.611577    0.589939    0.832348    0.813586    0.514309    0.969081    0.946996    0.760471    0.758945    0.611577    0.589939    0.767494    0.734815    4800        33.922261   0.411505    0.365317    149.905656 
[37m[36mINFO[0m[0m 03/25 05:51:53 | 0.636329    0.618902    0.863390    0.833217    0.454360    0.999117    0.992933    0.775059    0.736347    0.636329    0.618902    0.815994    0.770370    5000        35.335689   0.394494    0.360174    153.738828 
[37m[36mINFO[0m[0m 03/25 05:51:53 | Cumulative gradient change saved at train_output/VLCS/ERM/[2]/250325_04-16-50_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 05:51:55 | ---
[37m[36mINFO[0m[0m 03/25 05:51:55 | test-domain validation(oracle) = 76.352%
[37m[36mINFO[0m[0m 03/25 05:51:55 | training-domain validation(iid) = 68.088%
[37m[36mINFO[0m[0m 03/25 05:51:55 | last = 63.633%
[37m[36mINFO[0m[0m 03/25 05:51:55 | last (inD) = 83.322%
[37m[36mINFO[0m[0m 03/25 05:51:55 | training-domain validation (iid, inD) = 86.317%
[37m[36mINFO[0m[0m 03/25 05:51:55 | === Summary ===
[37m[36mINFO[0m[0m 03/25 05:51:55 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 2 --dataset VLCS --trial_seed 0 --hparams_seed 17
[37m[36mINFO[0m[0m 03/25 05:51:55 | Unique name: 250325_04-16-50_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 05:51:55 | Out path: train_output/VLCS/ERM/[2]/250325_04-16-50_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 05:51:55 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 05:51:55 | Dataset: VLCS

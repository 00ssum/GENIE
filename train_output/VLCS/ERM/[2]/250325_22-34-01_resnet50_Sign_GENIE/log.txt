[37m[36mINFO[0m[0m 03/25 22:34:01 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 2 --dataset VLCS --trial_seed 1 --hparams_seed 6
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 6
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[2]/250325_22-34-01_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 1
	unique_name: 250325_22-34-01_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00016409882498047177
	batch_size: 16
	weight_decay: 0.00012909833738066306
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/25 22:34:01 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 22:34:01 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 22:34:01 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 22:34:01 | 
[37m[36mINFO[0m[0m 03/25 22:34:01 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 03/25 22:34:01 | Test envs = [2], name = te_S
[37m[36mINFO[0m[0m 03/25 22:34:01 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 03/25 22:34:01 | Batch sizes for each domain: [16, 16, 0, 16] (total=48)
[37m[36mINFO[0m[0m 03/25 22:34:01 | steps-per-epoch for each domain: 70.75, 132.81, 168.81 -> min = 70.75
[37m[36mINFO[0m[0m 03/25 22:34:02 | # of params = 23518277
[37m[36mINFO[0m[0m 03/25 22:36:17 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 22:36:17 | 0.376618    0.419207    0.511439    0.495231    1.489455    0.613958    0.618375    0.466824    0.461394    0.376618    0.419207    0.453536    0.405926    0           0.000000    1.934934    1.002887    133.970675 
[37m[36mINFO[0m[0m 03/25 22:40:25 | 0.756283    0.777439    0.857368    0.851023    0.419431    0.999117    1.000000    0.718118    0.717514    0.756283    0.777439    0.854869    0.835556    200         2.826855    0.488976    0.568056    134.375596 
[37m[36mINFO[0m[0m 03/25 22:44:41 | 0.725819    0.733232    0.883851    0.869722    0.372237    0.999117    1.000000    0.781647    0.772128    0.725819    0.733232    0.870789    0.837037    400         5.653710    0.332712    0.593675    137.282894 
[37m[36mINFO[0m[0m 03/25 22:48:55 | 0.773420    0.794207    0.893616    0.867107    0.372940    0.997350    0.992933    0.784941    0.747646    0.773420    0.794207    0.898556    0.860741    600         8.480565    0.295106    0.597184    134.439231 
[37m[36mINFO[0m[0m 03/25 22:53:01 | 0.718964    0.769817    0.861889    0.828416    0.450584    0.999117    1.000000    0.693176    0.670433    0.718964    0.769817    0.893373    0.814815    800         11.307420   0.277481    0.571178    131.294220 
[37m[36mINFO[0m[0m 03/25 22:57:12 | 0.779893    0.798780    0.909728    0.864792    0.378222    1.000000    1.000000    0.799529    0.751412    0.779893    0.798780    0.929656    0.842963    1000        14.134276   0.264090    0.591573    133.413708 
[37m[36mINFO[0m[0m 03/25 23:01:21 | 0.751714    0.789634    0.920503    0.871105    0.377376    0.998233    0.996466    0.829176    0.766478    0.751714    0.789634    0.934098    0.850370    1200        16.961131   0.227783    0.585170    131.809836 
[37m[36mINFO[0m[0m 03/25 23:05:31 | 0.696116    0.733232    0.926178    0.863466    0.408380    1.000000    0.992933    0.845176    0.758945    0.696116    0.733232    0.933358    0.838519    1400        19.787986   0.216371    0.577169    134.502083 
[37m[36mINFO[0m[0m 03/25 23:09:49 | 0.705636    0.699695    0.934618    0.865539    0.411740    1.000000    0.996466    0.864941    0.764595    0.705636    0.699695    0.938912    0.835556    1600        22.614841   0.186714    0.605259    136.623132 
[37m[36mINFO[0m[0m 03/25 23:14:02 | 0.741051    0.745427    0.925406    0.861892    0.461330    0.997350    0.992933    0.848471    0.764595    0.741051    0.745427    0.930396    0.828148    1800        25.441696   0.190213    0.579262    137.356498 
[37m[36mINFO[0m[0m 03/25 23:18:10 | 0.685072    0.678354    0.931695    0.857588    0.458660    1.000000    0.996466    0.877647    0.777778    0.685072    0.678354    0.917438    0.798519    2000        28.268551   0.176031    0.579223    132.526515 
[37m[36mINFO[0m[0m 03/25 23:22:20 | 0.723534    0.734756    0.948729    0.861976    0.446484    1.000000    0.992933    0.895059    0.779661    0.723534    0.734756    0.951129    0.813333    2200        31.095406   0.152920    0.585632    132.572526 
[37m[36mINFO[0m[0m 03/25 23:26:31 | 0.686215    0.714939    0.952661    0.855246    0.455623    1.000000    0.992933    0.908706    0.768362    0.686215    0.714939    0.949278    0.804444    2400        33.922261   0.132542    0.572445    136.645534 
[37m[36mINFO[0m[0m 03/25 23:30:41 | 0.738385    0.736280    0.964683    0.863719    0.525628    0.999117    0.989399    0.915294    0.772128    0.738385    0.736280    0.979637    0.829630    2600        36.749117   0.115227    0.588841    131.793772 
[37m[36mINFO[0m[0m 03/25 23:34:52 | 0.718583    0.733232    0.960089    0.848857    0.521351    0.995583    0.971731    0.928000    0.757062    0.718583    0.733232    0.956683    0.817778    2800        39.575972   0.119414    0.591453    132.675136 
[37m[36mINFO[0m[0m 03/25 23:39:05 | 0.728104    0.711890    0.955661    0.847178    0.558008    1.000000    0.992933    0.898824    0.738230    0.728104    0.711890    0.968160    0.810370    3000        42.402827   0.096685    0.594925    134.166698 
[37m[36mINFO[0m[0m 03/25 23:43:12 | 0.679741    0.681402    0.966575    0.852086    0.553949    1.000000    1.000000    0.930824    0.753296    0.679741    0.681402    0.968900    0.802963    3200        45.229682   0.095839    0.570842    133.212009 
[37m[36mINFO[0m[0m 03/25 23:47:22 | 0.685072    0.713415    0.977426    0.862788    0.615135    1.000000    0.992933    0.951529    0.770245    0.685072    0.713415    0.980748    0.825185    3400        48.056537   0.080826    0.576608    134.184978 
[37m[36mINFO[0m[0m 03/25 23:51:37 | 0.699162    0.727134    0.976535    0.865680    0.600216    0.999117    0.985866    0.955294    0.781544    0.699162    0.727134    0.975194    0.829630    3600        50.883392   0.078802    0.603415    134.018985 
[37m[36mINFO[0m[0m 03/25 23:55:52 | 0.703351    0.714939    0.976156    0.858132    0.597166    1.000000    0.996466    0.956235    0.764595    0.703351    0.714939    0.972233    0.813333    3800        53.710247   0.070461    0.599035    135.792638 
[37m[36mINFO[0m[0m 03/26 00:00:05 | 0.706017    0.724085    0.974297    0.858548    0.641642    1.000000    1.000000    0.949176    0.760829    0.706017    0.724085    0.973713    0.814815    4000        56.537102   0.079933    0.589553    134.514029 
[37m[36mINFO[0m[0m 03/26 00:04:21 | 0.706778    0.699695    0.976865    0.847579    0.588690    1.000000    0.992933    0.950588    0.743879    0.706778    0.699695    0.980007    0.805926    4200        59.363958   0.070423    0.582833    139.480268 
[37m[36mINFO[0m[0m 03/26 00:08:34 | 0.697258    0.721037    0.964642    0.847411    0.791593    0.999117    0.982332    0.930353    0.749529    0.697258    0.721037    0.964458    0.810370    4400        62.190813   0.062638    0.587687    135.768408 
[37m[36mINFO[0m[0m 03/26 00:12:47 | 0.731531    0.730183    0.971541    0.846790    0.669625    0.999117    0.996466    0.933647    0.723164    0.731531    0.730183    0.981859    0.820741    4600        65.017668   0.071741    0.584046    136.270840 
[37m[36mINFO[0m[0m 03/26 00:16:59 | 0.719726    0.748476    0.984598    0.861913    0.707948    1.000000    1.000000    0.970824    0.766478    0.719726    0.748476    0.982969    0.819259    4800        67.844523   0.057429    0.585195    135.394521 
[37m[36mINFO[0m[0m 03/26 00:21:06 | 0.677456    0.692073    0.980157    0.848609    0.789060    1.000000    0.992933    0.965647    0.751412    0.677456    0.692073    0.974824    0.801481    5000        70.671378   0.044177    0.570087    132.976129 
[37m[36mINFO[0m[0m 03/26 00:21:07 | Cumulative gradient change saved at train_output/VLCS/ERM/[2]/250325_22-34-01_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 00:21:08 | ---
[37m[36mINFO[0m[0m 03/26 00:21:08 | test-domain validation(oracle) = 77.989%
[37m[36mINFO[0m[0m 03/26 00:21:08 | training-domain validation(iid) = 75.171%
[37m[36mINFO[0m[0m 03/26 00:21:08 | last = 67.746%
[37m[36mINFO[0m[0m 03/26 00:21:08 | last (inD) = 84.861%
[37m[36mINFO[0m[0m 03/26 00:21:08 | training-domain validation (iid, inD) = 87.111%
[37m[36mINFO[0m[0m 03/26 00:21:08 | === Summary ===
[37m[36mINFO[0m[0m 03/26 00:21:08 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 2 --dataset VLCS --trial_seed 1 --hparams_seed 6
[37m[36mINFO[0m[0m 03/26 00:21:08 | Unique name: 250325_22-34-01_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 00:21:08 | Out path: train_output/VLCS/ERM/[2]/250325_22-34-01_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 00:21:08 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 00:21:08 | Dataset: VLCS

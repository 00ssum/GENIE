[37m[36mINFO[0m[0m 03/24 22:39:21 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 2 --dataset VLCS --trial_seed 0 --hparams_seed 14
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 14
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[2]/250324_22-39-21_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250324_22-39-21_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.1399727535070965e-05
	batch_size: 16
	weight_decay: 0.00022842646099519332
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/24 22:39:21 | n_steps = 5001
[37m[36mINFO[0m[0m 03/24 22:39:21 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/24 22:39:21 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/24 22:39:21 | 
[37m[36mINFO[0m[0m 03/24 22:39:21 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 03/24 22:39:21 | Test envs = [2], name = te_S
[37m[36mINFO[0m[0m 03/24 22:39:21 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 03/24 22:39:21 | Batch sizes for each domain: [16, 16, 0, 16] (total=48)
[37m[36mINFO[0m[0m 03/24 22:39:21 | steps-per-epoch for each domain: 70.75, 132.81, 168.81 -> min = 70.75
[37m[36mINFO[0m[0m 03/24 22:39:22 | # of params = 23518277
[37m[36mINFO[0m[0m 03/24 22:41:52 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/24 22:41:52 | 0.383473    0.388720    0.506687    0.523638    1.223578    0.613958    0.632509    0.455529    0.482109    0.383473    0.388720    0.450574    0.456296    0           0.000000    1.761493    1.264642    148.809162 
[37m[36mINFO[0m[0m 03/24 22:46:33 | 0.735720    0.717988    0.873554    0.859946    0.356749    1.000000    1.000000    0.757647    0.745763    0.735720    0.717988    0.863014    0.834074    200         2.826855    0.447930    0.635269    153.460295 
[37m[36mINFO[0m[0m 03/24 22:51:09 | 0.722772    0.696646    0.887841    0.859628    0.359743    0.999117    1.000000    0.789176    0.755179    0.722772    0.696646    0.875231    0.823704    400         5.653710    0.318007    0.644527    147.532897 
[37m[36mINFO[0m[0m 03/24 22:55:15 | 0.746382    0.711890    0.898904    0.874512    0.362331    0.998233    0.996466    0.806588    0.779661    0.746382    0.711890    0.891892    0.847407    600         8.480565    0.280692    0.565283    132.604053 
[37m[36mINFO[0m[0m 03/24 22:59:22 | 0.702589    0.673780    0.905099    0.879322    0.348422    1.000000    1.000000    0.816000    0.789077    0.702589    0.673780    0.899297    0.848889    800         11.307420   0.271186    0.570192    133.643687 
[37m[36mINFO[0m[0m 03/24 23:03:29 | 0.746763    0.724085    0.909615    0.874166    0.358880    0.999117    1.000000    0.821176    0.772128    0.746763    0.724085    0.908552    0.850370    1000        14.134276   0.251556    0.549353    136.544842 
[37m[36mINFO[0m[0m 03/24 23:07:31 | 0.695354    0.682927    0.919763    0.875330    0.351972    1.000000    1.000000    0.840000    0.781544    0.695354    0.682927    0.919289    0.844444    1200        16.961131   0.245586    0.561091    129.700053 
[37m[36mINFO[0m[0m 03/24 23:11:32 | 0.723915    0.678354    0.920185    0.876437    0.360861    1.000000    0.996466    0.849412    0.792844    0.723915    0.678354    0.911144    0.840000    1400        19.787986   0.212253    0.554242    130.627636 
[37m[36mINFO[0m[0m 03/24 23:15:33 | 0.741813    0.722561    0.936425    0.867127    0.382225    1.000000    1.000000    0.862588    0.749529    0.741813    0.722561    0.946686    0.851852    1600        22.614841   0.186479    0.554387    129.960396 
[37m[36mINFO[0m[0m 03/24 23:19:38 | 0.709063    0.685976    0.930441    0.861398    0.468718    0.999117    0.992933    0.865882    0.764595    0.709063    0.685976    0.926324    0.826667    1800        25.441696   0.182785    0.564157    131.731318 
[37m[36mINFO[0m[0m 03/24 23:23:48 | 0.736481    0.727134    0.951458    0.858062    0.418897    0.999117    1.000000    0.883765    0.740113    0.736481    0.727134    0.971492    0.834074    2000        28.268551   0.165010    0.571219    135.596562 
[37m[36mINFO[0m[0m 03/24 23:27:53 | 0.702589    0.655488    0.954172    0.867330    0.440423    0.999117    0.996466    0.911529    0.775895    0.702589    0.655488    0.951870    0.829630    2200        31.095406   0.146079    0.554468    134.167181 
[37m[36mINFO[0m[0m 03/24 23:31:56 | 0.659558    0.657012    0.938133    0.853737    0.470080    1.000000    0.996466    0.881412    0.751412    0.659558    0.657012    0.932988    0.813333    2400        33.922261   0.128357    0.570414    129.642848 
[37m[36mINFO[0m[0m 03/24 23:36:02 | 0.693450    0.675305    0.965058    0.869270    0.511122    1.000000    1.000000    0.935529    0.779661    0.693450    0.675305    0.959645    0.828148    2600        36.749117   0.117601    0.556458    134.070469 
[37m[36mINFO[0m[0m 03/24 23:40:05 | 0.692308    0.666159    0.969452    0.849266    0.508615    1.000000    1.000000    0.943529    0.734463    0.692308    0.666159    0.964828    0.813333    2800        39.575972   0.119882    0.553283    133.121701 
[37m[36mINFO[0m[0m 03/24 23:44:09 | 0.714014    0.685976    0.944367    0.838192    0.521784    0.999117    1.000000    0.884706    0.696798    0.714014    0.685976    0.949278    0.817778    3000        42.402827   0.103486    0.567537    129.920910 
[37m[36mINFO[0m[0m 03/24 23:48:13 | 0.707159    0.685976    0.966236    0.865863    0.493108    0.999117    1.000000    0.928471    0.766478    0.707159    0.685976    0.971122    0.831111    3200        45.229682   0.093979    0.564269    130.798334 
[37m[36mINFO[0m[0m 03/24 23:52:21 | 0.678218    0.669207    0.972666    0.851411    0.545929    1.000000    0.996466    0.933176    0.732580    0.678218    0.669207    0.984820    0.825185    3400        48.056537   0.087918    0.572089    133.879220 
[37m[36mINFO[0m[0m 03/24 23:56:26 | 0.716679    0.681402    0.978078    0.862632    0.588707    0.997350    1.000000    0.955765    0.762712    0.716679    0.681402    0.981118    0.825185    3600        50.883392   0.072615    0.575134    129.866330 
[37m[36mINFO[0m[0m 03/25 00:00:31 | 0.688119    0.638720    0.971819    0.852878    0.605174    0.999117    0.992933    0.939294    0.741996    0.688119    0.638720    0.977046    0.823704    3800        53.710247   0.063388    0.572056    131.186246 
[37m[36mINFO[0m[0m 03/25 00:04:40 | 0.717441    0.661585    0.976160    0.865941    0.584205    1.000000    0.996466    0.945882    0.770245    0.717441    0.661585    0.982599    0.831111    4000        56.537102   0.062034    0.573202    134.366488 
[37m[36mINFO[0m[0m 03/25 00:08:43 | 0.696497    0.657012    0.978655    0.865405    0.551724    1.000000    0.996466    0.961882    0.762712    0.696497    0.657012    0.974084    0.837037    4200        59.363958   0.069502    0.552567    132.423239 
[37m[36mINFO[0m[0m 03/25 00:12:43 | 0.679741    0.666159    0.968349    0.852693    0.606715    1.000000    0.992933    0.928000    0.753296    0.679741    0.666159    0.977046    0.811852    4400        62.190813   0.056079    0.558855    127.447759 
[37m[36mINFO[0m[0m 03/25 00:16:40 | 0.690784    0.660061    0.987781    0.850774    0.565615    1.000000    0.996466    0.977412    0.751412    0.690784    0.660061    0.985931    0.804444    4600        65.017668   0.060166    0.548182    127.807689 
[37m[36mINFO[0m[0m 03/25 00:20:42 | 0.676314    0.650915    0.974397    0.865503    0.713715    1.000000    1.000000    0.950588    0.768362    0.676314    0.650915    0.972603    0.828148    4800        67.844523   0.050683    0.559726    130.285470 
[37m[36mINFO[0m[0m 03/25 00:24:52 | 0.715918    0.689024    0.986794    0.866801    0.655409    1.000000    1.000000    0.977412    0.779661    0.715918    0.689024    0.982969    0.820741    5000        70.671378   0.042829    0.585704    132.158659 
[37m[36mINFO[0m[0m 03/25 00:24:52 | Cumulative gradient change saved at train_output/VLCS/ERM/[2]/250324_22-39-21_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 00:24:53 | ---
[37m[36mINFO[0m[0m 03/25 00:24:53 | test-domain validation(oracle) = 73.648%
[37m[36mINFO[0m[0m 03/25 00:24:53 | training-domain validation(iid) = 70.259%
[37m[36mINFO[0m[0m 03/25 00:24:53 | last = 71.592%
[37m[36mINFO[0m[0m 03/25 00:24:53 | last (inD) = 86.680%
[37m[36mINFO[0m[0m 03/25 00:24:53 | training-domain validation (iid, inD) = 87.932%
[37m[36mINFO[0m[0m 03/25 00:24:53 | === Summary ===
[37m[36mINFO[0m[0m 03/25 00:24:53 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 2 --dataset VLCS --trial_seed 0 --hparams_seed 14
[37m[36mINFO[0m[0m 03/25 00:24:53 | Unique name: 250324_22-39-21_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 00:24:53 | Out path: train_output/VLCS/ERM/[2]/250324_22-39-21_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 00:24:53 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 00:24:53 | Dataset: VLCS

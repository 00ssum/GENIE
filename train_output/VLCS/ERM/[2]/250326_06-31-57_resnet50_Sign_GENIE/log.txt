[37m[36mINFO[0m[0m 03/26 06:31:57 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 2 --dataset VLCS --trial_seed 1 --hparams_seed 11
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 11
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[2]/250326_06-31-57_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 1
	unique_name: 250326_06-31-57_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5.340583028754034e-05
	batch_size: 10
	weight_decay: 2.5000172438864113e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/26 06:31:58 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 06:31:58 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 06:31:58 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 06:31:58 | 
[37m[36mINFO[0m[0m 03/26 06:31:58 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 03/26 06:31:58 | Test envs = [2], name = te_S
[37m[36mINFO[0m[0m 03/26 06:31:58 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 03/26 06:31:58 | Batch sizes for each domain: [10, 10, 0, 10] (total=30)
[37m[36mINFO[0m[0m 03/26 06:31:58 | steps-per-epoch for each domain: 113.20, 212.50, 270.10 -> min = 113.20
[37m[36mINFO[0m[0m 03/26 06:31:59 | # of params = 23518277
[37m[36mINFO[0m[0m 03/26 06:34:10 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 06:34:10 | 0.376618    0.419207    0.511439    0.495231    1.492585    0.613958    0.618375    0.466824    0.461394    0.376618    0.419207    0.453536    0.405926    0           0.000000    1.985814    0.984093    130.453694 
[37m[36mINFO[0m[0m 03/26 06:37:33 | 0.648134    0.667683    0.856120    0.844441    0.427245    0.994700    0.992933    0.742118    0.734463    0.648134    0.667683    0.831544    0.805926    200         1.766784    0.495646    0.353590    132.086372 
[37m[36mINFO[0m[0m 03/26 06:40:57 | 0.719726    0.717988    0.865405    0.853371    0.412975    0.993816    0.992933    0.772706    0.741996    0.719726    0.717988    0.829693    0.825185    400         3.533569    0.373921    0.362800    131.561885 
[37m[36mINFO[0m[0m 03/26 06:44:20 | 0.691546    0.722561    0.881651    0.855648    0.410986    0.997350    0.992933    0.797176    0.774011    0.691546    0.722561    0.850426    0.800000    600         5.300353    0.339285    0.362281    130.438233 
[37m[36mINFO[0m[0m 03/26 06:47:38 | 0.745240    0.775915    0.883491    0.865935    0.398396    0.999117    0.992933    0.783529    0.758945    0.745240    0.775915    0.867827    0.845926    800         7.067138    0.320225    0.346272    129.182770 
[37m[36mINFO[0m[0m 03/26 06:51:02 | 0.723153    0.713415    0.895580    0.859345    0.378499    1.000000    0.996466    0.801882    0.760829    0.723153    0.713415    0.884857    0.820741    1000        8.833922    0.295122    0.361925    130.641719 
[37m[36mINFO[0m[0m 03/26 06:54:25 | 0.656893    0.679878    0.893090    0.860643    0.452940    0.997350    0.996466    0.807059    0.772128    0.656893    0.679878    0.874861    0.813333    1200        10.600707   0.283107    0.358264    131.975659 
[37m[36mINFO[0m[0m 03/26 06:57:48 | 0.699162    0.727134    0.914888    0.868797    0.413141    1.000000    0.992933    0.828706    0.785311    0.699162    0.727134    0.915957    0.828148    1400        12.367491   0.250835    0.352908    132.240373 
[37m[36mINFO[0m[0m 03/26 07:01:10 | 0.717822    0.725610    0.904135    0.845075    0.473076    0.999117    0.982332    0.806588    0.751412    0.717822    0.725610    0.906701    0.801481    1600        14.134276   0.259110    0.351786    131.534495 
[37m[36mINFO[0m[0m 03/26 07:04:33 | 0.662605    0.687500    0.901866    0.846430    0.418368    1.000000    0.996466    0.794824    0.725047    0.662605    0.687500    0.910774    0.817778    1800        15.901060   0.248871    0.354982    131.826956 
[37m[36mINFO[0m[0m 03/26 07:07:57 | 0.635948    0.640244    0.897958    0.848278    0.397016    1.000000    1.000000    0.802353    0.734463    0.635948    0.640244    0.891522    0.810370    2000        17.667845   0.237075    0.360775    132.514681 
[37m[36mINFO[0m[0m 03/26 07:11:20 | 0.706778    0.733232    0.923119    0.854987    0.406564    0.998233    0.992933    0.850353    0.743879    0.706778    0.733232    0.920770    0.828148    2200        19.434629   0.216720    0.356363    131.148505 
[37m[36mINFO[0m[0m 03/26 07:14:41 | 0.720487    0.742378    0.936559    0.861490    0.432356    1.000000    0.992933    0.864471    0.758945    0.720487    0.742378    0.945205    0.832593    2400        21.201413   0.190431    0.353566    130.657746 
[37m[36mINFO[0m[0m 03/26 07:18:06 | 0.705636    0.705793    0.918895    0.837831    0.486170    1.000000    0.989399    0.850353    0.734463    0.705636    0.705793    0.906331    0.789630    2600        22.968198   0.187159    0.359924    132.939219 
[37m[36mINFO[0m[0m 03/26 07:21:31 | 0.739909    0.753049    0.930666    0.850373    0.471143    0.999117    0.996466    0.839529    0.745763    0.739909    0.753049    0.953351    0.808889    2800        24.734982   0.185653    0.359728    133.079875 
[37m[36mINFO[0m[0m 03/26 07:24:55 | 0.707540    0.722561    0.950794    0.865073    0.446589    1.000000    0.992933    0.894588    0.781544    0.707540    0.722561    0.957793    0.820741    3000        26.501767   0.183735    0.356754    132.249815 
[37m[36mINFO[0m[0m 03/26 07:28:16 | 0.626809    0.644817    0.926185    0.836625    0.519617    0.999117    0.989399    0.849412    0.717514    0.626809    0.644817    0.930026    0.802963    3200        28.268551   0.167906    0.358785    129.689267 
[37m[36mINFO[0m[0m 03/26 07:31:36 | 0.739147    0.740854    0.935792    0.849259    0.592328    1.000000    0.996466    0.848471    0.723164    0.739147    0.740854    0.958904    0.828148    3400        30.035336   0.151319    0.358364    127.650754 
[37m[36mINFO[0m[0m 03/26 07:35:02 | 0.711348    0.714939    0.953078    0.856594    0.523286    1.000000    0.992933    0.905882    0.766478    0.711348    0.714939    0.953351    0.810370    3600        31.802120   0.143802    0.374061    131.254976 
[37m[36mINFO[0m[0m 03/26 07:38:23 | 0.719345    0.722561    0.956393    0.858873    0.490144    0.999117    0.989399    0.911529    0.766478    0.719345    0.722561    0.958534    0.820741    3800        33.568905   0.128954    0.357443    129.597099 
[37m[36mINFO[0m[0m 03/26 07:41:45 | 0.665651    0.681402    0.957280    0.840053    0.502035    0.999117    0.982332    0.910118    0.736347    0.665651    0.681402    0.962606    0.801481    4000        35.335689   0.153015    0.358688    130.660675 
[37m[36mINFO[0m[0m 03/26 07:45:06 | 0.713633    0.710366    0.953319    0.849272    0.545247    0.998233    0.989399    0.905412    0.749529    0.713633    0.710366    0.956312    0.808889    4200        37.102473   0.133809    0.355241    130.193048 
[37m[36mINFO[0m[0m 03/26 07:48:29 | 0.697258    0.695122    0.961827    0.849632    0.603775    1.000000    0.989399    0.909176    0.747646    0.697258    0.695122    0.976305    0.811852    4400        38.869258   0.095740    0.356862    131.636676 
[37m[36mINFO[0m[0m 03/26 07:51:54 | 0.714014    0.734756    0.971762    0.858274    0.492775    0.999117    0.996466    0.940235    0.745763    0.714014    0.734756    0.975935    0.832593    4600        40.636042   0.126405    0.373568    130.142696 
[37m[36mINFO[0m[0m 03/26 07:55:22 | 0.692308    0.708841    0.972044    0.863472    0.530411    1.000000    0.996466    0.943529    0.770245    0.692308    0.708841    0.972603    0.823704    4800        42.402827   0.100561    0.362352    135.007266 
[37m[36mINFO[0m[0m 03/26 07:58:47 | 0.720487    0.739329    0.968825    0.853081    0.594379    1.000000    0.989399    0.941647    0.768362    0.720487    0.739329    0.964828    0.801481    5000        44.169611   0.106443    0.367816    131.678201 
[37m[36mINFO[0m[0m 03/26 07:58:47 | Cumulative gradient change saved at train_output/VLCS/ERM/[2]/250326_06-31-57_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 07:58:48 | ---
[37m[36mINFO[0m[0m 03/26 07:58:48 | test-domain validation(oracle) = 74.524%
[37m[36mINFO[0m[0m 03/26 07:58:48 | training-domain validation(iid) = 69.916%
[37m[36mINFO[0m[0m 03/26 07:58:48 | last = 72.049%
[37m[36mINFO[0m[0m 03/26 07:58:48 | last (inD) = 85.308%
[37m[36mINFO[0m[0m 03/26 07:58:48 | training-domain validation (iid, inD) = 86.880%
[37m[36mINFO[0m[0m 03/26 07:58:48 | === Summary ===
[37m[36mINFO[0m[0m 03/26 07:58:48 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 2 --dataset VLCS --trial_seed 1 --hparams_seed 11
[37m[36mINFO[0m[0m 03/26 07:58:48 | Unique name: 250326_06-31-57_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 07:58:48 | Out path: train_output/VLCS/ERM/[2]/250326_06-31-57_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 07:58:48 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 07:58:48 | Dataset: VLCS

[37m[36mINFO[0m[0m 03/25 07:44:40 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 2 --dataset VLCS --trial_seed 0 --hparams_seed 19
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 19
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[2]/250325_07-44-40_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250325_07-44-40_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5.513854977685438e-05
	batch_size: 27
	weight_decay: 0.0014556716107047517
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/25 07:44:40 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 07:44:40 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 07:44:40 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 07:44:40 | 
[37m[36mINFO[0m[0m 03/25 07:44:40 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 03/25 07:44:40 | Test envs = [2], name = te_S
[37m[36mINFO[0m[0m 03/25 07:44:40 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 03/25 07:44:40 | Batch sizes for each domain: [27, 27, 0, 27] (total=81)
[37m[36mINFO[0m[0m 03/25 07:44:40 | steps-per-epoch for each domain: 41.93, 78.70, 100.04 -> min = 41.93
[37m[36mINFO[0m[0m 03/25 07:44:41 | # of params = 23518277
[37m[36mINFO[0m[0m 03/25 07:47:22 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 07:47:22 | 0.384615    0.387195    0.504871    0.521514    1.326444    0.611307    0.628975    0.459765    0.489642    0.384615    0.387195    0.443539    0.445926    0           0.000000    1.828983    2.416283    158.428460 
[37m[36mINFO[0m[0m 03/25 07:53:45 | 0.753237    0.733232    0.869885    0.863135    0.358502    0.999117    1.000000    0.750118    0.741996    0.753237    0.733232    0.860422    0.847407    200         4.770318    0.446180    1.132590    156.426614 
[37m[36mINFO[0m[0m 03/25 08:00:03 | 0.729627    0.717988    0.883945    0.861067    0.351568    1.000000    1.000000    0.778824    0.747646    0.729627    0.717988    0.873010    0.835556    400         9.540636    0.300858    1.116623    153.966506 
[37m[36mINFO[0m[0m 03/25 08:06:23 | 0.739528    0.716463    0.907064    0.864524    0.356740    0.999117    1.000000    0.806118    0.747646    0.739528    0.716463    0.915957    0.845926    600         14.310954   0.265977    1.126416    155.133583 
[37m[36mINFO[0m[0m 03/25 08:12:41 | 0.716299    0.702744    0.912497    0.883766    0.351070    1.000000    1.000000    0.831529    0.789077    0.716299    0.702744    0.905961    0.862222    800         19.081272   0.235004    1.119008    153.920442 
[37m[36mINFO[0m[0m 03/25 08:18:57 | 0.691546    0.661585    0.925904    0.871421    0.372189    1.000000    1.000000    0.856941    0.789077    0.691546    0.661585    0.920770    0.825185    1000        23.851590   0.206199    1.102653    156.223905 
[37m[36mINFO[0m[0m 03/25 08:25:22 | 0.670982    0.672256    0.929458    0.866175    0.406851    0.999117    0.996466    0.855529    0.745763    0.670982    0.672256    0.933728    0.856296    1200        28.621908   0.180637    1.144741    155.486251 
[37m[36mINFO[0m[0m 03/25 08:31:44 | 0.730008    0.682927    0.945012    0.880917    0.442553    1.000000    0.992933    0.903529    0.789077    0.730008    0.682927    0.931507    0.860741    1400        33.392226   0.143869    1.131730    156.092661 
[37m[36mINFO[0m[0m 03/25 08:38:07 | 0.720487    0.698171    0.960218    0.872664    0.414301    1.000000    0.992933    0.919529    0.770245    0.720487    0.698171    0.961126    0.854815    1600        38.162544   0.130351    1.141074    154.158224 
[37m[36mINFO[0m[0m 03/25 08:44:21 | 0.714775    0.670732    0.969637    0.872735    0.474461    1.000000    1.000000    0.932235    0.758945    0.714775    0.670732    0.976675    0.859259    1800        42.932862   0.111686    1.108440    153.041635 
[37m[36mINFO[0m[0m 03/25 08:50:33 | 0.690404    0.667683    0.976067    0.877876    0.494366    0.999117    0.996466    0.948706    0.785311    0.690404    0.667683    0.980378    0.851852    2000        47.703180   0.081413    1.103358    151.144440 
[37m[36mINFO[0m[0m 03/25 08:56:51 | 0.699162    0.670732    0.978321    0.870257    0.510932    1.000000    1.000000    0.957176    0.779661    0.699162    0.670732    0.977786    0.831111    2200        52.473498   0.092792    1.115766    154.641240 
[37m[36mINFO[0m[0m 03/25 09:03:11 | 0.708682    0.666159    0.945148    0.832819    0.616736    0.999117    1.000000    0.869647    0.662900    0.708682    0.666159    0.966679    0.835556    2400        57.243816   0.071426    1.111929    157.540652 
[37m[36mINFO[0m[0m 03/25 09:09:16 | 0.722772    0.690549    0.986055    0.872869    0.483397    1.000000    1.000000    0.972235    0.760829    0.722772    0.690549    0.985931    0.857778    2600        62.014134   0.072914    1.078703    148.786222 
[37m[36mINFO[0m[0m 03/25 09:15:33 | 0.684692    0.657012    0.986415    0.868784    0.588939    1.000000    1.000000    0.970353    0.758945    0.684692    0.657012    0.988893    0.847407    2800        66.784452   0.053706    1.105223    156.197079 
[37m[36mINFO[0m[0m 03/25 09:21:49 | 0.707540    0.682927    0.990933    0.867205    0.572422    1.000000    0.996466    0.978353    0.753296    0.707540    0.682927    0.994447    0.851852    3000        71.554770   0.044445    1.126169    151.086956 
[37m[36mINFO[0m[0m 03/25 09:28:07 | 0.710206    0.676829    0.982332    0.861865    0.667714    1.000000    0.996466    0.968471    0.747646    0.710206    0.676829    0.978526    0.841481    3200        76.325088   0.039208    1.096242    158.509329 
[37m[36mINFO[0m[0m 03/25 09:34:20 | 0.664509    0.644817    0.988488    0.863051    0.649489    1.000000    1.000000    0.976941    0.726930    0.664509    0.644817    0.988523    0.862222    3400        81.095406   0.046391    1.105158    152.494138 
[37m[36mINFO[0m[0m 03/25 09:40:28 | 0.720487    0.701220    0.994989    0.871775    0.677917    1.000000    0.996466    0.992000    0.775895    0.720487    0.701220    0.992966    0.842963    3600        85.865724   0.027743    1.078889    151.669970 
[37m[36mINFO[0m[0m 03/25 09:46:41 | 0.712871    0.701220    0.994661    0.861117    0.659448    0.999117    1.000000    0.991529    0.734463    0.712871    0.701220    0.993336    0.848889    3800        90.636042   0.028509    1.112886    150.903965 
[37m[36mINFO[0m[0m 03/25 09:52:50 | 0.697639    0.628049    0.980559    0.847439    0.669111    0.999117    0.989399    0.963294    0.730697    0.697639    0.628049    0.979267    0.822222    4000        95.406360   0.028343    1.080136    152.767523 
[37m[36mINFO[0m[0m 03/25 09:59:13 | 0.711729    0.676829    0.994148    0.867740    0.670848    1.000000    0.996466    0.990588    0.760829    0.711729    0.676829    0.991855    0.845926    4200        100.176678  0.025553    1.111409    160.626307 
[37m[36mINFO[0m[0m 03/25 10:05:22 | 0.676695    0.672256    0.995719    0.871831    0.670555    1.000000    1.000000    0.990118    0.774011    0.676695    0.672256    0.997038    0.841481    4400        104.946996  0.023460    1.078628    153.583455 
[37m[36mINFO[0m[0m 03/25 10:11:42 | 0.680883    0.655488    0.996009    0.869948    0.623087    1.000000    1.000000    0.992471    0.768362    0.680883    0.655488    0.995557    0.841481    4600        109.717314  0.024395    1.133071    153.184299 
[37m[36mINFO[0m[0m 03/25 10:17:58 | 0.679741    0.652439    0.991527    0.848244    0.661804    1.000000    1.000000    0.979765    0.706215    0.679741    0.652439    0.994817    0.838519    4800        114.487633  0.025022    1.123128    151.271406 
[37m[36mINFO[0m[0m 03/25 10:24:19 | 0.678599    0.629573    0.982940    0.860877    0.971551    0.999117    0.996466    0.958588    0.747646    0.678599    0.629573    0.991114    0.838519    5000        119.257951  0.019980    1.134378    154.019454 
[37m[36mINFO[0m[0m 03/25 10:24:19 | Cumulative gradient change saved at train_output/VLCS/ERM/[2]/250325_07-44-40_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 10:24:20 | ---
[37m[36mINFO[0m[0m 03/25 10:24:20 | test-domain validation(oracle) = 75.324%
[37m[36mINFO[0m[0m 03/25 10:24:20 | training-domain validation(iid) = 71.630%
[37m[36mINFO[0m[0m 03/25 10:24:20 | last = 67.860%
[37m[36mINFO[0m[0m 03/25 10:24:20 | last (inD) = 86.088%
[37m[36mINFO[0m[0m 03/25 10:24:20 | training-domain validation (iid, inD) = 88.377%
[37m[36mINFO[0m[0m 03/25 10:24:20 | === Summary ===
[37m[36mINFO[0m[0m 03/25 10:24:20 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 2 --dataset VLCS --trial_seed 0 --hparams_seed 19
[37m[36mINFO[0m[0m 03/25 10:24:20 | Unique name: 250325_07-44-40_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 10:24:20 | Out path: train_output/VLCS/ERM/[2]/250325_07-44-40_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 10:24:20 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 10:24:20 | Dataset: VLCS

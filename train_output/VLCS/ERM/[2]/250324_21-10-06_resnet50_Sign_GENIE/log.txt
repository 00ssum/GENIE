[37m[36mINFO[0m[0m 03/24 21:10:06 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 2 --dataset VLCS --trial_seed 0 --hparams_seed 13
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 13
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[2]/250324_21-10-06_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250324_21-10-06_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00014596629881421895
	batch_size: 9
	weight_decay: 0.0009399117661702502
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/24 21:10:06 | n_steps = 5001
[37m[36mINFO[0m[0m 03/24 21:10:06 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/24 21:10:06 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/24 21:10:06 | 
[37m[36mINFO[0m[0m 03/24 21:10:06 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 03/24 21:10:06 | Test envs = [2], name = te_S
[37m[36mINFO[0m[0m 03/24 21:10:06 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 03/24 21:10:06 | Batch sizes for each domain: [9, 9, 0, 9] (total=27)
[37m[36mINFO[0m[0m 03/24 21:10:06 | steps-per-epoch for each domain: 125.78, 236.11, 300.11 -> min = 125.78
[37m[36mINFO[0m[0m 03/24 21:10:07 | # of params = 23518277
[37m[36mINFO[0m[0m 03/24 21:12:23 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/24 21:12:23 | 0.384615    0.387195    0.504871    0.521514    1.258313    0.611307    0.628975    0.459765    0.489642    0.384615    0.387195    0.443539    0.445926    0           0.000000    1.774350    2.051118    134.368440 
[37m[36mINFO[0m[0m 03/24 21:15:51 | 0.673648    0.631098    0.848119    0.850924    0.423548    0.983216    0.985866    0.740706    0.747646    0.673648    0.631098    0.820437    0.819259    200         1.590106    0.500496    0.335965    140.616040 
[37m[36mINFO[0m[0m 03/24 21:19:29 | 0.731531    0.713415    0.872990    0.859812    0.370000    0.997350    1.000000    0.770824    0.743879    0.731531    0.713415    0.850796    0.835556    400         3.180212    0.384905    0.366628    144.532110 
[37m[36mINFO[0m[0m 03/24 21:23:02 | 0.745240    0.717988    0.878731    0.863120    0.368796    0.997350    0.996466    0.776941    0.751412    0.745240    0.717988    0.861903    0.841481    600         4.770318    0.338788    0.354642    142.057881 
[37m[36mINFO[0m[0m 03/24 21:26:30 | 0.739528    0.719512    0.892049    0.878159    0.341399    0.998233    1.000000    0.783059    0.779661    0.739528    0.719512    0.894854    0.854815    800         6.360424    0.326358    0.345349    139.001984 
[37m[36mINFO[0m[0m 03/24 21:30:08 | 0.723534    0.692073    0.892057    0.869531    0.353581    0.998233    0.996466    0.790118    0.772128    0.723534    0.692073    0.887819    0.840000    1000        7.950530    0.296482    0.387498    140.710400 
[37m[36mINFO[0m[0m 03/24 21:33:30 | 0.742955    0.722561    0.893524    0.867746    0.364280    1.000000    1.000000    0.781647    0.772128    0.742955    0.722561    0.898926    0.831111    1200        9.540636    0.293696    0.347737    131.553342 
[37m[36mINFO[0m[0m 03/24 21:36:52 | 0.729246    0.692073    0.896706    0.863444    0.386251    0.998233    1.000000    0.805176    0.753296    0.729246    0.692073    0.886709    0.837037    1400        11.130742   0.257638    0.333128    135.679496 
[37m[36mINFO[0m[0m 03/24 21:40:14 | 0.665651    0.646341    0.892070    0.855353    0.396802    0.994700    0.996466    0.810353    0.753296    0.665651    0.646341    0.871159    0.816296    1600        12.720848   0.277182    0.323918    136.924669 
[37m[36mINFO[0m[0m 03/24 21:43:29 | 0.764280    0.739329    0.906705    0.866717    0.388353    1.000000    1.000000    0.810824    0.764595    0.764280    0.739329    0.909293    0.835556    1800        14.310954   0.265503    0.323693    131.093842 
[37m[36mINFO[0m[0m 03/24 21:46:51 | 0.634044    0.628049    0.897866    0.847910    0.468020    0.999117    1.000000    0.827765    0.757062    0.634044    0.628049    0.866716    0.786667    2000        15.901060   0.232582    0.330733    135.839141 
[37m[36mINFO[0m[0m 03/24 21:50:09 | 0.734196    0.721037    0.922713    0.859310    0.419973    0.993816    0.985866    0.848000    0.768362    0.734196    0.721037    0.926324    0.823704    2200        17.491166   0.232257    0.331107    130.892315 
[37m[36mINFO[0m[0m 03/24 21:53:38 | 0.741432    0.725610    0.929885    0.863888    0.411890    0.999117    1.000000    0.854588    0.766478    0.741432    0.725610    0.935950    0.825185    2400        19.081272   0.214450    0.351830    139.207789 
[37m[36mINFO[0m[0m 03/24 21:57:13 | 0.709444    0.698171    0.915099    0.846211    0.451742    1.000000    1.000000    0.833412    0.740113    0.709444    0.698171    0.911884    0.798519    2600        20.671378   0.195071    0.360089    142.518894 
[37m[36mINFO[0m[0m 03/24 22:00:56 | 0.722391    0.702744    0.927923    0.862766    0.415962    0.999117    1.000000    0.851294    0.764595    0.722391    0.702744    0.933358    0.823704    2800        22.261484   0.212668    0.368286    149.658445 
[37m[36mINFO[0m[0m 03/24 22:04:14 | 0.691165    0.663110    0.934160    0.867021    0.396077    1.000000    0.996466    0.860235    0.764595    0.691165    0.663110    0.942244    0.840000    3000        23.851590   0.197354    0.336559    130.854033 
[37m[36mINFO[0m[0m 03/24 22:07:37 | 0.678599    0.664634    0.939413    0.860291    0.439741    1.000000    0.996466    0.878588    0.753296    0.678599    0.664634    0.939652    0.831111    3200        25.441696   0.182271    0.336223    135.479690 
[37m[36mINFO[0m[0m 03/24 22:10:59 | 0.729246    0.724085    0.947433    0.864432    0.401509    1.000000    1.000000    0.883765    0.753296    0.729246    0.724085    0.958534    0.840000    3400        27.031802   0.181647    0.338326    134.348746 
[37m[36mINFO[0m[0m 03/24 22:14:36 | 0.646230    0.623476    0.907302    0.842790    0.592597    0.999117    0.996466    0.826824    0.736347    0.646230    0.623476    0.895964    0.795556    3600        28.621908   0.168042    0.355115    146.166688 
[37m[36mINFO[0m[0m 03/24 22:18:13 | 0.631759    0.626524    0.939704    0.870031    0.506773    1.000000    1.000000    0.880941    0.783427    0.631759    0.626524    0.938171    0.826667    3800        30.212014   0.162925    0.366457    143.377564 
[37m[36mINFO[0m[0m 03/24 22:21:56 | 0.716299    0.689024    0.949600    0.877263    0.446819    1.000000    1.000000    0.879529    0.774011    0.716299    0.689024    0.969271    0.857778    4000        31.802120   0.143661    0.355458    152.409508 
[37m[36mINFO[0m[0m 03/24 22:25:39 | 0.731531    0.714939    0.953026    0.872135    0.447601    1.000000    0.996466    0.896471    0.774011    0.731531    0.714939    0.962606    0.845926    4200        33.392226   0.158697    0.355725    151.336147 
[37m[36mINFO[0m[0m 03/24 22:29:00 | 0.660320    0.628049    0.946264    0.848122    0.562419    0.996466    0.982332    0.913412    0.766478    0.660320    0.628049    0.928915    0.795556    4400        34.982332   0.125988    0.336226    134.007599 
[37m[36mINFO[0m[0m 03/24 22:32:21 | 0.669078    0.661585    0.953849    0.854823    0.454370    1.000000    1.000000    0.911529    0.757062    0.669078    0.661585    0.950019    0.807407    4600        36.572438   0.152486    0.335757    133.422484 
[37m[36mINFO[0m[0m 03/24 22:35:43 | 0.676314    0.646341    0.939118    0.841501    0.505998    1.000000    0.996466    0.886588    0.704331    0.676314    0.646341    0.930766    0.823704    4800        38.162544   0.097303    0.338061    134.791874 
[37m[36mINFO[0m[0m 03/24 22:39:15 | 0.696497    0.692073    0.962750    0.852030    0.452991    0.999117    0.996466    0.922824    0.755179    0.696497    0.692073    0.966309    0.804444    5000        39.752650   0.136928    0.345959    143.105973 
[37m[36mINFO[0m[0m 03/24 22:39:15 | Cumulative gradient change saved at train_output/VLCS/ERM/[2]/250324_21-10-06_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/24 22:39:17 | ---
[37m[36mINFO[0m[0m 03/24 22:39:17 | test-domain validation(oracle) = 76.428%
[37m[36mINFO[0m[0m 03/24 22:39:17 | training-domain validation(iid) = 73.953%
[37m[36mINFO[0m[0m 03/24 22:39:17 | last = 69.650%
[37m[36mINFO[0m[0m 03/24 22:39:17 | last (inD) = 85.203%
[37m[36mINFO[0m[0m 03/24 22:39:17 | training-domain validation (iid, inD) = 87.816%
[37m[36mINFO[0m[0m 03/24 22:39:17 | === Summary ===
[37m[36mINFO[0m[0m 03/24 22:39:17 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 2 --dataset VLCS --trial_seed 0 --hparams_seed 13
[37m[36mINFO[0m[0m 03/24 22:39:17 | Unique name: 250324_21-10-06_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 22:39:17 | Out path: train_output/VLCS/ERM/[2]/250324_21-10-06_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 22:39:17 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/24 22:39:17 | Dataset: VLCS

[37m[36mINFO[0m[0m 03/24 16:05:42 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 2 --dataset VLCS --trial_seed 0 --hparams_seed 10
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 10
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[2]/250324_16-05-42_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250324_16-05-42_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.5980189819232268e-05
	batch_size: 22
	weight_decay: 1.2831747186887755e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/24 16:05:42 | n_steps = 5001
[37m[36mINFO[0m[0m 03/24 16:05:42 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/24 16:05:42 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/24 16:05:42 | 
[37m[36mINFO[0m[0m 03/24 16:05:42 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 03/24 16:05:42 | Test envs = [2], name = te_S
[37m[36mINFO[0m[0m 03/24 16:05:42 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 03/24 16:05:42 | Batch sizes for each domain: [22, 22, 0, 22] (total=66)
[37m[36mINFO[0m[0m 03/24 16:05:42 | steps-per-epoch for each domain: 51.45, 96.59, 122.77 -> min = 51.45
[37m[36mINFO[0m[0m 03/24 16:05:43 | # of params = 23518277
[37m[36mINFO[0m[0m 03/24 16:07:59 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/24 16:07:59 | 0.384235    0.387195    0.505117    0.521514    1.247878    0.611307    0.628975    0.459765    0.489642    0.384235    0.387195    0.444280    0.445926    0           0.000000    1.836092    1.454037    134.101420 
[37m[36mINFO[0m[0m 03/24 16:12:47 | 0.742574    0.730183    0.874558    0.874124    0.339267    0.999117    1.000000    0.763765    0.764595    0.742574    0.730183    0.860792    0.857778    200         3.886926    0.469329    0.783622    131.202342 
[37m[36mINFO[0m[0m 03/24 16:17:41 | 0.739147    0.710366    0.889004    0.873622    0.351119    0.999117    1.000000    0.798588    0.785311    0.739147    0.710366    0.869308    0.835556    400         7.773852    0.319032    0.804629    133.708387 
[37m[36mINFO[0m[0m 03/24 16:22:35 | 0.746382    0.727134    0.906588    0.877573    0.336846    1.000000    1.000000    0.823059    0.785311    0.746382    0.727134    0.896705    0.847407    600         11.660777   0.287985    0.809209    131.935145 
[37m[36mINFO[0m[0m 03/24 16:27:25 | 0.779132    0.746951    0.900549    0.864771    0.386030    0.998233    0.992933    0.791529    0.749529    0.779132    0.746951    0.911884    0.851852    800         15.547703   0.257054    0.788863    131.771675 
[37m[36mINFO[0m[0m 03/24 16:32:15 | 0.757807    0.743902    0.922915    0.876269    0.344584    1.000000    0.996466    0.840941    0.762712    0.757807    0.743902    0.927805    0.869630    1000        19.434629   0.238296    0.783789    133.589473 
[37m[36mINFO[0m[0m 03/24 16:37:11 | 0.631379    0.596037    0.883356    0.843800    0.499662    0.999117    1.000000    0.759059    0.706215    0.631379    0.596037    0.891892    0.825185    1200        23.321555   0.220357    0.808967    134.577901 
[37m[36mINFO[0m[0m 03/24 16:42:05 | 0.714775    0.702744    0.936594    0.871655    0.399056    1.000000    1.000000    0.859765    0.764595    0.714775    0.702744    0.950019    0.850370    1400        27.208481   0.192933    0.789570    135.858452 
[37m[36mINFO[0m[0m 03/24 16:46:54 | 0.693831    0.650915    0.934358    0.867160    0.415147    1.000000    1.000000    0.868235    0.777778    0.693831    0.650915    0.934839    0.823704    1600        31.095406   0.178637    0.790550    131.116933 
[37m[36mINFO[0m[0m 03/24 16:51:44 | 0.680883    0.658537    0.948125    0.868418    0.397312    1.000000    0.996466    0.891765    0.749529    0.680883    0.658537    0.952610    0.859259    1800        34.982332   0.160434    0.776396    134.507186 
[37m[36mINFO[0m[0m 03/24 16:56:35 | 0.699543    0.675305    0.961601    0.873538    0.392357    1.000000    1.000000    0.912941    0.770245    0.699543    0.675305    0.971862    0.850370    2000        38.869258   0.143723    0.774249    135.823144 
[37m[36mINFO[0m[0m 03/24 17:01:24 | 0.709444    0.696646    0.973057    0.871013    0.406858    1.000000    0.996466    0.936941    0.772128    0.709444    0.696646    0.982229    0.844444    2200        42.756184   0.122492    0.773932    133.956052 
[37m[36mINFO[0m[0m 03/24 17:06:15 | 0.730008    0.676829    0.962017    0.854656    0.535921    1.000000    1.000000    0.910118    0.726930    0.730008    0.676829    0.975935    0.837037    2400        46.643110   0.109828    0.787569    134.262272 
[37m[36mINFO[0m[0m 03/24 17:11:05 | 0.721630    0.689024    0.968279    0.868806    0.483397    1.000000    0.992933    0.932235    0.764595    0.721630    0.689024    0.972603    0.848889    2600        50.530035   0.107487    0.771099    135.829877 
[37m[36mINFO[0m[0m 03/24 17:15:54 | 0.727342    0.681402    0.964402    0.856631    0.618062    1.000000    1.000000    0.922824    0.726930    0.727342    0.681402    0.970381    0.842963    2800        54.416961   0.087720    0.797112    128.972002 
[37m[36mINFO[0m[0m 03/24 17:20:49 | 0.719726    0.705793    0.978413    0.870216    0.658063    1.000000    1.000000    0.951529    0.772128    0.719726    0.705793    0.983710    0.838519    3000        58.303887   0.088337    0.795934    136.181556 
[37m[36mINFO[0m[0m 03/24 17:25:41 | 0.739909    0.681402    0.976266    0.862858    0.637996    0.998233    1.000000    0.948706    0.758945    0.739909    0.681402    0.981859    0.829630    3200        62.190813   0.075295    0.787731    134.451625 
[37m[36mINFO[0m[0m 03/24 17:30:24 | 0.718203    0.698171    0.983764    0.872325    0.619777    0.998233    1.000000    0.965647    0.774011    0.718203    0.698171    0.987412    0.842963    3400        66.077739   0.064384    0.771806    128.108629 
[37m[36mINFO[0m[0m 03/24 17:35:14 | 0.693450    0.664634    0.987724    0.857900    0.582141    1.000000    0.992933    0.978353    0.757062    0.693450    0.664634    0.984820    0.823704    3600        69.964664   0.072148    0.792401    131.730587 
[37m[36mINFO[0m[0m 03/24 17:40:04 | 0.715537    0.681402    0.972475    0.855947    0.601210    1.000000    0.996466    0.932235    0.726930    0.715537    0.681402    0.985191    0.844444    3800        73.851590   0.061205    0.795014    130.657128 
[37m[36mINFO[0m[0m 03/24 17:44:59 | 0.722391    0.695122    0.985798    0.857724    0.688104    1.000000    0.992933    0.970353    0.747646    0.722391    0.695122    0.987042    0.832593    4000        77.738516   0.050337    0.801312    135.254960 
[37m[36mINFO[0m[0m 03/24 17:49:56 | 0.725819    0.692073    0.994361    0.871683    0.663183    1.000000    0.996466    0.990118    0.781544    0.725819    0.692073    0.992966    0.837037    4200        81.625442   0.039407    0.812369    134.244104 
[37m[36mINFO[0m[0m 03/24 17:54:49 | 0.703732    0.681402    0.986796    0.862400    0.661427    1.000000    0.996466    0.972235    0.755179    0.703732    0.681402    0.988153    0.835556    4400        85.512367   0.041104    0.813400    130.254521 
[37m[36mINFO[0m[0m 03/24 17:59:43 | 0.683930    0.657012    0.989077    0.857334    0.681718    1.000000    1.000000    0.988706    0.764595    0.683930    0.657012    0.978526    0.807407    4600        89.399293   0.044844    0.801715    133.806608 
[37m[36mINFO[0m[0m 03/24 18:04:36 | 0.738766    0.714939    0.983117    0.864016    0.838577    0.999117    0.996466    0.962824    0.757062    0.738766    0.714939    0.987412    0.838519    4800        93.286219   0.033352    0.797596    133.672131 
[37m[36mINFO[0m[0m 03/24 18:09:31 | 0.715156    0.679878    0.990850    0.865455    0.626852    0.999117    0.996466    0.983059    0.749529    0.715156    0.679878    0.990374    0.850370    5000        97.173145   0.039076    0.804213    134.499102 
[37m[36mINFO[0m[0m 03/24 18:09:32 | Cumulative gradient change saved at train_output/VLCS/ERM/[2]/250324_16-05-42_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/24 18:09:33 | ---
[37m[36mINFO[0m[0m 03/24 18:09:33 | test-domain validation(oracle) = 77.913%
[37m[36mINFO[0m[0m 03/24 18:09:33 | training-domain validation(iid) = 74.638%
[37m[36mINFO[0m[0m 03/24 18:09:33 | last = 71.516%
[37m[36mINFO[0m[0m 03/24 18:09:33 | last (inD) = 86.546%
[37m[36mINFO[0m[0m 03/24 18:09:33 | training-domain validation (iid, inD) = 87.757%
[37m[36mINFO[0m[0m 03/24 18:09:33 | === Summary ===
[37m[36mINFO[0m[0m 03/24 18:09:33 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 2 --dataset VLCS --trial_seed 0 --hparams_seed 10
[37m[36mINFO[0m[0m 03/24 18:09:33 | Unique name: 250324_16-05-42_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 18:09:33 | Out path: train_output/VLCS/ERM/[2]/250324_16-05-42_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 18:09:33 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/24 18:09:33 | Dataset: VLCS

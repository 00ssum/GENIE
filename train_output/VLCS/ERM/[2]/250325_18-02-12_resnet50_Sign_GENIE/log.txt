[37m[36mINFO[0m[0m 03/25 18:02:12 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 2 --dataset VLCS --trial_seed 1 --hparams_seed 3
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 3
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[2]/250325_18-02-12_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 1
	unique_name: 250325_18-02-12_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00018664964766736356
	batch_size: 13
	weight_decay: 0.0001969969539389593
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/25 18:02:12 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 18:02:12 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 18:02:12 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 18:02:12 | 
[37m[36mINFO[0m[0m 03/25 18:02:12 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 03/25 18:02:12 | Test envs = [2], name = te_S
[37m[36mINFO[0m[0m 03/25 18:02:12 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 03/25 18:02:12 | Batch sizes for each domain: [13, 13, 0, 13] (total=39)
[37m[36mINFO[0m[0m 03/25 18:02:12 | steps-per-epoch for each domain: 87.08, 163.46, 207.77 -> min = 87.08
[37m[36mINFO[0m[0m 03/25 18:02:14 | # of params = 23518277
[37m[36mINFO[0m[0m 03/25 18:04:26 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 18:04:26 | 0.376618    0.419207    0.511439    0.495231    1.415526    0.613958    0.618375    0.466824    0.461394    0.376618    0.419207    0.453536    0.405926    0           0.000000    1.853185    0.971229    131.232067 
[37m[36mINFO[0m[0m 03/25 18:08:16 | 0.642803    0.664634    0.851274    0.837628    0.425565    0.999117    0.992933    0.720941    0.708098    0.642803    0.664634    0.833765    0.811852    200         2.296820    0.510393    0.469914    136.367545 
[37m[36mINFO[0m[0m 03/25 18:12:07 | 0.705255    0.714939    0.875556    0.861999    0.389860    0.993816    0.996466    0.778353    0.749529    0.705255    0.714939    0.854498    0.840000    400         4.593640    0.363485    0.475236    135.767416 
[37m[36mINFO[0m[0m 03/25 18:16:05 | 0.710967    0.730183    0.891196    0.871471    0.351917    1.000000    1.000000    0.795765    0.775895    0.710967    0.730183    0.877823    0.838519    600         6.890459    0.337718    0.496197    138.435727 
[37m[36mINFO[0m[0m 03/25 18:19:59 | 0.741432    0.768293    0.898080    0.872593    0.348361    0.999117    1.000000    0.799529    0.777778    0.741432    0.768293    0.895594    0.840000    800         9.187279    0.310332    0.475899    139.008155 
[37m[36mINFO[0m[0m 03/25 18:23:52 | 0.703351    0.711890    0.880742    0.852417    0.409917    1.000000    0.992933    0.791059    0.770245    0.703351    0.711890    0.851166    0.794074    1000        11.484099   0.288106    0.464619    139.997020 
[37m[36mINFO[0m[0m 03/25 18:27:46 | 0.728104    0.728659    0.911920    0.867021    0.370719    0.998233    0.996466    0.828235    0.764595    0.728104    0.728659    0.909293    0.840000    1200        13.780919   0.262002    0.490946    135.520156 
[37m[36mINFO[0m[0m 03/25 18:31:47 | 0.752094    0.783537    0.906512    0.873137    0.367135    1.000000    1.000000    0.792471    0.764595    0.752094    0.783537    0.927064    0.854815    1400        16.077739   0.250671    0.510194    139.542093 
[37m[36mINFO[0m[0m 03/25 18:35:40 | 0.768088    0.775915    0.921721    0.875993    0.371318    1.000000    0.996466    0.825882    0.779661    0.768088    0.775915    0.939282    0.851852    1600        18.374558   0.252871    0.483908    135.544573 
[37m[36mINFO[0m[0m 03/25 18:39:25 | 0.760091    0.748476    0.925066    0.875823    0.359270    0.999117    1.000000    0.842353    0.781544    0.760091    0.748476    0.933728    0.845926    1800        20.671378   0.221718    0.458614    133.276334 
[37m[36mINFO[0m[0m 03/25 18:43:12 | 0.735720    0.771341    0.918913    0.856644    0.445006    0.999117    0.992933    0.828706    0.753296    0.735720    0.771341    0.928915    0.823704    2000        22.968198   0.230476    0.463143    135.156083 
[37m[36mINFO[0m[0m 03/25 18:47:11 | 0.747906    0.753049    0.942010    0.878462    0.381531    1.000000    0.996466    0.868235    0.779661    0.747906    0.753049    0.957793    0.859259    2200        25.265018   0.215345    0.481013    142.314430 
[37m[36mINFO[0m[0m 03/25 18:50:54 | 0.725819    0.728659    0.946826    0.870123    0.375554    1.000000    1.000000    0.885647    0.777778    0.725819    0.728659    0.954832    0.832593    2400        27.561837   0.206729    0.466794    129.973886 
[37m[36mINFO[0m[0m 03/25 18:54:41 | 0.748667    0.739329    0.937965    0.860023    0.447929    1.000000    0.996466    0.856471    0.749529    0.748667    0.739329    0.957423    0.834074    2600        29.858657   0.162695    0.474990    131.580119 
[37m[36mINFO[0m[0m 03/25 18:58:27 | 0.726200    0.730183    0.952352    0.872388    0.414643    1.000000    0.992933    0.897412    0.787194    0.726200    0.730183    0.959645    0.837037    2800        32.155477   0.151859    0.472379    131.742958 
[37m[36mINFO[0m[0m 03/25 19:02:14 | 0.735339    0.734756    0.957654    0.866244    0.432206    1.000000    0.992933    0.907765    0.770245    0.735339    0.734756    0.965198    0.835556    3000        34.452297   0.174751    0.460850    134.456439 
[37m[36mINFO[0m[0m 03/25 19:06:00 | 0.632521    0.647866    0.927415    0.845526    0.560169    1.000000    0.996466    0.840000    0.740113    0.632521    0.647866    0.942244    0.800000    3200        36.749117   0.132071    0.465791    132.931899 
[37m[36mINFO[0m[0m 03/25 19:09:46 | 0.713633    0.705793    0.961419    0.858301    0.512131    1.000000    0.992933    0.919059    0.762712    0.713633    0.705793    0.965198    0.819259    3400        39.045936   0.138349    0.464277    132.935285 
[37m[36mINFO[0m[0m 03/25 19:13:34 | 0.691927    0.710366    0.967696    0.855282    0.498544    1.000000    0.989399    0.932706    0.764595    0.691927    0.710366    0.970381    0.811852    3600        41.342756   0.117415    0.475656    133.300451 
[37m[36mINFO[0m[0m 03/25 19:17:22 | 0.737624    0.751524    0.965239    0.868663    0.563698    0.999117    0.992933    0.926588    0.783427    0.737624    0.751524    0.970011    0.829630    3800        43.639576   0.128945    0.465456    134.606182 
[37m[36mINFO[0m[0m 03/25 19:21:08 | 0.704494    0.722561    0.968868    0.863698    0.533540    0.998233    0.996466    0.933176    0.766478    0.704494    0.722561    0.975194    0.828148    4000        45.936396   0.112162    0.469497    131.864692 
[37m[36mINFO[0m[0m 03/25 19:24:53 | 0.700685    0.719512    0.973011    0.865349    0.533397    1.000000    0.992933    0.939765    0.764595    0.700685    0.719512    0.979267    0.838519    4200        48.233216   0.101480    0.476560    129.918843 
[37m[36mINFO[0m[0m 03/25 19:28:40 | 0.716299    0.733232    0.970710    0.866780    0.642447    1.000000    0.992933    0.942118    0.777778    0.716299    0.733232    0.970011    0.829630    4400        50.530035   0.094334    0.463908    134.456470 
[37m[36mINFO[0m[0m 03/25 19:32:29 | 0.728484    0.724085    0.955139    0.845788    0.802418    1.000000    0.992933    0.888000    0.732580    0.728484    0.724085    0.977416    0.811852    4600        52.826855   0.093777    0.476635    133.533349 
[37m[36mINFO[0m[0m 03/25 19:36:14 | 0.720868    0.717988    0.978577    0.856094    0.579214    0.999117    0.989399    0.956235    0.755179    0.720868    0.717988    0.980378    0.823704    4800        55.123675   0.096799    0.476725    129.323992 
[37m[36mINFO[0m[0m 03/25 19:39:59 | 0.689261    0.699695    0.970017    0.868770    0.514904    1.000000    0.996466    0.934118    0.768362    0.689261    0.699695    0.975935    0.841481    5000        57.420495   0.086016    0.466602    131.971160 
[37m[36mINFO[0m[0m 03/25 19:39:59 | Cumulative gradient change saved at train_output/VLCS/ERM/[2]/250325_18-02-12_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 19:40:00 | ---
[37m[36mINFO[0m[0m 03/25 19:40:00 | test-domain validation(oracle) = 75.209%
[37m[36mINFO[0m[0m 03/25 19:40:00 | training-domain validation(iid) = 74.791%
[37m[36mINFO[0m[0m 03/25 19:40:00 | last = 68.926%
[37m[36mINFO[0m[0m 03/25 19:40:00 | last (inD) = 86.877%
[37m[36mINFO[0m[0m 03/25 19:40:00 | training-domain validation (iid, inD) = 87.846%
[37m[36mINFO[0m[0m 03/25 19:40:00 | === Summary ===
[37m[36mINFO[0m[0m 03/25 19:40:00 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 2 --dataset VLCS --trial_seed 1 --hparams_seed 3
[37m[36mINFO[0m[0m 03/25 19:40:00 | Unique name: 250325_18-02-12_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 19:40:00 | Out path: train_output/VLCS/ERM/[2]/250325_18-02-12_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 19:40:00 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 19:40:00 | Dataset: VLCS

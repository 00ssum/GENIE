[37m[36mINFO[0m[0m 03/25 13:15:34 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 2 --dataset VLCS --trial_seed 1 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[2]/250325_13-15-34_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 1
	unique_name: 250325_13-15-34_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 1.2332416678311953e-05
	batch_size: 13
	weight_decay: 0.0018634819595667504
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/25 13:15:34 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 13:15:34 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 13:15:34 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 13:15:34 | 
[37m[36mINFO[0m[0m 03/25 13:15:34 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 03/25 13:15:34 | Test envs = [2], name = te_S
[37m[36mINFO[0m[0m 03/25 13:15:34 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 03/25 13:15:34 | Batch sizes for each domain: [13, 13, 0, 13] (total=39)
[37m[36mINFO[0m[0m 03/25 13:15:34 | steps-per-epoch for each domain: 87.08, 163.46, 207.77 -> min = 87.08
[37m[36mINFO[0m[0m 03/25 13:15:35 | # of params = 23518277
[37m[36mINFO[0m[0m 03/25 13:18:13 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 13:18:13 | 0.376618    0.419207    0.511439    0.495231    1.399863    0.613958    0.618375    0.466824    0.461394    0.376618    0.419207    0.453536    0.405926    0           0.000000    1.919986    1.297734    156.497570 
[37m[36mINFO[0m[0m 03/25 13:22:36 | 0.647753    0.666159    0.854334    0.841536    0.412246    0.997350    0.992933    0.716706    0.700565    0.647753    0.666159    0.848945    0.831111    200         2.296820    0.464493    0.543512    154.300289 
[37m[36mINFO[0m[0m 03/25 13:26:54 | 0.704874    0.730183    0.884672    0.863084    0.372438    1.000000    1.000000    0.782118    0.755179    0.704874    0.730183    0.871899    0.834074    400         4.593640    0.341649    0.514372    154.880029 
[37m[36mINFO[0m[0m 03/25 13:31:23 | 0.750190    0.765244    0.886976    0.865009    0.364670    0.998233    1.000000    0.786353    0.768362    0.750190    0.765244    0.876342    0.826667    600         6.890459    0.317001    0.565240    156.633811 
[37m[36mINFO[0m[0m 03/25 13:35:48 | 0.720868    0.763720    0.906789    0.876606    0.357075    0.999117    0.992933    0.817882    0.790960    0.720868    0.763720    0.903369    0.845926    800         9.187279    0.279705    0.543099    156.279038 
[37m[36mINFO[0m[0m 03/25 13:40:10 | 0.712110    0.716463    0.903077    0.873220    0.363666    0.999117    1.000000    0.816000    0.779661    0.712110    0.716463    0.894113    0.840000    1000        11.484099   0.266659    0.538558    154.030266 
[37m[36mINFO[0m[0m 03/25 13:44:40 | 0.736862    0.727134    0.918351    0.868318    0.377667    1.000000    0.996466    0.835765    0.775895    0.736862    0.727134    0.919289    0.832593    1200        13.780919   0.237047    0.564368    156.608321 
[37m[36mINFO[0m[0m 03/25 13:49:09 | 0.682026    0.704268    0.913235    0.857250    0.385269    1.000000    1.000000    0.836706    0.749529    0.682026    0.704268    0.902999    0.822222    1400        16.077739   0.221147    0.576232    153.874224 
[37m[36mINFO[0m[0m 03/25 13:53:41 | 0.737624    0.750000    0.929935    0.869017    0.391926    1.000000    0.989399    0.849412    0.770245    0.737624    0.750000    0.940392    0.847407    1600        18.374558   0.222903    0.574938    157.537060 
[37m[36mINFO[0m[0m 03/25 13:58:07 | 0.745621    0.753049    0.920832    0.865271    0.427173    0.996466    0.996466    0.833412    0.760829    0.745621    0.753049    0.932618    0.838519    1800        20.671378   0.208912    0.555840    154.793624 
[37m[36mINFO[0m[0m 03/25 14:02:36 | 0.710206    0.740854    0.933168    0.856933    0.437332    1.000000    0.985866    0.870588    0.762712    0.710206    0.740854    0.928915    0.822222    2000        22.968198   0.214775    0.560884    157.152671 
[37m[36mINFO[0m[0m 03/25 14:07:01 | 0.742955    0.759146    0.939054    0.862648    0.438752    0.999117    0.989399    0.872471    0.757062    0.742955    0.759146    0.945576    0.841481    2200        25.265018   0.186009    0.554868    153.997391 
[37m[36mINFO[0m[0m 03/25 14:11:27 | 0.746763    0.737805    0.940514    0.858950    0.419026    1.000000    1.000000    0.876706    0.766478    0.746763    0.737805    0.944835    0.810370    2400        27.561837   0.186471    0.548480    155.712097 
[37m[36mINFO[0m[0m 03/25 14:15:52 | 0.692688    0.693598    0.953358    0.872564    0.379000    1.000000    0.992933    0.906353    0.796610    0.692688    0.693598    0.953721    0.828148    2600        29.858657   0.165141    0.558290    153.640287 
[37m[36mINFO[0m[0m 03/25 14:20:20 | 0.706778    0.734756    0.962128    0.871266    0.382116    1.000000    0.992933    0.913412    0.785311    0.706778    0.734756    0.972973    0.835556    2800        32.155477   0.150918    0.548440    158.215957 
[37m[36mINFO[0m[0m 03/25 14:24:45 | 0.718203    0.725610    0.954515    0.862993    0.493117    1.000000    0.985866    0.903529    0.764595    0.718203    0.725610    0.960015    0.838519    3000        34.452297   0.125569    0.552906    154.554301 
[37m[36mINFO[0m[0m 03/25 14:29:11 | 0.670602    0.670732    0.954590    0.846966    0.509206    1.000000    0.996466    0.911529    0.732580    0.670602    0.670732    0.952240    0.811852    3200        36.749117   0.123616    0.536501    158.978019 
[37m[36mINFO[0m[0m 03/25 14:33:25 | 0.685834    0.701220    0.926418    0.828239    0.615513    0.999117    0.989399    0.830118    0.696798    0.685834    0.701220    0.950019    0.798519    3400        39.045936   0.122463    0.542323    145.316167 
[37m[36mINFO[0m[0m 03/25 14:37:29 | 0.691546    0.716463    0.968953    0.857152    0.485268    1.000000    0.996466    0.931294    0.743879    0.691546    0.716463    0.975565    0.831111    3600        41.342756   0.136191    0.512332    140.894898 
[37m[36mINFO[0m[0m 03/25 14:41:33 | 0.738766    0.736280    0.962139    0.862915    0.519602    1.000000    0.989399    0.915294    0.760829    0.738766    0.736280    0.971122    0.838519    3800        43.639576   0.117984    0.488445    147.086088 
[37m[36mINFO[0m[0m 03/25 14:45:48 | 0.720107    0.731707    0.963515    0.864968    0.559060    0.999117    1.000000    0.916235    0.760829    0.720107    0.731707    0.975194    0.834074    4000        45.936396   0.095535    0.516171    151.349847 
[37m[36mINFO[0m[0m 03/25 14:50:01 | 0.710206    0.711890    0.971325    0.848257    0.537564    0.999117    0.992933    0.939294    0.732580    0.710206    0.711890    0.975565    0.819259    4200        48.233216   0.089324    0.510618    151.210771 
[37m[36mINFO[0m[0m 03/25 14:54:10 | 0.685072    0.702744    0.976495    0.853265    0.591466    1.000000    0.989399    0.950588    0.757062    0.685072    0.702744    0.978897    0.813333    4400        50.530035   0.085365    0.510102    146.829805 
[37m[36mINFO[0m[0m 03/25 14:58:19 | 0.713252    0.702744    0.976855    0.856743    0.590882    1.000000    0.982332    0.948706    0.762712    0.713252    0.702744    0.981859    0.825185    4600        52.826855   0.086587    0.501556    148.393254 
[37m[36mINFO[0m[0m 03/25 15:02:27 | 0.683168    0.707317    0.963916    0.853307    0.593652    1.000000    0.989399    0.929882    0.764595    0.683168    0.707317    0.961866    0.805926    4800        55.123675   0.103137    0.513689    145.239835 
[37m[36mINFO[0m[0m 03/25 15:06:38 | 0.695354    0.693598    0.976498    0.855910    0.566275    0.998233    0.989399    0.957176    0.766478    0.695354    0.693598    0.974084    0.811852    5000        57.420495   0.078691    0.522351    146.720388 
[37m[36mINFO[0m[0m 03/25 15:06:38 | Cumulative gradient change saved at train_output/VLCS/ERM/[2]/250325_13-15-34_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 15:06:40 | ---
[37m[36mINFO[0m[0m 03/25 15:06:40 | test-domain validation(oracle) = 75.019%
[37m[36mINFO[0m[0m 03/25 15:06:40 | training-domain validation(iid) = 72.087%
[37m[36mINFO[0m[0m 03/25 15:06:40 | last = 69.535%
[37m[36mINFO[0m[0m 03/25 15:06:40 | last (inD) = 85.591%
[37m[36mINFO[0m[0m 03/25 15:06:40 | training-domain validation (iid, inD) = 87.661%
[37m[36mINFO[0m[0m 03/25 15:06:40 | === Summary ===
[37m[36mINFO[0m[0m 03/25 15:06:40 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 2 --dataset VLCS --trial_seed 1 --hparams_seed 1
[37m[36mINFO[0m[0m 03/25 15:06:40 | Unique name: 250325_13-15-34_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 15:06:40 | Out path: train_output/VLCS/ERM/[2]/250325_13-15-34_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 15:06:40 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 15:06:40 | Dataset: VLCS

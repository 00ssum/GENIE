[37m[36mINFO[0m[0m 03/14 08:57:43 | Command :: /jsm0707/GENIE/train_all.py resnet50_signum config/resnet50_signum.yaml --algorithm ERM --test_envs 0 --dataset VLCS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_signum.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_signum
	out_dir: train_output/VLCS/ERM/[0]/250314_08-57-43_resnet50_signum
	out_root: train_output/VLCS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250314_08-57-43_resnet50_signum
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: signum
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/14 08:57:43 | n_steps = 5001
[37m[36mINFO[0m[0m 03/14 08:57:43 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/14 08:57:43 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/14 08:57:43 | 
[37m[36mINFO[0m[0m 03/14 08:57:43 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/14 08:57:43 | Test envs = [0], name = te_C
[37m[36mINFO[0m[0m 03/14 08:57:43 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/14 08:57:43 | Batch sizes for each domain: [0, 32, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/14 08:57:43 | steps-per-epoch for each domain: 66.41, 82.06, 84.41 -> min = 66.41
[37m[36mINFO[0m[0m 03/14 08:57:45 | # of params = 23518277
[37m[36mINFO[0m[0m 03/14 09:00:01 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/14 09:00:01 | 0.299470    0.275618    0.467250    0.479788    1.358681    0.299470    0.275618    0.513882    0.536723    0.415080    0.435976    0.472788    0.466667    0           0.000000    1.786248    1.701784    134.310903 
[37m[36mINFO[0m[0m 03/14 09:05:57 | 0.965548    0.954064    0.784788    0.753659    0.606564    0.965548    0.954064    0.758118    0.740113    0.766184    0.714939    0.830063    0.805926    200         3.011765    0.663132    1.117438    133.063612 
[37m[36mINFO[0m[0m 03/14 09:11:55 | 0.927562    0.932862    0.789992    0.760106    0.711928    0.927562    0.932862    0.727059    0.715631    0.793602    0.745427    0.849315    0.819259    400         6.023529    0.562971    1.123227    133.295778 
[37m[36mINFO[0m[0m 03/14 09:17:49 | 0.874558    0.890459    0.802241    0.773367    0.665999    0.874558    0.890459    0.753882    0.728814    0.844250    0.795732    0.808589    0.795556    600         9.035294    0.663753    1.101947    133.806033 
[37m[36mINFO[0m[0m 03/14 09:23:43 | 0.799470    0.798587    0.680543    0.657327    0.864266    0.799470    0.798587    0.630118    0.596987    0.713252    0.690549    0.698260    0.684444    800         12.047059   0.788077    1.090666    135.419750 
[37m[36mINFO[0m[0m 03/14 09:29:36 | 0.769435    0.773852    0.697423    0.685162    0.785351    0.769435    0.773852    0.699765    0.719397    0.695354    0.676829    0.697149    0.659259    1000        15.058824   1.179930    1.088868    135.774437 
[37m[36mINFO[0m[0m 03/14 09:35:33 | 0.605124    0.643110    0.499916    0.519308    1.286952    0.605124    0.643110    0.635765    0.655367    0.408225    0.432927    0.455757    0.469630    1200        18.070588   1.697900    1.107355    134.808173 
[37m[36mINFO[0m[0m 03/14 09:41:34 | 0.275618    0.233216    0.503813    0.499798    1.241183    0.275618    0.233216    0.507765    0.497175    0.585682    0.605183    0.417993    0.397037    1400        21.082353   1.398306    1.112330    138.857675 
[37m[36mINFO[0m[0m 03/14 09:47:34 | 0.230565    0.233216    0.427143    0.444050    1.139622    0.230565    0.233216    0.473882    0.461394    0.469155    0.513720    0.338393    0.357037    1600        24.094118   1.438180    1.117570    136.232805 
[37m[36mINFO[0m[0m 03/14 09:53:31 | 0.653710    0.625442    0.493014    0.501950    1.145607    0.653710    0.625442    0.515765    0.506591    0.477532    0.500000    0.485746    0.499259    1800        27.105882   1.334295    1.101765    136.420552 
[37m[36mINFO[0m[0m 03/14 09:59:32 | 0.638693    0.660777    0.479678    0.482225    1.087816    0.638693    0.660777    0.524235    0.527307    0.451637    0.451220    0.463162    0.468148    2000        30.117647   1.335671    1.123136    136.963771 
[37m[36mINFO[0m[0m 03/14 10:05:30 | 0.484982    0.466431    0.519165    0.529369    1.086915    0.484982    0.466431    0.552941    0.570621    0.537319    0.568598    0.467234    0.448889    2200        33.129412   1.294578    1.127315    132.716408 
[37m[36mINFO[0m[0m 03/14 10:11:28 | 0.299470    0.257951    0.484762    0.485670    1.295720    0.299470    0.257951    0.490353    0.478343    0.554455    0.557927    0.409478    0.420741    2400        36.141176   1.257546    1.111945    135.207258 
[37m[36mINFO[0m[0m 03/14 10:17:24 | 0.514134    0.512367    0.559175    0.571227    1.073226    0.514134    0.512367    0.560941    0.566855    0.611957    0.637195    0.504628    0.509630    2600        39.152941   1.216902    1.117319    132.673860 
[37m[36mINFO[0m[0m 03/14 10:23:19 | 0.250883    0.229682    0.493375    0.494458    1.241400    0.250883    0.229682    0.488000    0.491525    0.596344    0.605183    0.395779    0.386667    2800        42.164706   1.195932    1.105149    133.520007 
[37m[36mINFO[0m[0m 03/14 10:29:15 | 0.469081    0.434629    0.476630    0.494382    1.249179    0.469081    0.434629    0.556706    0.581921    0.459634    0.490854    0.413551    0.410370    3000        45.176471   1.220890    1.106570    135.327759 
[37m[36mINFO[0m[0m 03/14 10:35:09 | 0.660777    0.667845    0.479228    0.494245    1.148016    0.660777    0.667845    0.516706    0.549906    0.447449    0.455793    0.473528    0.477037    3200        48.188235   1.210566    1.093371    134.992267 
[37m[36mINFO[0m[0m 03/14 10:41:08 | 0.152827    0.137809    0.423462    0.425387    1.466826    0.152827    0.137809    0.417882    0.406780    0.554836    0.570122    0.297668    0.299259    3400        51.200000   1.198123    1.114987    136.005061 
[37m[36mINFO[0m[0m 03/14 10:47:12 | 0.213781    0.176678    0.478200    0.479897    1.252627    0.213781    0.176678    0.476706    0.468927    0.576923    0.592988    0.380970    0.377778    3600        54.211765   1.215273    1.130129    137.777087 
[37m[36mINFO[0m[0m 03/14 10:53:07 | 0.310954    0.240283    0.419413    0.414664    1.522464    0.310954    0.240283    0.523765    0.500942    0.384235    0.397866    0.350241    0.345185    3800        57.223529   1.222244    1.111076    132.820850 
[37m[36mINFO[0m[0m 03/14 10:59:04 | 0.310954    0.296820    0.532617    0.525659    1.097406    0.310954    0.296820    0.506824    0.487759    0.624905    0.643293    0.466124    0.445926    4000        60.235294   1.230109    1.110860    135.391229 
[37m[36mINFO[0m[0m 03/14 11:05:02 | 0.519435    0.512367    0.491664    0.506468    1.220609    0.519435    0.512367    0.499294    0.517891    0.524752    0.527439    0.450944    0.474074    4200        63.247059   1.221167    1.116987    133.895673 
[37m[36mINFO[0m[0m 03/14 11:10:54 | 0.631625    0.650177    0.504034    0.512662    1.130373    0.631625    0.650177    0.557647    0.561205    0.479817    0.490854    0.474639    0.485926    4400        66.258824   1.190668    1.085349    135.611240 
[37m[36mINFO[0m[0m 03/14 11:16:44 | 0.358657    0.360424    0.500821    0.509521    1.156755    0.358657    0.360424    0.491765    0.514124    0.558644    0.565549    0.452055    0.448889    4600        69.270588   1.192432    1.081764    132.864206 
[37m[36mINFO[0m[0m 03/14 11:22:33 | 0.378092    0.342756    0.524367    0.524577    1.056659    0.378092    0.342756    0.522353    0.529190    0.587586    0.582317    0.463162    0.462222    4800        72.282353   1.181725    1.084363    132.031427 
[37m[36mINFO[0m[0m 03/14 11:28:25 | 0.269435    0.257951    0.468887    0.485124    1.416897    0.269435    0.257951    0.464941    0.480226    0.527799    0.538110    0.413921    0.437037    5000        75.294118   1.194321    1.092561    133.605086 
[37m[36mINFO[0m[0m 03/14 11:28:25 | Cumulative gradient change saved at train_output/VLCS/ERM/[0]/250314_08-57-43_resnet50_signum/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/14 11:28:26 | ---
[37m[36mINFO[0m[0m 03/14 11:28:26 | test-domain validation(oracle) = 96.555%
[37m[36mINFO[0m[0m 03/14 11:28:26 | training-domain validation(iid) = 87.456%
[37m[36mINFO[0m[0m 03/14 11:28:26 | last = 26.943%
[37m[36mINFO[0m[0m 03/14 11:28:26 | last (inD) = 48.512%
[37m[36mINFO[0m[0m 03/14 11:28:26 | training-domain validation (iid, inD) = 77.337%
[37m[36mINFO[0m[0m 03/14 11:28:26 | === Summary ===
[37m[36mINFO[0m[0m 03/14 11:28:26 | Command: /jsm0707/GENIE/train_all.py resnet50_signum config/resnet50_signum.yaml --algorithm ERM --test_envs 0 --dataset VLCS
[37m[36mINFO[0m[0m 03/14 11:28:26 | Unique name: 250314_08-57-43_resnet50_signum
[37m[36mINFO[0m[0m 03/14 11:28:26 | Out path: train_output/VLCS/ERM/[0]/250314_08-57-43_resnet50_signum
[37m[36mINFO[0m[0m 03/14 11:28:26 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/14 11:28:26 | Dataset: VLCS

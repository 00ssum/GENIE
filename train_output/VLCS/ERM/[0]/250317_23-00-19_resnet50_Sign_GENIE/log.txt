[37m[36mINFO[0m[0m 03/17 23:00:19 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset VLCS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[0]/250317_23-00-19_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250317_23-00-19_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/17 23:00:19 | n_steps = 5001
[37m[36mINFO[0m[0m 03/17 23:00:19 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/17 23:00:19 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/17 23:00:19 | 
[37m[36mINFO[0m[0m 03/17 23:00:19 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/17 23:00:19 | Test envs = [0], name = te_C
[37m[36mINFO[0m[0m 03/17 23:00:19 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/17 23:00:19 | Batch sizes for each domain: [0, 32, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/17 23:00:19 | steps-per-epoch for each domain: 66.41, 82.06, 84.41 -> min = 66.41
[37m[36mINFO[0m[0m 03/17 23:00:20 | # of params = 23518277
[37m[36mINFO[0m[0m 03/17 23:02:38 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/17 23:02:38 | 0.611307    0.628975    0.429430    0.440921    1.318087    0.611307    0.628975    0.459765    0.489642    0.384615    0.387195    0.443910    0.445926    0           0.000000    1.786248    1.656070    136.135948 
[37m[36mINFO[0m[0m 03/17 23:08:45 | 0.977915    0.975265    0.819313    0.810636    0.518882    0.977915    0.975265    0.764235    0.772128    0.835872    0.807927    0.857830    0.851852    200         3.011765    0.613853    1.150510    137.241636 
[37m[36mINFO[0m[0m 03/17 23:14:56 | 0.983216    0.982332    0.845545    0.813070    0.504971    0.983216    0.982332    0.779294    0.777778    0.861005    0.814024    0.896335    0.847407    400         6.023529    0.439079    1.155690    139.226162 
[37m[36mINFO[0m[0m 03/17 23:21:07 | 0.986749    0.985866    0.860867    0.807420    0.534869    0.986749    0.985866    0.796235    0.760829    0.879665    0.814024    0.906701    0.847407    600         9.035294    0.381255    1.159674    139.828222 
[37m[36mINFO[0m[0m 03/17 23:27:09 | 0.984099    0.982332    0.884187    0.810247    0.579814    0.984099    0.982332    0.841412    0.774011    0.892232    0.804878    0.918919    0.851852    800         12.047059   0.338219    1.142505    133.116237 
[37m[36mINFO[0m[0m 03/17 23:33:14 | 0.973498    0.957597    0.878787    0.781580    0.661312    0.973498    0.957597    0.831059    0.738230    0.868241    0.757622    0.937060    0.848889    1000        15.058824   0.292241    1.137844    136.814106 
[37m[36mINFO[0m[0m 03/17 23:39:18 | 0.966431    0.971731    0.922131    0.808350    0.610904    0.966431    0.971731    0.876235    0.768362    0.937548    0.803354    0.952610    0.853333    1200        18.070588   0.250321    1.136771    137.400136 
[37m[36mINFO[0m[0m 03/17 23:45:26 | 0.977915    0.985866    0.925773    0.794100    0.682275    0.977915    0.985866    0.877176    0.741996    0.937167    0.800305    0.962977    0.840000    1400        21.082353   0.216964    1.172241    133.622193 
[37m[36mINFO[0m[0m 03/17 23:51:34 | 0.981449    0.975265    0.941567    0.792597    0.824079    0.981449    0.975265    0.890824    0.736347    0.952018    0.788110    0.981859    0.853333    1600        24.094118   0.166343    1.160831    135.555792 
[37m[36mINFO[0m[0m 03/17 23:57:42 | 0.970848    0.971731    0.950839    0.783551    0.726440    0.970848    0.971731    0.925176    0.728814    0.956588    0.775915    0.970752    0.845926    1800        27.105882   0.154505    1.149766    137.957779 
[37m[36mINFO[0m[0m 03/18 00:03:51 | 0.946996    0.946996    0.958887    0.789742    0.806638    0.946996    0.946996    0.926588    0.715631    0.975248    0.798780    0.974824    0.854815    2000        30.117647   0.125588    1.153452    138.104295 
[37m[36mINFO[0m[0m 03/18 00:10:01 | 0.963781    0.954064    0.958044    0.797696    0.894501    0.963781    0.954064    0.925647    0.745763    0.971439    0.786585    0.977046    0.860741    2200        33.129412   0.114298    1.161656    137.802129 
[37m[36mINFO[0m[0m 03/18 00:16:10 | 0.956714    0.964664    0.977796    0.796136    1.022356    0.956714    0.964664    0.966118    0.758945    0.981340    0.783537    0.985931    0.845926    2400        36.141176   0.098076    1.161557    136.652923 
[37m[36mINFO[0m[0m 03/18 00:22:22 | 0.971731    0.982332    0.974926    0.795072    0.872382    0.971731    0.982332    0.964235    0.757062    0.979056    0.789634    0.981488    0.838519    2600        39.152941   0.087464    1.165901    139.032183 
[37m[36mINFO[0m[0m 03/18 00:28:31 | 0.978799    0.968198    0.980778    0.811271    0.990635    0.978799    0.968198    0.965647    0.760829    0.987053    0.803354    0.989633    0.869630    2800        42.164706   0.077323    1.150972    138.383545 
[37m[36mINFO[0m[0m 03/18 00:34:35 | 0.988516    0.982332    0.975888    0.784945    1.032093    0.988516    0.982332    0.971765    0.743879    0.971820    0.757622    0.984080    0.853333    3000        45.176471   0.065724    1.146741    135.307424 
[37m[36mINFO[0m[0m 03/18 00:40:46 | 0.969081    0.968198    0.981314    0.779467    1.048347    0.969081    0.968198    0.964706    0.726930    0.985529    0.775915    0.993706    0.835556    3200        48.188235   0.078595    1.153737    140.330415 
[37m[36mINFO[0m[0m 03/18 00:46:55 | 0.971731    0.975265    0.983034    0.782559    1.123033    0.971731    0.975265    0.973176    0.726930    0.986291    0.789634    0.989633    0.831111    3400        51.200000   0.045675    1.169908    134.571092 
[37m[36mINFO[0m[0m 03/18 00:53:08 | 0.968198    0.971731    0.986176    0.802589    1.246704    0.968198    0.971731    0.984941    0.787194    0.982102    0.783537    0.991485    0.837037    3600        54.211765   0.044933    1.179400    136.911837 
[37m[36mINFO[0m[0m 03/18 00:59:16 | 0.962014    0.968198    0.990736    0.786650    1.053965    0.962014    0.968198    0.989176    0.741996    0.988957    0.795732    0.994076    0.822222    3800        57.223529   0.052309    1.161361    136.184574 
[37m[36mINFO[0m[0m 03/18 01:05:24 | 0.970848    0.968198    0.984945    0.788094    1.060474    0.970848    0.968198    0.984941    0.743879    0.982483    0.777439    0.987412    0.842963    4000        60.235294   0.042194    1.143624    138.582834 
[37m[36mINFO[0m[0m 03/18 01:11:30 | 0.969081    0.971731    0.996104    0.801455    1.148756    0.969081    0.971731    0.998118    0.770245    0.993526    0.791159    0.996668    0.842963    4200        63.247059   0.034188    1.150470    136.750576 
[37m[36mINFO[0m[0m 03/18 01:17:34 | 0.968198    0.971731    0.978460    0.782563    1.210103    0.968198    0.971731    0.963294    0.736347    0.981340    0.771341    0.990744    0.840000    4400        66.258824   0.039094    1.146999    134.473405 
[37m[36mINFO[0m[0m 03/18 01:23:40 | 0.980565    0.968198    0.995967    0.801996    1.288059    0.980565    0.968198    0.996235    0.779661    0.993145    0.777439    0.998519    0.848889    4600        69.270588   0.036433    1.143280    136.969123 
[37m[36mINFO[0m[0m 03/18 01:29:46 | 0.977915    0.982332    0.993918    0.803028    1.330560    0.977915    0.982332    0.993412    0.772128    0.993526    0.786585    0.994817    0.850370    4800        72.282353   0.041068    1.159926    134.371194 
[37m[36mINFO[0m[0m 03/18 01:35:56 | 0.961131    0.964664    0.993781    0.800608    1.175914    0.961131    0.964664    0.993412    0.766478    0.992003    0.782012    0.995927    0.853333    5000        75.294118   0.029865    1.156284    138.076030 
[37m[36mINFO[0m[0m 03/18 01:35:56 | Cumulative gradient change saved at train_output/VLCS/ERM/[0]/250317_23-00-19_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 01:35:58 | ---
[37m[36mINFO[0m[0m 03/18 01:35:58 | test-domain validation(oracle) = 98.675%
[37m[36mINFO[0m[0m 03/18 01:35:58 | training-domain validation(iid) = 98.322%
[37m[36mINFO[0m[0m 03/18 01:35:58 | last = 96.113%
[37m[36mINFO[0m[0m 03/18 01:35:58 | last (inD) = 80.061%
[37m[36mINFO[0m[0m 03/18 01:35:58 | training-domain validation (iid, inD) = 81.307%
[37m[36mINFO[0m[0m 03/18 01:35:58 | === Summary ===
[37m[36mINFO[0m[0m 03/18 01:35:58 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset VLCS
[37m[36mINFO[0m[0m 03/18 01:35:58 | Unique name: 250317_23-00-19_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 01:35:58 | Out path: train_output/VLCS/ERM/[0]/250317_23-00-19_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 01:35:58 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 01:35:58 | Dataset: VLCS

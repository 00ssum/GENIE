[37m[36mINFO[0m[0m 03/25 22:46:08 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset VLCS --trial_seed 2 --hparams_seed 16
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 16
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[0]/250325_22-46-08_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 2
	unique_name: 250325_22-46-08_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 1.15290264354828e-05
	batch_size: 18
	weight_decay: 0.008257233595621347
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/25 22:46:08 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 22:46:08 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 22:46:08 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 22:46:08 | 
[37m[36mINFO[0m[0m 03/25 22:46:08 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/25 22:46:08 | Test envs = [0], name = te_C
[37m[36mINFO[0m[0m 03/25 22:46:08 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/25 22:46:08 | Batch sizes for each domain: [0, 18, 18, 18] (total=54)
[37m[36mINFO[0m[0m 03/25 22:46:08 | steps-per-epoch for each domain: 118.06, 145.89, 150.06 -> min = 118.06
[37m[36mINFO[0m[0m 03/25 22:46:09 | # of params = 23518277
[37m[36mINFO[0m[0m 03/25 22:48:33 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 22:48:33 | 0.620141    0.593640    0.433117    0.425653    1.290958    0.620141    0.593640    0.467294    0.459510    0.391851    0.356707    0.440207    0.460741    0           0.000000    1.852168    1.371363    142.077206 
[37m[36mINFO[0m[0m 03/25 22:52:58 | 0.983216    0.978799    0.773357    0.744490    0.608049    0.983216    0.978799    0.736941    0.702448    0.747144    0.707317    0.835987    0.823704    200         1.694118    0.658617    0.645139    135.763902 
[37m[36mINFO[0m[0m 03/25 22:57:26 | 0.982332    0.968198    0.811703    0.802097    0.515354    0.982332    0.968198    0.750588    0.772128    0.825209    0.792683    0.859311    0.841481    400         3.388235    0.504382    0.663113    135.417858 
[37m[36mINFO[0m[0m 03/25 23:01:56 | 0.980565    0.971731    0.832939    0.803642    0.536348    0.980565    0.971731    0.781176    0.766478    0.844631    0.789634    0.873010    0.854815    600         5.082353    0.455490    0.648799    140.645016 
[37m[36mINFO[0m[0m 03/25 23:06:30 | 0.977032    0.978799    0.844016    0.798239    0.524055    0.977032    0.978799    0.796235    0.740113    0.845773    0.782012    0.890041    0.872593    800         6.776471    0.421922    0.664307    140.809412 
[37m[36mINFO[0m[0m 03/25 23:11:00 | 0.984982    0.978799    0.836769    0.793382    0.525254    0.984982    0.978799    0.760000    0.738230    0.861005    0.804878    0.889300    0.837037    1000        8.470588    0.418358    0.671908    135.445820 
[37m[36mINFO[0m[0m 03/25 23:15:35 | 0.980565    0.975265    0.853110    0.797411    0.526299    0.980565    0.975265    0.791529    0.764595    0.864433    0.771341    0.903369    0.856296    1200        10.164706   0.419856    0.669530    141.077538 
[37m[36mINFO[0m[0m 03/25 23:20:05 | 0.971731    0.971731    0.852777    0.785801    0.542879    0.971731    0.971731    0.771765    0.726930    0.873572    0.766768    0.912995    0.863704    1400        11.858824   0.373379    0.657355    139.124739 
[37m[36mINFO[0m[0m 03/25 23:24:29 | 0.976148    0.968198    0.872149    0.802086    0.516868    0.976148    0.968198    0.795765    0.749529    0.888804    0.804878    0.931877    0.851852    1600        13.552941   0.386384    0.640020    135.809642 
[37m[36mINFO[0m[0m 03/25 23:29:02 | 0.958481    0.950530    0.859296    0.800191    0.586505    0.958481    0.950530    0.831529    0.768362    0.852247    0.775915    0.894113    0.856296    1800        15.247059   0.356852    0.664203    140.405422 
[37m[36mINFO[0m[0m 03/25 23:33:32 | 0.954947    0.964664    0.861813    0.800704    0.565912    0.954947    0.964664    0.790588    0.757062    0.891851    0.810976    0.902999    0.834074    2000        16.941176   0.362223    0.639546    141.818466 
[37m[36mINFO[0m[0m 03/25 23:38:04 | 0.925795    0.918728    0.827448    0.752342    0.722620    0.925795    0.918728    0.760471    0.726930    0.837014    0.727134    0.884857    0.802963    2200        18.635294   0.358487    0.667926    138.924537 
[37m[36mINFO[0m[0m 03/25 23:42:35 | 0.975265    0.971731    0.884559    0.785519    0.554049    0.975265    0.971731    0.832000    0.741996    0.897944    0.780488    0.923732    0.834074    2400        20.329412   0.353783    0.647360    140.720760 
[37m[36mINFO[0m[0m 03/25 23:47:07 | 0.957597    0.968198    0.845561    0.777235    0.682018    0.957597    0.968198    0.815529    0.745763    0.837776    0.763720    0.883377    0.822222    2600        22.023529   0.346988    0.654779    140.893009 
[37m[36mINFO[0m[0m 03/25 23:51:40 | 0.925795    0.901060    0.842515    0.785795    0.674402    0.925795    0.901060    0.810824    0.764595    0.824829    0.743902    0.891892    0.848889    2800        23.717647   0.352443    0.669297    139.397246 
[37m[36mINFO[0m[0m 03/25 23:56:14 | 0.977915    0.982332    0.863119    0.777861    0.656957    0.977915    0.982332    0.786353    0.723164    0.892232    0.791159    0.910774    0.819259    3000        25.411765   0.335463    0.668943    140.872180 
[37m[36mINFO[0m[0m 03/26 00:00:46 | 0.922261    0.893993    0.835340    0.752639    0.706371    0.922261    0.893993    0.798588    0.704331    0.823686    0.719512    0.883747    0.834074    3200        27.105882   0.363047    0.663772    138.870719 
[37m[36mINFO[0m[0m 03/26 00:05:15 | 0.965548    0.957597    0.900590    0.791979    0.561786    0.965548    0.957597    0.862588    0.764595    0.915080    0.771341    0.924102    0.840000    3400        28.800000   0.365443    0.655712    137.653429 
[37m[36mINFO[0m[0m 03/26 00:09:47 | 0.958481    0.950530    0.871079    0.774298    0.639397    0.958481    0.950530    0.846588    0.760829    0.876238    0.757622    0.890411    0.804444    3600        30.494118   0.367462    0.667777    138.696606 
[37m[36mINFO[0m[0m 03/26 00:14:23 | 0.935512    0.929329    0.872258    0.790398    0.626126    0.935512    0.929329    0.817882    0.757062    0.890708    0.765244    0.908182    0.848889    3800        32.188235   0.368269    0.666938    142.547744 
[37m[36mINFO[0m[0m 03/26 00:18:55 | 0.942580    0.939929    0.865750    0.783691    0.642355    0.942580    0.939929    0.840471    0.777778    0.880807    0.788110    0.875972    0.785185    4000        33.882353   0.375388    0.656362    140.828088 
[37m[36mINFO[0m[0m 03/26 00:23:27 | 0.980565    0.985866    0.830727    0.750562    0.677246    0.980565    0.985866    0.772235    0.725047    0.861005    0.762195    0.858941    0.764444    4200        35.576471   0.390772    0.650898    141.802338 
[37m[36mINFO[0m[0m 03/26 00:27:59 | 0.958481    0.961131    0.873120    0.775835    0.627558    0.958481    0.961131    0.850353    0.736347    0.881188    0.791159    0.887819    0.800000    4400        37.270588   0.421387    0.666356    138.816351 
[37m[36mINFO[0m[0m 03/26 00:32:30 | 0.912544    0.908127    0.878304    0.767490    0.635273    0.912544    0.908127    0.865882    0.762712    0.881950    0.754573    0.887079    0.785185    4600        38.964706   0.368216    0.654795    139.715886 
[37m[36mINFO[0m[0m 03/26 00:37:01 | 0.951413    0.964664    0.858674    0.758800    0.647051    0.951413    0.964664    0.836706    0.751412    0.865194    0.756098    0.874121    0.768889    4800        40.658824   0.361460    0.651553    140.343559 
[37m[36mINFO[0m[0m 03/26 00:41:28 | 0.917845    0.904594    0.834312    0.745052    0.715244    0.917845    0.904594    0.807529    0.730697    0.857197    0.763720    0.838208    0.740741    5000        42.352941   0.389890    0.649251    137.884019 
[37m[36mINFO[0m[0m 03/26 00:41:28 | Cumulative gradient change saved at train_output/VLCS/ERM/[0]/250325_22-46-08_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 00:41:30 | ---
[37m[36mINFO[0m[0m 03/26 00:41:30 | test-domain validation(oracle) = 98.057%
[37m[36mINFO[0m[0m 03/26 00:41:30 | training-domain validation(iid) = 98.057%
[37m[36mINFO[0m[0m 03/26 00:41:30 | last = 91.784%
[37m[36mINFO[0m[0m 03/26 00:41:30 | last (inD) = 74.505%
[37m[36mINFO[0m[0m 03/26 00:41:30 | training-domain validation (iid, inD) = 80.364%
[37m[36mINFO[0m[0m 03/26 00:41:30 | === Summary ===
[37m[36mINFO[0m[0m 03/26 00:41:30 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset VLCS --trial_seed 2 --hparams_seed 16
[37m[36mINFO[0m[0m 03/26 00:41:30 | Unique name: 250325_22-46-08_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 00:41:30 | Out path: train_output/VLCS/ERM/[0]/250325_22-46-08_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 00:41:30 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 00:41:30 | Dataset: VLCS

[37m[36mINFO[0m[0m 03/04 02:18:27 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 0 --dataset VLCS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/VLCS/ERM/[0]/250304_02-18-27_clip_vitb16_GENIE
	out_root: train_output/VLCS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250304_02-18-27_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: clip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/04 02:18:27 | n_steps = 5001
[37m[36mINFO[0m[0m 03/04 02:18:27 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/04 02:18:27 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/04 02:18:27 | 
[37m[36mINFO[0m[0m 03/04 02:18:27 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/04 02:18:27 | Test envs = [0], name = te_C
[37m[36mINFO[0m[0m 03/04 02:18:27 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/04 02:18:27 | Batch sizes for each domain: [0, 32, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/04 02:18:27 | steps-per-epoch for each domain: 66.41, 82.06, 84.41 -> min = 66.41
[37m[36mINFO[0m[0m 03/04 02:18:29 | # of params = 86195205
[37m[36mINFO[0m[0m 03/04 02:20:40 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/04 02:20:40 | 0.336572    0.363958    0.425518    0.436388    1.451384    0.336572    0.363958    0.476706    0.491525    0.405179    0.416159    0.394669    0.401481    0           0.000000    1.659496    1.126793    130.239001 
[37m[36mINFO[0m[0m 03/04 02:26:34 | 0.793286    0.780919    0.661681    0.651976    0.862961    0.793286    0.780919    0.647059    0.666667    0.678599    0.644817    0.659385    0.644444    200         3.011765    1.177249    1.101989    133.198039 
[37m[36mINFO[0m[0m 03/04 02:32:20 | 0.891343    0.901060    0.748593    0.744904    0.636300    0.891343    0.901060    0.691294    0.702448    0.768850    0.751524    0.785635    0.780741    400         6.023529    0.752081    1.078854    130.681055 
[37m[36mINFO[0m[0m 03/04 02:38:13 | 0.880742    0.872792    0.775439    0.748436    0.646746    0.880742    0.872792    0.735529    0.745763    0.769612    0.746951    0.821177    0.752593    600         9.035294    0.585522    1.109483    131.032005 
[37m[36mINFO[0m[0m 03/04 02:44:03 | 0.901060    0.876325    0.824161    0.784035    0.596170    0.901060    0.876325    0.795294    0.783427    0.841203    0.782012    0.835987    0.786667    800         12.047059   0.484624    1.086495    132.448992 
[37m[36mINFO[0m[0m 03/04 02:49:57 | 0.909894    0.883392    0.852212    0.786375    0.596153    0.909894    0.883392    0.825412    0.790960    0.853770    0.763720    0.877453    0.804444    1000        15.058824   0.418816    1.103249    132.949252 
[37m[36mINFO[0m[0m 03/04 02:55:46 | 0.913428    0.869258    0.854345    0.755055    0.650393    0.913428    0.869258    0.820706    0.726930    0.853770    0.753049    0.888560    0.785185    1200        18.070588   0.376241    1.089612    131.717793 
[37m[36mINFO[0m[0m 03/04 03:01:35 | 0.939929    0.929329    0.880293    0.780628    0.668252    0.939929    0.929329    0.854588    0.777778    0.890327    0.777439    0.895964    0.786667    1400        21.082353   0.306880    1.085069    131.179118 
[37m[36mINFO[0m[0m 03/04 03:07:22 | 0.892226    0.858657    0.917239    0.785072    0.674385    0.892226    0.858657    0.889412    0.777778    0.934501    0.777439    0.927805    0.800000    1600        24.094118   0.258497    1.084840    130.733665 
[37m[36mINFO[0m[0m 03/04 03:13:12 | 0.917845    0.908127    0.922666    0.773519    0.723842    0.917845    0.908127    0.908706    0.740113    0.932597    0.778963    0.926694    0.801481    1800        27.105882   0.229173    1.094886    131.051666 
[37m[36mINFO[0m[0m 03/04 03:19:04 | 0.911661    0.901060    0.939269    0.760611    0.768836    0.911661    0.901060    0.932706    0.757062    0.942117    0.748476    0.942984    0.776296    2000        30.117647   0.191038    1.095357    132.725186 
[37m[36mINFO[0m[0m 03/04 03:25:03 | 0.863074    0.830389    0.928467    0.749130    0.835762    0.863074    0.830389    0.911059    0.719397    0.928027    0.757622    0.946316    0.770370    2200        33.129412   0.163797    1.126532    133.809732 
[37m[36mINFO[0m[0m 03/04 03:30:58 | 0.911661    0.879859    0.952349    0.773483    0.813501    0.911661    0.879859    0.944941    0.753296    0.954684    0.780488    0.957423    0.786667    2400        36.141176   0.134814    1.121315    130.732093 
[37m[36mINFO[0m[0m 03/04 03:36:55 | 0.927562    0.908127    0.962609    0.770406    0.820072    0.927562    0.908127    0.954353    0.753296    0.964204    0.768293    0.969271    0.789630    2600        39.152941   0.129877    1.115988    133.447458 
[37m[36mINFO[0m[0m 03/04 03:42:46 | 0.897527    0.883392    0.967152    0.753821    0.864122    0.897527    0.883392    0.964235    0.736347    0.965727    0.760671    0.971492    0.764444    2800        42.164706   0.120573    1.105861    129.499751 
[37m[36mINFO[0m[0m 03/04 03:48:38 | 0.888693    0.844523    0.971386    0.764287    0.915244    0.888693    0.844523    0.968941    0.766478    0.973724    0.753049    0.971492    0.773333    3000        45.176471   0.084660    1.095568    133.337437 
[37m[36mINFO[0m[0m 03/04 03:54:29 | 0.910777    0.890459    0.969862    0.756305    0.959445    0.910777    0.890459    0.980235    0.768362    0.962300    0.730183    0.967049    0.770370    3200        48.188235   0.090185    1.095157    131.594329 
[37m[36mINFO[0m[0m 03/04 04:00:21 | 0.879859    0.858657    0.975288    0.770943    0.898065    0.879859    0.858657    0.961882    0.753296    0.982864    0.772866    0.981118    0.786667    3400        51.200000   0.076064    1.106818    131.306925 
[37m[36mINFO[0m[0m 03/04 04:06:14 | 0.881625    0.872792    0.976619    0.759011    1.030374    0.881625    0.872792    0.981647    0.747646    0.974867    0.754573    0.973343    0.774815    3600        54.211765   0.057286    1.115345    129.770071 
[37m[36mINFO[0m[0m 03/04 04:12:12 | 0.916078    0.890459    0.984496    0.778503    0.959482    0.916078    0.890459    0.985412    0.783427    0.983625    0.771341    0.984450    0.780741    3800        57.223529   0.070498    1.114426    135.073042 
[37m[36mINFO[0m[0m 03/04 04:18:08 | 0.942580    0.929329    0.969279    0.747582    1.047485    0.942580    0.929329    0.969412    0.747646    0.969155    0.746951    0.969271    0.748148    4000        60.235294   0.060651    1.108804    133.639621 
[37m[36mINFO[0m[0m 03/04 04:23:59 | 0.937279    0.932862    0.985760    0.777171    1.030729    0.937279    0.932862    0.982118    0.777778    0.985529    0.777439    0.989633    0.776296    4200        63.247059   0.053481    1.099075    131.956581 
[37m[36mINFO[0m[0m 03/04 04:29:47 | 0.927562    0.915194    0.980119    0.756605    1.059275    0.927562    0.915194    0.976471    0.749529    0.979436    0.746951    0.984450    0.773333    4400        66.258824   0.048856    1.079701    131.887046 
[37m[36mINFO[0m[0m 03/04 04:35:36 | 0.882509    0.851590    0.982593    0.767916    1.154886    0.882509    0.851590    0.986824    0.758945    0.980579    0.775915    0.980378    0.768889    4600        69.270588   0.042428    1.090631    130.809969 
[37m[36mINFO[0m[0m 03/04 04:41:25 | 0.911661    0.915194    0.985674    0.754567    1.111027    0.911661    0.915194    0.980706    0.747646    0.987053    0.754573    0.989263    0.761481    4800        72.282353   0.043029    1.086470    132.064361 
[37m[36mINFO[0m[0m 03/04 04:47:20 | 0.915194    0.901060    0.980344    0.750270    1.144076    0.915194    0.901060    0.970353    0.730697    0.984006    0.740854    0.986672    0.779259    5000        75.294118   0.035472    1.113495    131.575317 
[37m[36mINFO[0m[0m 03/04 04:47:20 | Cumulative gradient change saved at train_output/VLCS/ERM/[0]/250304_02-18-27_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/04 04:47:22 | ---
[37m[36mINFO[0m[0m 03/04 04:47:22 | test-domain validation(oracle) = 93.728%
[37m[36mINFO[0m[0m 03/04 04:47:22 | training-domain validation(iid) = 90.989%
[37m[36mINFO[0m[0m 03/04 04:47:22 | last = 91.519%
[37m[36mINFO[0m[0m 03/04 04:47:22 | last (inD) = 75.027%
[37m[36mINFO[0m[0m 03/04 04:47:22 | training-domain validation (iid, inD) = 78.637%
[37m[36mINFO[0m[0m 03/04 04:47:22 | === Summary ===
[37m[36mINFO[0m[0m 03/04 04:47:22 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 0 --dataset VLCS
[37m[36mINFO[0m[0m 03/04 04:47:22 | Unique name: 250304_02-18-27_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/04 04:47:22 | Out path: train_output/VLCS/ERM/[0]/250304_02-18-27_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/04 04:47:22 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/04 04:47:22 | Dataset: VLCS

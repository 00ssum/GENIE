[37m[36mINFO[0m[0m 03/24 17:36:49 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset VLCS --trial_seed 2 --hparams_seed 12
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 12
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[0]/250324_17-36-49_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 2
	unique_name: 250324_17-36-49_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5.346798771850428e-05
	batch_size: 44
	weight_decay: 1.8352299015720086e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/24 17:36:49 | n_steps = 5001
[37m[36mINFO[0m[0m 03/24 17:36:49 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/24 17:36:49 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/24 17:36:49 | 
[37m[36mINFO[0m[0m 03/24 17:36:49 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/24 17:36:49 | Test envs = [0], name = te_C
[37m[36mINFO[0m[0m 03/24 17:36:49 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/24 17:36:49 | Batch sizes for each domain: [0, 44, 44, 44] (total=132)
[37m[36mINFO[0m[0m 03/24 17:36:49 | steps-per-epoch for each domain: 48.30, 59.68, 61.39 -> min = 48.30
[37m[36mINFO[0m[0m 03/24 17:36:50 | # of params = 23518277
[37m[36mINFO[0m[0m 03/24 17:39:11 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/24 17:39:11 | 0.620141    0.593640    0.432737    0.424651    1.249781    0.620141    0.593640    0.467294    0.459510    0.390708    0.355183    0.440207    0.459259    0           0.000000    1.774141    1.533631    139.458068 
[37m[36mINFO[0m[0m 03/24 17:46:36 | 0.984982    0.975265    0.829815    0.798666    0.518501    0.984982    0.975265    0.777412    0.768362    0.842727    0.771341    0.869308    0.856296    200         4.141176    0.573960    1.550044    134.968432 
[37m[36mINFO[0m[0m 03/24 17:54:03 | 0.984982    0.978799    0.855968    0.809534    0.483808    0.984982    0.978799    0.791059    0.772128    0.870145    0.795732    0.906701    0.860741    400         8.282353    0.431545    1.554151    135.802966 
[37m[36mINFO[0m[0m 03/24 18:01:35 | 0.988516    0.985866    0.875578    0.801998    0.509113    0.988516    0.985866    0.807059    0.764595    0.892612    0.786585    0.927064    0.854815    600         12.423529   0.352146    1.577321    137.316468 
[37m[36mINFO[0m[0m 03/24 18:09:08 | 0.975265    0.971731    0.883372    0.795986    0.586370    0.975265    0.971731    0.799529    0.732580    0.912414    0.809451    0.938171    0.845926    800         16.564706   0.291650    1.574836    137.332061 
[37m[36mINFO[0m[0m 03/24 18:16:41 | 0.972615    0.971731    0.929950    0.807949    0.601187    0.972615    0.971731    0.894118    0.755179    0.938309    0.807927    0.957423    0.860741    1000        20.705882   0.243685    1.573543    138.162761 
[37m[36mINFO[0m[0m 03/24 18:24:14 | 0.977915    0.964664    0.934945    0.804447    0.683001    0.977915    0.964664    0.909176    0.770245    0.935644    0.794207    0.960015    0.848889    1200        24.847059   0.191512    1.572108    138.546235 
[37m[36mINFO[0m[0m 03/24 18:31:39 | 0.982332    0.978799    0.953580    0.804614    0.750626    0.982332    0.978799    0.929412    0.741996    0.953542    0.815549    0.977786    0.856296    1400        28.988235   0.146443    1.548212    136.186626 
[37m[36mINFO[0m[0m 03/24 18:39:04 | 0.960247    0.954064    0.969131    0.800082    0.810134    0.960247    0.954064    0.945412    0.749529    0.977532    0.801829    0.984450    0.848889    1600        33.129412   0.125288    1.539984    136.186185 
[37m[36mINFO[0m[0m 03/24 18:46:34 | 0.975265    0.954064    0.967214    0.788564    0.966666    0.975265    0.954064    0.940706    0.732580    0.979817    0.807927    0.981118    0.825185    1800        37.270588   0.084389    1.560237    138.465475 
[37m[36mINFO[0m[0m 03/24 18:54:01 | 0.978799    0.978799    0.966549    0.794224    1.001167    0.978799    0.978799    0.959529    0.753296    0.963442    0.780488    0.976675    0.848889    2000        41.411765   0.091807    1.541984    138.043045 
[37m[36mINFO[0m[0m 03/24 19:01:29 | 0.945230    0.943463    0.978031    0.784957    1.082126    0.945230    0.943463    0.984000    0.745763    0.976009    0.797256    0.974084    0.811852    2200        45.552941   0.069367    1.556590    136.858555 
[37m[36mINFO[0m[0m 03/24 19:08:57 | 0.975265    0.971731    0.980302    0.788049    0.929241    0.975265    0.971731    0.966588    0.719397    0.981721    0.800305    0.992595    0.844444    2400        49.694118   0.062753    1.558637    136.865388 
[37m[36mINFO[0m[0m 03/24 19:16:29 | 0.977032    0.961131    0.989985    0.798334    0.923816    0.977032    0.961131    0.989176    0.738230    0.987814    0.806402    0.992966    0.850370    2600        53.835294   0.048065    1.554720    141.014570 
[37m[36mINFO[0m[0m 03/24 19:24:06 | 0.960247    0.964664    0.981205    0.804520    1.050104    0.960247    0.964664    0.960941    0.762712    0.989337    0.806402    0.993336    0.844444    2800        57.976471   0.044989    1.586232    139.311915 
[37m[36mINFO[0m[0m 03/24 19:31:37 | 0.954947    0.950530    0.989799    0.811834    1.150472    0.954947    0.950530    0.986353    0.775895    0.989337    0.801829    0.993706    0.857778    3000        62.117647   0.037758    1.572030    136.351555 
[37m[36mINFO[0m[0m 03/24 19:39:13 | 0.978799    0.961131    0.984972    0.775634    1.153475    0.978799    0.961131    0.977882    0.704331    0.986291    0.801829    0.990744    0.820741    3200        66.258824   0.029381    1.570397    141.938687 
[37m[36mINFO[0m[0m 03/24 19:46:49 | 0.963781    0.950530    0.993418    0.805238    1.326722    0.963781    0.950530    0.991529    0.766478    0.993907    0.801829    0.994817    0.847407    3400        70.400000   0.029283    1.582012    140.383730 
[37m[36mINFO[0m[0m 03/24 19:54:23 | 0.978799    0.968198    0.993307    0.793543    1.284669    0.978799    0.968198    0.992000    0.747646    0.991622    0.803354    0.996298    0.829630    3600        74.541176   0.026922    1.585446    136.307002 
[37m[36mINFO[0m[0m 03/24 20:02:28 | 0.980565    0.975265    0.983269    0.797196    1.433089    0.980565    0.975265    0.978824    0.751412    0.981721    0.795732    0.989263    0.844444    3800        78.682353   0.028106    1.666500    151.917946 
[37m[36mINFO[0m[0m 03/24 20:10:44 | 0.968198    0.961131    0.994713    0.798116    1.187889    0.968198    0.961131    0.993882    0.747646    0.995811    0.817073    0.994447    0.829630    4000        82.823529   0.026717    1.726980    150.718945 
[37m[36mINFO[0m[0m 03/24 20:18:47 | 0.979682    0.971731    0.993358    0.792830    1.302099    0.979682    0.971731    0.992471    0.745763    0.993526    0.794207    0.994076    0.838519    4200        86.964706   0.027279    1.703238    142.081068 
[37m[36mINFO[0m[0m 03/24 20:26:25 | 0.981449    0.968198    0.992863    0.800605    1.243563    0.981449    0.968198    0.989176    0.749529    0.992003    0.804878    0.997408    0.847407    4400        91.105882   0.026439    1.581330    141.814879 
[37m[36mINFO[0m[0m 03/24 20:34:04 | 0.978799    0.982332    0.987701    0.809888    1.508403    0.978799    0.982332    0.980706    0.768362    0.992765    0.809451    0.989633    0.851852    4600        95.247059   0.018901    1.573283    144.094490 
[37m[36mINFO[0m[0m 03/24 20:41:45 | 0.981449    0.982332    0.995928    0.799526    1.345125    0.981449    0.982332    0.995294    0.747646    0.996192    0.809451    0.996298    0.841481    4800        99.388235   0.017971    1.598987    141.749532 
[37m[36mINFO[0m[0m 03/24 20:49:16 | 0.984982    0.971731    0.998281    0.811189    1.382402    0.984982    0.971731    0.996706    0.757062    0.999619    0.823171    0.998519    0.853333    5000        103.529412  0.015550    1.563278    137.870033 
[37m[36mINFO[0m[0m 03/24 20:49:16 | Cumulative gradient change saved at train_output/VLCS/ERM/[0]/250324_17-36-49_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/24 20:49:17 | ---
[37m[36mINFO[0m[0m 03/24 20:49:17 | test-domain validation(oracle) = 98.852%
[37m[36mINFO[0m[0m 03/24 20:49:17 | training-domain validation(iid) = 95.495%
[37m[36mINFO[0m[0m 03/24 20:49:17 | last = 98.498%
[37m[36mINFO[0m[0m 03/24 20:49:17 | last (inD) = 81.119%
[37m[36mINFO[0m[0m 03/24 20:49:17 | training-domain validation (iid, inD) = 81.183%
[37m[36mINFO[0m[0m 03/24 20:49:17 | === Summary ===
[37m[36mINFO[0m[0m 03/24 20:49:17 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset VLCS --trial_seed 2 --hparams_seed 12
[37m[36mINFO[0m[0m 03/24 20:49:17 | Unique name: 250324_17-36-49_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 20:49:17 | Out path: train_output/VLCS/ERM/[0]/250324_17-36-49_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 20:49:17 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/24 20:49:17 | Dataset: VLCS

[37m[36mINFO[0m[0m 03/26 03:13:08 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset VLCS --trial_seed 2 --hparams_seed 18
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 18
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[0]/250326_03-13-08_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 2
	unique_name: 250326_03-13-08_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00011902331527815511
	batch_size: 15
	weight_decay: 1.4821095235078581e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/26 03:13:08 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 03:13:08 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 03:13:08 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 03:13:08 | 
[37m[36mINFO[0m[0m 03/26 03:13:08 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/26 03:13:08 | Test envs = [0], name = te_C
[37m[36mINFO[0m[0m 03/26 03:13:08 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/26 03:13:08 | Batch sizes for each domain: [0, 15, 15, 15] (total=45)
[37m[36mINFO[0m[0m 03/26 03:13:08 | steps-per-epoch for each domain: 141.67, 175.07, 180.07 -> min = 141.67
[37m[36mINFO[0m[0m 03/26 03:13:10 | # of params = 23518277
[37m[36mINFO[0m[0m 03/26 03:15:31 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 03:15:31 | 0.620141    0.593640    0.433117    0.425145    1.281798    0.620141    0.593640    0.467294    0.459510    0.391851    0.355183    0.440207    0.460741    0           0.000000    1.955036    2.222912    138.514579 
[37m[36mINFO[0m[0m 03/26 03:19:37 | 0.967314    0.957597    0.805666    0.782355    0.558429    0.967314    0.957597    0.758118    0.749529    0.808454    0.754573    0.850426    0.842963    200         1.411765    0.703994    0.544415    137.198017 
[37m[36mINFO[0m[0m 03/26 03:23:45 | 0.988516    0.971731    0.824374    0.805421    0.521357    0.988516    0.971731    0.764706    0.762712    0.832445    0.797256    0.875972    0.856296    400         2.823529    0.552213    0.550558    138.355793 
[37m[36mINFO[0m[0m 03/26 03:27:58 | 0.973498    0.964664    0.833994    0.797165    0.529468    0.973498    0.964664    0.789176    0.766478    0.843869    0.783537    0.868937    0.841481    600         4.235294    0.477062    0.563804    139.637237 
[37m[36mINFO[0m[0m 03/26 03:32:07 | 0.977915    0.975265    0.831445    0.797478    0.531635    0.977915    0.975265    0.748706    0.755179    0.865956    0.797256    0.879674    0.840000    800         5.647059    0.439425    0.552961    138.420749 
[37m[36mINFO[0m[0m 03/26 03:36:17 | 0.979682    0.968198    0.856061    0.800599    0.518887    0.979682    0.968198    0.799059    0.768362    0.872049    0.766768    0.897075    0.866667    1000        7.058824    0.434539    0.558217    138.567774 
[37m[36mINFO[0m[0m 03/26 03:40:28 | 0.981449    0.982332    0.870981    0.812645    0.503653    0.981449    0.982332    0.805176    0.774011    0.890327    0.797256    0.917438    0.866667    1200        8.470588    0.431053    0.549056    141.587257 
[37m[36mINFO[0m[0m 03/26 03:44:38 | 0.986749    0.982332    0.871625    0.805795    0.550454    0.986749    0.982332    0.816471    0.768362    0.886519    0.794207    0.911884    0.854815    1400        9.882353    0.372880    0.554355    138.631732 
[37m[36mINFO[0m[0m 03/26 03:48:49 | 0.974382    0.964664    0.866278    0.783630    0.569339    0.974382    0.964664    0.827765    0.741996    0.875476    0.789634    0.895594    0.819259    1600        11.294118   0.360388    0.560179    139.421214 
[37m[36mINFO[0m[0m 03/26 03:52:55 | 0.980565    0.964664    0.892029    0.795455    0.561772    0.980565    0.964664    0.825882    0.726930    0.912034    0.795732    0.938171    0.863704    1800        12.705882   0.321952    0.546766    136.695157 
[37m[36mINFO[0m[0m 03/26 03:57:03 | 0.974382    0.975265    0.874958    0.789244    0.612521    0.974382    0.975265    0.842824    0.745763    0.884235    0.780488    0.897816    0.841481    2000        14.117647   0.321642    0.560169    135.227661 
[37m[36mINFO[0m[0m 03/26 04:01:14 | 0.984982    0.985866    0.912930    0.796077    0.574325    0.984982    0.985866    0.871059    0.734463    0.916603    0.804878    0.951129    0.848889    2200        15.529412   0.304532    0.572117    137.095099 
[37m[36mINFO[0m[0m 03/26 04:05:23 | 0.988516    0.978799    0.910422    0.789947    0.635302    0.988516    0.978799    0.871529    0.757062    0.921935    0.769817    0.937801    0.842963    2400        16.941176   0.263363    0.554953    137.409748 
[37m[36mINFO[0m[0m 03/26 04:09:27 | 0.962898    0.961131    0.907120    0.801072    0.621453    0.962898    0.961131    0.869176    0.774011    0.903275    0.774390    0.948908    0.854815    2600        18.352941   0.256674    0.544877    135.239170 
[37m[36mINFO[0m[0m 03/26 04:13:35 | 0.985866    0.982332    0.899129    0.802354    0.738405    0.985866    0.982332    0.818824    0.753296    0.920030    0.804878    0.958534    0.848889    2800        19.764706   0.263833    0.563938    135.045726 
[37m[36mINFO[0m[0m 03/26 04:17:43 | 0.977032    0.975265    0.920041    0.790437    0.603664    0.977032    0.975265    0.881412    0.747646    0.925362    0.788110    0.953351    0.835556    3000        21.176471   0.240152    0.555961    137.184253 
[37m[36mINFO[0m[0m 03/26 04:21:46 | 0.973498    0.971731    0.946643    0.803411    0.613517    0.973498    0.971731    0.918588    0.768362    0.953922    0.803354    0.967419    0.838519    3200        22.588235   0.217358    0.539016    134.802816 
[37m[36mINFO[0m[0m 03/26 04:25:49 | 0.963781    0.957597    0.929926    0.807246    0.800846    0.963781    0.957597    0.892235    0.775895    0.936786    0.786585    0.960755    0.859259    3400        24.000000   0.202074    0.544144    134.786894 
[37m[36mINFO[0m[0m 03/26 04:29:58 | 0.979682    0.978799    0.944462    0.803908    0.749984    0.979682    0.978799    0.928471    0.785311    0.935644    0.780488    0.969271    0.845926    3600        25.411765   0.190888    0.541620    140.268508 
[37m[36mINFO[0m[0m 03/26 04:34:12 | 0.949647    0.943463    0.945710    0.801612    0.721956    0.949647    0.943463    0.922824    0.751412    0.953922    0.792683    0.960385    0.860741    3800        26.823529   0.155868    0.562343    141.706634 
[37m[36mINFO[0m[0m 03/26 04:38:15 | 0.986749    0.975265    0.965481    0.803967    0.765962    0.986749    0.975265    0.936471    0.738230    0.971820    0.827744    0.988153    0.845926    4000        28.235294   0.161778    0.542348    134.684397 
[37m[36mINFO[0m[0m 03/26 04:42:24 | 0.976148    0.971731    0.955355    0.790537    0.691037    0.976148    0.971731    0.944471    0.747646    0.963062    0.798780    0.958534    0.825185    4200        29.647059   0.147223    0.552728    138.353051 
[37m[36mINFO[0m[0m 03/26 04:46:38 | 0.949647    0.950530    0.963085    0.810352    1.077379    0.949647    0.950530    0.939765    0.775895    0.967631    0.801829    0.981859    0.853333    4400        31.058824   0.115054    0.561563    141.191831 
[37m[36mINFO[0m[0m 03/26 04:50:43 | 0.967314    0.978799    0.960888    0.812147    0.888208    0.967314    0.978799    0.944471    0.764595    0.960777    0.815549    0.977416    0.856296    4600        32.470588   0.139553    0.555379    134.501487 
[37m[36mINFO[0m[0m 03/26 04:54:56 | 0.955830    0.964664    0.959744    0.789177    0.899066    0.955830    0.964664    0.940235    0.734463    0.963062    0.806402    0.975935    0.826667    4800        33.882353   0.123926    0.549642    142.754112 
[37m[36mINFO[0m[0m 03/26 04:59:02 | 0.956714    0.950530    0.960077    0.787835    0.922101    0.956714    0.950530    0.939765    0.738230    0.962681    0.792683    0.977786    0.832593    5000        35.294118   0.115906    0.541751    138.039029 
[37m[36mINFO[0m[0m 03/26 04:59:02 | Cumulative gradient change saved at train_output/VLCS/ERM/[0]/250326_03-13-08_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 04:59:04 | ---
[37m[36mINFO[0m[0m 03/26 04:59:04 | test-domain validation(oracle) = 98.498%
[37m[36mINFO[0m[0m 03/26 04:59:04 | training-domain validation(iid) = 98.145%
[37m[36mINFO[0m[0m 03/26 04:59:04 | last = 95.671%
[37m[36mINFO[0m[0m 03/26 04:59:04 | last (inD) = 78.784%
[37m[36mINFO[0m[0m 03/26 04:59:04 | training-domain validation (iid, inD) = 81.264%
[37m[36mINFO[0m[0m 03/26 04:59:04 | === Summary ===
[37m[36mINFO[0m[0m 03/26 04:59:04 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset VLCS --trial_seed 2 --hparams_seed 18
[37m[36mINFO[0m[0m 03/26 04:59:04 | Unique name: 250326_03-13-08_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 04:59:04 | Out path: train_output/VLCS/ERM/[0]/250326_03-13-08_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 04:59:04 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 04:59:04 | Dataset: VLCS

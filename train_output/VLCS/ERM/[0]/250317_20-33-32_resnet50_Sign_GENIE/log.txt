[37m[36mINFO[0m[0m 03/17 20:33:32 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --trial_seed 1 --hparams_seed 0 --algorithm ERM --test_envs 0 --dataset VLCS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[0]/250317_20-33-32_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 1
	unique_name: 250317_20-33-32_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/17 20:33:32 | n_steps = 5001
[37m[36mINFO[0m[0m 03/17 20:33:32 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/17 20:33:32 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/17 20:33:32 | 
[37m[36mINFO[0m[0m 03/17 20:33:32 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/17 20:33:32 | Test envs = [0], name = te_C
[37m[36mINFO[0m[0m 03/17 20:33:32 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/17 20:33:32 | Batch sizes for each domain: [0, 32, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/17 20:33:32 | steps-per-epoch for each domain: 66.41, 82.06, 84.41 -> min = 66.41
[37m[36mINFO[0m[0m 03/17 20:33:34 | # of params = 23518277
[37m[36mINFO[0m[0m 03/17 20:36:01 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/17 20:36:01 | 0.613958    0.618375    0.432326    0.428842    1.444249    0.613958    0.618375    0.466824    0.461394    0.376618    0.419207    0.453536    0.405926    0           0.000000    1.781322    1.156851    145.656847 
[37m[36mINFO[0m[0m 03/17 20:42:18 | 0.984099    0.982332    0.815724    0.801170    0.541335    0.984099    0.982332    0.769412    0.749529    0.808454    0.812500    0.869308    0.841481    200         3.011765    0.623751    1.156601    146.386092 
[37m[36mINFO[0m[0m 03/17 20:48:36 | 0.973498    0.964664    0.817370    0.779664    0.543894    0.973498    0.964664    0.760471    0.723164    0.814928    0.772866    0.876712    0.842963    400         6.023529    0.454321    1.172222    142.755417 
[37m[36mINFO[0m[0m 03/17 20:54:53 | 0.989399    0.982332    0.859229    0.813474    0.537546    0.989399    0.982332    0.821647    0.768362    0.854151    0.823171    0.901888    0.848889    600         9.035294    0.384775    1.172465    143.451961 
[37m[36mINFO[0m[0m 03/17 21:00:56 | 0.992933    0.992933    0.879682    0.806479    0.530449    0.992933    0.992933    0.800000    0.738230    0.896801    0.832317    0.942244    0.848889    800         12.047059   0.337536    1.122424    137.670385 
[37m[36mINFO[0m[0m 03/17 21:07:04 | 0.987633    0.982332    0.890158    0.809336    0.604276    0.987633    0.982332    0.811765    0.736347    0.911653    0.835366    0.947057    0.856296    1000        15.058824   0.293761    1.149041    138.360860 
[37m[36mINFO[0m[0m 03/17 21:13:22 | 0.987633    0.982332    0.908582    0.806220    0.669293    0.987633    0.982332    0.884235    0.772128    0.892232    0.810976    0.949278    0.835556    1200        18.070588   0.251116    1.176903    142.846601 
[37m[36mINFO[0m[0m 03/17 21:19:33 | 0.985866    0.971731    0.921279    0.814672    0.611016    0.985866    0.971731    0.886118    0.772128    0.916222    0.817073    0.961496    0.854815    1400        21.082353   0.234373    1.161154    139.171657 
[37m[36mINFO[0m[0m 03/17 21:25:48 | 0.988516    0.971731    0.950192    0.809346    0.713503    0.988516    0.971731    0.925647    0.766478    0.949733    0.818598    0.975194    0.842963    1600        24.094118   0.176904    1.156066    142.920499 
[37m[36mINFO[0m[0m 03/17 21:32:04 | 0.979682    0.961131    0.937572    0.798973    0.816638    0.979682    0.961131    0.911059    0.762712    0.938309    0.794207    0.963347    0.840000    1800        27.105882   0.153757    1.180393    140.631581 
[37m[36mINFO[0m[0m 03/17 21:38:10 | 0.962898    0.943463    0.929466    0.782290    0.771777    0.962898    0.943463    0.908235    0.730697    0.924219    0.785061    0.955942    0.831111    2000        30.117647   0.136049    1.140695    137.816581 
[37m[36mINFO[0m[0m 03/17 21:44:14 | 0.977915    0.946996    0.912129    0.757232    1.039076    0.977915    0.946996    0.860235    0.693032    0.926504    0.768293    0.949648    0.810370    2200        33.129412   0.110680    1.138319    136.202033 
[37m[36mINFO[0m[0m 03/17 21:50:22 | 0.962898    0.968198    0.937503    0.772976    0.940505    0.962898    0.968198    0.896000    0.726930    0.939832    0.768293    0.976675    0.823704    2400        36.141176   0.107701    1.141364    139.803920 
[37m[36mINFO[0m[0m 03/17 21:56:21 | 0.985866    0.978799    0.981234    0.793988    0.961852    0.985866    0.978799    0.970824    0.753296    0.983244    0.807927    0.989633    0.820741    2600        39.152941   0.087558    1.121570    134.767325 
[37m[36mINFO[0m[0m 03/17 22:02:20 | 0.977915    0.968198    0.984045    0.787812    1.026888    0.977915    0.968198    0.980706    0.758945    0.984387    0.791159    0.987042    0.813333    2800        42.164706   0.069226    1.108725    136.543987 
[37m[36mINFO[0m[0m 03/17 22:08:17 | 0.977032    0.971731    0.970922    0.800710    1.150753    0.977032    0.971731    0.955765    0.751412    0.971439    0.801829    0.985561    0.848889    3000        45.176471   0.067999    1.102085    136.610667 
[37m[36mINFO[0m[0m 03/17 22:14:12 | 0.984099    0.964664    0.989554    0.791799    1.251211    0.984099    0.964664    0.983059    0.745763    0.988195    0.789634    0.997408    0.840000    3200        48.188235   0.055045    1.112652    133.018111 
[37m[36mINFO[0m[0m 03/17 22:20:21 | 0.974382    0.946996    0.975898    0.796087    1.030884    0.974382    0.946996    0.960000    0.725047    0.983244    0.824695    0.984450    0.838519    3400        51.200000   0.050519    1.137304    141.118483 
[37m[36mINFO[0m[0m 03/17 22:26:28 | 0.978799    0.975265    0.983277    0.780359    1.160008    0.978799    0.975265    0.986824    0.755179    0.974486    0.762195    0.988523    0.823704    3600        54.211765   0.037499    1.135220    140.176009 
[37m[36mINFO[0m[0m 03/17 22:32:33 | 0.976148    0.978799    0.989436    0.800168    1.273879    0.976148    0.978799    0.982588    0.749529    0.992384    0.810976    0.993336    0.840000    3800        57.223529   0.039986    1.135296    137.577985 
[37m[36mINFO[0m[0m 03/17 22:38:42 | 0.977032    0.946996    0.984612    0.798731    1.076761    0.977032    0.946996    0.985412    0.741996    0.982864    0.820122    0.985561    0.834074    4000        60.235294   0.048375    1.142310    140.678175 
[37m[36mINFO[0m[0m 03/17 22:44:42 | 0.974382    0.968198    0.993744    0.794857    1.183868    0.974382    0.968198    0.992941    0.743879    0.991622    0.814024    0.996668    0.826667    4200        63.247059   0.030190    1.118811    136.946528 
[37m[36mINFO[0m[0m 03/17 22:50:45 | 0.988516    0.975265    0.990788    0.804141    0.987857    0.988516    0.975265    0.985882    0.755179    0.993145    0.823171    0.993336    0.834074    4400        66.258824   0.030506    1.121454    138.410159 
[37m[36mINFO[0m[0m 03/17 22:56:45 | 0.992049    0.971731    0.989342    0.797554    1.091283    0.992049    0.971731    0.986824    0.725047    0.989718    0.823171    0.991485    0.844444    4600        69.270588   0.045034    1.113741    136.821006 
[37m[36mINFO[0m[0m 03/17 23:02:45 | 0.954064    0.954064    0.978059    0.781400    1.440483    0.954064    0.954064    0.981176    0.745763    0.974105    0.786585    0.978897    0.811852    4800        72.282353   0.030457    1.126163    134.549107 
[37m[36mINFO[0m[0m 03/17 23:08:45 | 0.977032    0.985866    0.993848    0.794424    1.317599    0.977032    0.985866    0.992471    0.753296    0.993145    0.801829    0.995927    0.828148    5000        75.294118   0.022860    1.126964    134.637995 
[37m[36mINFO[0m[0m 03/17 23:08:45 | Cumulative gradient change saved at train_output/VLCS/ERM/[0]/250317_20-33-32_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/17 23:08:46 | ---
[37m[36mINFO[0m[0m 03/17 23:08:46 | test-domain validation(oracle) = 99.293%
[37m[36mINFO[0m[0m 03/17 23:08:46 | training-domain validation(iid) = 98.587%
[37m[36mINFO[0m[0m 03/17 23:08:46 | last = 97.703%
[37m[36mINFO[0m[0m 03/17 23:08:46 | last (inD) = 79.442%
[37m[36mINFO[0m[0m 03/17 23:08:46 | training-domain validation (iid, inD) = 81.467%
[37m[36mINFO[0m[0m 03/17 23:08:46 | === Summary ===
[37m[36mINFO[0m[0m 03/17 23:08:46 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --trial_seed 1 --hparams_seed 0 --algorithm ERM --test_envs 0 --dataset VLCS
[37m[36mINFO[0m[0m 03/17 23:08:46 | Unique name: 250317_20-33-32_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/17 23:08:46 | Out path: train_output/VLCS/ERM/[0]/250317_20-33-32_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/17 23:08:46 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/17 23:08:46 | Dataset: VLCS

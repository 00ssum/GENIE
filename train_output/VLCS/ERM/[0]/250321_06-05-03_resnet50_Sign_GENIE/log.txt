[37m[36mINFO[0m[0m 03/21 06:05:03 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset VLCS --trial_seed 1 --hparams_seed 2
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 2
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[0]/250321_06-05-03_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 1
	unique_name: 250321_06-05-03_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.0001126313085293539
	batch_size: 38
	weight_decay: 0.006639128805224463
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/21 06:05:03 | n_steps = 5001
[37m[36mINFO[0m[0m 03/21 06:05:03 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/21 06:05:03 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/21 06:05:03 | 
[37m[36mINFO[0m[0m 03/21 06:05:03 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/21 06:05:03 | Test envs = [0], name = te_C
[37m[36mINFO[0m[0m 03/21 06:05:03 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/21 06:05:03 | Batch sizes for each domain: [0, 38, 38, 38] (total=114)
[37m[36mINFO[0m[0m 03/21 06:05:03 | steps-per-epoch for each domain: 55.92, 69.11, 71.08 -> min = 55.92
[37m[36mINFO[0m[0m 03/21 06:05:04 | # of params = 23518277
[37m[36mINFO[0m[0m 03/21 06:07:20 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/21 06:07:20 | 0.613958    0.618375    0.432326    0.428842    1.383849    0.613958    0.618375    0.466824    0.461394    0.376618    0.419207    0.453536    0.405926    0           0.000000    1.876013    1.611862    134.391629 
[37m[36mINFO[0m[0m 03/21 06:13:50 | 0.979682    0.975265    0.811008    0.795849    0.538204    0.979682    0.975265    0.774588    0.753296    0.805788    0.795732    0.852647    0.838519    200         3.576471    0.673788    1.268461    136.141651 
[37m[36mINFO[0m[0m 03/21 06:20:33 | 0.979682    0.975265    0.835670    0.813354    0.512887    0.979682    0.975265    0.798118    0.766478    0.822925    0.824695    0.885968    0.848889    400         7.152941    0.471075    1.343043    133.835084 
[37m[36mINFO[0m[0m 03/21 06:27:17 | 0.986749    0.985866    0.865575    0.821081    0.500756    0.986749    0.985866    0.806118    0.768362    0.872430    0.844512    0.918178    0.850370    600         10.729412   0.405169    1.316501    141.547234 
[37m[36mINFO[0m[0m 03/21 06:33:58 | 0.993816    0.985866    0.884030    0.822145    0.500126    0.993816    0.985866    0.832000    0.777778    0.894136    0.833841    0.925953    0.854815    800         14.305882   0.367282    1.326499    134.793394 
[37m[36mINFO[0m[0m 03/21 06:40:35 | 0.969965    0.982332    0.880951    0.801648    0.577156    0.969965    0.982332    0.832941    0.764595    0.887662    0.801829    0.922251    0.838519    1000        17.882353   0.344926    1.317215    134.152989 
[37m[36mINFO[0m[0m 03/21 06:47:12 | 0.984982    0.989399    0.885992    0.802447    0.559775    0.984982    0.989399    0.850824    0.766478    0.894897    0.820122    0.912255    0.820741    1200        21.458824   0.313663    1.314123    134.454313 
[37m[36mINFO[0m[0m 03/21 06:53:56 | 0.984099    0.975265    0.872101    0.791169    0.632715    0.984099    0.975265    0.774118    0.719397    0.903275    0.817073    0.938912    0.837037    1400        25.035294   0.267748    1.347015    134.452199 
[37m[36mINFO[0m[0m 03/21 07:00:40 | 0.991166    0.985866    0.924336    0.814008    0.615956    0.991166    0.985866    0.897882    0.783427    0.916222    0.818598    0.958904    0.840000    1600        28.611765   0.250821    1.344256    135.318867 
[37m[36mINFO[0m[0m 03/21 07:07:21 | 0.981449    0.975265    0.919829    0.796721    0.800355    0.981449    0.975265    0.893647    0.747646    0.928408    0.826220    0.937431    0.816296    1800        32.188235   0.212634    1.337505    132.615881 
[37m[36mINFO[0m[0m 03/21 07:14:00 | 0.987633    0.982332    0.938751    0.797467    0.711829    0.987633    0.982332    0.916235    0.758945    0.945925    0.820122    0.954091    0.813333    2000        35.764706   0.210939    1.325926    134.251998 
[37m[36mINFO[0m[0m 03/21 07:20:44 | 0.980565    0.971731    0.939395    0.796334    0.670792    0.980565    0.971731    0.888941    0.734463    0.958492    0.832317    0.970752    0.822222    2200        39.341176   0.218588    1.331647    137.573675 
[37m[36mINFO[0m[0m 03/21 07:27:24 | 0.988516    0.982332    0.948074    0.786066    0.772386    0.988516    0.982332    0.914353    0.732580    0.954303    0.804878    0.975565    0.820741    2400        42.917647   0.174751    1.323912    135.047287 
[37m[36mINFO[0m[0m 03/21 07:34:07 | 0.991166    0.978799    0.954485    0.790159    0.789180    0.991166    0.978799    0.925176    0.740113    0.963823    0.815549    0.974454    0.814815    2600        46.494118   0.154357    1.335277    136.521212 
[37m[36mINFO[0m[0m 03/21 07:40:50 | 0.977915    0.968198    0.968623    0.790215    0.762182    0.977915    0.968198    0.954824    0.747646    0.970297    0.817073    0.980748    0.805926    2800        50.070588   0.144677    1.347451    133.570056 
[37m[36mINFO[0m[0m 03/21 07:47:33 | 0.955830    0.957597    0.957668    0.776218    0.860139    0.955830    0.957597    0.947294    0.732580    0.964585    0.807927    0.961126    0.788148    3000        53.647059   0.146658    1.338789    134.365024 
[37m[36mINFO[0m[0m 03/21 07:54:18 | 0.951413    0.954064    0.921812    0.766893    0.893874    0.951413    0.954064    0.932706    0.745763    0.882711    0.766768    0.950019    0.788148    3200        57.223529   0.161012    1.344410    136.545292 
[37m[36mINFO[0m[0m 03/21 08:01:05 | 0.983216    0.982332    0.966370    0.790574    0.896731    0.983216    0.982332    0.956706    0.753296    0.965727    0.812500    0.976675    0.805926    3400        60.800000   0.156719    1.357491    135.272337 
[37m[36mINFO[0m[0m 03/21 08:07:51 | 0.962014    0.971731    0.956085    0.772589    0.876028    0.962014    0.971731    0.928000    0.700565    0.968393    0.821646    0.971862    0.795556    3600        64.376471   0.113824    1.363402    133.542178 
[37m[36mINFO[0m[0m 03/21 08:14:29 | 0.983216    0.975265    0.968377    0.752587    0.881433    0.983216    0.975265    0.964706    0.719397    0.961158    0.757622    0.979267    0.780741    3800        67.952941   0.113621    1.323967    133.631027 
[37m[36mINFO[0m[0m 03/21 08:21:14 | 0.974382    0.971731    0.942011    0.762037    0.998255    0.974382    0.971731    0.907294    0.709981    0.953542    0.783537    0.965198    0.792593    4000        71.529412   0.136741    1.345572    135.933482 
[37m[36mINFO[0m[0m 03/21 08:27:55 | 0.969965    0.961131    0.952771    0.767688    0.932881    0.969965    0.961131    0.920471    0.719397    0.961538    0.788110    0.976305    0.795556    4200        75.105882   0.130707    1.335261    133.887438 
[37m[36mINFO[0m[0m 03/21 08:34:38 | 0.968198    0.964664    0.974954    0.758431    0.912946    0.968198    0.964664    0.969882    0.715631    0.978675    0.777439    0.976305    0.782222    4400        78.682353   0.117240    1.343937    133.793636 
[37m[36mINFO[0m[0m 03/21 08:41:22 | 0.942580    0.943463    0.950681    0.770065    0.932502    0.942580    0.943463    0.967059    0.725047    0.937928    0.788110    0.947057    0.797037    4600        82.258824   0.116486    1.340320    136.282625 
[37m[36mINFO[0m[0m 03/21 08:48:07 | 0.971731    0.964664    0.958878    0.778403    0.884880    0.971731    0.964664    0.960000    0.743879    0.957730    0.797256    0.958904    0.794074    4800        85.835294   0.118770    1.344879    135.822789 
[37m[36mINFO[0m[0m 03/21 08:54:44 | 0.976148    0.971731    0.962913    0.753272    0.854712    0.976148    0.971731    0.963294    0.721281    0.955065    0.763720    0.970381    0.774815    5000        89.411765   0.109833    1.313968    133.953647 
[37m[36mINFO[0m[0m 03/21 08:54:44 | Cumulative gradient change saved at train_output/VLCS/ERM/[0]/250321_06-05-03_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/21 08:54:45 | ---
[37m[36mINFO[0m[0m 03/21 08:54:45 | test-domain validation(oracle) = 98.498%
[37m[36mINFO[0m[0m 03/21 08:54:45 | training-domain validation(iid) = 99.382%
[37m[36mINFO[0m[0m 03/21 08:54:45 | last = 97.615%
[37m[36mINFO[0m[0m 03/21 08:54:45 | last (inD) = 75.327%
[37m[36mINFO[0m[0m 03/21 08:54:45 | training-domain validation (iid, inD) = 82.214%
[37m[36mINFO[0m[0m 03/21 08:54:45 | === Summary ===
[37m[36mINFO[0m[0m 03/21 08:54:45 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset VLCS --trial_seed 1 --hparams_seed 2
[37m[36mINFO[0m[0m 03/21 08:54:45 | Unique name: 250321_06-05-03_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/21 08:54:45 | Out path: train_output/VLCS/ERM/[0]/250321_06-05-03_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/21 08:54:45 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/21 08:54:45 | Dataset: VLCS

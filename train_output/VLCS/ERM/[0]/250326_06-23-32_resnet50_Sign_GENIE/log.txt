[37m[36mINFO[0m[0m 03/26 06:23:32 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset VLCS --trial_seed 2 --hparams_seed 20
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 20
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[0]/250326_06-23-32_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 2
	unique_name: 250326_06-23-32_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 3.0575564760860844e-05
	batch_size: 27
	weight_decay: 7.45235722180653e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/26 06:23:32 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 06:23:32 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 06:23:32 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 06:23:32 | 
[37m[36mINFO[0m[0m 03/26 06:23:32 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/26 06:23:32 | Test envs = [0], name = te_C
[37m[36mINFO[0m[0m 03/26 06:23:32 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/26 06:23:32 | Batch sizes for each domain: [0, 27, 27, 27] (total=81)
[37m[36mINFO[0m[0m 03/26 06:23:32 | steps-per-epoch for each domain: 78.70, 97.26, 100.04 -> min = 78.70
[37m[36mINFO[0m[0m 03/26 06:23:33 | # of params = 23518277
[37m[36mINFO[0m[0m 03/26 06:25:52 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 06:25:52 | 0.620141    0.593640    0.433117    0.425667    1.297099    0.620141    0.593640    0.467294    0.459510    0.391851    0.358232    0.440207    0.459259    0           0.000000    1.806381    1.303181    137.279134 
[37m[36mINFO[0m[0m 03/26 06:31:20 | 0.975265    0.943463    0.817638    0.797412    0.515039    0.975265    0.943463    0.767059    0.757062    0.819878    0.775915    0.865976    0.859259    200         2.541176    0.612040    0.955784    136.618546 
[37m[36mINFO[0m[0m 03/26 06:36:45 | 0.975265    0.978799    0.834156    0.801045    0.513128    0.975265    0.978799    0.796706    0.766478    0.830160    0.775915    0.875602    0.860741    400         5.082353    0.449000    0.949314    135.700432 
[37m[36mINFO[0m[0m 03/26 06:42:08 | 0.978799    0.961131    0.865623    0.817653    0.491172    0.978799    0.961131    0.817412    0.781544    0.870906    0.800305    0.908552    0.871111    600         7.623529    0.406972    0.945258    134.104165 
[37m[36mINFO[0m[0m 03/26 06:47:36 | 0.989399    0.982332    0.869686    0.801971    0.567124    0.989399    0.982332    0.832941    0.757062    0.870526    0.788110    0.905591    0.860741    800         10.164706   0.359047    0.963756    134.807937 
[37m[36mINFO[0m[0m 03/26 06:53:03 | 0.959364    0.961131    0.886409    0.794297    0.647262    0.959364    0.961131    0.859765    0.745763    0.884615    0.792683    0.914846    0.844444    1000        12.705882   0.305597    0.948659    136.826782 
[37m[36mINFO[0m[0m 03/26 06:58:31 | 0.959364    0.957597    0.877900    0.793034    0.654253    0.959364    0.957597    0.867294    0.768362    0.854151    0.750000    0.912255    0.860741    1200        15.247059   0.272393    0.964526    135.800652 
[37m[36mINFO[0m[0m 03/26 07:03:57 | 0.982332    0.964664    0.913888    0.791594    0.634637    0.982332    0.964664    0.884235    0.743879    0.905560    0.782012    0.951870    0.848889    1400        17.788235   0.244768    0.945599    136.270784 
[37m[36mINFO[0m[0m 03/26 07:09:21 | 0.960247    0.939929    0.926854    0.789985    0.678594    0.960247    0.939929    0.895059    0.728814    0.929931    0.777439    0.955572    0.863704    1600        20.329412   0.196721    0.949970    134.480101 
[37m[36mINFO[0m[0m 03/26 07:14:49 | 0.975265    0.978799    0.953486    0.807601    0.621956    0.975265    0.978799    0.930824    0.772128    0.959254    0.800305    0.970381    0.850370    1800        22.870588   0.206676    0.955461    136.393231 
[37m[36mINFO[0m[0m 03/26 07:20:15 | 0.970848    0.964664    0.946863    0.795843    0.661000    0.970848    0.964664    0.928471    0.751412    0.955065    0.809451    0.957053    0.826667    2000        25.411765   0.148869    0.957916    135.132937 
[37m[36mINFO[0m[0m 03/26 07:25:41 | 0.990283    0.982332    0.960944    0.804180    0.691998    0.990283    0.982332    0.947294    0.758945    0.958492    0.798780    0.977046    0.854815    2200        27.952941   0.151120    0.947736    136.257433 
[37m[36mINFO[0m[0m 03/26 07:31:05 | 0.954064    0.954064    0.959276    0.803283    0.851853    0.954064    0.954064    0.952941    0.768362    0.948210    0.789634    0.976675    0.851852    2400        30.494118   0.115965    0.944850    134.452799 
[37m[36mINFO[0m[0m 03/26 07:36:30 | 0.955830    0.932862    0.976871    0.810784    0.694022    0.955830    0.932862    0.967529    0.774011    0.977152    0.809451    0.985931    0.848889    2600        33.035294   0.114008    0.931256    138.808480 
[37m[36mINFO[0m[0m 03/26 07:41:54 | 0.971731    0.961131    0.964560    0.802201    1.051119    0.971731    0.961131    0.925647    0.749529    0.982102    0.817073    0.985931    0.840000    2800        35.576471   0.076487    0.944138    135.138517 
[37m[36mINFO[0m[0m 03/26 07:47:16 | 0.973498    0.961131    0.972365    0.809084    1.214764    0.973498    0.961131    0.960000    0.764595    0.974867    0.804878    0.982229    0.857778    3000        38.117647   0.061983    0.944374    133.430778 
[37m[36mINFO[0m[0m 03/26 07:52:37 | 0.963781    0.954064    0.967710    0.791553    1.010730    0.963781    0.954064    0.949176    0.747646    0.968393    0.801829    0.985561    0.825185    3200        40.658824   0.096137    0.933585    134.718128 
[37m[36mINFO[0m[0m 03/26 07:58:01 | 0.940813    0.932862    0.971284    0.791329    1.073985    0.940813    0.932862    0.964235    0.743879    0.972201    0.806402    0.977416    0.823704    3400        43.200000   0.072880    0.941725    135.317166 
[37m[36mINFO[0m[0m 03/26 08:03:30 | 0.962898    0.957597    0.978103    0.799883    1.031427    0.962898    0.957597    0.965176    0.768362    0.981721    0.795732    0.987412    0.835556    3600        45.741176   0.059275    0.964038    136.510441 
[37m[36mINFO[0m[0m 03/26 08:08:53 | 0.968198    0.985866    0.992406    0.800230    0.987385    0.968198    0.985866    0.989647    0.758945    0.992384    0.798780    0.995187    0.842963    3800        48.282353   0.050505    0.944023    133.937271 
[37m[36mINFO[0m[0m 03/26 08:14:16 | 0.944346    0.918728    0.970225    0.789977    0.899872    0.944346    0.918728    0.963765    0.749529    0.968012    0.777439    0.978897    0.842963    4000        50.823529   0.053701    0.943733    134.415214 
[37m[36mINFO[0m[0m 03/26 08:19:41 | 0.971731    0.968198    0.992801    0.808902    0.975792    0.971731    0.968198    0.991529    0.760829    0.993907    0.814024    0.992966    0.851852    4200        53.364706   0.050220    0.949900    134.282990 
[37m[36mINFO[0m[0m 03/26 08:25:10 | 0.974382    0.971731    0.984319    0.796970    0.993434    0.974382    0.971731    0.973647    0.755179    0.988195    0.795732    0.991114    0.840000    4400        55.905882   0.054303    0.963948    136.322884 
[37m[36mINFO[0m[0m 03/26 08:30:33 | 0.979682    0.978799    0.980812    0.786222    1.290102    0.979682    0.978799    0.958588    0.721281    0.991622    0.801829    0.992225    0.835556    4600        58.447059   0.037181    0.939864    135.830246 
[37m[36mINFO[0m[0m 03/26 08:35:57 | 0.968198    0.968198    0.992155    0.800223    1.096086    0.968198    0.968198    0.991529    0.764595    0.990861    0.807927    0.994076    0.828148    4800        60.988235   0.036029    0.934214    136.965557 
[37m[36mINFO[0m[0m 03/26 08:41:22 | 0.946996    0.946996    0.988271    0.802139    1.176258    0.946996    0.946996    0.992941    0.779661    0.987053    0.792683    0.984820    0.834074    5000        63.529412   0.028921    0.933864    137.844495 
[37m[36mINFO[0m[0m 03/26 08:41:22 | Cumulative gradient change saved at train_output/VLCS/ERM/[0]/250326_06-23-32_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 08:41:23 | ---
[37m[36mINFO[0m[0m 03/26 08:41:23 | test-domain validation(oracle) = 96.820%
[37m[36mINFO[0m[0m 03/26 08:41:23 | training-domain validation(iid) = 97.880%
[37m[36mINFO[0m[0m 03/26 08:41:23 | last = 94.700%
[37m[36mINFO[0m[0m 03/26 08:41:23 | last (inD) = 80.214%
[37m[36mINFO[0m[0m 03/26 08:41:23 | training-domain validation (iid, inD) = 81.765%
[37m[36mINFO[0m[0m 03/26 08:41:24 | === Summary ===
[37m[36mINFO[0m[0m 03/26 08:41:24 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset VLCS --trial_seed 2 --hparams_seed 20
[37m[36mINFO[0m[0m 03/26 08:41:24 | Unique name: 250326_06-23-32_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 08:41:24 | Out path: train_output/VLCS/ERM/[0]/250326_06-23-32_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 08:41:24 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 08:41:24 | Dataset: VLCS

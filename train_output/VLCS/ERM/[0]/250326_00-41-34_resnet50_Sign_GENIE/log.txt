[37m[36mINFO[0m[0m 03/26 00:41:34 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset VLCS --trial_seed 2 --hparams_seed 17
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 17
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[0]/250326_00-41-34_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 2
	unique_name: 250326_00-41-34_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 4.54558611872744e-05
	batch_size: 30
	weight_decay: 2.0881632317009623e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/26 00:41:34 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 00:41:34 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 00:41:34 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 00:41:34 | 
[37m[36mINFO[0m[0m 03/26 00:41:34 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/26 00:41:34 | Test envs = [0], name = te_C
[37m[36mINFO[0m[0m 03/26 00:41:34 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/26 00:41:34 | Batch sizes for each domain: [0, 30, 30, 30] (total=90)
[37m[36mINFO[0m[0m 03/26 00:41:34 | steps-per-epoch for each domain: 70.83, 87.53, 90.03 -> min = 70.83
[37m[36mINFO[0m[0m 03/26 00:41:36 | # of params = 23518277
[37m[36mINFO[0m[0m 03/26 00:43:58 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 00:43:58 | 0.620141    0.593640    0.433117    0.425667    1.275695    0.620141    0.593640    0.467294    0.459510    0.391851    0.358232    0.440207    0.459259    0           0.000000    1.921032    1.024819    140.697243 
[37m[36mINFO[0m[0m 03/26 00:50:00 | 0.980565    0.971731    0.789544    0.771256    0.582358    0.980565    0.971731    0.749176    0.728814    0.775324    0.728659    0.844132    0.856296    200         2.823529    0.645611    1.098315    142.332762 
[37m[36mINFO[0m[0m 03/26 00:56:00 | 0.986749    0.982332    0.834329    0.809162    0.523886    0.986749    0.982332    0.755294    0.751412    0.860244    0.807927    0.887449    0.868148    400         5.647059    0.479744    1.104012    139.138465 
[37m[36mINFO[0m[0m 03/26 01:01:59 | 0.987633    0.992933    0.866353    0.804018    0.530860    0.987633    0.992933    0.822118    0.757062    0.873572    0.795732    0.903369    0.859259    600         8.470588    0.416187    1.104856    138.401160 
[37m[36mINFO[0m[0m 03/26 01:08:00 | 0.980565    0.985866    0.884638    0.817476    0.523246    0.980565    0.985866    0.826824    0.787194    0.892993    0.791159    0.934098    0.874074    800         11.294118   0.372905    1.105851    139.421993 
[37m[36mINFO[0m[0m 03/26 01:13:57 | 0.989399    0.982332    0.890128    0.802582    0.536799    0.989399    0.982332    0.835294    0.774011    0.900990    0.777439    0.934098    0.856296    1000        14.117647   0.315588    1.100132    137.257421 
[37m[36mINFO[0m[0m 03/26 01:19:54 | 0.984099    0.975265    0.907559    0.810871    0.562759    0.984099    0.975265    0.864941    0.766478    0.916603    0.823171    0.941133    0.842963    1200        16.941176   0.303125    1.088277    139.110799 
[37m[36mINFO[0m[0m 03/26 01:25:50 | 0.977915    0.964664    0.911696    0.799363    0.606754    0.977915    0.964664    0.876706    0.753296    0.913176    0.801829    0.945205    0.842963    1400        19.764706   0.261716    1.084904    139.261515 
[37m[36mINFO[0m[0m 03/26 01:31:51 | 0.968198    0.961131    0.939035    0.808721    0.667613    0.968198    0.961131    0.906353    0.749529    0.945925    0.827744    0.964828    0.848889    1600        22.588235   0.220377    1.103254    140.163378 
[37m[36mINFO[0m[0m 03/26 01:37:51 | 0.979682    0.975265    0.927464    0.795830    0.758485    0.979682    0.975265    0.910588    0.757062    0.929931    0.765244    0.941873    0.865185    1800        25.411765   0.208211    1.113786    137.372861 
[37m[36mINFO[0m[0m 03/26 01:43:53 | 0.991166    0.982332    0.954192    0.817602    0.812485    0.991166    0.982332    0.927059    0.762712    0.957730    0.832317    0.977786    0.857778    2000        28.235294   0.167425    1.110198    139.627415 
[37m[36mINFO[0m[0m 03/26 01:49:52 | 0.983216    0.975265    0.946186    0.803523    0.691065    0.983216    0.975265    0.904471    0.725047    0.959634    0.827744    0.974454    0.857778    2200        31.058824   0.143895    1.086171    142.164740 
[37m[36mINFO[0m[0m 03/26 01:55:49 | 0.970848    0.957597    0.962397    0.803629    0.906023    0.970848    0.957597    0.946353    0.758945    0.962681    0.792683    0.978156    0.859259    2400        33.882353   0.135802    1.088624    139.350360 
[37m[36mINFO[0m[0m 03/26 02:01:49 | 0.971731    0.954064    0.967671    0.803424    0.786534    0.971731    0.954064    0.957647    0.775895    0.965727    0.800305    0.979637    0.834074    2600        36.705882   0.116787    1.098820    139.895436 
[37m[36mINFO[0m[0m 03/26 02:07:45 | 0.978799    0.978799    0.969202    0.805020    0.825872    0.978799    0.978799    0.940706    0.757062    0.981340    0.797256    0.985561    0.860741    2800        39.529412   0.118863    1.093878    136.856550 
[37m[36mINFO[0m[0m 03/26 02:13:47 | 0.976148    0.961131    0.953048    0.782265    0.987717    0.976148    0.961131    0.944000    0.740113    0.944021    0.763720    0.971122    0.842963    3000        42.352941   0.089632    1.118339    138.310411 
[37m[36mINFO[0m[0m 03/26 02:19:49 | 0.979682    0.971731    0.981644    0.811552    0.979916    0.979682    0.971731    0.976941    0.772128    0.980579    0.800305    0.987412    0.862222    3200        45.176471   0.080589    1.086978    144.750913 
[37m[36mINFO[0m[0m 03/26 02:25:47 | 0.982332    0.964664    0.983063    0.798762    1.003576    0.982332    0.964664    0.981176    0.758945    0.981340    0.800305    0.986672    0.837037    3400        48.000000   0.077654    1.103796    137.978371 
[37m[36mINFO[0m[0m 03/26 02:31:44 | 0.979682    0.957597    0.985545    0.803150    1.067643    0.979682    0.957597    0.979294    0.758945    0.984006    0.794207    0.993336    0.856296    3600        50.823529   0.066361    1.093256    137.515025 
[37m[36mINFO[0m[0m 03/26 02:37:39 | 0.978799    0.975265    0.980182    0.795002    1.196815    0.978799    0.975265    0.977412    0.741996    0.979056    0.791159    0.984080    0.851852    3800        53.647059   0.059668    1.090849    137.233423 
[37m[36mINFO[0m[0m 03/26 02:43:35 | 0.964664    0.961131    0.955650    0.778502    1.102483    0.964664    0.961131    0.946824    0.732580    0.950114    0.788110    0.970011    0.814815    4000        56.470588   0.059038    1.090942    137.942696 
[37m[36mINFO[0m[0m 03/26 02:49:34 | 0.968198    0.957597    0.986552    0.797860    1.217645    0.968198    0.957597    0.980706    0.766478    0.988576    0.804878    0.990374    0.822222    4200        59.294118   0.057076    1.095336    139.628145 
[37m[36mINFO[0m[0m 03/26 02:55:29 | 0.969965    0.961131    0.978410    0.797656    0.991843    0.969965    0.961131    0.968000    0.749529    0.979817    0.806402    0.987412    0.837037    4400        62.117647   0.063923    1.089713    137.387117 
[37m[36mINFO[0m[0m 03/26 03:01:18 | 0.992049    0.982332    0.990373    0.801224    1.130626    0.992049    0.982332    0.987294    0.772128    0.990861    0.804878    0.992966    0.826667    4600        64.941176   0.037890    1.066640    135.726519 
[37m[36mINFO[0m[0m 03/26 03:07:10 | 0.969965    0.961131    0.981242    0.787886    1.173624    0.969965    0.961131    0.979765    0.743879    0.982102    0.807927    0.981859    0.811852    4800        67.764706   0.038386    1.078117    136.212261 
[37m[36mINFO[0m[0m 03/26 03:13:02 | 0.974382    0.968198    0.991952    0.809556    1.132941    0.974382    0.968198    0.984941    0.777778    0.992765    0.807927    0.998149    0.842963    5000        70.588235   0.042872    1.082222    135.558731 
[37m[36mINFO[0m[0m 03/26 03:13:02 | Cumulative gradient change saved at train_output/VLCS/ERM/[0]/250326_00-41-34_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 03:13:04 | ---
[37m[36mINFO[0m[0m 03/26 03:13:04 | test-domain validation(oracle) = 98.763%
[37m[36mINFO[0m[0m 03/26 03:13:04 | training-domain validation(iid) = 99.117%
[37m[36mINFO[0m[0m 03/26 03:13:04 | last = 97.438%
[37m[36mINFO[0m[0m 03/26 03:13:04 | last (inD) = 80.956%
[37m[36mINFO[0m[0m 03/26 03:13:04 | training-domain validation (iid, inD) = 81.760%
[37m[36mINFO[0m[0m 03/26 03:13:04 | === Summary ===
[37m[36mINFO[0m[0m 03/26 03:13:04 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset VLCS --trial_seed 2 --hparams_seed 17
[37m[36mINFO[0m[0m 03/26 03:13:04 | Unique name: 250326_00-41-34_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 03:13:04 | Out path: train_output/VLCS/ERM/[0]/250326_00-41-34_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 03:13:04 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 03:13:04 | Dataset: VLCS

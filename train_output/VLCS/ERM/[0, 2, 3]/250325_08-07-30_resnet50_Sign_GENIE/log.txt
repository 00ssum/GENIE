[37m[36mINFO[0m[0m 03/25 08:07:30 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 2 3 --dataset VLCS --trial_seed 1 --hparams_seed 8
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 8
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[0, 2, 3]/250325_08-07-30_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[0, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 2, 3]
	trial_seed: 1
	unique_name: 250325_08-07-30_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 3.335053008064847e-05
	batch_size: 18
	weight_decay: 0.00011109601170966198
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/25 08:07:30 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 08:07:30 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 08:07:30 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 08:07:30 | 
[37m[36mINFO[0m[0m 03/25 08:07:30 | Testenv name escaping te_C_S_V -> te_C_S_V
[37m[36mINFO[0m[0m 03/25 08:07:30 | Test envs = [0, 2, 3], name = te_C_S_V
[37m[36mINFO[0m[0m 03/25 08:07:30 | Train environments: [1], Test environments: [0, 2, 3]
[37m[36mINFO[0m[0m 03/25 08:07:30 | Batch sizes for each domain: [0, 18, 0, 0] (total=18)
[37m[36mINFO[0m[0m 03/25 08:07:30 | steps-per-epoch for each domain: 118.06 -> min = 118.06
[37m[36mINFO[0m[0m 03/25 08:07:31 | # of params = 23518277
[37m[36mINFO[0m[0m 03/25 08:09:36 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 08:09:36 | 0.439831    0.438588    0.466824    0.461394    1.127184    0.505300    0.515901    0.466824    0.461394    0.375095    0.416159    0.439097    0.383704    0           0.000000    1.729287    1.127871    123.568099 
[37m[36mINFO[0m[0m 03/25 08:13:44 | 0.640850    0.644645    0.707294    0.691149    0.760313    0.859541    0.837456    0.707294    0.691149    0.429170    0.480183    0.633839    0.616296    200         1.694118    0.744518    0.648634    119.001899 
[37m[36mINFO[0m[0m 03/25 08:18:00 | 0.638732    0.640320    0.753412    0.711864    0.674707    0.858657    0.848057    0.753412    0.711864    0.445545    0.484756    0.611996    0.588148    400         3.388235    0.619512    0.661322    123.646851 
[37m[36mINFO[0m[0m 03/25 08:22:12 | 0.681294    0.672925    0.763765    0.751412    0.641637    0.886042    0.858657    0.763765    0.751412    0.511043    0.530488    0.646797    0.629630    600         5.082353    0.551167    0.639812    123.747588 
[37m[36mINFO[0m[0m 03/25 08:26:20 | 0.691210    0.696209    0.824471    0.762712    0.612943    0.860424    0.855124    0.824471    0.762712    0.571592    0.611280    0.641614    0.622222    800         6.776471    0.541585    0.643295    119.064536 
[37m[36mINFO[0m[0m 03/25 08:30:28 | 0.698386    0.688164    0.817882    0.766478    0.639318    0.878092    0.848057    0.817882    0.766478    0.550647    0.583841    0.666420    0.632593    1000        8.470588    0.493517    0.640604    120.204147 
[37m[36mINFO[0m[0m 03/25 08:34:40 | 0.673644    0.656978    0.822118    0.768362    0.737909    0.757067    0.734982    0.822118    0.768362    0.569307    0.592988    0.694558    0.642963    1200        10.164706   0.452699    0.652467    121.064588 
[37m[36mINFO[0m[0m 03/25 08:38:44 | 0.572311    0.568418    0.828706    0.732580    0.785477    0.517668    0.501767    0.828706    0.732580    0.562833    0.597561    0.636431    0.605926    1400        11.858824   0.388696    0.634909    117.322216 
[37m[36mINFO[0m[0m 03/25 08:42:56 | 0.639399    0.625931    0.857882    0.736347    0.773302    0.784452    0.752650    0.857882    0.736347    0.469916    0.498476    0.663828    0.626667    1600        13.552941   0.369994    0.654566    121.017277 
[37m[36mINFO[0m[0m 03/25 08:47:03 | 0.561180    0.554430    0.887059    0.758945    0.709807    0.454064    0.455830    0.887059    0.758945    0.584158    0.580793    0.645317    0.626667    1800        15.247059   0.346877    0.636751    119.499158 
[37m[36mINFO[0m[0m 03/25 08:51:08 | 0.507055    0.484779    0.902588    0.753296    0.712884    0.338339    0.296820    0.902588    0.753296    0.597487    0.596037    0.585339    0.561481    2000        16.941176   0.319172    0.632983    118.897857 
[37m[36mINFO[0m[0m 03/25 08:55:15 | 0.626336    0.617364    0.907765    0.747646    1.020450    0.662544    0.643110    0.907765    0.747646    0.568926    0.582317    0.647538    0.626667    2200        18.635294   0.260161    0.642339    118.272581 
[37m[36mINFO[0m[0m 03/25 08:59:27 | 0.572265    0.585400    0.836706    0.708098    0.890004    0.673145    0.696113    0.836706    0.708098    0.465347    0.503049    0.578304    0.557037    2400        20.329412   0.263698    0.651596    121.733434 
[37m[36mINFO[0m[0m 03/25 09:03:38 | 0.610468    0.615924    0.862118    0.713748    0.973190    0.713781    0.720848    0.862118    0.713748    0.462681    0.509146    0.654943    0.617778    2600        22.023529   0.239215    0.655339    119.867015 
[37m[36mINFO[0m[0m 03/25 09:07:45 | 0.545832    0.530909    0.941647    0.743879    0.989388    0.431979    0.434629    0.941647    0.743879    0.561310    0.564024    0.644206    0.594074    2800        23.717647   0.278814    0.642542    118.285874 
[37m[36mINFO[0m[0m 03/25 09:11:49 | 0.529467    0.507251    0.935059    0.751412    1.013002    0.428445    0.381625    0.935059    0.751412    0.587205    0.609756    0.572751    0.530370    3000        25.411765   0.169321    0.630142    118.185283 
[37m[36mINFO[0m[0m 03/25 09:15:58 | 0.581127    0.555839    0.935059    0.741996    1.214015    0.576855    0.515901    0.935059    0.741996    0.517136    0.544207    0.649389    0.607407    3200        27.105882   0.159672    0.643475    120.554872 
[37m[36mINFO[0m[0m 03/25 09:20:04 | 0.610415    0.594826    0.948706    0.740113    1.407262    0.634276    0.611307    0.948706    0.740113    0.546839    0.573171    0.650130    0.600000    3400        28.800000   0.177450    0.626855    120.060328 
[37m[36mINFO[0m[0m 03/25 09:24:07 | 0.605593    0.599486    0.940706    0.717514    1.116025    0.667845    0.636042    0.940706    0.717514    0.523610    0.559451    0.625324    0.602963    3600        30.494118   0.129865    0.629592    117.074845 
[37m[36mINFO[0m[0m 03/25 09:28:15 | 0.577549    0.552257    0.968941    0.766478    1.027049    0.554770    0.494700    0.968941    0.766478    0.525895    0.547256    0.651981    0.614815    3800        32.188235   0.133583    0.644677    119.729346 
[37m[36mINFO[0m[0m 03/25 09:32:21 | 0.554022    0.537121    0.976000    0.738230    1.078057    0.388693    0.367491    0.976000    0.738230    0.605103    0.611280    0.668271    0.632593    4000        33.882353   0.186304    0.637956    118.065199 
[37m[36mINFO[0m[0m 03/25 09:36:28 | 0.499656    0.496310    0.946353    0.726930    0.913387    0.453180    0.413428    0.946353    0.726930    0.502285    0.524390    0.543502    0.551111    4200        35.576471   0.125418    0.635485    120.195085 
[37m[36mINFO[0m[0m 03/25 09:40:35 | 0.552902    0.543701    0.980706    0.768362    1.163065    0.440813    0.431095    0.980706    0.768362    0.567022    0.579268    0.650870    0.620741    4400        37.270588   0.173468    0.637710    119.344175 
[37m[36mINFO[0m[0m 03/25 09:44:42 | 0.585427    0.592335    0.914824    0.715631    1.484232    0.586572    0.586572    0.914824    0.715631    0.538462    0.554878    0.631248    0.635556    4600        38.964706   0.087711    0.641631    118.632635 
[37m[36mINFO[0m[0m 03/25 09:48:48 | 0.558834    0.545715    0.946353    0.725047    1.206885    0.474382    0.445230    0.946353    0.725047    0.532369    0.554878    0.669752    0.637037    4800        40.658824   0.162758    0.627048    120.152330 
[37m[36mINFO[0m[0m 03/25 09:52:56 | 0.571947    0.571415    0.966118    0.709981    1.748042    0.622792    0.604240    0.966118    0.709981    0.497715    0.539634    0.595335    0.570370    5000        42.352941   0.075035    0.648015    118.926684 
[37m[36mINFO[0m[0m 03/25 09:52:56 | Cumulative gradient change saved at train_output/VLCS/ERM/[0, 2, 3]/250325_08-07-30_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 09:52:58 | ---
[37m[36mINFO[0m[0m 03/25 09:52:58 | test-domain validation(oracle) = 69.121%
[37m[36mINFO[0m[0m 03/25 09:52:58 | training-domain validation(iid) = 67.364%
[37m[36mINFO[0m[0m 03/25 09:52:58 | last = 57.195%
[37m[36mINFO[0m[0m 03/25 09:52:58 | last (inD) = 70.998%
[37m[36mINFO[0m[0m 03/25 09:52:58 | training-domain validation (iid, inD) = 76.836%
[37m[36mINFO[0m[0m 03/25 09:52:58 | === Summary ===
[37m[36mINFO[0m[0m 03/25 09:52:58 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 2 3 --dataset VLCS --trial_seed 1 --hparams_seed 8
[37m[36mINFO[0m[0m 03/25 09:52:58 | Unique name: 250325_08-07-30_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 09:52:58 | Out path: train_output/VLCS/ERM/[0, 2, 3]/250325_08-07-30_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 09:52:58 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 09:52:58 | Dataset: VLCS

[37m[36mINFO[0m[0m 01/26 05:47:21 | Command :: /jsm0707/Large-scale/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm ERM --test_envs 0 1 3 --dataset VLCS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_adam.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_adam
	out_dir: train_output/VLCS/ERM/[0, 1, 3]/250126_05-47-21_resnet50_adam
	out_root: train_output/VLCS/ERM/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 0
	unique_name: 250126_05-47-21_resnet50_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 01/26 05:47:21 | n_steps = 5001
[37m[36mINFO[0m[0m 01/26 05:47:21 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/26 05:47:21 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/26 05:47:21 | 
[37m[36mINFO[0m[0m 01/26 05:47:21 | Testenv name escaping te_C_L_V -> te_C_L_V
[37m[36mINFO[0m[0m 01/26 05:47:21 | Test envs = [0, 1, 3], name = te_C_L_V
[37m[36mINFO[0m[0m 01/26 05:47:21 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 01/26 05:47:21 | Batch sizes for each domain: [0, 0, 32, 0] (total=32)
[37m[36mINFO[0m[0m 01/26 05:47:21 | steps-per-epoch for each domain: 82.06 -> min = 82.06
[37m[36mINFO[0m[0m 01/26 05:47:22 | # of params = 23518277
[37m[36mINFO[0m[0m 01/26 05:49:29 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/26 05:49:29 | 0.266543    0.253872    0.454684    0.408537    1.331692    0.085689    0.060071    0.465882    0.448211    0.454684    0.408537    0.248056    0.253333    0           0.000000    1.675835    0.930406    126.426991 
[37m[36mINFO[0m[0m 01/26 05:52:20 | 0.653218    0.649473    0.825590    0.762195    0.630098    0.734982    0.720848    0.583059    0.587571    0.825590    0.762195    0.641614    0.640000    200         2.437167    0.527980    0.237887    122.848357 
[37m[36mINFO[0m[0m 01/26 05:55:18 | 0.682947    0.678176    0.903656    0.798780    0.535429    0.751767    0.742049    0.606588    0.593220    0.903656    0.798780    0.690485    0.699259    400         4.874334    0.334116    0.230721    131.243187 
[37m[36mINFO[0m[0m 01/26 05:58:11 | 0.648595    0.645599    0.897182    0.769817    0.876572    0.740283    0.731449    0.599059    0.587571    0.897182    0.769817    0.606442    0.617778    600         7.311500    0.221643    0.233586    126.304678 
[37m[36mINFO[0m[0m 01/26 06:01:08 | 0.587941    0.609619    0.924219    0.772866    0.632231    0.505300    0.586572    0.564706    0.559322    0.924219    0.772866    0.693817    0.682963    800         9.748667    0.186083    0.235732    130.073487 
[37m[36mINFO[0m[0m 01/26 06:04:02 | 0.700239    0.714698    0.955446    0.775915    1.020678    0.806537    0.826855    0.605176    0.612053    0.955446    0.775915    0.689004    0.705185    1000        12.185834   0.128700    0.236194    126.713989 
[37m[36mINFO[0m[0m 01/26 06:06:53 | 0.623195    0.630141    0.969916    0.803354    1.053882    0.674912    0.678445    0.565647    0.563089    0.969916    0.803354    0.629026    0.648889    1200        14.623001   0.094472    0.231266    124.342953 
[37m[36mINFO[0m[0m 01/26 06:09:44 | 0.691556    0.684065    0.976009    0.786585    0.824915    0.733216    0.734982    0.642824    0.632768    0.976009    0.786585    0.698630    0.684444    1400        17.060168   0.095780    0.233284    124.533672 
[37m[36mINFO[0m[0m 01/26 06:12:36 | 0.696925    0.697438    0.946687    0.778963    0.975652    0.813604    0.802120    0.589647    0.589454    0.946687    0.778963    0.687523    0.700741    1600        19.497334   0.084840    0.230790    125.108833 
[37m[36mINFO[0m[0m 01/26 06:15:27 | 0.548745    0.566175    0.942498    0.750000    1.232895    0.498233    0.554770    0.530824    0.514124    0.942498    0.750000    0.617179    0.629630    1800        21.934501   0.070946    0.229096    125.574070 
[37m[36mINFO[0m[0m 01/26 06:18:22 | 0.642061    0.646449    0.980198    0.785061    1.053148    0.640459    0.660777    0.636706    0.625235    0.980198    0.785061    0.649019    0.653333    2000        24.371668   0.069489    0.236925    127.541804 
[37m[36mINFO[0m[0m 01/26 06:21:18 | 0.549755    0.558249    0.981721    0.785061    1.082916    0.409894    0.399293    0.615529    0.638418    0.981721    0.785061    0.623843    0.637037    2200        26.808835   0.043459    0.235572    129.062799 
[37m[36mINFO[0m[0m 01/26 06:24:11 | 0.545813    0.569866    0.985910    0.795732    1.176478    0.431979    0.477032    0.579765    0.576271    0.985910    0.795732    0.625694    0.656296    2400        29.246002   0.047436    0.231988    126.341666 
[37m[36mINFO[0m[0m 01/26 06:27:02 | 0.631315    0.629175    0.989718    0.798780    1.563180    0.635159    0.632509    0.619765    0.612053    0.989718    0.798780    0.639023    0.642963    2600        31.683168   0.040931    0.231963    124.790437 
[37m[36mINFO[0m[0m 01/26 06:29:55 | 0.667935    0.667989    0.959634    0.759146    1.315575    0.756184    0.756184    0.588235    0.578154    0.959634    0.759146    0.659385    0.669630    2800        34.120335   0.044091    0.232631    125.967390 
[37m[36mINFO[0m[0m 01/26 06:32:46 | 0.698144    0.712884    0.994669    0.783537    1.266793    0.827739    0.823322    0.622118    0.630885    0.994669    0.783537    0.644576    0.684444    3000        36.557502   0.055050    0.229341    125.674527 
[37m[36mINFO[0m[0m 01/26 06:35:37 | 0.558546    0.563988    0.977913    0.771341    0.827880    0.467314    0.480565    0.601882    0.595104    0.977913    0.771341    0.606442    0.616296    3200        38.994669   0.076935    0.231739    124.937866 
[37m[36mINFO[0m[0m 01/26 06:38:27 | 0.585346    0.604906    0.993526    0.777439    1.040965    0.497350    0.537102    0.619294    0.634652    0.993526    0.777439    0.639393    0.642963    3400        41.431835   0.049793    0.229479    123.282655 
[37m[36mINFO[0m[0m 01/26 06:41:23 | 0.588282    0.601188    0.994288    0.797256    0.879133    0.541519    0.565371    0.608000    0.602637    0.994288    0.797256    0.615328    0.635556    3600        43.869002   0.030110    0.241429    128.137435 
[37m[36mINFO[0m[0m 01/26 06:44:17 | 0.633557    0.653645    0.995811    0.794207    1.198497    0.636926    0.664311    0.611765    0.619586    0.995811    0.794207    0.651981    0.677037    3800        46.306169   0.029993    0.237455    126.914364 
[37m[36mINFO[0m[0m 01/26 06:47:11 | 0.581630    0.605574    0.992765    0.791159    1.209856    0.536219    0.590106    0.594824    0.596987    0.992765    0.791159    0.613847    0.629630    4000        48.743336   0.030159    0.231739    127.306340 
[37m[36mINFO[0m[0m 01/26 06:50:06 | 0.615023    0.645878    0.988957    0.789634    1.131245    0.583039    0.625442    0.636706    0.664783    0.988957    0.789634    0.625324    0.647407    4200        51.180503   0.036199    0.236412    127.922928 
[37m[36mINFO[0m[0m 01/26 06:53:04 | 0.589650    0.603928    0.990099    0.778963    1.257634    0.485866    0.508834    0.622588    0.621469    0.990099    0.778963    0.660496    0.681481    4400        53.617669   0.013456    0.234134    131.242569 
[37m[36mINFO[0m[0m 01/26 06:55:57 | 0.647389    0.658657    0.993145    0.785061    1.157787    0.727915    0.756184    0.574118    0.564972    0.993145    0.785061    0.640133    0.654815    4600        56.054836   0.057364    0.233171    126.397366 
[37m[36mINFO[0m[0m 01/26 06:58:53 | 0.566061    0.581316    0.992003    0.795732    1.207886    0.416078    0.452297    0.624941    0.610169    0.992003    0.795732    0.657164    0.681481    4800        58.492003   0.031752    0.233665    129.302179 
[37m[36mINFO[0m[0m 01/26 07:01:47 | 0.674090    0.686358    0.995050    0.782012    1.183580    0.746466    0.773852    0.579765    0.580038    0.995050    0.782012    0.696039    0.705185    5000        60.929170   0.028602    0.232769    127.398821 
[37m[36mINFO[0m[0m 01/26 07:01:48 | Cumulative gradient change saved at train_output/VLCS/ERM/[0, 1, 3]/250126_05-47-21_resnet50_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/26 07:01:49 | ---
[37m[36mINFO[0m[0m 01/26 07:01:49 | test-domain validation(oracle) = 70.024%
[37m[36mINFO[0m[0m 01/26 07:01:49 | training-domain validation(iid) = 62.320%
[37m[36mINFO[0m[0m 01/26 07:01:49 | last = 67.409%
[37m[36mINFO[0m[0m 01/26 07:01:49 | last (inD) = 78.201%
[37m[36mINFO[0m[0m 01/26 07:01:49 | training-domain validation (iid, inD) = 80.335%
[37m[36mINFO[0m[0m 01/26 07:01:49 | === Summary ===
[37m[36mINFO[0m[0m 01/26 07:01:49 | Command: /jsm0707/Large-scale/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm ERM --test_envs 0 1 3 --dataset VLCS
[37m[36mINFO[0m[0m 01/26 07:01:49 | Unique name: 250126_05-47-21_resnet50_adam
[37m[36mINFO[0m[0m 01/26 07:01:49 | Out path: train_output/VLCS/ERM/[0, 1, 3]/250126_05-47-21_resnet50_adam
[37m[36mINFO[0m[0m 01/26 07:01:49 | Algorithm: ERM
[37m[36mINFO[0m[0m 01/26 07:01:49 | Dataset: VLCS

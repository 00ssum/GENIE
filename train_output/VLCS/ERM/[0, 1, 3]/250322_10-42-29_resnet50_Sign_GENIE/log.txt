[37m[36mINFO[0m[0m 03/22 10:42:29 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 3 --dataset VLCS --trial_seed 2 --hparams_seed 0
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[0, 1, 3]/250322_10-42-29_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 2
	unique_name: 250322_10-42-29_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/22 10:42:29 | n_steps = 5001
[37m[36mINFO[0m[0m 03/22 10:42:29 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/22 10:42:29 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/22 10:42:29 | 
[37m[36mINFO[0m[0m 03/22 10:42:29 | Testenv name escaping te_C_L_V -> te_C_L_V
[37m[36mINFO[0m[0m 03/22 10:42:29 | Test envs = [0, 1, 3], name = te_C_L_V
[37m[36mINFO[0m[0m 03/22 10:42:29 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 03/22 10:42:29 | Batch sizes for each domain: [0, 0, 32, 0] (total=32)
[37m[36mINFO[0m[0m 03/22 10:42:29 | steps-per-epoch for each domain: 82.06 -> min = 82.06
[37m[36mINFO[0m[0m 03/22 10:42:30 | # of params = 23518277
[37m[36mINFO[0m[0m 03/22 10:44:35 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/22 10:44:35 | 0.395263    0.402121    0.466870    0.504573    1.067958    0.294170    0.289753    0.464000    0.463277    0.466870    0.504573    0.427619    0.453333    0           0.000000    1.634413    1.043749    123.260117 
[37m[36mINFO[0m[0m 03/22 10:47:30 | 0.690570    0.704251    0.848058    0.804878    0.536220    0.766784    0.777385    0.650353    0.655367    0.848058    0.804878    0.654572    0.680000    200         2.437167    0.534500    0.254911    124.592844 
[37m[36mINFO[0m[0m 03/22 10:50:23 | 0.605572    0.625980    0.879665    0.814024    0.493307    0.599823    0.628975    0.588235    0.604520    0.879665    0.814024    0.628656    0.644444    400         4.874334    0.375295    0.243990    124.467533 
[37m[36mINFO[0m[0m 03/22 10:53:17 | 0.541646    0.564810    0.896420    0.785061    0.557410    0.433746    0.452297    0.551059    0.572505    0.896420    0.785061    0.640133    0.669630    600         7.311500    0.311818    0.249931    123.801468 
[37m[36mINFO[0m[0m 03/22 10:56:14 | 0.646571    0.651274    0.936786    0.818598    0.623835    0.673145    0.653710    0.614588    0.629002    0.936786    0.818598    0.651981    0.671111    800         9.748667    0.234591    0.247981    126.923796 
[37m[36mINFO[0m[0m 03/22 10:59:07 | 0.526318    0.566590    0.960396    0.814024    0.594569    0.318905    0.367491    0.606588    0.647834    0.960396    0.814024    0.653462    0.684444    1000        12.185834   0.196086    0.253421    122.959249 
[37m[36mINFO[0m[0m 03/22 11:02:04 | 0.568667    0.604676    0.958492    0.812500    0.636445    0.415194    0.491166    0.636235    0.638418    0.958492    0.812500    0.654572    0.684444    1200        14.623001   0.147129    0.248444    126.992610 
[37m[36mINFO[0m[0m 03/22 11:04:58 | 0.632740    0.647431    0.912414    0.791159    0.671420    0.622792    0.618375    0.635294    0.657250    0.912414    0.791159    0.640133    0.666667    1400        17.060168   0.175445    0.246921    124.829762 
[37m[36mINFO[0m[0m 03/22 11:07:52 | 0.482701    0.515585    0.967251    0.800305    0.744521    0.276502    0.339223    0.552941    0.563089    0.967251    0.800305    0.618660    0.644444    1600        19.497334   0.148915    0.243388    124.932491 
[37m[36mINFO[0m[0m 03/22 11:10:43 | 0.579158    0.596798    0.965727    0.774390    1.006083    0.533569    0.533569    0.558588    0.564972    0.965727    0.774390    0.645317    0.691852    1800        21.934501   0.067191    0.239295    123.596455 
[37m[36mINFO[0m[0m 03/22 11:13:35 | 0.560405    0.584770    0.972963    0.791159    0.672702    0.432862    0.469965    0.621176    0.638418    0.972963    0.791159    0.627175    0.645926    2000        24.371668   0.074236    0.247432    122.002967 
[37m[36mINFO[0m[0m 03/22 11:16:31 | 0.673217    0.667879    0.978675    0.803354    1.210853    0.720848    0.681979    0.621647    0.632768    0.978675    0.803354    0.677157    0.688889    2200        26.808835   0.064644    0.247494    126.928468 
[37m[36mINFO[0m[0m 03/22 11:19:25 | 0.525114    0.551196    0.987053    0.824695    1.049047    0.394876    0.434629    0.568471    0.581921    0.987053    0.824695    0.611996    0.637037    2400        29.246002   0.035991    0.252196    123.520523 
[37m[36mINFO[0m[0m 03/22 11:22:19 | 0.659832    0.660425    0.983244    0.803354    1.000966    0.707597    0.689046    0.578824    0.578154    0.983244    0.803354    0.693077    0.714074    2600        31.683168   0.048310    0.237064    126.260301 
[37m[36mINFO[0m[0m 03/22 11:25:13 | 0.529576    0.547399    0.982483    0.817073    1.045205    0.384276    0.416961    0.602824    0.625235    0.982483    0.817073    0.601629    0.600000    2800        34.120335   0.052823    0.241612    125.923614 
[37m[36mINFO[0m[0m 03/22 11:28:13 | 0.532520    0.544538    0.974105    0.789634    1.091881    0.412544    0.427562    0.563765    0.563089    0.974105    0.789634    0.621251    0.642963    3000        36.557502   0.046238    0.265877    126.474345 
[37m[36mINFO[0m[0m 03/22 11:31:10 | 0.470443    0.498900    0.976009    0.801829    1.027648    0.276502    0.332155    0.568000    0.583804    0.976009    0.801829    0.566827    0.580741    3200        38.994669   0.050434    0.271675    122.773580 
[37m[36mINFO[0m[0m 03/22 11:34:10 | 0.605500    0.641146    0.997715    0.820122    1.193723    0.564488    0.628975    0.601882    0.623352    0.997715    0.820122    0.650130    0.671111    3400        41.431835   0.038630    0.278908    124.031840 
[37m[36mINFO[0m[0m 03/22 11:37:07 | 0.533140    0.555051    0.987433    0.807927    1.212649    0.362191    0.388693    0.581176    0.587571    0.987433    0.807927    0.656053    0.688889    3600        43.869002   0.035685    0.259777    125.215620 
[37m[36mINFO[0m[0m 03/22 11:40:01 | 0.622050    0.651058    0.991241    0.806402    1.421921    0.556537    0.600707    0.642824    0.659134    0.991241    0.806402    0.666790    0.693333    3800        46.306169   0.029471    0.252433    123.467131 
[37m[36mINFO[0m[0m 03/22 11:43:00 | 0.562652    0.595401    0.996573    0.807927    1.225802    0.428445    0.480565    0.607529    0.627119    0.996573    0.807927    0.651981    0.678519    4000        48.743336   0.016138    0.254813    127.934202 
[37m[36mINFO[0m[0m 03/22 11:46:01 | 0.589274    0.625604    0.993145    0.829268    1.096317    0.535336    0.614841    0.630118    0.651601    0.993145    0.829268    0.602369    0.610370    4200        51.180503   0.026062    0.283166    124.133573 
[37m[36mINFO[0m[0m 03/22 11:49:00 | 0.604139    0.629617    0.987433    0.804878    1.278277    0.535336    0.558304    0.606588    0.632768    0.987433    0.804878    0.670492    0.697778    4400        53.617669   0.026431    0.283969    122.942449 
[37m[36mINFO[0m[0m 03/22 11:51:59 | 0.590234    0.610313    0.988957    0.798780    1.248316    0.557420    0.600707    0.593882    0.613936    0.988957    0.798780    0.619400    0.616296    4600        56.054836   0.032468    0.259393    127.170990 
[37m[36mINFO[0m[0m 03/22 11:54:55 | 0.620149    0.632467    0.993907    0.797256    1.203667    0.633392    0.653710    0.615059    0.621469    0.993907    0.797256    0.611996    0.622222    4800        58.492003   0.022310    0.254008    124.431243 
[37m[36mINFO[0m[0m 03/22 11:57:48 | 0.621123    0.644856    0.990861    0.817073    1.434805    0.580389    0.600707    0.649882    0.676083    0.990861    0.817073    0.633099    0.657778    5000        60.929170   0.017084    0.235328    126.431785 
[37m[36mINFO[0m[0m 03/22 11:57:48 | Cumulative gradient change saved at train_output/VLCS/ERM/[0, 1, 3]/250322_10-42-29_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/22 11:57:50 | ---
[37m[36mINFO[0m[0m 03/22 11:57:50 | test-domain validation(oracle) = 69.057%
[37m[36mINFO[0m[0m 03/22 11:57:50 | training-domain validation(iid) = 58.927%
[37m[36mINFO[0m[0m 03/22 11:57:50 | last = 62.112%
[37m[36mINFO[0m[0m 03/22 11:57:50 | last (inD) = 81.707%
[37m[36mINFO[0m[0m 03/22 11:57:50 | training-domain validation (iid, inD) = 82.927%
[37m[36mINFO[0m[0m 03/22 11:57:50 | === Summary ===
[37m[36mINFO[0m[0m 03/22 11:57:50 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 3 --dataset VLCS --trial_seed 2 --hparams_seed 0
[37m[36mINFO[0m[0m 03/22 11:57:50 | Unique name: 250322_10-42-29_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/22 11:57:50 | Out path: train_output/VLCS/ERM/[0, 1, 3]/250322_10-42-29_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/22 11:57:50 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/22 11:57:50 | Dataset: VLCS

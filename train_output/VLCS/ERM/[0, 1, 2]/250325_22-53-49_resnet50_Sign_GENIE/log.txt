[37m[36mINFO[0m[0m 03/25 22:53:49 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset VLCS --trial_seed 1 --hparams_seed 2
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 2
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[0, 1, 2]/250325_22-53-49_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 1
	unique_name: 250325_22-53-49_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.0001126313085293539
	batch_size: 38
	weight_decay: 0.006639128805224463
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/25 22:53:49 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 22:53:49 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 22:53:49 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 22:53:49 | 
[37m[36mINFO[0m[0m 03/25 22:53:49 | Testenv name escaping te_C_L_S -> te_C_L_S
[37m[36mINFO[0m[0m 03/25 22:53:49 | Test envs = [0, 1, 2], name = te_C_L_S
[37m[36mINFO[0m[0m 03/25 22:53:49 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 03/25 22:53:49 | Batch sizes for each domain: [0, 0, 0, 38] (total=38)
[37m[36mINFO[0m[0m 03/25 22:53:49 | steps-per-epoch for each domain: 71.08 -> min = 71.08
[37m[36mINFO[0m[0m 03/25 22:53:50 | # of params = 23518277
[37m[36mINFO[0m[0m 03/25 22:55:55 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 22:55:55 | 0.486054    0.499658    0.453165    0.405926    1.381484    0.613958    0.618375    0.466824    0.461394    0.377380    0.419207    0.453165    0.405926    0           0.000000    1.834396    1.103489    124.057069 
[37m[36mINFO[0m[0m 03/25 22:58:42 | 0.772040    0.772338    0.891151    0.838519    0.492396    0.988516    0.971731    0.585412    0.580038    0.742193    0.765244    0.891151    0.838519    200         2.813773    0.500491    0.207284    125.843093 
[37m[36mINFO[0m[0m 03/25 23:01:32 | 0.782196    0.785038    0.883006    0.822222    0.567111    0.992049    0.978799    0.668706    0.662900    0.685834    0.713415    0.883006    0.822222    400         5.627545    0.298733    0.204341    128.248691 
[37m[36mINFO[0m[0m 03/25 23:04:18 | 0.753949    0.750302    0.921881    0.829630    0.539671    0.977032    0.961131    0.572706    0.568738    0.712110    0.721037    0.921881    0.829630    600         8.441318    0.243666    0.201601    125.724236 
[37m[36mINFO[0m[0m 03/25 23:07:07 | 0.784717    0.783291    0.960755    0.848889    0.502757    0.991166    0.975265    0.613176    0.613936    0.749810    0.760671    0.960755    0.848889    800         11.255091   0.176966    0.201187    129.386994 
[37m[36mINFO[0m[0m 03/25 23:09:55 | 0.772321    0.776021    0.951129    0.823704    0.615087    0.992049    0.982332    0.579294    0.574388    0.745621    0.771341    0.951129    0.823704    1000        14.068863   0.151741    0.207680    125.914505 
[37m[36mINFO[0m[0m 03/25 23:12:41 | 0.798277    0.798577    0.974824    0.848889    0.557535    0.984099    0.978799    0.641882    0.644068    0.768850    0.772866    0.974824    0.848889    1200        16.882636   0.134117    0.203209    126.136790 
[37m[36mINFO[0m[0m 03/25 23:15:27 | 0.748193    0.749948    0.964828    0.828148    0.665258    0.980565    0.971731    0.535529    0.523540    0.728484    0.754573    0.964828    0.828148    1400        19.696409   0.104456    0.203342    125.230801 
[37m[36mINFO[0m[0m 03/25 23:18:15 | 0.771335    0.769635    0.984450    0.828148    0.783720    0.979682    0.968198    0.580706    0.580038    0.753618    0.760671    0.984450    0.828148    1600        22.510181   0.093188    0.211158    125.396190 
[37m[36mINFO[0m[0m 03/25 23:21:04 | 0.768170    0.765588    0.979267    0.834074    0.669882    0.984099    0.964664    0.573647    0.566855    0.746763    0.765244    0.979267    0.834074    1800        25.323954   0.108328    0.207185    127.608880 
[37m[36mINFO[0m[0m 03/25 23:23:48 | 0.734146    0.728189    0.942614    0.800000    0.691352    0.982332    0.971731    0.528941    0.532957    0.691165    0.679878    0.942614    0.800000    2000        28.137727   0.113654    0.204647    123.040558 
[37m[36mINFO[0m[0m 03/25 23:26:34 | 0.767609    0.774897    0.982599    0.823704    0.741574    0.973498    0.968198    0.584471    0.598870    0.744859    0.757622    0.982599    0.823704    2200        30.951499   0.101368    0.201894    125.691750 
[37m[36mINFO[0m[0m 03/25 23:29:21 | 0.782925    0.794572    0.981488    0.834074    0.624672    0.978799    0.978799    0.617882    0.629002    0.752094    0.775915    0.981488    0.834074    2400        33.765272   0.066039    0.205335    125.919677 
[37m[36mINFO[0m[0m 03/25 23:32:07 | 0.768593    0.765337    0.991855    0.826667    0.801308    0.987633    0.978799    0.571765    0.568738    0.746382    0.748476    0.991855    0.826667    2600        36.579045   0.063741    0.204230    124.919296 
[37m[36mINFO[0m[0m 03/25 23:35:00 | 0.768682    0.768459    0.984080    0.813333    0.627373    0.986749    0.982332    0.587765    0.591337    0.731531    0.731707    0.984080    0.813333    2800        39.392817   0.063249    0.227962    127.786408 
[37m[36mINFO[0m[0m 03/25 23:37:44 | 0.760957    0.757973    0.954091    0.797037    0.748382    0.969081    0.957597    0.602824    0.612053    0.710967    0.704268    0.954091    0.797037    3000        42.206590   0.096075    0.211267    121.974432 
[37m[36mINFO[0m[0m 03/25 23:40:31 | 0.797814    0.790811    0.980748    0.816296    0.999761    0.975265    0.954064    0.664941    0.651601    0.753237    0.766768    0.980748    0.816296    3200        45.020363   0.079931    0.202337    126.566275 
[37m[36mINFO[0m[0m 03/25 23:43:20 | 0.759754    0.756752    0.960385    0.777778    0.904812    0.954947    0.950530    0.590118    0.581921    0.734196    0.737805    0.960385    0.777778    3400        47.834136   0.096380    0.203626    128.151691 
[37m[36mINFO[0m[0m 03/25 23:46:04 | 0.754495    0.750787    0.981118    0.794074    0.845014    0.975265    0.971731    0.574588    0.568738    0.713633    0.711890    0.981118    0.794074    3600        50.647908   0.097482    0.202098    123.025002 
[37m[36mINFO[0m[0m 03/25 23:48:46 | 0.764109    0.749780    0.942614    0.774815    1.019060    0.954064    0.922261    0.577412    0.572505    0.760853    0.754573    0.942614    0.774815    3800        53.461681   0.102216    0.201494    122.362041 
[37m[36mINFO[0m[0m 03/25 23:51:38 | 0.761391    0.771843    0.953351    0.773333    0.844268    0.977915    0.975265    0.587294    0.617702    0.718964    0.722561    0.953351    0.773333    4000        56.275454   0.074238    0.225606    126.190500 
[37m[36mINFO[0m[0m 03/25 23:54:25 | 0.749227    0.744993    0.981118    0.791111    0.904391    0.970848    0.964664    0.554824    0.538606    0.722011    0.731707    0.981118    0.791111    4200        59.089226   0.120304    0.211216    124.682035 
[37m[36mINFO[0m[0m 03/25 23:57:13 | 0.756802    0.756323    0.950759    0.777778    0.909799    0.976148    0.964664    0.604235    0.596987    0.690023    0.707317    0.950759    0.777778    4400        61.902999   0.142805    0.201566    128.240014 
[37m[36mINFO[0m[0m 03/26 00:00:01 | 0.745813    0.743618    0.988523    0.788148    0.797076    0.977032    0.964664    0.534588    0.532957    0.725819    0.733232    0.988523    0.788148    4600        64.716772   0.070994    0.202358    127.286186 
[37m[36mINFO[0m[0m 03/26 00:02:48 | 0.750443    0.751462    0.972233    0.791111    0.780248    0.977915    0.968198    0.570824    0.581921    0.702589    0.704268    0.972233    0.791111    4800        67.530544   0.112691    0.205443    125.431097 
[37m[36mINFO[0m[0m 03/26 00:05:35 | 0.746707    0.750379    0.978156    0.797037    0.898653    0.976148    0.957597    0.547294    0.540490    0.716679    0.753049    0.978156    0.797037    5000        70.344317   0.088505    0.203579    126.746203 
[37m[36mINFO[0m[0m 03/26 00:05:35 | Cumulative gradient change saved at train_output/VLCS/ERM/[0, 1, 2]/250325_22-53-49_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 00:05:36 | ---
[37m[36mINFO[0m[0m 03/26 00:05:36 | test-domain validation(oracle) = 79.828%
[37m[36mINFO[0m[0m 03/26 00:05:36 | training-domain validation(iid) = 78.472%
[37m[36mINFO[0m[0m 03/26 00:05:36 | last = 74.671%
[37m[36mINFO[0m[0m 03/26 00:05:36 | last (inD) = 79.704%
[37m[36mINFO[0m[0m 03/26 00:05:36 | training-domain validation (iid, inD) = 84.889%
[37m[36mINFO[0m[0m 03/26 00:05:36 | === Summary ===
[37m[36mINFO[0m[0m 03/26 00:05:36 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset VLCS --trial_seed 1 --hparams_seed 2
[37m[36mINFO[0m[0m 03/26 00:05:36 | Unique name: 250325_22-53-49_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 00:05:36 | Out path: train_output/VLCS/ERM/[0, 1, 2]/250325_22-53-49_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 00:05:36 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 00:05:36 | Dataset: VLCS

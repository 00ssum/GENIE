[37m[36mINFO[0m[0m 03/26 01:12:42 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset VLCS --trial_seed 1 --hparams_seed 4
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 4
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[0, 1, 2]/250326_01-12-42_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 1
	unique_name: 250326_01-12-42_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 7.71168362195819e-05
	batch_size: 8
	weight_decay: 0.0007466379205516084
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/26 01:12:42 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 01:12:42 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 01:12:42 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 01:12:42 | 
[37m[36mINFO[0m[0m 03/26 01:12:42 | Testenv name escaping te_C_L_S -> te_C_L_S
[37m[36mINFO[0m[0m 03/26 01:12:42 | Test envs = [0, 1, 2], name = te_C_L_S
[37m[36mINFO[0m[0m 03/26 01:12:42 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 03/26 01:12:42 | Batch sizes for each domain: [0, 0, 0, 8] (total=8)
[37m[36mINFO[0m[0m 03/26 01:12:42 | steps-per-epoch for each domain: 337.62 -> min = 337.62
[37m[36mINFO[0m[0m 03/26 01:12:43 | # of params = 23518277
[37m[36mINFO[0m[0m 03/26 01:14:51 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 01:14:51 | 0.023503    0.027628    0.123288    0.128889    1.889068    0.043286    0.063604    0.016941    0.013183    0.010282    0.006098    0.123288    0.128889    0           0.000000    1.806861    1.194260    126.510908 
[37m[36mINFO[0m[0m 03/26 01:17:27 | 0.714022    0.717480    0.723066    0.712593    0.837830    0.925795    0.908127    0.572706    0.578154    0.643564    0.666159    0.723066    0.712593    200         0.592373    0.914277    0.149881    126.420736 
[37m[36mINFO[0m[0m 03/26 01:20:07 | 0.679785    0.683442    0.718993    0.691852    0.884591    0.907244    0.901060    0.630588    0.623352    0.501523    0.525915    0.718993    0.691852    400         1.184746    0.835183    0.166594    126.719642 
[37m[36mINFO[0m[0m 03/26 01:22:41 | 0.733708    0.742678    0.831544    0.780741    0.772225    0.922261    0.925795    0.585412    0.578154    0.693450    0.724085    0.831544    0.780741    600         1.777120    0.771075    0.134788    126.691651 
[37m[36mINFO[0m[0m 03/26 01:25:13 | 0.711537    0.709864    0.818215    0.785185    0.645484    0.947880    0.936396    0.533647    0.517891    0.653085    0.675305    0.818215    0.785185    800         2.369493    0.659501    0.115027    128.769227 
[37m[36mINFO[0m[0m 03/26 01:27:47 | 0.744140    0.747592    0.802295    0.768889    0.681890    0.935512    0.929329    0.564235    0.564972    0.732673    0.748476    0.802295    0.768889    1000        2.961866    0.570477    0.138013    126.316007 
[37m[36mINFO[0m[0m 03/26 01:30:21 | 0.657857    0.657502    0.761570    0.722963    0.825443    0.922261    0.911661    0.562353    0.559322    0.488957    0.501524    0.761570    0.722963    1200        3.554239    0.618253    0.141801    126.090345 
[37m[36mINFO[0m[0m 03/26 01:32:54 | 0.661406    0.657424    0.726398    0.697778    0.829370    0.958481    0.950530    0.468235    0.482109    0.557502    0.539634    0.726398    0.697778    1400        4.146612    0.535503    0.121071    128.470929 
[37m[36mINFO[0m[0m 03/26 01:35:28 | 0.741146    0.749998    0.817105    0.764444    0.662708    0.926678    0.932862    0.643294    0.640301    0.653465    0.676829    0.817105    0.764444    1600        4.738986    0.481493    0.136796    126.795066 
[37m[36mINFO[0m[0m 03/26 01:37:56 | 0.765687    0.753894    0.859682    0.795556    0.596776    0.948763    0.936396    0.632000    0.595104    0.716299    0.730183    0.859682    0.795556    1800        5.331359    0.567082    0.116889    124.762761 
[37m[36mINFO[0m[0m 03/26 01:40:29 | 0.755516    0.764095    0.836727    0.757037    0.686140    0.960247    0.946996    0.641412    0.644068    0.664890    0.701220    0.836727    0.757037    2000        5.923732    0.505775    0.136935    125.714640 
[37m[36mINFO[0m[0m 03/26 01:43:15 | 0.739044    0.727810    0.814143    0.746667    0.706128    0.916078    0.904594    0.625882    0.591337    0.675171    0.687500    0.814143    0.746667    2200        6.516105    0.451713    0.199386    126.182617 
[37m[36mINFO[0m[0m 03/26 01:45:45 | 0.767663    0.764727    0.877453    0.785185    0.595956    0.969965    0.939929    0.635765    0.627119    0.697258    0.727134    0.877453    0.785185    2400        7.108478    0.432674    0.116356    126.264988 
[37m[36mINFO[0m[0m 03/26 01:48:17 | 0.743225    0.743014    0.851907    0.765926    0.750436    0.945230    0.936396    0.596706    0.583804    0.687738    0.708841    0.851907    0.765926    2600        7.700852    0.423304    0.134043    125.559609 
[37m[36mINFO[0m[0m 03/26 01:50:48 | 0.732491    0.747923    0.803406    0.734815    0.724761    0.903710    0.911661    0.655529    0.662900    0.638233    0.669207    0.803406    0.734815    2800        8.293225    0.549076    0.126262    125.947391 
[37m[36mINFO[0m[0m 03/26 01:53:39 | 0.760705    0.755264    0.888560    0.805926    0.601670    0.970848    0.943463    0.623529    0.619586    0.687738    0.702744    0.888560    0.805926    3000        8.885598    0.434734    0.204681    129.886801 
[37m[36mINFO[0m[0m 03/26 01:56:14 | 0.713928    0.704334    0.867456    0.748148    0.681348    0.953180    0.936396    0.511529    0.502825    0.677075    0.673780    0.867456    0.748148    3200        9.477971    0.357410    0.137437    126.952292 
[37m[36mINFO[0m[0m 03/26 01:58:44 | 0.717518    0.719442    0.872640    0.786667    0.719140    0.954064    0.957597    0.529412    0.525424    0.669078    0.675305    0.872640    0.786667    3400        10.070344   0.387809    0.113866    127.544270 
[37m[36mINFO[0m[0m 03/26 02:01:15 | 0.751534    0.750747    0.853388    0.761481    0.911778    0.901943    0.890459    0.608941    0.602637    0.743717    0.759146    0.853388    0.761481    3600        10.662718   0.427856    0.132456    124.500567 
[37m[36mINFO[0m[0m 03/26 02:04:06 | 0.738958    0.737414    0.877453    0.788148    0.822500    0.984099    0.968198    0.561412    0.568738    0.671363    0.675305    0.877453    0.788148    3800        11.255091   0.326383    0.235227    124.379071 
[37m[36mINFO[0m[0m 03/26 02:06:36 | 0.765266    0.772356    0.915217    0.786667    0.617960    0.964664    0.950530    0.617882    0.619586    0.713252    0.746951    0.915217    0.786667    4000        11.847464   0.352336    0.118374    126.240905 
[37m[36mINFO[0m[0m 03/26 02:09:11 | 0.712549    0.713216    0.896335    0.785185    0.732769    0.890459    0.893993    0.525176    0.529190    0.722011    0.716463    0.896335    0.785185    4200        12.439837   0.318980    0.133021    127.713002 
[37m[36mINFO[0m[0m 03/26 02:11:45 | 0.749003    0.759739    0.891522    0.776296    0.721511    0.905477    0.897527    0.624471    0.627119    0.717060    0.754573    0.891522    0.776296    4400        13.032210   0.329132    0.133443    127.285849 
[37m[36mINFO[0m[0m 03/26 02:14:33 | 0.757258    0.754988    0.925953    0.800000    0.703251    0.970848    0.950530    0.587294    0.578154    0.713633    0.736280    0.925953    0.800000    4600        13.624583   0.352222    0.215306    125.664383 
[37m[36mINFO[0m[0m 03/26 02:17:12 | 0.703588    0.703540    0.864495    0.760000    0.813297    0.924912    0.922261    0.576941    0.572505    0.608911    0.615854    0.864495    0.760000    4800        14.216957   0.303983    0.154345    127.886800 
[37m[36mINFO[0m[0m 03/26 02:19:40 | 0.760552    0.754522    0.909293    0.789630    0.704693    0.964664    0.936396    0.597647    0.596987    0.719345    0.730183    0.909293    0.789630    5000        14.809330   0.273055    0.110423    125.866960 
[37m[36mINFO[0m[0m 03/26 02:19:40 | Cumulative gradient change saved at train_output/VLCS/ERM/[0, 1, 2]/250326_01-12-42_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 02:19:41 | ---
[37m[36mINFO[0m[0m 03/26 02:19:41 | test-domain validation(oracle) = 76.527%
[37m[36mINFO[0m[0m 03/26 02:19:41 | training-domain validation(iid) = 76.071%
[37m[36mINFO[0m[0m 03/26 02:19:41 | last = 76.055%
[37m[36mINFO[0m[0m 03/26 02:19:41 | last (inD) = 78.963%
[37m[36mINFO[0m[0m 03/26 02:19:41 | training-domain validation (iid, inD) = 80.593%
[37m[36mINFO[0m[0m 03/26 02:19:41 | === Summary ===
[37m[36mINFO[0m[0m 03/26 02:19:41 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset VLCS --trial_seed 1 --hparams_seed 4
[37m[36mINFO[0m[0m 03/26 02:19:41 | Unique name: 250326_01-12-42_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 02:19:41 | Out path: train_output/VLCS/ERM/[0, 1, 2]/250326_01-12-42_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 02:19:41 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 02:19:41 | Dataset: VLCS

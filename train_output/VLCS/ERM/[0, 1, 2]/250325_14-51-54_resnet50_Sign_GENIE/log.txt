[37m[36mINFO[0m[0m 03/25 14:51:54 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset VLCS --trial_seed 0 --hparams_seed 16
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 16
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[0, 1, 2]/250325_14-51-54_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 0
	unique_name: 250325_14-51-54_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 4.249952708249365e-05
	batch_size: 17
	weight_decay: 9.786966598736845e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/25 14:51:54 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 14:51:54 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 14:51:54 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 14:51:54 | 
[37m[36mINFO[0m[0m 03/25 14:51:54 | Testenv name escaping te_C_L_S -> te_C_L_S
[37m[36mINFO[0m[0m 03/25 14:51:54 | Test envs = [0, 1, 2], name = te_C_L_S
[37m[36mINFO[0m[0m 03/25 14:51:54 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 03/25 14:51:54 | Batch sizes for each domain: [0, 0, 0, 17] (total=17)
[37m[36mINFO[0m[0m 03/25 14:51:54 | steps-per-epoch for each domain: 158.88 -> min = 158.88
[37m[36mINFO[0m[0m 03/25 14:51:55 | # of params = 23518277
[37m[36mINFO[0m[0m 03/25 14:54:13 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 14:54:13 | 0.487895    0.506511    0.446501    0.451852    1.537416    0.611307    0.628975    0.459765    0.489642    0.392612    0.400915    0.446501    0.451852    0           0.000000    1.679284    1.108994    137.057226 
[37m[36mINFO[0m[0m 03/25 14:57:00 | 0.762749    0.755976    0.842651    0.805926    0.494550    0.986749    0.985866    0.554353    0.544256    0.747144    0.737805    0.842651    0.805926    200         1.258793    0.638568    0.139987    138.311259 
[37m[36mINFO[0m[0m 03/25 14:59:37 | 0.745360    0.734901    0.865605    0.814815    0.579683    0.956714    0.950530    0.558118    0.549906    0.721249    0.704268    0.865605    0.814815    400         2.517586    0.415110    0.119504    133.347745 
[37m[36mINFO[0m[0m 03/25 15:02:12 | 0.759851    0.750237    0.836357    0.801481    0.584271    0.973498    0.968198    0.580235    0.570621    0.725819    0.711890    0.836357    0.801481    600         3.776379    0.387189    0.133263    128.812650 
[37m[36mINFO[0m[0m 03/25 15:05:07 | 0.770354    0.753052    0.904480    0.842963    0.493729    0.981449    0.961131    0.568000    0.580038    0.761615    0.717988    0.904480    0.842963    800         5.035172    0.306849    0.187717    137.073680 
[37m[36mINFO[0m[0m 03/25 15:07:52 | 0.727833    0.706278    0.909663    0.807407    0.532288    0.961131    0.954064    0.530824    0.504708    0.691546    0.660061    0.909663    0.807407    1000        6.293965    0.315537    0.123743    139.993813 
[37m[36mINFO[0m[0m 03/25 15:10:34 | 0.756743    0.753361    0.921881    0.834074    0.527342    0.939046    0.929329    0.572235    0.583804    0.758949    0.746951    0.921881    0.834074    1200        7.552758    0.262989    0.126225    137.100522 
[37m[36mINFO[0m[0m 03/25 15:13:18 | 0.762996    0.755749    0.897445    0.810370    0.674273    0.958481    0.936396    0.614588    0.640301    0.715918    0.690549    0.897445    0.810370    1400        8.811551    0.269713    0.139615    135.617167 
[37m[36mINFO[0m[0m 03/25 15:16:17 | 0.764158    0.750296    0.928915    0.823704    0.586021    0.967314    0.950530    0.574588    0.576271    0.750571    0.724085    0.928915    0.823704    1600        10.070344   0.291556    0.186288    141.879741 
[37m[36mINFO[0m[0m 03/25 15:19:03 | 0.771420    0.765929    0.941503    0.823704    0.636610    0.956714    0.950530    0.622588    0.606403    0.734958    0.740854    0.941503    0.823704    1800        11.329137   0.194139    0.138961    138.482961 
[37m[36mINFO[0m[0m 03/25 15:21:51 | 0.765390    0.750529    0.956683    0.826667    0.648330    0.971731    0.957597    0.562824    0.566855    0.761615    0.727134    0.956683    0.826667    2000        12.587930   0.165605    0.140349    139.313840 
[37m[36mINFO[0m[0m 03/25 15:24:33 | 0.755297    0.750529    0.961866    0.840000    0.573649    0.980565    0.957597    0.561412    0.566855    0.723915    0.727134    0.961866    0.840000    2200        13.846723   0.135965    0.127861    137.396812 
[37m[36mINFO[0m[0m 03/25 15:27:06 | 0.782078    0.771353    0.942984    0.854815    0.774092    0.964664    0.954064    0.652706    0.657250    0.728865    0.702744    0.942984    0.854815    2400        15.105516   0.121223    0.139871    124.317811 
[37m[36mINFO[0m[0m 03/25 15:29:51 | 0.753177    0.732785    0.970381    0.823704    0.745511    0.972615    0.943463    0.555765    0.553672    0.731150    0.701220    0.970381    0.823704    2600        16.364310   0.121090    0.195185    126.501270 
[37m[36mINFO[0m[0m 03/25 15:32:20 | 0.755774    0.747977    0.958904    0.819259    0.804255    0.979682    0.971731    0.575529    0.572505    0.712110    0.699695    0.958904    0.819259    2800        17.623103   0.129697    0.127249    122.980375 
[37m[36mINFO[0m[0m 03/25 15:34:53 | 0.718571    0.700584    0.848575    0.752593    1.026257    0.931979    0.915194    0.528000    0.499058    0.695735    0.687500    0.848575    0.752593    3000        18.881896   0.109065    0.139186    125.904507 
[37m[36mINFO[0m[0m 03/25 15:37:27 | 0.752865    0.749661    0.971492    0.829630    0.590165    0.954064    0.939929    0.580235    0.581921    0.724296    0.727134    0.971492    0.829630    3200        20.140689   0.136393    0.144648    124.624292 
[37m[36mINFO[0m[0m 03/25 15:40:03 | 0.763888    0.758309    0.950389    0.831111    0.661466    0.970848    0.968198    0.637647    0.649718    0.683168    0.657012    0.950389    0.831111    3400        21.399482   0.114668    0.167483    122.483251 
[37m[36mINFO[0m[0m 03/25 15:42:38 | 0.761355    0.756108    0.981488    0.820741    0.745057    0.976148    0.971731    0.592000    0.604520    0.715918    0.692073    0.981488    0.820741    3600        22.658275   0.108580    0.139541    127.076138 
[37m[36mINFO[0m[0m 03/25 15:45:10 | 0.747017    0.745579    0.955202    0.783704    0.926532    0.960247    0.961131    0.565647    0.574388    0.715156    0.701220    0.955202    0.783704    3800        23.917068   0.078286    0.121839    127.945467 
[37m[36mINFO[0m[0m 03/25 15:47:41 | 0.773845    0.758450    0.953721    0.808889    0.776871    0.947880    0.939929    0.629176    0.608286    0.744478    0.727134    0.953721    0.808889    4000        25.175861   0.086324    0.135920    123.652367 
[37m[36mINFO[0m[0m 03/25 15:50:13 | 0.767186    0.763102    0.971492    0.814815    0.696860    0.976148    0.971731    0.585882    0.602637    0.739528    0.714939    0.971492    0.814815    4200        26.434654   0.174897    0.140992    123.605595 
[37m[36mINFO[0m[0m 03/25 15:52:48 | 0.765063    0.765188    0.982229    0.822222    0.857181    0.961131    0.961131    0.587294    0.595104    0.746763    0.739329    0.982229    0.822222    4400        27.693447   0.072225    0.145294    125.924810 
[37m[36mINFO[0m[0m 03/25 15:55:24 | 0.759475    0.762796    0.977416    0.813333    1.041233    0.925795    0.943463    0.594824    0.610169    0.757807    0.734756    0.977416    0.813333    4600        28.952240   0.080132    0.138015    128.813664 
[37m[36mINFO[0m[0m 03/25 15:57:54 | 0.736723    0.736923    0.983710    0.811852    0.933469    0.948763    0.946996    0.571765    0.576271    0.689642    0.687500    0.983710    0.811852    4800        30.211033   0.038988    0.127200    123.768934 
[37m[36mINFO[0m[0m 03/25 16:00:34 | 0.762453    0.757662    0.983340    0.816296    0.850190    0.980565    0.971731    0.582118    0.596987    0.724676    0.704268    0.983340    0.816296    5000        31.469826   0.094718    0.156581    128.908543 
[37m[36mINFO[0m[0m 03/25 16:00:34 | Cumulative gradient change saved at train_output/VLCS/ERM/[0, 1, 2]/250325_14-51-54_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 16:00:35 | ---
[37m[36mINFO[0m[0m 03/25 16:00:35 | test-domain validation(oracle) = 78.208%
[37m[36mINFO[0m[0m 03/25 16:00:35 | training-domain validation(iid) = 78.208%
[37m[36mINFO[0m[0m 03/25 16:00:35 | last = 76.245%
[37m[36mINFO[0m[0m 03/25 16:00:35 | last (inD) = 81.630%
[37m[36mINFO[0m[0m 03/25 16:00:35 | training-domain validation (iid, inD) = 85.481%
[37m[36mINFO[0m[0m 03/25 16:00:35 | === Summary ===
[37m[36mINFO[0m[0m 03/25 16:00:35 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset VLCS --trial_seed 0 --hparams_seed 16
[37m[36mINFO[0m[0m 03/25 16:00:35 | Unique name: 250325_14-51-54_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 16:00:35 | Out path: train_output/VLCS/ERM/[0, 1, 2]/250325_14-51-54_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 16:00:35 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 16:00:35 | Dataset: VLCS

[37m[36mINFO[0m[0m 03/26 06:51:41 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset VLCS --trial_seed 1 --hparams_seed 9
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 9
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[0, 1, 2]/250326_06-51-41_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 1
	unique_name: 250326_06-51-41_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.7532223448653515e-05
	batch_size: 36
	weight_decay: 0.007511403320794324
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/26 06:51:41 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 06:51:41 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 06:51:41 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 06:51:41 | 
[37m[36mINFO[0m[0m 03/26 06:51:41 | Testenv name escaping te_C_L_S -> te_C_L_S
[37m[36mINFO[0m[0m 03/26 06:51:41 | Test envs = [0, 1, 2], name = te_C_L_S
[37m[36mINFO[0m[0m 03/26 06:51:41 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 03/26 06:51:41 | Batch sizes for each domain: [0, 0, 0, 36] (total=36)
[37m[36mINFO[0m[0m 03/26 06:51:41 | steps-per-epoch for each domain: 75.03 -> min = 75.03
[37m[36mINFO[0m[0m 03/26 06:51:42 | # of params = 23518277
[37m[36mINFO[0m[0m 03/26 06:53:45 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 06:53:45 | 0.485927    0.499658    0.453536    0.407407    1.388768    0.613958    0.618375    0.466824    0.461394    0.376999    0.419207    0.453536    0.407407    0           0.000000    1.854571    1.213981    121.910236 
[37m[36mINFO[0m[0m 03/26 06:56:27 | 0.781953    0.774024    0.899297    0.840000    0.429997    0.991166    0.975265    0.597647    0.580038    0.757045    0.766768    0.899297    0.840000    200         2.665679    0.520049    0.191874    123.764587 
[37m[36mINFO[0m[0m 03/26 06:59:09 | 0.777612    0.777569    0.901148    0.832593    0.494238    0.992049    0.971731    0.614588    0.606403    0.726200    0.754573    0.901148    0.832593    400         5.331359    0.298307    0.190653    123.710514 
[37m[36mINFO[0m[0m 03/26 07:02:01 | 0.789610    0.791133    0.939652    0.832593    0.535947    0.984099    0.978799    0.601412    0.598870    0.783321    0.795732    0.939652    0.832593    600         7.997038    0.233505    0.238691    123.722448 
[37m[36mINFO[0m[0m 03/26 07:04:44 | 0.764052    0.760548    0.940022    0.822222    0.529208    0.978799    0.968198    0.582588    0.564972    0.730769    0.748476    0.940022    0.822222    800         10.662718   0.209116    0.212671    121.141742 
[37m[36mINFO[0m[0m 03/26 07:07:28 | 0.770172    0.760303    0.931137    0.808889    0.604724    0.976148    0.957597    0.576941    0.568738    0.757426    0.754573    0.931137    0.808889    1000        13.328397   0.179362    0.191445    125.202551 
[37m[36mINFO[0m[0m 03/26 07:10:10 | 0.794391    0.805231    0.946316    0.847407    0.591056    0.978799    0.975265    0.648471    0.655367    0.755903    0.785061    0.946316    0.847407    1200        15.994076   0.158278    0.195900    123.430939 
[37m[36mINFO[0m[0m 03/26 07:12:52 | 0.787986    0.781407    0.968530    0.837037    0.557763    0.992933    0.975265    0.609412    0.608286    0.761615    0.760671    0.968530    0.837037    1400        18.659756   0.113328    0.188762    123.429682 
[37m[36mINFO[0m[0m 03/26 07:15:45 | 0.735708    0.734339    0.932618    0.795556    0.843892    0.969965    0.943463    0.544471    0.546139    0.692688    0.713415    0.932618    0.795556    1600        21.325435   0.121050    0.252782    123.309236 
[37m[36mINFO[0m[0m 03/26 07:18:26 | 0.741162    0.745255    0.960015    0.795556    0.675717    0.938163    0.936396    0.553412    0.563089    0.731912    0.736280    0.960015    0.795556    1800        23.991114   0.104432    0.187576    122.843340 
[37m[36mINFO[0m[0m 03/26 07:21:08 | 0.788874    0.794931    0.983340    0.832593    0.577479    0.977915    0.978799    0.628235    0.634652    0.760472    0.771341    0.983340    0.832593    2000        26.656794   0.107769    0.193177    123.361005 
[37m[36mINFO[0m[0m 03/26 07:23:50 | 0.768442    0.768249    0.971122    0.804444    0.817721    0.977915    0.964664    0.602353    0.600753    0.725057    0.739329    0.971122    0.804444    2200        29.322473   0.095627    0.194422    123.038634 
[37m[36mINFO[0m[0m 03/26 07:26:38 | 0.767523    0.770508    0.974824    0.798519    0.691135    0.973498    0.961131    0.607059    0.598870    0.722011    0.751524    0.974824    0.798519    2400        31.988153   0.120285    0.206160    127.111036 
[37m[36mINFO[0m[0m 03/26 07:29:34 | 0.779200    0.783015    0.950389    0.800000    0.679311    0.955830    0.946996    0.643765    0.645951    0.738005    0.756098    0.950389    0.800000    2600        34.653832   0.109235    0.256168    124.930926 
[37m[36mINFO[0m[0m 03/26 07:32:18 | 0.762179    0.760907    0.977046    0.797037    0.769446    0.962898    0.950530    0.582588    0.591337    0.741051    0.740854    0.977046    0.797037    2800        37.319511   0.105982    0.192017    125.828950 
[37m[36mINFO[0m[0m 03/26 07:35:00 | 0.766271    0.770389    0.975565    0.817778    0.799473    0.960247    0.961131    0.600941    0.596987    0.737624    0.753049    0.975565    0.817778    3000        39.985191   0.113047    0.189879    123.542746 
[37m[36mINFO[0m[0m 03/26 07:37:42 | 0.744461    0.747644    0.886338    0.758519    0.936564    0.991166    0.978799    0.592941    0.610169    0.649276    0.653963    0.886338    0.758519    3200        42.650870   0.109574    0.196306    122.730628 
[37m[36mINFO[0m[0m 03/26 07:40:22 | 0.765998    0.773450    0.970381    0.791111    0.839340    0.950530    0.946996    0.613647    0.623352    0.733816    0.750000    0.970381    0.791111    3400        45.316549   0.103771    0.187906    122.941513 
[37m[36mINFO[0m[0m 03/26 07:43:06 | 0.749125    0.752072    0.984080    0.768889    0.746730    0.977915    0.989399    0.542118    0.544256    0.727342    0.722561    0.984080    0.768889    3600        47.982229   0.107556    0.193881    124.313318 
[37m[36mINFO[0m[0m 03/26 07:45:57 | 0.764414    0.774663    0.983710    0.798519    1.051708    0.959364    0.961131    0.586353    0.608286    0.747525    0.754573    0.983710    0.798519    3800        50.647908   0.081731    0.229745    125.842539 
[37m[36mINFO[0m[0m 03/26 07:48:40 | 0.747629    0.747966    0.951499    0.780741    0.783195    0.988516    0.985866    0.562824    0.578154    0.691546    0.679878    0.951499    0.780741    4000        53.313588   0.116751    0.194256    124.141044 
[37m[36mINFO[0m[0m 03/26 07:51:25 | 0.752668    0.761565    0.980378    0.802963    0.969721    0.966431    0.968198    0.556235    0.564972    0.735339    0.751524    0.980378    0.802963    4200        55.979267   0.120854    0.196078    125.360484 
[37m[36mINFO[0m[0m 03/26 07:54:08 | 0.750539    0.750805    0.968900    0.771852    0.749481    0.969081    0.968198    0.588706    0.587571    0.693831    0.696646    0.968900    0.771852    4400        58.644946   0.128732    0.191748    124.847371 
[37m[36mINFO[0m[0m 03/26 07:56:51 | 0.742437    0.741622    0.970752    0.774815    0.799833    0.971731    0.957597    0.565176    0.570621    0.690404    0.696646    0.970752    0.774815    4600        61.310626   0.111580    0.194060    123.592363 
[37m[36mINFO[0m[0m 03/26 07:59:34 | 0.759862    0.759401    0.965198    0.789630    0.966952    0.959364    0.946996    0.606588    0.610169    0.713633    0.721037    0.965198    0.789630    4800        63.976305   0.115068    0.201771    122.887942 
[37m[36mINFO[0m[0m 03/26 08:02:20 | 0.733962    0.736761    0.964087    0.770370    0.883781    0.963781    0.961131    0.561412    0.555556    0.676695    0.693598    0.964087    0.770370    5000        66.641984   0.116112    0.220783    121.825240 
[37m[36mINFO[0m[0m 03/26 08:02:20 | Cumulative gradient change saved at train_output/VLCS/ERM/[0, 1, 2]/250326_06-51-41_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 08:02:21 | ---
[37m[36mINFO[0m[0m 03/26 08:02:21 | test-domain validation(oracle) = 79.439%
[37m[36mINFO[0m[0m 03/26 08:02:21 | training-domain validation(iid) = 79.439%
[37m[36mINFO[0m[0m 03/26 08:02:21 | last = 73.396%
[37m[36mINFO[0m[0m 03/26 08:02:21 | last (inD) = 77.037%
[37m[36mINFO[0m[0m 03/26 08:02:21 | training-domain validation (iid, inD) = 84.741%
[37m[36mINFO[0m[0m 03/26 08:02:21 | === Summary ===
[37m[36mINFO[0m[0m 03/26 08:02:21 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset VLCS --trial_seed 1 --hparams_seed 9
[37m[36mINFO[0m[0m 03/26 08:02:21 | Unique name: 250326_06-51-41_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 08:02:21 | Out path: train_output/VLCS/ERM/[0, 1, 2]/250326_06-51-41_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 08:02:21 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 08:02:21 | Dataset: VLCS

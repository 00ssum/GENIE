[37m[36mINFO[0m[0m 03/26 08:02:26 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset VLCS --trial_seed 1 --hparams_seed 10
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 10
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[0, 1, 2]/250326_08-02-26_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 1
	unique_name: 250326_08-02-26_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.2128485336217652e-05
	batch_size: 9
	weight_decay: 0.00030907441430549757
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/26 08:02:26 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 08:02:26 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 08:02:26 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 08:02:26 | 
[37m[36mINFO[0m[0m 03/26 08:02:26 | Testenv name escaping te_C_L_S -> te_C_L_S
[37m[36mINFO[0m[0m 03/26 08:02:26 | Test envs = [0, 1, 2], name = te_C_L_S
[37m[36mINFO[0m[0m 03/26 08:02:26 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 03/26 08:02:26 | Batch sizes for each domain: [0, 0, 0, 9] (total=9)
[37m[36mINFO[0m[0m 03/26 08:02:26 | steps-per-epoch for each domain: 300.11 -> min = 300.11
[37m[36mINFO[0m[0m 03/26 08:02:27 | # of params = 23518277
[37m[36mINFO[0m[0m 03/26 08:04:31 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 08:04:31 | 0.050473    0.053555    0.168086    0.176296    1.907575    0.043286    0.067138    0.017882    0.018832    0.090251    0.074695    0.168086    0.176296    0           0.000000    1.762374    1.106263    123.129640 
[37m[36mINFO[0m[0m 03/26 08:06:59 | 0.677964    0.692758    0.710107    0.714074    0.793342    0.872792    0.890459    0.519059    0.521657    0.642041    0.666159    0.710107    0.714074    200         0.666420    0.962917    0.131083    121.570774 
[37m[36mINFO[0m[0m 03/26 08:09:35 | 0.687325    0.696610    0.746020    0.714074    0.831055    0.872792    0.862191    0.618353    0.634652    0.570830    0.592988    0.746020    0.714074    400         1.332840    0.712756    0.166348    122.348676 
[37m[36mINFO[0m[0m 03/26 08:12:05 | 0.682349    0.686667    0.750093    0.709630    0.817486    0.893993    0.901060    0.506824    0.514124    0.646230    0.644817    0.750093    0.709630    600         1.999260    0.709330    0.142220    121.425593 
[37m[36mINFO[0m[0m 03/26 08:14:28 | 0.737624    0.726975    0.771196    0.714074    0.821507    0.929329    0.904594    0.641882    0.642185    0.641660    0.634146    0.771196    0.714074    800         2.665679    0.735316    0.107208    121.628151 
[37m[36mINFO[0m[0m 03/26 08:16:58 | 0.753764    0.750644    0.824139    0.789630    0.625560    0.971731    0.964664    0.623529    0.619586    0.666032    0.667683    0.824139    0.789630    1000        3.332099    0.627265    0.135045    123.096407 
[37m[36mINFO[0m[0m 03/26 08:19:39 | 0.752615    0.754223    0.792299    0.742222    0.711025    0.914311    0.918728    0.648941    0.629002    0.694593    0.714939    0.792299    0.742222    1200        3.998519    0.524096    0.185590    123.832256 
[37m[36mINFO[0m[0m 03/26 08:22:10 | 0.756977    0.763956    0.889300    0.820741    0.525488    0.972615    0.968198    0.557647    0.570621    0.740670    0.753049    0.889300    0.820741    1400        4.664939    0.468198    0.129225    125.253717 
[37m[36mINFO[0m[0m 03/26 08:24:43 | 0.716378    0.718210    0.800444    0.739259    0.717795    0.939046    0.946996    0.514353    0.521657    0.695735    0.685976    0.800444    0.739259    1600        5.331359    0.460144    0.134956    126.275954 
[37m[36mINFO[0m[0m 03/26 08:27:09 | 0.770000    0.770514    0.866716    0.801481    0.690680    0.958481    0.954064    0.616941    0.612053    0.734577    0.745427    0.866716    0.801481    1800        5.997779    0.455487    0.113699    122.830868 
[37m[36mINFO[0m[0m 03/26 08:29:38 | 0.739238    0.753530    0.847094    0.789630    0.698739    0.932862    0.943463    0.610824    0.608286    0.674029    0.708841    0.847094    0.789630    2000        6.664198    0.473275    0.146353    119.753490 
[37m[36mINFO[0m[0m 03/26 08:32:05 | 0.752988    0.757342    0.875972    0.770370    0.708686    0.926678    0.922261    0.584000    0.587571    0.748286    0.762195    0.875972    0.770370    2200        7.330618    0.455577    0.124382    121.761944 
[37m[36mINFO[0m[0m 03/26 08:34:33 | 0.748225    0.731774    0.867086    0.780741    0.627640    0.954064    0.936396    0.557176    0.534840    0.733435    0.724085    0.867086    0.780741    2400        7.997038    0.419108    0.128919    122.645507 
[37m[36mINFO[0m[0m 03/26 08:37:02 | 0.747293    0.746780    0.833025    0.768889    0.639174    0.945230    0.936396    0.586824    0.595104    0.709825    0.708841    0.833025    0.768889    2600        8.663458    0.442086    0.134979    121.861202 
[37m[36mINFO[0m[0m 03/26 08:39:35 | 0.746988    0.747527    0.874121    0.768889    0.671045    0.961131    0.954064    0.550588    0.546139    0.729246    0.742378    0.874121    0.768889    2800        9.329878    0.421731    0.157042    122.092125 
[37m[36mINFO[0m[0m 03/26 08:42:02 | 0.731350    0.731786    0.883006    0.770370    0.683008    0.942580    0.957597    0.541647    0.519774    0.709825    0.717988    0.883006    0.770370    3000        9.996298    0.320148    0.132016    120.619066 
[37m[36mINFO[0m[0m 03/26 08:44:27 | 0.756115    0.752441    0.865976    0.770370    0.858254    0.912544    0.904594    0.625412    0.627119    0.730388    0.725610    0.865976    0.770370    3200        10.662718   0.365021    0.121758    120.672741 
[37m[36mINFO[0m[0m 03/26 08:46:56 | 0.765805    0.765260    0.897075    0.795556    0.650151    0.977032    0.964664    0.617412    0.617702    0.702970    0.713415    0.897075    0.795556    3400        11.329137   0.342056    0.137537    121.565896 
[37m[36mINFO[0m[0m 03/26 08:49:35 | 0.755413    0.754899    0.883006    0.770370    0.657490    0.954064    0.950530    0.594353    0.600753    0.717822    0.713415    0.883006    0.770370    3600        11.995557   0.364767    0.193959    119.593056 
[37m[36mINFO[0m[0m 03/26 08:52:02 | 0.783652    0.778270    0.925583    0.811852    0.625804    0.986749    0.975265    0.639529    0.630885    0.724676    0.728659    0.925583    0.811852    3800        12.661977   0.318098    0.125908    122.418883 
[37m[36mINFO[0m[0m 03/26 08:54:32 | 0.753868    0.755634    0.892632    0.767407    0.762505    0.941696    0.929329    0.608941    0.619586    0.710967    0.717988    0.892632    0.767407    4000        13.328397   0.268029    0.136228    122.468635 
[37m[36mINFO[0m[0m 03/26 08:57:00 | 0.696737    0.692902    0.861163    0.757037    0.755351    0.914311    0.897527    0.498824    0.502825    0.677075    0.678354    0.861163    0.757037    4200        13.994817   0.273899    0.111466    125.688912 
[37m[36mINFO[0m[0m 03/26 08:59:28 | 0.753339    0.756584    0.931137    0.800000    0.822323    0.945230    0.936396    0.574118    0.589454    0.740670    0.743902    0.931137    0.800000    4400        14.661237   0.251458    0.124752    122.992665 
[37m[36mINFO[0m[0m 03/26 09:02:04 | 0.752193    0.766850    0.931507    0.804444    0.664933    0.961131    0.957597    0.608471    0.615819    0.686976    0.727134    0.931507    0.804444    4600        15.327656   0.321506    0.166504    122.631905 
[37m[36mINFO[0m[0m 03/26 09:04:29 | 0.759115    0.754616    0.869308    0.768889    0.816129    0.914311    0.911661    0.625412    0.608286    0.737624    0.743902    0.869308    0.768889    4800        15.994076   0.241561    0.110365    122.567070 
[37m[36mINFO[0m[0m 03/26 09:06:55 | 0.734100    0.735448    0.913736    0.761481    0.640870    0.981449    0.978799    0.546824    0.578154    0.674029    0.649390    0.913736    0.761481    5000        16.660496   0.220314    0.125264    120.851231 
[37m[36mINFO[0m[0m 03/26 09:06:55 | Cumulative gradient change saved at train_output/VLCS/ERM/[0, 1, 2]/250326_08-02-26_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 09:06:56 | ---
[37m[36mINFO[0m[0m 03/26 09:06:56 | test-domain validation(oracle) = 78.365%
[37m[36mINFO[0m[0m 03/26 09:06:56 | training-domain validation(iid) = 75.698%
[37m[36mINFO[0m[0m 03/26 09:06:56 | last = 73.410%
[37m[36mINFO[0m[0m 03/26 09:06:56 | last (inD) = 76.148%
[37m[36mINFO[0m[0m 03/26 09:06:56 | training-domain validation (iid, inD) = 82.074%
[37m[36mINFO[0m[0m 03/26 09:06:56 | === Summary ===
[37m[36mINFO[0m[0m 03/26 09:06:56 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset VLCS --trial_seed 1 --hparams_seed 10
[37m[36mINFO[0m[0m 03/26 09:06:56 | Unique name: 250326_08-02-26_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 09:06:56 | Out path: train_output/VLCS/ERM/[0, 1, 2]/250326_08-02-26_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 09:06:56 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 09:06:56 | Dataset: VLCS

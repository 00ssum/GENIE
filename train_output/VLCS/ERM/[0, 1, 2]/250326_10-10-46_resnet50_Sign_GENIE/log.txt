[37m[36mINFO[0m[0m 03/26 10:10:46 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset VLCS --trial_seed 1 --hparams_seed 12
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 12
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[0, 1, 2]/250326_10-10-46_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 1
	unique_name: 250326_10-10-46_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 3.0065625733392338e-05
	batch_size: 34
	weight_decay: 4.89485556145273e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/26 10:10:46 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 10:10:46 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 10:10:46 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 10:10:46 | 
[37m[36mINFO[0m[0m 03/26 10:10:46 | Testenv name escaping te_C_L_S -> te_C_L_S
[37m[36mINFO[0m[0m 03/26 10:10:46 | Test envs = [0, 1, 2], name = te_C_L_S
[37m[36mINFO[0m[0m 03/26 10:10:46 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 03/26 10:10:46 | Batch sizes for each domain: [0, 0, 0, 34] (total=34)
[37m[36mINFO[0m[0m 03/26 10:10:46 | steps-per-epoch for each domain: 79.44 -> min = 79.44
[37m[36mINFO[0m[0m 03/26 10:10:47 | # of params = 23518277
[37m[36mINFO[0m[0m 03/26 10:12:48 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 10:12:48 | 0.485262    0.499658    0.456127    0.405926    1.394841    0.613958    0.618375    0.466353    0.461394    0.375476    0.419207    0.456127    0.405926    0           0.000000    1.775346    1.177582    119.511680 
[37m[36mINFO[0m[0m 03/26 10:15:28 | 0.763398    0.755754    0.880415    0.840000    0.444968    0.992933    0.982332    0.550118    0.527307    0.747144    0.757622    0.880415    0.840000    200         2.517586    0.469583    0.183639    122.886612 
[37m[36mINFO[0m[0m 03/26 10:18:04 | 0.710953    0.710403    0.877083    0.807407    0.600652    0.986749    0.971731    0.506353    0.500942    0.639756    0.658537    0.877083    0.807407    400         5.035172    0.296138    0.182677    119.538914 
[37m[36mINFO[0m[0m 03/26 10:20:45 | 0.803255    0.800968    0.927064    0.848889    0.439529    0.984099    0.978799    0.626353    0.617702    0.799315    0.806402    0.927064    0.848889    600         7.552758    0.240579    0.214261    118.550857 
[37m[36mINFO[0m[0m 03/26 10:23:25 | 0.793926    0.799103    0.960755    0.853333    0.485003    0.987633    0.975265    0.610824    0.630885    0.783321    0.791159    0.960755    0.853333    800         10.070344   0.157382    0.180733    123.587076 
[37m[36mINFO[0m[0m 03/26 10:26:04 | 0.774266    0.763345    0.964087    0.844444    0.515486    0.972615    0.946996    0.584000    0.576271    0.766184    0.766768    0.964087    0.844444    1000        12.587930   0.110227    0.183438    122.221276 
[37m[36mINFO[0m[0m 03/26 10:28:41 | 0.789909    0.793627    0.978897    0.856296    0.472783    0.984982    0.964664    0.633412    0.640301    0.751333    0.775915    0.978897    0.856296    1200        15.105516   0.118910    0.177099    121.701657 
[37m[36mINFO[0m[0m 03/26 10:31:19 | 0.760039    0.758670    0.962236    0.808889    0.772952    0.966431    0.943463    0.562353    0.561205    0.751333    0.771341    0.962236    0.808889    1400        17.623103   0.081231    0.183390    121.223362 
[37m[36mINFO[0m[0m 03/26 10:33:56 | 0.795108    0.797178    0.982229    0.844444    0.656765    0.979682    0.971731    0.629176    0.627119    0.776466    0.792683    0.982229    0.844444    1600        20.140689   0.071194    0.178686    121.341255 
[37m[36mINFO[0m[0m 03/26 10:36:41 | 0.770104    0.767041    0.985561    0.845926    0.633009    0.982332    0.978799    0.569412    0.555556    0.758568    0.766768    0.985561    0.845926    1800        22.658275   0.053614    0.209022    123.609915 
[37m[36mINFO[0m[0m 03/26 10:39:17 | 0.767251    0.764339    0.984080    0.807407    0.908307    0.982332    0.975265    0.560471    0.555556    0.758949    0.762195    0.984080    0.807407    2000        25.175861   0.052437    0.175136    120.579363 
[37m[36mINFO[0m[0m 03/26 10:41:54 | 0.778057    0.772103    0.988893    0.840000    0.866125    0.971731    0.946996    0.586353    0.578154    0.776085    0.791159    0.988893    0.840000    2200        27.693447   0.061574    0.178164    122.071023 
[37m[36mINFO[0m[0m 03/26 10:44:32 | 0.758984    0.756202    0.992595    0.847407    0.593593    0.992933    0.982332    0.542588    0.542373    0.741432    0.743902    0.992595    0.847407    2400        30.211033   0.060298    0.178949    121.284301 
[37m[36mINFO[0m[0m 03/26 10:47:11 | 0.773331    0.768829    0.993706    0.840000    0.700293    0.994700    0.985866    0.571294    0.570621    0.753998    0.750000    0.993706    0.840000    2600        32.728619   0.034138    0.179257    123.672693 
[37m[36mINFO[0m[0m 03/26 10:50:00 | 0.779692    0.778508    0.995557    0.853333    0.741717    0.975265    0.975265    0.599529    0.602637    0.764280    0.757622    0.995557    0.853333    2800        35.246205   0.037667    0.243033    120.752207 
[37m[36mINFO[0m[0m 03/26 10:52:38 | 0.733877    0.734841    0.990744    0.810370    0.932781    0.963781    0.950530    0.534118    0.532957    0.703732    0.721037    0.990744    0.810370    3000        37.763791   0.020303    0.178988    122.222345 
[37m[36mINFO[0m[0m 03/26 10:55:16 | 0.791416    0.795630    0.994817    0.853333    0.838399    0.984982    0.982332    0.621176    0.627119    0.768088    0.777439    0.994817    0.853333    3200        40.281377   0.023138    0.177703    121.780043 
[37m[36mINFO[0m[0m 03/26 10:57:53 | 0.778621    0.769989    0.994447    0.853333    1.018359    0.980565    0.975265    0.602824    0.604520    0.752475    0.730183    0.994447    0.853333    3400        42.798963   0.015815    0.178159    121.415039 
[37m[36mINFO[0m[0m 03/26 11:00:32 | 0.777977    0.781676    0.995557    0.844444    1.262118    0.973498    0.957597    0.611765    0.625235    0.748667    0.762195    0.995557    0.844444    3600        45.316549   0.012421    0.177544    123.306155 
[37m[36mINFO[0m[0m 03/26 11:03:13 | 0.771344    0.769169    0.996298    0.829630    0.928497    0.985866    0.971731    0.586353    0.578154    0.741813    0.757622    0.996298    0.829630    3800        47.834136   0.045435    0.187926    123.316312 
[37m[36mINFO[0m[0m 03/26 11:06:02 | 0.788636    0.782197    0.988893    0.835556    0.830886    0.988516    0.978799    0.618824    0.610169    0.758568    0.757622    0.988893    0.835556    4000        50.351722   0.028129    0.234173    122.599912 
[37m[36mINFO[0m[0m 03/26 11:08:39 | 0.777268    0.773247    0.995557    0.845926    0.803356    0.986749    0.975265    0.583059    0.583804    0.761995    0.760671    0.995557    0.845926    4200        52.869308   0.033666    0.178272    120.838346 
[37m[36mINFO[0m[0m 03/26 11:11:15 | 0.782369    0.771860    0.994817    0.826667    0.939466    0.982332    0.971731    0.606588    0.604520    0.758187    0.739329    0.994817    0.826667    4400        55.386894   0.011319    0.177093    121.400212 
[37m[36mINFO[0m[0m 03/26 11:13:50 | 0.767780    0.765109    0.997779    0.834074    1.084114    0.984099    0.964664    0.559529    0.559322    0.759711    0.771341    0.997779    0.834074    4600        57.904480   0.015005    0.177811    119.415317 
[37m[36mINFO[0m[0m 03/26 11:16:28 | 0.787136    0.782949    0.998149    0.838519    1.017775    0.987633    0.971731    0.593882    0.595104    0.779893    0.782012    0.998149    0.838519    4800        60.422066   0.012339    0.178849    122.229539 
[37m[36mINFO[0m[0m 03/26 11:19:15 | 0.780848    0.778179    0.999260    0.842963    1.038116    0.987633    0.975265    0.586824    0.589454    0.768088    0.769817    0.999260    0.842963    5000        62.939652   0.018895    0.214867    123.346415 
[37m[36mINFO[0m[0m 03/26 11:19:15 | Cumulative gradient change saved at train_output/VLCS/ERM/[0, 1, 2]/250326_10-10-46_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 11:19:16 | ---
[37m[36mINFO[0m[0m 03/26 11:19:16 | test-domain validation(oracle) = 80.326%
[37m[36mINFO[0m[0m 03/26 11:19:16 | training-domain validation(iid) = 78.991%
[37m[36mINFO[0m[0m 03/26 11:19:16 | last = 78.085%
[37m[36mINFO[0m[0m 03/26 11:19:16 | last (inD) = 84.296%
[37m[36mINFO[0m[0m 03/26 11:19:16 | training-domain validation (iid, inD) = 85.630%
[37m[36mINFO[0m[0m 03/26 11:19:16 | === Summary ===
[37m[36mINFO[0m[0m 03/26 11:19:16 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset VLCS --trial_seed 1 --hparams_seed 12
[37m[36mINFO[0m[0m 03/26 11:19:16 | Unique name: 250326_10-10-46_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 11:19:16 | Out path: train_output/VLCS/ERM/[0, 1, 2]/250326_10-10-46_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 11:19:16 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 11:19:16 | Dataset: VLCS

[37m[36mINFO[0m[0m 03/25 18:16:42 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset VLCS --trial_seed 0 --hparams_seed 19
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 19
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[0, 1, 2]/250325_18-16-42_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 0
	unique_name: 250325_18-16-42_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5.513854977685438e-05
	batch_size: 27
	weight_decay: 0.0014556716107047517
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/25 18:16:42 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 18:16:42 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 18:16:42 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 18:16:42 | 
[37m[36mINFO[0m[0m 03/25 18:16:42 | Testenv name escaping te_C_L_S -> te_C_L_S
[37m[36mINFO[0m[0m 03/25 18:16:42 | Test envs = [0, 1, 2], name = te_C_L_S
[37m[36mINFO[0m[0m 03/25 18:16:42 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 03/25 18:16:42 | Batch sizes for each domain: [0, 0, 0, 27] (total=27)
[37m[36mINFO[0m[0m 03/25 18:16:42 | steps-per-epoch for each domain: 100.04 -> min = 100.04
[37m[36mINFO[0m[0m 03/25 18:16:43 | # of params = 23518277
[37m[36mINFO[0m[0m 03/25 18:18:55 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 18:18:55 | 0.485229    0.501938    0.443539    0.445926    1.615726    0.611307    0.628975    0.459765    0.489642    0.384615    0.387195    0.443539    0.445926    0           0.000000    1.739892    1.209581    131.026851 
[37m[36mINFO[0m[0m 03/25 18:21:41 | 0.778647    0.770814    0.880415    0.841481    0.442968    0.958481    0.954064    0.621176    0.632768    0.756283    0.725610    0.880415    0.841481    200         1.999260    0.554418    0.177766    130.214107 
[37m[36mINFO[0m[0m 03/25 18:24:16 | 0.753302    0.744909    0.897445    0.842963    0.524866    0.963781    0.957597    0.566118    0.542373    0.730008    0.734756    0.897445    0.842963    400         3.998519    0.329010    0.149944    124.628026 
[37m[36mINFO[0m[0m 03/25 18:27:00 | 0.772834    0.750762    0.914846    0.848889    0.541836    0.981449    0.964664    0.575059    0.557439    0.761995    0.730183    0.914846    0.848889    600         5.997779    0.271081    0.171658    130.065838 
[37m[36mINFO[0m[0m 03/25 18:29:42 | 0.787757    0.774915    0.934839    0.859259    0.441396    0.987633    0.982332    0.605647    0.596987    0.769992    0.745427    0.934839    0.859259    800         7.997038    0.229753    0.164365    129.023232 
[37m[36mINFO[0m[0m 03/25 18:32:27 | 0.750894    0.745991    0.874121    0.823704    0.698727    0.954064    0.950530    0.581176    0.572505    0.717441    0.714939    0.874121    0.823704    1000        9.996298    0.172114    0.179179    129.729541 
[37m[36mINFO[0m[0m 03/25 18:35:07 | 0.783793    0.775784    0.936320    0.851852    0.587624    0.988516    0.982332    0.640471    0.666667    0.722391    0.678354    0.936320    0.851852    1200        11.995557   0.243781    0.173621    125.173230 
[37m[36mINFO[0m[0m 03/25 18:37:48 | 0.771112    0.755875    0.974454    0.856296    0.529515    0.983216    0.964664    0.598588    0.613936    0.731531    0.689024    0.974454    0.856296    1400        13.994817   0.124804    0.160705    128.746241 
[37m[36mINFO[0m[0m 03/25 18:40:28 | 0.741558    0.725796    0.951870    0.819259    0.581806    0.977915    0.971731    0.520941    0.495292    0.725819    0.710366    0.951870    0.819259    1600        15.994076   0.151991    0.152268    129.616552 
[37m[36mINFO[0m[0m 03/25 18:43:08 | 0.763740    0.756561    0.970752    0.834074    0.652184    0.961131    0.964664    0.576471    0.568738    0.753618    0.736280    0.970752    0.834074    1800        17.993336   0.076271    0.158000    128.584164 
[37m[36mINFO[0m[0m 03/25 18:46:03 | 0.774351    0.765290    0.958904    0.828148    0.705269    0.968198    0.964664    0.616471    0.610169    0.738385    0.721037    0.958904    0.828148    2000        19.992595   0.080646    0.221683    129.948590 
[37m[36mINFO[0m[0m 03/25 18:48:42 | 0.717999    0.713085    0.982229    0.825185    0.735982    0.922261    0.908127    0.536000    0.532957    0.695735    0.698171    0.982229    0.825185    2200        21.991855   0.050327    0.154026    128.481713 
[37m[36mINFO[0m[0m 03/25 18:51:17 | 0.769226    0.748921    0.978156    0.837037    0.702022    0.971731    0.950530    0.605176    0.602637    0.730769    0.693598    0.978156    0.837037    2400        23.991114   0.073028    0.149764    125.314374 
[37m[36mINFO[0m[0m 03/25 18:53:59 | 0.771929    0.757687    0.982229    0.845926    0.703031    0.985866    0.978799    0.607529    0.608286    0.722391    0.685976    0.982229    0.845926    2600        25.990374   0.089216    0.164163    128.699868 
[37m[36mINFO[0m[0m 03/25 18:56:35 | 0.773912    0.762371    0.988153    0.842963    0.862396    0.969965    0.950530    0.578353    0.574388    0.773420    0.762195    0.988153    0.842963    2800        27.989633   0.048805    0.146292    126.535837 
[37m[36mINFO[0m[0m 03/25 18:59:19 | 0.754361    0.745107    0.983710    0.805926    0.888850    0.971731    0.971731    0.559059    0.559322    0.732292    0.704268    0.983710    0.805926    3000        29.988893   0.043526    0.188103    126.381464 
[37m[36mINFO[0m[0m 03/25 19:01:57 | 0.759022    0.752766    0.987042    0.820741    0.997444    0.969081    0.964664    0.594353    0.596987    0.713633    0.696646    0.987042    0.820741    3200        31.988153   0.032917    0.161893    125.465956 
[37m[36mINFO[0m[0m 03/25 19:04:33 | 0.757229    0.752083    0.993336    0.822222    0.815080    0.968198    0.975265    0.546824    0.538606    0.756664    0.742378    0.993336    0.822222    3400        33.987412   0.024250    0.145796    127.401303 
[37m[36mINFO[0m[0m 03/25 19:07:09 | 0.767156    0.745853    0.990374    0.851852    0.888254    0.972615    0.954064    0.568000    0.551789    0.760853    0.731707    0.990374    0.851852    3600        35.986672   0.022484    0.145632    126.266158 
[37m[36mINFO[0m[0m 03/25 19:09:47 | 0.779204    0.767168    0.977416    0.844444    0.921701    0.981449    0.971731    0.635294    0.634652    0.720868    0.695122    0.977416    0.844444    3800        37.985931   0.050010    0.162299    125.756661 
[37m[36mINFO[0m[0m 03/25 19:12:37 | 0.745954    0.723782    0.975565    0.816296    0.877852    0.954064    0.950530    0.545412    0.534840    0.738385    0.685976    0.975565    0.816296    4000        39.985191   0.067388    0.220925    125.967669 
[37m[36mINFO[0m[0m 03/25 19:15:14 | 0.731694    0.729952    0.963717    0.791111    0.909284    0.969081    0.971731    0.537882    0.536723    0.688119    0.681402    0.963717    0.791111    4200        41.984450   0.032388    0.151064    127.311576 
[37m[36mINFO[0m[0m 03/25 19:17:48 | 0.759373    0.755778    0.991114    0.838519    0.764875    0.988516    0.971731    0.553882    0.559322    0.735720    0.736280    0.991114    0.838519    4400        43.983710   0.052124    0.145394    124.299839 
[37m[36mINFO[0m[0m 03/25 19:20:23 | 0.729274    0.729683    0.980748    0.802963    0.841483    0.958481    0.954064    0.545412    0.561205    0.683930    0.673780    0.980748    0.802963    4600        45.982969   0.021716    0.155795    124.136698 
[37m[36mINFO[0m[0m 03/25 19:22:59 | 0.749217    0.734328    0.994076    0.810370    0.975026    0.969965    0.957597    0.555294    0.551789    0.722391    0.693598    0.994076    0.810370    4800        47.982229   0.027842    0.149126    126.021016 
[37m[36mINFO[0m[0m 03/25 19:25:40 | 0.757128    0.751850    0.983710    0.822222    0.952810    0.956714    0.950530    0.559529    0.568738    0.755141    0.736280    0.983710    0.822222    5000        49.981488   0.028673    0.185010    124.240398 
[37m[36mINFO[0m[0m 03/25 19:25:40 | Cumulative gradient change saved at train_output/VLCS/ERM/[0, 1, 2]/250325_18-16-42_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 19:25:42 | ---
[37m[36mINFO[0m[0m 03/25 19:25:42 | test-domain validation(oracle) = 78.379%
[37m[36mINFO[0m[0m 03/25 19:25:42 | training-domain validation(iid) = 78.776%
[37m[36mINFO[0m[0m 03/25 19:25:42 | last = 75.713%
[37m[36mINFO[0m[0m 03/25 19:25:42 | last (inD) = 82.222%
[37m[36mINFO[0m[0m 03/25 19:25:42 | training-domain validation (iid, inD) = 85.926%
[37m[36mINFO[0m[0m 03/25 19:25:42 | === Summary ===
[37m[36mINFO[0m[0m 03/25 19:25:42 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset VLCS --trial_seed 0 --hparams_seed 19
[37m[36mINFO[0m[0m 03/25 19:25:42 | Unique name: 250325_18-16-42_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 19:25:42 | Out path: train_output/VLCS/ERM/[0, 1, 2]/250325_18-16-42_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 19:25:42 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 19:25:42 | Dataset: VLCS

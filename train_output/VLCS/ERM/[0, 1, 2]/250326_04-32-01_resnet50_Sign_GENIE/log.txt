[37m[36mINFO[0m[0m 03/26 04:32:01 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset VLCS --trial_seed 1 --hparams_seed 7
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 7
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[0, 1, 2]/250326_04-32-01_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 1
	unique_name: 250326_04-32-01_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00025471109765784857
	batch_size: 39
	weight_decay: 9.10622179414602e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/26 04:32:01 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 04:32:01 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 04:32:01 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 04:32:01 | 
[37m[36mINFO[0m[0m 03/26 04:32:01 | Testenv name escaping te_C_L_S -> te_C_L_S
[37m[36mINFO[0m[0m 03/26 04:32:01 | Test envs = [0, 1, 2], name = te_C_L_S
[37m[36mINFO[0m[0m 03/26 04:32:01 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 03/26 04:32:01 | Batch sizes for each domain: [0, 0, 0, 39] (total=39)
[37m[36mINFO[0m[0m 03/26 04:32:01 | steps-per-epoch for each domain: 69.26 -> min = 69.26
[37m[36mINFO[0m[0m 03/26 04:32:03 | # of params = 23518277
[37m[36mINFO[0m[0m 03/26 04:34:10 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 04:34:10 | 0.486054    0.498642    0.455387    0.404444    1.384616    0.613958    0.618375    0.466824    0.461394    0.377380    0.416159    0.455387    0.404444    0           0.000000    1.837718    2.611381    124.845589 
[37m[36mINFO[0m[0m 03/26 04:37:00 | 0.760380    0.755617    0.871159    0.835556    0.462675    0.994700    0.985866    0.547294    0.538606    0.739147    0.742378    0.871159    0.835556    200         2.887819    0.490947    0.211844    128.017418 
[37m[36mINFO[0m[0m 03/26 04:39:49 | 0.777410    0.777354    0.922251    0.844444    0.447749    0.992933    0.978799    0.578824    0.581921    0.760472    0.771341    0.922251    0.844444    400         5.775639    0.298124    0.212019    126.596363 
[37m[36mINFO[0m[0m 03/26 04:42:35 | 0.758229    0.757547    0.935209    0.845926    0.514609    0.976148    0.964664    0.546824    0.544256    0.751714    0.763720    0.935209    0.845926    600         8.663458    0.223368    0.213489    122.687674 
[37m[36mINFO[0m[0m 03/26 04:45:36 | 0.785845    0.788383    0.962606    0.854815    0.504080    0.990283    0.978799    0.581647    0.587571    0.785605    0.798780    0.962606    0.854815    800         11.551277   0.160508    0.274643    126.086371 
[37m[36mINFO[0m[0m 03/26 04:48:34 | 0.789037    0.795193    0.968530    0.853333    0.514335    0.982332    0.985866    0.605647    0.617702    0.779132    0.782012    0.968530    0.853333    1000        14.439097   0.132057    0.251401    128.220884 
[37m[36mINFO[0m[0m 03/26 04:51:23 | 0.773390    0.767154    0.968900    0.825185    0.701800    0.982332    0.968198    0.573176    0.564972    0.764661    0.768293    0.968900    0.825185    1200        17.326916   0.097411    0.209418    127.109268 
[37m[36mINFO[0m[0m 03/26 04:54:09 | 0.806225    0.805147    0.972603    0.840000    0.661871    0.988516    0.968198    0.657882    0.659134    0.772277    0.788110    0.972603    0.840000    1400        20.214735   0.081289    0.215220    122.543710 
[37m[36mINFO[0m[0m 03/26 04:57:06 | 0.779172    0.771286    0.976305    0.826667    0.744126    0.984982    0.978799    0.578353    0.574388    0.774181    0.760671    0.976305    0.826667    1600        23.102555   0.062747    0.258846    125.241959 
[37m[36mINFO[0m[0m 03/26 05:00:09 | 0.777780    0.774341    0.983710    0.825185    0.844398    0.987633    0.971731    0.592471    0.587571    0.753237    0.763720    0.983710    0.825185    1800        25.990374   0.053083    0.277547    127.654165 
[37m[36mINFO[0m[0m 03/26 05:02:56 | 0.771413    0.771351    0.982599    0.835556    0.799557    0.984982    0.971731    0.566118    0.572505    0.763138    0.769817    0.982599    0.835556    2000        28.878193   0.058500    0.210429    125.015873 
[37m[36mINFO[0m[0m 03/26 05:05:45 | 0.773219    0.777192    0.991114    0.844444    0.602511    0.988516    0.975265    0.576000    0.581921    0.755141    0.774390    0.991114    0.844444    2200        31.766013   0.069478    0.213786    125.761075 
[37m[36mINFO[0m[0m 03/26 05:08:32 | 0.789020    0.792551    0.991485    0.844444    0.712595    0.984099    0.982332    0.598118    0.602637    0.784844    0.792683    0.991485    0.844444    2400        34.653832   0.051064    0.210834    125.302621 
[37m[36mINFO[0m[0m 03/26 05:11:36 | 0.796875    0.798099    0.989633    0.856296    0.780319    0.994700    0.978799    0.638118    0.636535    0.757807    0.778963    0.989633    0.856296    2600        37.541651   0.043013    0.297483    124.114882 
[37m[36mINFO[0m[0m 03/26 05:14:22 | 0.794975    0.797943    0.993336    0.857778    0.840633    0.981449    0.968198    0.643765    0.649718    0.759711    0.775915    0.993336    0.857778    2800        40.429471   0.028789    0.213031    123.896054 
[37m[36mINFO[0m[0m 03/26 05:17:06 | 0.779421    0.784223    0.998149    0.844444    0.900041    0.984982    0.985866    0.596235    0.596987    0.757045    0.769817    0.998149    0.844444    3000        43.317290   0.020675    0.206494    122.579091 
[37m[36mINFO[0m[0m 03/26 05:19:57 | 0.773827    0.776726    0.997779    0.850370    0.829372    0.989399    0.978799    0.576941    0.580038    0.755141    0.771341    0.997779    0.850370    3200        46.205109   0.036688    0.210241    129.005464 
[37m[36mINFO[0m[0m 03/26 05:23:05 | 0.776440    0.766061    0.992966    0.841481    0.868851    0.986749    0.989399    0.592000    0.572505    0.750571    0.736280    0.992966    0.841481    3400        49.092929   0.019881    0.307215    126.448531 
[37m[36mINFO[0m[0m 03/26 05:25:59 | 0.786518    0.780211    0.997779    0.828148    0.860108    0.981449    0.957597    0.606588    0.610169    0.771516    0.772866    0.997779    0.828148    3600        51.980748   0.033496    0.235777    127.069354 
[37m[36mINFO[0m[0m 03/26 05:28:46 | 0.788678    0.788467    0.988523    0.837037    1.197635    0.967314    0.950530    0.626824    0.625235    0.771896    0.789634    0.988523    0.837037    3800        54.868567   0.018312    0.209060    125.084905 
[37m[36mINFO[0m[0m 03/26 05:31:32 | 0.778955    0.781670    0.984820    0.808889    1.183442    0.979682    0.964664    0.612706    0.612053    0.744478    0.768293    0.984820    0.808889    4000        57.756387   0.022677    0.206705    124.350868 
[37m[36mINFO[0m[0m 03/26 05:34:19 | 0.790071    0.792891    0.999630    0.837037    1.093051    0.984982    0.968198    0.616000    0.610169    0.769231    0.800305    0.999630    0.837037    4200        60.644206   0.019668    0.221463    122.634649 
[37m[36mINFO[0m[0m 03/26 05:37:19 | 0.775641    0.773748    0.995557    0.837037    1.102575    0.971731    0.946996    0.612235    0.612053    0.742955    0.762195    0.995557    0.837037    4400        63.532025   0.017878    0.292270    121.760092 
[37m[36mINFO[0m[0m 03/26 05:40:02 | 0.777568    0.775703    0.994447    0.840000    1.106640    0.986749    0.968198    0.595765    0.587571    0.750190    0.771341    0.994447    0.840000    4600        66.419845   0.017507    0.205096    121.765330 
[37m[36mINFO[0m[0m 03/26 05:42:46 | 0.777012    0.769073    0.994076    0.826667    0.959729    0.976148    0.961131    0.580706    0.576271    0.774181    0.769817    0.994076    0.826667    4800        69.307664   0.024073    0.207984    122.309937 
[37m[36mINFO[0m[0m 03/26 05:45:29 | 0.792497    0.789459    0.996298    0.826667    1.267473    0.982332    0.961131    0.630118    0.625235    0.765042    0.782012    0.996298    0.826667    5000        72.195483   0.006560    0.209077    121.473746 
[37m[36mINFO[0m[0m 03/26 05:45:29 | Cumulative gradient change saved at train_output/VLCS/ERM/[0, 1, 2]/250326_04-32-01_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 05:45:31 | ---
[37m[36mINFO[0m[0m 03/26 05:45:31 | test-domain validation(oracle) = 80.623%
[37m[36mINFO[0m[0m 03/26 05:45:31 | training-domain validation(iid) = 79.497%
[37m[36mINFO[0m[0m 03/26 05:45:31 | last = 79.250%
[37m[36mINFO[0m[0m 03/26 05:45:31 | last (inD) = 82.667%
[37m[36mINFO[0m[0m 03/26 05:45:31 | training-domain validation (iid, inD) = 85.778%
[37m[36mINFO[0m[0m 03/26 05:45:31 | === Summary ===
[37m[36mINFO[0m[0m 03/26 05:45:31 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset VLCS --trial_seed 1 --hparams_seed 7
[37m[36mINFO[0m[0m 03/26 05:45:31 | Unique name: 250326_04-32-01_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 05:45:31 | Out path: train_output/VLCS/ERM/[0, 1, 2]/250326_04-32-01_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 05:45:31 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 05:45:31 | Dataset: VLCS

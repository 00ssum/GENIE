[37m[36mINFO[0m[0m 03/25 11:05:31 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset VLCS --trial_seed 0 --hparams_seed 13
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 13
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[0, 1, 2]/250325_11-05-31_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 0
	unique_name: 250325_11-05-31_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00014596629881421895
	batch_size: 9
	weight_decay: 0.0009399117661702502
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/25 11:05:31 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 11:05:31 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 11:05:31 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 11:05:31 | 
[37m[36mINFO[0m[0m 03/25 11:05:31 | Testenv name escaping te_C_L_S -> te_C_L_S
[37m[36mINFO[0m[0m 03/25 11:05:31 | Test envs = [0, 1, 2], name = te_C_L_S
[37m[36mINFO[0m[0m 03/25 11:05:31 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 03/25 11:05:31 | Batch sizes for each domain: [0, 0, 0, 9] (total=9)
[37m[36mINFO[0m[0m 03/25 11:05:31 | steps-per-epoch for each domain: 300.11 -> min = 300.11
[37m[36mINFO[0m[0m 03/25 11:05:32 | # of params = 23518277
[37m[36mINFO[0m[0m 03/25 11:08:00 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 11:08:00 | 0.485229    0.501938    0.443539    0.445926    1.607678    0.611307    0.628975    0.459765    0.489642    0.384615    0.387195    0.443539    0.445926    0           0.000000    1.789665    1.478324    146.214414 
[37m[36mINFO[0m[0m 03/25 11:11:15 | 0.718222    0.707362    0.751573    0.730370    0.817931    0.916961    0.929329    0.621176    0.619586    0.616527    0.573171    0.751573    0.730370    200         0.666420    0.846042    0.273266    140.375141 
[37m[36mINFO[0m[0m 03/25 11:14:07 | 0.732298    0.732008    0.826361    0.789630    0.614587    0.929329    0.943463    0.566118    0.557439    0.701447    0.695122    0.826361    0.789630    400         1.332840    0.662312    0.155259    141.169176 
[37m[36mINFO[0m[0m 03/25 11:17:05 | 0.700924    0.698217    0.735283    0.702222    0.841062    0.871025    0.869258    0.568000    0.566855    0.663747    0.658537    0.735283    0.702222    600         1.999260    0.639649    0.155124    146.784941 
[37m[36mINFO[0m[0m 03/25 11:20:15 | 0.777705    0.775943    0.852277    0.805926    0.587070    0.939046    0.932862    0.650353    0.664783    0.743717    0.730183    0.852277    0.805926    800         2.665679    0.507993    0.231462    143.678969 
[37m[36mINFO[0m[0m 03/25 11:23:14 | 0.726909    0.717529    0.853388    0.786667    0.568499    0.971731    0.975265    0.526588    0.506591    0.682407    0.670732    0.853388    0.786667    1000        3.332099    0.525221    0.148988    148.729898 
[37m[36mINFO[0m[0m 03/25 11:26:05 | 0.668995    0.674673    0.701592    0.672593    0.881633    0.890459    0.879859    0.644706    0.668550    0.471820    0.475610    0.701592    0.672593    1200        3.998519    0.488148    0.135104    144.772917 
[37m[36mINFO[0m[0m 03/25 11:29:17 | 0.749142    0.762116    0.827471    0.798519    0.654460    0.945230    0.954064    0.625882    0.647834    0.676314    0.684451    0.827471    0.798519    1400        4.664939    0.446064    0.251246    140.809436 
[37m[36mINFO[0m[0m 03/25 11:32:07 | 0.759995    0.752329    0.865235    0.805926    0.551926    0.959364    0.950530    0.596706    0.608286    0.723915    0.698171    0.865235    0.805926    1600        5.331359    0.480657    0.133807    143.493495 
[37m[36mINFO[0m[0m 03/25 11:34:55 | 0.742381    0.748987    0.853758    0.780741    0.605096    0.958481    0.961131    0.569882    0.580038    0.698781    0.705793    0.853758    0.780741    1800        5.997779    0.407008    0.145203    139.037333 
[37m[36mINFO[0m[0m 03/25 11:38:02 | 0.734246    0.723246    0.818586    0.770370    0.643901    0.876325    0.855124    0.573176    0.595104    0.753237    0.719512    0.818586    0.770370    2000        6.664198    0.449184    0.241776    138.281517 
[37m[36mINFO[0m[0m 03/25 11:40:53 | 0.768328    0.756890    0.907442    0.820741    0.493796    0.971731    0.964664    0.591059    0.581921    0.742193    0.724085    0.907442    0.820741    2200        7.330618    0.373742    0.145745    141.810423 
[37m[36mINFO[0m[0m 03/25 11:43:50 | 0.737537    0.720643    0.897075    0.794074    0.557510    0.947880    0.950530    0.539294    0.525424    0.725438    0.685976    0.897075    0.794074    2400        7.997038    0.360500    0.152992    147.078942 
[37m[36mINFO[0m[0m 03/25 11:46:53 | 0.748963    0.734847    0.887449    0.797037    0.651941    0.937279    0.961131    0.560941    0.525424    0.748667    0.717988    0.887449    0.797037    2600        8.663458    0.301717    0.202293    142.778443 
[37m[36mINFO[0m[0m 03/25 11:49:47 | 0.755032    0.740654    0.917068    0.804444    0.603306    0.975265    0.971731    0.567059    0.561205    0.722772    0.689024    0.917068    0.804444    2800        9.329878    0.302176    0.146848    143.825191 
[37m[36mINFO[0m[0m 03/25 11:52:37 | 0.717778    0.696611    0.908182    0.805926    0.646861    0.952297    0.950530    0.514824    0.499058    0.686215    0.640244    0.908182    0.805926    3000        9.996298    0.276750    0.116918    146.785932 
[37m[36mINFO[0m[0m 03/25 11:55:53 | 0.745896    0.752163    0.873010    0.776296    0.751787    0.962898    0.954064    0.600000    0.659134    0.674791    0.643293    0.873010    0.776296    3200        10.662718   0.364324    0.247590    147.058566 
[37m[36mINFO[0m[0m 03/25 11:58:45 | 0.685054    0.669296    0.857090    0.740741    0.789531    0.935512    0.943463    0.497412    0.482109    0.622239    0.582317    0.857090    0.740741    3400        11.329137   0.314422    0.145709    142.676236 
[37m[36mINFO[0m[0m 03/25 12:01:37 | 0.743788    0.739618    0.907812    0.819259    0.619350    0.936396    0.939929    0.584000    0.583804    0.710967    0.695122    0.907812    0.819259    3600        11.995557   0.267025    0.127211    146.497635 
[37m[36mINFO[0m[0m 03/25 12:04:40 | 0.744744    0.753896    0.923362    0.811852    0.588568    0.967314    0.971731    0.572706    0.585687    0.694212    0.704268    0.923362    0.811852    3800        12.661977   0.251510    0.199977    142.731243 
[37m[36mINFO[0m[0m 03/25 12:07:30 | 0.749178    0.749705    0.926324    0.808889    0.564027    0.952297    0.961131    0.585412    0.591337    0.709825    0.696646    0.926324    0.808889    4000        13.328397   0.276464    0.128926    143.858765 
[37m[36mINFO[0m[0m 03/25 12:10:22 | 0.728208    0.712333    0.910774    0.761481    0.739935    0.932862    0.932862    0.541176    0.527307    0.710586    0.676829    0.910774    0.761481    4200        13.994817   0.250399    0.149665    142.695266 
[37m[36mINFO[0m[0m 03/25 12:13:10 | 0.752562    0.744288    0.928915    0.804444    0.622515    0.931979    0.932862    0.601412    0.606403    0.724296    0.693598    0.928915    0.804444    4400        14.661237   0.252026    0.131372    141.263668 
[37m[36mINFO[0m[0m 03/25 12:16:02 | 0.776311    0.767204    0.952240    0.810370    0.578745    0.962898    0.964664    0.621176    0.640301    0.744859    0.696646    0.952240    0.810370    4600        15.327656   0.187459    0.144228    143.914341 
[37m[36mINFO[0m[0m 03/25 12:19:04 | 0.706565    0.716094    0.863014    0.733333    0.707832    0.933746    0.939929    0.535529    0.557439    0.650419    0.650915    0.863014    0.733333    4800        15.994076   0.351611    0.196194    142.683993 
[37m[36mINFO[0m[0m 03/25 12:21:56 | 0.763745    0.756973    0.924102    0.820741    0.596141    0.934629    0.936396    0.621647    0.619586    0.734958    0.714939    0.924102    0.820741    5000        16.660496   0.284093    0.129882    146.065032 
[37m[36mINFO[0m[0m 03/25 12:21:57 | Cumulative gradient change saved at train_output/VLCS/ERM/[0, 1, 2]/250325_11-05-31_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 12:21:58 | ---
[37m[36mINFO[0m[0m 03/25 12:21:58 | test-domain validation(oracle) = 77.771%
[37m[36mINFO[0m[0m 03/25 12:21:58 | training-domain validation(iid) = 76.833%
[37m[36mINFO[0m[0m 03/25 12:21:58 | last = 76.374%
[37m[36mINFO[0m[0m 03/25 12:21:58 | last (inD) = 82.074%
[37m[36mINFO[0m[0m 03/25 12:21:58 | training-domain validation (iid, inD) = 82.074%
[37m[36mINFO[0m[0m 03/25 12:21:58 | === Summary ===
[37m[36mINFO[0m[0m 03/25 12:21:58 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset VLCS --trial_seed 0 --hparams_seed 13
[37m[36mINFO[0m[0m 03/25 12:21:58 | Unique name: 250325_11-05-31_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 12:21:58 | Out path: train_output/VLCS/ERM/[0, 1, 2]/250325_11-05-31_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 12:21:58 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 12:21:58 | Dataset: VLCS

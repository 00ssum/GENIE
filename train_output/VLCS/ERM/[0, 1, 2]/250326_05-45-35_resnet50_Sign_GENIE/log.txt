[37m[36mINFO[0m[0m 03/26 05:45:35 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset VLCS --trial_seed 1 --hparams_seed 8
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 8
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[0, 1, 2]/250326_05-45-35_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 1
	unique_name: 250326_05-45-35_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 3.335053008064847e-05
	batch_size: 18
	weight_decay: 0.00011109601170966198
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/26 05:45:35 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 05:45:35 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 05:45:35 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 05:45:35 | 
[37m[36mINFO[0m[0m 03/26 05:45:35 | Testenv name escaping te_C_L_S -> te_C_L_S
[37m[36mINFO[0m[0m 03/26 05:45:35 | Test envs = [0, 1, 2], name = te_C_L_S
[37m[36mINFO[0m[0m 03/26 05:45:35 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 03/26 05:45:35 | Batch sizes for each domain: [0, 0, 0, 18] (total=18)
[37m[36mINFO[0m[0m 03/26 05:45:35 | steps-per-epoch for each domain: 150.06 -> min = 150.06
[37m[36mINFO[0m[0m 03/26 05:45:36 | # of params = 23518277
[37m[36mINFO[0m[0m 03/26 05:47:42 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 05:47:42 | 0.092573    0.113970    0.174010    0.143704    1.586951    0.121025    0.155477    0.066824    0.090395    0.089871    0.096037    0.174010    0.143704    0           0.000000    1.694496    1.553589    124.769464 
[37m[36mINFO[0m[0m 03/26 05:50:09 | 0.755826    0.752616    0.855609    0.810370    0.539711    0.990283    0.982332    0.564706    0.549906    0.712490    0.725610    0.855609    0.810370    200         1.332840    0.586161    0.116917    123.330061 
[37m[36mINFO[0m[0m 03/26 05:52:43 | 0.777102    0.765062    0.835987    0.774815    0.784342    0.975265    0.950530    0.612706    0.600753    0.743336    0.743902    0.835987    0.774815    400         2.665679    0.420937    0.147798    124.598585 
[37m[36mINFO[0m[0m 03/26 05:55:32 | 0.744553    0.740838    0.897075    0.823704    0.484542    0.984099    0.982332    0.517647    0.508475    0.731912    0.731707    0.897075    0.823704    600         3.998519    0.349775    0.217071    125.630985 
[37m[36mINFO[0m[0m 03/26 05:58:07 | 0.766769    0.769719    0.880415    0.816296    0.573364    0.978799    0.975265    0.577412    0.576271    0.744097    0.757622    0.880415    0.816296    800         5.331359    0.311624    0.154765    124.205351 
[37m[36mINFO[0m[0m 03/26 06:00:37 | 0.758858    0.751778    0.889670    0.786667    0.779658    0.965548    0.964664    0.578353    0.557439    0.732673    0.733232    0.889670    0.786667    1000        6.664198    0.244963    0.127879    124.321002 
[37m[36mINFO[0m[0m 03/26 06:03:02 | 0.771617    0.771614    0.930766    0.825185    0.600155    0.977032    0.961131    0.583059    0.576271    0.754760    0.777439    0.930766    0.825185    1200        7.997038    0.250657    0.117953    121.798116 
[37m[36mINFO[0m[0m 03/26 06:05:51 | 0.769322    0.764852    0.925583    0.811852    0.604493    0.977915    0.950530    0.596235    0.589454    0.733816    0.754573    0.925583    0.811852    1400        9.329878    0.215318    0.217058    125.179737 
[37m[36mINFO[0m[0m 03/26 06:08:26 | 0.773979    0.768937    0.945205    0.813333    0.564158    0.978799    0.964664    0.608941    0.619586    0.734196    0.722561    0.945205    0.813333    1600        10.662718   0.199809    0.152548    123.962461 
[37m[36mINFO[0m[0m 03/26 06:10:51 | 0.774119    0.772755    0.907812    0.801481    0.657874    0.945230    0.918728    0.633412    0.632768    0.743717    0.766768    0.907812    0.801481    1800        11.995557   0.196931    0.120818    121.428179 
[37m[36mINFO[0m[0m 03/26 06:13:16 | 0.741903    0.740720    0.934839    0.798519    0.867003    0.983216    0.982332    0.552471    0.570621    0.690023    0.669207    0.934839    0.798519    2000        13.328397   0.164124    0.119398    120.640826 
[37m[36mINFO[0m[0m 03/26 06:15:51 | 0.740662    0.741256    0.960755    0.825185    0.815174    0.956714    0.946996    0.542118    0.540490    0.723153    0.736280    0.960755    0.825185    2200        14.661237   0.135391    0.156774    124.212442 
[37m[36mINFO[0m[0m 03/26 06:18:28 | 0.747809    0.742912    0.961866    0.811852    0.694195    0.958481    0.950530    0.561412    0.548023    0.723534    0.730183    0.961866    0.811852    2400        15.994076   0.130260    0.151907    126.091905 
[37m[36mINFO[0m[0m 03/26 06:20:58 | 0.764257    0.771052    0.958534    0.819259    0.595046    0.965548    0.954064    0.585412    0.604520    0.741813    0.754573    0.958534    0.819259    2600        17.326916   0.133519    0.140884    121.822800 
[37m[36mINFO[0m[0m 03/26 06:23:25 | 0.749194    0.747199    0.975194    0.816296    0.720919    0.973498    0.954064    0.570353    0.564972    0.703732    0.722561    0.975194    0.816296    2800        18.659756   0.099809    0.128264    121.285449 
[37m[36mINFO[0m[0m 03/26 06:26:00 | 0.754768    0.751373    0.974084    0.808889    0.927653    0.989399    0.985866    0.548706    0.551789    0.726200    0.716463    0.974084    0.808889    3000        19.992595   0.071948    0.164071    122.322145 
[37m[36mINFO[0m[0m 03/26 06:28:34 | 0.775642    0.769129    0.974824    0.822222    0.727106    0.988516    0.985866    0.606118    0.591337    0.732292    0.730183    0.974824    0.822222    3200        21.325435   0.098302    0.145544    124.832509 
[37m[36mINFO[0m[0m 03/26 06:31:06 | 0.765692    0.756676    0.943354    0.794074    0.802434    0.979682    0.971731    0.595765    0.589454    0.721630    0.708841    0.943354    0.794074    3400        22.658275   0.089732    0.145405    122.978234 
[37m[36mINFO[0m[0m 03/26 06:33:35 | 0.784933    0.768458    0.980007    0.828148    0.825657    0.984982    0.964664    0.607059    0.580038    0.762757    0.760671    0.980007    0.828148    3600        23.991114   0.091438    0.125726    124.533932 
[37m[36mINFO[0m[0m 03/26 06:36:11 | 0.768679    0.768793    0.981118    0.829630    0.794733    0.979682    0.957597    0.594824    0.606403    0.731531    0.742378    0.981118    0.829630    3800        25.323954   0.063314    0.162594    122.919797 
[37m[36mINFO[0m[0m 03/26 06:38:40 | 0.769981    0.768176    0.984450    0.838519    0.782753    0.983216    0.961131    0.570824    0.578154    0.755903    0.765244    0.984450    0.838519    4000        26.656794   0.076801    0.122288    125.001711 
[37m[36mINFO[0m[0m 03/26 06:41:09 | 0.754051    0.743529    0.976305    0.807407    0.888189    0.980565    0.964664    0.563765    0.555556    0.717822    0.710366    0.976305    0.807407    4200        27.989633   0.054911    0.125772    122.974669 
[37m[36mINFO[0m[0m 03/26 06:44:07 | 0.743125    0.732110    0.983340    0.823704    0.813957    0.977032    0.964664    0.532235    0.519774    0.720107    0.711890    0.983340    0.823704    4400        29.322473   0.066879    0.278891    122.231359 
[37m[36mINFO[0m[0m 03/26 06:46:37 | 0.765479    0.761684    0.985191    0.826667    0.674079    0.981449    0.968198    0.573176    0.566855    0.741813    0.750000    0.985191    0.826667    4600        30.655313   0.084419    0.136312    123.358599 
[37m[36mINFO[0m[0m 03/26 06:49:07 | 0.745408    0.745346    0.987782    0.811852    0.966296    0.978799    0.971731    0.528941    0.531073    0.728484    0.733232    0.987782    0.811852    4800        31.988153   0.040900    0.125878    124.421341 
[37m[36mINFO[0m[0m 03/26 06:51:35 | 0.776268    0.772182    0.987782    0.840000    0.766946    0.986749    0.961131    0.587294    0.593220    0.754760    0.762195    0.987782    0.840000    5000        33.320992   0.038741    0.123130    123.208856 
[37m[36mINFO[0m[0m 03/26 06:51:35 | Cumulative gradient change saved at train_output/VLCS/ERM/[0, 1, 2]/250326_05-45-35_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 06:51:36 | ---
[37m[36mINFO[0m[0m 03/26 06:51:36 | test-domain validation(oracle) = 77.412%
[37m[36mINFO[0m[0m 03/26 06:51:36 | training-domain validation(iid) = 77.627%
[37m[36mINFO[0m[0m 03/26 06:51:36 | last = 77.627%
[37m[36mINFO[0m[0m 03/26 06:51:36 | last (inD) = 84.000%
[37m[36mINFO[0m[0m 03/26 06:51:36 | training-domain validation (iid, inD) = 84.000%
[37m[36mINFO[0m[0m 03/26 06:51:36 | === Summary ===
[37m[36mINFO[0m[0m 03/26 06:51:36 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset VLCS --trial_seed 1 --hparams_seed 8
[37m[36mINFO[0m[0m 03/26 06:51:36 | Unique name: 250326_05-45-35_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 06:51:36 | Out path: train_output/VLCS/ERM/[0, 1, 2]/250326_05-45-35_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 06:51:36 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 06:51:36 | Dataset: VLCS

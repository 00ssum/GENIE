[37m[36mINFO[0m[0m 03/25 20:36:44 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset VLCS --trial_seed 1 --hparams_seed 0
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[0, 1, 2]/250325_20-36-44_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 1
	unique_name: 250325_20-36-44_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/25 20:36:44 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 20:36:44 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 20:36:44 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 20:36:44 | 
[37m[36mINFO[0m[0m 03/25 20:36:44 | Testenv name escaping te_C_L_S -> te_C_L_S
[37m[36mINFO[0m[0m 03/25 20:36:44 | Test envs = [0, 1, 2], name = te_C_L_S
[37m[36mINFO[0m[0m 03/25 20:36:44 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 03/25 20:36:44 | Batch sizes for each domain: [0, 0, 0, 32] (total=32)
[37m[36mINFO[0m[0m 03/25 20:36:44 | steps-per-epoch for each domain: 84.41 -> min = 84.41
[37m[36mINFO[0m[0m 03/25 20:36:45 | # of params = 23518277
[37m[36mINFO[0m[0m 03/25 20:38:52 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 20:38:52 | 0.487823    0.502888    0.469456    0.407407    1.405641    0.628092    0.636042    0.464471    0.459510    0.370906    0.413110    0.469456    0.407407    0           0.000000    1.737476    0.985382    126.058161 
[37m[36mINFO[0m[0m 03/25 20:41:38 | 0.767408    0.769324    0.901518    0.845926    0.427677    0.980565    0.964664    0.556235    0.553672    0.765423    0.789634    0.901518    0.845926    200         2.369493    0.488596    0.179221    129.885535 
[37m[36mINFO[0m[0m 03/25 20:44:33 | 0.776680    0.773168    0.925213    0.857778    0.432844    0.987633    0.961131    0.573176    0.568738    0.769231    0.789634    0.925213    0.857778    400         4.738986    0.298675    0.242581    126.304536 
[37m[36mINFO[0m[0m 03/25 20:47:13 | 0.790178    0.794512    0.929656    0.856296    0.424588    0.986749    0.978799    0.642353    0.644068    0.741432    0.760671    0.929656    0.856296    600         7.108478    0.219937    0.181187    123.936094 
[37m[36mINFO[0m[0m 03/25 20:49:58 | 0.760789    0.760191    0.935209    0.841481    0.591547    0.991166    0.985866    0.572235    0.570621    0.718964    0.724085    0.935209    0.841481    800         9.477971    0.192173    0.176484    129.637198 
[37m[36mINFO[0m[0m 03/25 20:52:41 | 0.781142    0.778865    0.964458    0.851852    0.586488    0.985866    0.957597    0.596706    0.596987    0.760853    0.782012    0.964458    0.851852    1000        11.847464   0.140605    0.176217    127.561777 
[37m[36mINFO[0m[0m 03/25 20:55:36 | 0.763870    0.760919    0.972233    0.841481    0.652744    0.981449    0.971731    0.545882    0.544256    0.764280    0.766768    0.972233    0.841481    1200        14.216957   0.105714    0.216615    131.780823 
[37m[36mINFO[0m[0m 03/25 20:58:24 | 0.777816    0.770538    0.973343    0.840000    0.640023    0.978799    0.961131    0.601412    0.591337    0.753237    0.759146    0.973343    0.840000    1400        16.586449   0.094391    0.203832    127.885692 
[37m[36mINFO[0m[0m 03/25 21:01:09 | 0.794865    0.798385    0.985561    0.848889    0.588657    0.982332    0.957597    0.633412    0.640301    0.768850    0.797256    0.985561    0.848889    1600        18.955942   0.087566    0.170452    130.581989 
[37m[36mINFO[0m[0m 03/25 21:03:54 | 0.776651    0.769026    0.989633    0.834074    0.610569    0.987633    0.982332    0.580706    0.576271    0.761615    0.748476    0.989633    0.834074    1800        21.325435   0.061070    0.196101    125.642702 
[37m[36mINFO[0m[0m 03/25 21:06:38 | 0.762324    0.754612    0.977046    0.817778    0.811984    0.988516    0.971731    0.570353    0.564972    0.728104    0.727134    0.977046    0.817778    2000        23.694928   0.056721    0.183030    127.272467 
[37m[36mINFO[0m[0m 03/25 21:09:41 | 0.776056    0.765588    0.982229    0.834074    0.781914    0.977915    0.964664    0.586353    0.566855    0.763899    0.765244    0.982229    0.834074    2200        26.064421   0.048557    0.281931    126.699874 
[37m[36mINFO[0m[0m 03/25 21:12:28 | 0.773064    0.763592    0.967419    0.829630    0.707964    0.968198    0.957597    0.596235    0.604520    0.754760    0.728659    0.967419    0.829630    2400        28.433913   0.070542    0.203878    126.579139 
[37m[36mINFO[0m[0m 03/25 21:15:12 | 0.764596    0.762551    0.974084    0.816296    0.783697    0.962014    0.950530    0.587294    0.593220    0.744478    0.743902    0.974084    0.816296    2600        30.803406   0.059660    0.179707    128.125113 
[37m[36mINFO[0m[0m 03/25 21:17:57 | 0.782318    0.777856    0.990004    0.840000    0.835783    0.980565    0.968198    0.607059    0.621469    0.759330    0.743902    0.990004    0.840000    2800        33.172899   0.035360    0.174598    129.330747 
[37m[36mINFO[0m[0m 03/25 21:20:39 | 0.740128    0.735177    0.977786    0.811852    0.846987    0.977915    0.961131    0.546353    0.538606    0.696116    0.705793    0.977786    0.811852    3000        35.542392   0.039153    0.174099    127.775130 
[37m[36mINFO[0m[0m 03/25 21:23:28 | 0.763426    0.764105    0.995557    0.844444    0.821204    0.973498    0.968198    0.566588    0.564972    0.750190    0.759146    0.995557    0.844444    3200        37.911884   0.032571    0.190721    130.746863 
[37m[36mINFO[0m[0m 03/25 21:26:13 | 0.782716    0.780725    0.994076    0.837037    0.984211    0.981449    0.968198    0.596706    0.602637    0.769992    0.771341    0.994076    0.837037    3400        40.281377   0.024906    0.185799    127.766348 
[37m[36mINFO[0m[0m 03/25 21:28:55 | 0.772968    0.773581    0.990744    0.822222    0.848580    0.977032    0.968198    0.578353    0.578154    0.763519    0.774390    0.990744    0.822222    3600        42.650870   0.034966    0.172800    127.057329 
[37m[36mINFO[0m[0m 03/25 21:31:40 | 0.769816    0.765492    0.968900    0.801481    1.173544    0.946996    0.936396    0.618353    0.617702    0.744097    0.742378    0.968900    0.801481    3800        45.020363   0.045835    0.188702    128.006739 
[37m[36mINFO[0m[0m 03/25 21:34:26 | 0.767403    0.759903    0.995187    0.842963    1.089099    0.994700    0.971731    0.577882    0.576271    0.729627    0.731707    0.995187    0.842963    4000        47.389856   0.020332    0.200138    125.928626 
[37m[36mINFO[0m[0m 03/25 21:37:10 | 0.780024    0.781951    0.989263    0.823704    0.931964    0.977915    0.968198    0.610824    0.613936    0.751333    0.763720    0.989263    0.823704    4200        49.759348   0.028797    0.176114    128.724412 
[37m[36mINFO[0m[0m 03/25 21:39:59 | 0.784579    0.787750    0.992595    0.842963    0.838659    0.982332    0.985866    0.601412    0.604520    0.769992    0.772866    0.992595    0.842963    4400        52.128841   0.024508    0.208305    126.540026 
[37m[36mINFO[0m[0m 03/25 21:42:42 | 0.772935    0.768787    0.997038    0.831111    0.899996    0.976148    0.964664    0.584471    0.593220    0.758187    0.748476    0.997038    0.831111    4600        54.498334   0.030982    0.179918    127.098238 
[37m[36mINFO[0m[0m 03/25 21:45:23 | 0.784611    0.787331    0.982599    0.804444    1.267375    0.968198    0.950530    0.622118    0.623352    0.763519    0.788110    0.982599    0.804444    4800        56.867827   0.022631    0.184545    124.849098 
[37m[36mINFO[0m[0m 03/25 21:48:07 | 0.776501    0.778351    0.998149    0.841481    1.008049    0.969081    0.964664    0.587765    0.583804    0.772658    0.786585    0.998149    0.841481    5000        59.237320   0.016941    0.194214    125.104567 
[37m[36mINFO[0m[0m 03/25 21:48:07 | Cumulative gradient change saved at train_output/VLCS/ERM/[0, 1, 2]/250325_20-36-44_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 21:48:09 | ---
[37m[36mINFO[0m[0m 03/25 21:48:09 | test-domain validation(oracle) = 79.486%
[37m[36mINFO[0m[0m 03/25 21:48:09 | training-domain validation(iid) = 77.668%
[37m[36mINFO[0m[0m 03/25 21:48:09 | last = 77.650%
[37m[36mINFO[0m[0m 03/25 21:48:09 | last (inD) = 84.148%
[37m[36mINFO[0m[0m 03/25 21:48:09 | training-domain validation (iid, inD) = 85.778%
[37m[36mINFO[0m[0m 03/25 21:48:09 | === Summary ===
[37m[36mINFO[0m[0m 03/25 21:48:09 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset VLCS --trial_seed 1 --hparams_seed 0
[37m[36mINFO[0m[0m 03/25 21:48:09 | Unique name: 250325_20-36-44_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 21:48:09 | Out path: train_output/VLCS/ERM/[0, 1, 2]/250325_20-36-44_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 21:48:09 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 21:48:09 | Dataset: VLCS

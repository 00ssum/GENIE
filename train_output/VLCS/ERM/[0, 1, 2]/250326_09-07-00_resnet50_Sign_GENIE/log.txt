[37m[36mINFO[0m[0m 03/26 09:07:00 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset VLCS --trial_seed 1 --hparams_seed 11
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 11
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[0, 1, 2]/250326_09-07-00_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 1
	unique_name: 250326_09-07-00_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5.340583028754034e-05
	batch_size: 10
	weight_decay: 2.5000172438864113e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/26 09:07:00 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 09:07:00 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 09:07:00 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 09:07:00 | 
[37m[36mINFO[0m[0m 03/26 09:07:00 | Testenv name escaping te_C_L_S -> te_C_L_S
[37m[36mINFO[0m[0m 03/26 09:07:00 | Test envs = [0, 1, 2], name = te_C_L_S
[37m[36mINFO[0m[0m 03/26 09:07:00 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 03/26 09:07:00 | Batch sizes for each domain: [0, 0, 0, 10] (total=10)
[37m[36mINFO[0m[0m 03/26 09:07:00 | steps-per-epoch for each domain: 270.10 -> min = 270.10
[37m[36mINFO[0m[0m 03/26 09:07:01 | # of params = 23518277
[37m[36mINFO[0m[0m 03/26 09:09:03 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 09:09:03 | 0.031809    0.036709    0.144391    0.137778    1.677155    0.052120    0.070671    0.017412    0.015066    0.025895    0.024390    0.144391    0.137778    0           0.000000    1.735376    0.911866    121.536474 
[37m[36mINFO[0m[0m 03/26 09:11:32 | 0.714781    0.725420    0.776379    0.748148    0.685024    0.901060    0.904594    0.624471    0.617702    0.618812    0.653963    0.776379    0.748148    200         0.740466    0.821200    0.126996    123.290227 
[37m[36mINFO[0m[0m 03/26 09:13:59 | 0.780110    0.777510    0.833395    0.797037    0.555356    0.962898    0.954064    0.664941    0.642185    0.712490    0.736280    0.833395    0.797037    400         1.480933    0.624009    0.131119    120.694355 
[37m[36mINFO[0m[0m 03/26 09:16:23 | 0.765077    0.760475    0.847834    0.802963    0.627700    0.959364    0.946996    0.578824    0.563089    0.757045    0.771341    0.847834    0.802963    600         2.221399    0.560009    0.114155    120.717397 
[37m[36mINFO[0m[0m 03/26 09:18:54 | 0.702691    0.702278    0.826361    0.765926    0.694498    0.927562    0.929329    0.552941    0.523540    0.627570    0.653963    0.826361    0.765926    800         2.961866    0.448113    0.144103    122.183310 
[37m[36mINFO[0m[0m 03/26 09:21:19 | 0.758115    0.753039    0.885968    0.801481    0.536378    0.975265    0.957597    0.557647    0.542373    0.741432    0.759146    0.885968    0.801481    1000        3.702332    0.416795    0.106536    123.753623 
[37m[36mINFO[0m[0m 03/26 09:23:50 | 0.759492    0.759295    0.883377    0.798519    0.718003    0.980565    0.985866    0.609412    0.604520    0.688500    0.687500    0.883377    0.798519    1200        4.442799    0.425397    0.134510    124.649377 
[37m[36mINFO[0m[0m 03/26 09:26:17 | 0.722108    0.708757    0.820807    0.755556    0.691925    0.946996    0.918728    0.538824    0.529190    0.680503    0.678354    0.820807    0.755556    1400        5.183265    0.458200    0.130526    120.815222 
[37m[36mINFO[0m[0m 03/26 09:28:41 | 0.754233    0.742315    0.894484    0.802963    0.573646    0.970848    0.950530    0.573647    0.570621    0.718203    0.705793    0.894484    0.802963    1600        5.923732    0.457500    0.111429    121.251022 
[37m[36mINFO[0m[0m 03/26 09:31:14 | 0.785571    0.779585    0.872270    0.794074    0.658054    0.956714    0.957597    0.689412    0.672316    0.710586    0.708841    0.872270    0.794074    1800        6.664198    0.396362    0.157603    121.755140 
[37m[36mINFO[0m[0m 03/26 09:33:38 | 0.775471    0.777898    0.904480    0.810370    0.505342    0.976148    0.971731    0.618353    0.619586    0.731912    0.742378    0.904480    0.810370    2000        7.404665    0.338949    0.112500    121.405957 
[37m[36mINFO[0m[0m 03/26 09:36:05 | 0.770103    0.765845    0.917438    0.811852    0.565261    0.969081    0.961131    0.592941    0.589454    0.748286    0.746951    0.917438    0.811852    2200        8.145131    0.338089    0.129228    121.455939 
[37m[36mINFO[0m[0m 03/26 09:38:34 | 0.757279    0.752405    0.896335    0.798519    0.684028    0.955830    0.929329    0.600471    0.600753    0.715537    0.727134    0.896335    0.798519    2400        8.885598    0.289862    0.129687    122.879922 
[37m[36mINFO[0m[0m 03/26 09:41:07 | 0.768933    0.758117    0.886338    0.780741    0.756461    0.983216    0.982332    0.612235    0.604520    0.711348    0.687500    0.886338    0.780741    2600        9.626064    0.298081    0.157269    121.226369 
[37m[36mINFO[0m[0m 03/26 09:43:36 | 0.758817    0.766025    0.864124    0.770370    0.757500    0.927562    0.925795    0.655059    0.649718    0.693831    0.722561    0.864124    0.770370    2800        10.366531   0.413126    0.133205    122.885139 
[37m[36mINFO[0m[0m 03/26 09:46:00 | 0.767279    0.777958    0.881525    0.765926    0.734308    0.970848    0.954064    0.647059    0.657250    0.683930    0.722561    0.881525    0.765926    3000        11.106997   0.276971    0.111339    121.200777 
[37m[36mINFO[0m[0m 03/26 09:48:26 | 0.767596    0.764100    0.929285    0.819259    0.529981    0.960247    0.939929    0.627765    0.625235    0.714775    0.727134    0.929285    0.819259    3200        11.847464   0.296048    0.138341    118.703002 
[37m[36mINFO[0m[0m 03/26 09:50:56 | 0.764576    0.756208    0.927434    0.792593    0.667984    0.967314    0.957597    0.573176    0.576271    0.753237    0.734756    0.927434    0.792593    3400        12.587930   0.258338    0.154637    118.875636 
[37m[36mINFO[0m[0m 03/26 09:53:24 | 0.764005    0.759342    0.940763    0.816296    0.621991    0.984099    0.982332    0.584000    0.583804    0.723915    0.711890    0.940763    0.816296    3600        13.328397   0.223161    0.132132    121.549822 
[37m[36mINFO[0m[0m 03/26 09:55:50 | 0.774879    0.759473    0.962236    0.834074    0.618638    0.982332    0.968198    0.598588    0.580038    0.743717    0.730183    0.962236    0.834074    3800        14.068863   0.184372    0.133232    119.707184 
[37m[36mINFO[0m[0m 03/26 09:58:13 | 0.754697    0.750647    0.931137    0.811852    0.641304    0.919611    0.922261    0.600000    0.578154    0.744478    0.751524    0.931137    0.811852    4000        14.809330   0.212585    0.114334    120.218278 
[37m[36mINFO[0m[0m 03/26 10:00:51 | 0.771634    0.756143    0.942614    0.804444    0.742784    0.970848    0.964664    0.603765    0.578154    0.740289    0.725610    0.942614    0.804444    4200        15.549796   0.229660    0.170928    123.118440 
[37m[36mINFO[0m[0m 03/26 10:03:17 | 0.744872    0.735888    0.941133    0.791111    0.795362    0.969965    0.950530    0.562824    0.557439    0.701828    0.699695    0.941133    0.791111    4400        16.290263   0.181921    0.121458    121.875065 
[37m[36mINFO[0m[0m 03/26 10:05:42 | 0.754019    0.740338    0.920400    0.789630    0.861810    0.977032    0.975265    0.595765    0.585687    0.689261    0.660061    0.920400    0.789630    4600        17.030729   0.211875    0.130245    119.184214 
[37m[36mINFO[0m[0m 03/26 10:08:09 | 0.779793    0.766934    0.945946    0.808889    0.833696    0.970848    0.946996    0.644235    0.632768    0.724296    0.721037    0.945946    0.808889    4800        17.771196   0.194545    0.130542    120.894557 
[37m[36mINFO[0m[0m 03/26 10:10:41 | 0.775246    0.759454    0.947057    0.792593    0.756646    0.957597    0.936396    0.620235    0.602637    0.747906    0.739329    0.947057    0.792593    5000        18.511662   0.161956    0.163589    119.124553 
[37m[36mINFO[0m[0m 03/26 10:10:41 | Cumulative gradient change saved at train_output/VLCS/ERM/[0, 1, 2]/250326_09-07-00_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 10:10:42 | ---
[37m[36mINFO[0m[0m 03/26 10:10:42 | test-domain validation(oracle) = 78.557%
[37m[36mINFO[0m[0m 03/26 10:10:42 | training-domain validation(iid) = 77.488%
[37m[36mINFO[0m[0m 03/26 10:10:42 | last = 77.525%
[37m[36mINFO[0m[0m 03/26 10:10:42 | last (inD) = 79.259%
[37m[36mINFO[0m[0m 03/26 10:10:42 | training-domain validation (iid, inD) = 83.407%
[37m[36mINFO[0m[0m 03/26 10:10:42 | === Summary ===
[37m[36mINFO[0m[0m 03/26 10:10:42 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset VLCS --trial_seed 1 --hparams_seed 11
[37m[36mINFO[0m[0m 03/26 10:10:42 | Unique name: 250326_09-07-00_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 10:10:42 | Out path: train_output/VLCS/ERM/[0, 1, 2]/250326_09-07-00_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 10:10:42 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 10:10:42 | Dataset: VLCS

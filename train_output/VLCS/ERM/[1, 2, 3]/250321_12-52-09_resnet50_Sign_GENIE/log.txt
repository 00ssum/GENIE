[37m[36mINFO[0m[0m 03/21 12:52:09 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 2 3 --dataset VLCS --trial_seed 1 --hparams_seed 14
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 14
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/VLCS/ERM/[1, 2, 3]/250321_12-52-09_resnet50_Sign_GENIE
	out_root: train_output/VLCS/ERM/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 1
	unique_name: 250321_12-52-09_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00011127987942826837
	batch_size: 12
	weight_decay: 3.236767350601091e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 03/21 12:52:09 | n_steps = 5001
[37m[36mINFO[0m[0m 03/21 12:52:09 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/21 12:52:09 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/21 12:52:09 | 
[37m[36mINFO[0m[0m 03/21 12:52:09 | Testenv name escaping te_L_S_V -> te_L_S_V
[37m[36mINFO[0m[0m 03/21 12:52:09 | Test envs = [1, 2, 3], name = te_L_S_V
[37m[36mINFO[0m[0m 03/21 12:52:09 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 03/21 12:52:09 | Batch sizes for each domain: [12, 0, 0, 0] (total=12)
[37m[36mINFO[0m[0m 03/21 12:52:09 | steps-per-epoch for each domain: 94.33 -> min = 94.33
[37m[36mINFO[0m[0m 03/21 12:52:10 | # of params = 23518277
[37m[36mINFO[0m[0m 03/21 12:54:07 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/21 12:54:07 | 0.432326    0.428842    0.613958    0.618375    1.077924    0.613958    0.618375    0.466824    0.461394    0.376618    0.419207    0.453536    0.405926    0           0.000000    1.833673    1.645620    115.246567 
[37m[36mINFO[0m[0m 03/21 12:56:42 | 0.564497    0.560175    0.999117    1.000000    0.001023    0.999117    1.000000    0.513882    0.502825    0.575019    0.576220    0.604591    0.601481    200         2.120141    0.084375    0.192222    116.179319 
[37m[36mINFO[0m[0m 03/21 12:59:19 | 0.483080    0.473997    0.998233    0.992933    0.008522    0.998233    0.992933    0.473882    0.459510    0.525895    0.509146    0.449463    0.453333    400         4.240283    0.023313    0.194204    118.026805 
[37m[36mINFO[0m[0m 03/21 13:01:51 | 0.486770    0.490659    1.000000    0.996466    0.004366    1.000000    0.996466    0.455059    0.451977    0.495811    0.500000    0.509441    0.520000    600         6.360424    0.014465    0.173185    117.821339 
[37m[36mINFO[0m[0m 03/21 13:04:27 | 0.478548    0.484499    1.000000    0.996466    0.006072    1.000000    0.996466    0.450353    0.450094    0.483625    0.489329    0.501666    0.514074    800         8.480565    0.000240    0.171718    121.063237 
[37m[36mINFO[0m[0m 03/21 13:06:58 | 0.489374    0.496924    1.000000    0.996466    0.003707    1.000000    0.996466    0.454588    0.455744    0.500762    0.507622    0.512773    0.527407    1000        10.600707   0.000041    0.160599    119.249080 
[37m[36mINFO[0m[0m 03/21 13:09:27 | 0.484281    0.489762    1.000000    0.996466    0.003698    1.000000    0.996466    0.451294    0.453861    0.495811    0.495427    0.505739    0.520000    1200        12.720848   0.000050    0.152172    118.232281 
[37m[36mINFO[0m[0m 03/21 13:11:55 | 0.485910    0.491781    1.000000    0.996466    0.002734    1.000000    0.996466    0.451294    0.453861    0.498477    0.500000    0.507960    0.521481    1400        14.840989   0.000028    0.144591    119.056559 
[37m[36mINFO[0m[0m 03/21 13:14:28 | 0.496074    0.509216    1.000000    1.000000    0.001328    1.000000    1.000000    0.453647    0.459510    0.511805    0.525915    0.522769    0.542222    1600        16.961131   0.000190    0.161634    121.176639 
[37m[36mINFO[0m[0m 03/21 13:17:05 | 0.490302    0.499868    1.000000    0.996466    0.002562    1.000000    0.996466    0.451765    0.453861    0.502666    0.519817    0.516475    0.525926    1800        19.081272   0.000017    0.183970    120.377177 
[37m[36mINFO[0m[0m 03/21 13:19:40 | 0.499494    0.506775    1.000000    1.000000    0.002132    1.000000    1.000000    0.458353    0.459510    0.511805    0.528963    0.528323    0.531852    2000        21.201413   0.000027    0.180310    118.693854 
[37m[36mINFO[0m[0m 03/21 13:22:12 | 0.497431    0.507092    1.000000    1.000000    0.001788    1.000000    1.000000    0.455529    0.457627    0.510663    0.524390    0.526101    0.539259    2200        23.321555   0.000044    0.173494    117.540634 
[37m[36mINFO[0m[0m 03/21 13:24:45 | 0.492097    0.500319    1.000000    1.000000    0.001457    1.000000    1.000000    0.452706    0.453861    0.502666    0.515244    0.520918    0.531852    2400        25.441696   0.000004    0.172643    118.419702 
[37m[36mINFO[0m[0m 03/21 13:27:20 | 0.487878    0.496848    1.000000    0.996466    0.004462    1.000000    0.996466    0.449412    0.453861    0.498858    0.513720    0.515365    0.522963    2600        27.561837   0.000033    0.172949    119.980805 
[37m[36mINFO[0m[0m 03/21 13:29:43 | 0.484830    0.495712    1.000000    0.996466    0.004743    1.000000    0.996466    0.447059    0.451977    0.494288    0.512195    0.513143    0.522963    2800        29.681979   0.000008    0.137094    116.075588 
[37m[36mINFO[0m[0m 03/21 13:32:20 | 0.486423    0.499465    1.000000    0.996466    0.003994    1.000000    0.996466    0.449882    0.455744    0.498096    0.515244    0.511292    0.527407    3000        31.802120   0.000009    0.191684    117.953026 
[37m[36mINFO[0m[0m 03/21 13:34:51 | 0.488116    0.499839    1.000000    0.996466    0.003390    1.000000    0.996466    0.450824    0.453861    0.500381    0.516768    0.513143    0.528889    3200        33.922261   0.000005    0.167126    117.807923 
[37m[36mINFO[0m[0m 03/21 13:37:30 | 0.490870    0.499839    1.000000    0.996466    0.003141    1.000000    0.996466    0.452706    0.453861    0.503427    0.516768    0.516475    0.528889    3400        36.042403   0.000003    0.202698    118.203187 
[37m[36mINFO[0m[0m 03/21 13:40:14 | 0.489838    0.498823    1.000000    1.000000    0.002393    1.000000    1.000000    0.452235    0.453861    0.502285    0.513720    0.514994    0.528889    3600        38.162544   0.000017    0.223810    119.885101 
[37m[36mINFO[0m[0m 03/21 13:42:52 | 0.487850    0.499317    1.000000    0.996466    0.003307    1.000000    0.996466    0.450353    0.453861    0.501904    0.513720    0.511292    0.530370    3800        40.282686   0.000003    0.204291    116.277515 
[37m[36mINFO[0m[0m 03/21 13:45:26 | 0.407496    0.415432    0.998233    0.992933    0.018966    0.998233    0.992933    0.393412    0.414313    0.404417    0.399390    0.424658    0.432593    4000        42.402827   0.031067    0.175725    119.472845 
[37m[36mINFO[0m[0m 03/21 13:48:07 | 0.391687    0.395291    1.000000    0.996466    0.006944    1.000000    0.996466    0.385412    0.389831    0.384615    0.385671    0.405035    0.410370    4200        44.522968   0.001116    0.210159    119.189401 
[37m[36mINFO[0m[0m 03/21 13:50:42 | 0.381268    0.385573    1.000000    1.000000    0.005013    1.000000    1.000000    0.383529    0.395480    0.366717    0.359756    0.393558    0.401481    4400        46.643110   0.000111    0.178592    118.780486 
[37m[36mINFO[0m[0m 03/21 13:53:11 | 0.394626    0.398251    1.000000    0.996466    0.004451    1.000000    0.996466    0.393412    0.404896    0.387281    0.376524    0.403184    0.413333    4600        48.763251   0.000055    0.157699    117.293806 
[37m[36mINFO[0m[0m 03/21 13:55:42 | 0.393388    0.396502    1.000000    0.996466    0.004482    1.000000    0.996466    0.391529    0.401130    0.388043    0.376524    0.400592    0.411852    4800        50.883392   0.000069    0.157611    120.207510 
[37m[36mINFO[0m[0m 03/21 13:58:14 | 0.392342    0.395754    1.000000    1.000000    0.003080    1.000000    1.000000    0.394824    0.404896    0.383092    0.373476    0.399111    0.408889    5000        53.003534   0.000089    0.170554    117.837955 
[37m[36mINFO[0m[0m 03/21 13:58:15 | Cumulative gradient change saved at train_output/VLCS/ERM/[1, 2, 3]/250321_12-52-09_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/21 13:58:16 | ---
[37m[36mINFO[0m[0m 03/21 13:58:16 | test-domain validation(oracle) = 56.450%
[37m[36mINFO[0m[0m 03/21 13:58:16 | training-domain validation(iid) = 56.450%
[37m[36mINFO[0m[0m 03/21 13:58:16 | last = 39.234%
[37m[36mINFO[0m[0m 03/21 13:58:16 | last (inD) = 100.000%
[37m[36mINFO[0m[0m 03/21 13:58:16 | training-domain validation (iid, inD) = 100.000%
[37m[36mINFO[0m[0m 03/21 13:58:16 | === Summary ===
[37m[36mINFO[0m[0m 03/21 13:58:16 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 2 3 --dataset VLCS --trial_seed 1 --hparams_seed 14
[37m[36mINFO[0m[0m 03/21 13:58:16 | Unique name: 250321_12-52-09_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/21 13:58:16 | Out path: train_output/VLCS/ERM/[1, 2, 3]/250321_12-52-09_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/21 13:58:16 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/21 13:58:16 | Dataset: VLCS

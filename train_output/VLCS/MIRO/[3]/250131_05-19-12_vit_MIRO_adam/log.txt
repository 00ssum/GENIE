[37m[36mINFO[0m[0m 01/31 05:19:12 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py vit_MIRO_adam config/vit_MIRO_adam.yaml --algorithm MIRO --test_envs 3 --dataset VLCS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: MIRO
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/vit_MIRO_adam.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: vit_MIRO_adam
	out_dir: train_output/VLCS/MIRO/[3]/250131_05-19-12_vit_MIRO_adam
	out_root: train_output/VLCS/MIRO/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250131_05-19-12_vit_MIRO_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 01/31 05:19:12 | n_steps = 5001
[37m[36mINFO[0m[0m 01/31 05:19:12 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/31 05:19:12 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/31 05:19:12 | Target test envs = [[3]]
[37m[36mINFO[0m[0m 01/31 05:19:12 | 
[37m[36mINFO[0m[0m 01/31 05:19:12 | Testenv name escaping te_V -> te_V
[37m[36mINFO[0m[0m 01/31 05:19:12 | Test envs = [3], name = te_V
[37m[36mINFO[0m[0m 01/31 05:19:12 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 01/31 05:19:12 | steps-per-epoch for each domain: 35.38, 66.41, 82.06 -> min = 35.38
[37m[36mINFO[0m[0m 01/31 05:19:16 | # of params = 172391685
[37m[36mINFO[0m[0m 01/31 05:21:25 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        reg_loss    step_time   eval_time  
[37m[36mINFO[0m[0m 01/31 05:21:25 | 0.514624    0.527407    0.612703    0.642552    1.067325    0.771201    0.770318    0.580235    0.649718    0.486672    0.507622    0.514624    0.527407    0           0.000000    1.104715    -5.756463   1.225827    127.471778 
[37m[36mINFO[0m[0m 01/31 05:27:12 | 0.781192    0.782222    0.929895    0.883931    0.310905    0.999117    1.000000    0.858353    0.796610    0.932216    0.855183    0.781192    0.782222    200         5.653710    -0.198900   -4.912702   1.085061    128.251196 
[37m[36mINFO[0m[0m 01/31 05:33:00 | 0.796001    0.804444    0.953321    0.884141    0.362829    0.998233    1.000000    0.904000    0.807910    0.957730    0.844512    0.796001    0.804444    400         11.307420   -0.319080   -4.902709   1.076964    131.097412 
[37m[36mINFO[0m[0m 01/31 05:38:46 | 0.732692    0.760000    0.973125    0.866254    0.462756    0.999117    0.996466    0.955294    0.792844    0.964966    0.809451    0.732692    0.760000    600         16.961131   -0.388046   -4.954440   1.071180    130.337249 
[37m[36mINFO[0m[0m 01/31 05:44:24 | 0.716401    0.737778    0.982379    0.880344    0.459107    0.999117    1.000000    0.975059    0.804143    0.972963    0.836890    0.716401    0.737778    800         22.614841   -0.435695   -5.104409   1.051808    127.713131 
[37m[36mINFO[0m[0m 01/31 05:50:07 | 0.764161    0.794074    0.971352    0.865208    0.534582    0.998233    0.996466    0.952000    0.800377    0.963823    0.798780    0.764161    0.794074    1000        28.268551   -0.432885   -5.102792   1.062087    130.360220 
[37m[36mINFO[0m[0m 01/31 05:55:49 | 0.765642    0.776296    0.982808    0.856611    0.560523    1.000000    1.000000    0.973176    0.766478    0.975248    0.803354    0.765642    0.776296    1200        33.922261   -0.479564   -5.302554   1.059786    130.338587 
[37m[36mINFO[0m[0m 01/31 06:01:29 | 0.758238    0.739259    0.970919    0.856599    0.729603    1.000000    0.996466    0.961882    0.792844    0.950876    0.780488    0.758238    0.739259    1400        39.575972   -0.487575   -5.364084   1.051651    129.799475 
[37m[36mINFO[0m[0m 01/31 06:07:09 | 0.765642    0.755556    0.992487    0.875532    0.540429    1.000000    1.000000    0.989647    0.800377    0.987814    0.826220    0.765642    0.755556    1600        45.229682   -0.512350   -5.528980   1.060839    127.459025 
[37m[36mINFO[0m[0m 01/31 06:12:49 | 0.668641    0.682963    0.987398    0.868364    0.561765    0.997350    0.992933    0.977412    0.796610    0.987433    0.815549    0.668641    0.682963    1800        50.883392   -0.521557   -5.596455   1.058782    128.406407 
[37m[36mINFO[0m[0m 01/31 06:18:33 | 0.728619    0.733333    0.985189    0.870181    0.641031    1.000000    1.000000    0.964706    0.772128    0.990861    0.838415    0.728619    0.733333    2000        56.537102   -0.550612   -5.790987   1.065221    130.769604 
[37m[36mINFO[0m[0m 01/31 06:24:17 | 0.741577    0.746667    0.982911    0.865954    0.688496    1.000000    0.996466    0.962824    0.772128    0.985910    0.829268    0.741577    0.746667    2200        62.190813   -0.554876   -5.875283   1.064684    130.917493 
[37m[36mINFO[0m[0m 01/31 06:29:59 | 0.751573    0.745185    0.992995    0.870779    0.579660    1.000000    1.000000    0.989647    0.781544    0.989337    0.830793    0.751573    0.745185    2400        67.844523   -0.577075   -6.040627   1.062702    129.760150 
[37m[36mINFO[0m[0m 01/31 06:35:41 | 0.720474    0.725926    0.993346    0.866565    0.632214    1.000000    1.000000    0.989176    0.787194    0.990861    0.812500    0.720474    0.725926    2600        73.498233   -0.585809   -6.123937   1.064519    129.467706 
[37m[36mINFO[0m[0m 01/31 06:41:25 | 0.743799    0.740741    0.992494    0.869584    0.591591    1.000000    1.000000    0.987765    0.794727    0.989718    0.814024    0.743799    0.740741    2800        79.151943   -0.589204   -6.181837   1.076950    128.556604 
[37m[36mINFO[0m[0m 01/31 06:47:07 | 0.733062    0.734815    0.993846    0.861513    0.685396    1.000000    1.000000    0.991059    0.779661    0.990480    0.804878    0.733062    0.734815    3000        84.805654   -0.599022   -6.266654   1.066937    127.950675 
[37m[36mINFO[0m[0m 01/31 06:52:49 | 0.699741    0.699259    0.992091    0.863665    0.659139    1.000000    1.000000    0.985412    0.781544    0.990861    0.809451    0.699741    0.699259    3200        90.459364   -0.617408   -6.420839   1.070513    128.017462 
[37m[36mINFO[0m[0m 01/31 06:58:32 | 0.772307    0.746667    0.992536    0.867282    0.666674    0.999117    1.000000    0.991059    0.798493    0.987433    0.803354    0.772307    0.746667    3400        96.113074   -0.625415   -6.480382   1.071598    128.943688 
[37m[36mINFO[0m[0m 01/31 07:04:15 | 0.701222    0.684444    0.994531    0.870438    0.695696    0.997350    0.996466    0.995765    0.794727    0.990480    0.820122    0.701222    0.684444    3600        101.766784  -0.652605   -6.695642   1.069046    129.638361 
[37m[36mINFO[0m[0m 01/31 07:09:59 | 0.743428    0.745185    0.992867    0.869464    0.694556    1.000000    1.000000    0.981647    0.792844    0.996954    0.815549    0.743428    0.745185    3800        107.420495  -0.663677   -6.814406   1.062687    131.001181 
[37m[36mINFO[0m[0m 01/31 07:15:43 | 0.730470    0.714074    0.992584    0.860054    0.644432    1.000000    0.992933    0.989176    0.777778    0.988576    0.809451    0.730470    0.714074    4000        113.074205  -0.675481   -6.938369   1.057515    132.181891 
[37m[36mINFO[0m[0m 01/31 07:21:24 | 0.740466    0.717037    0.996527    0.860736    0.703344    1.000000    1.000000    0.995294    0.783427    0.994288    0.798780    0.740466    0.717037    4200        118.727915  -0.666955   -6.895178   1.066301    128.037939 
[37m[36mINFO[0m[0m 01/31 07:27:07 | 0.748612    0.746667    0.991321    0.862559    0.742316    1.000000    1.000000    0.979294    0.772128    0.994669    0.815549    0.748612    0.746667    4400        124.381625  -0.702486   -7.161045   1.068017    129.495704 
[37m[36mINFO[0m[0m 01/31 07:32:47 | 0.708626    0.691852    0.995001    0.877236    0.679277    0.999117    1.000000    0.993882    0.819209    0.992003    0.812500    0.708626    0.691852    4600        130.035336  -0.695298   -7.144067   1.052266    129.087504 
[37m[36mINFO[0m[0m 01/31 07:38:31 | 0.659015    0.647407    0.987600    0.849736    0.663482    0.999117    1.000000    0.987294    0.770245    0.976390    0.778963    0.659015    0.647407    4800        135.689046  -0.679979   -7.076139   1.071530    130.014949 
[37m[36mINFO[0m[0m 01/31 07:44:17 | 0.710848    0.697778    0.990111    0.854656    0.608818    1.000000    0.996466    0.980235    0.770245    0.990099    0.797256    0.710848    0.697778    5000        141.342756  -0.699815   -7.209311   1.077985    130.430869 
[37m[36mINFO[0m[0m 01/31 07:44:17 | ---
[37m[36mINFO[0m[0m 01/31 07:44:17 | test-domain validation(oracle) = 79.600%
[37m[36mINFO[0m[0m 01/31 07:44:17 | training-domain validation(iid) = 79.600%
[37m[36mINFO[0m[0m 01/31 07:44:17 | last = 71.085%
[37m[36mINFO[0m[0m 01/31 07:44:17 | last (inD) = 85.466%
[37m[36mINFO[0m[0m 01/31 07:44:17 | training-domain validation (iid, inD) = 88.414%
[37m[36mINFO[0m[0m 01/31 07:44:17 | === Summary ===
[37m[36mINFO[0m[0m 01/31 07:44:17 | Command: /jsm0707/DomainBed/Large-scale/train_all.py vit_MIRO_adam config/vit_MIRO_adam.yaml --algorithm MIRO --test_envs 3 --dataset VLCS
[37m[36mINFO[0m[0m 01/31 07:44:17 | Unique name: 250131_05-19-12_vit_MIRO_adam
[37m[36mINFO[0m[0m 01/31 07:44:17 | Out path: train_output/VLCS/MIRO/[3]/250131_05-19-12_vit_MIRO_adam
[37m[36mINFO[0m[0m 01/31 07:44:17 | Algorithm: MIRO
[37m[36mINFO[0m[0m 01/31 07:44:17 | Dataset: VLCS
[37m[36mINFO[0m[0m 01/31 07:44:17 | Max test_in: 0.7960

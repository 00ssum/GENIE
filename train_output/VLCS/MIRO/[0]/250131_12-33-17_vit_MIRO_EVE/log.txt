[37m[36mINFO[0m[0m 01/31 12:33:17 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py vit_MIRO_EVE config/vit_MIRO_EVE.yaml --algorithm MIRO --test_envs 0 --dataset VLCS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: MIRO
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/vit_MIRO_EVE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: vit_MIRO_EVE
	out_dir: train_output/VLCS/MIRO/[0]/250131_12-33-17_vit_MIRO_EVE
	out_root: train_output/VLCS/MIRO/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250131_12-33-17_vit_MIRO_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: EVE
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 01/31 12:33:17 | n_steps = 5001
[37m[36mINFO[0m[0m 01/31 12:33:17 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/31 12:33:17 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/31 12:33:17 | Target test envs = [[0]]
[37m[36mINFO[0m[0m 01/31 12:33:17 | 
[37m[36mINFO[0m[0m 01/31 12:33:17 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 01/31 12:33:17 | Test envs = [0], name = te_C
[37m[36mINFO[0m[0m 01/31 12:33:17 | Batch sizes for each domain: [0, 32, 32, 32] (total=96)
[37m[36mINFO[0m[0m 01/31 12:33:17 | steps-per-epoch for each domain: 66.41, 82.06, 84.41 -> min = 66.41
[37m[36mINFO[0m[0m 01/31 12:33:23 | # of params = 172391685
[37m[36mINFO[0m[0m 01/31 12:35:57 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        reg_loss    step_time   eval_time  
[37m[36mINFO[0m[0m 01/31 12:35:57 | 0.575088    0.593640    0.451473    0.474686    1.295384    0.575088    0.593640    0.479529    0.510358    0.427647    0.460366    0.447242    0.453333    0           0.000000    1.062300    -5.756463   1.729886    151.704686 
[37m[36mINFO[0m[0m 01/31 12:42:58 | 0.602473    0.632509    0.574468    0.601107    0.957592    0.602473    0.632509    0.616000    0.651601    0.547982    0.600610    0.559422    0.551111    200         3.011765    1.908976    7.192465    1.270524    164.689200 
[37m[36mINFO[0m[0m 01/31 12:49:30 | 0.889576    0.901060    0.775892    0.778542    0.593723    0.889576    0.901060    0.758118    0.774011    0.805027    0.794207    0.764532    0.767407    400         6.023529    0.404780    -3.093312   1.225721    145.706295 
[37m[36mINFO[0m[0m 01/31 12:56:17 | 0.916961    0.908127    0.798961    0.771188    0.586382    0.916961    0.908127    0.758588    0.751412    0.813785    0.760671    0.824509    0.801481    600         9.035294    0.138829    -3.724085   1.295199    146.277733 
[37m[36mINFO[0m[0m 01/31 13:02:57 | 0.947880    0.929329    0.846578    0.795361    0.549205    0.947880    0.929329    0.800471    0.774011    0.849962    0.797256    0.889300    0.814815    800         12.047059   0.025977    -3.916935   1.250834    150.198104 
[37m[36mINFO[0m[0m 01/31 13:09:38 | 0.916078    0.893993    0.876720    0.799211    0.576978    0.916078    0.893993    0.856941    0.800377    0.886139    0.797256    0.887079    0.800000    1000        15.058824   -0.037799   -3.919982   1.240017    151.190387 
[37m[36mINFO[0m[0m 01/31 13:16:24 | 0.910777    0.904594    0.886425    0.774059    0.679559    0.910777    0.904594    0.854588    0.757062    0.899467    0.760671    0.905220    0.804444    1200        18.070588   -0.088663   -3.888918   1.249425    154.993870 
[37m[36mINFO[0m[0m 01/31 13:22:56 | 0.921378    0.918728    0.923823    0.794401    0.632283    0.921378    0.918728    0.901176    0.781544    0.928789    0.795732    0.941503    0.805926    1400        21.082353   -0.170006   -3.966414   1.246250    142.731040 
[37m[36mINFO[0m[0m 01/31 13:29:31 | 0.948763    0.932862    0.951120    0.801309    0.636172    0.948763    0.932862    0.932706    0.779661    0.955826    0.809451    0.964828    0.814815    1600        24.094118   -0.211555   -3.974842   1.222153    150.694541 
[37m[36mINFO[0m[0m 01/31 13:35:58 | 0.910777    0.908127    0.958337    0.788331    0.786986    0.910777    0.908127    0.940235    0.749529    0.971059    0.812500    0.963717    0.802963    1800        27.105882   -0.265402   -4.055989   1.192166    146.359929 
[37m[36mINFO[0m[0m 01/31 13:42:27 | 0.931095    0.911661    0.964933    0.791172    0.744597    0.931095    0.911661    0.955294    0.762712    0.968012    0.804878    0.971492    0.805926    2000        30.117647   -0.291397   -4.086287   1.197968    149.093835 
[37m[36mINFO[0m[0m 01/31 13:48:58 | 0.941696    0.929329    0.966002    0.792030    0.786538    0.941696    0.929329    0.961412    0.770245    0.969916    0.786585    0.966679    0.819259    2200        33.129412   -0.307205   -4.066789   1.188208    153.796946 
[37m[36mINFO[0m[0m 01/31 13:55:36 | 0.943463    0.936396    0.979467    0.800445    0.726954    0.943463    0.936396    0.975529    0.790960    0.982864    0.789634    0.980007    0.820741    2400        36.141176   -0.322185   -4.132478   1.236338    150.994710 
[37m[36mINFO[0m[0m 01/31 14:02:11 | 0.936396    0.925795    0.983744    0.802674    0.869071    0.936396    0.925795    0.978353    0.794727    0.983244    0.788110    0.989633    0.825185    2600        39.152941   -0.354723   -4.167084   1.211754    152.155717 
[37m[36mINFO[0m[0m 01/31 14:08:57 | 0.927562    0.911661    0.988095    0.802974    0.883305    0.927562    0.911661    0.990118    0.775895    0.989718    0.804878    0.984450    0.828148    2800        42.164706   -0.362994   -4.197242   1.283750    146.521351 
[37m[36mINFO[0m[0m 01/31 14:15:41 | 0.951413    0.936396    0.991004    0.812688    0.868984    0.951413    0.936396    0.989176    0.792844    0.991241    0.817073    0.992595    0.828148    3000        45.176471   -0.380561   -4.269449   1.238830    155.060211 
[37m[36mINFO[0m[0m 01/31 14:22:16 | 0.955830    0.954064    0.990086    0.812107    0.840682    0.955830    0.954064    0.986824    0.768362    0.990099    0.835366    0.993336    0.832593    3200        48.188235   -0.386427   -4.271128   1.206279    151.800366 
[37m[36mINFO[0m[0m 01/31 14:29:00 | 0.939929    0.929329    0.979900    0.797499    0.965575    0.939929    0.929329    0.980235    0.775895    0.980198    0.800305    0.979267    0.816296    3400        51.200000   -0.402328   -4.351573   1.245209    155.211094 
[37m[36mINFO[0m[0m 01/31 14:35:39 | 0.942580    0.939929    0.991592    0.813782    0.857793    0.942580    0.939929    0.986824    0.787194    0.992765    0.818598    0.995187    0.835556    3600        54.211765   -0.380838   -4.251480   1.207054    157.972525 
[37m[36mINFO[0m[0m 01/31 14:42:26 | 0.935512    0.939929    0.988009    0.803313    0.941146    0.935512    0.939929    0.986824    0.779661    0.992384    0.812500    0.984820    0.817778    3800        57.223529   -0.400358   -4.333621   1.280100    148.142191 
[37m[36mINFO[0m[0m 01/31 14:49:06 | 0.944346    0.950530    0.991068    0.804251    0.927032    0.944346    0.950530    0.990118    0.766478    0.990861    0.801829    0.992225    0.844444    4000        60.235294   -0.391589   -4.291380   1.203618    159.734701 
[37m[36mINFO[0m[0m 01/31 14:55:43 | 0.946996    0.964664    0.984067    0.802858    1.052229    0.946996    0.964664    0.974118    0.783427    0.984006    0.788110    0.994076    0.837037    4200        63.247059   -0.414435   -4.383156   1.252153    146.637481 
[37m[36mINFO[0m[0m 01/31 15:02:06 | 0.948763    0.936396    0.994541    0.825471    0.911243    0.948763    0.936396    0.992941    0.811676    0.997715    0.826220    0.992966    0.838519    4400        66.258824   -0.422428   -4.417909   1.198696    143.534129 
[37m[36mINFO[0m[0m 01/31 15:08:27 | 0.964664    0.964664    0.997797    0.818057    0.918207    0.964664    0.964664    0.997176    0.798493    0.996954    0.820122    0.999260    0.835556    4600        69.270588   -0.440327   -4.534018   1.163939    146.442535 
[37m[36mINFO[0m[0m 01/31 15:14:37 | 0.971731    0.954064    0.994743    0.824117    0.936791    0.971731    0.954064    0.992471    0.800377    0.996573    0.820122    0.995187    0.851852    4800        72.282353   -0.435789   -4.526781   1.149490    140.316913 
[37m[36mINFO[0m[0m 01/31 15:20:50 | 0.967314    0.968198    0.993986    0.804576    0.960917    0.967314    0.968198    0.990588    0.770245    0.995811    0.807927    0.995557    0.835556    5000        75.294118   -0.427564   -4.472657   1.160640    140.525277 

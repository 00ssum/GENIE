[37m[36mINFO[0m[0m 01/30 22:52:18 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py vit_MIRO_adam config/vit_MIRO_adam.yaml --algorithm MIRO --test_envs 0 --dataset VLCS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: MIRO
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/vit_MIRO_adam.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: vit_MIRO_adam
	out_dir: train_output/VLCS/MIRO/[0]/250130_22-52-18_vit_MIRO_adam
	out_root: train_output/VLCS/MIRO/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250130_22-52-18_vit_MIRO_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 01/30 22:52:18 | n_steps = 5001
[37m[36mINFO[0m[0m 01/30 22:52:18 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/30 22:52:18 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/30 22:52:18 | Target test envs = [[0]]
[37m[36mINFO[0m[0m 01/30 22:52:18 | 
[37m[36mINFO[0m[0m 01/30 22:52:18 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 01/30 22:52:18 | Test envs = [0], name = te_C
[37m[36mINFO[0m[0m 01/30 22:52:18 | Batch sizes for each domain: [0, 32, 32, 32] (total=96)
[37m[36mINFO[0m[0m 01/30 22:52:18 | steps-per-epoch for each domain: 66.41, 82.06, 84.41 -> min = 66.41
[37m[36mINFO[0m[0m 01/30 22:52:23 | # of params = 172391685
[37m[36mINFO[0m[0m 01/30 22:54:37 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        reg_loss    step_time   eval_time  
[37m[36mINFO[0m[0m 01/30 22:54:37 | 0.661661    0.650177    0.558589    0.575914    1.164840    0.661661    0.650177    0.609882    0.659134    0.532749    0.542683    0.533136    0.525926    0           0.000000    1.062300    -5.756463   1.184382    132.465865 
[37m[36mINFO[0m[0m 01/30 23:00:32 | 0.964664    0.978799    0.858299    0.809011    0.508969    0.964664    0.978799    0.807529    0.772128    0.862148    0.792683    0.905220    0.862222    200         3.011765    -0.102337   -4.862277   1.098663    134.509310 
[37m[36mINFO[0m[0m 01/30 23:06:26 | 0.955830    0.954064    0.927406    0.822245    0.527165    0.955830    0.954064    0.895529    0.777778    0.945925    0.844512    0.940763    0.844444    400         6.023529    -0.249438   -4.815893   1.098738    132.692481 
[37m[36mINFO[0m[0m 01/30 23:12:20 | 0.976148    0.975265    0.965060    0.835486    0.545059    0.976148    0.975265    0.935059    0.783427    0.977152    0.844512    0.982969    0.878519    600         9.035294    -0.325381   -4.841913   1.101227    131.905152 
[37m[36mINFO[0m[0m 01/30 23:18:12 | 0.945230    0.943463    0.964007    0.820109    0.631517    0.945230    0.943463    0.944000    0.760829    0.968012    0.850610    0.980007    0.848889    800         12.047059   -0.396431   -4.985741   1.091129    133.002167 
[37m[36mINFO[0m[0m 01/30 23:24:02 | 0.961131    0.978799    0.975577    0.823562    0.704080    0.961131    0.978799    0.962824    0.790960    0.980198    0.832317    0.983710    0.847407    1000        15.058824   -0.435324   -5.131476   1.084308    133.263391 
[37m[36mINFO[0m[0m 01/30 23:29:56 | 0.984099    0.989399    0.976464    0.813837    0.753297    0.984099    0.989399    0.977882    0.783427    0.973724    0.800305    0.977786    0.857778    1200        18.070588   -0.442632   -5.164485   1.097066    134.030628 
[37m[36mINFO[0m[0m 01/30 23:35:41 | 0.954947    0.954064    0.983487    0.814799    0.768451    0.954947    0.954064    0.983529    0.787194    0.982483    0.821646    0.984450    0.835556    1400        21.082353   -0.474797   -5.315619   1.066238    131.648751 
[37m[36mINFO[0m[0m 01/30 23:41:26 | 0.978799    0.989399    0.987893    0.818970    0.743618    0.978799    0.989399    0.985882    0.781544    0.987053    0.835366    0.990744    0.840000    1600        24.094118   -0.465803   -5.324515   1.064845    132.443540 
[37m[36mINFO[0m[0m 01/30 23:47:08 | 0.975265    0.978799    0.982850    0.810197    0.768156    0.975265    0.978799    0.977882    0.787194    0.983625    0.804878    0.987042    0.838519    1800        27.105882   -0.484345   -5.428638   1.045558    132.550889 
[37m[36mINFO[0m[0m 01/30 23:53:04 | 0.958481    0.954064    0.987142    0.817882    0.923694    0.958481    0.954064    0.982118    0.781544    0.988195    0.824695    0.991114    0.847407    2000        30.117647   -0.513734   -5.583919   1.106671    134.334304 
[37m[36mINFO[0m[0m 01/30 23:58:52 | 0.962014    0.939929    0.981435    0.805504    0.890355    0.962014    0.939929    0.973647    0.785311    0.983244    0.792683    0.987412    0.838519    2200        33.129412   -0.535709   -5.727904   1.071723    134.302253 
[37m[36mINFO[0m[0m 01/31 00:04:36 | 0.922261    0.929329    0.978488    0.801563    0.907233    0.922261    0.929329    0.982588    0.783427    0.982864    0.807927    0.970011    0.813333    2400        36.141176   -0.530613   -5.752256   1.056555    132.758240 
[37m[36mINFO[0m[0m 01/31 00:10:22 | 0.977032    0.982332    0.992462    0.820860    0.860964    0.977032    0.982332    0.990588    0.781544    0.991241    0.826220    0.995557    0.854815    2600        39.152941   -0.548248   -5.872676   1.059842    133.449769 
[37m[36mINFO[0m[0m 01/31 00:16:08 | 0.979682    0.968198    0.993211    0.822755    0.874197    0.979682    0.968198    0.992000    0.802260    0.994669    0.818598    0.992966    0.847407    2800        42.164706   -0.548435   -5.923787   1.074237    131.378287 
[37m[36mINFO[0m[0m 01/31 00:21:51 | 0.965548    0.946996    0.995985    0.823250    0.875448    0.965548    0.946996    0.992471    0.794727    0.997334    0.823171    0.998149    0.851852    3000        45.176471   -0.588168   -6.160120   1.064841    130.061598 
[37m[36mINFO[0m[0m 01/31 00:27:34 | 0.924028    0.915194    0.992681    0.820442    0.835790    0.924028    0.915194    0.993412    0.809793    0.993145    0.830793    0.991485    0.820741    3200        48.188235   -0.604566   -6.307583   1.065136    130.098179 
[37m[36mINFO[0m[0m 01/31 00:33:17 | 0.944346    0.932862    0.980743    0.795758    0.967437    0.944346    0.932862    0.979294    0.770245    0.985149    0.815549    0.977786    0.801481    3400        51.200000   -0.595030   -6.281730   1.066251    129.979894 
[37m[36mINFO[0m[0m 01/31 00:39:00 | 0.931095    0.939929    0.991382    0.810644    0.923507    0.931095    0.939929    0.989176    0.777778    0.992003    0.818598    0.992966    0.835556    3600        54.211765   -0.580307   -6.241952   1.061126    130.587308 
[37m[36mINFO[0m[0m 01/31 00:44:43 | 0.939929    0.950530    0.985230    0.798539    0.938007    0.939929    0.950530    0.977882    0.747646    0.987433    0.809451    0.990374    0.838519    3800        57.223529   -0.599938   -6.324722   1.054768    132.107319 
[37m[36mINFO[0m[0m 01/31 00:50:27 | 0.982332    0.985866    0.988783    0.783259    1.033439    0.982332    0.985866    0.989176    0.779661    0.991241    0.780488    0.985931    0.789630    4000        60.235294   -0.631224   -6.552459   1.049427    133.354215 
[37m[36mINFO[0m[0m 01/31 00:56:13 | 0.949647    0.957597    0.988323    0.794084    1.037128    0.949647    0.957597    0.989647    0.783427    0.991241    0.800305    0.984080    0.798519    4200        63.247059   -0.625249   -6.556109   1.071872    132.340314 
[37m[36mINFO[0m[0m 01/31 01:01:57 | 0.942580    0.946996    0.977619    0.779384    1.113989    0.942580    0.946996    0.955294    0.730697    0.992003    0.791159    0.985561    0.816296    4400        66.258824   -0.645371   -6.694513   1.061351    131.006504 
[37m[36mINFO[0m[0m 01/31 01:07:39 | 0.943463    0.943463    0.992744    0.802045    0.932969    0.943463    0.943463    0.992471    0.760829    0.993907    0.820122    0.991855    0.825185    4600        69.270588   -0.618651   -6.568151   1.060319    130.715773 
[37m[36mINFO[0m[0m 01/31 01:13:22 | 0.957597    0.950530    0.996455    0.819477    0.989850    0.957597    0.950530    0.995765    0.789077    0.996192    0.832317    0.997408    0.837037    4800        72.282353   -0.682308   -6.962657   1.053496    131.653337 
[37m[36mINFO[0m[0m 01/31 01:19:08 | 0.968198    0.964664    0.993541    0.809473    0.989940    0.968198    0.964664    0.991529    0.781544    0.993907    0.823171    0.995187    0.823704    5000        75.294118   -0.658135   -6.847965   1.074093    131.876719 
[37m[36mINFO[0m[0m 01/31 01:19:08 | ---
[37m[36mINFO[0m[0m 01/31 01:19:08 | test-domain validation(oracle) = 98.410%
[37m[36mINFO[0m[0m 01/31 01:19:08 | training-domain validation(iid) = 97.615%
[37m[36mINFO[0m[0m 01/31 01:19:08 | last = 96.820%
[37m[36mINFO[0m[0m 01/31 01:19:08 | last (inD) = 80.947%
[37m[36mINFO[0m[0m 01/31 01:19:08 | training-domain validation (iid, inD) = 83.549%
[37m[36mINFO[0m[0m 01/31 01:19:09 | === Summary ===
[37m[36mINFO[0m[0m 01/31 01:19:09 | Command: /jsm0707/DomainBed/Large-scale/train_all.py vit_MIRO_adam config/vit_MIRO_adam.yaml --algorithm MIRO --test_envs 0 --dataset VLCS
[37m[36mINFO[0m[0m 01/31 01:19:09 | Unique name: 250130_22-52-18_vit_MIRO_adam
[37m[36mINFO[0m[0m 01/31 01:19:09 | Out path: train_output/VLCS/MIRO/[0]/250130_22-52-18_vit_MIRO_adam
[37m[36mINFO[0m[0m 01/31 01:19:09 | Algorithm: MIRO
[37m[36mINFO[0m[0m 01/31 01:19:09 | Dataset: VLCS
[37m[36mINFO[0m[0m 01/31 01:19:09 | Max test_in: 0.9841

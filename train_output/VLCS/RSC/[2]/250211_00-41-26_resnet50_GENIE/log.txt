[37m[36mINFO[0m[0m 02/11 00:41:26 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 2 --dataset VLCS --trial_seed 0 --hparams_seed 6
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 6
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/VLCS/RSC/[2]/250211_00-41-26_resnet50_GENIE
	out_root: train_output/VLCS/RSC/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250211_00-41-26_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.5764387170443743e-05
	batch_size: 19
	weight_decay: 0.0006024239579587198
	rsc_f_drop_factor: 0.19876770246536363
	rsc_b_drop_factor: 0.08199629172100226
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 02/11 00:41:26 | n_steps = 5001
[37m[36mINFO[0m[0m 02/11 00:41:26 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/11 00:41:26 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/11 00:41:26 | 
[37m[36mINFO[0m[0m 02/11 00:41:26 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 02/11 00:41:26 | Test envs = [2], name = te_S
[37m[36mINFO[0m[0m 02/11 00:41:26 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 02/11 00:41:26 | Batch sizes for each domain: [19, 19, 0, 19] (total=57)
[37m[36mINFO[0m[0m 02/11 00:41:26 | steps-per-epoch for each domain: 59.58, 111.84, 142.16 -> min = 59.58
[37m[36mINFO[0m[0m 02/11 00:41:27 | # of params = 23518277
[37m[36mINFO[0m[0m 02/11 00:43:47 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/11 00:43:47 | 0.384615    0.391768    0.512985    0.529832    1.244472    0.613074    0.632509    0.464941    0.485876    0.384615    0.391768    0.460940    0.471111    0           0.000000    2.053049    0.958038    138.955643 
[37m[36mINFO[0m[0m 02/11 00:48:33 | 0.668698    0.649390    0.849900    0.848680    0.398776    1.000000    1.000000    0.714824    0.740113    0.668698    0.649390    0.834876    0.805926    200         3.356890    0.619748    0.741405    138.219014 
[37m[36mINFO[0m[0m 02/11 00:53:15 | 0.745240    0.714939    0.887080    0.875154    0.343000    0.999117    1.000000    0.785412    0.772128    0.745240    0.714939    0.876712    0.853333    400         6.713781    0.409654    0.711306    139.465340 
[37m[36mINFO[0m[0m 02/11 00:57:53 | 0.714775    0.693598    0.884573    0.866717    0.401311    0.998233    1.000000    0.792471    0.764595    0.714775    0.693598    0.863014    0.835556    600         10.070671   0.347636    0.697869    138.280563 
[37m[36mINFO[0m[0m 02/11 01:02:31 | 0.707159    0.690549    0.896925    0.865955    0.372360    1.000000    1.000000    0.805176    0.760829    0.707159    0.690549    0.885598    0.837037    800         13.427562   0.330092    0.703186    137.191019 
[37m[36mINFO[0m[0m 02/11 01:07:11 | 0.692688    0.670732    0.898036    0.862239    0.373352    0.999117    1.000000    0.797176    0.736347    0.692688    0.670732    0.897816    0.850370    1000        16.784452   0.295931    0.714201    137.057477 
[37m[36mINFO[0m[0m 02/11 01:11:51 | 0.738385    0.714939    0.913843    0.881255    0.340791    0.998233    1.000000    0.818824    0.781544    0.738385    0.714939    0.924472    0.862222    1200        20.141343   0.269425    0.726507    134.542591 
[37m[36mINFO[0m[0m 02/11 01:16:33 | 0.714014    0.676829    0.920941    0.877974    0.361838    1.000000    1.000000    0.840941    0.790960    0.714014    0.676829    0.921881    0.842963    1400        23.498233   0.246738    0.743971    133.888940 
[37m[36mINFO[0m[0m 02/11 01:21:15 | 0.736862    0.707317    0.936278    0.870534    0.383023    1.000000    1.000000    0.864000    0.762712    0.736862    0.707317    0.944835    0.848889    1600        26.855124   0.244286    0.725757    136.927189 
[37m[36mINFO[0m[0m 02/11 01:25:56 | 0.730769    0.708841    0.942488    0.876677    0.367986    1.000000    1.000000    0.876706    0.779661    0.730769    0.708841    0.950759    0.850370    1800        30.212014   0.226990    0.725878    135.594544 
[37m[36mINFO[0m[0m 02/11 01:30:41 | 0.721249    0.701220    0.947855    0.875648    0.411458    1.000000    1.000000    0.893176    0.772128    0.721249    0.701220    0.950389    0.854815    2000        33.568905   0.213092    0.744039    136.330219 
[37m[36mINFO[0m[0m 02/11 01:35:21 | 0.740670    0.714939    0.917683    0.853168    0.472279    1.000000    0.996466    0.798588    0.715631    0.740670    0.714939    0.954461    0.847407    2200        36.925795   0.211309    0.694479    141.032268 
[37m[36mINFO[0m[0m 02/11 01:40:01 | 0.726961    0.696646    0.951913    0.871069    0.410933    1.000000    1.000000    0.901647    0.770245    0.726961    0.696646    0.954091    0.842963    2400        40.282686   0.181262    0.705673    138.503626 
[37m[36mINFO[0m[0m 02/11 01:44:42 | 0.709444    0.707317    0.960971    0.872191    0.424185    1.000000    1.000000    0.916235    0.772128    0.709444    0.707317    0.966679    0.844444    2600        43.639576   0.160942    0.694490    142.299298 
[37m[36mINFO[0m[0m 02/11 01:49:23 | 0.687738    0.661585    0.956215    0.865863    0.512926    1.000000    1.000000    0.915294    0.766478    0.687738    0.661585    0.953351    0.831111    2800        46.996466   0.151535    0.704849    140.501020 
[37m[36mINFO[0m[0m 02/11 01:54:12 | 0.736101    0.705793    0.958951    0.870483    0.511448    1.000000    1.000000    0.919059    0.775895    0.736101    0.705793    0.957793    0.835556    3000        50.353357   0.150816    0.757241    137.363422 
[37m[36mINFO[0m[0m 02/11 01:59:00 | 0.671363    0.634146    0.953724    0.855585    0.623810    1.000000    1.000000    0.916706    0.760829    0.671363    0.634146    0.944465    0.805926    3200        53.710247   0.156933    0.760190    135.152333 
[37m[36mINFO[0m[0m 02/11 02:03:46 | 0.679741    0.667683    0.961812    0.867972    0.475273    1.000000    1.000000    0.917647    0.768362    0.679741    0.667683    0.967790    0.835556    3400        57.067138   0.144541    0.754399    135.411814 
[37m[36mINFO[0m[0m 02/11 02:08:22 | 0.719726    0.708841    0.970308    0.883633    0.523619    1.000000    1.000000    0.936471    0.787194    0.719726    0.708841    0.974454    0.863704    3600        60.424028   0.141969    0.725225    130.795037 
[37m[36mINFO[0m[0m 02/11 02:13:03 | 0.684692    0.646341    0.979573    0.861011    0.560245    0.998233    0.996466    0.955294    0.749529    0.684692    0.646341    0.985191    0.837037    3800        63.780919   0.108488    0.713230    138.926150 
[37m[36mINFO[0m[0m 02/11 02:17:42 | 0.653846    0.641768    0.975401    0.855635    0.606517    0.999117    1.000000    0.956706    0.747646    0.653846    0.641768    0.970381    0.819259    4000        67.137809   0.113211    0.700809    138.241727 
[37m[36mINFO[0m[0m 02/11 02:22:22 | 0.674029    0.650915    0.970087    0.869693    0.758373    0.998233    0.992933    0.941647    0.790960    0.674029    0.650915    0.970381    0.825185    4200        70.494700   0.117425    0.708846    138.861808 
[37m[36mINFO[0m[0m 02/11 02:27:01 | 0.693069    0.682927    0.974866    0.864403    0.618485    0.999117    0.992933    0.949176    0.772128    0.693069    0.682927    0.976305    0.828148    4400        73.851590   0.106987    0.704810    137.565980 
[37m[36mINFO[0m[0m 02/11 02:31:42 | 0.684692    0.663110    0.978022    0.848397    0.591011    0.999117    0.996466    0.967529    0.745763    0.684692    0.663110    0.967419    0.802963    4600        77.208481   0.093836    0.720674    136.806352 
[37m[36mINFO[0m[0m 02/11 02:36:27 | 0.725438    0.704268    0.976500    0.854064    0.515766    1.000000    0.996466    0.940235    0.721281    0.725438    0.704268    0.989263    0.844444    4800        80.565371   0.101539    0.741162    137.297108 
[37m[36mINFO[0m[0m 02/11 02:41:13 | 0.675552    0.663110    0.985696    0.849117    0.875683    1.000000    0.996466    0.974118    0.741996    0.675552    0.663110    0.982969    0.808889    5000        83.922261   0.083894    0.736471    138.391412 
[37m[36mINFO[0m[0m 02/11 02:41:13 | Cumulative gradient change saved at train_output/VLCS/RSC/[2]/250211_00-41-26_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/11 02:41:15 | ---
[37m[36mINFO[0m[0m 02/11 02:41:15 | test-domain validation(oracle) = 74.524%
[37m[36mINFO[0m[0m 02/11 02:41:15 | training-domain validation(iid) = 71.973%
[37m[36mINFO[0m[0m 02/11 02:41:15 | last = 67.555%
[37m[36mINFO[0m[0m 02/11 02:41:15 | last (inD) = 84.912%
[37m[36mINFO[0m[0m 02/11 02:41:15 | training-domain validation (iid, inD) = 88.363%
[37m[36mINFO[0m[0m 02/11 02:41:15 | === Summary ===
[37m[36mINFO[0m[0m 02/11 02:41:15 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 2 --dataset VLCS --trial_seed 0 --hparams_seed 6
[37m[36mINFO[0m[0m 02/11 02:41:15 | Unique name: 250211_00-41-26_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 02:41:15 | Out path: train_output/VLCS/RSC/[2]/250211_00-41-26_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 02:41:15 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/11 02:41:15 | Dataset: VLCS

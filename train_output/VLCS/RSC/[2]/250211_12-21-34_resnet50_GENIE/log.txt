[37m[36mINFO[0m[0m 02/11 12:21:34 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 2 --dataset VLCS --trial_seed 0 --hparams_seed 12
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 12
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/VLCS/RSC/[2]/250211_12-21-34_resnet50_GENIE
	out_root: train_output/VLCS/RSC/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250211_12-21-34_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.00012111338094255871
	batch_size: 9
	weight_decay: 1.821145631101786e-06
	rsc_f_drop_factor: 0.40686428928752155
	rsc_b_drop_factor: 0.1630540413892459
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 02/11 12:21:34 | n_steps = 5001
[37m[36mINFO[0m[0m 02/11 12:21:34 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/11 12:21:34 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/11 12:21:34 | 
[37m[36mINFO[0m[0m 02/11 12:21:34 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 02/11 12:21:34 | Test envs = [2], name = te_S
[37m[36mINFO[0m[0m 02/11 12:21:34 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 02/11 12:21:34 | Batch sizes for each domain: [9, 9, 0, 9] (total=27)
[37m[36mINFO[0m[0m 02/11 12:21:34 | steps-per-epoch for each domain: 125.78, 236.11, 300.11 -> min = 125.78
[37m[36mINFO[0m[0m 02/11 12:21:35 | # of params = 23518277
[37m[36mINFO[0m[0m 02/11 12:24:01 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/11 12:24:01 | 0.391470    0.391768    0.505364    0.522502    1.325326    0.611307    0.628975    0.459765    0.489642    0.391470    0.391768    0.445020    0.448889    0           0.000000    2.745917    1.271900    144.591902 
[37m[36mINFO[0m[0m 02/11 12:27:39 | 0.562833    0.557927    0.821273    0.828398    0.495204    0.987633    0.989399    0.719059    0.747646    0.562833    0.557927    0.757127    0.748148    200         1.590106    0.957997    0.387966    140.571126 
[37m[36mINFO[0m[0m 02/11 12:31:12 | 0.757045    0.708841    0.856970    0.852976    0.403119    0.999117    0.996466    0.729882    0.747646    0.757045    0.708841    0.841910    0.814815    400         3.180212    0.720672    0.355171    141.657721 
[37m[36mINFO[0m[0m 02/11 12:34:47 | 0.719726    0.681402    0.874599    0.864700    0.370480    0.999117    1.000000    0.771294    0.757062    0.719726    0.681402    0.853388    0.837037    600         4.770318    0.676519    0.371773    140.879877 
[37m[36mINFO[0m[0m 02/11 12:38:21 | 0.760853    0.728659    0.874934    0.869412    0.367747    1.000000    1.000000    0.756235    0.760829    0.760853    0.728659    0.868567    0.847407    800         6.360424    0.655702    0.389927    136.007412 
[37m[36mINFO[0m[0m 02/11 12:42:02 | 0.712871    0.681402    0.885402    0.867154    0.362085    1.000000    0.996466    0.780235    0.766478    0.712871    0.681402    0.875972    0.838519    1000        7.950530    0.621857    0.401196    140.456980 
[37m[36mINFO[0m[0m 02/11 12:45:38 | 0.714395    0.695122    0.890167    0.866307    0.366064    1.000000    1.000000    0.788235    0.779661    0.714395    0.695122    0.882266    0.819259    1200        9.540636    0.592787    0.384390    139.061556 
[37m[36mINFO[0m[0m 02/11 12:49:14 | 0.730388    0.696646    0.892357    0.863712    0.371212    0.999117    1.000000    0.802353    0.757062    0.730388    0.696646    0.875602    0.834074    1400        11.130742   0.569763    0.367447    142.825018 
[37m[36mINFO[0m[0m 02/11 12:52:45 | 0.636710    0.615854    0.880670    0.847339    0.502201    0.992933    0.989399    0.802353    0.757062    0.636710    0.615854    0.846723    0.795556    1600        12.720848   0.558934    0.365679    137.094299 
[37m[36mINFO[0m[0m 02/11 12:56:13 | 0.739147    0.724085    0.889757    0.856397    0.423197    0.999117    1.000000    0.795294    0.751412    0.739147    0.724085    0.874861    0.817778    1800        14.310954   0.577865    0.369288    134.767233 
[37m[36mINFO[0m[0m 02/11 12:59:54 | 0.694973    0.657012    0.887007    0.848412    0.418704    1.000000    1.000000    0.780235    0.736347    0.694973    0.657012    0.880785    0.808889    2000        15.901060   0.537858    0.397117    141.224191 
[37m[36mINFO[0m[0m 02/11 13:03:25 | 0.724296    0.707317    0.902515    0.863070    0.420106    0.996466    0.996466    0.824000    0.764595    0.724296    0.707317    0.887079    0.828148    2200        17.491166   0.542268    0.356753    140.154255 
[37m[36mINFO[0m[0m 02/11 13:07:03 | 0.723915    0.667683    0.908994    0.859761    0.391638    0.999117    1.000000    0.831529    0.757062    0.723915    0.667683    0.896335    0.822222    2400        19.081272   0.503242    0.358550    145.665160 
[37m[36mINFO[0m[0m 02/11 13:10:33 | 0.730769    0.714939    0.918630    0.864968    0.372495    0.999117    1.000000    0.833412    0.760829    0.730769    0.714939    0.923362    0.834074    2600        20.671378   0.498035    0.372958    135.931422 
[37m[36mINFO[0m[0m 02/11 13:14:11 | 0.713252    0.698171    0.915542    0.858188    0.388144    0.999117    1.000000    0.838588    0.762712    0.713252    0.698171    0.908923    0.811852    2800        22.261484   0.477294    0.396409    138.679602 
[37m[36mINFO[0m[0m 02/11 13:17:44 | 0.678979    0.629573    0.907186    0.846980    0.421140    0.995583    0.975265    0.834824    0.762712    0.678979    0.629573    0.891151    0.802963    3000        23.851590   0.486827    0.379175    137.076228 
[37m[36mINFO[0m[0m 02/11 13:21:18 | 0.684692    0.663110    0.909504    0.858950    0.426275    1.000000    1.000000    0.825882    0.766478    0.684692    0.663110    0.902629    0.810370    3200        25.441696   0.491564    0.357147    142.892826 
[37m[36mINFO[0m[0m 02/11 13:24:53 | 0.718583    0.661585    0.924325    0.850825    0.413795    0.999117    0.996466    0.842353    0.738230    0.718583    0.661585    0.931507    0.817778    3400        27.031802   0.461538    0.365142    141.545505 
[37m[36mINFO[0m[0m 02/11 13:28:25 | 0.694973    0.657012    0.928683    0.853562    0.408039    1.000000    0.996466    0.863059    0.741996    0.694973    0.657012    0.922991    0.822222    3600        28.621908   0.479695    0.360848    139.501768 
[37m[36mINFO[0m[0m 02/11 13:31:59 | 0.696877    0.663110    0.928993    0.867972    0.448626    0.999117    1.000000    0.866353    0.768362    0.696877    0.663110    0.921511    0.835556    3800        30.212014   0.458007    0.404818    133.645202 
[37m[36mINFO[0m[0m 02/11 13:35:31 | 0.718203    0.685976    0.941758    0.864432    0.426613    1.000000    1.000000    0.878588    0.753296    0.718203    0.685976    0.946686    0.840000    4000        31.802120   0.433804    0.389205    134.295834 
[37m[36mINFO[0m[0m 02/11 13:39:04 | 0.755522    0.705793    0.929711    0.856497    0.447474    1.000000    1.000000    0.848000    0.725047    0.755522    0.705793    0.941133    0.844444    4200        33.392226   0.437223    0.369342    139.154935 
[37m[36mINFO[0m[0m 02/11 13:42:32 | 0.674791    0.635671    0.935452    0.864311    0.476157    0.998233    0.992933    0.893647    0.777778    0.674791    0.635671    0.914476    0.822222    4400        34.982332   0.426597    0.355107    136.576961 
[37m[36mINFO[0m[0m 02/11 13:46:06 | 0.722011    0.695122    0.945186    0.864064    0.452941    1.000000    1.000000    0.890353    0.775895    0.722011    0.695122    0.945205    0.816296    4600        36.572438   0.449675    0.377422    138.280831 
[37m[36mINFO[0m[0m 02/11 13:49:43 | 0.676695    0.628049    0.937255    0.848841    0.447752    0.999117    0.996466    0.881882    0.758945    0.676695    0.628049    0.930766    0.791111    4800        38.162544   0.397296    0.399840    136.871479 
[37m[36mINFO[0m[0m 02/11 13:53:15 | 0.711348    0.685976    0.910678    0.831454    0.479883    1.000000    1.000000    0.809412    0.706215    0.711348    0.685976    0.922621    0.788148    5000        39.752650   0.410160    0.382507    135.568024 
[37m[36mINFO[0m[0m 02/11 13:53:15 | Cumulative gradient change saved at train_output/VLCS/RSC/[2]/250211_12-21-34_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/11 13:53:16 | ---
[37m[36mINFO[0m[0m 02/11 13:53:16 | test-domain validation(oracle) = 76.085%
[37m[36mINFO[0m[0m 02/11 13:53:16 | training-domain validation(iid) = 76.085%
[37m[36mINFO[0m[0m 02/11 13:53:16 | last = 71.135%
[37m[36mINFO[0m[0m 02/11 13:53:16 | last (inD) = 83.145%
[37m[36mINFO[0m[0m 02/11 13:53:16 | training-domain validation (iid, inD) = 86.941%
[37m[36mINFO[0m[0m 02/11 13:53:16 | === Summary ===
[37m[36mINFO[0m[0m 02/11 13:53:16 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 2 --dataset VLCS --trial_seed 0 --hparams_seed 12
[37m[36mINFO[0m[0m 02/11 13:53:16 | Unique name: 250211_12-21-34_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 13:53:16 | Out path: train_output/VLCS/RSC/[2]/250211_12-21-34_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 13:53:16 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/11 13:53:16 | Dataset: VLCS

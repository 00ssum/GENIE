[37m[36mINFO[0m[0m 02/10 18:07:33 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 2 --dataset VLCS --trial_seed 0 --hparams_seed 3
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 3
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/VLCS/RSC/[2]/250210_18-07-33_resnet50_GENIE
	out_root: train_output/VLCS/RSC/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250210_18-07-33_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 6.166705009429313e-05
	batch_size: 14
	weight_decay: 3.4412812120883604e-06
	rsc_f_drop_factor: 0.2173803526378828
	rsc_b_drop_factor: 0.2877436135895483
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 02/10 18:07:33 | n_steps = 5001
[37m[36mINFO[0m[0m 02/10 18:07:33 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/10 18:07:33 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/10 18:07:33 | 
[37m[36mINFO[0m[0m 02/10 18:07:33 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 02/10 18:07:33 | Test envs = [2], name = te_S
[37m[36mINFO[0m[0m 02/10 18:07:33 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 02/10 18:07:33 | Batch sizes for each domain: [14, 14, 0, 14] (total=42)
[37m[36mINFO[0m[0m 02/10 18:07:33 | steps-per-epoch for each domain: 80.86, 151.79, 192.93 -> min = 80.86
[37m[36mINFO[0m[0m 02/10 18:07:34 | # of params = 23518277
[37m[36mINFO[0m[0m 02/10 18:09:51 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/10 18:09:51 | 0.384235    0.387195    0.504871    0.520887    1.296118    0.611307    0.628975    0.459765    0.487759    0.384235    0.387195    0.443539    0.445926    0           0.000000    2.743367    1.002835    135.995004 
[37m[36mINFO[0m[0m 02/10 18:14:03 | 0.594440    0.567073    0.815503    0.812872    0.542063    0.977032    0.975265    0.727529    0.734463    0.594440    0.567073    0.741947    0.728889    200         2.473498    0.979898    0.563673    139.378956 
[37m[36mINFO[0m[0m 02/10 18:18:16 | 0.628332    0.594512    0.841925    0.841350    0.473690    0.998233    0.996466    0.723765    0.743879    0.628332    0.594512    0.803776    0.783704    400         4.946996    0.692002    0.539910    144.321817 
[37m[36mINFO[0m[0m 02/10 18:22:27 | 0.710967    0.682927    0.871914    0.861913    0.390413    0.998233    1.000000    0.774118    0.766478    0.710967    0.682927    0.843391    0.819259    600         7.420495    0.616436    0.538405    143.714404 
[37m[36mINFO[0m[0m 02/10 18:26:34 | 0.544554    0.522866    0.844887    0.834499    0.473049    0.992049    0.989399    0.756235    0.757062    0.544554    0.522866    0.786375    0.757037    800         9.893993    0.560319    0.538231    139.497663 
[37m[36mINFO[0m[0m 02/10 18:30:45 | 0.680503    0.663110    0.863589    0.851239    0.422254    0.998233    0.989399    0.775059    0.770245    0.680503    0.663110    0.817475    0.794074    1000        12.367491   0.565212    0.555553    139.431564 
[37m[36mINFO[0m[0m 02/10 18:35:00 | 0.750571    0.733232    0.861274    0.846897    0.437623    0.999117    1.000000    0.738353    0.708098    0.750571    0.733232    0.846353    0.832593    1200        14.840989   0.513047    0.559190    143.969883 
[37m[36mINFO[0m[0m 02/10 18:39:08 | 0.626428    0.612805    0.834676    0.810838    0.473398    0.995583    0.989399    0.682824    0.653484    0.626428    0.612805    0.825620    0.789630    1400        17.314488   0.502042    0.559267    135.910210 
[37m[36mINFO[0m[0m 02/10 18:43:19 | 0.634806    0.609756    0.845028    0.821628    0.527330    0.969965    0.961131    0.762824    0.736347    0.634806    0.609756    0.802295    0.767407    1600        19.787986   0.518700    0.545907    141.645026 
[37m[36mINFO[0m[0m 02/10 18:47:29 | 0.719726    0.705793    0.863741    0.843855    0.423342    0.992049    0.992933    0.768000    0.740113    0.719726    0.705793    0.831174    0.798519    1800        22.261484   0.461635    0.556516    138.663955 
[37m[36mINFO[0m[0m 02/10 18:51:48 | 0.734958    0.713415    0.879303    0.846966    0.441585    1.000000    0.996466    0.770824    0.732580    0.734958    0.713415    0.867086    0.811852    2000        24.734982   0.493560    0.567651    144.946628 
[37m[36mINFO[0m[0m 02/10 18:55:59 | 0.693069    0.676829    0.888255    0.860071    0.423163    0.996466    1.000000    0.800471    0.768362    0.693069    0.676829    0.867827    0.811852    2200        27.208481   0.401896    0.532370    145.421019 
[37m[36mINFO[0m[0m 02/10 19:00:09 | 0.690404    0.669207    0.889614    0.855535    0.405277    0.999117    1.000000    0.814118    0.774011    0.690404    0.669207    0.855609    0.792593    2400        29.681979   0.454526    0.552771    139.184367 
[37m[36mINFO[0m[0m 02/10 19:04:22 | 0.702970    0.678354    0.887720    0.863514    0.600666    0.994700    0.996466    0.804706    0.777778    0.702970    0.678354    0.863754    0.816296    2600        32.155477   0.434951    0.552994    142.280988 
[37m[36mINFO[0m[0m 02/10 19:08:30 | 0.734196    0.681402    0.881724    0.846860    0.610421    0.996466    0.992933    0.802353    0.747646    0.734196    0.681402    0.846353    0.800000    2800        34.628975   0.411071    0.545413    138.383030 
[37m[36mINFO[0m[0m 02/10 19:12:43 | 0.727723    0.692073    0.912708    0.864248    0.439067    1.000000    1.000000    0.836235    0.764595    0.727723    0.692073    0.901888    0.828148    3000        37.102473   0.372892    0.570478    139.657403 
[37m[36mINFO[0m[0m 02/10 19:16:58 | 0.734577    0.719512    0.908154    0.856305    0.546135    1.000000    1.000000    0.832941    0.757062    0.734577    0.719512    0.891522    0.811852    3200        39.575972   0.342336    0.541990    146.235870 
[37m[36mINFO[0m[0m 02/10 19:21:11 | 0.524752    0.489329    0.807637    0.770951    0.836039    0.989399    0.982332    0.690824    0.653484    0.524752    0.489329    0.742688    0.677037    3400        42.049470   0.325941    0.532895    146.208297 
[37m[36mINFO[0m[0m 02/10 19:25:24 | 0.710586    0.685976    0.926458    0.860919    0.528076    1.000000    0.996466    0.845647    0.755179    0.710586    0.685976    0.933728    0.831111    3600        44.522968   0.317362    0.546898    143.620965 
[37m[36mINFO[0m[0m 02/10 19:29:36 | 0.643945    0.640244    0.912543    0.852164    0.520986    1.000000    0.996466    0.828706    0.757062    0.643945    0.640244    0.908923    0.802963    3800        46.996466   0.285275    0.554071    141.535726 
[37m[36mINFO[0m[0m 02/10 19:33:53 | 0.754379    0.731707    0.897064    0.847424    0.525324    0.999117    1.000000    0.788706    0.736347    0.754379    0.731707    0.903369    0.805926    4000        49.469965   0.378803    0.595710    137.405463 
[37m[36mINFO[0m[0m 02/10 19:38:13 | 0.728865    0.699695    0.920598    0.858732    0.413923    1.000000    1.000000    0.829176    0.749529    0.728865    0.699695    0.932618    0.826667    4200        51.943463   0.342752    0.591628    141.868570 
[37m[36mINFO[0m[0m 02/10 19:42:39 | 0.717822    0.669207    0.929231    0.859937    0.555857    1.000000    1.000000    0.867294    0.766478    0.717822    0.669207    0.920400    0.813333    4400        54.416961   0.301839    0.621574    141.821982 
[37m[36mINFO[0m[0m 02/10 19:46:57 | 0.719345    0.728659    0.898375    0.842409    0.619274    1.000000    0.989399    0.799529    0.736347    0.719345    0.728659    0.895594    0.801481    4600        56.890459   0.283991    0.580736    141.834795 
[37m[36mINFO[0m[0m 02/10 19:51:13 | 0.710586    0.681402    0.922928    0.847267    0.491583    0.999117    0.996466    0.857412    0.764595    0.710586    0.681402    0.912255    0.780741    4800        59.363958   0.362669    0.590787    138.006076 
[37m[36mINFO[0m[0m 02/10 19:55:29 | 0.704113    0.676829    0.894122    0.852917    0.470020    0.998233    0.996466    0.840000    0.781544    0.704113    0.676829    0.844132    0.780741    5000        61.837456   0.292893    0.569720    141.522272 
[37m[36mINFO[0m[0m 02/10 19:55:29 | Cumulative gradient change saved at train_output/VLCS/RSC/[2]/250210_18-07-33_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/10 19:55:30 | ---
[37m[36mINFO[0m[0m 02/10 19:55:30 | test-domain validation(oracle) = 75.057%
[37m[36mINFO[0m[0m 02/10 19:55:30 | training-domain validation(iid) = 72.772%
[37m[36mINFO[0m[0m 02/10 19:55:30 | last = 70.411%
[37m[36mINFO[0m[0m 02/10 19:55:30 | last (inD) = 85.292%
[37m[36mINFO[0m[0m 02/10 19:55:30 | training-domain validation (iid, inD) = 86.425%
[37m[36mINFO[0m[0m 02/10 19:55:30 | === Summary ===
[37m[36mINFO[0m[0m 02/10 19:55:30 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 2 --dataset VLCS --trial_seed 0 --hparams_seed 3
[37m[36mINFO[0m[0m 02/10 19:55:30 | Unique name: 250210_18-07-33_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 19:55:30 | Out path: train_output/VLCS/RSC/[2]/250210_18-07-33_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 19:55:30 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/10 19:55:30 | Dataset: VLCS

[37m[36mINFO[0m[0m 02/10 13:14:51 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 2 --dataset VLCS --trial_seed 0 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/VLCS/RSC/[2]/250210_13-14-51_resnet50_GENIE
	out_root: train_output/VLCS/RSC/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250210_13-14-51_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5.0781288859686544e-05
	batch_size: 44
	weight_decay: 0.00046410133598234803
	rsc_f_drop_factor: 0.2665134852412123
	rsc_b_drop_factor: 0.28056710878365126
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 02/10 13:14:51 | n_steps = 5001
[37m[36mINFO[0m[0m 02/10 13:14:51 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/10 13:14:51 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/10 13:14:51 | 
[37m[36mINFO[0m[0m 02/10 13:14:51 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 02/10 13:14:51 | Test envs = [2], name = te_S
[37m[36mINFO[0m[0m 02/10 13:14:51 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 02/10 13:14:51 | Batch sizes for each domain: [44, 44, 0, 44] (total=132)
[37m[36mINFO[0m[0m 02/10 13:14:51 | steps-per-epoch for each domain: 25.73, 48.30, 61.39 -> min = 25.73
[37m[36mINFO[0m[0m 02/10 13:14:52 | # of params = 23518277
[37m[36mINFO[0m[0m 02/10 13:17:01 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/10 13:17:01 | 0.383092    0.387195    0.504871    0.521514    1.282502    0.611307    0.628975    0.459765    0.489642    0.383092    0.387195    0.443539    0.445926    0           0.000000    2.873908    1.751518    127.399237 
[37m[36mINFO[0m[0m 02/10 13:24:12 | 0.662986    0.631098    0.837716    0.838839    0.476526    0.994700    0.996466    0.728000    0.736347    0.662986    0.631098    0.790448    0.783704    200         7.773852    0.969271    1.496605    131.606207 
[37m[36mINFO[0m[0m 02/10 13:31:54 | 0.687357    0.635671    0.869435    0.854195    0.410956    0.998233    1.000000    0.772235    0.755179    0.687357    0.635671    0.837838    0.807407    400         15.547703   0.711854    1.623414    137.522513 
[37m[36mINFO[0m[0m 02/10 13:39:32 | 0.710206    0.672256    0.872328    0.856382    0.428609    0.998233    0.996466    0.776471    0.760829    0.710206    0.672256    0.842281    0.811852    600         23.321555   0.626692    1.611423    135.360171 
[37m[36mINFO[0m[0m 02/10 13:47:09 | 0.716679    0.678354    0.890893    0.869136    0.405081    1.000000    1.000000    0.796706    0.777778    0.716679    0.678354    0.875972    0.829630    800         31.095406   0.585869    1.610544    134.636636 
[37m[36mINFO[0m[0m 02/10 13:54:46 | 0.735339    0.690549    0.895610    0.872846    0.403299    0.999117    0.996466    0.804706    0.790960    0.735339    0.690549    0.883006    0.831111    1000        38.869258   0.538260    1.620489    133.579433 
[37m[36mINFO[0m[0m 02/10 14:02:28 | 0.735339    0.687500    0.907606    0.866491    0.438401    1.000000    1.000000    0.828706    0.768362    0.735339    0.687500    0.894113    0.831111    1200        46.643110   0.477946    1.623086    137.214918 
[37m[36mINFO[0m[0m 02/10 14:10:09 | 0.681264    0.657012    0.886885    0.858673    0.472130    1.000000    1.000000    0.802824    0.783427    0.681264    0.657012    0.857830    0.792593    1400        54.416961   0.479398    1.617878    137.669263 
[37m[36mINFO[0m[0m 02/10 14:17:43 | 0.717441    0.684451    0.928958    0.865679    0.472249    0.999117    1.000000    0.871059    0.777778    0.717441    0.684451    0.916698    0.819259    1600        62.190813   0.423946    1.619159    129.713641 
[37m[36mINFO[0m[0m 02/10 14:25:26 | 0.685453    0.661585    0.933870    0.865319    0.521397    1.000000    1.000000    0.880471    0.779661    0.685453    0.661585    0.921140    0.816296    1800        69.964664   0.388759    1.648255    133.198644 
[37m[36mINFO[0m[0m 02/10 14:33:06 | 0.707540    0.673780    0.929559    0.856966    0.511160    1.000000    1.000000    0.887529    0.787194    0.707540    0.673780    0.901148    0.783704    2000        77.738516   0.368335    1.623600    134.961803 
[37m[36mINFO[0m[0m 02/10 14:40:48 | 0.694973    0.660061    0.944056    0.855493    0.514296    1.000000    1.000000    0.909176    0.766478    0.694973    0.660061    0.922991    0.800000    2200        85.512367   0.357381    1.637675    134.580368 
[37m[36mINFO[0m[0m 02/10 14:48:34 | 0.705255    0.664634    0.866751    0.802925    0.582078    0.984099    0.968198    0.832000    0.745763    0.705255    0.664634    0.784154    0.694815    2400        93.286219   0.364562    1.648278    136.420196 
[37m[36mINFO[0m[0m 02/10 14:56:15 | 0.713252    0.684451    0.958028    0.864382    0.843916    1.000000    1.000000    0.925176    0.766478    0.713252    0.684451    0.948908    0.826667    2600        101.060071  0.364749    1.639930    133.707527 
[37m[36mINFO[0m[0m 02/10 15:03:56 | 0.667174    0.647866    0.921253    0.842478    0.824678    0.996466    1.000000    0.870588    0.757062    0.667174    0.647866    0.896705    0.770370    2800        108.833922  0.284004    1.618565    136.968330 
[37m[36mINFO[0m[0m 02/10 15:11:44 | 0.712871    0.675305    0.956650    0.857828    0.679674    1.000000    1.000000    0.921412    0.764595    0.712871    0.675305    0.948538    0.808889    3000        116.607774  0.312640    1.658868    135.780547 
[37m[36mINFO[0m[0m 02/10 15:19:20 | 0.714775    0.672256    0.948606    0.864424    1.126042    1.000000    1.000000    0.895059    0.774011    0.714775    0.672256    0.950759    0.819259    3200        124.381625  0.306233    1.604471    135.660249 
[37m[36mINFO[0m[0m 02/10 15:27:38 | 0.727342    0.698171    0.967043    0.863486    0.969854    1.000000    1.000000    0.937412    0.760829    0.727342    0.698171    0.963717    0.829630    3400        132.155477  0.242884    1.749384    147.671366 
[37m[36mINFO[0m[0m 02/10 15:36:13 | 0.705636    0.646341    0.974543    0.849293    1.016247    1.000000    0.996466    0.949176    0.751412    0.705636    0.646341    0.974454    0.800000    3600        139.929329  0.221326    1.817773    151.946533 
[37m[36mINFO[0m[0m 02/10 15:44:48 | 0.721630    0.673780    0.977748    0.865637    1.121301    1.000000    1.000000    0.959529    0.770245    0.721630    0.673780    0.973713    0.826667    3800        147.703180  0.221868    1.830651    149.003790 
[37m[36mINFO[0m[0m 02/10 15:53:16 | 0.658416    0.638720    0.950159    0.838777    0.957897    0.996466    0.989399    0.909176    0.726930    0.658416    0.638720    0.944835    0.800000    4000        155.477032  0.190155    1.782512    151.369351 
[37m[36mINFO[0m[0m 02/10 16:01:43 | 0.689261    0.698171    0.977229    0.856748    1.023274    1.000000    1.000000    0.966118    0.770245    0.689261    0.698171    0.965568    0.800000    4200        163.250883  0.196405    1.763230    154.067784 
[37m[36mINFO[0m[0m 02/10 16:09:56 | 0.657273    0.629573    0.981234    0.869220    1.468704    1.000000    1.000000    0.965176    0.792844    0.657273    0.629573    0.978526    0.814815    4400        171.024735  0.168761    1.729093    147.478116 
[37m[36mINFO[0m[0m 02/10 16:18:18 | 0.676314    0.644817    0.979458    0.847374    1.154008    1.000000    1.000000    0.973176    0.749529    0.676314    0.644817    0.965198    0.792593    4600        178.798587  0.181810    1.739884    154.026120 
[37m[36mINFO[0m[0m 02/10 16:26:36 | 0.685453    0.658537    0.990694    0.865277    1.734735    1.000000    1.000000    0.985412    0.772128    0.685453    0.658537    0.986672    0.823704    4800        186.572438  0.121543    1.750698    147.127058 
[37m[36mINFO[0m[0m 02/10 16:35:05 | 0.705636    0.661585    0.977588    0.848588    1.576758    1.000000    1.000000    0.964235    0.745763    0.705636    0.661585    0.968530    0.800000    5000        194.346290  0.134555    1.763550    156.734909 
[37m[36mINFO[0m[0m 02/10 16:35:05 | Cumulative gradient change saved at train_output/VLCS/RSC/[2]/250210_13-14-51_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/10 16:35:06 | ---
[37m[36mINFO[0m[0m 02/10 16:35:06 | test-domain validation(oracle) = 72.734%
[37m[36mINFO[0m[0m 02/10 16:35:06 | training-domain validation(iid) = 73.534%
[37m[36mINFO[0m[0m 02/10 16:35:06 | last = 70.564%
[37m[36mINFO[0m[0m 02/10 16:35:06 | last (inD) = 84.859%
[37m[36mINFO[0m[0m 02/10 16:35:06 | training-domain validation (iid, inD) = 87.285%
[37m[36mINFO[0m[0m 02/10 16:35:06 | === Summary ===
[37m[36mINFO[0m[0m 02/10 16:35:06 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 2 --dataset VLCS --trial_seed 0 --hparams_seed 1
[37m[36mINFO[0m[0m 02/10 16:35:06 | Unique name: 250210_13-14-51_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 16:35:06 | Out path: train_output/VLCS/RSC/[2]/250210_13-14-51_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 16:35:06 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/10 16:35:06 | Dataset: VLCS

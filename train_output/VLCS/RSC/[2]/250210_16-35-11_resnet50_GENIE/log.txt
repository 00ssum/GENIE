[37m[36mINFO[0m[0m 02/10 16:35:11 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 2 --dataset VLCS --trial_seed 0 --hparams_seed 2
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 2
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/VLCS/RSC/[2]/250210_16-35-11_resnet50_GENIE
	out_root: train_output/VLCS/RSC/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250210_16-35-11_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.9041073434446342e-05
	batch_size: 9
	weight_decay: 0.0006566989842279891
	rsc_f_drop_factor: 0.2998869208594543
	rsc_b_drop_factor: 0.46590533469384005
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 02/10 16:35:11 | n_steps = 5001
[37m[36mINFO[0m[0m 02/10 16:35:11 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/10 16:35:11 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/10 16:35:11 | 
[37m[36mINFO[0m[0m 02/10 16:35:11 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 02/10 16:35:11 | Test envs = [2], name = te_S
[37m[36mINFO[0m[0m 02/10 16:35:11 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 02/10 16:35:11 | Batch sizes for each domain: [9, 9, 0, 9] (total=27)
[37m[36mINFO[0m[0m 02/10 16:35:11 | steps-per-epoch for each domain: 125.78, 236.11, 300.11 -> min = 125.78
[37m[36mINFO[0m[0m 02/10 16:35:12 | # of params = 23518277
[37m[36mINFO[0m[0m 02/10 16:37:36 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/10 16:37:36 | 0.400228    0.402439    0.505768    0.525465    1.395611    0.611307    0.628975    0.460235    0.489642    0.400228    0.402439    0.445761    0.457778    0           0.000000    3.664694    0.934601    143.256800 
[37m[36mINFO[0m[0m 02/10 16:41:29 | 0.381188    0.378049    0.572600    0.573936    0.852403    0.745583    0.731449    0.473882    0.510358    0.381188    0.378049    0.498334    0.480000    200         1.590106    1.286036    0.401467    152.439459 
[37m[36mINFO[0m[0m 02/10 16:45:14 | 0.644707    0.614329    0.792284    0.797481    0.641722    0.964664    0.961131    0.705412    0.723164    0.644707    0.614329    0.706775    0.708148    400         3.180212    1.004314    0.381538    148.896518 
[37m[36mINFO[0m[0m 02/10 16:48:49 | 0.633283    0.597561    0.797845    0.785892    0.587590    0.952297    0.943463    0.727059    0.719397    0.633283    0.597561    0.714180    0.694815    600         4.770318    0.928712    0.380841    138.564753 
[37m[36mINFO[0m[0m 02/10 16:52:31 | 0.620335    0.574695    0.827445    0.828525    0.510538    0.992049    1.000000    0.720941    0.734463    0.620335    0.574695    0.769345    0.751111    800         6.360424    0.838904    0.378948    146.169132 
[37m[36mINFO[0m[0m 02/10 16:56:06 | 0.618050    0.582317    0.846715    0.836914    0.463758    0.996466    0.996466    0.736941    0.723164    0.618050    0.582317    0.806738    0.791111    1000        7.950530    0.825292    0.363614    142.306117 
[37m[36mINFO[0m[0m 02/10 16:59:34 | 0.507235    0.477134    0.774986    0.764483    0.625385    0.947880    0.915194    0.709176    0.717514    0.507235    0.477134    0.667901    0.660741    1200        9.540636    0.825314    0.360715    135.912546 
[37m[36mINFO[0m[0m 02/10 17:03:04 | 0.595583    0.565549    0.839649    0.826952    0.574199    0.992049    0.985866    0.752000    0.743879    0.595583    0.565549    0.774898    0.751111    1400        11.130742   0.792105    0.358589    137.950387 
[37m[36mINFO[0m[0m 02/10 17:06:39 | 0.550647    0.533537    0.830333    0.822330    0.646600    0.994700    0.989399    0.754353    0.766478    0.550647    0.533537    0.741947    0.711111    1600        12.720848   0.758734    0.348619    145.787942 
[37m[36mINFO[0m[0m 02/10 17:10:09 | 0.534653    0.524390    0.796459    0.792034    0.635329    0.982332    0.971731    0.724706    0.728814    0.534653    0.524390    0.682340    0.675556    1800        14.310954   0.734168    0.350247    140.152953 
[37m[36mINFO[0m[0m 02/10 17:13:41 | 0.579970    0.545732    0.847330    0.833089    0.486448    0.995583    0.996466    0.761882    0.745763    0.579970    0.545732    0.784524    0.757037    2000        15.901060   0.729146    0.371461    137.009243 
[37m[36mINFO[0m[0m 02/10 17:17:14 | 0.642803    0.621951    0.821387    0.814974    0.498657    0.966431    0.961131    0.768000    0.760829    0.642803    0.621951    0.729730    0.722963    2200        17.491166   0.744590    0.342362    145.189017 
[37m[36mINFO[0m[0m 02/10 17:20:46 | 0.574638    0.550305    0.824532    0.817378    0.559742    0.992933    0.996466    0.743529    0.740113    0.574638    0.550305    0.737134    0.715556    2400        19.081272   0.738090    0.354898    140.803308 
[37m[36mINFO[0m[0m 02/10 17:24:26 | 0.536558    0.536585    0.829506    0.819546    0.486721    0.971731    0.971731    0.761882    0.747646    0.536558    0.536585    0.754906    0.739259    2600        20.671378   0.704905    0.387195    142.269805 
[37m[36mINFO[0m[0m 02/10 17:28:08 | 0.493145    0.493902    0.778607    0.782573    0.565043    0.976148    0.975265    0.736941    0.725047    0.493145    0.493902    0.622732    0.647407    2800        22.261484   0.710675    0.396146    143.377634 
[37m[36mINFO[0m[0m 02/10 17:31:40 | 0.642041    0.617378    0.818491    0.794377    0.515573    0.961131    0.946996    0.759059    0.745763    0.642041    0.617378    0.735283    0.690370    3000        23.851590   0.705316    0.367118    138.258560 
[37m[36mINFO[0m[0m 02/10 17:35:18 | 0.579208    0.580793    0.804267    0.785363    0.579356    0.938163    0.932862    0.743059    0.726930    0.579208    0.580793    0.731581    0.696296    3200        25.441696   0.717922    0.372351    143.209183 
[37m[36mINFO[0m[0m 02/10 17:38:49 | 0.459254    0.477134    0.776329    0.777109    0.598388    0.906360    0.922261    0.726588    0.743879    0.459254    0.477134    0.696039    0.665185    3400        27.031802   0.683732    0.346698    142.226786 
[37m[36mINFO[0m[0m 02/10 17:42:22 | 0.504950    0.487805    0.811696    0.794762    0.577700    0.979682    0.971731    0.755294    0.753296    0.504950    0.487805    0.700111    0.659259    3600        28.621908   0.629785    0.363104    140.412545 
[37m[36mINFO[0m[0m 02/10 17:46:04 | 0.659939    0.629573    0.807497    0.785610    0.621596    0.946113    0.925795    0.752941    0.728814    0.659939    0.629573    0.723436    0.702222    3800        30.212014   0.823141    0.402909    140.700598 
[37m[36mINFO[0m[0m 02/10 17:49:41 | 0.706398    0.669207    0.872109    0.844623    0.496524    0.997350    0.996466    0.784471    0.755179    0.706398    0.669207    0.834506    0.782222    4000        31.802120   0.653797    0.359264    145.380823 
[37m[36mINFO[0m[0m 02/10 17:53:10 | 0.659177    0.629573    0.840435    0.819892    0.529442    0.994700    0.992933    0.745412    0.715631    0.659177    0.629573    0.781192    0.751111    4200        33.392226   0.593472    0.351800    138.412756 
[37m[36mINFO[0m[0m 02/10 17:56:44 | 0.589109    0.553354    0.857292    0.829986    0.612385    0.996466    0.992933    0.769412    0.732580    0.589109    0.553354    0.805998    0.764444    4400        34.982332   0.583108    0.357360    142.679298 
[37m[36mINFO[0m[0m 02/10 18:00:20 | 0.505712    0.496951    0.850693    0.821350    0.565696    0.995583    0.989399    0.767529    0.745763    0.505712    0.496951    0.788967    0.728889    4600        36.572438   0.537986    0.367220    142.199126 
[37m[36mINFO[0m[0m 02/10 18:03:56 | 0.509139    0.493902    0.837337    0.810234    0.585954    0.984099    0.978799    0.774118    0.736347    0.509139    0.493902    0.753795    0.715556    4800        38.162544   0.506456    0.385423    139.813601 
[37m[36mINFO[0m[0m 02/10 18:07:27 | 0.540366    0.547256    0.853651    0.831683    0.551631    0.997350    0.996466    0.788706    0.781544    0.540366    0.547256    0.774898    0.717037    5000        39.752650   0.553454    0.374999    135.344617 
[37m[36mINFO[0m[0m 02/10 18:07:27 | Cumulative gradient change saved at train_output/VLCS/RSC/[2]/250210_16-35-11_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/10 18:07:28 | ---
[37m[36mINFO[0m[0m 02/10 18:07:28 | test-domain validation(oracle) = 70.640%
[37m[36mINFO[0m[0m 02/10 18:07:28 | training-domain validation(iid) = 70.640%
[37m[36mINFO[0m[0m 02/10 18:07:28 | last = 54.037%
[37m[36mINFO[0m[0m 02/10 18:07:28 | last (inD) = 83.168%
[37m[36mINFO[0m[0m 02/10 18:07:28 | training-domain validation (iid, inD) = 84.462%
[37m[36mINFO[0m[0m 02/10 18:07:28 | === Summary ===
[37m[36mINFO[0m[0m 02/10 18:07:28 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 2 --dataset VLCS --trial_seed 0 --hparams_seed 2
[37m[36mINFO[0m[0m 02/10 18:07:28 | Unique name: 250210_16-35-11_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 18:07:28 | Out path: train_output/VLCS/RSC/[2]/250210_16-35-11_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 18:07:28 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/10 18:07:28 | Dataset: VLCS

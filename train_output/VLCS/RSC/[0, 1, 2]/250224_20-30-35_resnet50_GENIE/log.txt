[37m[36mINFO[0m[0m 02/24 20:30:35 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 2 --dataset VLCS --trial_seed 2 --hparams_seed 20
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 20
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/VLCS/RSC/[0, 1, 2]/250224_20-30-35_resnet50_GENIE
	out_root: train_output/VLCS/RSC/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 2
	unique_name: 250224_20-30-35_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 3.0575564760860844e-05
	batch_size: 27
	weight_decay: 7.45235722180653e-06
	rsc_f_drop_factor: 0.29037470564885265
	rsc_b_drop_factor: 0.006830956171108737
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 02/24 20:30:35 | n_steps = 5001
[37m[36mINFO[0m[0m 02/24 20:30:35 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/24 20:30:35 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/24 20:30:35 | 
[37m[36mINFO[0m[0m 02/24 20:30:35 | Testenv name escaping te_C_L_S -> te_C_L_S
[37m[36mINFO[0m[0m 02/24 20:30:35 | Test envs = [0, 1, 2], name = te_C_L_S
[37m[36mINFO[0m[0m 02/24 20:30:35 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 02/24 20:30:35 | Batch sizes for each domain: [0, 0, 0, 27] (total=27)
[37m[36mINFO[0m[0m 02/24 20:30:35 | steps-per-epoch for each domain: 100.04 -> min = 100.04
[37m[36mINFO[0m[0m 02/24 20:30:37 | # of params = 23518277
[37m[36mINFO[0m[0m 02/24 20:33:23 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/24 20:33:23 | 0.493095    0.470461    0.440207    0.459259    1.715599    0.620141    0.593640    0.467294    0.459510    0.391851    0.358232    0.440207    0.459259    0           0.000000    2.064335    1.822103    164.246104 
[37m[36mINFO[0m[0m 02/24 20:36:53 | 0.786815    0.778353    0.875972    0.862222    0.406456    0.982332    0.964664    0.630588    0.647834    0.747525    0.722561    0.875972    0.862222    200         1.999260    0.694691    0.191664    171.037042 
[37m[36mINFO[0m[0m 02/24 20:40:19 | 0.806805    0.796940    0.905591    0.885926    0.354004    0.994700    0.989399    0.630588    0.634652    0.795126    0.766768    0.905591    0.885926    400         3.998519    0.431227    0.180629    170.350947 
[37m[36mINFO[0m[0m 02/24 20:43:34 | 0.811269    0.804849    0.927805    0.890370    0.340036    0.990283    0.985866    0.638118    0.649718    0.805407    0.778963    0.927805    0.890370    600         5.997779    0.358410    0.195656    155.327381 
[37m[36mINFO[0m[0m 02/24 20:46:45 | 0.786798    0.789150    0.944835    0.866667    0.428861    0.991166    0.992933    0.592000    0.621469    0.777228    0.753049    0.944835    0.866667    800         7.997038    0.289954    0.262730    139.214040 
[37m[36mINFO[0m[0m 02/24 20:50:14 | 0.760769    0.773438    0.949648    0.850370    0.484751    0.980565    0.978799    0.549647    0.576271    0.752094    0.765244    0.949648    0.850370    1000        9.996298    0.257281    0.320808    144.472378 
[37m[36mINFO[0m[0m 02/24 20:53:42 | 0.795797    0.785844    0.951870    0.866667    0.438458    0.987633    0.978799    0.644235    0.651601    0.755522    0.727134    0.951870    0.866667    1200        11.995557   0.220883    0.225797    163.079956 
[37m[36mINFO[0m[0m 02/24 20:57:12 | 0.786399    0.800018    0.962236    0.863704    0.529105    0.973498    0.971731    0.608471    0.647834    0.777228    0.780488    0.962236    0.863704    1400        13.994817   0.182968    0.183725    173.282132 
[37m[36mINFO[0m[0m 02/24 21:00:31 | 0.781275    0.779297    0.938541    0.841481    0.510343    0.952297    0.943463    0.623059    0.645951    0.768469    0.748476    0.938541    0.841481    1600        15.994076   0.192358    0.177508    163.483711 
[37m[36mINFO[0m[0m 02/24 21:03:52 | 0.773816    0.788259    0.978897    0.871111    0.470193    0.988516    0.985866    0.577412    0.604520    0.755522    0.774390    0.978897    0.871111    1800        17.993336   0.176594    0.208159    159.390857 
[37m[36mINFO[0m[0m 02/24 21:07:04 | 0.794084    0.792212    0.963717    0.828148    0.675682    0.988516    0.978799    0.654588    0.679849    0.739147    0.717988    0.963717    0.828148    2000        19.992595   0.156835    0.212444    149.589315 
[37m[36mINFO[0m[0m 02/24 21:10:21 | 0.768811    0.773617    0.980378    0.860741    0.608664    0.979682    0.961131    0.576941    0.615819    0.749810    0.743902    0.980378    0.860741    2200        21.991855   0.132334    0.266789    143.559259 
[37m[36mINFO[0m[0m 02/24 21:13:43 | 0.800121    0.805470    0.985931    0.856296    0.513880    0.977915    0.975265    0.641412    0.659134    0.781036    0.782012    0.985931    0.856296    2400        23.991114   0.141185    0.220904    157.349728 
[37m[36mINFO[0m[0m 02/24 21:16:45 | 0.774248    0.781031    0.986301    0.860741    0.811565    0.981449    0.978799    0.595294    0.615819    0.746002    0.748476    0.986301    0.860741    2600        25.990374   0.087805    0.183241    145.725920 
[37m[36mINFO[0m[0m 02/24 21:19:45 | 0.772397    0.784110    0.984450    0.845926    0.742740    0.979682    0.978799    0.593412    0.608286    0.744097    0.765244    0.984450    0.845926    2800        27.989633   0.123714    0.217285    136.275897 
[37m[36mINFO[0m[0m 02/24 21:22:51 | 0.770972    0.773324    0.972603    0.826667    0.836956    0.955830    0.954064    0.588235    0.608286    0.768850    0.757622    0.972603    0.826667    3000        29.988893   0.138266    0.180025    150.042206 
[37m[36mINFO[0m[0m 02/24 21:26:02 | 0.751569    0.759389    0.987782    0.857778    0.543771    0.990283    0.961131    0.557647    0.583804    0.706778    0.733232    0.987782    0.857778    3200        31.988153   0.092539    0.229555    144.811122 
[37m[36mINFO[0m[0m 02/24 21:28:55 | 0.773176    0.777313    0.992225    0.868148    0.572848    0.982332    0.975265    0.595765    0.615819    0.741432    0.740854    0.992225    0.868148    3400        33.987412   0.115915    0.194064    134.970168 
[37m[36mINFO[0m[0m 02/24 21:31:58 | 0.779500    0.779889    0.995927    0.872593    0.856750    0.982332    0.985866    0.593412    0.600753    0.762757    0.753049    0.995927    0.872593    3600        35.986672   0.075403    0.226766    136.811175 
[37m[36mINFO[0m[0m 02/24 21:35:01 | 0.754574    0.746810    0.978156    0.854815    0.675157    0.977032    0.954064    0.550588    0.566855    0.736101    0.719512    0.978156    0.854815    3800        37.985931   0.088117    0.216751    139.935446 
[37m[36mINFO[0m[0m 02/24 21:37:50 | 0.794119    0.782185    0.992595    0.853333    0.733042    0.986749    0.975265    0.632471    0.636535    0.763138    0.734756    0.992595    0.853333    4000        39.985191   0.080079    0.187239    131.290328 
[37m[36mINFO[0m[0m 02/24 21:40:55 | 0.758515    0.760914    0.988893    0.844444    1.060047    0.974382    0.978799    0.558588    0.563089    0.742574    0.740854    0.988893    0.844444    4200        41.984450   0.085755    0.215231    142.314849 
[37m[36mINFO[0m[0m 02/24 21:44:00 | 0.728072    0.742214    0.990004    0.854815    0.892584    0.985866    0.982332    0.516706    0.546139    0.681645    0.698171    0.990004    0.854815    4400        43.983710   0.092138    0.212212    142.912445 
[37m[36mINFO[0m[0m 02/24 21:47:01 | 0.768076    0.769733    0.985561    0.841481    0.845555    0.980565    0.978799    0.588706    0.613936    0.734958    0.716463    0.985561    0.841481    4600        45.982969   0.080719    0.183049    144.089522 
[37m[36mINFO[0m[0m 02/24 21:50:00 | 0.731066    0.737502    0.968530    0.841481    0.709852    0.964664    0.950530    0.541176    0.566855    0.687357    0.695122    0.968530    0.841481    4800        47.982229   0.076728    0.188443    141.150758 
[37m[36mINFO[0m[0m 02/24 21:52:54 | 0.768025    0.768782    0.989263    0.842963    0.810305    0.960247    0.971731    0.598588    0.612053    0.745240    0.722561    0.989263    0.842963    5000        49.981488   0.069232    0.182458    137.925380 
[37m[36mINFO[0m[0m 02/24 21:52:55 | Cumulative gradient change saved at train_output/VLCS/RSC/[0, 1, 2]/250224_20-30-35_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/24 21:52:56 | ---
[37m[36mINFO[0m[0m 02/24 21:52:56 | test-domain validation(oracle) = 80.012%
[37m[36mINFO[0m[0m 02/24 21:52:56 | training-domain validation(iid) = 81.127%
[37m[36mINFO[0m[0m 02/24 21:52:56 | last = 76.803%
[37m[36mINFO[0m[0m 02/24 21:52:56 | last (inD) = 84.296%
[37m[36mINFO[0m[0m 02/24 21:52:56 | training-domain validation (iid, inD) = 89.037%
[37m[36mINFO[0m[0m 02/24 21:52:56 | === Summary ===
[37m[36mINFO[0m[0m 02/24 21:52:56 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 2 --dataset VLCS --trial_seed 2 --hparams_seed 20
[37m[36mINFO[0m[0m 02/24 21:52:56 | Unique name: 250224_20-30-35_resnet50_GENIE
[37m[36mINFO[0m[0m 02/24 21:52:56 | Out path: train_output/VLCS/RSC/[0, 1, 2]/250224_20-30-35_resnet50_GENIE
[37m[36mINFO[0m[0m 02/24 21:52:56 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/24 21:52:56 | Dataset: VLCS

[37m[36mINFO[0m[0m 02/07 18:59:12 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 --dataset VLCS --trial_seed 2 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/VLCS/RSC/[0]/250207_18-59-12_resnet50_GENIE
	out_root: train_output/VLCS/RSC/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 2
	unique_name: 250207_18-59-12_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 3.1159521264763664e-05
	batch_size: 11
	weight_decay: 1.4650833494643601e-05
	rsc_f_drop_factor: 0.1230288403437661
	rsc_b_drop_factor: 0.041552181381268205
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 02/07 18:59:12 | n_steps = 5001
[37m[36mINFO[0m[0m 02/07 18:59:12 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/07 18:59:12 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/07 18:59:12 | 
[37m[36mINFO[0m[0m 02/07 18:59:12 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 02/07 18:59:12 | Test envs = [0], name = te_C
[37m[36mINFO[0m[0m 02/07 18:59:12 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 02/07 18:59:12 | Batch sizes for each domain: [0, 11, 11, 11] (total=33)
[37m[36mINFO[0m[0m 02/07 18:59:12 | steps-per-epoch for each domain: 193.18, 238.73, 245.55 -> min = 193.18
[37m[36mINFO[0m[0m 02/07 18:59:13 | # of params = 23518277
[37m[36mINFO[0m[0m 02/07 19:01:45 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/07 19:01:45 | 0.620141    0.593640    0.434121    0.426075    1.257919    0.620141    0.593640    0.462118    0.459510    0.393374    0.349085    0.446872    0.469630    0           0.000000    2.051868    1.366740    150.407772 
[37m[36mINFO[0m[0m 02/07 19:06:05 | 0.937279    0.925795    0.768914    0.774076    0.604195    0.937279    0.925795    0.705882    0.741996    0.798934    0.771341    0.801925    0.808889    200         1.035294    0.888613    0.522070    155.005838 
[37m[36mINFO[0m[0m 02/07 19:10:29 | 0.974382    0.954064    0.809193    0.800595    0.527856    0.974382    0.954064    0.744941    0.758945    0.824067    0.785061    0.858571    0.857778    400         2.070588    0.671636    0.541143    155.851254 
[37m[36mINFO[0m[0m 02/07 19:14:44 | 0.969965    0.961131    0.802496    0.777738    0.582938    0.969965    0.961131    0.775529    0.757062    0.785605    0.731707    0.846353    0.844444    600         3.105882    0.555553    0.498264    155.493713 
[37m[36mINFO[0m[0m 02/07 19:19:00 | 0.992933    0.985866    0.823276    0.797734    0.535329    0.992933    0.985866    0.763294    0.743879    0.831302    0.804878    0.875231    0.844444    800         4.141176    0.553969    0.510432    154.389928 
[37m[36mINFO[0m[0m 02/07 19:23:21 | 0.984099    0.975265    0.823048    0.790131    0.572531    0.984099    0.975265    0.784000    0.772128    0.834349    0.780488    0.850796    0.817778    1000        5.176471    0.525387    0.519666    156.367626 
[37m[36mINFO[0m[0m 02/07 19:27:36 | 0.995583    0.996466    0.849949    0.813272    0.507637    0.995583    0.996466    0.799529    0.775895    0.861386    0.797256    0.888930    0.866667    1200        6.211765    0.504252    0.470068    161.675531 
[37m[36mINFO[0m[0m 02/07 19:31:55 | 0.990283    0.989399    0.851378    0.816701    0.511392    0.990283    0.989399    0.800000    0.794727    0.852247    0.809451    0.901888    0.845926    1400        7.247059    0.470507    0.473020    163.692431 
[37m[36mINFO[0m[0m 02/07 19:36:08 | 0.984982    0.978799    0.809836    0.794694    0.588943    0.984982    0.978799    0.772235    0.781544    0.790556    0.774390    0.866716    0.828148    1600        8.282353    0.455733    0.478087    158.085979 
[37m[36mINFO[0m[0m 02/07 19:40:20 | 0.962014    0.971731    0.838690    0.796930    0.684824    0.962014    0.971731    0.802353    0.772128    0.836634    0.768293    0.877083    0.850370    1800        9.317647    0.441003    0.508386    149.979475 
[37m[36mINFO[0m[0m 02/07 19:44:18 | 0.991166    0.982332    0.876127    0.821477    0.518577    0.991166    0.982332    0.835765    0.792844    0.878142    0.806402    0.914476    0.865185    2000        10.352941   0.421222    0.440078    149.766185 
[37m[36mINFO[0m[0m 02/07 19:48:21 | 0.931979    0.939929    0.778915    0.741432    0.657944    0.931979    0.939929    0.708235    0.709981    0.781417    0.745427    0.847094    0.768889    2200        11.388235   0.413879    0.464284    150.138928 
[37m[36mINFO[0m[0m 02/07 19:52:23 | 0.984982    0.975265    0.886921    0.819003    0.528628    0.984982    0.975265    0.832000    0.790960    0.899848    0.820122    0.928915    0.845926    2400        12.423529   0.397543    0.458216    151.111087 
[37m[36mINFO[0m[0m 02/07 19:56:25 | 0.968198    0.975265    0.884718    0.797561    0.542447    0.968198    0.975265    0.841882    0.751412    0.892612    0.782012    0.919659    0.859259    2600        13.458824   0.355247    0.452913    151.218600 
[37m[36mINFO[0m[0m 02/07 20:00:25 | 0.977915    0.968198    0.881396    0.789598    0.603931    0.977915    0.968198    0.832000    0.723164    0.889566    0.778963    0.922621    0.866667    2800        14.494118   0.331969    0.458790    147.600015 
[37m[36mINFO[0m[0m 02/07 20:04:26 | 0.981449    0.982332    0.891859    0.780680    0.625721    0.981449    0.982332    0.850824    0.723164    0.902133    0.775915    0.922621    0.842963    3000        15.529412   0.325258    0.475533    145.945353 
[37m[36mINFO[0m[0m 02/07 20:08:23 | 0.972615    0.957597    0.893065    0.801419    0.567018    0.972615    0.957597    0.854588    0.764595    0.896801    0.777439    0.927805    0.862222    3200        16.564706   0.301170    0.453671    146.273616 
[37m[36mINFO[0m[0m 02/07 20:12:32 | 0.955830    0.939929    0.897161    0.803065    0.678556    0.955830    0.939929    0.863059    0.777778    0.900990    0.800305    0.927434    0.831111    3400        17.600000   0.282941    0.499416    149.616308 
[37m[36mINFO[0m[0m 02/07 20:16:39 | 0.974382    0.975265    0.897188    0.802887    0.718059    0.974382    0.975265    0.881882    0.783427    0.879284    0.791159    0.930396    0.834074    3600        18.635294   0.283306    0.492207    147.978837 
[37m[36mINFO[0m[0m 02/07 20:20:46 | 0.969081    0.961131    0.906377    0.794211    0.582640    0.969081    0.961131    0.873412    0.745763    0.910510    0.783537    0.935209    0.853333    3800        19.670588   0.294551    0.503342    146.424432 
[37m[36mINFO[0m[0m 02/07 20:24:45 | 0.953180    0.946996    0.917387    0.795166    0.647272    0.953180    0.946996    0.874824    0.736347    0.929170    0.798780    0.948167    0.850370    4000        20.705882   0.264214    0.449523    149.700571 
[37m[36mINFO[0m[0m 02/07 20:28:47 | 0.943463    0.936396    0.933849    0.788268    0.662461    0.943463    0.936396    0.897882    0.728814    0.944021    0.804878    0.959645    0.831111    4200        21.741176   0.242859    0.468042    147.548898 
[37m[36mINFO[0m[0m 02/07 20:32:44 | 0.979682    0.975265    0.912240    0.780523    0.771383    0.979682    0.975265    0.880000    0.749529    0.920030    0.769817    0.936690    0.822222    4400        22.776471   0.254192    0.467561    143.862154 
[37m[36mINFO[0m[0m 02/07 20:36:29 | 0.966431    0.961131    0.920208    0.783487    0.749143    0.966431    0.961131    0.904941    0.741996    0.922696    0.774390    0.932988    0.834074    4600        23.811765   0.241891    0.425798    139.565665 
[37m[36mINFO[0m[0m 02/07 20:40:19 | 0.964664    0.950530    0.921534    0.787169    0.837516    0.964664    0.950530    0.906824    0.745763    0.918126    0.769817    0.939652    0.845926    4800        24.847059   0.223179    0.433440    143.751979 
[37m[36mINFO[0m[0m 02/07 20:44:15 | 0.959364    0.957597    0.936072    0.797992    0.691543    0.959364    0.957597    0.904941    0.757062    0.943260    0.785061    0.960015    0.851852    5000        25.882353   0.205534    0.446017    146.733392 
[37m[36mINFO[0m[0m 02/07 20:44:15 | Cumulative gradient change saved at train_output/VLCS/RSC/[0]/250207_18-59-12_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/07 20:44:17 | ---
[37m[36mINFO[0m[0m 02/07 20:44:17 | test-domain validation(oracle) = 99.558%
[37m[36mINFO[0m[0m 02/07 20:44:17 | training-domain validation(iid) = 99.117%
[37m[36mINFO[0m[0m 02/07 20:44:17 | last = 95.936%
[37m[36mINFO[0m[0m 02/07 20:44:17 | last (inD) = 79.799%
[37m[36mINFO[0m[0m 02/07 20:44:17 | training-domain validation (iid, inD) = 82.148%
[37m[36mINFO[0m[0m 02/07 20:44:17 | === Summary ===
[37m[36mINFO[0m[0m 02/07 20:44:17 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 --dataset VLCS --trial_seed 2 --hparams_seed 1
[37m[36mINFO[0m[0m 02/07 20:44:17 | Unique name: 250207_18-59-12_resnet50_GENIE
[37m[36mINFO[0m[0m 02/07 20:44:17 | Out path: train_output/VLCS/RSC/[0]/250207_18-59-12_resnet50_GENIE
[37m[36mINFO[0m[0m 02/07 20:44:17 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/07 20:44:17 | Dataset: VLCS

[37m[36mINFO[0m[0m 02/11 04:16:22 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset VLCS --trial_seed 0 --hparams_seed 11
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 11
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/VLCS/RSC/[3]/250211_04-16-22_resnet50_GENIE
	out_root: train_output/VLCS/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250211_04-16-22_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5.962562271631622e-05
	batch_size: 11
	weight_decay: 0.001114945719897867
	rsc_f_drop_factor: 0.4274398027176696
	rsc_b_drop_factor: 0.4906745147717738
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 02/11 04:16:22 | n_steps = 5001
[37m[36mINFO[0m[0m 02/11 04:16:22 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/11 04:16:22 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/11 04:16:22 | 
[37m[36mINFO[0m[0m 02/11 04:16:22 | Testenv name escaping te_V -> te_V
[37m[36mINFO[0m[0m 02/11 04:16:22 | Test envs = [3], name = te_V
[37m[36mINFO[0m[0m 02/11 04:16:22 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/11 04:16:22 | Batch sizes for each domain: [11, 11, 11, 0] (total=33)
[37m[36mINFO[0m[0m 02/11 04:16:22 | steps-per-epoch for each domain: 102.91, 193.18, 238.73 -> min = 102.91
[37m[36mINFO[0m[0m 02/11 04:16:23 | # of params = 23518277
[37m[36mINFO[0m[0m 02/11 04:18:38 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/11 04:18:38 | 0.440207    0.445926    0.484565    0.501938    1.385616    0.611307    0.628975    0.459294    0.489642    0.383092    0.387195    0.440207    0.445926    0           0.000000    4.004403    0.901453    133.457247 
[37m[36mINFO[0m[0m 02/11 04:22:22 | 0.445020    0.447407    0.494252    0.509548    1.012814    0.628092    0.643110    0.467765    0.495292    0.386900    0.390244    0.445020    0.447407    200         1.943463    1.404373    0.434248    137.282238 
[37m[36mINFO[0m[0m 02/11 04:26:12 | 0.459089    0.471111    0.530733    0.543722    0.763811    0.700530    0.706714    0.462118    0.491525    0.429551    0.432927    0.459089    0.471111    400         3.886926    1.215587    0.440358    141.726666 
[37m[36mINFO[0m[0m 02/11 04:29:51 | 0.503517    0.487407    0.559734    0.575704    0.715707    0.799470    0.802120    0.473412    0.510358    0.406321    0.414634    0.503517    0.487407    600         5.830389    1.063603    0.422965    134.889751 
[37m[36mINFO[0m[0m 02/11 04:33:36 | 0.589782    0.580741    0.698642    0.696661    0.668628    0.912544    0.911661    0.617882    0.647834    0.565499    0.530488    0.589782    0.580741    800         7.773852    1.020199    0.439293    136.650900 
[37m[36mINFO[0m[0m 02/11 04:37:24 | 0.609774    0.607407    0.703841    0.721664    0.639351    0.925795    0.932862    0.662118    0.706215    0.523610    0.525915    0.609774    0.607407    1000        9.717314    0.993683    0.427818    142.192573 
[37m[36mINFO[0m[0m 02/11 04:41:08 | 0.610885    0.586667    0.682249    0.676898    0.670685    0.901943    0.901060    0.669176    0.672316    0.475628    0.457317    0.610885    0.586667    1200        11.660777   0.972402    0.418479    140.440793 
[37m[36mINFO[0m[0m 02/11 04:44:48 | 0.630507    0.605926    0.706280    0.697860    0.662566    0.865724    0.851590    0.680000    0.677966    0.573115    0.564024    0.630507    0.605926    1400        13.604240   0.965425    0.431689    134.437789 
[37m[36mINFO[0m[0m 02/11 04:48:34 | 0.639023    0.645926    0.753933    0.722502    0.630034    0.924028    0.908127    0.636706    0.593220    0.701066    0.666159    0.639023    0.645926    1600        15.547703   0.948044    0.450703    135.771841 
[37m[36mINFO[0m[0m 02/11 04:52:17 | 0.608663    0.589630    0.717509    0.724590    0.607275    0.867491    0.879859    0.677647    0.702448    0.607388    0.591463    0.608663    0.589630    1800        17.491166   0.919920    0.422330    138.212302 
[37m[36mINFO[0m[0m 02/11 04:56:00 | 0.661977    0.635556    0.785998    0.780920    0.551914    0.964664    0.971731    0.706353    0.723164    0.686976    0.647866    0.661977    0.635556    2000        19.434629   0.923710    0.441943    134.133528 
[37m[36mINFO[0m[0m 02/11 04:59:40 | 0.731211    0.714074    0.817507    0.796205    0.560663    0.972615    0.975265    0.703059    0.689266    0.776847    0.724085    0.731211    0.714074    2200        21.378092   0.892631    0.423602    135.662610 
[37m[36mINFO[0m[0m 02/11 05:03:17 | 0.647908    0.642963    0.762838    0.721497    0.637112    0.928445    0.911661    0.601882    0.566855    0.758187    0.685976    0.647908    0.642963    2400        23.321555   0.909491    0.419616    133.242135 
[37m[36mINFO[0m[0m 02/11 05:07:01 | 0.648278    0.651852    0.821049    0.792264    0.568904    0.962014    0.950530    0.678588    0.661017    0.822544    0.765244    0.648278    0.651852    2600        25.265018   0.895075    0.442531    135.458673 
[37m[36mINFO[0m[0m 02/11 05:10:44 | 0.684932    0.696296    0.833697    0.809303    0.548864    0.992049    0.985866    0.686118    0.679849    0.822925    0.762195    0.684932    0.696296    2800        27.208481   0.852366    0.442787    134.809412 
[37m[36mINFO[0m[0m 02/11 05:14:31 | 0.734543    0.736296    0.858359    0.842806    0.546855    0.987633    0.992933    0.747765    0.738230    0.839680    0.797256    0.734543    0.736296    3000        29.151943   0.837614    0.456659    135.272402 
[37m[36mINFO[0m[0m 02/11 05:18:13 | 0.686783    0.663704    0.818361    0.783017    0.675575    0.960247    0.946996    0.729412    0.709981    0.765423    0.692073    0.686783    0.663704    3200        31.095406   0.851750    0.443231    133.261006 
[37m[36mINFO[0m[0m 02/11 05:21:58 | 0.745650    0.740741    0.841778    0.811677    0.561324    0.993816    0.989399    0.710118    0.698682    0.821401    0.746951    0.745650    0.740741    3400        33.038869   0.849965    0.430771    138.596561 
[37m[36mINFO[0m[0m 02/11 05:25:47 | 0.743428    0.749630    0.859690    0.824740    0.677802    0.993816    0.989399    0.756235    0.736347    0.829018    0.748476    0.743428    0.749630    3600        34.982332   0.816644    0.441285    140.694767 
[37m[36mINFO[0m[0m 02/11 05:29:31 | 0.715291    0.685926    0.851070    0.811302    0.601325    0.992049    0.992933    0.781647    0.738230    0.779513    0.702744    0.715291    0.685926    3800        36.925795   0.805833    0.430679    138.638743 
[37m[36mINFO[0m[0m 02/11 05:33:14 | 0.634950    0.647407    0.854865    0.809585    0.632995    0.987633    0.989399    0.748706    0.681733    0.828256    0.757622    0.634950    0.647407    4000        38.869258   0.819042    0.440465    134.313635 
[37m[36mINFO[0m[0m 02/11 05:36:58 | 0.730470    0.717037    0.874390    0.838323    0.573267    0.994700    0.992933    0.773176    0.747646    0.855293    0.774390    0.730470    0.717037    4200        40.812721   0.797406    0.444279    135.636403 
[37m[36mINFO[0m[0m 02/11 05:40:44 | 0.697519    0.684444    0.876015    0.823174    0.589933    0.987633    0.985866    0.785882    0.738230    0.854532    0.745427    0.697519    0.684444    4400        42.756184   0.783397    0.443612    136.516837 
[37m[36mINFO[0m[0m 02/11 05:44:30 | 0.725657    0.712593    0.883955    0.837026    0.557418    0.992049    0.989399    0.795765    0.745763    0.864052    0.775915    0.725657    0.712593    4600        44.699647   0.802793    0.441202    137.901560 
[37m[36mINFO[0m[0m 02/11 05:48:20 | 0.692706    0.702222    0.885299    0.816586    0.635144    0.998233    1.000000    0.792471    0.704331    0.865194    0.745427    0.692706    0.702222    4800        46.643110   0.808711    0.452112    139.372454 
[37m[36mINFO[0m[0m 02/11 05:52:06 | 0.669752    0.688889    0.884985    0.821541    0.593260    0.992049    0.989399    0.792000    0.709981    0.870906    0.765244    0.669752    0.688889    5000        48.586572   0.776745    0.441335    137.822743 
[37m[36mINFO[0m[0m 02/11 05:52:06 | Cumulative gradient change saved at train_output/VLCS/RSC/[3]/250211_04-16-22_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/11 05:52:07 | ---
[37m[36mINFO[0m[0m 02/11 05:52:07 | test-domain validation(oracle) = 74.343%
[37m[36mINFO[0m[0m 02/11 05:52:07 | training-domain validation(iid) = 73.454%
[37m[36mINFO[0m[0m 02/11 05:52:07 | last = 66.975%
[37m[36mINFO[0m[0m 02/11 05:52:07 | last (inD) = 82.154%
[37m[36mINFO[0m[0m 02/11 05:52:07 | training-domain validation (iid, inD) = 84.281%
[37m[36mINFO[0m[0m 02/11 05:52:07 | === Summary ===
[37m[36mINFO[0m[0m 02/11 05:52:07 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset VLCS --trial_seed 0 --hparams_seed 11
[37m[36mINFO[0m[0m 02/11 05:52:07 | Unique name: 250211_04-16-22_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 05:52:07 | Out path: train_output/VLCS/RSC/[3]/250211_04-16-22_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 05:52:07 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/11 05:52:07 | Dataset: VLCS

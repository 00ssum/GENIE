[37m[36mINFO[0m[0m 02/25 12:00:57 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset VLCS --trial_seed 2 --hparams_seed 20
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 20
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/VLCS/RSC/[3]/250225_12-00-57_resnet50_GENIE
	out_root: train_output/VLCS/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250225_12-00-57_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 3.0575564760860844e-05
	batch_size: 27
	weight_decay: 7.45235722180653e-06
	rsc_f_drop_factor: 0.29037470564885265
	rsc_b_drop_factor: 0.006830956171108737
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 02/25 12:00:57 | n_steps = 5001
[37m[36mINFO[0m[0m 02/25 12:00:57 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/25 12:00:57 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/25 12:00:57 | 
[37m[36mINFO[0m[0m 02/25 12:00:57 | Testenv name escaping te_V -> te_V
[37m[36mINFO[0m[0m 02/25 12:00:57 | Test envs = [3], name = te_V
[37m[36mINFO[0m[0m 02/25 12:00:57 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/25 12:00:57 | Batch sizes for each domain: [27, 27, 27, 0] (total=81)
[37m[36mINFO[0m[0m 02/25 12:00:57 | steps-per-epoch for each domain: 41.93, 78.70, 97.26 -> min = 41.93
[37m[36mINFO[0m[0m 02/25 12:00:58 | # of params = 23518277
[37m[36mINFO[0m[0m 02/25 12:03:13 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/25 12:03:13 | 0.440207    0.459259    0.493095    0.470461    1.272449    0.620141    0.593640    0.467294    0.459510    0.391851    0.358232    0.440207    0.459259    0           0.000000    1.858665    1.866903    133.084835 
[37m[36mINFO[0m[0m 02/25 12:08:59 | 0.777860    0.779259    0.868101    0.843267    0.393199    0.998233    0.996466    0.775529    0.758945    0.830541    0.774390    0.777860    0.779259    200         4.770318    0.506399    1.022862    140.690775 
[37m[36mINFO[0m[0m 02/25 12:14:49 | 0.785635    0.801481    0.881883    0.862201    0.364337    0.999117    1.000000    0.792000    0.798493    0.854532    0.788110    0.785635    0.801481    400         9.540636    0.370492    1.031128    143.658233 
[37m[36mINFO[0m[0m 02/25 12:20:25 | 0.776009    0.776296    0.890396    0.849562    0.372893    0.999117    0.992933    0.798118    0.764595    0.873953    0.791159    0.776009    0.776296    600         14.310954   0.333026    1.015490    133.286061 
[37m[36mINFO[0m[0m 02/25 12:26:12 | 0.763791    0.774815    0.896463    0.853203    0.393736    1.000000    1.000000    0.807059    0.760829    0.882331    0.798780    0.763791    0.774815    800         19.081272   0.292993    1.038940    139.805561 
[37m[36mINFO[0m[0m 02/25 12:32:02 | 0.727138    0.724444    0.911212    0.850722    0.384560    0.999117    1.000000    0.848000    0.745763    0.886519    0.806402    0.727138    0.724444    1000        23.851590   0.258331    1.027246    144.237072 
[37m[36mINFO[0m[0m 02/25 12:37:45 | 0.788967    0.771852    0.917978    0.854865    0.435441    0.999117    0.996466    0.854588    0.781544    0.900228    0.786585    0.788967    0.771852    1200        28.621908   0.255966    1.013945    139.532266 
[37m[36mINFO[0m[0m 02/25 12:43:37 | 0.741207    0.734815    0.924947    0.843386    0.433573    1.000000    0.996466    0.851765    0.728814    0.923077    0.804878    0.741207    0.734815    1400        33.392226   0.225382    1.030680    146.333833 
[37m[36mINFO[0m[0m 02/25 12:49:28 | 0.754165    0.758519    0.919341    0.840851    0.507858    0.999117    0.989399    0.830118    0.741996    0.928789    0.791159    0.754165    0.758519    1600        38.162544   0.193736    1.059351    138.926857 
[37m[36mINFO[0m[0m 02/25 12:55:09 | 0.778971    0.776296    0.956869    0.852174    0.468408    1.000000    0.996466    0.918588    0.755179    0.952018    0.804878    0.778971    0.776296    1800        42.932862   0.175482    1.028962    135.663375 
[37m[36mINFO[0m[0m 02/25 13:00:49 | 0.773787    0.767407    0.930071    0.842089    0.529716    0.999117    0.992933    0.887059    0.758945    0.904037    0.774390    0.773787    0.767407    2000        47.703180   0.162780    1.005301    138.381543 
[37m[36mINFO[0m[0m 02/25 13:06:28 | 0.756016    0.749630    0.965349    0.849144    0.610698    0.999117    0.992933    0.930824    0.774011    0.966108    0.780488    0.756016    0.749630    2200        52.473498   0.135732    1.022344    135.112244 
[37m[36mINFO[0m[0m 02/25 13:12:05 | 0.741207    0.748148    0.969886    0.853060    0.597009    1.000000    0.992933    0.941647    0.779661    0.968012    0.786585    0.741207    0.748148    2400        57.243816   0.140105    0.991544    138.878731 
[37m[36mINFO[0m[0m 02/25 13:17:46 | 0.724176    0.733333    0.979296    0.854362    0.654824    1.000000    0.989399    0.953882    0.762712    0.984006    0.810976    0.724176    0.733333    2600        62.014134   0.106722    0.988750    143.213959 
[37m[36mINFO[0m[0m 02/25 13:23:29 | 0.755646    0.743704    0.980723    0.849741    0.641164    1.000000    0.992933    0.962353    0.751412    0.979817    0.804878    0.755646    0.743704    2800        66.784452   0.091318    1.024759    138.034387 
[37m[36mINFO[0m[0m 02/25 13:29:11 | 0.739726    0.736296    0.970335    0.843135    0.748969    1.000000    0.992933    0.948706    0.751412    0.962300    0.785061    0.739726    0.736296    3000        71.554770   0.109537    0.996763    142.120185 
[37m[36mINFO[0m[0m 02/25 13:34:53 | 0.723436    0.714074    0.977556    0.853657    0.635932    1.000000    0.992933    0.952471    0.757062    0.980198    0.810976    0.723436    0.714074    3200        76.325088   0.085176    1.012830    139.809148 
[37m[36mINFO[0m[0m 02/25 13:40:35 | 0.728619    0.724444    0.986683    0.845915    0.755333    1.000000    0.992933    0.972235    0.755179    0.987814    0.789634    0.728619    0.724444    3400        81.095406   0.066819    1.010831    139.187919 
[37m[36mINFO[0m[0m 02/25 13:46:21 | 0.770455    0.761481    0.989708    0.851129    0.735583    1.000000    0.996466    0.977882    0.762712    0.991241    0.794207    0.770455    0.761481    3600        85.865724   0.078234    1.013925    143.785214 
[37m[36mINFO[0m[0m 02/25 13:52:12 | 0.711959    0.706667    0.977337    0.845646    0.722335    0.999117    0.992933    0.957647    0.758945    0.975248    0.785061    0.711959    0.706667    3800        90.636042   0.064335    1.034229    143.667283 
[37m[36mINFO[0m[0m 02/25 13:57:48 | 0.729730    0.737778    0.991673    0.849783    0.884138    1.000000    0.996466    0.986824    0.749529    0.988195    0.803354    0.729730    0.737778    4000        95.406360   0.053911    1.002352    135.489887 
[37m[36mINFO[0m[0m 02/25 14:03:32 | 0.757497    0.764444    0.991523    0.846753    0.860981    1.000000    0.992933    0.984471    0.768362    0.990099    0.778963    0.757497    0.764444    4200        100.176678  0.053140    1.028205    138.163731 
[37m[36mINFO[0m[0m 02/25 14:09:20 | 0.721955    0.721481    0.974717    0.827322    0.815895    1.000000    0.992933    0.939765    0.702448    0.984387    0.786585    0.721955    0.721481    4400        104.946996  0.055590    1.041807    140.416925 
[37m[36mINFO[0m[0m 02/25 14:15:03 | 0.732321    0.745185    0.991897    0.840792    0.805155    1.000000    0.989399    0.986353    0.757062    0.989337    0.775915    0.732321    0.745185    4600        109.717314  0.052617    1.020576    138.943902 
[37m[36mINFO[0m[0m 02/25 14:20:49 | 0.722695    0.733333    0.974196    0.836051    1.087312    1.000000    0.992933    0.951529    0.743879    0.971059    0.771341    0.722695    0.733333    4800        114.487633  0.049536    1.012787    143.210067 
[37m[36mINFO[0m[0m 02/25 14:26:29 | 0.648649    0.642963    0.961780    0.827138    0.806158    1.000000    1.000000    0.961882    0.734463    0.923458    0.746951    0.648649    0.642963    5000        119.257951  0.044160    1.022869    135.104626 
[37m[36mINFO[0m[0m 02/25 14:26:29 | Cumulative gradient change saved at train_output/VLCS/RSC/[3]/250225_12-00-57_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/25 14:26:31 | ---
[37m[36mINFO[0m[0m 02/25 14:26:31 | test-domain validation(oracle) = 78.563%
[37m[36mINFO[0m[0m 02/25 14:26:31 | training-domain validation(iid) = 78.563%
[37m[36mINFO[0m[0m 02/25 14:26:31 | last = 64.865%
[37m[36mINFO[0m[0m 02/25 14:26:31 | last (inD) = 82.714%
[37m[36mINFO[0m[0m 02/25 14:26:31 | training-domain validation (iid, inD) = 86.220%
[37m[36mINFO[0m[0m 02/25 14:26:31 | === Summary ===
[37m[36mINFO[0m[0m 02/25 14:26:31 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset VLCS --trial_seed 2 --hparams_seed 20
[37m[36mINFO[0m[0m 02/25 14:26:31 | Unique name: 250225_12-00-57_resnet50_GENIE
[37m[36mINFO[0m[0m 02/25 14:26:31 | Out path: train_output/VLCS/RSC/[3]/250225_12-00-57_resnet50_GENIE
[37m[36mINFO[0m[0m 02/25 14:26:31 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/25 14:26:31 | Dataset: VLCS

[37m[36mINFO[0m[0m 02/16 05:05:42 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset VLCS --trial_seed 1 --hparams_seed 9
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 9
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/VLCS/RSC/[3]/250216_05-05-42_resnet50_GENIE
	out_root: train_output/VLCS/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250216_05-05-42_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.7532223448653515e-05
	batch_size: 36
	weight_decay: 0.007511403320794324
	rsc_f_drop_factor: 0.47049384666007127
	rsc_b_drop_factor: 0.32275146960807627
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 02/16 05:05:42 | n_steps = 5001
[37m[36mINFO[0m[0m 02/16 05:05:42 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/16 05:05:42 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/16 05:05:42 | 
[37m[36mINFO[0m[0m 02/16 05:05:42 | Testenv name escaping te_V -> te_V
[37m[36mINFO[0m[0m 02/16 05:05:42 | Test envs = [3], name = te_V
[37m[36mINFO[0m[0m 02/16 05:05:42 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/16 05:05:42 | Batch sizes for each domain: [36, 36, 36, 0] (total=108)
[37m[36mINFO[0m[0m 02/16 05:05:42 | steps-per-epoch for each domain: 31.44, 59.03, 72.94 -> min = 31.44
[37m[36mINFO[0m[0m 02/16 05:05:44 | # of params = 23518277
[37m[36mINFO[0m[0m 02/16 05:08:25 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/16 05:08:25 | 0.453536    0.405926    0.485800    0.499658    1.297044    0.613958    0.618375    0.466824    0.461394    0.376618    0.419207    0.453536    0.405926    0           0.000000    3.495127    2.272752    159.055260 
[37m[36mINFO[0m[0m 02/16 05:16:05 | 0.632358    0.641481    0.763546    0.748492    0.597989    0.945230    0.929329    0.692706    0.659134    0.652704    0.657012    0.632358    0.641481    200         6.360424    1.173306    1.539371    151.757318 
[37m[36mINFO[0m[0m 02/16 05:23:37 | 0.669752    0.668148    0.825590    0.813937    0.504368    0.992933    0.985866    0.733647    0.696798    0.750190    0.759146    0.669752    0.668148    400         12.720848   0.940613    1.508402    151.067667 
[37m[36mINFO[0m[0m 02/16 05:31:02 | 0.696409    0.696296    0.848658    0.836111    0.460476    0.997350    0.992933    0.745882    0.728814    0.802742    0.786585    0.696409    0.696296    600         19.081272   0.887793    1.438582    156.412692 
[37m[36mINFO[0m[0m 02/16 05:38:20 | 0.679748    0.680000    0.850571    0.830693    0.453635    0.989399    0.964664    0.755765    0.743879    0.806550    0.783537    0.679748    0.680000    800         25.441696   0.856275    1.455377    146.872177 
[37m[36mINFO[0m[0m 02/16 05:45:39 | 0.697149    0.696296    0.871103    0.845126    0.415906    1.000000    0.989399    0.783529    0.753296    0.829779    0.792683    0.697149    0.696296    1000        31.802120   0.837064    1.461311    146.880865 
[37m[36mINFO[0m[0m 02/16 05:52:51 | 0.684191    0.678519    0.875270    0.837779    0.421420    1.000000    1.000000    0.789176    0.741996    0.836634    0.771341    0.684191    0.678519    1200        38.162544   0.823144    1.411774    149.675887 
[37m[36mINFO[0m[0m 02/16 06:00:07 | 0.656424    0.657778    0.864787    0.828202    0.443627    1.000000    0.996466    0.792000    0.745763    0.802361    0.742378    0.656424    0.657778    1400        44.522968   0.810245    1.420140    151.935890 
[37m[36mINFO[0m[0m 02/16 06:07:30 | 0.701592    0.694815    0.863203    0.835245    0.489435    1.000000    0.992933    0.783059    0.755179    0.806550    0.757622    0.701592    0.694815    1600        50.883392   0.794010    1.469430    149.007697 
[37m[36mINFO[0m[0m 02/16 06:14:43 | 0.687523    0.666667    0.858136    0.831411    0.480571    0.990283    0.982332    0.796235    0.734463    0.787890    0.777439    0.687523    0.666667    1800        57.243816   0.790064    1.439961    145.420483 
[37m[36mINFO[0m[0m 02/16 06:22:10 | 0.676416    0.687407    0.886652    0.842453    0.465723    0.998233    0.985866    0.803765    0.745763    0.857959    0.795732    0.676416    0.687407    2000        63.604240   0.764269    1.488063    149.405543 
[37m[36mINFO[0m[0m 02/16 06:29:31 | 0.692336    0.687407    0.886057    0.827191    0.453851    0.999117    0.989399    0.795765    0.726930    0.863290    0.765244    0.692336    0.687407    2200        69.964664   0.752088    1.455773    149.828585 
[37m[36mINFO[0m[0m 02/16 06:36:52 | 0.708626    0.705185    0.886277    0.830748    0.449223    0.998233    0.989399    0.785882    0.726930    0.874714    0.775915    0.708626    0.705185    2400        76.325088   0.760126    1.448903    151.560835 
[37m[36mINFO[0m[0m 02/16 06:44:25 | 0.676046    0.669630    0.887695    0.830282    0.493116    0.998233    0.992933    0.780235    0.725047    0.884615    0.772866    0.676046    0.669630    2600        82.685512   0.758478    1.463769    159.529305 
[37m[36mINFO[0m[0m 02/16 06:51:52 | 0.678267    0.654815    0.883790    0.830964    0.589211    0.994700    0.982332    0.829176    0.751412    0.827494    0.759146    0.678267    0.654815    2800        89.045936   0.737567    1.454777    156.071552 
[37m[36mINFO[0m[0m 02/16 06:59:50 | 0.693817    0.684444    0.865144    0.817015    0.528678    0.997350    0.985866    0.741647    0.689266    0.856436    0.775915    0.693817    0.684444    3000        95.406360   0.724296    1.545503    169.113297 
[37m[36mINFO[0m[0m 02/16 07:08:12 | 0.680118    0.668148    0.872886    0.808467    0.481660    1.000000    0.985866    0.773647    0.698682    0.845011    0.740854    0.680118    0.668148    3200        101.766784  0.706424    1.678718    166.420752 
[37m[36mINFO[0m[0m 02/16 07:16:24 | 0.637912    0.663704    0.892238    0.828117    0.467769    0.996466    0.989399    0.799059    0.717514    0.881188    0.777439    0.637912    0.663704    3400        108.127208  0.735289    1.631364    165.215688 
[37m[36mINFO[0m[0m 02/16 07:24:22 | 0.632358    0.631111    0.904472    0.824310    0.522359    0.995583    0.985866    0.850353    0.740113    0.867479    0.746951    0.632358    0.631111    3600        114.487633  0.704690    1.600930    157.873448 
[37m[36mINFO[0m[0m 02/16 07:32:28 | 0.627545    0.644444    0.893732    0.807744    0.506569    1.000000    0.992933    0.824000    0.706215    0.857197    0.724085    0.627545    0.644444    3800        120.848057  0.724653    1.594455    167.577199 
[37m[36mINFO[0m[0m 02/16 07:40:41 | 0.643465    0.647407    0.919811    0.831884    0.491813    1.000000    0.989399    0.858824    0.728814    0.900609    0.777439    0.643465    0.647407    4000        127.208481  0.676727    1.632775    166.277121 
[37m[36mINFO[0m[0m 02/16 07:49:01 | 0.592373    0.613333    0.890582    0.801288    0.513260    0.998233    0.992933    0.821647    0.700565    0.851866    0.710366    0.592373    0.613333    4200        133.568905  0.681929    1.607049    178.653775 
[37m[36mINFO[0m[0m 02/16 07:57:13 | 0.659015    0.644444    0.867994    0.810577    0.605342    0.996466    0.982332    0.807059    0.702448    0.800457    0.746951    0.659015    0.644444    4400        139.929329  0.754560    1.597370    172.118741 
[37m[36mINFO[0m[0m 02/16 08:05:15 | 0.690115    0.672593    0.907367    0.822797    0.563426    0.999117    0.989399    0.849412    0.713748    0.873572    0.765244    0.690115    0.672593    4600        146.289753  0.700859    1.605185    161.347526 
[37m[36mINFO[0m[0m 02/16 08:13:28 | 0.624213    0.625185    0.906816    0.817482    0.598722    0.995583    0.982332    0.851294    0.723164    0.873572    0.746951    0.624213    0.625185    4800        152.650177  0.729276    1.674530    158.387718 
[37m[36mINFO[0m[0m 02/16 08:20:52 | 0.616438    0.625185    0.887524    0.816149    0.745408    0.997350    0.985866    0.814118    0.715631    0.851104    0.746951    0.616438    0.625185    5000        159.010601  0.687852    1.512178    141.438685 
[37m[36mINFO[0m[0m 02/16 08:20:52 | Cumulative gradient change saved at train_output/VLCS/RSC/[3]/250216_05-05-42_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/16 08:20:54 | ---
[37m[36mINFO[0m[0m 02/16 08:20:54 | test-domain validation(oracle) = 70.863%
[37m[36mINFO[0m[0m 02/16 08:20:54 | training-domain validation(iid) = 69.715%
[37m[36mINFO[0m[0m 02/16 08:20:54 | last = 61.644%
[37m[36mINFO[0m[0m 02/16 08:20:54 | last (inD) = 81.615%
[37m[36mINFO[0m[0m 02/16 08:20:54 | training-domain validation (iid, inD) = 84.513%
[37m[36mINFO[0m[0m 02/16 08:20:54 | === Summary ===
[37m[36mINFO[0m[0m 02/16 08:20:54 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset VLCS --trial_seed 1 --hparams_seed 9
[37m[36mINFO[0m[0m 02/16 08:20:54 | Unique name: 250216_05-05-42_resnet50_GENIE
[37m[36mINFO[0m[0m 02/16 08:20:54 | Out path: train_output/VLCS/RSC/[3]/250216_05-05-42_resnet50_GENIE
[37m[36mINFO[0m[0m 02/16 08:20:54 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/16 08:20:54 | Dataset: VLCS

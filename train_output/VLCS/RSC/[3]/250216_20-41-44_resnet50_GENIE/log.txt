[37m[36mINFO[0m[0m 02/16 20:41:44 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset VLCS --trial_seed 1 --hparams_seed 16
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 16
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/VLCS/RSC/[3]/250216_20-41-44_resnet50_GENIE
	out_root: train_output/VLCS/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250216_20-41-44_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.3198033474735314e-05
	batch_size: 10
	weight_decay: 0.001844990356992375
	rsc_f_drop_factor: 0.27713000830136736
	rsc_b_drop_factor: 0.05247973244384463
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 02/16 20:41:45 | n_steps = 5001
[37m[36mINFO[0m[0m 02/16 20:41:45 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/16 20:41:45 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/16 20:41:45 | 
[37m[36mINFO[0m[0m 02/16 20:41:45 | Testenv name escaping te_V -> te_V
[37m[36mINFO[0m[0m 02/16 20:41:45 | Test envs = [3], name = te_V
[37m[36mINFO[0m[0m 02/16 20:41:45 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/16 20:41:45 | Batch sizes for each domain: [10, 10, 10, 0] (total=30)
[37m[36mINFO[0m[0m 02/16 20:41:45 | steps-per-epoch for each domain: 113.20, 212.50, 262.60 -> min = 113.20
[37m[36mINFO[0m[0m 02/16 20:41:46 | # of params = 23518277
[37m[36mINFO[0m[0m 02/16 20:44:01 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/16 20:44:01 | 0.453536    0.405926    0.485800    0.499658    1.398694    0.613958    0.618375    0.466824    0.461394    0.376618    0.419207    0.453536    0.405926    0           0.000000    2.304871    0.905546    134.253375 
[37m[36mINFO[0m[0m 02/16 20:47:29 | 0.705665    0.687407    0.820886    0.824794    0.462798    0.997350    0.996466    0.722353    0.708098    0.742955    0.769817    0.705665    0.687407    200         1.766784    0.719901    0.364118    135.679461 
[37m[36mINFO[0m[0m 02/16 20:51:07 | 0.714180    0.714074    0.845062    0.843728    0.410422    0.998233    1.000000    0.742588    0.747646    0.794364    0.783537    0.714180    0.714074    400         3.533569    0.545706    0.380569    142.161416 
[37m[36mINFO[0m[0m 02/16 20:54:37 | 0.780452    0.780741    0.861572    0.854476    0.390020    1.000000    0.996466    0.761412    0.751412    0.823305    0.815549    0.780452    0.780741    600         5.300353    0.493593    0.367402    135.650780 
[37m[36mINFO[0m[0m 02/16 20:58:04 | 0.711959    0.720000    0.850084    0.838544    0.430902    1.000000    0.996466    0.728471    0.732580    0.821782    0.786585    0.711959    0.720000    800         7.067138    0.442140    0.365252    133.964478 
[37m[36mINFO[0m[0m 02/16 21:01:30 | 0.714180    0.699259    0.851565    0.835346    0.416383    1.000000    0.996466    0.747765    0.738230    0.806931    0.771341    0.714180    0.699259    1000        8.833922    0.426920    0.358821    134.851676 
[37m[36mINFO[0m[0m 02/16 21:04:59 | 0.750093    0.734815    0.857092    0.836236    0.426556    0.997350    0.985866    0.780706    0.743879    0.793222    0.778963    0.750093    0.734815    1200        10.600707   0.424884    0.371755    133.935114 
[37m[36mINFO[0m[0m 02/16 21:08:28 | 0.764902    0.731852    0.875707    0.843679    0.410249    0.996466    0.985866    0.806588    0.757062    0.824067    0.788110    0.764902    0.731852    1400        12.367491   0.419961    0.370172    134.916313 
[37m[36mINFO[0m[0m 02/16 21:11:57 | 0.766753    0.749630    0.874961    0.849968    0.475179    0.999117    0.989399    0.792941    0.749529    0.832826    0.810976    0.766753    0.749630    1600        14.134276   0.399449    0.368591    135.416081 
[37m[36mINFO[0m[0m 02/16 21:15:29 | 0.695298    0.687407    0.869704    0.845019    0.418203    0.997350    0.992933    0.785412    0.757062    0.826352    0.785061    0.695298    0.687407    1800        15.901060   0.393201    0.389521    134.533087 
[37m[36mINFO[0m[0m 02/16 21:19:01 | 0.774898    0.773333    0.889758    0.862851    0.379588    1.000000    0.989399    0.809412    0.768362    0.859863    0.830793    0.774898    0.773333    2000        17.667845   0.388736    0.382679    135.130920 
[37m[36mINFO[0m[0m 02/16 21:22:33 | 0.737134    0.727407    0.885810    0.851696    0.404304    0.999117    0.996466    0.785882    0.747646    0.872430    0.810976    0.737134    0.727407    2200        19.434629   0.369870    0.378878    136.663901 
[37m[36mINFO[0m[0m 02/16 21:26:04 | 0.704924    0.727407    0.887474    0.846596    0.418021    0.998233    0.982332    0.804706    0.749529    0.859482    0.807927    0.704924    0.727407    2400        21.201413   0.366215    0.383949    134.189234 
[37m[36mINFO[0m[0m 02/16 21:29:41 | 0.648278    0.640000    0.865206    0.819958    0.470429    0.990283    0.989399    0.789647    0.725047    0.815689    0.745427    0.648278    0.640000    2600        22.968198   0.346762    0.424269    131.561489 
[37m[36mINFO[0m[0m 02/16 21:33:12 | 0.728619    0.720000    0.902120    0.839165    0.420053    0.998233    0.985866    0.833412    0.741996    0.874714    0.789634    0.728619    0.720000    2800        24.734982   0.369710    0.398533    131.910733 
[37m[36mINFO[0m[0m 02/16 21:36:38 | 0.752684    0.748148    0.913633    0.853699    0.386644    1.000000    0.996466    0.839529    0.755179    0.901371    0.809451    0.752684    0.748148    3000        26.501767   0.329258    0.377279    130.667223 
[37m[36mINFO[0m[0m 02/16 21:40:16 | 0.729730    0.742222    0.916488    0.858906    0.449613    1.000000    0.989399    0.856471    0.770245    0.892993    0.817073    0.729730    0.742222    3200        28.268551   0.335109    0.423831    132.365698 
[37m[36mINFO[0m[0m 02/16 21:43:42 | 0.714550    0.691852    0.907802    0.844630    0.420513    1.000000    0.992933    0.837647    0.758945    0.885758    0.782012    0.714550    0.691852    3400        30.035336   0.324226    0.374165    132.078840 
[37m[36mINFO[0m[0m 02/16 21:47:12 | 0.732692    0.724444    0.899400    0.833994    0.468106    1.000000    0.985866    0.827294    0.732580    0.870906    0.783537    0.732692    0.724444    3600        31.802120   0.294212    0.384170    132.820798 
[37m[36mINFO[0m[0m 02/16 21:50:39 | 0.664569    0.677037    0.916407    0.835872    0.486162    1.000000    0.992933    0.869176    0.757062    0.880046    0.757622    0.664569    0.677037    3800        33.568905   0.278946    0.364606    133.531971 
[37m[36mINFO[0m[0m 02/16 21:54:07 | 0.714550    0.702222    0.921716    0.845067    0.487513    1.000000    0.989399    0.866824    0.768362    0.898324    0.777439    0.714550    0.702222    4000        35.335689   0.287663    0.369717    134.407072 
[37m[36mINFO[0m[0m 02/16 21:57:32 | 0.753425    0.733333    0.915083    0.847983    0.541975    0.999117    0.985866    0.872941    0.760829    0.873191    0.797256    0.753425    0.733333    4200        37.102473   0.273572    0.383823    128.168733 
[37m[36mINFO[0m[0m 02/16 22:00:58 | 0.708997    0.712593    0.932165    0.841270    0.480124    1.000000    0.989399    0.889412    0.764595    0.907083    0.769817    0.708997    0.712593    4400        38.869258   0.264447    0.368536    132.032060 
[37m[36mINFO[0m[0m 02/16 22:04:25 | 0.704554    0.700741    0.938340    0.845156    0.472514    1.000000    0.989399    0.892706    0.745763    0.922315    0.800305    0.704554    0.700741    4600        40.636042   0.275582    0.378931    131.747299 
[37m[36mINFO[0m[0m 02/16 22:07:49 | 0.680859    0.677037    0.936254    0.839447    0.552873    0.999117    0.989399    0.896471    0.743879    0.913176    0.785061    0.680859    0.677037    4800        42.402827   0.240917    0.362279    131.023769 
[37m[36mINFO[0m[0m 02/16 22:11:17 | 0.718623    0.724444    0.932856    0.830933    0.579626    0.999117    0.982332    0.888941    0.726930    0.910510    0.783537    0.718623    0.724444    5000        44.169611   0.244858    0.378529    133.042056 
[37m[36mINFO[0m[0m 02/16 22:11:17 | Cumulative gradient change saved at train_output/VLCS/RSC/[3]/250216_20-41-44_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/16 22:11:19 | ---
[37m[36mINFO[0m[0m 02/16 22:11:19 | test-domain validation(oracle) = 78.045%
[37m[36mINFO[0m[0m 02/16 22:11:19 | training-domain validation(iid) = 77.490%
[37m[36mINFO[0m[0m 02/16 22:11:19 | last = 71.862%
[37m[36mINFO[0m[0m 02/16 22:11:19 | last (inD) = 83.093%
[37m[36mINFO[0m[0m 02/16 22:11:19 | training-domain validation (iid, inD) = 86.285%
[37m[36mINFO[0m[0m 02/16 22:11:19 | === Summary ===
[37m[36mINFO[0m[0m 02/16 22:11:19 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset VLCS --trial_seed 1 --hparams_seed 16
[37m[36mINFO[0m[0m 02/16 22:11:19 | Unique name: 250216_20-41-44_resnet50_GENIE
[37m[36mINFO[0m[0m 02/16 22:11:19 | Out path: train_output/VLCS/RSC/[3]/250216_20-41-44_resnet50_GENIE
[37m[36mINFO[0m[0m 02/16 22:11:19 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/16 22:11:19 | Dataset: VLCS

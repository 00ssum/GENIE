[37m[36mINFO[0m[0m 02/17 06:24:18 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset VLCS --trial_seed 2 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/VLCS/RSC/[3]/250217_06-24-18_resnet50_GENIE
	out_root: train_output/VLCS/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250217_06-24-18_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 3.1159521264763664e-05
	batch_size: 11
	weight_decay: 1.4650833494643601e-05
	rsc_f_drop_factor: 0.1230288403437661
	rsc_b_drop_factor: 0.041552181381268205
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 02/17 06:24:18 | n_steps = 5001
[37m[36mINFO[0m[0m 02/17 06:24:18 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/17 06:24:18 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/17 06:24:18 | 
[37m[36mINFO[0m[0m 02/17 06:24:18 | Testenv name escaping te_V -> te_V
[37m[36mINFO[0m[0m 02/17 06:24:18 | Test envs = [3], name = te_V
[37m[36mINFO[0m[0m 02/17 06:24:18 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/17 06:24:18 | Batch sizes for each domain: [11, 11, 11, 0] (total=33)
[37m[36mINFO[0m[0m 02/17 06:24:18 | steps-per-epoch for each domain: 102.91, 193.18, 238.73 -> min = 102.91
[37m[36mINFO[0m[0m 02/17 06:24:19 | # of params = 23518277
[37m[36mINFO[0m[0m 02/17 06:26:27 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/17 06:26:27 | 0.527212    0.548148    0.599967    0.628939    1.196566    0.674912    0.671378    0.513412    0.570621    0.611577    0.644817    0.527212    0.548148    0           0.000000    1.876784    0.892715    127.087478 
[37m[36mINFO[0m[0m 02/17 06:29:52 | 0.771196    0.768889    0.842034    0.841204    0.405843    0.998233    0.996466    0.712941    0.734463    0.814928    0.792683    0.771196    0.768889    200         1.943463    0.606484    0.385439    127.372170 
[37m[36mINFO[0m[0m 02/17 06:33:17 | 0.762310    0.777778    0.851044    0.832668    0.408812    1.000000    1.000000    0.759529    0.749529    0.793602    0.748476    0.762310    0.777778    400         3.886926    0.477639    0.379239    129.133384 
[37m[36mINFO[0m[0m 02/17 06:36:45 | 0.723066    0.728889    0.848522    0.847954    0.397710    0.986749    0.985866    0.745412    0.768362    0.813404    0.789634    0.723066    0.728889    600         5.830389    0.406832    0.406068    127.167377 
[37m[36mINFO[0m[0m 02/17 06:40:12 | 0.763421    0.757037    0.869109    0.858584    0.383535    1.000000    1.000000    0.782118    0.781544    0.825209    0.794207    0.763421    0.757037    800         7.773852    0.383807    0.378805    131.450777 
[37m[36mINFO[0m[0m 02/17 06:43:42 | 0.767494    0.764444    0.882319    0.864818    0.375063    1.000000    0.996466    0.788235    0.770245    0.858720    0.827744    0.767494    0.764444    1000        9.717314    0.362890    0.392743    131.468207 
[37m[36mINFO[0m[0m 02/17 06:47:09 | 0.751573    0.770370    0.878931    0.840116    0.394856    0.998233    0.992933    0.798118    0.743879    0.840442    0.783537    0.751573    0.770370    1200        11.660777   0.348678    0.399585    127.126404 
[37m[36mINFO[0m[0m 02/17 06:50:39 | 0.722695    0.718519    0.876882    0.843853    0.432667    1.000000    0.992933    0.782588    0.762712    0.848058    0.775915    0.722695    0.718519    1400        13.604240   0.304446    0.407275    128.720398 
[37m[36mINFO[0m[0m 02/17 06:54:10 | 0.751203    0.758519    0.898249    0.856287    0.384682    0.993816    0.992933    0.821647    0.766478    0.879284    0.809451    0.751203    0.758519    1600        15.547703   0.352720    0.409102    128.887406 
[37m[36mINFO[0m[0m 02/17 06:57:38 | 0.763421    0.782222    0.907174    0.862523    0.383435    1.000000    0.989399    0.835765    0.787194    0.885758    0.810976    0.763421    0.782222    1800        17.491166   0.296977    0.406830    126.922387 
[37m[36mINFO[0m[0m 02/17 07:01:11 | 0.742318    0.762963    0.893038    0.834306    0.456658    1.000000    0.989399    0.823059    0.758945    0.856055    0.754573    0.742318    0.762963    2000        19.434629   0.310501    0.403025    132.157613 
[37m[36mINFO[0m[0m 02/17 07:04:42 | 0.720104    0.737778    0.895434    0.840696    0.493666    0.999117    0.996466    0.783529    0.734463    0.903656    0.791159    0.720104    0.737778    2200        21.378092   0.280596    0.393451    131.797348 
[37m[36mINFO[0m[0m 02/17 07:08:08 | 0.758238    0.774815    0.910139    0.844959    0.415480    1.000000    0.992933    0.840471    0.772128    0.889947    0.769817    0.758238    0.774815    2400        23.321555   0.269173    0.389719    128.460004 
[37m[36mINFO[0m[0m 02/17 07:11:33 | 0.721955    0.712593    0.923594    0.853089    0.444069    0.999117    0.992933    0.863059    0.772128    0.908606    0.794207    0.721955    0.712593    2600        25.265018   0.251988    0.380557    128.939787 
[37m[36mINFO[0m[0m 02/17 07:14:58 | 0.733062    0.748148    0.906917    0.834275    0.454974    1.000000    0.989399    0.811765    0.734463    0.908987    0.778963    0.733062    0.748148    2800        27.208481   0.277734    0.386725    127.974335 
[37m[36mINFO[0m[0m 02/17 07:18:27 | 0.741577    0.736296    0.890491    0.834109    0.505814    0.997350    0.992933    0.834824    0.753296    0.839299    0.756098    0.741577    0.736296    3000        29.151943   0.223308    0.395124    129.321448 
[37m[36mINFO[0m[0m 02/17 07:21:53 | 0.767494    0.776296    0.933641    0.849861    0.440326    1.000000    0.992933    0.868706    0.753296    0.932216    0.803354    0.767494    0.776296    3200        31.095406   0.241591    0.381016    129.782460 
[37m[36mINFO[0m[0m 02/17 07:25:21 | 0.724917    0.742222    0.943739    0.858918    0.431078    1.000000    0.992933    0.891765    0.775895    0.939452    0.807927    0.724917    0.742222    3400        33.038869   0.211561    0.386690    130.420198 
[37m[36mINFO[0m[0m 02/17 07:28:50 | 0.696039    0.699259    0.928022    0.843948    0.471969    0.999117    0.985866    0.866824    0.753296    0.918126    0.792683    0.696039    0.699259    3600        34.982332   0.191866    0.397207    129.603420 
[37m[36mINFO[0m[0m 02/17 07:32:16 | 0.745280    0.743704    0.950139    0.858303    0.435869    1.000000    0.996466    0.902588    0.779661    0.947829    0.798780    0.745280    0.743704    3800        36.925795   0.199049    0.393930    127.557832 
[37m[36mINFO[0m[0m 02/17 07:35:45 | 0.723806    0.755556    0.948287    0.851326    0.573635    1.000000    0.992933    0.897412    0.768362    0.947449    0.792683    0.723806    0.755556    4000        38.869258   0.196680    0.406139    128.334917 
[37m[36mINFO[0m[0m 02/17 07:39:12 | 0.733432    0.736296    0.937986    0.841695    0.656360    1.000000    1.000000    0.869176    0.747646    0.944783    0.777439    0.733432    0.736296    4200        40.812721   0.188375    0.407433    124.718820 
[37m[36mINFO[0m[0m 02/17 07:42:38 | 0.648649    0.645926    0.925390    0.828847    0.508732    1.000000    0.992933    0.868706    0.734463    0.907464    0.759146    0.648649    0.645926    4400        42.756184   0.169272    0.397613    126.372861 
[37m[36mINFO[0m[0m 02/17 07:46:04 | 0.748612    0.776296    0.953738    0.845449    0.538870    1.000000    0.996466    0.899294    0.753296    0.961919    0.786585    0.748612    0.776296    4600        44.699647   0.176441    0.399186    126.775644 
[37m[36mINFO[0m[0m 02/17 07:49:32 | 0.716401    0.728889    0.954315    0.834987    0.610174    1.000000    0.996466    0.914353    0.732580    0.948591    0.775915    0.716401    0.728889    4800        46.643110   0.171740    0.396085    128.198050 
[37m[36mINFO[0m[0m 02/17 07:52:57 | 0.742318    0.757037    0.962850    0.848307    0.536763    1.000000    0.992933    0.922824    0.760829    0.965727    0.791159    0.742318    0.757037    5000        48.586572   0.146745    0.385453    128.746128 
[37m[36mINFO[0m[0m 02/17 07:52:58 | Cumulative gradient change saved at train_output/VLCS/RSC/[3]/250217_06-24-18_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/17 07:52:59 | ---
[37m[36mINFO[0m[0m 02/17 07:52:59 | test-domain validation(oracle) = 76.342%
[37m[36mINFO[0m[0m 02/17 07:52:59 | training-domain validation(iid) = 76.749%
[37m[36mINFO[0m[0m 02/17 07:52:59 | last = 74.232%
[37m[36mINFO[0m[0m 02/17 07:52:59 | last (inD) = 84.831%
[37m[36mINFO[0m[0m 02/17 07:52:59 | training-domain validation (iid, inD) = 86.482%
[37m[36mINFO[0m[0m 02/17 07:52:59 | === Summary ===
[37m[36mINFO[0m[0m 02/17 07:52:59 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset VLCS --trial_seed 2 --hparams_seed 1
[37m[36mINFO[0m[0m 02/17 07:52:59 | Unique name: 250217_06-24-18_resnet50_GENIE
[37m[36mINFO[0m[0m 02/17 07:52:59 | Out path: train_output/VLCS/RSC/[3]/250217_06-24-18_resnet50_GENIE
[37m[36mINFO[0m[0m 02/17 07:52:59 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/17 07:52:59 | Dataset: VLCS

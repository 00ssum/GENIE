[37m[36mINFO[0m[0m 02/11 07:21:54 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset VLCS --trial_seed 0 --hparams_seed 13
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 13
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/VLCS/RSC/[3]/250211_07-21-54_resnet50_GENIE
	out_root: train_output/VLCS/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250211_07-21-54_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.00014596629881421895
	batch_size: 9
	weight_decay: 0.0009399117661702502
	rsc_f_drop_factor: 0.07911276161410186
	rsc_b_drop_factor: 0.09127471665318299
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 02/11 07:21:54 | n_steps = 5001
[37m[36mINFO[0m[0m 02/11 07:21:54 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/11 07:21:54 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/11 07:21:54 | 
[37m[36mINFO[0m[0m 02/11 07:21:54 | Testenv name escaping te_V -> te_V
[37m[36mINFO[0m[0m 02/11 07:21:54 | Test envs = [3], name = te_V
[37m[36mINFO[0m[0m 02/11 07:21:54 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/11 07:21:54 | Batch sizes for each domain: [9, 9, 9, 0] (total=27)
[37m[36mINFO[0m[0m 02/11 07:21:54 | steps-per-epoch for each domain: 125.78, 236.11, 291.78 -> min = 125.78
[37m[36mINFO[0m[0m 02/11 07:21:55 | # of params = 23518277
[37m[36mINFO[0m[0m 02/11 07:24:15 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/11 07:24:15 | 0.436505    0.463704    0.538510    0.531496    1.259565    0.691696    0.671378    0.520941    0.508475    0.402894    0.414634    0.436505    0.463704    0           0.000000    1.968064    0.913324    138.576977 
[37m[36mINFO[0m[0m 02/11 07:27:42 | 0.727508    0.724444    0.832422    0.817788    0.477815    0.992933    0.992933    0.731294    0.736347    0.773039    0.724085    0.727508    0.724444    200         1.590106    0.659593    0.347753    138.153579 
[37m[36mINFO[0m[0m 02/11 07:31:10 | 0.796742    0.805926    0.841099    0.836016    0.434494    0.995583    1.000000    0.718118    0.738230    0.809596    0.769817    0.796742    0.805926    400         3.180212    0.453282    0.345743    138.228329 
[37m[36mINFO[0m[0m 02/11 07:34:39 | 0.759719    0.765926    0.840284    0.832160    0.446955    0.998233    1.000000    0.747294    0.749529    0.775324    0.746951    0.759719    0.765926    600         4.770318    0.398449    0.376394    134.583674 
[37m[36mINFO[0m[0m 02/11 07:38:11 | 0.789337    0.791111    0.859049    0.836344    0.403722    0.999117    1.000000    0.730353    0.719397    0.847677    0.789634    0.789337    0.791111    800         6.360424    0.382709    0.370319    137.041767 
[37m[36mINFO[0m[0m 02/11 07:41:39 | 0.810441    0.801481    0.870377    0.850423    0.397960    0.998233    1.000000    0.761412    0.757062    0.851485    0.794207    0.810441    0.801481    1000        7.950530    0.380433    0.354860    137.828028 
[37m[36mINFO[0m[0m 02/11 07:45:08 | 0.778601    0.789630    0.874840    0.858315    0.401666    0.999117    1.000000    0.783059    0.785311    0.842346    0.789634    0.778601    0.789630    1200        9.540636    0.348918    0.339363    140.967918 
[37m[36mINFO[0m[0m 02/11 07:48:41 | 0.765642    0.785185    0.876433    0.850722    0.431192    0.998233    1.000000    0.770824    0.745763    0.860244    0.806402    0.765642    0.785185    1400        11.130742   0.338940    0.356315    141.039826 
[37m[36mINFO[0m[0m 02/11 07:52:10 | 0.802666    0.797037    0.882584    0.856461    0.404877    0.999117    1.000000    0.791059    0.772128    0.857578    0.797256    0.802666    0.797037    1600        12.720848   0.349233    0.391203    131.480171 
[37m[36mINFO[0m[0m 02/11 07:55:54 | 0.771936    0.776296    0.882999    0.846866    0.401867    1.000000    1.000000    0.792941    0.757062    0.856055    0.783537    0.771936    0.776296    1800        14.310954   0.321713    0.389797    146.176313 
[37m[36mINFO[0m[0m 02/11 07:59:28 | 0.762680    0.768889    0.888161    0.852922    0.405125    0.998233    0.996466    0.807529    0.758945    0.858720    0.803354    0.762680    0.768889    2000        15.901060   0.300501    0.383605    137.085985 
[37m[36mINFO[0m[0m 02/11 08:03:06 | 0.755646    0.757037    0.901045    0.843470    0.464662    0.994700    0.985866    0.823059    0.745763    0.885377    0.798780    0.755646    0.757037    2200        17.491166   0.279404    0.365255    145.009837 
[37m[36mINFO[0m[0m 02/11 08:06:35 | 0.777860    0.785185    0.901205    0.846119    0.404091    1.000000    1.000000    0.811765    0.753296    0.891851    0.785061    0.777860    0.785185    2400        19.081272   0.278094    0.337506    141.596255 
[37m[36mINFO[0m[0m 02/11 08:10:06 | 0.683080    0.678519    0.887521    0.821495    0.507171    1.000000    0.992933    0.830118    0.762712    0.832445    0.708841    0.683080    0.678519    2600        20.671378   0.276568    0.360983    138.746714 
[37m[36mINFO[0m[0m 02/11 08:13:37 | 0.777860    0.774815    0.904635    0.855655    0.448099    0.998233    1.000000    0.823059    0.783427    0.892612    0.783537    0.777860    0.774815    2800        22.261484   0.286041    0.361770    138.135081 
[37m[36mINFO[0m[0m 02/11 08:17:10 | 0.771196    0.779259    0.915133    0.852306    0.439860    1.000000    1.000000    0.829176    0.762712    0.916222    0.794207    0.771196    0.779259    3000        23.851590   0.258648    0.371762    138.538719 
[37m[36mINFO[0m[0m 02/11 08:20:47 | 0.752314    0.752593    0.920386    0.863056    0.433178    1.000000    0.996466    0.857882    0.798493    0.903275    0.794207    0.752314    0.752593    3200        25.441696   0.259020    0.363307    144.880318 
[37m[36mINFO[0m[0m 02/11 08:24:18 | 0.773047    0.768889    0.919693    0.855613    0.426253    0.996466    0.996466    0.855529    0.785311    0.907083    0.785061    0.773047    0.768889    3400        27.031802   0.264136    0.374808    135.948458 
[37m[36mINFO[0m[0m 02/11 08:27:52 | 0.754165    0.748148    0.931606    0.858255    0.399737    0.999117    1.000000    0.867294    0.768362    0.928408    0.806402    0.754165    0.748148    3600        28.621908   0.257224    0.371201    139.301003 
[37m[36mINFO[0m[0m 02/11 08:31:26 | 0.754906    0.757037    0.906826    0.822762    0.466966    0.999117    0.996466    0.824941    0.740113    0.896420    0.731707    0.754906    0.757037    3800        30.212014   0.227705    0.383495    137.288648 
[37m[36mINFO[0m[0m 02/11 08:34:57 | 0.769345    0.771852    0.930494    0.844104    0.471560    1.000000    0.996466    0.845176    0.740113    0.946306    0.795732    0.769345    0.771852    4000        31.802120   0.215782    0.362658    138.544657 
[37m[36mINFO[0m[0m 02/11 08:38:23 | 0.785635    0.774815    0.928938    0.849468    0.482468    1.000000    1.000000    0.878588    0.806026    0.908225    0.742378    0.785635    0.774815    4200        33.392226   0.215580    0.342133    137.278778 
[37m[36mINFO[0m[0m 02/11 08:41:58 | 0.742318    0.736296    0.906653    0.823312    0.468132    1.000000    1.000000    0.847529    0.738230    0.872430    0.731707    0.742318    0.736296    4400        34.982332   0.208891    0.385404    138.159638 
[37m[36mINFO[0m[0m 02/11 08:45:33 | 0.760829    0.761481    0.944860    0.854943    0.495635    1.000000    0.992933    0.897412    0.785311    0.937167    0.786585    0.760829    0.761481    4600        36.572438   0.203329    0.376485    139.772333 
[37m[36mINFO[0m[0m 02/11 08:49:07 | 0.750463    0.737778    0.952850    0.847704    0.501347    1.000000    1.000000    0.907294    0.770245    0.951257    0.772866    0.750463    0.737778    4800        38.162544   0.170637    0.371519    140.214609 
[37m[36mINFO[0m[0m 02/11 08:52:38 | 0.685302    0.672593    0.920045    0.819360    0.487313    0.994700    0.989399    0.858353    0.715631    0.907083    0.753049    0.685302    0.672593    5000        39.752650   0.203259    0.357918    138.579743 
[37m[36mINFO[0m[0m 02/11 08:52:38 | Cumulative gradient change saved at train_output/VLCS/RSC/[3]/250211_07-21-54_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/11 08:52:39 | ---
[37m[36mINFO[0m[0m 02/11 08:52:39 | test-domain validation(oracle) = 79.674%
[37m[36mINFO[0m[0m 02/11 08:52:39 | training-domain validation(iid) = 75.231%
[37m[36mINFO[0m[0m 02/11 08:52:39 | last = 68.530%
[37m[36mINFO[0m[0m 02/11 08:52:39 | last (inD) = 81.936%
[37m[36mINFO[0m[0m 02/11 08:52:39 | training-domain validation (iid, inD) = 86.306%
[37m[36mINFO[0m[0m 02/11 08:52:39 | === Summary ===
[37m[36mINFO[0m[0m 02/11 08:52:39 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset VLCS --trial_seed 0 --hparams_seed 13
[37m[36mINFO[0m[0m 02/11 08:52:39 | Unique name: 250211_07-21-54_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 08:52:39 | Out path: train_output/VLCS/RSC/[3]/250211_07-21-54_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 08:52:39 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/11 08:52:39 | Dataset: VLCS

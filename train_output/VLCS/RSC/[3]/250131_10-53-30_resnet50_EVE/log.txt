[37m[36mINFO[0m[0m 01/31 10:53:30 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm RSC --test_envs 3 --dataset VLCS --trial_seed 0 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/VLCS/RSC/[3]/250131_10-53-30_resnet50_EVE
	out_root: train_output/VLCS/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250131_10-53-30_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: EVE
	freeze_bn: False
	pretrained: True
	lr: 5.0781288859686544e-05
	batch_size: 44
	weight_decay: 0.00046410133598234803
	rsc_f_drop_factor: 0.2665134852412123
	rsc_b_drop_factor: 0.28056710878365126
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 01/31 10:53:30 | n_steps = 5001
[37m[36mINFO[0m[0m 01/31 10:53:30 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/31 10:53:30 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/31 10:53:30 | Target test envs = [[3]]
[37m[36mINFO[0m[0m 01/31 10:53:30 | 
[37m[36mINFO[0m[0m 01/31 10:53:30 | Testenv name escaping te_V -> te_V
[37m[36mINFO[0m[0m 01/31 10:53:30 | Test envs = [3], name = te_V
[37m[36mINFO[0m[0m 01/31 10:53:30 | Batch sizes for each domain: [44, 44, 44, 0] (total=132)
[37m[36mINFO[0m[0m 01/31 10:53:30 | steps-per-epoch for each domain: 25.73, 48.30, 59.68 -> min = 25.73
[37m[36mINFO[0m[0m 01/31 10:53:32 | # of params = 23518277
[37m[36mINFO[0m[0m 01/31 10:56:00 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/31 10:56:00 | 0.452425    0.462222    0.477625    0.490727    1.287079    0.613958    0.628975    0.422118    0.433145    0.396801    0.410061    0.452425    0.462222    0           0.000000    2.856469    1.880460    146.529561 
[37m[36mINFO[0m[0m 01/31 11:04:15 | 0.703073    0.693333    0.815296    0.808681    0.507895    0.972615    0.961131    0.700235    0.711864    0.773039    0.753049    0.703073    0.693333    200         7.773852    0.960180    1.693715    156.052014 
[37m[36mINFO[0m[0m 01/31 11:12:40 | 0.704184    0.714074    0.833268    0.823408    0.457772    0.997350    0.992933    0.737412    0.760829    0.765042    0.716463    0.704184    0.714074    400         15.547703   0.699480    1.754637    153.464247 
[37m[36mINFO[0m[0m 01/31 11:20:49 | 0.757497    0.745185    0.865806    0.838586    0.456777    1.000000    1.000000    0.758118    0.730697    0.839299    0.785061    0.757497    0.745185    600         23.321555   0.606034    1.735583    141.677571 
[37m[36mINFO[0m[0m 01/31 11:28:54 | 0.753425    0.752593    0.870719    0.844147    0.429700    0.999117    1.000000    0.782118    0.770245    0.830922    0.762195    0.753425    0.752593    800         31.095406   0.606580    1.710047    142.194528 
[37m[36mINFO[0m[0m 01/31 11:37:06 | 0.752684    0.762963    0.887235    0.853234    0.448919    1.000000    1.000000    0.813647    0.785311    0.848058    0.774390    0.752684    0.762963    1000        38.869258   0.523240    1.718152    148.221303 
[37m[36mINFO[0m[0m 01/31 11:45:13 | 0.766383    0.746667    0.894290    0.847584    0.493788    1.000000    1.000000    0.802824    0.768362    0.880046    0.774390    0.766383    0.746667    1200        46.643110   0.485021    1.649405    156.289359 
[37m[36mINFO[0m[0m 01/31 11:53:05 | 0.718252    0.733333    0.875171    0.829697    0.508359    0.997350    0.996466    0.791529    0.753296    0.836634    0.739329    0.718252    0.733333    1400        54.416961   0.562075    1.649382    142.432912 
[37m[36mINFO[0m[0m 01/31 12:01:15 | 0.777860    0.776296    0.900394    0.856851    0.582565    1.000000    1.000000    0.832941    0.802260    0.868241    0.768293    0.777860    0.776296    1600        62.190813   0.465637    1.701453    150.287728 
[37m[36mINFO[0m[0m 01/31 12:09:24 | 0.732692    0.739259    0.921295    0.845103    0.753297    1.000000    1.000000    0.844235    0.753296    0.919650    0.782012    0.732692    0.739259    1800        69.964664   0.398913    1.720422    143.846476 
[37m[36mINFO[0m[0m 01/31 12:17:21 | 0.743428    0.734815    0.923121    0.844882    0.665483    1.000000    0.996466    0.872941    0.768362    0.896420    0.769817    0.743428    0.734815    2000        77.738516   0.347515    1.657555    146.081301 
[37m[36mINFO[0m[0m 01/31 12:25:36 | 0.712329    0.706667    0.943685    0.848289    0.901936    0.999117    0.996466    0.903529    0.774011    0.928408    0.774390    0.712329    0.706667    2200        85.512367   0.336292    1.724761    149.369560 
[37m[36mINFO[0m[0m 01/31 12:33:33 | 0.749722    0.745185    0.932364    0.847781    0.924724    1.000000    0.996466    0.870588    0.774011    0.926504    0.772866    0.749722    0.745185    2400        93.286219   0.265521    1.653376    146.403775 
[37m[36mINFO[0m[0m 01/31 12:41:38 | 0.734543    0.746667    0.961336    0.840649    1.461994    1.000000    1.000000    0.936941    0.755179    0.947068    0.766768    0.734543    0.746667    2600        101.060071  0.275410    1.717860    141.969934 
[37m[36mINFO[0m[0m 01/31 12:49:50 | 0.707886    0.705185    0.931552    0.840727    0.981135    1.000000    0.996466    0.883765    0.758945    0.910891    0.766768    0.707886    0.705185    2800        108.833922  0.267405    1.740774    143.630280 
[37m[36mINFO[0m[0m 01/31 12:57:58 | 0.742318    0.740741    0.965974    0.843507    0.991331    1.000000    0.996466    0.944000    0.762712    0.953922    0.771341    0.742318    0.740741    3000        116.607774  0.252909    1.680424    151.302953 
[37m[36mINFO[0m[0m 01/31 13:05:58 | 0.700111    0.722963    0.970156    0.842509    1.147398    1.000000    0.992933    0.945882    0.781544    0.964585    0.753049    0.700111    0.722963    3200        124.381625  0.225939    1.650566    149.887289 
[37m[36mINFO[0m[0m 01/31 13:14:13 | 0.734913    0.728889    0.977034    0.832656    1.111696    1.000000    0.996466    0.956235    0.743879    0.974867    0.757622    0.734913    0.728889    3400        132.155477  0.224645    1.728341    149.603844 
[37m[36mINFO[0m[0m 01/31 13:22:18 | 0.712699    0.712593    0.974077    0.837170    1.015108    1.000000    0.996466    0.957647    0.758945    0.964585    0.756098    0.712699    0.712593    3600        139.929329  0.200712    1.720394    140.582795 
[37m[36mINFO[0m[0m 01/31 13:30:21 | 0.723436    0.717037    0.980903    0.830516    1.393140    1.000000    1.000000    0.965176    0.747646    0.977532    0.743902    0.723436    0.717037    3800        147.703180  0.177789    1.705135    142.242065 
[37m[36mINFO[0m[0m 01/31 13:38:23 | 0.722325    0.730370    0.944663    0.809502    0.936520    1.000000    1.000000    0.882353    0.696798    0.951637    0.731707    0.722325    0.730370    4000        155.477032  0.221012    1.680479    145.611394 
[37m[36mINFO[0m[0m 01/31 13:46:21 | 0.720104    0.711111    0.981546    0.844266    2.378339    1.000000    1.000000    0.971294    0.772128    0.973343    0.760671    0.720104    0.711111    4200        163.250883  0.157705    1.676270    143.602540 
[37m[36mINFO[0m[0m 01/31 13:54:36 | 0.714920    0.714074    0.980686    0.835005    1.657769    1.000000    0.992933    0.963765    0.751412    0.978294    0.760671    0.714920    0.714074    4400        171.024735  0.162094    1.766063    141.313047 
[37m[36mINFO[0m[0m 01/31 14:03:02 | 0.749722    0.749630    0.988207    0.841575    2.108952    1.000000    1.000000    0.980235    0.745763    0.984387    0.778963    0.749722    0.749630    4600        178.798587  0.127740    1.771208    151.527988 
[37m[36mINFO[0m[0m 01/31 14:11:16 | 0.761570    0.752593    0.978242    0.835795    1.623007    0.999117    0.996466    0.969882    0.753296    0.965727    0.757622    0.761570    0.752593    4800        186.572438  0.153884    1.730917    148.231175 
[37m[36mINFO[0m[0m 01/31 14:19:25 | 0.747501    0.742222    0.988169    0.846705    1.786013    1.000000    0.996466    0.973647    0.757062    0.990861    0.786585    0.747501    0.742222    5000        194.346290  0.144912    1.727075    143.198528 
[37m[36mINFO[0m[0m 01/31 14:19:25 | Cumulative gradient change saved at train_output/VLCS/RSC/[3]/250131_10-53-30_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/31 14:19:26 | ---
[37m[36mINFO[0m[0m 01/31 14:19:26 | test-domain validation(oracle) = 77.786%
[37m[36mINFO[0m[0m 01/31 14:19:26 | training-domain validation(iid) = 77.786%
[37m[36mINFO[0m[0m 01/31 14:19:26 | last = 74.750%
[37m[36mINFO[0m[0m 01/31 14:19:26 | last (inD) = 84.670%
[37m[36mINFO[0m[0m 01/31 14:19:26 | training-domain validation (iid, inD) = 85.685%
[37m[36mINFO[0m[0m 01/31 14:19:26 | === Summary ===
[37m[36mINFO[0m[0m 01/31 14:19:26 | Command: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm RSC --test_envs 3 --dataset VLCS --trial_seed 0 --hparams_seed 1
[37m[36mINFO[0m[0m 01/31 14:19:26 | Unique name: 250131_10-53-30_resnet50_EVE
[37m[36mINFO[0m[0m 01/31 14:19:26 | Out path: train_output/VLCS/RSC/[3]/250131_10-53-30_resnet50_EVE
[37m[36mINFO[0m[0m 01/31 14:19:26 | Algorithm: RSC
[37m[36mINFO[0m[0m 01/31 14:19:26 | Dataset: VLCS
[37m[36mINFO[0m[0m 01/31 14:19:26 | Max test_in: 0.7779

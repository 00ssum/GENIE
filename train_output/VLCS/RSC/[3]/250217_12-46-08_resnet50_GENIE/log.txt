[37m[36mINFO[0m[0m 02/17 12:46:08 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset VLCS --trial_seed 2 --hparams_seed 5
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 5
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/VLCS/RSC/[3]/250217_12-46-08_resnet50_GENIE
	out_root: train_output/VLCS/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250217_12-46-08_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.0002982828768978312
	batch_size: 9
	weight_decay: 0.0003180957897867641
	rsc_f_drop_factor: 0.22729325817372148
	rsc_b_drop_factor: 0.134901679846891
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 02/17 12:46:08 | n_steps = 5001
[37m[36mINFO[0m[0m 02/17 12:46:08 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/17 12:46:08 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/17 12:46:08 | 
[37m[36mINFO[0m[0m 02/17 12:46:08 | Testenv name escaping te_V -> te_V
[37m[36mINFO[0m[0m 02/17 12:46:08 | Test envs = [3], name = te_V
[37m[36mINFO[0m[0m 02/17 12:46:08 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/17 12:46:08 | Batch sizes for each domain: [9, 9, 9, 0] (total=27)
[37m[36mINFO[0m[0m 02/17 12:46:08 | steps-per-epoch for each domain: 125.78, 236.11, 291.78 -> min = 125.78
[37m[36mINFO[0m[0m 02/17 12:46:09 | # of params = 23518277
[37m[36mINFO[0m[0m 02/17 12:48:20 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/17 12:48:20 | 0.509811    0.531852    0.546541    0.540070    1.248908    0.634276    0.618375    0.453176    0.457627    0.552171    0.544207    0.509811    0.531852    0           0.000000    2.206265    1.241130    129.974957 
[37m[36mINFO[0m[0m 02/17 12:51:38 | 0.750463    0.748148    0.836781    0.834987    0.449319    0.999117    0.996466    0.719529    0.732580    0.791698    0.775915    0.750463    0.748148    200         1.590106    0.787930    0.326621    131.985079 
[37m[36mINFO[0m[0m 02/17 12:55:03 | 0.734543    0.730370    0.833315    0.838288    0.412811    1.000000    1.000000    0.740235    0.774011    0.759711    0.740854    0.734543    0.730370    400         3.180212    0.587129    0.351280    135.255687 
[37m[36mINFO[0m[0m 02/17 12:58:27 | 0.684191    0.665185    0.818192    0.812048    0.485615    0.995583    0.992933    0.667294    0.677966    0.791698    0.765244    0.684191    0.665185    600         4.770318    0.507407    0.349135    133.698131 
[37m[36mINFO[0m[0m 02/17 13:01:52 | 0.773417    0.771852    0.842055    0.827712    0.453960    0.999117    0.992933    0.734588    0.732580    0.792460    0.757622    0.773417    0.771852    800         6.360424    0.493064    0.365498    132.392334 
[37m[36mINFO[0m[0m 02/17 13:05:14 | 0.703073    0.694815    0.858878    0.849753    0.405271    0.996466    0.996466    0.751529    0.757062    0.828637    0.795732    0.703073    0.694815    1000        7.950530    0.461905    0.352662    131.339233 
[37m[36mINFO[0m[0m 02/17 13:08:33 | 0.723806    0.712593    0.864595    0.830731    0.449255    0.999117    0.992933    0.773647    0.740113    0.821021    0.759146    0.723806    0.712593    1200        9.540636    0.436542    0.337270    131.051138 
[37m[36mINFO[0m[0m 02/17 13:11:52 | 0.773787    0.797037    0.878915    0.852205    0.395884    1.000000    0.996466    0.798588    0.779661    0.838157    0.780488    0.773787    0.797037    1400        11.130742   0.409743    0.333954    132.708825 
[37m[36mINFO[0m[0m 02/17 13:15:14 | 0.784154    0.794074    0.881134    0.848128    0.421853    0.998233    0.992933    0.802824    0.774011    0.842346    0.777439    0.784154    0.794074    1600        12.720848   0.395764    0.330624    135.330438 
[37m[36mINFO[0m[0m 02/17 13:18:28 | 0.756757    0.774815    0.881377    0.832973    0.439508    0.999117    0.992933    0.808000    0.751412    0.837014    0.754573    0.756757    0.774815    1800        14.310954   0.390666    0.329625    128.356190 
[37m[36mINFO[0m[0m 02/17 13:21:46 | 0.742688    0.736296    0.883662    0.839757    0.420690    1.000000    0.992933    0.785412    0.738230    0.865575    0.788110    0.742688    0.736296    2000        15.901060   0.399782    0.338057    130.084911 
[37m[36mINFO[0m[0m 02/17 13:25:07 | 0.702703    0.702222    0.865127    0.823378    0.475685    0.999117    0.992933    0.792000    0.736347    0.804265    0.740854    0.702703    0.702222    2200        17.491166   0.367716    0.340156    133.163885 
[37m[36mINFO[0m[0m 02/17 13:28:32 | 0.726768    0.728889    0.901729    0.841850    0.497816    1.000000    0.992933    0.824000    0.755179    0.881188    0.777439    0.726768    0.728889    2400        19.081272   0.324262    0.353811    134.228404 
[37m[36mINFO[0m[0m 02/17 13:32:00 | 0.677157    0.675556    0.887722    0.837349    0.485636    1.000000    0.996466    0.827294    0.745763    0.835872    0.769817    0.677157    0.675556    2600        20.671378   0.370378    0.368723    134.535551 
[37m[36mINFO[0m[0m 02/17 13:35:23 | 0.778601    0.776296    0.909367    0.848755    0.483851    0.999117    0.992933    0.840941    0.775895    0.888043    0.777439    0.778601    0.776296    2800        22.261484   0.335864    0.351293    132.690880 
[37m[36mINFO[0m[0m 02/17 13:38:43 | 0.764532    0.758519    0.904387    0.840350    0.415256    0.998233    1.000000    0.813176    0.734463    0.901752    0.786585    0.764532    0.758519    3000        23.851590   0.347947    0.335983    133.317144 
[37m[36mINFO[0m[0m 02/17 13:41:58 | 0.661237    0.665185    0.866630    0.819603    0.482142    0.961131    0.946996    0.797176    0.741996    0.841584    0.769817    0.661237    0.665185    3200        25.441696   0.313897    0.329880    128.828871 
[37m[36mINFO[0m[0m 02/17 13:45:15 | 0.757867    0.746667    0.882915    0.821052    0.586601    0.997350    0.985866    0.799529    0.728814    0.851866    0.748476    0.757867    0.746667    3400        27.031802   0.332845    0.331795    129.961516 
[37m[36mINFO[0m[0m 02/17 13:48:33 | 0.614587    0.607407    0.804260    0.770491    0.647245    0.916078    0.911661    0.749176    0.706215    0.747525    0.693598    0.614587    0.607407    3600        28.621908   0.355854    0.324722    133.375714 
[37m[36mINFO[0m[0m 02/17 13:51:50 | 0.694187    0.693333    0.890443    0.838443    0.468064    0.997350    0.992933    0.814118    0.749529    0.859863    0.772866    0.694187    0.693333    3800        30.212014   0.452386    0.329364    130.817525 
[37m[36mINFO[0m[0m 02/17 13:55:09 | 0.697519    0.671111    0.900072    0.839501    0.477121    1.000000    0.996466    0.825882    0.747646    0.874334    0.774390    0.697519    0.671111    4000        31.802120   0.332145    0.346453    129.921147 
[37m[36mINFO[0m[0m 02/17 13:58:26 | 0.735283    0.712593    0.920101    0.851756    0.450655    1.000000    0.996466    0.849412    0.764595    0.910891    0.794207    0.735283    0.712593    4200        33.392226   0.316497    0.349864    126.848568 
[37m[36mINFO[0m[0m 02/17 14:01:45 | 0.764161    0.745185    0.924327    0.851565    0.472729    0.999117    0.992933    0.870588    0.772128    0.903275    0.789634    0.764161    0.745185    4400        34.982332   0.293519    0.349720    129.649059 
[37m[36mINFO[0m[0m 02/17 14:05:07 | 0.734543    0.718519    0.925886    0.847524    0.452000    0.999117    1.000000    0.861176    0.751412    0.917365    0.791159    0.734543    0.718519    4600        36.572438   0.311352    0.340522    133.477392 
[37m[36mINFO[0m[0m 02/17 14:08:23 | 0.713069    0.727407    0.924455    0.836949    0.503887    0.999117    0.992933    0.878588    0.774011    0.895659    0.743902    0.713069    0.727407    4800        38.162544   0.265710    0.329281    130.669341 
[37m[36mINFO[0m[0m 02/17 14:11:40 | 0.725287    0.728889    0.926165    0.839638    0.578855    1.000000    0.992933    0.856941    0.736347    0.921554    0.789634    0.725287    0.728889    5000        39.752650   0.298867    0.342287    127.763299 
[37m[36mINFO[0m[0m 02/17 14:11:40 | Cumulative gradient change saved at train_output/VLCS/RSC/[3]/250217_12-46-08_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/17 14:11:41 | ---
[37m[36mINFO[0m[0m 02/17 14:11:41 | test-domain validation(oracle) = 77.379%
[37m[36mINFO[0m[0m 02/17 14:11:41 | training-domain validation(iid) = 77.379%
[37m[36mINFO[0m[0m 02/17 14:11:41 | last = 72.529%
[37m[36mINFO[0m[0m 02/17 14:11:41 | last (inD) = 83.964%
[37m[36mINFO[0m[0m 02/17 14:11:41 | training-domain validation (iid, inD) = 85.221%
[37m[36mINFO[0m[0m 02/17 14:11:41 | === Summary ===
[37m[36mINFO[0m[0m 02/17 14:11:41 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset VLCS --trial_seed 2 --hparams_seed 5
[37m[36mINFO[0m[0m 02/17 14:11:41 | Unique name: 250217_12-46-08_resnet50_GENIE
[37m[36mINFO[0m[0m 02/17 14:11:41 | Out path: train_output/VLCS/RSC/[3]/250217_12-46-08_resnet50_GENIE
[37m[36mINFO[0m[0m 02/17 14:11:41 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/17 14:11:41 | Dataset: VLCS

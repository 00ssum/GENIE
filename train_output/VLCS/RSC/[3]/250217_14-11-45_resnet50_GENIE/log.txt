[37m[36mINFO[0m[0m 02/17 14:11:45 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset VLCS --trial_seed 2 --hparams_seed 6
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 6
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/VLCS/RSC/[3]/250217_14-11-45_resnet50_GENIE
	out_root: train_output/VLCS/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250217_14-11-45_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.00020671063342821416
	batch_size: 9
	weight_decay: 0.00021810605040355685
	rsc_f_drop_factor: 0.46042234920023606
	rsc_b_drop_factor: 0.4947336818366218
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 02/17 14:11:45 | n_steps = 5001
[37m[36mINFO[0m[0m 02/17 14:11:45 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/17 14:11:45 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/17 14:11:45 | 
[37m[36mINFO[0m[0m 02/17 14:11:45 | Testenv name escaping te_V -> te_V
[37m[36mINFO[0m[0m 02/17 14:11:45 | Test envs = [3], name = te_V
[37m[36mINFO[0m[0m 02/17 14:11:45 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/17 14:11:45 | Batch sizes for each domain: [9, 9, 9, 0] (total=27)
[37m[36mINFO[0m[0m 02/17 14:11:45 | steps-per-epoch for each domain: 125.78, 236.11, 291.78 -> min = 125.78
[37m[36mINFO[0m[0m 02/17 14:11:46 | # of params = 23518277
[37m[36mINFO[0m[0m 02/17 14:13:54 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/17 14:13:54 | 0.410959    0.454815    0.412477    0.439393    1.428312    0.416078    0.399293    0.343059    0.414313    0.478294    0.504573    0.410959    0.454815    0           0.000000    3.818088    0.985522    127.351133 
[37m[36mINFO[0m[0m 02/17 14:17:07 | 0.506109    0.512593    0.611546    0.607657    0.919769    0.795936    0.749117    0.574118    0.619586    0.464585    0.454268    0.506109    0.512593    200         1.590106    1.394807    0.311651    130.609143 
[37m[36mINFO[0m[0m 02/17 14:20:23 | 0.543502    0.551111    0.655283    0.639541    0.700160    0.889576    0.869258    0.527529    0.531073    0.548743    0.518293    0.543502    0.551111    400         3.180212    1.208666    0.318125    132.691610 
[37m[36mINFO[0m[0m 02/17 14:23:36 | 0.677527    0.656296    0.794332    0.788941    0.590728    0.974382    0.957597    0.668706    0.683616    0.739909    0.725610    0.677527    0.656296    600         4.770318    1.124919    0.317736    129.326703 
[37m[36mINFO[0m[0m 02/17 14:26:48 | 0.537949    0.542222    0.646531    0.629236    0.644411    0.874558    0.862191    0.602353    0.581921    0.462681    0.443598    0.537949    0.542222    800         6.360424    1.059893    0.313112    129.290083 
[37m[36mINFO[0m[0m 02/17 14:30:05 | 0.662718    0.637037    0.796244    0.781738    0.609776    0.973498    0.957597    0.697412    0.706215    0.717822    0.681402    0.662718    0.637037    1000        7.950530    1.014860    0.320774    132.277362 
[37m[36mINFO[0m[0m 02/17 14:33:17 | 0.650130    0.632593    0.758309    0.751022    0.629030    0.959364    0.943463    0.672000    0.696798    0.643564    0.612805    0.650130    0.632593    1200        9.540636    0.999096    0.319924    128.696054 
[37m[36mINFO[0m[0m 02/17 14:36:28 | 0.696409    0.681481    0.817190    0.817059    0.559666    0.983216    0.971731    0.722353    0.772128    0.746002    0.707317    0.696409    0.681481    1400        11.130742   0.977421    0.319600    127.020777 
[37m[36mINFO[0m[0m 02/17 14:39:37 | 0.686042    0.691852    0.771111    0.770089    0.618795    0.968198    0.968198    0.733176    0.755179    0.611957    0.586890    0.686042    0.691852    1600        12.720848   0.981357    0.311374    126.570840 
[37m[36mINFO[0m[0m 02/17 14:42:48 | 0.676786    0.665185    0.833037    0.814014    0.565899    0.988516    0.964664    0.708235    0.721281    0.802361    0.756098    0.676786    0.665185    1800        14.310954   0.951844    0.307383    128.916288 
[37m[36mINFO[0m[0m 02/17 14:46:01 | 0.599408    0.580741    0.759930    0.728150    0.622581    0.962014    0.932862    0.711529    0.704331    0.606245    0.547256    0.599408    0.580741    2000        15.901060   0.949098    0.326954    127.905397 
[37m[36mINFO[0m[0m 02/17 14:49:14 | 0.711588    0.702222    0.855447    0.839931    0.552534    0.995583    0.982332    0.750118    0.764595    0.820640    0.772866    0.711588    0.702222    2200        17.491166   0.924515    0.323662    128.525421 
[37m[36mINFO[0m[0m 02/17 14:52:31 | 0.701592    0.712593    0.837301    0.819312    0.638366    0.989399    0.975265    0.740706    0.757062    0.781797    0.725610    0.701592    0.712593    2400        19.081272   0.897886    0.326105    131.771659 
[37m[36mINFO[0m[0m 02/17 14:55:48 | 0.614587    0.598519    0.730581    0.708120    0.614884    0.896643    0.862191    0.696471    0.711864    0.598629    0.550305    0.614587    0.598519    2600        20.671378   0.937645    0.326443    131.110855 
[37m[36mINFO[0m[0m 02/17 14:59:08 | 0.710848    0.715556    0.839388    0.820430    0.556771    0.997350    0.978799    0.713882    0.740113    0.806931    0.742378    0.710848    0.715556    2800        22.261484   0.896871    0.327781    134.437723 
[37m[36mINFO[0m[0m 02/17 15:02:24 | 0.701222    0.717037    0.828666    0.807052    0.570942    0.992049    0.982332    0.756706    0.758945    0.737243    0.679878    0.701222    0.717037    3000        23.851590   0.877283    0.328748    130.345517 
[37m[36mINFO[0m[0m 02/17 15:05:38 | 0.653832    0.648889    0.858028    0.829696    0.601883    0.992933    0.978799    0.748706    0.741996    0.832445    0.768293    0.653832    0.648889    3200        25.441696   0.848931    0.333512    127.401781 
[37m[36mINFO[0m[0m 02/17 15:08:54 | 0.690485    0.688889    0.846171    0.816716    0.565558    0.987633    0.968198    0.731765    0.721281    0.819117    0.760671    0.690485    0.688889    3400        27.031802   0.866139    0.327614    130.784456 
[37m[36mINFO[0m[0m 02/17 15:12:11 | 0.723806    0.720000    0.863295    0.841146    0.554742    0.999117    0.996466    0.773176    0.781544    0.817593    0.745427    0.723806    0.720000    3600        28.621908   0.857989    0.321399    132.262671 
[37m[36mINFO[0m[0m 02/17 15:15:24 | 0.716031    0.724444    0.854306    0.824113    0.543660    0.992049    0.989399    0.748706    0.734463    0.822163    0.748476    0.716031    0.724444    3800        30.212014   0.845724    0.324196    128.416039 
[37m[36mINFO[0m[0m 02/17 15:18:37 | 0.651981    0.632593    0.860416    0.829057    0.530797    1.000000    0.992933    0.765176    0.745763    0.816070    0.748476    0.651981    0.632593    4000        31.802120   0.843646    0.323061    128.724441 
[37m[36mINFO[0m[0m 02/17 15:21:50 | 0.665679    0.642963    0.853942    0.818595    0.550531    0.992049    0.975265    0.760941    0.745763    0.808835    0.734756    0.665679    0.642963    4200        33.392226   0.813156    0.323010    127.675918 
[37m[36mINFO[0m[0m 02/17 15:25:00 | 0.715291    0.724444    0.854597    0.825649    0.623122    0.998233    0.992933    0.746824    0.740113    0.818736    0.743902    0.715291    0.724444    4400        34.982332   0.821997    0.322829    126.387853 
[37m[36mINFO[0m[0m 02/17 15:28:15 | 0.661977    0.657778    0.846464    0.804873    0.544110    0.978799    0.975265    0.706824    0.681733    0.853770    0.757622    0.661977    0.657778    4600        36.572438   0.809771    0.321795    130.121659 
[37m[36mINFO[0m[0m 02/17 15:31:41 | 0.724917    0.722963    0.847913    0.801707    0.656066    0.986749    0.975265    0.771765    0.743879    0.785225    0.685976    0.724917    0.722963    4800        38.162544   0.820372    0.336802    138.283508 
[37m[36mINFO[0m[0m 02/17 15:35:14 | 0.705294    0.703704    0.865753    0.825309    0.625567    0.994700    0.989399    0.791059    0.753296    0.811500    0.733232    0.705294    0.703704    5000        39.752650   0.815550    0.357643    142.315803 
[37m[36mINFO[0m[0m 02/17 15:35:15 | Cumulative gradient change saved at train_output/VLCS/RSC/[3]/250217_14-11-45_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/17 15:35:16 | ---
[37m[36mINFO[0m[0m 02/17 15:35:16 | test-domain validation(oracle) = 71.603%
[37m[36mINFO[0m[0m 02/17 15:35:16 | training-domain validation(iid) = 72.381%
[37m[36mINFO[0m[0m 02/17 15:35:16 | last = 70.529%
[37m[36mINFO[0m[0m 02/17 15:35:16 | last (inD) = 82.531%
[37m[36mINFO[0m[0m 02/17 15:35:16 | training-domain validation (iid, inD) = 84.115%
[37m[36mINFO[0m[0m 02/17 15:35:16 | === Summary ===
[37m[36mINFO[0m[0m 02/17 15:35:16 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset VLCS --trial_seed 2 --hparams_seed 6
[37m[36mINFO[0m[0m 02/17 15:35:16 | Unique name: 250217_14-11-45_resnet50_GENIE
[37m[36mINFO[0m[0m 02/17 15:35:16 | Out path: train_output/VLCS/RSC/[3]/250217_14-11-45_resnet50_GENIE
[37m[36mINFO[0m[0m 02/17 15:35:16 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/17 15:35:16 | Dataset: VLCS

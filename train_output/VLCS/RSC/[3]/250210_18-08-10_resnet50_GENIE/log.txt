[37m[36mINFO[0m[0m 02/10 18:08:10 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset VLCS --trial_seed 0 --hparams_seed 6
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 6
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/VLCS/RSC/[3]/250210_18-08-10_resnet50_GENIE
	out_root: train_output/VLCS/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250210_18-08-10_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.5764387170443743e-05
	batch_size: 19
	weight_decay: 0.0006024239579587198
	rsc_f_drop_factor: 0.19876770246536363
	rsc_b_drop_factor: 0.08199629172100226
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 02/10 18:08:10 | n_steps = 5001
[37m[36mINFO[0m[0m 02/10 18:08:10 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/10 18:08:10 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/10 18:08:10 | 
[37m[36mINFO[0m[0m 02/10 18:08:10 | Testenv name escaping te_V -> te_V
[37m[36mINFO[0m[0m 02/10 18:08:10 | Test envs = [3], name = te_V
[37m[36mINFO[0m[0m 02/10 18:08:10 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/10 18:08:10 | Batch sizes for each domain: [19, 19, 19, 0] (total=57)
[37m[36mINFO[0m[0m 02/10 18:08:10 | steps-per-epoch for each domain: 59.58, 111.84, 138.21 -> min = 59.58
[37m[36mINFO[0m[0m 02/10 18:08:11 | # of params = 23518277
[37m[36mINFO[0m[0m 02/10 18:10:33 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/10 18:10:33 | 0.466494    0.468148    0.503129    0.512591    1.239021    0.616608    0.632509    0.497882    0.502825    0.394897    0.402439    0.466494    0.468148    0           0.000000    2.102313    1.221787    140.147878 
[37m[36mINFO[0m[0m 02/10 18:15:24 | 0.667160    0.663704    0.835467    0.833176    0.437794    1.000000    1.000000    0.750118    0.749529    0.756283    0.750000    0.667160    0.663704    200         3.356890    0.643268    0.744630    142.423389 
[37m[36mINFO[0m[0m 02/10 18:20:20 | 0.798223    0.804444    0.868576    0.859092    0.394374    0.997350    1.000000    0.773647    0.781544    0.834730    0.795732    0.798223    0.804444    400         6.713781    0.438662    0.723603    150.863950 
[37m[36mINFO[0m[0m 02/10 18:25:05 | 0.800444    0.797037    0.874792    0.852576    0.406704    1.000000    1.000000    0.789647    0.790960    0.834730    0.766768    0.800444    0.797037    600         10.070671   0.389198    0.708360    143.670366 
[37m[36mINFO[0m[0m 02/10 18:29:47 | 0.758978    0.770370    0.883566    0.847841    0.386608    1.000000    0.996466    0.793882    0.758945    0.856816    0.788110    0.758978    0.770370    800         13.427562   0.357405    0.717224    138.678216 
[37m[36mINFO[0m[0m 02/10 18:34:34 | 0.788597    0.788148    0.900535    0.859749    0.380056    1.000000    1.000000    0.829176    0.775895    0.872430    0.803354    0.788597    0.788148    1000        16.784452   0.324868    0.731095    140.986505 
[37m[36mINFO[0m[0m 02/10 18:39:21 | 0.769345    0.757037    0.908010    0.858691    0.404766    1.000000    0.996466    0.832941    0.777778    0.891089    0.801829    0.769345    0.757037    1200        20.141343   0.295837    0.743263    138.148799 
[37m[36mINFO[0m[0m 02/10 18:44:15 | 0.757127    0.786667    0.911028    0.856539    0.427213    1.000000    0.996466    0.840471    0.775895    0.892612    0.797256    0.757127    0.786667    1400        23.498233   0.285893    0.762130    141.602790 
[37m[36mINFO[0m[0m 02/10 18:49:06 | 0.741577    0.752593    0.900846    0.840111    0.466688    0.999117    1.000000    0.828706    0.762712    0.874714    0.757622    0.741577    0.752593    1600        26.855124   0.261723    0.734752    143.862427 
[37m[36mINFO[0m[0m 02/10 18:53:58 | 0.741207    0.755556    0.924269    0.854776    0.427592    1.000000    0.996466    0.863059    0.804143    0.909749    0.763720    0.741207    0.755556    1800        30.212014   0.237595    0.727732    146.342871 
[37m[36mINFO[0m[0m 02/10 18:58:47 | 0.780081    0.779259    0.928545    0.856133    0.515105    0.999117    1.000000    0.871059    0.790960    0.915461    0.777439    0.780081    0.779259    2000        33.568905   0.236934    0.739672    140.825518 
[37m[36mINFO[0m[0m 02/10 19:03:38 | 0.737875    0.693333    0.906005    0.831639    0.461016    1.000000    0.996466    0.801412    0.711864    0.916603    0.786585    0.737875    0.693333    2200        36.925795   0.236254    0.748621    141.070106 
[37m[36mINFO[0m[0m 02/10 19:08:31 | 0.742318    0.746667    0.947863    0.841892    0.505703    1.000000    0.996466    0.908706    0.753296    0.934882    0.775915    0.742318    0.746667    2400        40.282686   0.212399    0.763102    140.766378 
[37m[36mINFO[0m[0m 02/10 19:13:30 | 0.772677    0.773333    0.956084    0.847733    0.513746    1.000000    1.000000    0.908235    0.762712    0.960015    0.780488    0.772677    0.773333    2600        43.639576   0.202828    0.782961    142.212880 
[37m[36mINFO[0m[0m 02/10 19:18:32 | 0.747131    0.733333    0.949373    0.840219    0.630143    0.998233    0.996466    0.915765    0.758945    0.934120    0.765244    0.747131    0.733333    2800        46.996466   0.191850    0.760456    149.925756 
[37m[36mINFO[0m[0m 02/10 19:23:25 | 0.693817    0.691852    0.951910    0.838754    0.539245    1.000000    0.996466    0.912471    0.743879    0.943260    0.775915    0.693817    0.691852    3000        50.353357   0.178256    0.739999    145.292126 
[37m[36mINFO[0m[0m 02/10 19:28:14 | 0.776009    0.789630    0.947082    0.842101    0.664695    1.000000    0.996466    0.880471    0.732580    0.960777    0.797256    0.776009    0.789630    3200        53.710247   0.158234    0.738472    141.740037 
[37m[36mINFO[0m[0m 02/10 19:33:07 | 0.761570    0.771852    0.969502    0.849652    0.701941    0.999117    0.992933    0.940235    0.774011    0.969155    0.782012    0.761570    0.771852    3400        57.067138   0.150290    0.752428    142.368087 
[37m[36mINFO[0m[0m 02/10 19:38:02 | 0.774158    0.773333    0.970537    0.860395    0.686572    1.000000    0.996466    0.945882    0.796610    0.965727    0.788110    0.774158    0.773333    3600        60.424028   0.134918    0.763822    141.437338 
[37m[36mINFO[0m[0m 02/10 19:43:01 | 0.741207    0.730370    0.969565    0.851649    0.832435    1.000000    1.000000    0.942588    0.768362    0.966108    0.786585    0.741207    0.730370    3800        63.780919   0.123212    0.786531    142.616847 
[37m[36mINFO[0m[0m 02/10 19:48:02 | 0.661607    0.687407    0.963777    0.827532    0.759930    1.000000    0.992933    0.929412    0.713748    0.961919    0.775915    0.661607    0.687407    4000        67.137809   0.109612    0.791841    142.170264 
[37m[36mINFO[0m[0m 02/10 19:52:59 | 0.679378    0.682963    0.975675    0.843775    0.618302    1.000000    0.996466    0.954824    0.758945    0.972201    0.775915    0.679378    0.682963    4200        70.494700   0.145490    0.768729    142.925582 
[37m[36mINFO[0m[0m 02/10 19:57:43 | 0.727879    0.746667    0.976142    0.842125    0.945009    0.999117    0.985866    0.954824    0.764595    0.974486    0.775915    0.727879    0.746667    4400        73.851590   0.105808    0.739194    136.853037 
[37m[36mINFO[0m[0m 02/10 20:02:31 | 0.716401    0.720000    0.982523    0.839369    0.899313    1.000000    0.992933    0.964706    0.740113    0.982864    0.785061    0.716401    0.720000    4600        77.208481   0.106683    0.729012    141.697594 
[37m[36mINFO[0m[0m 02/10 20:07:23 | 0.674565    0.669630    0.966708    0.849306    0.907254    0.998233    0.996466    0.954824    0.774011    0.947068    0.777439    0.674565    0.669630    4800        80.565371   0.099333    0.732757    145.326160 
[37m[36mINFO[0m[0m 02/10 20:12:13 | 0.733802    0.742222    0.977773    0.848002    0.866592    1.000000    1.000000    0.953882    0.758945    0.979436    0.785061    0.733802    0.742222    5000        83.922261   0.099362    0.741416    142.163410 
[37m[36mINFO[0m[0m 02/10 20:12:13 | Cumulative gradient change saved at train_output/VLCS/RSC/[3]/250210_18-08-10_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/10 20:12:15 | ---
[37m[36mINFO[0m[0m 02/10 20:12:15 | test-domain validation(oracle) = 79.822%
[37m[36mINFO[0m[0m 02/10 20:12:15 | training-domain validation(iid) = 77.416%
[37m[36mINFO[0m[0m 02/10 20:12:15 | last = 73.380%
[37m[36mINFO[0m[0m 02/10 20:12:15 | last (inD) = 84.800%
[37m[36mINFO[0m[0m 02/10 20:12:15 | training-domain validation (iid, inD) = 86.040%
[37m[36mINFO[0m[0m 02/10 20:12:15 | === Summary ===
[37m[36mINFO[0m[0m 02/10 20:12:15 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset VLCS --trial_seed 0 --hparams_seed 6
[37m[36mINFO[0m[0m 02/10 20:12:15 | Unique name: 250210_18-08-10_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 20:12:15 | Out path: train_output/VLCS/RSC/[3]/250210_18-08-10_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 20:12:15 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/10 20:12:15 | Dataset: VLCS

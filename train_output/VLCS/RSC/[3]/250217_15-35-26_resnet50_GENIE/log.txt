[37m[36mINFO[0m[0m 02/17 15:35:26 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset VLCS --trial_seed 2 --hparams_seed 8
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 8
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/VLCS/RSC/[3]/250217_15-35-26_resnet50_GENIE
	out_root: train_output/VLCS/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250217_15-35-26_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 3.019123985218396e-05
	batch_size: 9
	weight_decay: 0.0020603523571546007
	rsc_f_drop_factor: 0.466733618322478
	rsc_b_drop_factor: 0.3753162030338783
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 02/17 15:35:26 | n_steps = 5001
[37m[36mINFO[0m[0m 02/17 15:35:26 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/17 15:35:26 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/17 15:35:26 | 
[37m[36mINFO[0m[0m 02/17 15:35:26 | Testenv name escaping te_V -> te_V
[37m[36mINFO[0m[0m 02/17 15:35:26 | Test envs = [3], name = te_V
[37m[36mINFO[0m[0m 02/17 15:35:26 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/17 15:35:26 | Batch sizes for each domain: [9, 9, 9, 0] (total=27)
[37m[36mINFO[0m[0m 02/17 15:35:26 | steps-per-epoch for each domain: 125.78, 236.11, 291.78 -> min = 125.78
[37m[36mINFO[0m[0m 02/17 15:35:28 | # of params = 23518277
[37m[36mINFO[0m[0m 02/17 15:37:56 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/17 15:37:56 | 0.475009    0.511111    0.523331    0.531296    1.393029    0.643993    0.657244    0.440471    0.459510    0.485529    0.477134    0.475009    0.511111    0           0.000000    3.361754    0.932187    148.002511 
[37m[36mINFO[0m[0m 02/17 15:41:28 | 0.619770    0.610370    0.716287    0.711266    0.687968    0.856890    0.830389    0.596235    0.608286    0.695735    0.695122    0.619770    0.610370    200         1.590106    1.295599    0.359120    139.313369 
[37m[36mINFO[0m[0m 02/17 15:45:07 | 0.655313    0.666667    0.792825    0.786378    0.566342    0.992049    0.985866    0.694118    0.694915    0.692308    0.678354    0.655313    0.666667    400         3.180212    1.040583    0.370859    145.631751 
[37m[36mINFO[0m[0m 02/17 15:48:43 | 0.673454    0.653333    0.829530    0.823269    0.507742    0.988516    0.978799    0.720941    0.728814    0.779132    0.762195    0.673454    0.653333    600         4.770318    0.948549    0.360993    142.956028 
[37m[36mINFO[0m[0m 02/17 15:52:20 | 0.722695    0.715556    0.827985    0.821363    0.465040    0.997350    0.989399    0.708235    0.723164    0.778370    0.751524    0.722695    0.715556    800         6.360424    0.937763    0.378774    141.805810 
[37m[36mINFO[0m[0m 02/17 15:55:53 | 0.697890    0.672593    0.839756    0.834185    0.466162    1.000000    0.989399    0.715765    0.725047    0.803503    0.788110    0.697890    0.672593    1000        7.950530    0.925595    0.372457    138.478782 
[37m[36mINFO[0m[0m 02/17 15:59:36 | 0.744909    0.739259    0.855471    0.841731    0.489432    1.000000    0.992933    0.755294    0.753296    0.811120    0.778963    0.744909    0.739259    1200        9.540636    0.888725    0.360207    150.852199 
[37m[36mINFO[0m[0m 02/17 16:03:13 | 0.727879    0.727407    0.862707    0.845659    0.437379    1.000000    0.996466    0.755294    0.764595    0.832826    0.775915    0.727879    0.727407    1400        11.130742   0.871674    0.354326    145.670831 
[37m[36mINFO[0m[0m 02/17 16:06:53 | 0.756757    0.760000    0.851335    0.834264    0.502287    0.992049    0.985866    0.753882    0.760829    0.808073    0.756098    0.756757    0.760000    1600        12.720848   0.860902    0.367178    147.288550 
[37m[36mINFO[0m[0m 02/17 16:10:28 | 0.700852    0.703704    0.864225    0.844720    0.444405    0.998233    0.992933    0.768471    0.768362    0.825971    0.772866    0.700852    0.703704    1800        14.310954   0.817627    0.368837    140.882021 
[37m[36mINFO[0m[0m 02/17 16:14:18 | 0.717512    0.736296    0.872653    0.840063    0.450239    0.999117    0.985866    0.782588    0.772128    0.836253    0.762195    0.717512    0.736296    2000        15.901060   0.842247    0.426571    144.639343 
[37m[36mINFO[0m[0m 02/17 16:17:52 | 0.720474    0.731852    0.872739    0.851416    0.432887    0.998233    0.992933    0.782588    0.777778    0.837395    0.783537    0.720474    0.731852    2200        17.491166   0.802989    0.388766    136.164759 
[37m[36mINFO[0m[0m 02/17 16:21:34 | 0.721214    0.712593    0.866045    0.836069    0.469156    0.998233    0.989399    0.757176    0.730697    0.842727    0.788110    0.721214    0.712593    2400        19.081272   0.780783    0.419638    138.099527 
[37m[36mINFO[0m[0m 02/17 16:25:16 | 0.735283    0.745185    0.880338    0.840493    0.501968    0.999117    0.989399    0.797647    0.768362    0.844250    0.763720    0.735283    0.745185    2600        20.671378   0.806032    0.423239    137.953620 
[37m[36mINFO[0m[0m 02/17 16:29:02 | 0.727508    0.742222    0.873915    0.837217    0.441777    0.998233    0.992933    0.757176    0.738230    0.866337    0.780488    0.727508    0.742222    2800        22.261484   0.774002    0.425777    140.792248 
[37m[36mINFO[0m[0m 02/17 16:32:41 | 0.729359    0.746667    0.878775    0.824388    0.462711    0.999117    0.982332    0.783059    0.743879    0.854151    0.746951    0.729359    0.746667    3000        23.851590   0.759012    0.385882    141.406252 
[37m[36mINFO[0m[0m 02/17 16:36:25 | 0.687893    0.687407    0.897065    0.849443    0.459049    0.999117    0.992933    0.813176    0.762712    0.878903    0.792683    0.687893    0.687407    3200        25.441696   0.717180    0.381117    147.274753 
[37m[36mINFO[0m[0m 02/17 16:40:06 | 0.747131    0.733333    0.884403    0.842526    0.451595    1.000000    0.989399    0.799059    0.768362    0.854151    0.769817    0.747131    0.733333    3400        27.031802   0.769555    0.378788    145.752779 
[37m[36mINFO[0m[0m 02/17 16:43:47 | 0.644946    0.629630    0.872584    0.828788    0.520246    0.998233    0.992933    0.798118    0.749529    0.821401    0.743902    0.644946    0.629630    3600        28.621908   0.757688    0.386080    143.653532 
[37m[36mINFO[0m[0m 02/17 16:47:27 | 0.743058    0.752593    0.896246    0.844977    0.455355    0.995583    0.989399    0.810824    0.758945    0.882331    0.786585    0.743058    0.752593    3800        30.212014   0.754872    0.370332    145.920510 
[37m[36mINFO[0m[0m 02/17 16:51:04 | 0.714920    0.714074    0.908467    0.845844    0.455551    0.998233    0.989399    0.833412    0.764595    0.893755    0.783537    0.714920    0.714074    4000        31.802120   0.733784    0.390981    139.006613 
[37m[36mINFO[0m[0m 02/17 16:54:48 | 0.643095    0.654815    0.857427    0.828041    0.612120    0.997350    0.992933    0.768000    0.745763    0.806931    0.745427    0.643095    0.654815    4200        33.392226   0.719204    0.384555    147.463764 
[37m[36mINFO[0m[0m 02/17 16:58:30 | 0.746020    0.757037    0.906911    0.847321    0.491330    0.997350    0.992933    0.839529    0.785311    0.883854    0.763720    0.746020    0.757037    4400        34.982332   0.701410    0.387435    144.488522 
[37m[36mINFO[0m[0m 02/17 17:02:08 | 0.716772    0.699259    0.906644    0.850979    0.449740    0.998233    0.996466    0.828706    0.768362    0.892993    0.788110    0.716772    0.699259    4600        36.572438   0.706757    0.364577    144.537795 
[37m[36mINFO[0m[0m 02/17 17:05:48 | 0.739356    0.749630    0.891582    0.827551    0.578590    0.995583    0.989399    0.835294    0.764595    0.843869    0.728659    0.739356    0.749630    4800        38.162544   0.717555    0.408883    138.039948 
[37m[36mINFO[0m[0m 02/17 17:09:34 | 0.648649    0.647407    0.873505    0.821686    0.474687    1.000000    0.996466    0.769412    0.723164    0.851104    0.745427    0.648649    0.647407    5000        39.752650   0.713817    0.441673    137.480515 
[37m[36mINFO[0m[0m 02/17 17:09:34 | Cumulative gradient change saved at train_output/VLCS/RSC/[3]/250217_15-35-26_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/17 17:09:35 | ---
[37m[36mINFO[0m[0m 02/17 17:09:35 | test-domain validation(oracle) = 75.676%
[37m[36mINFO[0m[0m 02/17 17:09:35 | training-domain validation(iid) = 72.047%
[37m[36mINFO[0m[0m 02/17 17:09:35 | last = 64.865%
[37m[36mINFO[0m[0m 02/17 17:09:35 | last (inD) = 82.169%
[37m[36mINFO[0m[0m 02/17 17:09:35 | training-domain validation (iid, inD) = 85.142%
[37m[36mINFO[0m[0m 02/17 17:09:35 | === Summary ===
[37m[36mINFO[0m[0m 02/17 17:09:35 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset VLCS --trial_seed 2 --hparams_seed 8
[37m[36mINFO[0m[0m 02/17 17:09:35 | Unique name: 250217_15-35-26_resnet50_GENIE
[37m[36mINFO[0m[0m 02/17 17:09:35 | Out path: train_output/VLCS/RSC/[3]/250217_15-35-26_resnet50_GENIE
[37m[36mINFO[0m[0m 02/17 17:09:35 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/17 17:09:35 | Dataset: VLCS

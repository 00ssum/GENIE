[37m[36mINFO[0m[0m 02/16 11:31:56 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset VLCS --trial_seed 1 --hparams_seed 12
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 12
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/VLCS/RSC/[3]/250216_11-31-56_resnet50_GENIE
	out_root: train_output/VLCS/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250216_11-31-56_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 3.0065625733392338e-05
	batch_size: 34
	weight_decay: 4.89485556145273e-06
	rsc_f_drop_factor: 0.23818860955359455
	rsc_b_drop_factor: 0.46131243462788474
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 02/16 11:31:56 | n_steps = 5001
[37m[36mINFO[0m[0m 02/16 11:31:56 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/16 11:31:56 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/16 11:31:56 | 
[37m[36mINFO[0m[0m 02/16 11:31:56 | Testenv name escaping te_V -> te_V
[37m[36mINFO[0m[0m 02/16 11:31:56 | Test envs = [3], name = te_V
[37m[36mINFO[0m[0m 02/16 11:31:56 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/16 11:31:56 | Batch sizes for each domain: [34, 34, 34, 0] (total=102)
[37m[36mINFO[0m[0m 02/16 11:31:56 | steps-per-epoch for each domain: 33.29, 62.50, 77.24 -> min = 33.29
[37m[36mINFO[0m[0m 02/16 11:31:57 | # of params = 23518277
[37m[36mINFO[0m[0m 02/16 11:34:20 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/16 11:34:20 | 0.453536    0.405926    0.485800    0.499658    1.299960    0.613958    0.618375    0.466824    0.461394    0.376618    0.419207    0.453536    0.405926    0           0.000000    3.399102    1.339350    142.096463 
[37m[36mINFO[0m[0m 02/16 11:41:08 | 0.637912    0.635556    0.742388    0.738685    0.706873    0.928445    0.893993    0.671529    0.642185    0.627190    0.679878    0.637912    0.635556    200         6.007067    1.108746    1.286240    150.495034 
[37m[36mINFO[0m[0m 02/16 11:47:55 | 0.673825    0.641481    0.767583    0.768697    0.566651    0.950530    0.929329    0.688471    0.657250    0.663747    0.719512    0.673825    0.641481    400         12.014134   0.955298    1.344121    138.169400 
[37m[36mINFO[0m[0m 02/16 11:54:23 | 0.706775    0.687407    0.829746    0.826742    0.510228    0.998233    0.989399    0.731294    0.711864    0.759711    0.778963    0.706775    0.687407    600         18.021201   0.803534    1.241990    139.755014 
[37m[36mINFO[0m[0m 02/16 12:00:44 | 0.684561    0.657778    0.819209    0.807171    0.554429    0.994700    0.982332    0.763765    0.728814    0.699162    0.710366    0.684561    0.657778    800         24.028269   0.719203    1.242456    132.388297 
[37m[36mINFO[0m[0m 02/16 12:07:06 | 0.743058    0.700741    0.830630    0.814511    0.610944    0.998233    0.978799    0.757176    0.726930    0.736481    0.737805    0.743058    0.700741    1000        30.035336   0.631838    1.240601    134.250373 
[37m[36mINFO[0m[0m 02/16 12:13:47 | 0.740466    0.693333    0.812793    0.802490    0.610901    0.998233    0.985866    0.766118    0.732580    0.674029    0.689024    0.740466    0.693333    1200        36.042403   0.623679    1.304196    140.356041 
[37m[36mINFO[0m[0m 02/16 12:20:48 | 0.712699    0.681481    0.884143    0.846483    0.527529    1.000000    0.992933    0.808941    0.740113    0.843488    0.806402    0.712699    0.681481    1400        42.049470   0.535662    1.420173    136.830027 
[37m[36mINFO[0m[0m 02/16 12:27:42 | 0.758608    0.754074    0.868559    0.834580    0.633957    1.000000    0.982332    0.801412    0.736347    0.804265    0.785061    0.758608    0.754074    1600        48.056537   0.504160    1.314953    151.126789 
[37m[36mINFO[0m[0m 02/16 12:34:25 | 0.710107    0.699259    0.890183    0.845903    0.566058    0.999117    0.989399    0.828706    0.749529    0.842727    0.798780    0.710107    0.699259    1800        54.063604   0.480004    1.302173    142.522387 
[37m[36mINFO[0m[0m 02/16 12:41:21 | 0.696779    0.674074    0.895765    0.832602    0.540380    1.000000    0.989399    0.840000    0.740113    0.847296    0.768293    0.696779    0.674074    2000        60.070671   0.432745    1.388857    138.317258 
[37m[36mINFO[0m[0m 02/16 12:48:12 | 0.742318    0.728889    0.912500    0.839279    0.661442    1.000000    0.992933    0.853647    0.730697    0.883854    0.794207    0.742318    0.728889    2200        66.077739   0.432835    1.339949    142.651820 
[37m[36mINFO[0m[0m 02/16 12:55:13 | 0.691596    0.684444    0.865666    0.808700    0.547264    0.999117    0.992933    0.800471    0.689266    0.797411    0.743902    0.691596    0.684444    2400        72.084806   0.384703    1.389137    143.001423 
[37m[36mINFO[0m[0m 02/16 13:01:45 | 0.696779    0.691852    0.914804    0.826618    0.684169    1.000000    0.996466    0.881882    0.728814    0.862529    0.754573    0.696779    0.691852    2600        78.091873   0.400585    1.291148    134.081375 
[37m[36mINFO[0m[0m 02/16 13:08:05 | 0.682710    0.672593    0.926449    0.839130    0.636253    0.999117    0.992933    0.888000    0.736347    0.892232    0.788110    0.682710    0.672593    2800        84.098940   0.323254    1.246849    130.732857 
[37m[36mINFO[0m[0m 02/16 13:14:32 | 0.704184    0.708148    0.914857    0.830688    0.639180    1.000000    0.989399    0.834824    0.709981    0.909749    0.792683    0.704184    0.708148    3000        90.106007   0.342730    1.257377    135.106730 
[37m[36mINFO[0m[0m 02/16 13:21:01 | 0.733062    0.714074    0.931045    0.848952    1.106031    1.000000    0.989399    0.891765    0.749529    0.901371    0.807927    0.733062    0.714074    3200        96.113074   0.376295    1.260457    136.921184 
[37m[36mINFO[0m[0m 02/16 13:27:34 | 0.713069    0.694815    0.951845    0.837623    0.943534    1.000000    0.989399    0.929412    0.723164    0.926123    0.800305    0.713069    0.694815    3400        102.120141  0.274698    1.260362    140.504674 
[37m[36mINFO[0m[0m 02/16 13:33:51 | 0.679378    0.666667    0.932932    0.832757    1.184267    1.000000    1.000000    0.871529    0.726930    0.927266    0.771341    0.679378    0.666667    3600        108.127208  0.227873    1.235801    130.402202 
[37m[36mINFO[0m[0m 02/16 13:40:23 | 0.710107    0.688889    0.950869    0.834950    0.956307    0.999117    0.985866    0.916706    0.715631    0.936786    0.803354    0.710107    0.688889    3800        114.134276  0.235059    1.279978    135.682999 
[37m[36mINFO[0m[0m 02/16 13:47:18 | 0.735283    0.711111    0.960209    0.844127    1.215918    1.000000    0.985866    0.941176    0.740113    0.939452    0.806402    0.735283    0.711111    4000        120.141343  0.201667    1.306804    153.923704 
[37m[36mINFO[0m[0m 02/16 13:54:10 | 0.707516    0.677037    0.950484    0.817895    0.901189    1.000000    0.989399    0.912000    0.700565    0.939452    0.763720    0.707516    0.677037    4200        126.148410  0.194744    1.294719    153.192817 
[37m[36mINFO[0m[0m 02/16 14:00:47 | 0.691966    0.671111    0.957003    0.830610    1.295825    1.000000    0.992933    0.916706    0.706215    0.954303    0.792683    0.691966    0.671111    4400        132.155477  0.222027    1.270712    142.589400 
[37m[36mINFO[0m[0m 02/16 14:07:37 | 0.718993    0.703704    0.952409    0.830628    1.291605    1.000000    0.989399    0.898353    0.693032    0.958873    0.809451    0.718993    0.703704    4600        138.162544  0.194311    1.384423    133.009966 
[37m[36mINFO[0m[0m 02/16 14:14:04 | 0.741207    0.717037    0.958883    0.836044    1.672507    0.997350    0.982332    0.924235    0.719397    0.955065    0.806402    0.741207    0.717037    4800        144.169611  0.189428    1.249189    136.980609 
[37m[36mINFO[0m[0m 02/16 14:20:25 | 0.726768    0.733333    0.948976    0.823891    1.728555    1.000000    0.985866    0.916235    0.717514    0.930693    0.768293    0.726768    0.733333    5000        150.176678  0.164156    1.235247    134.022983 
[37m[36mINFO[0m[0m 02/16 14:20:25 | Cumulative gradient change saved at train_output/VLCS/RSC/[3]/250216_11-31-56_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/16 14:20:35 | ---
[37m[36mINFO[0m[0m 02/16 14:20:35 | test-domain validation(oracle) = 75.861%
[37m[36mINFO[0m[0m 02/16 14:20:35 | training-domain validation(iid) = 73.306%
[37m[36mINFO[0m[0m 02/16 14:20:35 | last = 72.677%
[37m[36mINFO[0m[0m 02/16 14:20:35 | last (inD) = 82.389%
[37m[36mINFO[0m[0m 02/16 14:20:35 | training-domain validation (iid, inD) = 84.895%
[37m[36mINFO[0m[0m 02/16 14:20:35 | === Summary ===
[37m[36mINFO[0m[0m 02/16 14:20:35 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset VLCS --trial_seed 1 --hparams_seed 12
[37m[36mINFO[0m[0m 02/16 14:20:35 | Unique name: 250216_11-31-56_resnet50_GENIE
[37m[36mINFO[0m[0m 02/16 14:20:35 | Out path: train_output/VLCS/RSC/[3]/250216_11-31-56_resnet50_GENIE
[37m[36mINFO[0m[0m 02/16 14:20:35 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/16 14:20:35 | Dataset: VLCS

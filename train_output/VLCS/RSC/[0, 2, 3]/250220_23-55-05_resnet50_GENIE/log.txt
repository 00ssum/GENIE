[37m[36mINFO[0m[0m 02/20 23:55:05 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 2 3 --dataset VLCS --trial_seed 2 --hparams_seed 3
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 3
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/VLCS/RSC/[0, 2, 3]/250220_23-55-05_resnet50_GENIE
	out_root: train_output/VLCS/RSC/[0, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 2, 3]
	trial_seed: 2
	unique_name: 250220_23-55-05_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.0002649077542048787
	batch_size: 21
	weight_decay: 0.0023111806563778695
	rsc_f_drop_factor: 0.03146145565044939
	rsc_b_drop_factor: 0.0371714794770715
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 02/20 23:55:05 | n_steps = 5001
[37m[36mINFO[0m[0m 02/20 23:55:05 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/20 23:55:05 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/20 23:55:05 | 
[37m[36mINFO[0m[0m 02/20 23:55:05 | Testenv name escaping te_C_S_V -> te_C_S_V
[37m[36mINFO[0m[0m 02/20 23:55:05 | Test envs = [0, 2, 3], name = te_C_S_V
[37m[36mINFO[0m[0m 02/20 23:55:05 | Train environments: [1], Test environments: [0, 2, 3]
[37m[36mINFO[0m[0m 02/20 23:55:05 | Batch sizes for each domain: [0, 21, 0, 0] (total=21)
[37m[36mINFO[0m[0m 02/20 23:55:05 | steps-per-epoch for each domain: 101.19 -> min = 101.19
[37m[36mINFO[0m[0m 02/20 23:55:06 | # of params = 23518277
[37m[36mINFO[0m[0m 02/20 23:57:42 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/20 23:57:42 | 0.483943    0.470377    0.467294    0.459510    1.305455    0.620141    0.593640    0.467294    0.459510    0.391851    0.358232    0.439837    0.459259    0           0.000000    1.761328    1.028112    154.806531 
[37m[36mINFO[0m[0m 02/21 00:03:50 | 0.652537    0.627449    0.739765    0.736347    0.651185    0.860424    0.826855    0.739765    0.736347    0.473343    0.445122    0.623843    0.610370    200         1.976471    0.822060    1.003567    167.042758 
[37m[36mINFO[0m[0m 02/21 00:09:39 | 0.654092    0.617262    0.767529    0.762712    0.653032    0.825972    0.787986    0.767529    0.762712    0.522087    0.477134    0.614217    0.586667    400         3.952941    0.662704    0.969998    154.772242 
[37m[36mINFO[0m[0m 02/21 00:15:31 | 0.691797    0.658491    0.797176    0.781544    0.624210    0.885159    0.840989    0.797176    0.781544    0.504189    0.461890    0.686042    0.672593    600         5.929412    0.579732    0.996233    153.274740 
[37m[36mINFO[0m[0m 02/21 00:21:18 | 0.725967    0.691738    0.835765    0.787194    0.579768    0.914311    0.869258    0.835765    0.787194    0.572734    0.527439    0.690855    0.678519    800         7.905882    0.536415    0.962266    154.626746 
[37m[36mINFO[0m[0m 02/21 00:27:13 | 0.655083    0.634076    0.791059    0.723164    0.697732    0.764134    0.759717    0.791059    0.723164    0.562833    0.536585    0.638282    0.605926    1000        9.882353    0.461222    0.989963    156.603784 
[37m[36mINFO[0m[0m 02/21 00:33:10 | 0.542755    0.527661    0.864000    0.766478    0.656425    0.403710    0.416961    0.864000    0.766478    0.607007    0.582317    0.617549    0.583704    1200        11.858824   0.425655    0.987867    159.432412 
[37m[36mINFO[0m[0m 02/21 00:38:53 | 0.646691    0.623228    0.875765    0.772128    0.739389    0.686396    0.657244    0.875765    0.772128    0.575781    0.547256    0.677897    0.665185    1400        13.835294   0.381975    0.989477    145.133278 
[37m[36mINFO[0m[0m 02/21 00:44:32 | 0.580912    0.562590    0.888941    0.764595    0.674543    0.431979    0.420495    0.888941    0.764595    0.631379    0.600610    0.679378    0.666667    1600        15.811765   0.374822    0.937958    151.462765 
[37m[36mINFO[0m[0m 02/21 00:50:08 | 0.536482    0.525884    0.873412    0.755179    0.937912    0.358657    0.385159    0.873412    0.755179    0.645088    0.628049    0.605702    0.564444    1800        17.788235   0.324130    0.959789    143.986911 
[37m[36mINFO[0m[0m 02/21 00:55:56 | 0.611516    0.587054    0.901176    0.766478    0.724993    0.612191    0.586572    0.901176    0.766478    0.554455    0.518293    0.667901    0.656296    2000        19.764706   0.326015    1.006278    146.640530 
[37m[36mINFO[0m[0m 02/21 01:01:37 | 0.524571    0.521926    0.880471    0.755179    0.715399    0.415194    0.452297    0.880471    0.755179    0.575400    0.557927    0.583117    0.555556    2200        21.741176   0.295481    0.955134    150.485982 
[37m[36mINFO[0m[0m 02/21 01:07:25 | 0.525823    0.498368    0.918118    0.757062    1.011556    0.391343    0.374558    0.918118    0.757062    0.583016    0.545732    0.603110    0.574815    2400        23.717647   0.232861    0.996577    148.013925 
[37m[36mINFO[0m[0m 02/21 01:13:15 | 0.513888    0.498041    0.907765    0.749529    1.108319    0.338339    0.363958    0.907765    0.749529    0.615765    0.571646    0.587560    0.558519    2600        25.694118   0.228325    0.965908    156.993728 
[37m[36mINFO[0m[0m 02/21 01:18:49 | 0.682277    0.656342    0.911529    0.741996    0.809165    0.866608    0.851590    0.911529    0.741996    0.530465    0.487805    0.649759    0.629630    2800        27.670588   0.207348    0.948951    144.559435 
[37m[36mINFO[0m[0m 02/21 01:24:43 | 0.512434    0.504401    0.961412    0.760829    0.983559    0.297703    0.325088    0.961412    0.760829    0.615385    0.577744    0.624213    0.610370    3000        29.647059   0.201212    0.988998    155.582882 
[37m[36mINFO[0m[0m 02/21 01:30:32 | 0.467637    0.449967    0.955765    0.749529    1.008778    0.322438    0.307420    0.955765    0.749529    0.524752    0.509146    0.555720    0.533333    3200        31.623529   0.161239    0.943841    160.315027 
[37m[36mINFO[0m[0m 02/21 01:36:14 | 0.528697    0.510055    0.960000    0.772128    0.981688    0.389576    0.392226    0.960000    0.772128    0.570449    0.532012    0.626064    0.605926    3400        33.600000   0.172097    0.919518    158.511084 
[37m[36mINFO[0m[0m 02/21 01:41:56 | 0.621525    0.609313    0.969412    0.760829    0.821188    0.677562    0.685512    0.969412    0.760829    0.575019    0.533537    0.611996    0.608889    3600        35.576471   0.146527    0.943242    152.983267 
[37m[36mINFO[0m[0m 02/21 01:47:44 | 0.485527    0.480503    0.961412    0.747646    1.114775    0.337456    0.342756    0.961412    0.747646    0.556740    0.560976    0.562384    0.537778    3800        37.552941   0.106945    0.986977    150.545812 
[37m[36mINFO[0m[0m 02/21 01:53:39 | 0.470351    0.448376    0.944471    0.758945    1.099382    0.348057    0.335689    0.944471    0.758945    0.495430    0.440549    0.567568    0.568889    4000        39.529412   0.117837    0.978724    159.223157 
[37m[36mINFO[0m[0m 02/21 01:59:21 | 0.518210    0.512845    0.982588    0.757062    1.186123    0.415194    0.452297    0.982588    0.757062    0.514851    0.484756    0.624583    0.601481    4200        41.505882   0.099190    0.974214    147.169598 
[37m[36mINFO[0m[0m 02/21 02:05:05 | 0.510836    0.484379    0.961882    0.743879    1.103901    0.404594    0.388693    0.961882    0.743879    0.539985    0.500000    0.587930    0.564444    4400        43.482353   0.153396    0.971550    149.556580 
[37m[36mINFO[0m[0m 02/21 02:10:37 | 0.451348    0.439289    0.960941    0.736347    1.253634    0.318021    0.332155    0.960941    0.736347    0.523991    0.492378    0.512033    0.493333    4600        45.458824   0.095426    0.970459    138.352215 
[37m[36mINFO[0m[0m 02/21 02:16:13 | 0.453479    0.449272    0.967059    0.738230    1.165833    0.311837    0.332155    0.967059    0.738230    0.550267    0.556402    0.498334    0.459259    4800        47.435294   0.073425    0.957781    144.604017 
[37m[36mINFO[0m[0m 02/21 02:21:54 | 0.542816    0.520682    0.977882    0.768362    1.000476    0.493816    0.477032    0.977882    0.768362    0.528561    0.493902    0.606072    0.591111    5000        49.411765   0.113471    0.977964    145.056400 
[37m[36mINFO[0m[0m 02/21 02:21:54 | Cumulative gradient change saved at train_output/VLCS/RSC/[0, 2, 3]/250220_23-55-05_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/21 02:21:55 | ---
[37m[36mINFO[0m[0m 02/21 02:21:55 | test-domain validation(oracle) = 72.597%
[37m[36mINFO[0m[0m 02/21 02:21:55 | training-domain validation(iid) = 72.597%
[37m[36mINFO[0m[0m 02/21 02:21:55 | last = 54.282%
[37m[36mINFO[0m[0m 02/21 02:21:55 | last (inD) = 76.836%
[37m[36mINFO[0m[0m 02/21 02:21:55 | training-domain validation (iid, inD) = 78.719%
[37m[36mINFO[0m[0m 02/21 02:21:55 | === Summary ===
[37m[36mINFO[0m[0m 02/21 02:21:55 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 2 3 --dataset VLCS --trial_seed 2 --hparams_seed 3
[37m[36mINFO[0m[0m 02/21 02:21:55 | Unique name: 250220_23-55-05_resnet50_GENIE
[37m[36mINFO[0m[0m 02/21 02:21:55 | Out path: train_output/VLCS/RSC/[0, 2, 3]/250220_23-55-05_resnet50_GENIE
[37m[36mINFO[0m[0m 02/21 02:21:55 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/21 02:21:55 | Dataset: VLCS

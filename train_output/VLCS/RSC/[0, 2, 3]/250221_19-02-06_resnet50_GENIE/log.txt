[37m[36mINFO[0m[0m 02/21 19:02:06 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 2 3 --dataset VLCS --trial_seed 1 --hparams_seed 8
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 8
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/VLCS/RSC/[0, 2, 3]/250221_19-02-06_resnet50_GENIE
	out_root: train_output/VLCS/RSC/[0, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 2, 3]
	trial_seed: 1
	unique_name: 250221_19-02-06_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 3.335053008064847e-05
	batch_size: 18
	weight_decay: 0.00011109601170966198
	rsc_f_drop_factor: 0.18129063791925754
	rsc_b_drop_factor: 0.03567706337646076
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 02/21 19:02:06 | n_steps = 5001
[37m[36mINFO[0m[0m 02/21 19:02:06 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/21 19:02:06 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/21 19:02:06 | 
[37m[36mINFO[0m[0m 02/21 19:02:06 | Testenv name escaping te_C_S_V -> te_C_S_V
[37m[36mINFO[0m[0m 02/21 19:02:06 | Test envs = [0, 2, 3], name = te_C_S_V
[37m[36mINFO[0m[0m 02/21 19:02:06 | Train environments: [1], Test environments: [0, 2, 3]
[37m[36mINFO[0m[0m 02/21 19:02:06 | Batch sizes for each domain: [0, 18, 0, 0] (total=18)
[37m[36mINFO[0m[0m 02/21 19:02:06 | steps-per-epoch for each domain: 118.06 -> min = 118.06
[37m[36mINFO[0m[0m 02/21 19:02:08 | # of params = 23518277
[37m[36mINFO[0m[0m 02/21 19:04:36 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/21 19:04:36 | 0.451761    0.448746    0.466824    0.461394    1.198670    0.531802    0.530035    0.466824    0.461394    0.376238    0.417683    0.447242    0.398519    0           0.000000    1.897431    1.467499    146.682367 
[37m[36mINFO[0m[0m 02/21 19:09:33 | 0.569677    0.579393    0.706353    0.689266    0.812504    0.711131    0.706714    0.706353    0.689266    0.444402    0.486280    0.553499    0.545185    200         1.694118    0.806786    0.784913    139.844865 
[37m[36mINFO[0m[0m 02/21 19:14:54 | 0.649101    0.634292    0.769412    0.741996    0.685739    0.823322    0.791519    0.769412    0.741996    0.504950    0.535061    0.619030    0.576296    400         3.388235    0.669442    0.853871    150.007038 
[37m[36mINFO[0m[0m 02/21 19:19:59 | 0.615334    0.610617    0.736941    0.721281    0.692421    0.856890    0.833922    0.736941    0.721281    0.421173    0.452744    0.567938    0.545185    600         5.082353    0.638381    0.753405    154.140921 
[37m[36mINFO[0m[0m 02/21 19:25:05 | 0.635924    0.628861    0.753882    0.717514    0.677702    0.866608    0.840989    0.753882    0.717514    0.415842    0.461890    0.625324    0.583704    800         6.776471    0.611582    0.893650    127.388157 
[37m[36mINFO[0m[0m 02/21 19:30:12 | 0.729468    0.735487    0.821647    0.753296    0.639951    0.879859    0.886926    0.821647    0.753296    0.618431    0.667683    0.690115    0.651852    1000        8.470588    0.547335    0.817209    143.981904 
[37m[36mINFO[0m[0m 02/21 19:35:02 | 0.702680    0.704700    0.839059    0.775895    0.635988    0.886042    0.876325    0.839059    0.775895    0.554836    0.605183    0.667160    0.632593    1200        10.164706   0.502482    0.719528    146.125839 
[37m[36mINFO[0m[0m 02/21 19:40:04 | 0.688979    0.677085    0.848471    0.747646    0.674710    0.869258    0.848057    0.848471    0.747646    0.519040    0.560976    0.678638    0.622222    1400        11.858824   0.470672    0.783212    145.012582 
[37m[36mINFO[0m[0m 02/21 19:45:02 | 0.639878    0.645655    0.824471    0.749529    0.699289    0.896643    0.886926    0.824471    0.749529    0.414699    0.461890    0.608293    0.588148    1600        13.552941   0.438282    0.786847    140.786766 
[37m[36mINFO[0m[0m 02/21 19:50:16 | 0.727795    0.718644    0.856471    0.783427    0.708166    0.913428    0.915194    0.856471    0.783427    0.588728    0.605183    0.681229    0.635556    1800        15.247059   0.417776    0.845841    144.924572 
[37m[36mINFO[0m[0m 02/21 19:55:25 | 0.711529    0.697322    0.861176    0.768362    0.737031    0.913428    0.901060    0.861176    0.768362    0.551409    0.571646    0.669752    0.619259    2000        16.941176   0.376710    0.771152    154.183311 
[37m[36mINFO[0m[0m 02/21 20:00:11 | 0.729261    0.717868    0.871059    0.740113    0.826029    0.890459    0.893993    0.871059    0.740113    0.600914    0.591463    0.696409    0.668148    2200        18.635294   0.353258    0.764642    133.135052 
[37m[36mINFO[0m[0m 02/21 20:05:30 | 0.670862    0.662739    0.833882    0.728814    0.878455    0.863958    0.851590    0.833882    0.728814    0.512567    0.538110    0.636061    0.598519    2400        20.329412   0.371954    0.825222    154.541581 
[37m[36mINFO[0m[0m 02/21 20:10:33 | 0.661877    0.656698    0.883294    0.734463    1.100471    0.822438    0.819788    0.883294    0.734463    0.517136    0.550305    0.646057    0.600000    2600        22.023529   0.283017    0.748543    152.599732 
[37m[36mINFO[0m[0m 02/21 20:15:35 | 0.708500    0.700830    0.927529    0.751412    0.811009    0.895760    0.883392    0.927529    0.751412    0.540366    0.573171    0.689374    0.645926    2800        23.717647   0.323863    0.816525    138.547673 
[37m[36mINFO[0m[0m 02/21 20:20:38 | 0.663897    0.638087    0.911529    0.755179    1.003963    0.773852    0.731449    0.911529    0.755179    0.538462    0.547256    0.679378    0.635556    3000        25.411765   0.246886    0.778137    148.183201 
[37m[36mINFO[0m[0m 02/21 20:25:46 | 0.687442    0.671681    0.912471    0.725047    1.458258    0.857774    0.823322    0.912471    0.725047    0.566641    0.600610    0.637912    0.591111    3200        27.105882   0.216806    0.811311    144.860912 
[37m[36mINFO[0m[0m 02/21 20:30:52 | 0.573744    0.569651    0.924706    0.738230    1.196020    0.585689    0.558304    0.924706    0.738230    0.521325    0.562500    0.614217    0.588148    3400        28.800000   0.273098    0.796767    146.905840 
[37m[36mINFO[0m[0m 02/21 20:35:47 | 0.548414    0.559628    0.946353    0.747646    1.010631    0.424028    0.427562    0.946353    0.747646    0.579970    0.612805    0.641244    0.638519    3600        30.494118   0.208098    0.777282    139.758005 
[37m[36mINFO[0m[0m 02/21 20:40:47 | 0.625129    0.624666    0.930824    0.738230    1.118970    0.704947    0.699647    0.930824    0.738230    0.538081    0.562500    0.632358    0.611852    3800        32.188235   0.214718    0.811505    137.296022 
[37m[36mINFO[0m[0m 02/21 20:45:56 | 0.596939    0.585905    0.967059    0.755179    1.016340    0.581272    0.565371    0.967059    0.755179    0.559787    0.570122    0.649759    0.622222    4000        33.882353   0.222954    0.835216    141.986607 
[37m[36mINFO[0m[0m 02/21 20:51:11 | 0.599312    0.594378    0.933176    0.721281    1.214936    0.691696    0.674912    0.933176    0.721281    0.492765    0.528963    0.613476    0.579259    4200        35.576471   0.183319    0.780839    159.153153 
[37m[36mINFO[0m[0m 02/21 20:56:17 | 0.524998    0.506921    0.966118    0.755179    1.565649    0.422261    0.399293    0.966118    0.755179    0.527037    0.525915    0.625694    0.595556    4400        37.270588   0.165008    0.832341    139.374265 
[37m[36mINFO[0m[0m 02/21 21:01:36 | 0.560476    0.547411    0.974118    0.747646    1.163468    0.442580    0.445230    0.974118    0.747646    0.588347    0.577744    0.650500    0.619259    4600        38.964706   0.141952    0.847106    149.724769 
[37m[36mINFO[0m[0m 02/21 21:06:46 | 0.541822    0.531986    0.962353    0.740113    1.692712    0.457597    0.431095    0.962353    0.740113    0.498858    0.541159    0.669011    0.623704    4800        40.658824   0.128211    0.785325    152.972658 
[37m[36mINFO[0m[0m 02/21 21:12:12 | 0.487748    0.501612    0.973176    0.766478    1.704227    0.357774    0.381625    0.973176    0.766478    0.491622    0.535061    0.613847    0.588148    5000        42.352941   0.147426    0.904791    145.256566 
[37m[36mINFO[0m[0m 02/21 21:12:12 | Cumulative gradient change saved at train_output/VLCS/RSC/[0, 2, 3]/250221_19-02-06_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/21 21:12:13 | ---
[37m[36mINFO[0m[0m 02/21 21:12:13 | test-domain validation(oracle) = 72.947%
[37m[36mINFO[0m[0m 02/21 21:12:13 | training-domain validation(iid) = 72.779%
[37m[36mINFO[0m[0m 02/21 21:12:13 | last = 48.775%
[37m[36mINFO[0m[0m 02/21 21:12:13 | last (inD) = 76.648%
[37m[36mINFO[0m[0m 02/21 21:12:13 | training-domain validation (iid, inD) = 78.343%
[37m[36mINFO[0m[0m 02/21 21:12:13 | === Summary ===
[37m[36mINFO[0m[0m 02/21 21:12:13 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 2 3 --dataset VLCS --trial_seed 1 --hparams_seed 8
[37m[36mINFO[0m[0m 02/21 21:12:13 | Unique name: 250221_19-02-06_resnet50_GENIE
[37m[36mINFO[0m[0m 02/21 21:12:13 | Out path: train_output/VLCS/RSC/[0, 2, 3]/250221_19-02-06_resnet50_GENIE
[37m[36mINFO[0m[0m 02/21 21:12:13 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/21 21:12:13 | Dataset: VLCS

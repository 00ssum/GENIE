[37m[36mINFO[0m[0m 01/29 23:42:55 | Command :: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm RSC --test_envs 0 2 3 --dataset VLCS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: VLCS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/VLCS/RSC/[0, 2, 3]/250129_23-42-55_resnet50_sgd
	out_root: train_output/VLCS/RSC/[0, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 2, 3]
	trial_seed: 0
	unique_name: 250129_23-42-55_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	rsc_f_drop_factor: 0.3333333333333333
	rsc_b_drop_factor: 0.3333333333333333
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[VLCS] #envs=4, #classes=5
	env0: C (#1415)
	env1: L (#2656)
	env2: S (#3282)
	env3: V (#3376)

[37m[36mINFO[0m[0m 01/29 23:42:55 | n_steps = 5001
[37m[36mINFO[0m[0m 01/29 23:42:55 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/29 23:42:55 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/29 23:42:55 | 
[37m[36mINFO[0m[0m 01/29 23:42:55 | Testenv name escaping te_C_S_V -> te_C_S_V
[37m[36mINFO[0m[0m 01/29 23:42:55 | Test envs = [0, 2, 3], name = te_C_S_V
[37m[36mINFO[0m[0m 01/29 23:42:55 | Train environments: [1], Test environments: [0, 2, 3]
[37m[36mINFO[0m[0m 01/29 23:42:55 | Batch sizes for each domain: [0, 32, 0, 0] (total=32)
[37m[36mINFO[0m[0m 01/29 23:42:55 | steps-per-epoch for each domain: 66.41 -> min = 66.41
[37m[36mINFO[0m[0m 01/29 23:42:57 | # of params = 23518277
[37m[36mINFO[0m[0m 01/29 23:46:09 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/29 23:46:09 | 0.143250    0.121299    0.147765    0.169492    1.660996    0.094523    0.077739    0.147765    0.169492    0.192688    0.166159    0.142540    0.120000    0           0.000000    2.979122    1.588780    190.760853 
[37m[36mINFO[0m[0m 01/29 23:55:11 | 0.203608    0.200561    0.525647    0.514124    1.207123    0.045936    0.035336    0.525647    0.514124    0.343488    0.330793    0.221399    0.235556    200         3.011765    2.183885    1.782394    185.211544 
[37m[36mINFO[0m[0m 01/30 00:04:14 | 0.217698    0.213340    0.577412    0.581921    1.092174    0.047703    0.038869    0.577412    0.581921    0.362148    0.356707    0.243243    0.244444    400         6.023529    1.705579    1.750674    191.299000 
[37m[36mINFO[0m[0m 01/30 00:13:24 | 0.224697    0.220487    0.599059    0.606403    1.024135    0.047703    0.042403    0.599059    0.606403    0.371668    0.361280    0.254720    0.257778    600         9.035294    1.522072    1.845487    180.920488 
[37m[36mINFO[0m[0m 01/30 00:22:23 | 0.233860    0.230697    0.620706    0.623352    0.987212    0.060954    0.045936    0.620706    0.623352    0.377761    0.376524    0.262866    0.269630    800         12.047059   1.428940    1.722278    193.751049 
[37m[36mINFO[0m[0m 01/30 00:31:02 | 0.242290    0.240623    0.623059    0.617702    0.966937    0.074205    0.063604    0.623059    0.617702    0.384615    0.385671    0.268049    0.272593    1000        15.058824   1.369382    1.663522    186.474039 
[37m[36mINFO[0m[0m 01/30 00:39:49 | 0.246646    0.246577    0.624941    0.625235    0.954071    0.076855    0.063604    0.624941    0.625235    0.386519    0.388720    0.276564    0.287407    1200        18.070588   1.331833    1.722094    181.557065 
[37m[36mINFO[0m[0m 01/30 00:49:04 | 0.251726    0.249279    0.640000    0.613936    0.946559    0.084806    0.067138    0.640000    0.613936    0.395659    0.393293    0.274713    0.287407    1400        21.082353   1.300524    1.869038    180.968655 
[37m[36mINFO[0m[0m 01/30 00:58:04 | 0.252182    0.254754    0.639529    0.627119    0.941831    0.082155    0.067138    0.639529    0.627119    0.393755    0.397866    0.280637    0.299259    1600        24.094118   1.279065    1.775521    185.025972 
[37m[36mINFO[0m[0m 01/30 01:06:23 | 0.255033    0.254754    0.642353    0.632768    0.937530    0.086572    0.067138    0.642353    0.632768    0.396040    0.397866    0.282488    0.299259    1800        27.105882   1.248632    1.628217    172.591141 
[37m[36mINFO[0m[0m 01/30 01:14:37 | 0.257558    0.255277    0.628235    0.630885    0.934993    0.086572    0.067138    0.628235    0.630885    0.402133    0.400915    0.283969    0.297778    2000        30.117647   1.235084    1.618452    170.575011 
[37m[36mINFO[0m[0m 01/30 01:22:52 | 0.258796    0.254203    0.636706    0.642185    0.932980    0.086572    0.067138    0.636706    0.642185    0.402513    0.391768    0.287301    0.303704    2200        33.129412   1.234451    1.565569    181.516403 
[37m[36mINFO[0m[0m 01/30 01:31:17 | 0.260680    0.256236    0.639529    0.625235    0.931279    0.089223    0.067138    0.639529    0.625235    0.404037    0.397866    0.288782    0.303704    2400        36.141176   1.217884    1.632166    178.727676 
[37m[36mINFO[0m[0m 01/30 01:39:18 | 0.260876    0.259375    0.643294    0.647834    0.928292    0.086572    0.070671    0.643294    0.647834    0.400609    0.396341    0.295446    0.311111    2600        39.152941   1.201291    1.503809    179.505198 
[37m[36mINFO[0m[0m 01/30 01:47:37 | 0.262590    0.259840    0.647529    0.649718    0.926840    0.088339    0.070671    0.647529    0.649718    0.402133    0.393293    0.297297    0.315556    2800        42.164706   1.216050    1.573671    184.311199 
[37m[36mINFO[0m[0m 01/30 01:55:50 | 0.261731    0.259797    0.646118    0.642185    0.924353    0.085689    0.070671    0.646118    0.642185    0.391470    0.388720    0.308034    0.320000    3000        45.176471   1.190740    1.552445    181.471307 
[37m[36mINFO[0m[0m 01/30 02:04:37 | 0.260462    0.256891    0.657882    0.651601    0.922898    0.090989    0.070671    0.657882    0.651601    0.396801    0.394817    0.293595    0.305185    3200        48.188235   1.191373    1.673532    192.979455 
[37m[36mINFO[0m[0m 01/30 02:13:38 | 0.260536    0.255847    0.639059    0.623352    0.921918    0.090989    0.077739    0.639059    0.623352    0.404798    0.400915    0.285820    0.288889    3400        51.200000   1.201515    1.769864    186.780024 
[37m[36mINFO[0m[0m 01/30 02:22:51 | 0.259979    0.255729    0.624941    0.619586    0.921196    0.090989    0.074205    0.624941    0.619586    0.411272    0.408537    0.277675    0.284444    3600        54.211765   1.187843    1.810838    191.076639 
[37m[36mINFO[0m[0m 01/30 02:31:36 | 0.262373    0.258417    0.624471    0.617702    0.919706    0.090989    0.077739    0.624471    0.617702    0.416603    0.411585    0.279526    0.285926    3800        57.223529   1.175640    1.745868    175.685517 
[37m[36mINFO[0m[0m 01/30 02:40:46 | 0.267147    0.259898    0.626824    0.623352    0.917973    0.090989    0.077739    0.626824    0.623352    0.425743    0.411585    0.284709    0.290370    4000        60.235294   1.166230    1.768685    196.197450 
[37m[36mINFO[0m[0m 01/30 02:49:55 | 0.263265    0.263441    0.607529    0.593220    0.917391    0.090989    0.077739    0.607529    0.593220    0.419650    0.420732    0.279156    0.291852    4200        63.247059   1.170938    1.796272    189.270436 
[37m[36mINFO[0m[0m 01/30 02:59:18 | 0.263011    0.264457    0.596235    0.593220    0.916442    0.090989    0.077739    0.596235    0.593220    0.418888    0.423780    0.279156    0.291852    4400        66.258824   1.167098    1.804112    202.318996 
[37m[36mINFO[0m[0m 01/30 03:08:41 | 0.272165    0.266475    0.614588    0.602637    0.914982    0.090989    0.077739    0.614588    0.602637    0.434501    0.428354    0.291003    0.293333    4600        69.270588   1.160039    1.814151    200.204036 
[37m[36mINFO[0m[0m 01/30 03:17:16 | 0.268420    0.265502    0.597647    0.593220    0.914159    0.090989    0.077739    0.597647    0.593220    0.429931    0.429878    0.284339    0.288889    4800        72.282353   1.158526    1.690334    176.982704 
[37m[36mINFO[0m[0m 01/30 03:26:23 | 0.273311    0.265981    0.608000    0.596987    0.912799    0.090989    0.077739    0.608000    0.596987    0.438309    0.428354    0.290633    0.291852    5000        75.294118   1.143848    1.786042    190.314118 
[37m[36mINFO[0m[0m 01/30 03:26:24 | Cumulative gradient change saved at train_output/VLCS/RSC/[0, 2, 3]/250129_23-42-55_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/30 03:26:25 | ---
[37m[36mINFO[0m[0m 01/30 03:26:25 | test-domain validation(oracle) = 27.216%
[37m[36mINFO[0m[0m 01/30 03:26:25 | training-domain validation(iid) = 26.046%
[37m[36mINFO[0m[0m 01/30 03:26:25 | last = 27.331%
[37m[36mINFO[0m[0m 01/30 03:26:25 | last (inD) = 59.699%
[37m[36mINFO[0m[0m 01/30 03:26:25 | training-domain validation (iid, inD) = 65.160%
[37m[36mINFO[0m[0m 01/30 03:26:25 | === Summary ===
[37m[36mINFO[0m[0m 01/30 03:26:25 | Command: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm RSC --test_envs 0 2 3 --dataset VLCS
[37m[36mINFO[0m[0m 01/30 03:26:25 | Unique name: 250129_23-42-55_resnet50_sgd
[37m[36mINFO[0m[0m 01/30 03:26:25 | Out path: train_output/VLCS/RSC/[0, 2, 3]/250129_23-42-55_resnet50_sgd
[37m[36mINFO[0m[0m 01/30 03:26:25 | Algorithm: RSC
[37m[36mINFO[0m[0m 01/30 03:26:25 | Dataset: VLCS

[37m[36mINFO[0m[0m 03/15 20:24:53 | Command :: /jsm0707/GENIE/train_all.py B_PACS1_adam config/resnet50_adam.yaml --trial_seed 0 --hparams_seed 16 --algorithm GENIE --test_envs 0 2 3 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_adam.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 16
	in_domain: False
	model_save: None
	mpa: False
	name: B_PACS1_adam
	out_dir: train_output/PACS/GENIE/[0, 2, 3]/250315_20-24-53_B_PACS1_adam
	out_root: train_output/PACS/GENIE/[0, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 2, 3]
	trial_seed: 0
	unique_name: 250315_20-24-53_B_PACS1_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 4.249952708249365e-05
	batch_size: 17
	weight_decay: 9.786966598736845e-06
	momentum: 0.8998816091103917
	convergence_rate: 0.002532172972034822
	moving_avg: 0.9428040906106079
	p: 0.1602194197192816
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/15 20:24:53 | n_steps = 5001
[37m[36mINFO[0m[0m 03/15 20:24:53 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/15 20:24:53 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/15 20:24:53 | 
[37m[36mINFO[0m[0m 03/15 20:24:53 | Testenv name escaping te_A_P_S -> te_A_P_S
[37m[36mINFO[0m[0m 03/15 20:24:53 | Test envs = [0, 2, 3], name = te_A_P_S
[37m[36mINFO[0m[0m 03/15 20:24:53 | Train environments: [1], Test environments: [0, 2, 3]
[37m[36mINFO[0m[0m 03/15 20:24:53 | Batch sizes for each domain: [0, 17, 0, 0] (total=17)
[37m[36mINFO[0m[0m 03/15 20:24:53 | steps-per-epoch for each domain: 110.35 -> min = 110.35
[37m[36mINFO[0m[0m 03/15 20:24:55 | # of params = 23522375
[37m[36mINFO[0m[0m 03/15 20:25:19 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/15 20:25:19 | 0.131245    0.121350    0.142857    0.128205    1.975522    0.216595    0.173594    0.142857    0.128205    0.084581    0.089820    0.092557    0.100637    0           0.000000    2.004642    0.966146    23.125825  
[37m[36mINFO[0m[0m 03/15 20:26:12 | 0.655352    0.636237    0.868870    0.865385    0.381797    0.680293    0.652812    0.868870    0.865385    0.816617    0.802395    0.469148    0.453503    200         1.812367    0.755752    0.151839    22.511337  
[37m[36mINFO[0m[0m 03/15 20:26:59 | 0.756384    0.741515    0.932836    0.933761    0.191656    0.745577    0.718826    0.932836    0.933761    0.892216    0.880240    0.631361    0.625478    400         3.624733    0.283249    0.123077    23.189297  
[37m[36mINFO[0m[0m 03/15 20:27:47 | 0.794502    0.776970    0.953092    0.933761    0.222394    0.760220    0.711491    0.953092    0.933761    0.922904    0.925150    0.700382    0.694268    600         5.437100    0.129580    0.125534    22.892920  
[37m[36mINFO[0m[0m 03/15 20:28:41 | 0.766143    0.757293    0.981876    0.961538    0.148408    0.738255    0.726161    0.981876    0.961538    0.894461    0.892216    0.665712    0.653503    800         7.249467    0.089543    0.149404    23.648098  
[37m[36mINFO[0m[0m 03/15 20:29:27 | 0.731729    0.714176    0.977612    0.955128    0.141459    0.741306    0.689487    0.977612    0.955128    0.875000    0.877246    0.578880    0.575796    1000        9.061834    0.059246    0.113636    22.992203  
[37m[36mINFO[0m[0m 03/15 20:30:16 | 0.755583    0.755377    0.982409    0.957265    0.156122    0.754118    0.743276    0.982409    0.957265    0.889222    0.901198    0.623410    0.621656    1200        10.874200   0.043970    0.125385    24.073277  
[37m[36mINFO[0m[0m 03/15 20:31:10 | 0.768433    0.760125    0.994136    0.965812    0.118685    0.755339    0.740831    0.994136    0.965812    0.915419    0.919162    0.634542    0.620382    1400        12.686567   0.057683    0.150728    24.106980  
[37m[36mINFO[0m[0m 03/15 20:31:58 | 0.814335    0.796744    0.986141    0.950855    0.166770    0.804149    0.757946    0.986141    0.950855    0.946108    0.943114    0.692748    0.689172    1600        14.498934   0.032588    0.120901    24.066040  
[37m[36mINFO[0m[0m 03/15 20:32:48 | 0.772087    0.758749    0.995203    0.967949    0.131274    0.774253    0.735941    0.995203    0.967949    0.915419    0.907186    0.626590    0.633121    1800        16.311301   0.018171    0.125121    24.752443  
[37m[36mINFO[0m[0m 03/15 20:33:41 | 0.802004    0.794830    0.989339    0.972222    0.118848    0.787065    0.782396    0.989339    0.972222    0.923653    0.937126    0.695293    0.664968    2000        18.123667   0.019109    0.146134    23.310567  
[37m[36mINFO[0m[0m 03/15 20:34:29 | 0.824333    0.816166    0.995736    0.976496    0.107047    0.819402    0.794621    0.995736    0.976496    0.934132    0.934132    0.719466    0.719745    2200        19.936034   0.039982    0.119976    24.280121  
[37m[36mINFO[0m[0m 03/15 20:35:18 | 0.780525    0.761475    0.991471    0.963675    0.126418    0.782184    0.770171    0.991471    0.963675    0.914671    0.886228    0.644720    0.628025    2400        21.748401   0.028883    0.125599    23.662719  
[37m[36mINFO[0m[0m 03/15 20:36:07 | 0.791567    0.782828    0.995203    0.967949    0.122025    0.771812    0.755501    0.995203    0.967949    0.905689    0.910180    0.697201    0.682803    2600        23.560768   0.020160    0.144250    20.812649  
[37m[36mINFO[0m[0m 03/15 20:36:53 | 0.805383    0.790562    0.998401    0.974359    0.132940    0.766931    0.738386    0.998401    0.974359    0.917665    0.907186    0.731552    0.726115    2800        25.373134   0.017087    0.119415    21.723487  
[37m[36mINFO[0m[0m 03/15 20:37:40 | 0.812918    0.799505    0.998934    0.965812    0.132065    0.793167    0.777506    0.998934    0.965812    0.927395    0.910180    0.718193    0.710828    3000        27.185501   0.004538    0.123220    22.673105  
[37m[36mINFO[0m[0m 03/15 20:38:34 | 0.803859    0.787916    0.994136    0.970085    0.131561    0.787675    0.772616    0.994136    0.970085    0.907934    0.889222    0.715967    0.701911    3200        28.997868   0.014995    0.158721    22.124308  
[37m[36mINFO[0m[0m 03/15 20:39:23 | 0.822926    0.811979    0.998934    0.965812    0.139226    0.807810    0.787286    0.998934    0.965812    0.928144    0.916168    0.732824    0.732484    3400        30.810235   0.008450    0.124364    24.437413  
[37m[36mINFO[0m[0m 03/15 20:40:14 | 0.805587    0.796005    0.998934    0.970085    0.126374    0.795607    0.784841    0.998934    0.970085    0.921407    0.910180    0.699746    0.692994    3600        32.622601   0.008105    0.126217    25.380891  
[37m[36mINFO[0m[0m 03/15 20:41:07 | 0.790292    0.767798    0.998401    0.970085    0.123465    0.788286    0.762836    0.998401    0.970085    0.912425    0.883234    0.670165    0.657325    3800        34.434968   0.004561    0.152607    22.082134  
[37m[36mINFO[0m[0m 03/15 20:41:54 | 0.775530    0.773392    0.992004    0.961538    0.138321    0.774253    0.765281    0.992004    0.961538    0.920659    0.928144    0.631679    0.626752    4000        36.247335   0.011347    0.123959    22.783935  
[37m[36mINFO[0m[0m 03/15 20:42:44 | 0.763452    0.748724    0.997868    0.970085    0.115615    0.757779    0.760391    0.997868    0.970085    0.903443    0.883234    0.629135    0.602548    4200        38.059701   0.005047    0.125229    24.287490  
[37m[36mINFO[0m[0m 03/15 20:43:37 | 0.816662    0.817428    0.998934    0.965812    0.150296    0.800488    0.784841    0.998934    0.965812    0.925898    0.931138    0.723601    0.736306    4400        39.872068   0.006953    0.154791    22.827823  
[37m[36mINFO[0m[0m 03/15 20:44:24 | 0.797003    0.794021    0.990938    0.959402    0.170655    0.783405    0.782396    0.990938    0.959402    0.911677    0.895210    0.695929    0.704459    4600        41.684435   0.010059    0.121236    22.757400  
[37m[36mINFO[0m[0m 03/15 20:45:13 | 0.815731    0.804004    0.999467    0.972222    0.105039    0.801098    0.789731    0.999467    0.972222    0.924401    0.910180    0.721692    0.712102    4800        43.496802   0.006174    0.128183    23.263101  
[37m[36mINFO[0m[0m 03/15 20:46:07 | 0.786325    0.787386    0.998934    0.963675    0.153581    0.777303    0.772616    0.998934    0.963675    0.904192    0.904192    0.677481    0.685350    5000        45.309168   0.008139    0.154468    23.129449  
[37m[36mINFO[0m[0m 03/15 20:46:07 | Cumulative gradient change saved at train_output/PACS/GENIE/[0, 2, 3]/250315_20-24-53_B_PACS1_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/15 20:46:08 | ---
[37m[36mINFO[0m[0m 03/15 20:46:08 | test-domain validation(oracle) = 81.666%
[37m[36mINFO[0m[0m 03/15 20:46:08 | training-domain validation(iid) = 82.433%
[37m[36mINFO[0m[0m 03/15 20:46:08 | last = 78.633%
[37m[36mINFO[0m[0m 03/15 20:46:08 | last (inD) = 96.368%
[37m[36mINFO[0m[0m 03/15 20:46:08 | training-domain validation (iid, inD) = 97.650%
[37m[36mINFO[0m[0m 03/15 20:46:09 | === Summary ===
[37m[36mINFO[0m[0m 03/15 20:46:09 | Command: /jsm0707/GENIE/train_all.py B_PACS1_adam config/resnet50_adam.yaml --trial_seed 0 --hparams_seed 16 --algorithm GENIE --test_envs 0 2 3 --dataset PACS
[37m[36mINFO[0m[0m 03/15 20:46:09 | Unique name: 250315_20-24-53_B_PACS1_adam
[37m[36mINFO[0m[0m 03/15 20:46:09 | Out path: train_output/PACS/GENIE/[0, 2, 3]/250315_20-24-53_B_PACS1_adam
[37m[36mINFO[0m[0m 03/15 20:46:09 | Algorithm: GENIE
[37m[36mINFO[0m[0m 03/15 20:46:09 | Dataset: PACS

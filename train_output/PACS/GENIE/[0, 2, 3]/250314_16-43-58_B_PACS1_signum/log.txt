[37m[36mINFO[0m[0m 03/14 16:43:58 | Command :: /jsm0707/GENIE/train_all.py B_PACS1_signum config/resnet50_signum.yaml --trial_seed 0 --hparams_seed 16 --algorithm GENIE --test_envs 0 2 3 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_signum.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 16
	in_domain: False
	model_save: None
	mpa: False
	name: B_PACS1_signum
	out_dir: train_output/PACS/GENIE/[0, 2, 3]/250314_16-43-58_B_PACS1_signum
	out_root: train_output/PACS/GENIE/[0, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 2, 3]
	trial_seed: 0
	unique_name: 250314_16-43-58_B_PACS1_signum
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: signum
	freeze_bn: False
	pretrained: True
	lr: 4.249952708249365e-05
	batch_size: 17
	weight_decay: 9.786966598736845e-06
	momentum: 0.8998816091103917
	convergence_rate: 0.002532172972034822
	moving_avg: 0.9428040906106079
	p: 0.1602194197192816
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/14 16:43:58 | n_steps = 5001
[37m[36mINFO[0m[0m 03/14 16:43:58 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/14 16:43:58 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/14 16:43:58 | 
[37m[36mINFO[0m[0m 03/14 16:43:58 | Testenv name escaping te_A_P_S -> te_A_P_S
[37m[36mINFO[0m[0m 03/14 16:43:58 | Test envs = [0, 2, 3], name = te_A_P_S
[37m[36mINFO[0m[0m 03/14 16:43:58 | Train environments: [1], Test environments: [0, 2, 3]
[37m[36mINFO[0m[0m 03/14 16:43:58 | Batch sizes for each domain: [0, 17, 0, 0] (total=17)
[37m[36mINFO[0m[0m 03/14 16:43:58 | steps-per-epoch for each domain: 110.35 -> min = 110.35
[37m[36mINFO[0m[0m 03/14 16:43:59 | # of params = 23522375
[37m[36mINFO[0m[0m 03/14 16:44:24 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/14 16:44:24 | 0.131245    0.121350    0.142857    0.128205    1.975522    0.216595    0.173594    0.142857    0.128205    0.084581    0.089820    0.092557    0.100637    0           0.000000    2.004642    0.936067    24.240663  
[37m[36mINFO[0m[0m 03/14 16:45:13 | 0.655352    0.636237    0.868870    0.865385    0.381797    0.680293    0.652812    0.868870    0.865385    0.816617    0.802395    0.469148    0.453503    200         1.812367    0.755752    0.119605    24.320940  
[37m[36mINFO[0m[0m 03/14 16:46:02 | 0.756384    0.741515    0.932836    0.933761    0.191656    0.745577    0.718826    0.932836    0.933761    0.892216    0.880240    0.631361    0.625478    400         3.624733    0.283249    0.122083    25.289849  
[37m[36mINFO[0m[0m 03/14 16:46:52 | 0.794502    0.776970    0.953092    0.933761    0.222394    0.760220    0.711491    0.953092    0.933761    0.922904    0.925150    0.700382    0.694268    600         5.437100    0.129580    0.120750    25.710413  
[37m[36mINFO[0m[0m 03/14 16:47:42 | 0.766143    0.757293    0.981876    0.961538    0.148408    0.738255    0.726161    0.981876    0.961538    0.894461    0.892216    0.665712    0.653503    800         7.249467    0.089543    0.122369    25.658022  
[37m[36mINFO[0m[0m 03/14 16:48:31 | 0.731729    0.714176    0.977612    0.955128    0.141459    0.741306    0.689487    0.977612    0.955128    0.875000    0.877246    0.578880    0.575796    1000        9.061834    0.059246    0.122962    24.264070  
[37m[36mINFO[0m[0m 03/14 16:49:20 | 0.755583    0.755377    0.982409    0.957265    0.156122    0.754118    0.743276    0.982409    0.957265    0.889222    0.901198    0.623410    0.621656    1200        10.874200   0.043970    0.126346    23.954847  
[37m[36mINFO[0m[0m 03/14 16:50:11 | 0.768433    0.760125    0.994136    0.965812    0.118685    0.755339    0.740831    0.994136    0.965812    0.915419    0.919162    0.634542    0.620382    1400        12.686567   0.057683    0.130129    24.812706  
[37m[36mINFO[0m[0m 03/14 16:51:01 | 0.814335    0.796744    0.986141    0.950855    0.166770    0.804149    0.757946    0.986141    0.950855    0.946108    0.943114    0.692748    0.689172    1600        14.498934   0.032588    0.122141    25.299550  
[37m[36mINFO[0m[0m 03/14 16:51:49 | 0.772087    0.758749    0.995203    0.967949    0.131274    0.774253    0.735941    0.995203    0.967949    0.915419    0.907186    0.626590    0.633121    1800        16.311301   0.018171    0.119135    23.746054  
[37m[36mINFO[0m[0m 03/14 16:52:37 | 0.802004    0.794830    0.989339    0.972222    0.118848    0.787065    0.782396    0.989339    0.972222    0.923653    0.937126    0.695293    0.664968    2000        18.123667   0.019109    0.125342    23.190228  
[37m[36mINFO[0m[0m 03/14 16:53:25 | 0.824333    0.816166    0.995736    0.976496    0.107047    0.819402    0.794621    0.995736    0.976496    0.934132    0.934132    0.719466    0.719745    2200        19.936034   0.039982    0.120785    23.911782  
[37m[36mINFO[0m[0m 03/14 16:54:13 | 0.780525    0.761475    0.991471    0.963675    0.126418    0.782184    0.770171    0.991471    0.963675    0.914671    0.886228    0.644720    0.628025    2400        21.748401   0.028883    0.121250    24.076989  
[37m[36mINFO[0m[0m 03/14 16:55:01 | 0.791567    0.782828    0.995203    0.967949    0.122025    0.771812    0.755501    0.995203    0.967949    0.905689    0.910180    0.697201    0.682803    2600        23.560768   0.020160    0.122458    22.850314  
[37m[36mINFO[0m[0m 03/14 16:55:54 | 0.805383    0.790562    0.998401    0.974359    0.132940    0.766931    0.738386    0.998401    0.974359    0.917665    0.907186    0.731552    0.726115    2800        25.373134   0.017087    0.130075    26.978244  
[37m[36mINFO[0m[0m 03/14 16:56:42 | 0.812918    0.799505    0.998934    0.965812    0.132065    0.793167    0.777506    0.998934    0.965812    0.927395    0.910180    0.718193    0.710828    3000        27.185501   0.004538    0.120309    23.912577  
[37m[36mINFO[0m[0m 03/14 16:57:30 | 0.803859    0.787916    0.994136    0.970085    0.131561    0.787675    0.772616    0.994136    0.970085    0.907934    0.889222    0.715967    0.701911    3200        28.997868   0.014995    0.120595    23.871903  
[37m[36mINFO[0m[0m 03/14 16:58:17 | 0.822926    0.811979    0.998934    0.965812    0.139226    0.807810    0.787286    0.998934    0.965812    0.928144    0.916168    0.732824    0.732484    3400        30.810235   0.008450    0.119913    23.682153  
[37m[36mINFO[0m[0m 03/14 16:59:06 | 0.805587    0.796005    0.998934    0.970085    0.126374    0.795607    0.784841    0.998934    0.970085    0.921407    0.910180    0.699746    0.692994    3600        32.622601   0.008105    0.120852    24.441574  
[37m[36mINFO[0m[0m 03/14 16:59:55 | 0.790292    0.767798    0.998401    0.970085    0.123465    0.788286    0.762836    0.998401    0.970085    0.912425    0.883234    0.670165    0.657325    3800        34.434968   0.004561    0.120916    25.028506  
[37m[36mINFO[0m[0m 03/14 17:00:44 | 0.775530    0.773392    0.992004    0.961538    0.138321    0.774253    0.765281    0.992004    0.961538    0.920659    0.928144    0.631679    0.626752    4000        36.247335   0.011347    0.124259    24.100685  
[37m[36mINFO[0m[0m 03/14 17:01:33 | 0.763452    0.748724    0.997868    0.970085    0.115615    0.757779    0.760391    0.997868    0.970085    0.903443    0.883234    0.629135    0.602548    4200        38.059701   0.005047    0.123356    24.085890  
[37m[36mINFO[0m[0m 03/14 17:02:21 | 0.816662    0.817428    0.998934    0.965812    0.150296    0.800488    0.784841    0.998934    0.965812    0.925898    0.931138    0.723601    0.736306    4400        39.872068   0.006953    0.120086    24.595193  
[37m[36mINFO[0m[0m 03/14 17:03:11 | 0.797003    0.794021    0.990938    0.959402    0.170655    0.783405    0.782396    0.990938    0.959402    0.911677    0.895210    0.695929    0.704459    4600        41.684435   0.010059    0.126069    24.319852  
[37m[36mINFO[0m[0m 03/14 17:04:00 | 0.815731    0.804004    0.999467    0.972222    0.105039    0.801098    0.789731    0.999467    0.972222    0.924401    0.910180    0.721692    0.712102    4800        43.496802   0.006174    0.122612    24.588796  
[37m[36mINFO[0m[0m 03/14 17:04:47 | 0.786325    0.787386    0.998934    0.963675    0.153581    0.777303    0.772616    0.998934    0.963675    0.904192    0.904192    0.677481    0.685350    5000        45.309168   0.008139    0.123461    22.381497  
[37m[36mINFO[0m[0m 03/14 17:04:47 | Cumulative gradient change saved at train_output/PACS/GENIE/[0, 2, 3]/250314_16-43-58_B_PACS1_signum/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/14 17:04:49 | ---
[37m[36mINFO[0m[0m 03/14 17:04:49 | test-domain validation(oracle) = 81.666%
[37m[36mINFO[0m[0m 03/14 17:04:49 | training-domain validation(iid) = 82.433%
[37m[36mINFO[0m[0m 03/14 17:04:49 | last = 78.633%
[37m[36mINFO[0m[0m 03/14 17:04:49 | last (inD) = 96.368%
[37m[36mINFO[0m[0m 03/14 17:04:49 | training-domain validation (iid, inD) = 97.650%
[37m[36mINFO[0m[0m 03/14 17:04:49 | === Summary ===
[37m[36mINFO[0m[0m 03/14 17:04:49 | Command: /jsm0707/GENIE/train_all.py B_PACS1_signum config/resnet50_signum.yaml --trial_seed 0 --hparams_seed 16 --algorithm GENIE --test_envs 0 2 3 --dataset PACS
[37m[36mINFO[0m[0m 03/14 17:04:49 | Unique name: 250314_16-43-58_B_PACS1_signum
[37m[36mINFO[0m[0m 03/14 17:04:49 | Out path: train_output/PACS/GENIE/[0, 2, 3]/250314_16-43-58_B_PACS1_signum
[37m[36mINFO[0m[0m 03/14 17:04:49 | Algorithm: GENIE
[37m[36mINFO[0m[0m 03/14 17:04:49 | Dataset: PACS

[37m[36mINFO[0m[0m 03/15 00:01:19 | Command :: /jsm0707/GENIE/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm GENIE --test_envs 3 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_adam.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_adam
	out_dir: train_output/PACS/GENIE/[3]/250315_00-01-19_resnet50_adam
	out_root: train_output/PACS/GENIE/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250315_00-01-19_resnet50_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	momentum: 0.9
	convergence_rate: 0.015
	moving_avg: 0.95
	p: 0.4
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/15 00:01:19 | n_steps = 5001
[37m[36mINFO[0m[0m 03/15 00:01:19 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/15 00:01:19 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/15 00:01:19 | 
[37m[36mINFO[0m[0m 03/15 00:01:19 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 03/15 00:01:19 | Test envs = [3], name = te_S
[37m[36mINFO[0m[0m 03/15 00:01:19 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/15 00:01:19 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 03/15 00:01:19 | steps-per-epoch for each domain: 51.22, 58.62, 41.75 -> min = 41.75
[37m[36mINFO[0m[0m 03/15 00:01:20 | # of params = 23522375
[37m[36mINFO[0m[0m 03/15 00:01:52 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/15 00:01:52 | 0.060751    0.063694    0.316992    0.300709    1.846104    0.272117    0.261614    0.261194    0.239316    0.417665    0.401198    0.060751    0.063694    0           0.000000    1.999146    1.011330    31.191234  
[37m[36mINFO[0m[0m 03/15 00:03:41 | 0.714059    0.723567    0.958957    0.949619    0.137575    0.959732    0.926650    0.925373    0.940171    0.991766    0.982036    0.714059    0.723567    200         4.790419    0.273338    0.386963    31.342295  
[37m[36mINFO[0m[0m 03/15 00:05:03 | 0.745229    0.735032    0.978786    0.961308    0.121861    0.977425    0.943765    0.966418    0.955128    0.992515    0.985030    0.745229    0.735032    400         9.580838    0.074842    0.248517    32.100058  
[37m[36mINFO[0m[0m 03/15 00:06:40 | 0.740458    0.732484    0.986008    0.959678    0.139633    0.979256    0.938875    0.984009    0.955128    0.994760    0.985030    0.740458    0.732484    600         14.371257   0.047027    0.324746    32.368723  
[37m[36mINFO[0m[0m 03/15 00:08:11 | 0.769402    0.770701    0.989407    0.970083    0.098069    0.982306    0.955990    0.990405    0.972222    0.995509    0.982036    0.769402    0.770701    800         19.161677   0.027693    0.293780    32.406026  
[37m[36mINFO[0m[0m 03/15 00:09:32 | 0.711196    0.723567    0.997866    0.969230    0.096577    0.995729    0.955990    0.997868    0.963675    1.000000    0.988024    0.711196    0.723567    1000        23.952096   0.025086    0.235713    33.165406  
[37m[36mINFO[0m[0m 03/15 00:11:20 | 0.720420    0.736306    0.994441    0.958517    0.140471    0.992068    0.931540    0.992004    0.952991    0.999251    0.991018    0.720420    0.736306    1200        28.742515   0.018968    0.368987    34.385680  
[37m[36mINFO[0m[0m 03/15 00:12:42 | 0.659987    0.676433    0.993873    0.956074    0.168501    0.996339    0.941320    0.988273    0.950855    0.997006    0.976048    0.659987    0.676433    1400        33.532934   0.015558    0.241793    33.541881  
[37m[36mINFO[0m[0m 03/15 00:14:23 | 0.709924    0.696815    0.996246    0.971652    0.120122    0.996949    0.955990    0.992537    0.967949    0.999251    0.991018    0.709924    0.696815    1600        38.323353   0.011760    0.342114    32.890339  
[37m[36mINFO[0m[0m 03/15 00:15:53 | 0.756997    0.785987    0.998450    0.972387    0.115386    0.996949    0.963325    0.998401    0.965812    1.000000    0.988024    0.756997    0.785987    1800        43.113772   0.011071    0.280588    33.912702  
[37m[36mINFO[0m[0m 03/15 00:17:15 | 0.763677    0.768153    0.998108    0.971896    0.106774    0.998170    0.958435    0.998401    0.972222    0.997754    0.985030    0.763677    0.768153    2000        47.904192   0.009645    0.246715    32.930209  
[37m[36mINFO[0m[0m 03/15 00:19:01 | 0.735369    0.721019    0.999009    0.966644    0.136772    0.997559    0.948655    0.999467    0.957265    1.000000    0.994012    0.735369    0.721019    2200        52.694611   0.008670    0.362962    32.977964  
[37m[36mINFO[0m[0m 03/15 00:20:22 | 0.729644    0.741401    0.997165    0.965992    0.157789    0.999390    0.953545    0.993603    0.959402    0.998503    0.985030    0.729644    0.741401    2400        57.485030   0.008660    0.238697    33.061888  
[37m[36mINFO[0m[0m 03/15 00:22:08 | 0.730916    0.729936    0.995441    0.970228    0.152459    0.993899    0.955990    0.994670    0.963675    0.997754    0.991018    0.730916    0.729936    2600        62.275449   0.006886    0.362434    33.603444  
[37m[36mINFO[0m[0m 03/15 00:23:31 | 0.696565    0.698089    0.999264    0.967211    0.157065    0.999390    0.948655    0.998401    0.967949    1.000000    0.985030    0.696565    0.698089    2800        67.065868   0.008429    0.255936    32.299066  
[37m[36mINFO[0m[0m 03/15 00:24:55 | 0.742366    0.749045    0.999619    0.971896    0.120087    0.999390    0.958435    0.999467    0.972222    1.000000    0.985030    0.742366    0.749045    3000        71.856287   0.004383    0.253476    32.909095  
[37m[36mINFO[0m[0m 03/15 00:26:39 | 0.704517    0.704459    0.999264    0.967843    0.147853    0.999390    0.953545    0.998401    0.967949    1.000000    0.982036    0.704517    0.704459    3200        76.646707   0.008804    0.358814    32.259278  
[37m[36mINFO[0m[0m 03/15 00:27:59 | 0.701018    0.718471    0.997562    0.975236    0.133190    0.996949    0.963325    0.995736    0.974359    1.000000    0.988024    0.701018    0.718471    3400        81.437126   0.003636    0.235204    33.337871  
[37m[36mINFO[0m[0m 03/15 00:29:38 | 0.753817    0.773248    0.999619    0.972182    0.113728    0.999390    0.958435    0.999467    0.970085    1.000000    0.988024    0.753817    0.773248    3600        86.227545   0.003758    0.329363    32.958450  
[37m[36mINFO[0m[0m 03/15 00:31:10 | 0.704835    0.729936    0.995538    0.960714    0.143857    0.994509    0.936430    0.993603    0.963675    0.998503    0.982036    0.704835    0.729936    3800        91.017964   0.005855    0.294515    32.772170  
[37m[36mINFO[0m[0m 03/15 00:32:29 | 0.796756    0.805096    0.999186    0.976234    0.108248    0.997559    0.963325    1.000000    0.974359    1.000000    0.991018    0.796756    0.805096    4000        95.808383   0.007316    0.236967    31.900528  
[37m[36mINFO[0m[0m 03/15 00:34:18 | 0.789122    0.784713    0.999212    0.979715    0.097282    0.998170    0.968215    0.999467    0.982906    1.000000    0.988024    0.789122    0.784713    4200        100.598802  0.003476    0.379383    32.792768  
[37m[36mINFO[0m[0m 03/15 00:35:36 | 0.774173    0.791083    0.999395    0.973446    0.110195    1.000000    0.968215    0.998934    0.970085    0.999251    0.982036    0.774173    0.791083    4400        105.389222  0.003241    0.236599    31.278175  
[37m[36mINFO[0m[0m 03/15 00:37:16 | 0.713740    0.731210    0.999593    0.969290    0.145502    0.998780    0.960880    1.000000    0.967949    1.000000    0.979042    0.713740    0.731210    4600        110.179641  0.006122    0.338008    32.371680  
[37m[36mINFO[0m[0m 03/15 00:38:44 | 0.756361    0.760510    0.998937    0.973629    0.110971    0.997559    0.965770    1.000000    0.970085    0.999251    0.985030    0.756361    0.760510    4800        114.970060  0.003864    0.279768    31.515821  
[37m[36mINFO[0m[0m 03/15 00:40:04 | 0.766539    0.778344    0.999547    0.971001    0.135528    0.999390    0.960880    1.000000    0.970085    0.999251    0.982036    0.766539    0.778344    5000        119.760479  0.001562    0.237514    32.268079  
[37m[36mINFO[0m[0m 03/15 00:40:04 | Cumulative gradient change saved at train_output/PACS/GENIE/[3]/250315_00-01-19_resnet50_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/15 00:40:05 | ---
[37m[36mINFO[0m[0m 03/15 00:40:05 | test-domain validation(oracle) = 79.676%
[37m[36mINFO[0m[0m 03/15 00:40:05 | training-domain validation(iid) = 78.912%
[37m[36mINFO[0m[0m 03/15 00:40:05 | last = 76.654%
[37m[36mINFO[0m[0m 03/15 00:40:05 | last (inD) = 97.100%
[37m[36mINFO[0m[0m 03/15 00:40:05 | training-domain validation (iid, inD) = 97.972%
[37m[36mINFO[0m[0m 03/15 00:40:05 | === Summary ===
[37m[36mINFO[0m[0m 03/15 00:40:05 | Command: /jsm0707/GENIE/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm GENIE --test_envs 3 --dataset PACS
[37m[36mINFO[0m[0m 03/15 00:40:05 | Unique name: 250315_00-01-19_resnet50_adam
[37m[36mINFO[0m[0m 03/15 00:40:05 | Out path: train_output/PACS/GENIE/[3]/250315_00-01-19_resnet50_adam
[37m[36mINFO[0m[0m 03/15 00:40:05 | Algorithm: GENIE
[37m[36mINFO[0m[0m 03/15 00:40:05 | Dataset: PACS

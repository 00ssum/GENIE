[37m[36mINFO[0m[0m 03/13 19:43:29 | Command :: /jsm0707/GENIE/train_all.py B_PACS0_signum config/resnet50_signum.yaml --trial_seed 2 --hparams_seed 9 --algorithm GENIE --test_envs 0 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_signum.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 9
	in_domain: False
	model_save: None
	mpa: False
	name: B_PACS0_signum
	out_dir: train_output/PACS/GENIE/[0]/250313_19-43-29_B_PACS0_signum
	out_root: train_output/PACS/GENIE/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 2
	unique_name: 250313_19-43-29_B_PACS0_signum
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: signum
	freeze_bn: False
	pretrained: True
	lr: 2.716671579524612e-05
	batch_size: 29
	weight_decay: 1.71368232883332e-06
	momentum: 0.9092933546128503
	convergence_rate: 0.02426611940613899
	moving_avg: 0.947722940872739
	p: 0.5933807106679234
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/13 19:43:29 | n_steps = 5001
[37m[36mINFO[0m[0m 03/13 19:43:29 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/13 19:43:29 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/13 19:43:29 | 
[37m[36mINFO[0m[0m 03/13 19:43:29 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/13 19:43:29 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/13 19:43:29 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/13 19:43:29 | Batch sizes for each domain: [0, 29, 29, 29] (total=87)
[37m[36mINFO[0m[0m 03/13 19:43:29 | steps-per-epoch for each domain: 64.69, 46.07, 108.41 -> min = 46.07
[37m[36mINFO[0m[0m 03/13 19:43:30 | # of params = 23522375
[37m[36mINFO[0m[0m 03/13 19:44:02 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/13 19:44:02 | 0.206833    0.217604    0.197879    0.207606    1.874971    0.206833    0.217604    0.231876    0.245726    0.163922    0.179641    0.197837    0.197452    0           0.000000    1.997630    1.025310    30.848614  
[37m[36mINFO[0m[0m 03/13 19:45:15 | 0.825503    0.821516    0.932558    0.925748    0.212484    0.825503    0.821516    0.903518    0.920940    0.983533    0.976048    0.910623    0.880255    200         4.341317    0.322115    0.207949    31.987633  
[37m[36mINFO[0m[0m 03/13 19:46:31 | 0.885296    0.887531    0.977802    0.963365    0.110969    0.885296    0.887531    0.963753    0.955128    0.997006    0.991018    0.972646    0.943949    400         8.682635    0.096133    0.216253    32.292503  
[37m[36mINFO[0m[0m 03/13 19:47:43 | 0.838926    0.838631    0.984828    0.962518    0.108996    0.838926    0.838631    0.982942    0.959402    0.994760    0.988024    0.976781    0.940127    600         13.023952   0.062445    0.207554    30.977885  
[37m[36mINFO[0m[0m 03/13 19:48:58 | 0.873703    0.872861    0.994119    0.966490    0.099826    0.873703    0.872861    0.994670    0.963675    0.998503    0.988024    0.989186    0.947771    800         17.365269   0.047449    0.210741    32.325105  
[37m[36mINFO[0m[0m 03/13 19:50:11 | 0.824893    0.826406    0.989651    0.961966    0.121508    0.824893    0.826406    0.989872    0.959402    0.996257    0.994012    0.982824    0.932484    1000        21.706587   0.029315    0.210867    31.327313  
[37m[36mINFO[0m[0m 03/13 19:51:25 | 0.866382    0.843521    0.991744    0.972609    0.104548    0.866382    0.843521    0.990405    0.972222    0.998503    0.994012    0.986323    0.951592    1200        26.047904   0.026139    0.208527    31.513486  
[37m[36mINFO[0m[0m 03/13 19:52:36 | 0.814521    0.799511    0.989290    0.962504    0.131354    0.814521    0.799511    0.985608    0.952991    0.996257    0.988024    0.986005    0.946497    1400        30.389222   0.023977    0.206995    30.159339  
[37m[36mINFO[0m[0m 03/13 19:53:49 | 0.845027    0.828851    0.993057    0.971470    0.101907    0.845027    0.828851    0.990938    0.965812    1.000000    0.997006    0.988232    0.951592    1600        34.730539   0.019790    0.209916    31.251517  
[37m[36mINFO[0m[0m 03/13 19:55:00 | 0.862111    0.867971    0.997487    0.974333    0.095696    0.862111    0.867971    0.997868    0.980769    1.000000    0.997006    0.994593    0.945223    1800        39.071856   0.016415    0.207107    29.613199  
[37m[36mINFO[0m[0m 03/13 19:56:15 | 0.881025    0.885086    0.998229    0.967779    0.097342    0.881025    0.885086    0.997868    0.974359    1.000000    0.985030    0.996819    0.943949    2000        43.413174   0.015064    0.210259    32.623623  
[37m[36mINFO[0m[0m 03/13 19:57:29 | 0.865772    0.882641    0.993262    0.967353    0.104280    0.865772    0.882641    0.992004    0.970085    0.997006    0.988024    0.990776    0.943949    2200        47.754491   0.014188    0.220154    30.180071  
[37m[36mINFO[0m[0m 03/13 19:58:44 | 0.877974    0.894866    0.998725    0.973194    0.088225    0.877974    0.894866    0.998401    0.974359    1.000000    1.000000    0.997774    0.945223    2400        52.095808   0.016755    0.211779    32.628880  
[37m[36mINFO[0m[0m 03/13 20:00:01 | 0.866992    0.855746    0.997453    0.966664    0.142184    0.866992    0.855746    0.998401    0.972222    1.000000    0.994012    0.993957    0.933758    2600        56.437126   0.007570    0.223295    32.331547  
[37m[36mINFO[0m[0m 03/13 20:01:17 | 0.896278    0.877751    0.996636    0.975194    0.104441    0.896278    0.877751    0.996269    0.982906    1.000000    1.000000    0.993639    0.942675    2800        60.778443   0.010757    0.217290    32.660643  
[37m[36mINFO[0m[0m 03/13 20:02:30 | 0.876144    0.889976    0.997736    0.965502    0.131608    0.876144    0.889976    0.998934    0.961538    1.000000    0.991018    0.994275    0.943949    3000        65.119760   0.005662    0.209116    30.830988  
[37m[36mINFO[0m[0m 03/13 20:03:44 | 0.865162    0.867971    0.997802    0.969210    0.118027    0.865162    0.867971    0.998401    0.967949    0.998503    0.997006    0.996501    0.942675    3200        69.461078   0.009315    0.210245    31.759219  
[37m[36mINFO[0m[0m 03/13 20:04:59 | 0.873703    0.875306    0.998722    0.974896    0.107740    0.873703    0.875306    0.998934    0.982906    0.998503    0.994012    0.998728    0.947771    3400        73.802395   0.006237    0.215799    32.360764  
[37m[36mINFO[0m[0m 03/13 20:06:15 | 0.846248    0.870416    0.999255    0.973458    0.105308    0.846248    0.870416    0.998401    0.972222    1.000000    0.994012    0.999364    0.954140    3600        78.143713   0.007149    0.218785    31.334242  
[37m[36mINFO[0m[0m 03/13 20:07:30 | 0.893228    0.907090    0.999398    0.978716    0.097374    0.893228    0.907090    0.999467    0.978632    1.000000    0.997006    0.998728    0.960510    3800        82.485030   0.006298    0.222310    31.031792  
[37m[36mINFO[0m[0m 03/13 20:08:46 | 0.861501    0.865526    0.996168    0.964218    0.160056    0.861501    0.865526    0.996269    0.963675    0.997006    0.985030    0.995229    0.943949    4000        86.826347   0.006864    0.219449    32.550134  
[37m[36mINFO[0m[0m 03/13 20:10:00 | 0.890177    0.889976    0.999398    0.971902    0.095239    0.890177    0.889976    0.999467    0.982906    1.000000    0.985030    0.998728    0.947771    4200        91.167665   0.008610    0.216214    30.685484  
[37m[36mINFO[0m[0m 03/13 20:11:18 | 0.897498    0.880196    0.998974    0.977295    0.098701    0.897498    0.880196    0.999467    0.982906    1.000000    0.991018    0.997455    0.957962    4400        95.508982   0.005611    0.217789    34.211177  
[37m[36mINFO[0m[0m 03/13 20:12:35 | 0.871873    0.892421    0.998335    0.971611    0.096030    0.871873    0.892421    0.997868    0.972222    1.000000    0.991018    0.997137    0.951592    4600        99.850299   0.006587    0.221667    32.009061  
[37m[36mINFO[0m[0m 03/13 20:13:50 | 0.882855    0.872861    0.999149    0.973622    0.113699    0.882855    0.872861    0.999467    0.982906    0.999251    0.994012    0.998728    0.943949    4800        104.191617  0.003729    0.216577    32.091602  
[37m[36mINFO[0m[0m 03/13 20:15:06 | 0.875534    0.882641    0.999008    0.971760    0.127499    0.875534    0.882641    1.000000    0.972222    0.999251    0.994012    0.997774    0.949045    5000        108.532934  0.002642    0.218201    32.938227  
[37m[36mINFO[0m[0m 03/13 20:15:07 | Cumulative gradient change saved at train_output/PACS/GENIE/[0]/250313_19-43-29_B_PACS0_signum/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/13 20:15:08 | ---
[37m[36mINFO[0m[0m 03/13 20:15:08 | test-domain validation(oracle) = 89.323%
[37m[36mINFO[0m[0m 03/13 20:15:08 | training-domain validation(iid) = 89.323%
[37m[36mINFO[0m[0m 03/13 20:15:08 | last = 87.553%
[37m[36mINFO[0m[0m 03/13 20:15:08 | last (inD) = 97.176%
[37m[36mINFO[0m[0m 03/13 20:15:08 | training-domain validation (iid, inD) = 97.872%
[37m[36mINFO[0m[0m 03/13 20:15:08 | === Summary ===
[37m[36mINFO[0m[0m 03/13 20:15:08 | Command: /jsm0707/GENIE/train_all.py B_PACS0_signum config/resnet50_signum.yaml --trial_seed 2 --hparams_seed 9 --algorithm GENIE --test_envs 0 --dataset PACS
[37m[36mINFO[0m[0m 03/13 20:15:08 | Unique name: 250313_19-43-29_B_PACS0_signum
[37m[36mINFO[0m[0m 03/13 20:15:08 | Out path: train_output/PACS/GENIE/[0]/250313_19-43-29_B_PACS0_signum
[37m[36mINFO[0m[0m 03/13 20:15:08 | Algorithm: GENIE
[37m[36mINFO[0m[0m 03/13 20:15:08 | Dataset: PACS

[37m[36mINFO[0m[0m 03/14 23:09:41 | Command :: /jsm0707/GENIE/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm GENIE --test_envs 0 1 3 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_adam.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_adam
	out_dir: train_output/PACS/GENIE/[0, 1, 3]/250314_23-09-41_resnet50_adam
	out_root: train_output/PACS/GENIE/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 0
	unique_name: 250314_23-09-41_resnet50_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	momentum: 0.9
	convergence_rate: 0.015
	moving_avg: 0.95
	p: 0.4
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/14 23:09:41 | n_steps = 5001
[37m[36mINFO[0m[0m 03/14 23:09:41 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/14 23:09:41 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/14 23:09:41 | 
[37m[36mINFO[0m[0m 03/14 23:09:41 | Testenv name escaping te_A_C_S -> te_A_C_S
[37m[36mINFO[0m[0m 03/14 23:09:41 | Test envs = [0, 1, 3], name = te_A_C_S
[37m[36mINFO[0m[0m 03/14 23:09:41 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 03/14 23:09:41 | Batch sizes for each domain: [0, 0, 32, 0] (total=32)
[37m[36mINFO[0m[0m 03/14 23:09:41 | steps-per-epoch for each domain: 41.75 -> min = 41.75
[37m[36mINFO[0m[0m 03/14 23:09:43 | # of params = 23522375
[37m[36mINFO[0m[0m 03/14 23:10:09 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/14 23:10:09 | 0.145707    0.139213    0.266467    0.236527    1.756340    0.223917    0.202934    0.172175    0.175214    0.266467    0.236527    0.041031    0.039490    0           0.000000    1.968217    2.034599    24.286503  
[37m[36mINFO[0m[0m 03/14 23:11:03 | 0.440050    0.449871    0.973054    0.952096    0.222143    0.616229    0.618582    0.353412    0.371795    0.973054    0.952096    0.350509    0.359236    200         4.790419    0.121791    0.154247    22.851835  
[37m[36mINFO[0m[0m 03/14 23:12:21 | 0.413035    0.408669    0.998503    0.979042    0.094133    0.622331    0.618582    0.315565    0.299145    0.998503    0.979042    0.301209    0.308280    400         9.580838    0.018737    0.276154    22.410333  
[37m[36mINFO[0m[0m 03/14 23:13:52 | 0.471211    0.480820    1.000000    0.988024    0.079431    0.702257    0.713936    0.378998    0.378205    1.000000    0.988024    0.332379    0.350318    600         14.371257   0.002866    0.333766    24.466622  
[37m[36mINFO[0m[0m 03/14 23:15:13 | 0.384991    0.390390    0.964820    0.946108    0.175434    0.652837    0.655257    0.271855    0.264957    0.964820    0.946108    0.230280    0.250955    800         19.161677   0.004068    0.293221    22.790639  
[37m[36mINFO[0m[0m 03/14 23:16:14 | 0.444202    0.437412    1.000000    0.976048    0.069709    0.655278    0.640587    0.395522    0.382479    1.000000    0.976048    0.281807    0.289172    1000        23.952096   0.033748    0.191659    22.427244  
[37m[36mINFO[0m[0m 03/14 23:17:24 | 0.467818    0.466896    1.000000    0.976048    0.082835    0.693716    0.691932    0.408849    0.408120    1.000000    0.976048    0.300891    0.300637    1200        28.742515   0.001221    0.232081    22.920146  
[37m[36mINFO[0m[0m 03/14 23:18:45 | 0.466751    0.463842    1.000000    0.979042    0.076483    0.701037    0.696822    0.404051    0.401709    1.000000    0.979042    0.295165    0.292994    1400        33.532934   0.000093    0.300548    21.778735  
[37m[36mINFO[0m[0m 03/14 23:20:08 | 0.475833    0.473108    0.999251    0.979042    0.077609    0.713850    0.704156    0.406716    0.414530    0.999251    0.979042    0.306934    0.300637    1600        38.323353   0.000137    0.299254    22.494863  
[37m[36mINFO[0m[0m 03/14 23:21:19 | 0.472533    0.474758    1.000000    0.982036    0.058430    0.688225    0.696822    0.412580    0.410256    1.000000    0.982036    0.316794    0.317197    1800        43.113772   0.001060    0.234012    24.368919  
[37m[36mINFO[0m[0m 03/14 23:22:17 | 0.495189    0.499559    0.999251    0.973054    0.131265    0.619280    0.630807    0.400320    0.388889    0.999251    0.973054    0.465967    0.478981    2000        47.904192   0.000745    0.178464    22.348330  
[37m[36mINFO[0m[0m 03/14 23:23:36 | 0.455380    0.450110    1.000000    0.985030    0.071162    0.673581    0.679707    0.369403    0.354701    1.000000    0.985030    0.323155    0.315924    2200        52.694611   0.000304    0.281187    22.806946  
[37m[36mINFO[0m[0m 03/14 23:25:01 | 0.470497    0.467896    1.000000    0.985030    0.072732    0.691275    0.696822    0.385928    0.378205    1.000000    0.985030    0.334288    0.328662    2400        57.485030   0.000039    0.314878    22.230652  
[37m[36mINFO[0m[0m 03/14 23:26:13 | 0.478093    0.479573    1.000000    0.985030    0.067781    0.695546    0.704156    0.398721    0.393162    1.000000    0.985030    0.340013    0.341401    2600        62.275449   0.000027    0.246195    22.360966  
[37m[36mINFO[0m[0m 03/14 23:27:12 | 0.478153    0.478334    1.000000    0.985030    0.070811    0.696156    0.701711    0.397655    0.393162    1.000000    0.985030    0.340649    0.340127    2800        67.065868   0.000016    0.174649    24.672611  
[37m[36mINFO[0m[0m 03/14 23:28:13 | 0.477460    0.474889    1.000000    0.985030    0.072046    0.692495    0.694377    0.396055    0.388889    1.000000    0.985030    0.343830    0.341401    3000        71.856287   0.000020    0.190586    22.112932  
[37m[36mINFO[0m[0m 03/14 23:29:07 | 0.479383    0.473327    1.000000    0.985030    0.072890    0.694326    0.694377    0.398721    0.386752    1.000000    0.985030    0.345102    0.338854    3200        76.646707   0.000011    0.156112    22.787521  
[37m[36mINFO[0m[0m 03/14 23:30:04 | 0.470176    0.472540    1.000000    0.979042    0.074124    0.687614    0.696822    0.375267    0.365385    1.000000    0.979042    0.347646    0.355414    3400        81.437126   0.000503    0.178727    21.807010  
[37m[36mINFO[0m[0m 03/14 23:31:10 | 0.507090    0.508386    1.000000    0.976048    0.109284    0.673581    0.682152    0.430704    0.418803    1.000000    0.976048    0.416985    0.424204    3600        86.227545   0.000114    0.211731    23.124725  
[37m[36mINFO[0m[0m 03/14 23:32:19 | 0.442972    0.441844    0.994760    0.973054    0.078151    0.676022    0.691932    0.367271    0.341880    0.994760    0.973054    0.285623    0.291720    3800        91.017964   0.004106    0.233120    22.297441  
[37m[36mINFO[0m[0m 03/14 23:33:25 | 0.484415    0.483374    1.000000    0.976048    0.095637    0.691275    0.696822    0.401919    0.401709    1.000000    0.976048    0.360051    0.351592    4000        95.808383   0.002490    0.220344    21.800237  
[37m[36mINFO[0m[0m 03/14 23:34:26 | 0.465896    0.462986    1.000000    0.988024    0.053423    0.709579    0.704156    0.389126    0.380342    1.000000    0.988024    0.298982    0.304459    4200        100.598802  0.000344    0.195474    22.693642  
[37m[36mINFO[0m[0m 03/14 23:35:21 | 0.458427    0.453719    1.000000    0.988024    0.058901    0.710799    0.706601    0.373134    0.365385    1.000000    0.988024    0.291349    0.289172    4400        105.389222  0.000085    0.155947    23.393803  
[37m[36mINFO[0m[0m 03/14 23:36:17 | 0.463325    0.459493    1.000000    0.985030    0.080715    0.705308    0.709046    0.380597    0.367521    1.000000    0.985030    0.304071    0.301911    4600        110.179641  0.000060    0.169914    22.138729  
[37m[36mINFO[0m[0m 03/14 23:37:21 | 0.460406    0.453076    1.000000    0.982036    0.079921    0.701647    0.701711    0.378998    0.363248    1.000000    0.982036    0.300573    0.294268    4800        114.970060  0.000034    0.203114    23.762573  
[37m[36mINFO[0m[0m 03/14 23:38:29 | 0.462426    0.453925    1.000000    0.979042    0.075322    0.704088    0.701711    0.381663    0.363248    1.000000    0.979042    0.301527    0.296815    5000        119.760479  0.000005    0.228724    22.111126  
[37m[36mINFO[0m[0m 03/14 23:38:29 | Cumulative gradient change saved at train_output/PACS/GENIE/[0, 1, 3]/250314_23-09-41_resnet50_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/14 23:38:31 | ---
[37m[36mINFO[0m[0m 03/14 23:38:31 | test-domain validation(oracle) = 50.709%
[37m[36mINFO[0m[0m 03/14 23:38:31 | training-domain validation(iid) = 47.121%
[37m[36mINFO[0m[0m 03/14 23:38:31 | last = 46.243%
[37m[36mINFO[0m[0m 03/14 23:38:31 | last (inD) = 97.904%
[37m[36mINFO[0m[0m 03/14 23:38:31 | training-domain validation (iid, inD) = 98.802%
[37m[36mINFO[0m[0m 03/14 23:38:31 | === Summary ===
[37m[36mINFO[0m[0m 03/14 23:38:31 | Command: /jsm0707/GENIE/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm GENIE --test_envs 0 1 3 --dataset PACS
[37m[36mINFO[0m[0m 03/14 23:38:31 | Unique name: 250314_23-09-41_resnet50_adam
[37m[36mINFO[0m[0m 03/14 23:38:31 | Out path: train_output/PACS/GENIE/[0, 1, 3]/250314_23-09-41_resnet50_adam
[37m[36mINFO[0m[0m 03/14 23:38:31 | Algorithm: GENIE
[37m[36mINFO[0m[0m 03/14 23:38:31 | Dataset: PACS

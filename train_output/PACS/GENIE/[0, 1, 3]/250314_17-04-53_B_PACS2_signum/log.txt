[37m[36mINFO[0m[0m 03/14 17:04:53 | Command :: /jsm0707/GENIE/train_all.py B_PACS2_signum config/resnet50_signum.yaml --trial_seed 0 --hparams_seed 5 --algorithm GENIE --test_envs 0 1 3 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_signum.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 5
	in_domain: False
	model_save: None
	mpa: False
	name: B_PACS2_signum
	out_dir: train_output/PACS/GENIE/[0, 1, 3]/250314_17-04-53_B_PACS2_signum
	out_root: train_output/PACS/GENIE/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 0
	unique_name: 250314_17-04-53_B_PACS2_signum
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: signum
	freeze_bn: False
	pretrained: True
	lr: 1.6343540304927548e-05
	batch_size: 23
	weight_decay: 3.844578840738432e-05
	momentum: 0.8831874982931204
	convergence_rate: 0.038025503673057105
	moving_avg: 0.9556218694240625
	p: 0.22529679702233638
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/14 17:04:53 | n_steps = 5001
[37m[36mINFO[0m[0m 03/14 17:04:53 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/14 17:04:53 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/14 17:04:53 | 
[37m[36mINFO[0m[0m 03/14 17:04:53 | Testenv name escaping te_A_C_S -> te_A_C_S
[37m[36mINFO[0m[0m 03/14 17:04:53 | Test envs = [0, 1, 3], name = te_A_C_S
[37m[36mINFO[0m[0m 03/14 17:04:53 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 03/14 17:04:53 | Batch sizes for each domain: [0, 0, 23, 0] (total=23)
[37m[36mINFO[0m[0m 03/14 17:04:53 | steps-per-epoch for each domain: 58.09 -> min = 58.09
[37m[36mINFO[0m[0m 03/14 17:04:54 | # of params = 23522375
[37m[36mINFO[0m[0m 03/14 17:05:18 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/14 17:05:18 | 0.194858    0.183654    0.404192    0.410180    2.098591    0.322758    0.308068    0.220149    0.200855    0.404192    0.410180    0.041667    0.042038    0           0.000000    2.040825    0.907197    22.927538  
[37m[36mINFO[0m[0m 03/14 17:06:06 | 0.481725    0.488381    0.961078    0.925150    0.235120    0.525320    0.528117    0.481876    0.446581    0.961078    0.925150    0.437977    0.490446    200         3.443114    0.290093    0.124413    23.603093  
[37m[36mINFO[0m[0m 03/14 17:06:56 | 0.273165    0.287434    0.957335    0.934132    0.207518    0.456986    0.511002    0.176439    0.153846    0.957335    0.934132    0.186069    0.197452    400         6.886228    0.162815    0.121852    24.947902  
[37m[36mINFO[0m[0m 03/14 17:07:44 | 0.462829    0.459426    0.976048    0.940120    0.160573    0.562538    0.577017    0.372068    0.331197    0.976048    0.940120    0.453880    0.470064    600         10.329341   0.111938    0.125096    23.379019  
[37m[36mINFO[0m[0m 03/14 17:08:30 | 0.359728    0.369625    0.958084    0.934132    0.227020    0.596095    0.635697    0.240405    0.222222    0.958084    0.934132    0.242684    0.250955    800         13.772455   0.092461    0.121213    21.970102  
[37m[36mINFO[0m[0m 03/14 17:09:19 | 0.422399    0.431742    0.993263    0.937126    0.199923    0.568029    0.586797    0.356610    0.356838    0.993263    0.937126    0.342557    0.351592    1000        17.215569   0.051759    0.121508    24.105495  
[37m[36mINFO[0m[0m 03/14 17:10:09 | 0.436127    0.442468    0.987275    0.940120    0.178699    0.547895    0.567237    0.363539    0.346154    0.987275    0.940120    0.396947    0.414013    1200        20.658683   0.074092    0.125820    24.886744  
[37m[36mINFO[0m[0m 03/14 17:10:55 | 0.496964    0.495114    0.988772    0.943114    0.163945    0.626602    0.618582    0.441898    0.414530    0.988772    0.943114    0.422392    0.452229    1400        24.101796   0.041563    0.120835    22.016403  
[37m[36mINFO[0m[0m 03/14 17:11:43 | 0.532551    0.532563    0.997754    0.967066    0.161361    0.654667    0.647922    0.465885    0.446581    0.997754    0.967066    0.477099    0.503185    1600        27.544910   0.018339    0.118955    24.661886  
[37m[36mINFO[0m[0m 03/14 17:12:32 | 0.461798    0.467547    0.999251    0.976048    0.115511    0.660769    0.660147    0.377932    0.371795    0.999251    0.976048    0.346692    0.370701    1800        30.988024   0.008960    0.121383    24.477531  
[37m[36mINFO[0m[0m 03/14 17:13:21 | 0.388969    0.387774    0.994760    0.955090    0.180076    0.610738    0.601467    0.303305    0.277778    0.994760    0.955090    0.252863    0.284076    2000        34.431138   0.008596    0.120153    24.797749  
[37m[36mINFO[0m[0m 03/14 17:14:12 | 0.439016    0.452139    0.994012    0.946108    0.216827    0.533862    0.542787    0.346482    0.339744    0.994012    0.946108    0.436705    0.473885    2200        37.874251   0.033378    0.126144    25.641688  
[37m[36mINFO[0m[0m 03/14 17:15:01 | 0.511968    0.514584    0.974551    0.919162    0.218470    0.571080    0.572127    0.504264    0.478632    0.974551    0.919162    0.460560    0.492994    2400        41.317365   0.030193    0.117093    25.736358  
[37m[36mINFO[0m[0m 03/14 17:15:49 | 0.551502    0.545554    1.000000    0.979042    0.088040    0.669921    0.665037    0.492537    0.478632    1.000000    0.979042    0.492048    0.492994    2600        44.760479   0.027756    0.117796    24.851356  
[37m[36mINFO[0m[0m 03/14 17:16:36 | 0.428469    0.429188    0.999251    0.964072    0.120191    0.616229    0.618582    0.320896    0.297009    0.999251    0.964072    0.348282    0.371975    2800        48.203593   0.030284    0.121920    22.645494  
[37m[36mINFO[0m[0m 03/14 17:17:25 | 0.447433    0.452584    0.992515    0.955090    0.164667    0.594265    0.599022    0.335821    0.320513    0.992515    0.955090    0.412214    0.438217    3000        51.646707   0.020390    0.117312    24.730033  
[37m[36mINFO[0m[0m 03/14 17:18:12 | 0.483196    0.493599    0.994012    0.955090    0.186421    0.607077    0.601467    0.529851    0.521368    0.994012    0.955090    0.312659    0.357962    3200        55.089820   0.021410    0.119580    23.235160  
[37m[36mINFO[0m[0m 03/14 17:18:58 | 0.510178    0.512927    0.999251    0.964072    0.178587    0.615009    0.621027    0.504264    0.487179    0.999251    0.964072    0.411260    0.430573    3400        58.532934   0.011636    0.120231    22.658803  
[37m[36mINFO[0m[0m 03/14 17:19:49 | 0.423794    0.422681    0.997754    0.952096    0.221158    0.675412    0.667482    0.368870    0.354701    0.997754    0.952096    0.227099    0.245860    3600        61.976048   0.006382    0.122125    26.521546  
[37m[36mINFO[0m[0m 03/14 17:20:37 | 0.398367    0.397450    1.000000    0.970060    0.132615    0.651617    0.652812    0.329424    0.307692    1.000000    0.970060    0.214059    0.231847    3800        65.419162   0.000442    0.122046    23.365917  
[37m[36mINFO[0m[0m 03/14 17:21:24 | 0.419283    0.416462    1.000000    0.967066    0.145919    0.670531    0.672372    0.357676    0.324786    1.000000    0.967066    0.229644    0.252229    4000        68.862275   0.000047    0.115207    23.508652  
[37m[36mINFO[0m[0m 03/14 17:22:10 | 0.422340    0.417154    1.000000    0.967066    0.157112    0.660159    0.645477    0.363539    0.339744    1.000000    0.967066    0.243321    0.266242    4200        72.305389   0.000034    0.118050    22.757940  
[37m[36mINFO[0m[0m 03/14 17:22:57 | 0.423474    0.417257    1.000000    0.964072    0.158487    0.660159    0.647922    0.365672    0.337607    1.000000    0.964072    0.244593    0.266242    4400        75.748503   0.000009    0.122745    22.056334  
[37m[36mINFO[0m[0m 03/14 17:23:44 | 0.415930    0.414387    1.000000    0.970060    0.194570    0.655278    0.660147    0.357143    0.333333    1.000000    0.970060    0.235369    0.249682    4600        79.191617   0.002519    0.119803    23.394389  
[37m[36mINFO[0m[0m 03/14 17:24:33 | 0.446180    0.457424    0.996257    0.943114    0.195106    0.612569    0.630807    0.430171    0.410256    0.996257    0.943114    0.295802    0.331210    4800        82.634731   0.012392    0.120441    24.833684  
[37m[36mINFO[0m[0m 03/14 17:25:22 | 0.416560    0.440549    0.990269    0.934132    0.422356    0.570470    0.601467    0.390725    0.401709    0.990269    0.934132    0.288486    0.318471    5000        86.077844   0.008151    0.118873    24.958690  
[37m[36mINFO[0m[0m 03/14 17:25:22 | Cumulative gradient change saved at train_output/PACS/GENIE/[0, 1, 3]/250314_17-04-53_B_PACS2_signum/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/14 17:25:23 | ---
[37m[36mINFO[0m[0m 03/14 17:25:23 | test-domain validation(oracle) = 55.150%
[37m[36mINFO[0m[0m 03/14 17:25:23 | training-domain validation(iid) = 55.150%
[37m[36mINFO[0m[0m 03/14 17:25:23 | last = 41.656%
[37m[36mINFO[0m[0m 03/14 17:25:23 | last (inD) = 93.413%
[37m[36mINFO[0m[0m 03/14 17:25:23 | training-domain validation (iid, inD) = 97.904%
[37m[36mINFO[0m[0m 03/14 17:25:23 | === Summary ===
[37m[36mINFO[0m[0m 03/14 17:25:23 | Command: /jsm0707/GENIE/train_all.py B_PACS2_signum config/resnet50_signum.yaml --trial_seed 0 --hparams_seed 5 --algorithm GENIE --test_envs 0 1 3 --dataset PACS
[37m[36mINFO[0m[0m 03/14 17:25:23 | Unique name: 250314_17-04-53_B_PACS2_signum
[37m[36mINFO[0m[0m 03/14 17:25:23 | Out path: train_output/PACS/GENIE/[0, 1, 3]/250314_17-04-53_B_PACS2_signum
[37m[36mINFO[0m[0m 03/14 17:25:23 | Algorithm: GENIE
[37m[36mINFO[0m[0m 03/14 17:25:23 | Dataset: PACS

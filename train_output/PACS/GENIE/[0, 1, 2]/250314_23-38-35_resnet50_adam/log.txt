[37m[36mINFO[0m[0m 03/14 23:38:35 | Command :: /jsm0707/GENIE/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm GENIE --test_envs 0 1 2 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_adam.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_adam
	out_dir: train_output/PACS/GENIE/[0, 1, 2]/250314_23-38-35_resnet50_adam
	out_root: train_output/PACS/GENIE/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 0
	unique_name: 250314_23-38-35_resnet50_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	momentum: 0.9
	convergence_rate: 0.015
	moving_avg: 0.95
	p: 0.4
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/14 23:38:35 | n_steps = 5001
[37m[36mINFO[0m[0m 03/14 23:38:35 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/14 23:38:35 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/14 23:38:35 | 
[37m[36mINFO[0m[0m 03/14 23:38:35 | Testenv name escaping te_A_C_P -> te_A_C_P
[37m[36mINFO[0m[0m 03/14 23:38:35 | Test envs = [0, 1, 2], name = te_A_C_P
[37m[36mINFO[0m[0m 03/14 23:38:35 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 03/14 23:38:35 | Batch sizes for each domain: [0, 0, 0, 32] (total=32)
[37m[36mINFO[0m[0m 03/14 23:38:35 | steps-per-epoch for each domain: 98.25 -> min = 98.25
[37m[36mINFO[0m[0m 03/14 23:38:36 | # of params = 23522375
[37m[36mINFO[0m[0m 03/14 23:39:01 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/14 23:39:01 | 0.155420    0.167654    0.298664    0.262420    1.784369    0.174497    0.178484    0.157783    0.183761    0.133982    0.140719    0.298664    0.262420    0           0.000000    2.123937    1.122087    23.748089  
[37m[36mINFO[0m[0m 03/14 23:39:58 | 0.497511    0.495074    0.923664    0.896815    0.329781    0.462477    0.486553    0.568230    0.555556    0.461826    0.443114    0.923664    0.896815    200         2.035623    0.624174    0.170305    22.797854  
[37m[36mINFO[0m[0m 03/14 23:41:02 | 0.526834    0.530255    0.958651    0.919745    0.215032    0.491153    0.479218    0.586354    0.602564    0.502994    0.508982    0.958651    0.919745    400         4.071247    0.189312    0.210334    22.266288  
[37m[36mINFO[0m[0m 03/14 23:42:11 | 0.540835    0.543435    0.980280    0.947771    0.145346    0.489933    0.491443    0.649787    0.668803    0.482784    0.470060    0.980280    0.947771    600         6.106870    0.101208    0.226610    23.475942  
[37m[36mINFO[0m[0m 03/14 23:43:15 | 0.595241    0.608425    0.938931    0.912102    0.281860    0.505186    0.518337    0.657783    0.690171    0.622754    0.616766    0.938931    0.912102    800         8.142494    0.073379    0.203903    23.576830  
[37m[36mINFO[0m[0m 03/14 23:44:12 | 0.597584    0.604149    0.991730    0.952866    0.160752    0.569250    0.586797    0.671109    0.713675    0.552395    0.511976    0.991730    0.952866    1000        10.178117   0.058338    0.161997    23.871791  
[37m[36mINFO[0m[0m 03/14 23:45:06 | 0.571019    0.586030    0.990140    0.946497    0.201433    0.516168    0.518337    0.703625    0.730769    0.493263    0.508982    0.990140    0.946497    1200        12.213740   0.044077    0.151862    23.808530  
[37m[36mINFO[0m[0m 03/14 23:46:07 | 0.520527    0.532394    0.992048    0.943949    0.171296    0.450275    0.469438    0.644989    0.666667    0.466317    0.461078    0.992048    0.943949    1400        14.249364   0.044349    0.192414    23.157343  
[37m[36mINFO[0m[0m 03/14 23:47:13 | 0.595669    0.604841    0.993639    0.957962    0.148777    0.547285    0.562347    0.682836    0.707265    0.556886    0.544910    0.993639    0.957962    1600        16.284987   0.033482    0.213820    22.262801  
[37m[36mINFO[0m[0m 03/14 23:48:20 | 0.530644    0.523173    0.995865    0.959236    0.146994    0.461867    0.466993    0.630064    0.647436    0.500000    0.455090    0.995865    0.959236    1800        18.320611   0.037346    0.219593    23.709673  
[37m[36mINFO[0m[0m 03/14 23:49:22 | 0.495835    0.490509    0.994911    0.943949    0.154826    0.416107    0.398533    0.652985    0.668803    0.418413    0.404192    0.994911    0.943949    2000        20.356234   0.025153    0.198084    22.515718  
[37m[36mINFO[0m[0m 03/14 23:50:18 | 0.589151    0.596021    0.993639    0.946497    0.228834    0.532032    0.535452    0.654584    0.698718    0.580838    0.553892    0.993639    0.946497    2200        22.391858   0.013704    0.166684    21.936517  
[37m[36mINFO[0m[0m 03/14 23:51:11 | 0.676275    0.688868    0.972646    0.927389    0.209828    0.619280    0.635697    0.747868    0.769231    0.661677    0.661677    0.972646    0.927389    2400        24.427481   0.041378    0.154237    22.899566  
[37m[36mINFO[0m[0m 03/14 23:52:16 | 0.556410    0.567456    0.995229    0.957962    0.164930    0.481391    0.469438    0.690832    0.702991    0.497006    0.529940    0.995229    0.957962    2600        26.463104   0.022055    0.198481    24.995285  
[37m[36mINFO[0m[0m 03/14 23:53:22 | 0.575508    0.575495    0.995229    0.960510    0.180042    0.484442    0.491443    0.715885    0.735043    0.526198    0.500000    0.995229    0.960510    2800        28.498728   0.013607    0.216331    23.115879  
[37m[36mINFO[0m[0m 03/14 23:54:29 | 0.568879    0.592467    0.998410    0.952866    0.204779    0.507016    0.525672    0.683902    0.730769    0.515719    0.520958    0.998410    0.952866    3000        30.534351   0.020007    0.219869    22.668928  
[37m[36mINFO[0m[0m 03/14 23:55:32 | 0.539886    0.552174    0.994593    0.954140    0.196746    0.444783    0.462103    0.698827    0.724359    0.476048    0.470060    0.994593    0.954140    3200        32.569975   0.011094    0.198182    23.055451  
[37m[36mINFO[0m[0m 03/14 23:56:26 | 0.522949    0.541373    0.997774    0.959236    0.184046    0.433191    0.452323    0.655117    0.668803    0.480539    0.502994    0.997774    0.959236    3400        34.605598   0.013297    0.154714    22.948783  
[37m[36mINFO[0m[0m 03/14 23:57:23 | 0.622212    0.645699    0.992048    0.950318    0.201690    0.615619    0.643032    0.695629    0.737179    0.555389    0.556886    0.992048    0.950318    3600        36.641221   0.020454    0.166438    23.802049  
[37m[36mINFO[0m[0m 03/14 23:58:26 | 0.612728    0.637886    0.999046    0.959236    0.180287    0.582062    0.589242    0.705224    0.758547    0.550898    0.565868    0.999046    0.959236    3800        38.676845   0.007173    0.204580    22.791742  
[37m[36mINFO[0m[0m 03/14 23:59:17 | 0.628077    0.649751    0.998728    0.950318    0.213032    0.602196    0.613692    0.692964    0.730769    0.589072    0.604790    0.998728    0.950318    4000        40.712468   0.010545    0.134453    24.028377  
[37m[36mINFO[0m[0m 03/15 00:00:19 | 0.638302    0.655587    0.997774    0.957962    0.212025    0.582062    0.596577    0.722814    0.756410    0.610030    0.613772    0.997774    0.957962    4200        42.748092   0.006117    0.188171    23.843506  
[37m[36mINFO[0m[0m 03/15 00:01:25 | 0.637068    0.648887    0.986323    0.931210    0.329117    0.532032    0.545232    0.713753    0.730769    0.665419    0.670659    0.986323    0.931210    4400        44.783715   0.006021    0.212381    23.275791  
[37m[36mINFO[0m[0m 03/15 00:02:26 | 0.605508    0.639609    0.998728    0.955414    0.204484    0.551556    0.562347    0.714819    0.775641    0.550150    0.580838    0.998728    0.955414    4600        46.819338   0.008163    0.198541    22.172649  
[37m[36mINFO[0m[0m 03/15 00:03:23 | 0.589705    0.621542    0.998728    0.961783    0.206809    0.531422    0.559902    0.717484    0.777778    0.520210    0.526946    0.998728    0.961783    4800        48.854962   0.000657    0.169065    23.118305  
[37m[36mINFO[0m[0m 03/15 00:04:18 | 0.546471    0.572709    0.998728    0.959236    0.231432    0.478340    0.513447    0.701493    0.728632    0.459581    0.476048    0.998728    0.959236    5000        50.890585   0.001993    0.150642    24.039587  
[37m[36mINFO[0m[0m 03/15 00:04:18 | Cumulative gradient change saved at train_output/PACS/GENIE/[0, 1, 2]/250314_23-38-35_resnet50_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/15 00:04:19 | ---
[37m[36mINFO[0m[0m 03/15 00:04:19 | test-domain validation(oracle) = 67.627%
[37m[36mINFO[0m[0m 03/15 00:04:19 | training-domain validation(iid) = 58.971%
[37m[36mINFO[0m[0m 03/15 00:04:19 | last = 54.647%
[37m[36mINFO[0m[0m 03/15 00:04:19 | last (inD) = 95.924%
[37m[36mINFO[0m[0m 03/15 00:04:19 | training-domain validation (iid, inD) = 96.178%
[37m[36mINFO[0m[0m 03/15 00:04:19 | === Summary ===
[37m[36mINFO[0m[0m 03/15 00:04:19 | Command: /jsm0707/GENIE/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm GENIE --test_envs 0 1 2 --dataset PACS
[37m[36mINFO[0m[0m 03/15 00:04:19 | Unique name: 250314_23-38-35_resnet50_adam
[37m[36mINFO[0m[0m 03/15 00:04:19 | Out path: train_output/PACS/GENIE/[0, 1, 2]/250314_23-38-35_resnet50_adam
[37m[36mINFO[0m[0m 03/15 00:04:19 | Algorithm: GENIE
[37m[36mINFO[0m[0m 03/15 00:04:19 | Dataset: PACS

[37m[36mINFO[0m[0m 03/14 17:25:27 | Command :: /jsm0707/GENIE/train_all.py B_PACS3_signum config/resnet50_signum.yaml --trial_seed 1 --hparams_seed 9 --algorithm GENIE --test_envs 0 1 2 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_signum.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 9
	in_domain: False
	model_save: None
	mpa: False
	name: B_PACS3_signum
	out_dir: train_output/PACS/GENIE/[0, 1, 2]/250314_17-25-27_B_PACS3_signum
	out_root: train_output/PACS/GENIE/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 1
	unique_name: 250314_17-25-27_B_PACS3_signum
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: signum
	freeze_bn: False
	pretrained: True
	lr: 2.7532223448653515e-05
	batch_size: 36
	weight_decay: 0.007511403320794324
	momentum: 0.9872565509707083
	convergence_rate: 0.019543659090931836
	moving_avg: 0.900758517723229
	p: 0.5423165174183379
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/14 17:25:27 | n_steps = 5001
[37m[36mINFO[0m[0m 03/14 17:25:27 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/14 17:25:27 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/14 17:25:27 | 
[37m[36mINFO[0m[0m 03/14 17:25:27 | Testenv name escaping te_A_C_P -> te_A_C_P
[37m[36mINFO[0m[0m 03/14 17:25:27 | Test envs = [0, 1, 2], name = te_A_C_P
[37m[36mINFO[0m[0m 03/14 17:25:27 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 03/14 17:25:27 | Batch sizes for each domain: [0, 0, 0, 36] (total=36)
[37m[36mINFO[0m[0m 03/14 17:25:27 | steps-per-epoch for each domain: 87.33 -> min = 87.33
[37m[36mINFO[0m[0m 03/14 17:25:28 | # of params = 23522375
[37m[36mINFO[0m[0m 03/14 17:25:53 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/14 17:25:53 | 0.126633    0.149268    0.215967    0.208917    1.803894    0.134838    0.178484    0.149254    0.164530    0.095808    0.104790    0.215967    0.208917    0           0.000000    2.246371    1.025000    23.662207  
[37m[36mINFO[0m[0m 03/14 17:26:41 | 0.459645    0.445732    0.837150    0.815287    0.509860    0.380110    0.322738    0.606610    0.598291    0.392216    0.416168    0.837150    0.815287    200         2.290076    0.726866    0.127199    22.516020  
[37m[36mINFO[0m[0m 03/14 17:27:29 | 0.541562    0.543948    0.963422    0.946497    0.144783    0.491763    0.469438    0.639659    0.647436    0.493263    0.514970    0.963422    0.946497    400         4.580153    0.202113    0.126378    23.070140  
[37m[36mINFO[0m[0m 03/14 17:28:17 | 0.557583    0.552077    0.972328    0.952866    0.123056    0.503966    0.469438    0.626866    0.638889    0.541916    0.547904    0.972328    0.952866    600         6.870229    0.125319    0.125049    22.585275  
[37m[36mINFO[0m[0m 03/14 17:29:05 | 0.580634    0.576725    0.983779    0.971975    0.097550    0.538133    0.530562    0.655117    0.651709    0.548653    0.547904    0.983779    0.971975    800         9.160305    0.103508    0.129422    22.272651  
[37m[36mINFO[0m[0m 03/14 17:29:54 | 0.577144    0.580150    0.991730    0.968153    0.093293    0.506406    0.503667    0.698827    0.700855    0.526198    0.535928    0.991730    0.968153    1000        11.450382   0.063381    0.125910    24.169211  
[37m[36mINFO[0m[0m 03/14 17:30:45 | 0.599514    0.617400    0.985051    0.960510    0.144730    0.561928    0.579462    0.649787    0.670940    0.586826    0.601796    0.985051    0.960510    1200        13.740458   0.038305    0.129875    24.216112  
[37m[36mINFO[0m[0m 03/14 17:31:35 | 0.595383    0.580672    0.992048    0.954140    0.184394    0.519829    0.488998    0.728145    0.720085    0.538174    0.532934    0.992048    0.954140    1400        16.030534   0.044783    0.134800    23.846510  
[37m[36mINFO[0m[0m 03/14 17:32:24 | 0.592209    0.610557    0.988868    0.955414    0.166626    0.514948    0.518337    0.706290    0.711538    0.555389    0.601796    0.988868    0.955414    1600        18.320611   0.047569    0.127492    23.095054  
[37m[36mINFO[0m[0m 03/14 17:33:14 | 0.582425    0.572780    0.982506    0.951592    0.163670    0.524100    0.528117    0.638593    0.630342    0.584581    0.559880    0.982506    0.951592    1800        20.610687   0.034503    0.132749    23.654059  
[37m[36mINFO[0m[0m 03/14 17:34:06 | 0.600575    0.618399    0.995865    0.966879    0.125273    0.524100    0.535452    0.702026    0.717949    0.575599    0.601796    0.995865    0.966879    2000        22.900763   0.027391    0.130239    25.773244  
[37m[36mINFO[0m[0m 03/14 17:34:57 | 0.550811    0.564227    0.992048    0.969427    0.119863    0.465528    0.466993    0.644989    0.668803    0.541916    0.556886    0.992048    0.969427    2200        25.190840   0.022809    0.136118    23.302088  
[37m[36mINFO[0m[0m 03/14 17:35:47 | 0.550632    0.560411    0.994911    0.968153    0.110455    0.439902    0.447433    0.658849    0.685897    0.553144    0.547904    0.994911    0.968153    2400        27.480916   0.027504    0.130394    24.103770  
[37m[36mINFO[0m[0m 03/14 17:36:37 | 0.608275    0.626370    0.991730    0.957962    0.139709    0.581452    0.562347    0.677505    0.702991    0.565868    0.613772    0.991730    0.957962    2600        29.770992   0.024009    0.127725    24.783667  
[37m[36mINFO[0m[0m 03/14 17:37:29 | 0.611308    0.631249    0.995547    0.964331    0.136243    0.577791    0.586797    0.666311    0.675214    0.589820    0.631737    0.995547    0.964331    2800        32.061069   0.024028    0.131912    25.160669  
[37m[36mINFO[0m[0m 03/14 17:38:20 | 0.622271    0.626279    0.999046    0.965605    0.138829    0.583893    0.550122    0.718550    0.732906    0.564371    0.595808    0.999046    0.965605    3000        34.351145   0.014925    0.132473    24.402666  
[37m[36mINFO[0m[0m 03/14 17:39:10 | 0.648086    0.662781    0.999046    0.974522    0.092985    0.618060    0.618582    0.728145    0.750000    0.598054    0.619760    0.999046    0.974522    3200        36.641221   0.016892    0.132588    23.998908  
[37m[36mINFO[0m[0m 03/14 17:39:59 | 0.659263    0.676449    0.995547    0.957962    0.171493    0.591824    0.611247    0.730277    0.741453    0.655689    0.676647    0.995547    0.957962    3400        38.931298   0.007978    0.130991    22.693984  
[37m[36mINFO[0m[0m 03/14 17:40:49 | 0.686503    0.675127    0.998728    0.975796    0.115419    0.641855    0.613692    0.753731    0.735043    0.663922    0.676647    0.998728    0.975796    3600        41.221374   0.012182    0.131673    24.087219  
[37m[36mINFO[0m[0m 03/14 17:41:40 | 0.627656    0.640578    0.998092    0.968153    0.134065    0.618670    0.625917    0.688699    0.688034    0.575599    0.607784    0.998092    0.968153    3800        43.511450   0.007216    0.132204    23.719521  
[37m[36mINFO[0m[0m 03/14 17:42:29 | 0.606776    0.629549    0.994911    0.959236    0.236945    0.586333    0.594132    0.702559    0.713675    0.531437    0.580838    0.994911    0.959236    4000        45.801527   0.011448    0.131104    22.876686  
[37m[36mINFO[0m[0m 03/14 17:43:18 | 0.594770    0.602846    0.998092    0.963057    0.143926    0.549725    0.545232    0.684435    0.694444    0.550150    0.568862    0.998092    0.963057    4200        48.091603   0.013419    0.128875    23.823823  
[37m[36mINFO[0m[0m 03/14 17:44:08 | 0.589769    0.588400    0.997774    0.966879    0.126046    0.519219    0.513447    0.684968    0.700855    0.565120    0.550898    0.997774    0.966879    4400        50.381679   0.015251    0.129300    23.932482  
[37m[36mINFO[0m[0m 03/14 17:44:57 | 0.643825    0.656333    0.997455    0.971975    0.138269    0.630872    0.621027    0.706290    0.722222    0.594311    0.625749    0.997455    0.971975    4600        52.671756   0.004240    0.126616    23.457034  
[37m[36mINFO[0m[0m 03/14 17:45:45 | 0.631517    0.633891    0.999046    0.961783    0.109409    0.608908    0.599022    0.702559    0.700855    0.583084    0.601796    0.999046    0.961783    4800        54.961832   0.017952    0.131001    22.118736  
[37m[36mINFO[0m[0m 03/14 17:46:34 | 0.592379    0.599147    0.991730    0.964331    0.110784    0.541794    0.562347    0.680704    0.675214    0.554641    0.559880    0.991730    0.964331    5000        57.251908   0.043305    0.130281    22.615354  
[37m[36mINFO[0m[0m 03/14 17:46:34 | Cumulative gradient change saved at train_output/PACS/GENIE/[0, 1, 2]/250314_17-25-27_B_PACS3_signum/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/14 17:46:35 | ---
[37m[36mINFO[0m[0m 03/14 17:46:35 | test-domain validation(oracle) = 65.926%
[37m[36mINFO[0m[0m 03/14 17:46:35 | training-domain validation(iid) = 68.650%
[37m[36mINFO[0m[0m 03/14 17:46:35 | last = 59.238%
[37m[36mINFO[0m[0m 03/14 17:46:35 | last (inD) = 96.433%
[37m[36mINFO[0m[0m 03/14 17:46:35 | training-domain validation (iid, inD) = 97.580%
[37m[36mINFO[0m[0m 03/14 17:46:35 | === Summary ===
[37m[36mINFO[0m[0m 03/14 17:46:35 | Command: /jsm0707/GENIE/train_all.py B_PACS3_signum config/resnet50_signum.yaml --trial_seed 1 --hparams_seed 9 --algorithm GENIE --test_envs 0 1 2 --dataset PACS
[37m[36mINFO[0m[0m 03/14 17:46:35 | Unique name: 250314_17-25-27_B_PACS3_signum
[37m[36mINFO[0m[0m 03/14 17:46:35 | Out path: train_output/PACS/GENIE/[0, 1, 2]/250314_17-25-27_B_PACS3_signum
[37m[36mINFO[0m[0m 03/14 17:46:35 | Algorithm: GENIE
[37m[36mINFO[0m[0m 03/14 17:46:35 | Dataset: PACS

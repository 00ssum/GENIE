[37m[36mINFO[0m[0m 01/31 08:33:01 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py vit_MIRO_EVE config/vit_MIRO_EVE.yaml --algorithm MIRO --test_envs 0 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: MIRO
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/vit_MIRO_EVE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: vit_MIRO_EVE
	out_dir: train_output/PACS/MIRO/[0]/250131_08-33-01_vit_MIRO_EVE
	out_root: train_output/PACS/MIRO/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250131_08-33-01_vit_MIRO_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: EVE
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 01/31 08:33:01 | n_steps = 5001
[37m[36mINFO[0m[0m 01/31 08:33:01 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/31 08:33:01 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/31 08:33:01 | Target test envs = [[0]]
[37m[36mINFO[0m[0m 01/31 08:33:01 | 
[37m[36mINFO[0m[0m 01/31 08:33:01 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 01/31 08:33:01 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 01/31 08:33:01 | Batch sizes for each domain: [0, 32, 32, 32] (total=96)
[37m[36mINFO[0m[0m 01/31 08:33:01 | steps-per-epoch for each domain: 58.62, 41.75, 98.25 -> min = 41.75
[37m[36mINFO[0m[0m 01/31 08:33:05 | # of params = 172392711
[37m[36mINFO[0m[0m 01/31 08:33:41 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        reg_loss    step_time   eval_time  
[37m[36mINFO[0m[0m 01/31 08:33:41 | 0.166565    0.166259    0.221787    0.245642    1.898970    0.166565    0.166259    0.267058    0.333333    0.184880    0.203593    0.213422    0.200000    0           0.000000    1.364712    -5.756463   1.572528    34.311382  
[37m[36mINFO[0m[0m 01/31 08:36:06 | 0.456986    0.440098    0.676179    0.701724    0.846561    0.456986    0.440098    0.698294    0.737179    0.735778    0.742515    0.594466    0.625478    200         4.790419    3.258623    16.714046   0.521410    39.556608  
[37m[36mINFO[0m[0m 01/31 08:38:25 | 0.612569    0.603912    0.838666    0.842706    0.453306    0.612569    0.603912    0.857143    0.893162    0.928892    0.901198    0.729962    0.733758    400         9.580838    0.306522    -2.961251   0.509661    35.465076  
[37m[36mINFO[0m[0m 01/31 08:40:48 | 0.566809    0.540342    0.875254    0.868285    0.367610    0.566809    0.540342    0.890192    0.927350    0.961078    0.913174    0.774491    0.764331    600         14.371257   -0.013044   -3.594182   0.526645    36.918853  
[37m[36mINFO[0m[0m 01/31 08:43:07 | 0.604027    0.579462    0.904045    0.876617    0.349153    0.604027    0.579462    0.945096    0.925214    0.971557    0.907186    0.795483    0.797452    800         19.161677   -0.080293   -3.720294   0.515340    34.596407  
[37m[36mINFO[0m[0m 01/31 08:45:25 | 0.595485    0.613692    0.917834    0.889566    0.317913    0.595485    0.613692    0.929638    0.916667    0.983533    0.943114    0.840331    0.808917    1000        23.952096   -0.152572   -3.859961   0.515557    33.463447  
[37m[36mINFO[0m[0m 01/31 08:47:55 | 0.621110    0.647922    0.933128    0.900113    0.280120    0.621110    0.647922    0.973348    0.950855    0.989521    0.943114    0.836514    0.806369    1200        28.742515   -0.186646   -3.936427   0.521978    43.635368  
[37m[36mINFO[0m[0m 01/31 08:50:12 | 0.641245    0.633252    0.942850    0.916603    0.241486    0.641245    0.633252    0.976546    0.957265    0.988772    0.967066    0.863232    0.825478    1400        33.532934   -0.228095   -4.041097   0.510835    33.079548  
[37m[36mINFO[0m[0m 01/31 08:52:33 | 0.635143    0.652812    0.947957    0.922401    0.238404    0.635143    0.652812    0.982942    0.961538    0.991018    0.961078    0.869911    0.844586    1600        38.323353   -0.230957   -4.014547   0.531830    33.794188  
[37m[36mINFO[0m[0m 01/31 08:54:57 | 0.622941    0.603912    0.927129    0.900158    0.299496    0.622941    0.603912    0.969083    0.955128    0.995509    0.958084    0.816794    0.787261    1800        43.113772   -0.261355   -4.084058   0.514121    38.933165  
[37m[36mINFO[0m[0m 01/31 08:57:15 | 0.643075    0.647922    0.947453    0.916123    0.244004    0.643075    0.647922    0.974414    0.955128    0.993263    0.946108    0.874682    0.847134    2000        47.904192   -0.274497   -4.121343   0.522465    34.041280  
[37m[36mINFO[0m[0m 01/31 08:59:44 | 0.599756    0.599022    0.957406    0.917550    0.257700    0.599756    0.599022    0.981876    0.963675    0.996257    0.943114    0.894084    0.845860    2200        52.694611   -0.299565   -4.194443   0.516604    45.312079  
[37m[36mINFO[0m[0m 01/31 09:02:00 | 0.629042    0.630807    0.956411    0.920375    0.240310    0.629042    0.630807    0.982409    0.967949    0.994012    0.937126    0.892812    0.856051    2400        57.485030   -0.303671   -4.202997   0.521025    31.696649  
[37m[36mINFO[0m[0m 01/31 09:04:19 | 0.652837    0.625917    0.962906    0.931639    0.224413    0.652837    0.625917    0.988273    0.965812    1.000000    0.973054    0.900445    0.856051    2600        62.275449   -0.328661   -4.278489   0.526561    33.772710  
[37m[36mINFO[0m[0m 01/31 09:06:35 | 0.665650    0.667482    0.963727    0.919846    0.243239    0.665650    0.667482    0.977079    0.944444    0.997754    0.973054    0.916349    0.842038    2800        67.065868   -0.340653   -4.294332   0.510271    32.346864  
[37m[36mINFO[0m[0m 01/31 09:08:52 | 0.694326    0.687042    0.973617    0.935578    0.204495    0.694326    0.687042    0.993070    0.967949    0.997754    0.961078    0.930025    0.877707    3000        71.856287   -0.340517   -4.330922   0.520409    33.259107  
[37m[36mINFO[0m[0m 01/31 09:11:19 | 0.706528    0.682152    0.973832    0.930494    0.220640    0.706528    0.682152    0.992537    0.970085    0.999251    0.964072    0.929707    0.857325    3200        76.646707   -0.364332   -4.386801   0.508678    43.152225  
[37m[36mINFO[0m[0m 01/31 09:13:33 | 0.723002    0.709046    0.977408    0.931480    0.203170    0.723002    0.709046    0.995203    0.967949    1.000000    0.964072    0.937023    0.862420    3400        81.437126   -0.369746   -4.408599   0.514179    31.520815  
[37m[36mINFO[0m[0m 01/31 09:15:54 | 0.721782    0.713936    0.979273    0.941707    0.181560    0.721782    0.713936    0.995203    0.974359    0.997006    0.973054    0.945611    0.877707    3600        86.227545   -0.375908   -4.424250   0.513765    38.415057  
[37m[36mINFO[0m[0m 01/31 09:18:14 | 0.715680    0.706601    0.978076    0.938585    0.214519    0.715680    0.706601    0.996269    0.974359    0.997754    0.970060    0.940204    0.871338    3800        91.017964   -0.378679   -4.424323   0.514628    34.686428  
[37m[36mINFO[0m[0m 01/31 09:20:32 | 0.733374    0.718826    0.981182    0.948385    0.178434    0.733374    0.718826    0.990938    0.976496    1.000000    0.982036    0.952608    0.886624    4000        95.808383   -0.397910   -4.492466   0.521034    34.107042  
[37m[36mINFO[0m[0m 01/31 09:22:58 | 0.716290    0.699267    0.984368    0.940824    0.197615    0.716290    0.699267    0.996269    0.972222    0.998503    0.961078    0.958333    0.889172    4200        100.598802  -0.391386   -4.478452   0.511915    41.646586  
[37m[36mINFO[0m[0m 01/31 09:25:15 | 0.758389    0.748166    0.974649    0.944390    0.194668    0.758389    0.748166    0.994670    0.967949    0.999251    0.976048    0.930025    0.889172    4400        105.389222  -0.399526   -4.502692   0.512504    35.140387  
[37m[36mINFO[0m[0m 01/31 09:27:33 | 0.749237    0.728606    0.984294    0.946378    0.175674    0.749237    0.728606    0.994136    0.974359    0.998503    0.973054    0.960242    0.891720    4600        110.179641  -0.403083   -4.514023   0.516150    34.121722  
[37m[36mINFO[0m[0m 01/31 09:29:54 | 0.735815    0.731051    0.987515    0.949501    0.191902    0.735815    0.731051    0.994670    0.978632    1.000000    0.973054    0.967875    0.896815    4800        114.970060  -0.409679   -4.519507   0.524774    36.049726  
[37m[36mINFO[0m[0m 01/31 09:32:21 | 0.716901    0.701711    0.984245    0.942918    0.201335    0.716901    0.701711    0.987740    0.955128    0.997754    0.964072    0.967239    0.909554    5000        119.760479  -0.409727   -4.541210   0.520456    41.291767  

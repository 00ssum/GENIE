[37m[36mINFO[0m[0m 01/31 10:32:39 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py vit_MIRO_EVE config/vit_MIRO_EVE.yaml --algorithm MIRO --test_envs 2 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: MIRO
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/vit_MIRO_EVE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: vit_MIRO_EVE
	out_dir: train_output/PACS/MIRO/[2]/250131_10-32-39_vit_MIRO_EVE
	out_root: train_output/PACS/MIRO/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250131_10-32-39_vit_MIRO_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: GENIE
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 01/31 10:32:39 | n_steps = 5001
[37m[36mINFO[0m[0m 01/31 10:32:39 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/31 10:32:39 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/31 10:32:39 | Target test envs = [[2]]
[37m[36mINFO[0m[0m 01/31 10:32:39 | 
[37m[36mINFO[0m[0m 01/31 10:32:39 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 01/31 10:32:39 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 01/31 10:32:39 | Batch sizes for each domain: [32, 32, 0, 32] (total=96)
[37m[36mINFO[0m[0m 01/31 10:32:39 | steps-per-epoch for each domain: 51.22, 58.62, 98.25 -> min = 51.22
[37m[36mINFO[0m[0m 01/31 10:32:46 | # of params = 172392711
[37m[36mINFO[0m[0m 01/31 10:33:23 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        reg_loss    step_time   eval_time  
[37m[36mINFO[0m[0m 01/31 10:33:23 | 0.314371    0.311377    0.240044    0.294795    1.865791    0.231849    0.308068    0.259595    0.348291    0.314371    0.311377    0.228690    0.228025    0           0.000000    1.373095    -5.756463   1.994077    34.575232  
[37m[36mINFO[0m[0m 01/31 10:35:47 | 0.815120    0.778443    0.772276    0.792421    0.578842    0.774253    0.777506    0.857143    0.895299    0.815120    0.778443    0.685433    0.704459    200         3.904820    1.273127    0.845625    0.521483    38.956014  
[37m[36mINFO[0m[0m 01/31 10:38:10 | 0.850299    0.823353    0.825721    0.827412    0.491400    0.801708    0.799511    0.901919    0.920940    0.850299    0.823353    0.773537    0.761783    400         7.809640    0.199467    -3.430885   0.528052    35.251234  
[37m[36mINFO[0m[0m 01/31 10:40:32 | 0.890719    0.850299    0.871879    0.868203    0.381979    0.898109    0.877751    0.917910    0.916667    0.890719    0.850299    0.799618    0.810191    600         11.714460   0.041923    -3.600271   0.521070    36.919428  
[37m[36mINFO[0m[0m 01/31 10:42:55 | 0.857784    0.826347    0.892875    0.872606    0.382418    0.929225    0.870416    0.948827    0.942308    0.857784    0.826347    0.800573    0.805096    800         15.619280   -0.048860   -3.772847   0.536497    33.900887  
[37m[36mINFO[0m[0m 01/31 10:45:16 | 0.887725    0.886228    0.913203    0.883462    0.325670    0.930445    0.882641    0.962154    0.935897    0.887725    0.886228    0.847010    0.831847    1000        19.524100   -0.104994   -3.830135   0.524563    34.763908  
[37m[36mINFO[0m[0m 01/31 10:47:40 | 0.878743    0.844311    0.914687    0.879702    0.327704    0.934106    0.870416    0.971215    0.950855    0.878743    0.844311    0.838740    0.817834    1200        23.428920   -0.155311   -3.921715   0.522299    37.972121  
[37m[36mINFO[0m[0m 01/31 10:50:05 | 0.898952    0.877246    0.931520    0.892338    0.308659    0.954240    0.887531    0.978678    0.948718    0.898952    0.877246    0.861641    0.840764    1400        27.333740   -0.193695   -3.969842   0.516031    42.213527  
[37m[36mINFO[0m[0m 01/31 10:52:26 | 0.891467    0.829341    0.932946    0.882017    0.347626    0.963392    0.885086    0.979211    0.938034    0.891467    0.829341    0.856234    0.822930    1600        31.238560   -0.213445   -4.009789   0.531668    32.586413  
[37m[36mINFO[0m[0m 01/31 10:54:46 | 0.876497    0.856287    0.943274    0.915329    0.262394    0.974375    0.924205    0.972814    0.952991    0.876497    0.856287    0.882634    0.868790    1800        35.143380   -0.242278   -4.055281   0.514017    37.169183  
[37m[36mINFO[0m[0m 01/31 10:57:06 | 0.918413    0.892216    0.958825    0.905193    0.265450    0.983527    0.899756    0.986141    0.950855    0.918413    0.892216    0.906807    0.864968    2000        39.048200   -0.258243   -4.076484   0.522803    33.882028  
[37m[36mINFO[0m[0m 01/31 10:59:36 | 0.907186    0.871257    0.950969    0.904035    0.284887    0.974375    0.902200    0.986674    0.955128    0.907186    0.871257    0.891858    0.854777    2200        42.953020   -0.281931   -4.144067   0.523101    44.541164  
[37m[36mINFO[0m[0m 01/31 11:01:58 | 0.907186    0.895210    0.949271    0.903741    0.294027    0.981086    0.904645    0.980277    0.965812    0.907186    0.895210    0.886450    0.840764    2400        46.857840   -0.274265   -4.110876   0.512179    39.966993  
[37m[36mINFO[0m[0m 01/31 11:04:16 | 0.907934    0.880240    0.964545    0.911966    0.257633    0.979866    0.902200    0.993603    0.957265    0.907934    0.880240    0.920165    0.876433    2600        50.762660   -0.298278   -4.199109   0.520634    34.170713  
[37m[36mINFO[0m[0m 01/31 11:06:37 | 0.854042    0.847305    0.959023    0.905768    0.305697    0.979256    0.899756    0.984009    0.955128    0.854042    0.847305    0.913804    0.862420    2800        54.667480   -0.303993   -4.187435   0.517725    37.302475  
[37m[36mINFO[0m[0m 01/31 11:09:03 | 0.904192    0.901198    0.971023    0.917514    0.274846    0.989018    0.921760    0.993070    0.965812    0.904192    0.901198    0.930980    0.864968    3000        58.572300   -0.331792   -4.251810   0.536894    38.298920  
[37m[36mINFO[0m[0m 01/31 11:11:24 | 0.916916    0.895210    0.976257    0.912014    0.275772    0.993899    0.899756    0.994670    0.963675    0.916916    0.895210    0.940204    0.872611    3200        62.477120   -0.343330   -4.295256   0.506704    38.176700  
[37m[36mINFO[0m[0m 01/31 11:13:48 | 0.913922    0.904192    0.972274    0.927301    0.232169    0.992678    0.929095    0.990938    0.957265    0.913922    0.904192    0.933206    0.895541    3400        66.381940   -0.348614   -4.298527   0.519346    40.488966  
[37m[36mINFO[0m[0m 01/31 11:16:10 | 0.896707    0.886228    0.974108    0.915836    0.267372    0.993289    0.909535    0.993603    0.961538    0.896707    0.886228    0.935433    0.876433    3600        70.286760   -0.339848   -4.217025   0.519464    35.406160  
[37m[36mINFO[0m[0m 01/31 11:18:35 | 0.896707    0.898204    0.968148    0.910480    0.290846    0.985357    0.914425    0.977612    0.938034    0.896707    0.898204    0.941476    0.878981    3800        74.191580   -0.357560   -4.291425   0.536709    37.648927  
[37m[36mINFO[0m[0m 01/31 11:20:51 | 0.910928    0.892216    0.979884    0.924260    0.234941    0.996949    0.924205    0.992004    0.959402    0.910928    0.892216    0.950700    0.889172    4000        78.096400   -0.372587   -4.357864   0.512857    34.108255  
[37m[36mINFO[0m[0m 01/31 11:23:15 | 0.923653    0.919162    0.983429    0.934594    0.235508    0.996949    0.936430    0.997868    0.974359    0.923653    0.919162    0.955471    0.892994    4200        82.001220   -0.385274   -4.416802   0.511103    41.199096  
[37m[36mINFO[0m[0m 01/31 11:25:46 | 0.946856    0.931138    0.979704    0.939539    0.207737    0.997559    0.955990    0.994670    0.965812    0.946856    0.931138    0.946883    0.896815    4400        85.906040   -0.386406   -4.408299   0.516444    46.222914  
[37m[36mINFO[0m[0m 01/31 11:28:05 | 0.930389    0.904192    0.986559    0.928417    0.245866    0.993289    0.921760    0.999467    0.967949    0.930389    0.904192    0.966921    0.895541    4600        89.810860   -0.392195   -4.428191   0.518302    33.169281  
[37m[36mINFO[0m[0m 01/31 11:30:25 | 0.923653    0.907186    0.987971    0.942662    0.205479    0.998170    0.955990    0.997868    0.970085    0.923653    0.907186    0.967875    0.901911    4800        93.715680   -0.400779   -4.455689   0.509681    38.331472  
[37m[36mINFO[0m[0m 01/31 11:32:54 | 0.946856    0.928144    0.980827    0.933444    0.205853    0.994509    0.946210    0.986141    0.963675    0.946856    0.928144    0.961832    0.890446    5000        97.620500   -0.391096   -4.419288   0.531260    40.619317  

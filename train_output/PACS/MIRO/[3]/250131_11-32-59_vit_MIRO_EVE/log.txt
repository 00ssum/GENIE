[37m[36mINFO[0m[0m 01/31 11:32:59 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py vit_MIRO_EVE config/vit_MIRO_EVE.yaml --algorithm MIRO --test_envs 3 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: MIRO
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/vit_MIRO_EVE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: vit_MIRO_EVE
	out_dir: train_output/PACS/MIRO/[3]/250131_11-32-59_vit_MIRO_EVE
	out_root: train_output/PACS/MIRO/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250131_11-32-59_vit_MIRO_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: EVE
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 01/31 11:32:59 | n_steps = 5001
[37m[36mINFO[0m[0m 01/31 11:32:59 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/31 11:32:59 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/31 11:32:59 | Target test envs = [[3]]
[37m[36mINFO[0m[0m 01/31 11:32:59 | 
[37m[36mINFO[0m[0m 01/31 11:32:59 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 01/31 11:32:59 | Test envs = [3], name = te_S
[37m[36mINFO[0m[0m 01/31 11:32:59 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 01/31 11:32:59 | steps-per-epoch for each domain: 51.22, 58.62, 41.75 -> min = 41.75
[37m[36mINFO[0m[0m 01/31 11:33:03 | # of params = 172392711
[37m[36mINFO[0m[0m 01/31 11:33:37 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        reg_loss    step_time   eval_time  
[37m[36mINFO[0m[0m 01/31 11:33:37 | 0.194975    0.183439    0.130780    0.135355    1.927006    0.144600    0.149144    0.148188    0.158120    0.099551    0.098802    0.194975    0.183439    0           0.000000    1.390946    -5.756463   1.198397    33.316104  
[37m[36mINFO[0m[0m 01/31 11:36:03 | 0.267812    0.256051    0.612971    0.633157    1.035775    0.477120    0.488998    0.625267    0.655983    0.736527    0.754491    0.267812    0.256051    200         4.790419    3.235856    15.487075   0.518478    40.888866  
[37m[36mINFO[0m[0m 01/31 11:38:23 | 0.414122    0.412739    0.860292    0.870531    0.368328    0.791336    0.804401    0.865139    0.891026    0.924401    0.916168    0.414122    0.412739    400         9.580838    0.353556    -2.652310   0.508456    36.682971  
[37m[36mINFO[0m[0m 01/31 11:40:45 | 0.430662    0.417834    0.885979    0.889424    0.340234    0.810250    0.799511    0.908316    0.916667    0.939371    0.952096    0.430662    0.417834    600         14.371257   -0.038664   -3.465281   0.521965    36.265270  
[37m[36mINFO[0m[0m 01/31 11:43:05 | 0.448473    0.456051    0.940896    0.924806    0.221880    0.904210    0.875306    0.942431    0.938034    0.976048    0.961078    0.448473    0.456051    800         19.161677   -0.162233   -3.623857   0.515700    35.371160  
[37m[36mINFO[0m[0m 01/31 11:45:25 | 0.522901    0.491720    0.950046    0.924219    0.234768    0.927395    0.885086    0.946695    0.929487    0.976048    0.958084    0.522901    0.491720    1000        23.952096   -0.223213   -3.765039   0.523833    34.027430  
[37m[36mINFO[0m[0m 01/31 11:47:46 | 0.449746    0.461146    0.978826    0.936555    0.183124    0.964002    0.897311    0.979211    0.957265    0.993263    0.955090    0.449746    0.461146    1200        28.742515   -0.296010   -3.963195   0.512350    38.932348  
[37m[36mINFO[0m[0m 01/31 11:50:07 | 0.461196    0.472611    0.978120    0.929348    0.232833    0.971934    0.902200    0.978145    0.948718    0.984281    0.937126    0.461196    0.472611    1400        33.532934   -0.324049   -4.037717   0.521288    34.764373  
[37m[36mINFO[0m[0m 01/31 11:52:30 | 0.411578    0.396178    0.986312    0.940570    0.196964    0.978035    0.904645    0.986141    0.952991    0.994760    0.964072    0.411578    0.396178    1600        38.323353   -0.348302   -4.082429   0.509691    41.202537  
[37m[36mINFO[0m[0m 01/31 11:54:53 | 0.395356    0.392357    0.981779    0.949554    0.163518    0.972544    0.921760    0.980277    0.950855    0.992515    0.976048    0.395356    0.392357    1800        43.113772   -0.358977   -4.131655   0.529230    35.445247  
[37m[36mINFO[0m[0m 01/31 11:57:24 | 0.487277    0.473885    0.987365    0.945640    0.168894    0.976815    0.899756    0.988273    0.955128    0.997006    0.982036    0.487277    0.473885    2000        47.904192   -0.350212   -4.067560   0.518315    46.477761  
[37m[36mINFO[0m[0m 01/31 11:59:42 | 0.548982    0.523567    0.990502    0.943702    0.183053    0.982916    0.887531    0.989339    0.961538    0.999251    0.982036    0.548982    0.523567    2200        52.694611   -0.372724   -4.155130   0.511948    34.743636  
[37m[36mINFO[0m[0m 01/31 12:02:09 | 0.504771    0.473885    0.993372    0.952403    0.150226    0.992068    0.921760    0.992537    0.959402    0.995509    0.976048    0.504771    0.473885    2400        57.485030   -0.404034   -4.309087   0.522451    42.689248  
[37m[36mINFO[0m[0m 01/31 12:04:27 | 0.555662    0.526115    0.994491    0.953504    0.155665    0.989018    0.924205    0.995203    0.957265    0.999251    0.979042    0.555662    0.526115    2600        62.275449   -0.408187   -4.359598   0.510791    34.694505  
[37m[36mINFO[0m[0m 01/31 12:07:03 | 0.555344    0.554140    0.988011    0.946862    0.157524    0.982916    0.911980    0.985608    0.961538    0.995509    0.967066    0.555344    0.554140    2800        67.065868   -0.412455   -4.382462   0.510416    52.325762  
[37m[36mINFO[0m[0m 01/31 12:09:24 | 0.416985    0.412739    0.992671    0.959997    0.141215    0.987187    0.936430    0.993070    0.976496    0.997754    0.967066    0.416985    0.412739    3000        71.856287   -0.420481   -4.419101   0.509598    39.202172  
[37m[36mINFO[0m[0m 01/31 12:11:44 | 0.508906    0.487898    0.995402    0.949224    0.165970    0.992068    0.907090    0.994136    0.961538    1.000000    0.979042    0.508906    0.487898    3200        76.646707   -0.415413   -4.385762   0.516000    34.549247  
[37m[36mINFO[0m[0m 01/31 12:14:09 | 0.491412    0.459873    0.996355    0.969554    0.101276    0.994509    0.953545    0.996802    0.970085    0.997754    0.985030    0.491412    0.459873    3400        81.437126   -0.430248   -4.468255   0.521756    41.105035  
[37m[36mINFO[0m[0m 01/31 12:16:31 | 0.485687    0.482803    0.998201    0.962976    0.125594    0.996949    0.946210    0.998401    0.963675    0.999251    0.979042    0.485687    0.482803    3600        86.227545   -0.439149   -4.525404   0.522611    36.110689  
[37m[36mINFO[0m[0m 01/31 12:18:57 | 0.668257    0.687898    0.999467    0.986887    0.049473    1.000000    0.982885    0.998401    0.980769    1.000000    0.997006    0.668257    0.687898    3800        91.017964   -0.467761   -4.718944   0.510469    43.220444  
[37m[36mINFO[0m[0m 01/31 12:21:29 | 0.718511    0.736306    0.999593    0.991652    0.029786    0.998780    0.987775    1.000000    0.987179    1.000000    1.000000    0.718511    0.736306    4000        95.808383   -0.487025   -4.892191   0.507230    48.904094  
[37m[36mINFO[0m[0m 01/31 12:23:45 | 0.842875    0.858599    0.999390    0.994603    0.015222    0.998170    0.990220    1.000000    0.993590    1.000000    1.000000    0.842875    0.858599    4200        100.598802  -0.503701   -5.049630   0.511390    32.521619  
[37m[36mINFO[0m[0m 01/31 12:26:05 | 0.862595    0.876433    1.000000    0.995418    0.014238    1.000000    0.992665    1.000000    0.993590    1.000000    1.000000    0.862595    0.876433    4400        105.389222  -0.512735   -5.137972   0.520098    34.259104  
[37m[36mINFO[0m[0m 01/31 12:28:28 | 0.891539    0.903185    1.000000    0.996131    0.011397    1.000000    0.992665    1.000000    0.995726    1.000000    1.000000    0.891539    0.903185    4600        110.179641  -0.521056   -5.217899   0.518961    37.940879  
[37m[36mINFO[0m[0m 01/31 12:30:52 | 0.892494    0.907006    1.000000    0.996843    0.009807    1.000000    0.992665    1.000000    0.997863    1.000000    1.000000    0.892494    0.907006    4800        114.970060  -0.525631   -5.264114   0.521311    38.961437  
[37m[36mINFO[0m[0m 01/31 12:33:10 | 0.883588    0.898089    0.999593    0.997658    0.007715    0.998780    0.995110    1.000000    0.997863    1.000000    1.000000    0.883588    0.898089    5000        119.760479  -0.529434   -5.304601   0.503789    34.938894  

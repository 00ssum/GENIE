[37m[36mINFO[0m[0m 03/26 14:33:24 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm ERM_visual --test_envs 0 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.22.4
	PIL: 9.4.0
Args:
	algorithm: ERM_visual
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/PACS/ERM_visual/[0]/250326_14-33-24_resnet50_sgd
	out_root: train_output/PACS/ERM_visual/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250326_14-33-24_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/26 14:33:24 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 14:33:24 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 14:33:24 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 14:33:24 | 
[37m[36mINFO[0m[0m 03/26 14:33:24 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/26 14:33:24 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/26 14:33:24 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/26 14:33:24 | Batch sizes for each domain: [0, 32, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/26 14:33:24 | steps-per-epoch for each domain: 58.62, 41.75, 98.25 -> min = 41.75
[37m[36mINFO[0m[0m 03/26 14:33:25 | # of params = 23522375
[37m[36mINFO[0m[0m 03/26 14:33:25 | Extracting features BEFORE training...
[37m[36mINFO[0m[0m 03/26 14:34:00 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 14:34:00 | 0.158633    0.183374    0.107102    0.096581    2.012661    0.158633    0.183374    0.184435    0.151709    0.062126    0.062874    0.074746    0.075159    0           0.000000    1.997718    4.188383    31.516824  
[37m[36mINFO[0m[0m 03/26 14:35:33 | 0.208054    0.207824    0.219453    0.219974    1.883627    0.208054    0.207824    0.256930    0.243590    0.203593    0.203593    0.197837    0.212739    200         4.790419    1.936757    0.313141    29.629496  
[37m[36mINFO[0m[0m 03/26 14:37:03 | 0.239780    0.239609    0.340773    0.318088    1.783082    0.239780    0.239609    0.319829    0.301282    0.448353    0.398204    0.254135    0.254777    400         9.580838    1.824064    0.299082    30.996296  
[37m[36mINFO[0m[0m 03/26 14:38:31 | 0.311775    0.334963    0.437289    0.433807    1.668275    0.311775    0.334963    0.386994    0.423077    0.580090    0.500000    0.344784    0.378344    600         14.371257   1.717848    0.281058    31.053752  
[37m[36mINFO[0m[0m 03/26 14:39:54 | 0.410616    0.418093    0.547863    0.562277    1.523160    0.410616    0.418093    0.486674    0.491453    0.725299    0.712575    0.431616    0.482803    800         19.161677   1.585416    0.265108    30.633730  
[37m[36mINFO[0m[0m 03/26 14:41:15 | 0.486272    0.488998    0.611645    0.623598    1.349603    0.486272    0.488998    0.541578    0.538462    0.799401    0.802395    0.493957    0.529936    1000        23.952096   1.424707    0.252659    30.123222  
[37m[36mINFO[0m[0m 03/26 14:42:35 | 0.528981    0.518337    0.653642    0.670279    1.166296    0.528981    0.518337    0.591151    0.611111    0.846557    0.844311    0.523219    0.555414    1200        28.742515   1.245120    0.247085    30.594557  
[37m[36mINFO[0m[0m 03/26 14:43:55 | 0.571080    0.559902    0.693789    0.722330    0.997173    0.571080    0.559902    0.621535    0.655983    0.889222    0.907186    0.570611    0.603822    1400        33.532934   1.076771    0.246220    30.658384  
[37m[36mINFO[0m[0m 03/26 14:45:16 | 0.599146    0.594132    0.731287    0.761982    0.850566    0.599146    0.594132    0.663113    0.705128    0.925150    0.931138    0.605598    0.649682    1600        38.323353   0.915152    0.254395    30.407929  
[37m[36mINFO[0m[0m 03/26 14:46:42 | 0.629042    0.638142    0.767339    0.781327    0.735823    0.629042    0.638142    0.707356    0.732906    0.935629    0.946108    0.659033    0.664968    1800        43.113772   0.793952    0.276124    30.665538  
[37m[36mINFO[0m[0m 03/26 14:48:12 | 0.646736    0.638142    0.785263    0.795651    0.651499    0.646736    0.638142    0.721215    0.739316    0.953593    0.952096    0.680980    0.695541    2000        47.904192   0.707842    0.294073    31.303864  
[37m[36mINFO[0m[0m 03/26 14:49:45 | 0.665650    0.660147    0.802349    0.819236    0.579503    0.665650    0.660147    0.739339    0.777778    0.960329    0.955090    0.707379    0.724841    2200        52.694611   0.624771    0.312021    30.442241  
[37m[36mINFO[0m[0m 03/26 14:51:20 | 0.663209    0.650367    0.814182    0.831186    0.527772    0.663209    0.650367    0.753731    0.792735    0.961078    0.967066    0.727735    0.733758    2400        57.485030   0.560011    0.326108    29.962821  
[37m[36mINFO[0m[0m 03/26 14:52:58 | 0.675412    0.655257    0.830803    0.847510    0.479622    0.675412    0.655257    0.776652    0.807692    0.962575    0.973054    0.753181    0.761783    2600        62.275449   0.522226    0.337698    30.547803  
[37m[36mINFO[0m[0m 03/26 14:54:35 | 0.676632    0.652812    0.841135    0.858029    0.446180    0.676632    0.652812    0.793710    0.829060    0.968563    0.973054    0.761132    0.771975    2800        67.065868   0.485577    0.327206    30.958529  
[37m[36mINFO[0m[0m 03/26 14:56:10 | 0.682733    0.665037    0.845838    0.865988    0.413945    0.682733    0.665037    0.792644    0.844017    0.970060    0.973054    0.774809    0.780892    3000        71.856287   0.445751    0.314242    31.931585  
[37m[36mINFO[0m[0m 03/26 14:57:41 | 0.686394    0.667482    0.857760    0.872670    0.390453    0.686394    0.667482    0.809701    0.854701    0.976048    0.976048    0.787532    0.787261    3200        76.646707   0.426796    0.304838    30.187535  
[37m[36mINFO[0m[0m 03/26 14:59:09 | 0.693106    0.667482    0.869019    0.881176    0.364752    0.693106    0.667482    0.821962    0.861111    0.975299    0.976048    0.809796    0.806369    3400        81.437126   0.398469    0.285815    30.565024  
[37m[36mINFO[0m[0m 03/26 15:00:31 | 0.694326    0.669927    0.872595    0.886710    0.344502    0.694326    0.669927    0.826759    0.867521    0.974551    0.976048    0.816476    0.816561    3600        86.227545   0.381825    0.265058    29.731805  
[37m[36mINFO[0m[0m 03/26 15:01:52 | 0.699817    0.674817    0.878242    0.892091    0.327710    0.699817    0.674817    0.832623    0.865385    0.980539    0.979042    0.821565    0.831847    3800        91.017964   0.363658    0.250264    30.881876  
[37m[36mINFO[0m[0m 03/26 15:03:10 | 0.707749    0.672372    0.882694    0.896513    0.313787    0.707749    0.672372    0.839019    0.878205    0.976048    0.982036    0.833015    0.829299    4000        95.808383   0.347569    0.241671    29.370620  
[37m[36mINFO[0m[0m 03/26 15:04:31 | 0.712630    0.691932    0.883611    0.897774    0.303722    0.712630    0.691932    0.837953    0.871795    0.976048    0.982036    0.836832    0.839490    4200        100.598802  0.334562    0.249093    31.051301  
[37m[36mINFO[0m[0m 03/26 15:05:55 | 0.724832    0.706601    0.890738    0.903732    0.283200    0.724832    0.706601    0.852878    0.878205    0.974551    0.982036    0.844784    0.850955    4400        105.389222  0.318359    0.268677    30.376914  
[37m[36mINFO[0m[0m 03/26 15:07:26 | 0.724222    0.699267    0.894392    0.908992    0.275257    0.724222    0.699267    0.856077    0.888889    0.977545    0.982036    0.849555    0.856051    4600        110.179641  0.309652    0.303618    30.539800  
[37m[36mINFO[0m[0m 03/26 15:09:02 | 0.732154    0.713936    0.897792    0.910988    0.259864    0.732154    0.713936    0.852878    0.888889    0.982036    0.988024    0.858461    0.856051    4800        114.970060  0.298431    0.321949    31.349463  
[37m[36mINFO[0m[0m 03/26 15:10:40 | 0.732154    0.701711    0.904716    0.914663    0.252216    0.732154    0.701711    0.867271    0.893162    0.984281    0.982036    0.862595    0.868790    5000        119.760479  0.276797    0.333763    31.021552  
[37m[36mINFO[0m[0m 03/26 15:10:40 | Extracting features AFTER training...
[37m[36mINFO[0m[0m 03/26 15:10:43 | Feature representations saved to disk.
[37m[36mINFO[0m[0m 03/26 15:10:43 | Cumulative gradient change saved at train_output/PACS/ERM_visual/[0]/250326_14-33-24_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 15:10:44 | ---
[37m[36mINFO[0m[0m 03/26 15:10:44 | test-domain validation(oracle) = 73.215%
[37m[36mINFO[0m[0m 03/26 15:10:44 | training-domain validation(iid) = 73.215%
[37m[36mINFO[0m[0m 03/26 15:10:44 | last = 73.215%
[37m[36mINFO[0m[0m 03/26 15:10:44 | last (inD) = 91.466%
[37m[36mINFO[0m[0m 03/26 15:10:44 | training-domain validation (iid, inD) = 91.466%
[37m[36mINFO[0m[0m 03/26 15:10:44 | === Summary ===
[37m[36mINFO[0m[0m 03/26 15:10:44 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm ERM_visual --test_envs 0 --dataset PACS
[37m[36mINFO[0m[0m 03/26 15:10:44 | Unique name: 250326_14-33-24_resnet50_sgd
[37m[36mINFO[0m[0m 03/26 15:10:44 | Out path: train_output/PACS/ERM_visual/[0]/250326_14-33-24_resnet50_sgd
[37m[36mINFO[0m[0m 03/26 15:10:44 | Algorithm: ERM_visual
[37m[36mINFO[0m[0m 03/26 15:10:44 | Dataset: PACS

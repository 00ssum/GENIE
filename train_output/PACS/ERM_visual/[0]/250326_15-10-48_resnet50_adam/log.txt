[37m[36mINFO[0m[0m 03/26 15:10:48 | Command :: /jsm0707/GENIE/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm ERM_visual --test_envs 0 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.22.4
	PIL: 9.4.0
Args:
	algorithm: ERM_visual
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_adam.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_adam
	out_dir: train_output/PACS/ERM_visual/[0]/250326_15-10-48_resnet50_adam
	out_root: train_output/PACS/ERM_visual/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250326_15-10-48_resnet50_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/26 15:10:48 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 15:10:48 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 15:10:48 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 15:10:48 | 
[37m[36mINFO[0m[0m 03/26 15:10:48 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/26 15:10:48 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/26 15:10:48 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/26 15:10:48 | Batch sizes for each domain: [0, 32, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/26 15:10:48 | steps-per-epoch for each domain: 58.62, 41.75, 98.25 -> min = 41.75
[37m[36mINFO[0m[0m 03/26 15:10:49 | # of params = 23522375
[37m[36mINFO[0m[0m 03/26 15:10:49 | Extracting features BEFORE training...
[37m[36mINFO[0m[0m 03/26 15:11:25 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 15:11:25 | 0.257474    0.237164    0.293052    0.285536    1.839943    0.257474    0.237164    0.270789    0.297009    0.376497    0.344311    0.231870    0.215287    0           0.000000    1.997718    4.779367    30.931640  
[37m[36mINFO[0m[0m 03/26 15:12:45 | 0.732764    0.753056    0.918279    0.917049    0.260839    0.732764    0.753056    0.905117    0.914530    0.969311    0.955090    0.880407    0.881529    200         4.790419    0.269159    0.252868    29.508506  
[37m[36mINFO[0m[0m 03/26 15:14:03 | 0.824893    0.831296    0.988631    0.963922    0.103486    0.824893    0.831296    0.992537    0.967949    0.996257    0.976048    0.977099    0.947771    400         9.580838    0.082551    0.229465    31.624713  
[37m[36mINFO[0m[0m 03/26 15:15:24 | 0.816962    0.838631    0.982215    0.954260    0.151797    0.816962    0.838631    0.982942    0.963675    0.995509    0.964072    0.968193    0.935032    600         14.371257   0.049842    0.250567    30.731006  
[37m[36mINFO[0m[0m 03/26 15:16:41 | 0.892007    0.897311    0.992239    0.968478    0.116333    0.892007    0.897311    0.995203    0.970085    0.995509    0.985030    0.986005    0.950318    800         19.161677   0.044527    0.228993    31.533397  
[37m[36mINFO[0m[0m 03/26 15:18:06 | 0.847468    0.855746    0.986486    0.963361    0.135383    0.847468    0.855746    0.986141    0.970085    0.991766    0.976048    0.981552    0.943949    1000        23.952096   0.031188    0.258672    33.374889  
[37m[36mINFO[0m[0m 03/26 15:19:29 | 0.826724    0.831296    0.992841    0.961500    0.128810    0.826724    0.831296    0.990405    0.963675    0.999251    0.973054    0.988868    0.947771    1200        28.742515   0.031024    0.258280    31.838336  
[37m[36mINFO[0m[0m 03/26 15:20:47 | 0.887126    0.887531    0.995183    0.967768    0.131358    0.887126    0.887531    0.994136    0.972222    1.000000    0.982036    0.991412    0.949045    1400        33.532934   0.028778    0.230785    31.802993  
[37m[36mINFO[0m[0m 03/26 15:22:07 | 0.863331    0.880196    0.998475    0.971589    0.129771    0.863331    0.880196    0.999467    0.972222    0.998503    0.982036    0.997455    0.960510    1600        38.323353   0.024739    0.243582    30.795385  
[37m[36mINFO[0m[0m 03/26 15:23:29 | 0.768151    0.797066    0.987247    0.958242    0.194534    0.768151    0.797066    0.993603    0.965812    0.993263    0.970060    0.974873    0.938854    1800        43.113772   0.014189    0.260660    30.060442  
[37m[36mINFO[0m[0m 03/26 15:24:49 | 0.822453    0.811736    0.988940    0.953230    0.156425    0.822453    0.811736    0.993070    0.965812    0.992515    0.946108    0.981234    0.947771    2000        47.904192   0.021776    0.241423    31.242540  
[37m[36mINFO[0m[0m 03/26 15:26:07 | 0.858450    0.870416    0.995601    0.962353    0.143816    0.858450    0.870416    0.993070    0.972222    0.998503    0.967066    0.995229    0.947771    2200        52.694611   0.018486    0.235091    31.538090  
[37m[36mINFO[0m[0m 03/26 15:27:31 | 0.817572    0.826406    0.988333    0.958216    0.178241    0.817572    0.826406    0.986141    0.957265    0.994760    0.967066    0.984097    0.950318    2400        57.485030   0.019068    0.257620    31.751501  
[37m[36mINFO[0m[0m 03/26 15:28:52 | 0.792556    0.784841    0.993873    0.952675    0.174750    0.792556    0.784841    0.997335    0.957265    0.997006    0.958084    0.987277    0.942675    2600        62.275449   0.010176    0.250828    30.996602  
[37m[36mINFO[0m[0m 03/26 15:30:12 | 0.766321    0.779951    0.990771    0.949368    0.171141    0.766321    0.779951    0.988273    0.946581    0.993263    0.946108    0.990776    0.955414    2800        67.065868   0.014082    0.227253    34.581457  
[37m[36mINFO[0m[0m 03/26 15:31:34 | 0.818182    0.845966    0.997409    0.968593    0.128872    0.818182    0.845966    0.997335    0.967949    0.997754    0.976048    0.997137    0.961783    3000        71.856287   0.020054    0.257659    31.044427  
[37m[36mINFO[0m[0m 03/26 15:32:55 | 0.837706    0.845966    0.995862    0.966186    0.119513    0.837706    0.845966    0.998401    0.974359    1.000000    0.970060    0.989186    0.954140    3200        76.646707   0.015922    0.256065    29.700571  
[37m[36mINFO[0m[0m 03/26 15:34:12 | 0.671141    0.682152    0.980374    0.938569    0.224780    0.671141    0.682152    0.965352    0.916667    0.993263    0.955090    0.982506    0.943949    3400        81.437126   0.017633    0.227795    31.207014  
[37m[36mINFO[0m[0m 03/26 15:35:33 | 0.768761    0.797066    0.991881    0.960203    0.142783    0.768761    0.797066    0.990405    0.959402    0.997006    0.967066    0.988232    0.954140    3600        86.227545   0.016124    0.250596    31.211260  
[37m[36mINFO[0m[0m 03/26 15:36:56 | 0.808420    0.823961    0.996670    0.957389    0.214422    0.808420    0.823961    0.995736    0.957265    1.000000    0.976048    0.994275    0.938854    3800        91.017964   0.011923    0.257933    31.476584  
[37m[36mINFO[0m[0m 03/26 15:38:13 | 0.790116    0.797066    0.996985    0.959334    0.151343    0.790116    0.797066    0.994136    0.940171    1.000000    0.976048    0.996819    0.961783    4000        95.808383   0.011525    0.232217    30.391966  
[37m[36mINFO[0m[0m 03/26 15:39:33 | 0.824283    0.845966    0.997484    0.966321    0.121158    0.824283    0.845966    0.997335    0.967949    0.999251    0.973054    0.995865    0.957962    4200        100.598802  0.016307    0.244350    31.292404  
[37m[36mINFO[0m[0m 03/26 15:40:55 | 0.888957    0.867971    0.998123    0.964200    0.174472    0.888957    0.867971    0.998934    0.972222    0.999251    0.970060    0.996183    0.950318    4400        105.389222  0.012494    0.259024    30.243626  
[37m[36mINFO[0m[0m 03/26 15:42:14 | 0.880415    0.872861    0.997552    0.964339    0.172646    0.880415    0.872861    0.998401    0.974359    0.997754    0.967066    0.996501    0.951592    4600        110.179641  0.009306    0.234478    31.364218  
[37m[36mINFO[0m[0m 03/26 15:43:34 | 0.855400    0.853301    0.997661    0.960940    0.168473    0.855400    0.853301    0.998934    0.970085    0.998503    0.970060    0.995547    0.942675    4800        114.970060  0.013388    0.235825    33.436966  
[37m[36mINFO[0m[0m 03/26 15:44:57 | 0.854179    0.863081    0.996741    0.959643    0.229143    0.854179    0.863081    0.998401    0.965812    0.998503    0.964072    0.993321    0.949045    5000        119.760479  0.008767    0.258417    31.370161  
[37m[36mINFO[0m[0m 03/26 15:44:57 | Extracting features AFTER training...
[37m[36mINFO[0m[0m 03/26 15:45:00 | Feature representations saved to disk.
[37m[36mINFO[0m[0m 03/26 15:45:00 | Cumulative gradient change saved at train_output/PACS/ERM_visual/[0]/250326_15-10-48_resnet50_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 15:45:01 | ---
[37m[36mINFO[0m[0m 03/26 15:45:01 | test-domain validation(oracle) = 89.201%
[37m[36mINFO[0m[0m 03/26 15:45:01 | training-domain validation(iid) = 86.333%
[37m[36mINFO[0m[0m 03/26 15:45:01 | last = 85.418%
[37m[36mINFO[0m[0m 03/26 15:45:01 | last (inD) = 95.964%
[37m[36mINFO[0m[0m 03/26 15:45:01 | training-domain validation (iid, inD) = 97.159%
[37m[36mINFO[0m[0m 03/26 15:45:02 | === Summary ===
[37m[36mINFO[0m[0m 03/26 15:45:02 | Command: /jsm0707/GENIE/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm ERM_visual --test_envs 0 --dataset PACS
[37m[36mINFO[0m[0m 03/26 15:45:02 | Unique name: 250326_15-10-48_resnet50_adam
[37m[36mINFO[0m[0m 03/26 15:45:02 | Out path: train_output/PACS/ERM_visual/[0]/250326_15-10-48_resnet50_adam
[37m[36mINFO[0m[0m 03/26 15:45:02 | Algorithm: ERM_visual
[37m[36mINFO[0m[0m 03/26 15:45:02 | Dataset: PACS

[37m[36mINFO[0m[0m 03/29 18:00:39 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm ERM_visual --test_envs 3 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.22.4
	PIL: 9.4.0
Args:
	algorithm: ERM_visual
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/PACS/ERM_visual/[3]/250329_18-00-39_resnet50_sgd
	out_root: train_output/PACS/ERM_visual/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250329_18-00-39_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/29 18:00:39 | n_steps = 5001
[37m[36mINFO[0m[0m 03/29 18:00:39 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/29 18:00:39 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/29 18:00:39 | 
[37m[36mINFO[0m[0m 03/29 18:00:39 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 03/29 18:00:39 | Test envs = [3], name = te_S
[37m[36mINFO[0m[0m 03/29 18:00:39 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/29 18:00:39 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 03/29 18:00:39 | steps-per-epoch for each domain: 51.22, 58.62, 41.75 -> min = 41.75
[37m[36mINFO[0m[0m 03/29 18:00:40 | # of params = 23522375
[37m[36mINFO[0m[0m 03/29 18:00:40 | Extracting features BEFORE training...
[37m[36mINFO[0m[0m 03/29 18:01:20 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/29 18:01:20 | 0.072837    0.072611    0.139900    0.133365    1.963606    0.173887    0.183374    0.184435    0.153846    0.061377    0.062874    0.072837    0.072611    0           0.000000    1.999146    7.599050    32.250446  
[37m[36mINFO[0m[0m 03/29 18:02:56 | 0.047074    0.044586    0.255153    0.246327    1.857642    0.230018    0.239609    0.234542    0.232906    0.300898    0.266467    0.047074    0.044586    200         4.790419    1.897219    0.203066    31.884138  
[37m[36mINFO[0m[0m 03/29 18:04:24 | 0.049300    0.050955    0.335593    0.329255    1.753226    0.325198    0.344743    0.280384    0.307692    0.401198    0.335329    0.049300    0.050955    400         9.580838    1.797807    0.175859    31.679279  
[37m[36mINFO[0m[0m 03/29 18:05:51 | 0.064249    0.076433    0.464324    0.459256    1.620609    0.444783    0.457213    0.376333    0.369658    0.571856    0.550898    0.064249    0.076433    600         14.371257   1.670867    0.177057    30.900935  
[37m[36mINFO[0m[0m 03/29 18:07:18 | 0.107824    0.121019    0.588611    0.593589    1.451100    0.547895    0.530562    0.494136    0.510684    0.723802    0.739521    0.107824    0.121019    800         19.161677   1.519458    0.175909    30.489531  
[37m[36mINFO[0m[0m 03/29 18:08:45 | 0.145992    0.152866    0.680788    0.695256    1.252892    0.632703    0.657702    0.566098    0.589744    0.843563    0.838323    0.145992    0.152866    1000        23.952096   1.332875    0.175670    31.028051  
[37m[36mINFO[0m[0m 03/29 18:10:14 | 0.178117    0.179618    0.739640    0.760998    1.048294    0.697376    0.750611    0.626333    0.643162    0.895210    0.889222    0.178117    0.179618    1200        28.742515   1.131799    0.175822    32.071394  
[37m[36mINFO[0m[0m 03/29 18:11:41 | 0.227099    0.243312    0.783422    0.813415    0.853556    0.758999    0.804401    0.659382    0.698718    0.931886    0.937126    0.227099    0.243312    1400        33.532934   0.940272    0.176366    31.413300  
[37m[36mINFO[0m[0m 03/29 18:13:09 | 0.251590    0.271338    0.811427    0.841798    0.695416    0.784015    0.828851    0.704158    0.741453    0.946108    0.955090    0.251590    0.271338    1600        38.323353   0.785902    0.176277    31.292397  
[37m[36mINFO[0m[0m 03/29 18:14:36 | 0.290076    0.312102    0.826786    0.856869    0.576404    0.805979    0.848411    0.722281    0.752137    0.952096    0.970060    0.290076    0.312102    1800        43.113772   0.648230    0.175830    31.121855  
[37m[36mINFO[0m[0m 03/29 18:16:03 | 0.314885    0.332484    0.842437    0.872508    0.491358    0.820622    0.867971    0.751599    0.773504    0.955090    0.976048    0.314885    0.332484    2000        47.904192   0.561493    0.175447    30.886809  
[37m[36mINFO[0m[0m 03/29 18:17:31 | 0.327290    0.338854    0.856632    0.884292    0.430635    0.841977    0.870416    0.767591    0.803419    0.960329    0.979042    0.327290    0.338854    2200        52.694611   0.483199    0.175838    31.871509  
[37m[36mINFO[0m[0m 03/29 18:18:58 | 0.356234    0.365605    0.865800    0.892237    0.381774    0.859671    0.889976    0.776652    0.807692    0.961078    0.979042    0.356234    0.365605    2400        57.485030   0.437974    0.176544    30.147031  
[37m[36mINFO[0m[0m 03/29 18:20:25 | 0.369275    0.377070    0.874197    0.902699    0.348216    0.859671    0.894866    0.792111    0.831197    0.970808    0.982036    0.369275    0.377070    2600        62.275449   0.395261    0.176832    30.246657  
[37m[36mINFO[0m[0m 03/29 18:21:53 | 0.387087    0.392357    0.887028    0.908382    0.323763    0.877364    0.904645    0.809168    0.835470    0.974551    0.985030    0.387087    0.392357    2800        67.065868   0.369808    0.176484    32.231268  
[37m[36mINFO[0m[0m 03/29 18:23:20 | 0.394720    0.393631    0.891230    0.906466    0.302919    0.887736    0.899756    0.812900    0.837607    0.973054    0.982036    0.394720    0.393631    3000        71.856287   0.341611    0.176100    30.393661  
[37m[36mINFO[0m[0m 03/29 18:24:47 | 0.392812    0.401274    0.888537    0.914609    0.284527    0.882855    0.907090    0.809701    0.854701    0.973054    0.982036    0.392812    0.401274    3200        76.646707   0.320821    0.175634    30.458101  
[37m[36mINFO[0m[0m 03/29 18:26:14 | 0.418575    0.420382    0.898085    0.918456    0.272595    0.890177    0.907090    0.831023    0.863248    0.973054    0.985030    0.418575    0.420382    3400        81.437126   0.304840    0.176359    30.812300  
[37m[36mINFO[0m[0m 03/29 18:27:42 | 0.433842    0.435669    0.900667    0.919066    0.262919    0.893228    0.904645    0.834222    0.867521    0.974551    0.985030    0.433842    0.435669    3600        86.227545   0.295781    0.177182    31.426753  
[37m[36mINFO[0m[0m 03/29 18:29:09 | 0.444020    0.439490    0.906192    0.919778    0.253103    0.900549    0.904645    0.850213    0.869658    0.967814    0.985030    0.444020    0.439490    3800        91.017964   0.273719    0.177207    30.933305  
[37m[36mINFO[0m[0m 03/29 18:30:37 | 0.439885    0.442038    0.905355    0.920997    0.243673    0.895668    0.899756    0.844350    0.878205    0.976048    0.985030    0.439885    0.442038    4000        95.808383   0.267627    0.176162    31.577355  
[37m[36mINFO[0m[0m 03/29 18:32:06 | 0.446247    0.459873    0.907685    0.922730    0.234180    0.901159    0.907090    0.844350    0.876068    0.977545    0.985030    0.446247    0.459873    4200        100.598802  0.258746    0.177137    32.082225  
[37m[36mINFO[0m[0m 03/29 18:33:36 | 0.461514    0.459873    0.915140    0.929345    0.228267    0.912752    0.911980    0.852878    0.891026    0.979790    0.985030    0.461514    0.459873    4400        105.389222  0.247951    0.178739    33.708972  
[37m[36mINFO[0m[0m 03/29 18:35:05 | 0.461514    0.466242    0.921106    0.928736    0.219766    0.915192    0.914425    0.868337    0.886752    0.979790    0.985030    0.461514    0.466242    4600        110.179641  0.245293    0.177603    31.308468  
[37m[36mINFO[0m[0m 03/29 18:36:33 | 0.480598    0.492994    0.921460    0.930263    0.210697    0.910921    0.916870    0.873667    0.888889    0.979790    0.985030    0.480598    0.492994    4800        114.970060  0.236251    0.178341    31.928814  
[37m[36mINFO[0m[0m 03/29 18:38:00 | 0.481552    0.500637    0.926824    0.931585    0.209321    0.920073    0.914425    0.876866    0.895299    0.983533    0.985030    0.481552    0.500637    5000        119.760479  0.227099    0.176898    30.680936  
[37m[36mINFO[0m[0m 03/29 18:38:21 | Extracting features AFTER training...
[37m[36mINFO[0m[0m 03/29 18:38:28 | Feature representations saved to disk.
[37m[36mINFO[0m[0m 03/29 18:38:28 | Cumulative gradient change saved at train_output/PACS/ERM_visual/[3]/250329_18-00-39_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/29 18:38:30 | ---
[37m[36mINFO[0m[0m 03/29 18:38:30 | test-domain validation(oracle) = 48.155%
[37m[36mINFO[0m[0m 03/29 18:38:30 | training-domain validation(iid) = 48.155%
[37m[36mINFO[0m[0m 03/29 18:38:30 | last = 48.155%
[37m[36mINFO[0m[0m 03/29 18:38:30 | last (inD) = 93.158%
[37m[36mINFO[0m[0m 03/29 18:38:30 | training-domain validation (iid, inD) = 93.158%
[37m[36mINFO[0m[0m 03/29 18:38:30 | === Summary ===
[37m[36mINFO[0m[0m 03/29 18:38:30 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm ERM_visual --test_envs 3 --dataset PACS
[37m[36mINFO[0m[0m 03/29 18:38:30 | Unique name: 250329_18-00-39_resnet50_sgd
[37m[36mINFO[0m[0m 03/29 18:38:30 | Out path: train_output/PACS/ERM_visual/[3]/250329_18-00-39_resnet50_sgd
[37m[36mINFO[0m[0m 03/29 18:38:30 | Algorithm: ERM_visual
[37m[36mINFO[0m[0m 03/29 18:38:30 | Dataset: PACS

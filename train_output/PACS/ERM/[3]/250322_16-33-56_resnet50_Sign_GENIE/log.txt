[37m[36mINFO[0m[0m 03/22 16:33:56 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset PACS --trial_seed 0 --hparams_seed 15
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 15
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[3]/250322_16-33-56_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250322_16-33-56_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00010661763546249327
	batch_size: 14
	weight_decay: 9.086452814323981e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/22 16:33:56 | n_steps = 5001
[37m[36mINFO[0m[0m 03/22 16:33:56 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/22 16:33:56 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/22 16:33:56 | 
[37m[36mINFO[0m[0m 03/22 16:33:56 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 03/22 16:33:56 | Test envs = [3], name = te_S
[37m[36mINFO[0m[0m 03/22 16:33:56 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/22 16:33:56 | Batch sizes for each domain: [14, 14, 14, 0] (total=42)
[37m[36mINFO[0m[0m 03/22 16:33:56 | steps-per-epoch for each domain: 117.07, 134.00, 95.43 -> min = 95.43
[37m[36mINFO[0m[0m 03/22 16:33:57 | # of params = 23522375
[37m[36mINFO[0m[0m 03/22 16:34:30 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/22 16:34:30 | 0.196565    0.198726    0.185034    0.171655    1.926499    0.200122    0.178484    0.186567    0.153846    0.168413    0.182635    0.196565    0.198726    0           0.000000    2.085142    0.966982    32.319875  
[37m[36mINFO[0m[0m 03/22 16:35:29 | 0.678435    0.694268    0.930592    0.940318    0.185331    0.890787    0.929095    0.926439    0.918803    0.974551    0.973054    0.678435    0.694268    200         2.095808    0.450138    0.135606    31.663693  
[37m[36mINFO[0m[0m 03/22 16:36:33 | 0.767812    0.771975    0.965538    0.941228    0.168424    0.954240    0.916870    0.961087    0.933761    0.981287    0.973054    0.767812    0.771975    400         4.191617    0.178388    0.160447    31.803049  
[37m[36mINFO[0m[0m 03/22 16:37:35 | 0.742366    0.755414    0.953845    0.944055    0.171698    0.930445    0.909535    0.944563    0.946581    0.986527    0.976048    0.742366    0.755414    600         6.287425    0.142840    0.152289    31.619161  
[37m[36mINFO[0m[0m 03/22 16:38:33 | 0.715967    0.723567    0.973354    0.948438    0.150090    0.968273    0.929095    0.960021    0.940171    0.991766    0.976048    0.715967    0.723567    800         8.383234    0.101280    0.134527    31.512446  
[37m[36mINFO[0m[0m 03/22 16:39:50 | 0.769084    0.775796    0.983602    0.953748    0.146643    0.971934    0.926650    0.985608    0.961538    0.993263    0.973054    0.769084    0.775796    1000        10.479042   0.077837    0.226446    31.668460  
[37m[36mINFO[0m[0m 03/22 16:40:49 | 0.752226    0.764331    0.963417    0.945810    0.178523    0.960342    0.924205    0.945629    0.940171    0.984281    0.973054    0.752226    0.764331    1200        12.574850   0.062022    0.137794    30.944876  
[37m[36mINFO[0m[0m 03/22 16:41:48 | 0.750954    0.774522    0.986268    0.956485    0.149091    0.982916    0.951100    0.981876    0.942308    0.994012    0.976048    0.750954    0.774522    1400        14.670659   0.056391    0.134700    32.277058  
[37m[36mINFO[0m[0m 03/22 16:42:56 | 0.736323    0.729936    0.973773    0.951383    0.165635    0.959732    0.914425    0.972814    0.963675    0.988772    0.976048    0.736323    0.729936    1600        16.766467   0.047817    0.180118    32.255264  
[37m[36mINFO[0m[0m 03/22 16:43:54 | 0.770356    0.798726    0.990402    0.959004    0.148347    0.984747    0.936430    0.987207    0.961538    0.999251    0.979042    0.770356    0.798726    1800        18.862275   0.055195    0.133058    30.906835  
[37m[36mINFO[0m[0m 03/22 16:45:03 | 0.808206    0.816561    0.990068    0.965501    0.122219    0.985357    0.948655    0.989339    0.965812    0.995509    0.982036    0.808206    0.816561    2000        20.958084   0.045223    0.177063    33.523742  
[37m[36mINFO[0m[0m 03/22 16:46:05 | 0.802481    0.824204    0.990372    0.954547    0.176440    0.984137    0.938875    0.991471    0.948718    0.995509    0.976048    0.802481    0.824204    2200        23.053892   0.038002    0.146378    33.387415  
[37m[36mINFO[0m[0m 03/22 16:47:07 | 0.763677    0.745223    0.986427    0.957419    0.151981    0.979866    0.946210    0.982409    0.952991    0.997006    0.973054    0.763677    0.745223    2400        25.149701   0.032706    0.134897    34.382837  
[37m[36mINFO[0m[0m 03/22 16:48:22 | 0.815840    0.833121    0.995639    0.974223    0.119155    0.992678    0.973105    0.995736    0.961538    0.998503    0.988024    0.815840    0.833121    2600        27.245509   0.023449    0.217099    31.811163  
[37m[36mINFO[0m[0m 03/22 16:49:19 | 0.791985    0.815287    0.993117    0.957769    0.160702    0.992678    0.951100    0.986674    0.940171    1.000000    0.982036    0.791985    0.815287    2800        29.341317   0.024283    0.130750    30.764205  
[37m[36mINFO[0m[0m 03/22 16:50:21 | 0.768766    0.784713    0.989590    0.955134    0.171325    0.984137    0.929095    0.989872    0.957265    0.994760    0.979042    0.768766    0.784713    3000        31.437126   0.036742    0.146882    32.691291  
[37m[36mINFO[0m[0m 03/22 16:51:24 | 0.772901    0.783439    0.995837    0.968886    0.131182    0.991458    0.968215    0.996802    0.959402    0.999251    0.979042    0.772901    0.783439    3200        33.532934   0.025396    0.165827    29.983600  
[37m[36mINFO[0m[0m 03/22 16:52:22 | 0.769402    0.769427    0.988204    0.956097    0.146142    0.979866    0.948655    0.987740    0.946581    0.997006    0.973054    0.769402    0.769427    3400        35.628743   0.034788    0.131769    31.805284  
[37m[36mINFO[0m[0m 03/22 16:53:40 | 0.746819    0.745223    0.993886    0.960332    0.174970    0.989018    0.951100    0.994136    0.950855    0.998503    0.979042    0.746819    0.745223    3600        37.724551   0.014969    0.225368    32.237307  
[37m[36mINFO[0m[0m 03/22 16:54:38 | 0.776399    0.798726    0.993407    0.952265    0.201121    0.987797    0.938875    0.994670    0.950855    0.997754    0.967066    0.776399    0.798726    3800        39.820359   0.018517    0.137031    31.521822  
[37m[36mINFO[0m[0m 03/22 16:55:39 | 0.819656    0.805096    0.991906    0.959433    0.142596    0.988408    0.953545    0.988806    0.963675    0.998503    0.961078    0.819656    0.805096    4000        41.916168   0.014763    0.134584    33.873769  
[37m[36mINFO[0m[0m 03/22 16:56:49 | 0.708015    0.705732    0.993320    0.943749    0.263718    0.990848    0.919315    0.993603    0.950855    0.995509    0.961078    0.708015    0.705732    4200        44.011976   0.014442    0.192945    31.134482  
[37m[36mINFO[0m[0m 03/22 16:57:48 | 0.766539    0.777070    0.996622    0.960553    0.148719    0.995729    0.946210    0.994136    0.959402    1.000000    0.976048    0.766539    0.777070    4400        46.107784   0.016374    0.132541    32.720120  
[37m[36mINFO[0m[0m 03/22 16:58:58 | 0.767812    0.765605    0.998074    0.965238    0.150857    0.998170    0.955990    0.996802    0.963675    0.999251    0.976048    0.767812    0.765605    4600        48.203593   0.014539    0.179971    33.389063  
[37m[36mINFO[0m[0m 03/22 16:59:57 | 0.766221    0.773248    0.998023    0.967031    0.149718    0.996949    0.968215    0.997868    0.965812    0.999251    0.967066    0.766221    0.773248    4800        50.299401   0.012594    0.145248    30.332218  
[37m[36mINFO[0m[0m 03/22 17:00:55 | 0.739822    0.726115    0.985837    0.941921    0.267146    0.976815    0.926650    0.982942    0.938034    0.997754    0.961078    0.739822    0.726115    5000        52.395210   0.025318    0.131821    31.342024  
[37m[36mINFO[0m[0m 03/22 17:00:55 | Cumulative gradient change saved at train_output/PACS/ERM/[3]/250322_16-33-56_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/22 17:00:56 | ---
[37m[36mINFO[0m[0m 03/22 17:00:56 | test-domain validation(oracle) = 81.584%
[37m[36mINFO[0m[0m 03/22 17:00:56 | training-domain validation(iid) = 81.584%
[37m[36mINFO[0m[0m 03/22 17:00:56 | last = 73.982%
[37m[36mINFO[0m[0m 03/22 17:00:56 | last (inD) = 94.192%
[37m[36mINFO[0m[0m 03/22 17:00:56 | training-domain validation (iid, inD) = 97.422%
[37m[36mINFO[0m[0m 03/22 17:00:56 | === Summary ===
[37m[36mINFO[0m[0m 03/22 17:00:56 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset PACS --trial_seed 0 --hparams_seed 15
[37m[36mINFO[0m[0m 03/22 17:00:56 | Unique name: 250322_16-33-56_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/22 17:00:56 | Out path: train_output/PACS/ERM/[3]/250322_16-33-56_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/22 17:00:56 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/22 17:00:56 | Dataset: PACS

[37m[36mINFO[0m[0m 03/22 16:06:11 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset PACS --trial_seed 0 --hparams_seed 14
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 14
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[3]/250322_16-06-11_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250322_16-06-11_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.1399727535070965e-05
	batch_size: 16
	weight_decay: 0.00022842646099519332
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/22 16:06:11 | n_steps = 5001
[37m[36mINFO[0m[0m 03/22 16:06:11 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/22 16:06:11 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/22 16:06:11 | 
[37m[36mINFO[0m[0m 03/22 16:06:11 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 03/22 16:06:11 | Test envs = [3], name = te_S
[37m[36mINFO[0m[0m 03/22 16:06:11 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/22 16:06:11 | Batch sizes for each domain: [16, 16, 16, 0] (total=48)
[37m[36mINFO[0m[0m 03/22 16:06:11 | steps-per-epoch for each domain: 102.44, 117.25, 83.50 -> min = 83.50
[37m[36mINFO[0m[0m 03/22 16:06:13 | # of params = 23522375
[37m[36mINFO[0m[0m 03/22 16:06:45 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/22 16:06:45 | 0.212786    0.216561    0.252668    0.234026    1.888471    0.236120    0.234719    0.190299    0.155983    0.331587    0.311377    0.212786    0.216561    0           0.000000    2.002792    1.193537    31.460419  
[37m[36mINFO[0m[0m 03/22 16:07:45 | 0.549300    0.560510    0.953917    0.935979    0.176875    0.945699    0.924205    0.931770    0.916667    0.984281    0.967066    0.549300    0.560510    200         2.395210    0.363065    0.141318    31.296480  
[37m[36mINFO[0m[0m 03/22 16:09:05 | 0.465013    0.462420    0.933176    0.931253    0.242867    0.904820    0.916870    0.917910    0.918803    0.976796    0.958084    0.465013    0.462420    400         4.790419    0.136416    0.229101    34.414300  
[37m[36mINFO[0m[0m 03/22 16:10:03 | 0.662532    0.642038    0.977750    0.957887    0.132569    0.968883    0.943765    0.973348    0.950855    0.991018    0.979042    0.662532    0.642038    600         7.185629    0.108469    0.131459    31.898400  
[37m[36mINFO[0m[0m 03/22 16:11:05 | 0.756679    0.755414    0.982777    0.965992    0.110660    0.972544    0.953545    0.980277    0.959402    0.995509    0.985030    0.756679    0.755414    800         9.580838    0.070141    0.150228    32.181198  
[37m[36mINFO[0m[0m 03/22 16:12:11 | 0.749682    0.733758    0.987839    0.966030    0.113692    0.984747    0.951100    0.984009    0.967949    0.994760    0.979042    0.749682    0.733758    1000        11.976048   0.049091    0.173040    31.222075  
[37m[36mINFO[0m[0m 03/22 16:13:09 | 0.742366    0.738854    0.988922    0.955503    0.160132    0.985967    0.941320    0.984542    0.955128    0.996257    0.970060    0.742366    0.738854    1200        14.371257   0.043497    0.133834    30.908278  
[37m[36mINFO[0m[0m 03/22 16:14:25 | 0.731870    0.756688    0.992435    0.965113    0.136676    0.990848    0.946210    0.987207    0.970085    0.999251    0.979042    0.731870    0.756688    1400        16.766467   0.037659    0.217765    31.949764  
[37m[36mINFO[0m[0m 03/22 16:15:26 | 0.694020    0.699363    0.988022    0.944792    0.204524    0.986577    0.933985    0.983475    0.942308    0.994012    0.958084    0.694020    0.699363    1600        19.161677   0.046859    0.143855    32.698968  
[37m[36mINFO[0m[0m 03/22 16:16:25 | 0.777990    0.797452    0.993476    0.970045    0.123065    0.990238    0.958435    0.990938    0.963675    0.999251    0.988024    0.777990    0.797452    1800        21.556886   0.028538    0.136553    31.508206  
[37m[36mINFO[0m[0m 03/22 16:17:39 | 0.767176    0.774522    0.995889    0.973709    0.101457    0.992678    0.960880    0.995736    0.972222    0.999251    0.988024    0.767176    0.774522    2000        23.952096   0.024651    0.202900    33.464539  
[37m[36mINFO[0m[0m 03/22 16:18:37 | 0.810751    0.819108    0.995928    0.969248    0.114025    0.994509    0.963325    0.996269    0.974359    0.997006    0.970060    0.810751    0.819108    2200        26.347305   0.026404    0.136060    30.448158  
[37m[36mINFO[0m[0m 03/22 16:19:42 | 0.695611    0.710828    0.996306    0.964827    0.124393    0.997559    0.946210    0.993603    0.972222    0.997754    0.976048    0.695611    0.710828    2400        28.742515   0.016670    0.170381    31.315275  
[37m[36mINFO[0m[0m 03/22 16:20:44 | 0.693702    0.707006    0.992374    0.953869    0.215646    0.992068    0.936430    0.992537    0.970085    0.992515    0.955090    0.693702    0.707006    2600        31.137725   0.016857    0.148127    32.166779  
[37m[36mINFO[0m[0m 03/22 16:21:43 | 0.744275    0.750318    0.996859    0.964811    0.122751    0.996339    0.955990    0.995736    0.959402    0.998503    0.979042    0.744275    0.750318    2800        33.532934   0.014584    0.132186    32.622933  
[37m[36mINFO[0m[0m 03/22 16:22:58 | 0.793575    0.800000    0.992405    0.966133    0.128085    0.988408    0.953545    0.988806    0.965812    1.000000    0.979042    0.793575    0.800000    3000        35.928144   0.018330    0.222413    30.553019  
[37m[36mINFO[0m[0m 03/22 16:24:01 | 0.729962    0.755414    0.995940    0.957213    0.184113    0.993899    0.941320    0.994670    0.957265    0.999251    0.973054    0.729962    0.755414    3200        38.323353   0.018937    0.147151    33.376714  
[37m[36mINFO[0m[0m 03/22 16:25:00 | 0.785305    0.796178    0.996736    0.959879    0.159679    0.995119    0.943765    0.997335    0.965812    0.997754    0.970060    0.785305    0.796178    3400        40.718563   0.007418    0.141763    31.391803  
[37m[36mINFO[0m[0m 03/22 16:26:13 | 0.811069    0.808917    0.995971    0.967234    0.098033    0.996339    0.955990    0.993070    0.963675    0.998503    0.982036    0.811069    0.808917    3600        43.113772   0.019082    0.204089    31.587209  
[37m[36mINFO[0m[0m 03/22 16:27:14 | 0.795802    0.791083    0.991791    0.963688    0.137859    0.986577    0.946210    0.992537    0.965812    0.996257    0.979042    0.795802    0.791083    3800        45.508982   0.012416    0.132377    34.334599  
[37m[36mINFO[0m[0m 03/22 16:28:26 | 0.771310    0.765605    0.998653    0.969759    0.099876    0.997559    0.958435    0.998401    0.965812    1.000000    0.985030    0.771310    0.765605    4000        47.904192   0.010590    0.188337    34.938502  
[37m[36mINFO[0m[0m 03/22 16:29:27 | 0.787850    0.792357    0.998404    0.975339    0.087853    0.997559    0.965770    0.998401    0.972222    0.999251    0.988024    0.787850    0.792357    4200        50.299401   0.012302    0.149806    30.560231  
[37m[36mINFO[0m[0m 03/22 16:30:26 | 0.805025    0.815287    0.998785    0.965707    0.136511    0.998170    0.953545    0.998934    0.961538    0.999251    0.982036    0.805025    0.815287    4400        52.694611   0.013731    0.135546    32.372840  
[37m[36mINFO[0m[0m 03/22 16:31:44 | 0.745865    0.741401    0.998146    0.967904    0.152832    0.998170    0.958435    0.996269    0.972222    1.000000    0.973054    0.745865    0.741401    4600        55.089820   0.007795    0.222110    33.771523  
[37m[36mINFO[0m[0m 03/22 16:32:44 | 0.810115    0.820382    0.998002    0.972425    0.099053    0.998170    0.960880    0.997335    0.974359    0.998503    0.982036    0.810115    0.820382    4800        57.485030   0.012921    0.141749    31.196988  
[37m[36mINFO[0m[0m 03/22 16:33:50 | 0.756361    0.754140    0.996670    0.970818    0.111781    0.996949    0.963325    0.996802    0.970085    0.996257    0.979042    0.756361    0.754140    5000        59.880240   0.005882    0.164719    33.562063  
[37m[36mINFO[0m[0m 03/22 16:33:51 | Cumulative gradient change saved at train_output/PACS/ERM/[3]/250322_16-06-11_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/22 16:33:52 | ---
[37m[36mINFO[0m[0m 03/22 16:33:52 | test-domain validation(oracle) = 81.011%
[37m[36mINFO[0m[0m 03/22 16:33:52 | training-domain validation(iid) = 78.785%
[37m[36mINFO[0m[0m 03/22 16:33:52 | last = 75.636%
[37m[36mINFO[0m[0m 03/22 16:33:52 | last (inD) = 97.082%
[37m[36mINFO[0m[0m 03/22 16:33:52 | training-domain validation (iid, inD) = 97.534%
[37m[36mINFO[0m[0m 03/22 16:33:52 | === Summary ===
[37m[36mINFO[0m[0m 03/22 16:33:52 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset PACS --trial_seed 0 --hparams_seed 14
[37m[36mINFO[0m[0m 03/22 16:33:52 | Unique name: 250322_16-06-11_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/22 16:33:52 | Out path: train_output/PACS/ERM/[3]/250322_16-06-11_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/22 16:33:52 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/22 16:33:52 | Dataset: PACS

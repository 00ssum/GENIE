[37m[36mINFO[0m[0m 03/23 07:36:01 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset PACS --trial_seed 2 --hparams_seed 5
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 5
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[3]/250323_07-36-01_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250323_07-36-01_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.0002982828768978312
	batch_size: 9
	weight_decay: 0.0003180957897867641
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/23 07:36:01 | n_steps = 5001
[37m[36mINFO[0m[0m 03/23 07:36:01 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/23 07:36:01 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/23 07:36:01 | 
[37m[36mINFO[0m[0m 03/23 07:36:01 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 03/23 07:36:01 | Test envs = [3], name = te_S
[37m[36mINFO[0m[0m 03/23 07:36:01 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/23 07:36:01 | Batch sizes for each domain: [9, 9, 9, 0] (total=27)
[37m[36mINFO[0m[0m 03/23 07:36:01 | steps-per-epoch for each domain: 182.11, 208.44, 148.44 -> min = 148.44
[37m[36mINFO[0m[0m 03/23 07:36:02 | # of params = 23522375
[37m[36mINFO[0m[0m 03/23 07:36:34 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/23 07:36:34 | 0.196247    0.197452    0.174119    0.170427    1.940985    0.195241    0.183374    0.172175    0.175214    0.154940    0.152695    0.196247    0.197452    0           0.000000    2.017798    1.067349    30.995101  
[37m[36mINFO[0m[0m 03/23 07:37:42 | 0.506361    0.517197    0.885991    0.896654    0.320325    0.857840    0.880196    0.863006    0.884615    0.937126    0.925150    0.506361    0.517197    200         1.347305    0.545391    0.184335    31.110880  
[37m[36mINFO[0m[0m 03/23 07:38:44 | 0.658079    0.672611    0.927252    0.922837    0.222133    0.892617    0.882641    0.920576    0.918803    0.968563    0.967066    0.658079    0.672611    400         2.694611    0.257867    0.159409    30.537651  
[37m[36mINFO[0m[0m 03/23 07:39:40 | 0.683206    0.680255    0.931209    0.926755    0.222971    0.911531    0.904645    0.915778    0.899573    0.966317    0.976048    0.683206    0.680255    600         4.041916    0.212378    0.117866    32.535658  
[37m[36mINFO[0m[0m 03/23 07:40:35 | 0.773537    0.749045    0.958214    0.948465    0.148604    0.952410    0.936430    0.938699    0.920940    0.983533    0.988024    0.773537    0.749045    800         5.389222    0.176772    0.116824    31.859734  
[37m[36mINFO[0m[0m 03/23 07:41:40 | 0.716921    0.715924    0.949163    0.933570    0.202499    0.923124    0.897311    0.940832    0.927350    0.983533    0.976048    0.716921    0.715924    1000        6.736527    0.153594    0.169889    30.597492  
[37m[36mINFO[0m[0m 03/23 07:42:47 | 0.692430    0.689172    0.960723    0.936307    0.172538    0.953630    0.921760    0.939765    0.908120    0.988772    0.979042    0.692430    0.689172    1200        8.083832    0.161306    0.171448    32.594046  
[37m[36mINFO[0m[0m 03/23 07:43:43 | 0.777036    0.785987    0.963496    0.946522    0.164734    0.946309    0.924205    0.965885    0.942308    0.978293    0.973054    0.777036    0.785987    1400        9.431138    0.088001    0.119728    31.927720  
[37m[36mINFO[0m[0m 03/23 07:44:38 | 0.731870    0.714650    0.962768    0.940188    0.192507    0.945088    0.919315    0.966418    0.940171    0.976796    0.961078    0.731870    0.714650    1600        10.778443   0.130731    0.124798    30.718970  
[37m[36mINFO[0m[0m 03/23 07:45:45 | 0.773219    0.774522    0.971931    0.952940    0.141940    0.969494    0.941320    0.971748    0.944444    0.974551    0.973054    0.773219    0.774522    1800        12.125749   0.101334    0.174858    31.379260  
[37m[36mINFO[0m[0m 03/23 07:46:52 | 0.703562    0.699363    0.969730    0.952734    0.157398    0.970104    0.936430    0.952559    0.948718    0.986527    0.973054    0.703562    0.699363    2000        13.473054   0.096526    0.184271    30.274696  
[37m[36mINFO[0m[0m 03/23 07:47:46 | 0.763359    0.756688    0.985266    0.960855    0.122090    0.974375    0.936430    0.990405    0.970085    0.991018    0.976048    0.763359    0.756688    2200        14.820359   0.059457    0.117079    30.833691  
[37m[36mINFO[0m[0m 03/23 07:48:42 | 0.800254    0.810191    0.988669    0.965932    0.114287    0.979866    0.948655    0.986141    0.955128    1.000000    0.994012    0.800254    0.810191    2400        16.167665   0.050144    0.125004    30.691306  
[37m[36mINFO[0m[0m 03/23 07:49:48 | 0.792939    0.797452    0.989435    0.967086    0.105984    0.987187    0.938875    0.985608    0.974359    0.995509    0.988024    0.792939    0.797452    2600        17.514970   0.066952    0.173560    31.664880  
[37m[36mINFO[0m[0m 03/23 07:50:53 | 0.784987    0.778344    0.992676    0.966743    0.100771    0.989018    0.951100    0.992004    0.970085    0.997006    0.979042    0.784987    0.778344    2800        18.862275   0.051698    0.166003    31.408035  
[37m[36mINFO[0m[0m 03/23 07:51:48 | 0.800573    0.803822    0.983001    0.957088    0.147314    0.978035    0.931540    0.982942    0.963675    0.988024    0.976048    0.800573    0.803822    3000        20.209581   0.045809    0.121804    30.477740  
[37m[36mINFO[0m[0m 03/23 07:52:44 | 0.820611    0.826752    0.991075    0.958108    0.124238    0.984747    0.938875    0.991471    0.959402    0.997006    0.976048    0.820611    0.826752    3200        21.556886   0.056316    0.122817    31.446733  
[37m[36mINFO[0m[0m 03/23 07:53:50 | 0.827926    0.815287    0.992647    0.966522    0.153101    0.990848    0.955990    0.989339    0.961538    0.997754    0.982036    0.827926    0.815287    3400        22.904192   0.021536    0.169053    32.986886  
[37m[36mINFO[0m[0m 03/23 07:54:55 | 0.782443    0.791083    0.993983    0.959575    0.136150    0.989628    0.936430    0.993070    0.957265    0.999251    0.985030    0.782443    0.791083    3600        24.251497   0.034007    0.166771    30.849508  
[37m[36mINFO[0m[0m 03/23 07:55:51 | 0.838740    0.820382    0.991702    0.954297    0.142157    0.987797    0.919315    0.988806    0.961538    0.998503    0.982036    0.838740    0.820382    3800        25.598802   0.033663    0.129012    30.679616  
[37m[36mINFO[0m[0m 03/23 07:56:50 | 0.775763    0.798726    0.992813    0.971184    0.103533    0.991458    0.958435    0.991471    0.970085    0.995509    0.985030    0.775763    0.798726    4000        26.946108   0.025996    0.125651    33.689370  
[37m[36mINFO[0m[0m 03/23 07:58:01 | 0.737277    0.737580    0.985195    0.944305    0.189884    0.985357    0.929095    0.979211    0.933761    0.991018    0.970060    0.737277    0.737580    4200        28.293413   0.035695    0.190919    32.837847  
[37m[36mINFO[0m[0m 03/23 07:59:05 | 0.756679    0.752866    0.991437    0.964526    0.129065    0.990848    0.955990    0.987207    0.961538    0.996257    0.976048    0.756679    0.752866    4400        29.640719   0.030661    0.159938    31.913034  
[37m[36mINFO[0m[0m 03/23 08:00:04 | 0.831743    0.831847    0.997333    0.973423    0.100784    0.995729    0.960880    0.996269    0.974359    1.000000    0.985030    0.831743    0.831847    4600        30.988024   0.019818    0.124350    34.427361  
[37m[36mINFO[0m[0m 03/23 08:01:06 | 0.768448    0.777070    0.974152    0.940893    0.210399    0.956071    0.902200    0.977612    0.959402    0.988772    0.961078    0.768448    0.777070    4800        32.335329   0.036996    0.148685    31.640451  
[37m[36mINFO[0m[0m 03/23 08:02:15 | 0.801845    0.807643    0.990444    0.960573    0.128491    0.984137    0.936430    0.990938    0.957265    0.996257    0.988024    0.801845    0.807643    5000        33.682635   0.042059    0.182620    32.929497  
[37m[36mINFO[0m[0m 03/23 08:02:15 | Cumulative gradient change saved at train_output/PACS/ERM/[3]/250323_07-36-01_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/23 08:02:17 | ---
[37m[36mINFO[0m[0m 03/23 08:02:17 | test-domain validation(oracle) = 83.174%
[37m[36mINFO[0m[0m 03/23 08:02:17 | training-domain validation(iid) = 83.174%
[37m[36mINFO[0m[0m 03/23 08:02:17 | last = 80.184%
[37m[36mINFO[0m[0m 03/23 08:02:17 | last (inD) = 96.057%
[37m[36mINFO[0m[0m 03/23 08:02:17 | training-domain validation (iid, inD) = 97.342%
[37m[36mINFO[0m[0m 03/23 08:02:17 | === Summary ===
[37m[36mINFO[0m[0m 03/23 08:02:17 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset PACS --trial_seed 2 --hparams_seed 5
[37m[36mINFO[0m[0m 03/23 08:02:17 | Unique name: 250323_07-36-01_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/23 08:02:17 | Out path: train_output/PACS/ERM/[3]/250323_07-36-01_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/23 08:02:17 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/23 08:02:17 | Dataset: PACS

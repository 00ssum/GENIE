[37m[36mINFO[0m[0m 03/19 05:16:37 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 1 --hparams_seed 7
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 7
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250319_05-16-37_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 1
	unique_name: 250319_05-16-37_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00025471109765784857
	batch_size: 39
	weight_decay: 9.10622179414602e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/19 05:16:37 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 05:16:37 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 05:16:37 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 05:16:37 | 
[37m[36mINFO[0m[0m 03/19 05:16:37 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 05:16:37 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 05:16:37 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 05:16:37 | Batch sizes for each domain: [0, 39, 39, 39] (total=117)
[37m[36mINFO[0m[0m 03/19 05:16:37 | steps-per-epoch for each domain: 48.10, 34.26, 80.62 -> min = 34.26
[37m[36mINFO[0m[0m 03/19 05:16:39 | # of params = 23522375
[37m[36mINFO[0m[0m 03/19 05:17:12 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 05:17:12 | 0.141550    0.180929    0.194064    0.192680    1.888565    0.141550    0.180929    0.197228    0.245726    0.199850    0.152695    0.185115    0.179618    0           0.000000    2.034142    1.502643    31.638199  
[37m[36mINFO[0m[0m 03/19 05:18:38 | 0.824283    0.833741    0.953805    0.951133    0.138892    0.824283    0.833741    0.944563    0.927350    0.984281    0.991018    0.932570    0.935032    200         5.838323    0.378637    0.275835    31.166238  
[37m[36mINFO[0m[0m 03/19 05:20:23 | 0.882245    0.887531    0.973673    0.957818    0.117511    0.882245    0.887531    0.965885    0.942308    0.997754    0.991018    0.957379    0.940127    400         11.676647   0.107864    0.373309    30.059190  
[37m[36mINFO[0m[0m 03/19 05:21:50 | 0.863331    0.860636    0.981878    0.962244    0.117205    0.863331    0.860636    0.988273    0.963675    0.997754    0.988024    0.959606    0.935032    600         17.514970   0.056706    0.277709    31.310884  
[37m[36mINFO[0m[0m 03/19 05:23:34 | 0.857230    0.865526    0.987531    0.969298    0.109956    0.857230    0.865526    0.987740    0.952991    0.997754    0.988024    0.977099    0.966879    800         23.353293   0.045323    0.364559    31.526599  
[37m[36mINFO[0m[0m 03/19 05:25:01 | 0.881635    0.889976    0.993979    0.974570    0.099272    0.881635    0.889976    0.993070    0.965812    1.000000    0.991018    0.988868    0.966879    1000        29.191617   0.034310    0.278258    30.938052  
[37m[36mINFO[0m[0m 03/19 05:26:42 | 0.885906    0.902200    0.993627    0.965766    0.108414    0.885906    0.902200    0.993603    0.959402    1.000000    0.985030    0.987277    0.952866    1200        35.029940   0.024199    0.348896    31.169317  
[37m[36mINFO[0m[0m 03/19 05:28:10 | 0.890787    0.897311    0.995111    0.971897    0.102897    0.890787    0.897311    0.993603    0.970085    1.000000    0.994012    0.991730    0.951592    1400        40.868263   0.015170    0.282959    32.099034  
[37m[36mINFO[0m[0m 03/19 05:29:38 | 0.867602    0.860636    0.995395    0.964903    0.110419    0.867602    0.860636    0.995203    0.952991    0.999251    0.985030    0.991730    0.956688    1600        46.706587   0.013294    0.276041    32.240920  
[37m[36mINFO[0m[0m 03/19 05:31:01 | 0.860891    0.853301    0.997235    0.979544    0.090747    0.860891    0.853301    0.995203    0.978632    1.000000    0.988024    0.996501    0.971975    1800        52.544910   0.013409    0.267618    30.166355  
[37m[36mINFO[0m[0m 03/19 05:32:45 | 0.861501    0.860636    0.998725    0.975135    0.102208    0.861501    0.860636    0.999467    0.972222    0.999251    0.985030    0.997455    0.968153    2000        58.383234   0.010869    0.362547    31.010952  
[37m[36mINFO[0m[0m 03/19 05:34:09 | 0.884076    0.897311    0.997169    0.979692    0.081942    0.884076    0.897311    0.997868    0.978632    1.000000    0.991018    0.993639    0.969427    2200        64.221557   0.012619    0.265120    30.867959  
[37m[36mINFO[0m[0m 03/19 05:35:54 | 0.834045    0.828851    0.997418    0.969163    0.136017    0.834045    0.828851    0.998934    0.959402    1.000000    0.985030    0.993321    0.963057    2400        70.059880   0.010397    0.365196    32.026991  
[37m[36mINFO[0m[0m 03/19 05:37:18 | 0.856620    0.880196    0.997272    0.975857    0.092957    0.856620    0.880196    0.998401    0.972222    0.998503    0.991018    0.994911    0.964331    2600        75.898204   0.010220    0.261793    31.439528  
[37m[36mINFO[0m[0m 03/19 05:39:01 | 0.890177    0.885086    0.997730    0.975707    0.107899    0.890177    0.885086    1.000000    0.967949    0.997006    0.991018    0.996183    0.968153    2800        81.736527   0.010454    0.364065    30.543761  
[37m[36mINFO[0m[0m 03/19 05:40:24 | 0.842587    0.855746    0.995685    0.975871    0.118079    0.842587    0.855746    0.997868    0.978632    1.000000    0.991018    0.989186    0.957962    3000        87.574850   0.006170    0.262147    30.103754  
[37m[36mINFO[0m[0m 03/19 05:42:10 | 0.866382    0.860636    0.998051    0.975845    0.097904    0.866382    0.860636    0.997335    0.970085    1.000000    0.988024    0.996819    0.969427    3200        93.413174   0.008831    0.376566    31.410301  
[37m[36mINFO[0m[0m 03/19 05:43:33 | 0.858450    0.867971    0.998828    0.975857    0.102658    0.858450    0.867971    0.998934    0.972222    0.998503    0.991018    0.999046    0.964331    3400        99.251497   0.004092    0.263859    30.253579  
[37m[36mINFO[0m[0m 03/19 05:45:21 | 0.889567    0.899756    0.996137    0.977419    0.105013    0.889567    0.899756    0.994136    0.974359    1.000000    0.991018    0.994275    0.966879    3600        105.089820  0.008936    0.380948    31.169980  
[37m[36mINFO[0m[0m 03/19 05:46:45 | 0.857230    0.848411    0.997371    0.972570    0.128798    0.857230    0.848411    0.998401    0.957265    0.996257    0.991018    0.997455    0.969427    3800        110.928144  0.005557    0.263680    31.840508  
[37m[36mINFO[0m[0m 03/19 05:48:32 | 0.854790    0.850856    0.998366    0.975982    0.102674    0.854790    0.850856    0.998934    0.967949    0.997754    0.988024    0.998410    0.971975    4000        116.766467  0.007526    0.379805    31.067322  
[37m[36mINFO[0m[0m 03/19 05:49:56 | 0.829164    0.811736    0.998690    0.978978    0.099094    0.829164    0.811736    0.998934    0.972222    1.000000    0.994012    0.997137    0.970701    4200        122.604790  0.005998    0.265722    30.922606  
[37m[36mINFO[0m[0m 03/19 05:51:43 | 0.874314    0.867971    0.999258    0.981953    0.091667    0.874314    0.867971    1.000000    0.976496    1.000000    0.991018    0.997774    0.978344    4400        128.443114  0.003977    0.381350    29.853448  
[37m[36mINFO[0m[0m 03/19 05:53:08 | 0.879195    0.870416    0.999538    0.977409    0.109432    0.879195    0.870416    1.000000    0.976496    0.999251    0.985030    0.999364    0.970701    4600        134.281437  0.004640    0.264547    32.352409  
[37m[36mINFO[0m[0m 03/19 05:54:55 | 0.869433    0.855746    0.999398    0.975984    0.135273    0.869433    0.855746    0.999467    0.972222    1.000000    0.985030    0.998728    0.970701    4800        140.119760  0.001402    0.379908    31.188381  
[37m[36mINFO[0m[0m 03/19 05:56:21 | 0.881025    0.872861    0.998616    0.976845    0.116889    0.881025    0.872861    0.997868    0.974359    0.999251    0.988024    0.998728    0.968153    5000        145.958084  0.004140    0.271234    31.521395  
[37m[36mINFO[0m[0m 03/19 05:56:21 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250319_05-16-37_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 05:56:22 | ---
[37m[36mINFO[0m[0m 03/19 05:56:22 | test-domain validation(oracle) = 88.591%
[37m[36mINFO[0m[0m 03/19 05:56:22 | training-domain validation(iid) = 87.431%
[37m[36mINFO[0m[0m 03/19 05:56:22 | last = 88.103%
[37m[36mINFO[0m[0m 03/19 05:56:22 | last (inD) = 97.685%
[37m[36mINFO[0m[0m 03/19 05:56:22 | training-domain validation (iid, inD) = 98.195%
[37m[36mINFO[0m[0m 03/19 05:56:22 | === Summary ===
[37m[36mINFO[0m[0m 03/19 05:56:22 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 1 --hparams_seed 7
[37m[36mINFO[0m[0m 03/19 05:56:22 | Unique name: 250319_05-16-37_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 05:56:22 | Out path: train_output/PACS/ERM/[0]/250319_05-16-37_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 05:56:22 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 05:56:22 | Dataset: PACS

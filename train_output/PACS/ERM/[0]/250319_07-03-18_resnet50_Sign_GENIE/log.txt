[37m[36mINFO[0m[0m 03/19 07:03:18 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 1 --hparams_seed 10
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 10
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250319_07-03-18_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 1
	unique_name: 250319_07-03-18_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.2128485336217652e-05
	batch_size: 9
	weight_decay: 0.00030907441430549757
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/19 07:03:18 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 07:03:18 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 07:03:18 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 07:03:18 | 
[37m[36mINFO[0m[0m 03/19 07:03:18 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 07:03:18 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 07:03:18 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 07:03:18 | Batch sizes for each domain: [0, 9, 9, 9] (total=27)
[37m[36mINFO[0m[0m 03/19 07:03:18 | steps-per-epoch for each domain: 208.44, 148.44, 349.33 -> min = 148.44
[37m[36mINFO[0m[0m 03/19 07:03:19 | # of params = 23522375
[37m[36mINFO[0m[0m 03/19 07:03:51 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 07:03:51 | 0.205003    0.210269    0.202305    0.228160    1.970981    0.205003    0.210269    0.190832    0.241453    0.218563    0.254491    0.197519    0.188535    0           0.000000    2.022240    1.317044    30.717160  
[37m[36mINFO[0m[0m 03/19 07:04:59 | 0.816962    0.819071    0.912527    0.919193    0.231182    0.816962    0.819071    0.890725    0.886752    0.969311    0.988024    0.877545    0.882803    200         1.347305    0.608883    0.182327    31.057136  
[37m[36mINFO[0m[0m 03/19 07:05:57 | 0.779134    0.799511    0.917668    0.926572    0.222803    0.779134    0.799511    0.914179    0.912393    0.947605    0.973054    0.891221    0.894268    400         2.694611    0.251615    0.135229    31.596071  
[37m[36mINFO[0m[0m 03/19 07:06:52 | 0.793777    0.789731    0.952656    0.956972    0.133305    0.793777    0.789731    0.947761    0.950855    0.976048    0.985030    0.934160    0.935032    600         4.041916    0.219363    0.118210    30.688030  
[37m[36mINFO[0m[0m 03/19 07:07:58 | 0.836486    0.823961    0.962358    0.949684    0.134342    0.836486    0.823961    0.952559    0.914530    0.991766    0.988024    0.942748    0.946497    800         5.389222    0.153418    0.177043    31.197716  
[37m[36mINFO[0m[0m 03/19 07:08:59 | 0.806589    0.811736    0.953123    0.939565    0.170889    0.806589    0.811736    0.949893    0.912393    0.964820    0.961078    0.944656    0.945223    1000        6.736527    0.140532    0.147372    31.255699  
[37m[36mINFO[0m[0m 03/19 07:09:54 | 0.870043    0.867971    0.968924    0.954959    0.144255    0.870043    0.867971    0.958955    0.935897    0.985030    0.985030    0.962786    0.943949    1200        8.083832    0.112423    0.119507    31.134963  
[37m[36mINFO[0m[0m 03/19 07:10:54 | 0.834655    0.836186    0.974458    0.965639    0.099056    0.834655    0.836186    0.974414    0.959402    0.994760    0.991018    0.954198    0.946497    1400        9.431138    0.100205    0.145769    30.700882  
[37m[36mINFO[0m[0m 03/19 07:12:01 | 0.851739    0.858191    0.977002    0.963355    0.104124    0.851739    0.858191    0.972281    0.957265    0.996257    0.985030    0.962468    0.947771    1600        10.778443   0.082204    0.175349    32.211924  
[37m[36mINFO[0m[0m 03/19 07:12:57 | 0.834045    0.816626    0.984373    0.970460    0.090985    0.834045    0.816626    0.984009    0.963675    0.995509    0.991018    0.973601    0.956688    1800        12.125749   0.071861    0.127569    29.900351  
[37m[36mINFO[0m[0m 03/19 07:13:53 | 0.841977    0.809291    0.967472    0.945568    0.196962    0.841977    0.809291    0.946162    0.923077    0.992515    0.976048    0.963740    0.937580    2000        13.473054   0.063053    0.122561    31.515751  
[37m[36mINFO[0m[0m 03/19 07:15:00 | 0.847468    0.848411    0.973887    0.956822    0.121222    0.847468    0.848411    0.969616    0.946581    0.996257    0.985030    0.955789    0.938854    2200        14.820359   0.084594    0.181814    30.561429  
[37m[36mINFO[0m[0m 03/19 07:15:55 | 0.857230    0.850856    0.990864    0.964629    0.103878    0.857230    0.850856    0.993603    0.957265    0.997754    0.985030    0.981234    0.951592    2400        16.167665   0.060217    0.126727    29.645751  
[37m[36mINFO[0m[0m 03/19 07:16:48 | 0.846858    0.848411    0.990013    0.964780    0.117366    0.846858    0.848411    0.993070    0.961538    0.997006    0.985030    0.979962    0.947771    2600        17.514970   0.056305    0.119109    29.976531  
[37m[36mINFO[0m[0m 03/19 07:17:54 | 0.825503    0.799511    0.977407    0.956696    0.168623    0.825503    0.799511    0.979744    0.950855    0.997006    0.988024    0.955471    0.931210    2800        18.862275   0.055722    0.181467    29.600175  
[37m[36mINFO[0m[0m 03/19 07:18:54 | 0.749237    0.738386    0.982355    0.964502    0.114181    0.749237    0.738386    0.987740    0.957265    0.991766    0.991018    0.967557    0.945223    3000        20.209581   0.062488    0.139989    31.306970  
[37m[36mINFO[0m[0m 03/19 07:19:47 | 0.848078    0.863081    0.985366    0.953653    0.151128    0.848078    0.863081    0.990938    0.938034    0.992515    0.970060    0.972646    0.952866    3200        21.556886   0.050793    0.112047    30.754296  
[37m[36mINFO[0m[0m 03/19 07:20:47 | 0.816351    0.816626    0.990334    0.965754    0.111707    0.816351    0.816626    0.991471    0.957265    0.999251    0.982036    0.980280    0.957962    3400        22.904192   0.036338    0.149000    30.138121  
[37m[36mINFO[0m[0m 03/19 07:21:55 | 0.826724    0.823961    0.991182    0.969006    0.123538    0.826724    0.823961    0.995736    0.965812    0.996257    0.973054    0.981552    0.968153    3600        24.251497   0.028834    0.182962    31.367449  
[37m[36mINFO[0m[0m 03/19 07:22:49 | 0.849908    0.838631    0.993732    0.975147    0.077450    0.849908    0.838631    0.996802    0.974359    0.997754    0.988024    0.986641    0.963057    3800        25.598802   0.034230    0.119796    30.003589  
[37m[36mINFO[0m[0m 03/19 07:23:45 | 0.796217    0.789731    0.981030    0.963069    0.145289    0.796217    0.789731    0.979744    0.959402    0.991018    0.982036    0.972328    0.947771    4000        26.946108   0.030231    0.119673    32.200483  
[37m[36mINFO[0m[0m 03/19 07:24:49 | 0.802318    0.809291    0.993910    0.976853    0.072645    0.802318    0.809291    0.995203    0.967949    0.999251    0.997006    0.987277    0.965605    4200        28.293413   0.043183    0.175302    29.662427  
[37m[36mINFO[0m[0m 03/19 07:25:45 | 0.803539    0.801956    0.992025    0.975992    0.092600    0.803539    0.801956    0.988273    0.965812    0.999251    0.994012    0.988550    0.968153    4400        29.640719   0.036329    0.124971    30.083084  
[37m[36mINFO[0m[0m 03/19 07:26:40 | 0.821232    0.819071    0.990041    0.965465    0.120930    0.821232    0.819071    0.990405    0.950855    0.996257    0.985030    0.983461    0.960510    4600        30.988024   0.027877    0.122305    31.091093  
[37m[36mINFO[0m[0m 03/19 07:27:48 | 0.854179    0.865526    0.996636    0.976272    0.085268    0.854179    0.865526    0.996269    0.974359    1.000000    0.985030    0.993639    0.969427    4800        32.335329   0.032350    0.191331    30.097398  
[37m[36mINFO[0m[0m 03/19 07:28:46 | 0.860891    0.872861    0.994967    0.975986    0.081109    0.860891    0.872861    0.995736    0.976496    0.997754    0.982036    0.991412    0.969427    5000        33.682635   0.033302    0.134335    30.913693  
[37m[36mINFO[0m[0m 03/19 07:28:46 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250319_07-03-18_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 07:28:48 | ---
[37m[36mINFO[0m[0m 03/19 07:28:48 | test-domain validation(oracle) = 86.089%
[37m[36mINFO[0m[0m 03/19 07:28:48 | training-domain validation(iid) = 80.232%
[37m[36mINFO[0m[0m 03/19 07:28:48 | last = 86.089%
[37m[36mINFO[0m[0m 03/19 07:28:48 | last (inD) = 97.599%
[37m[36mINFO[0m[0m 03/19 07:28:48 | training-domain validation (iid, inD) = 97.685%
[37m[36mINFO[0m[0m 03/19 07:28:48 | === Summary ===
[37m[36mINFO[0m[0m 03/19 07:28:48 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 1 --hparams_seed 10
[37m[36mINFO[0m[0m 03/19 07:28:48 | Unique name: 250319_07-03-18_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 07:28:48 | Out path: train_output/PACS/ERM/[0]/250319_07-03-18_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 07:28:48 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 07:28:48 | Dataset: PACS

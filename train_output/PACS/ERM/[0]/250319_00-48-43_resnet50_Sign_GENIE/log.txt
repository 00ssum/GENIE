[37m[36mINFO[0m[0m 03/19 00:48:43 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 0 --hparams_seed 18
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 18
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250319_00-48-43_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250319_00-48-43_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00021894640154701087
	batch_size: 13
	weight_decay: 7.1565884139944e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/19 00:48:43 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 00:48:43 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 00:48:43 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 00:48:43 | 
[37m[36mINFO[0m[0m 03/19 00:48:43 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 00:48:43 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 00:48:43 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 00:48:43 | Batch sizes for each domain: [0, 13, 13, 13] (total=39)
[37m[36mINFO[0m[0m 03/19 00:48:43 | steps-per-epoch for each domain: 144.31, 102.77, 241.85 -> min = 102.77
[37m[36mINFO[0m[0m 03/19 00:48:44 | # of params = 23522375
[37m[36mINFO[0m[0m 03/19 00:49:16 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 00:49:16 | 0.175717    0.215159    0.255659    0.254930    1.927436    0.175717    0.215159    0.237207    0.260684    0.259731    0.245509    0.270038    0.258599    0           0.000000    1.953893    1.053241    31.068534  
[37m[36mINFO[0m[0m 03/19 00:50:16 | 0.841977    0.848411    0.926150    0.929010    0.187463    0.841977    0.848411    0.905117    0.927350    0.978293    0.973054    0.895038    0.886624    200         1.946108    0.454534    0.140412    31.791333  
[37m[36mINFO[0m[0m 03/19 00:51:19 | 0.834655    0.794621    0.949183    0.939349    0.176142    0.834655    0.794621    0.925906    0.927350    0.986527    0.976048    0.935115    0.914650    400         3.892216    0.197135    0.160292    31.082173  
[37m[36mINFO[0m[0m 03/19 00:52:19 | 0.755339    0.782396    0.950652    0.932806    0.219099    0.755339    0.782396    0.941898    0.918803    0.983533    0.970060    0.926527    0.909554    600         5.838323    0.120212    0.143356    30.947630  
[37m[36mINFO[0m[0m 03/19 00:53:17 | 0.832825    0.843521    0.954570    0.952256    0.148817    0.832825    0.843521    0.934435    0.946581    0.986527    0.970060    0.942748    0.940127    800         7.784431    0.108928    0.125138    33.278610  
[37m[36mINFO[0m[0m 03/19 00:54:25 | 0.801708    0.801956    0.968653    0.946124    0.177042    0.801708    0.801956    0.956290    0.931624    0.991018    0.964072    0.958651    0.942675    1000        9.730539    0.079558    0.179655    31.485780  
[37m[36mINFO[0m[0m 03/19 00:55:20 | 0.830384    0.877751    0.976684    0.954829    0.139401    0.830384    0.877751    0.976546    0.955128    0.993263    0.973054    0.960242    0.936306    1200        11.676647   0.070013    0.123415    30.385062  
[37m[36mINFO[0m[0m 03/19 00:56:21 | 0.855400    0.882641    0.979985    0.965646    0.126879    0.855400    0.882641    0.985608    0.976496    0.992515    0.979042    0.961832    0.941401    1400        13.622754   0.059977    0.154337    30.461404  
[37m[36mINFO[0m[0m 03/19 00:57:23 | 0.887126    0.909535    0.985052    0.965509    0.123665    0.887126    0.909535    0.987207    0.978632    0.996257    0.979042    0.971692    0.938854    1600        15.568862   0.045424    0.150222    32.005257  
[37m[36mINFO[0m[0m 03/19 00:58:23 | 0.865772    0.863081    0.989414    0.964071    0.107449    0.865772    0.863081    0.990938    0.967949    0.999251    0.979042    0.978053    0.945223    1800        17.514970   0.044174    0.138337    31.691315  
[37m[36mINFO[0m[0m 03/19 00:59:31 | 0.843807    0.845966    0.992663    0.967619    0.117165    0.843807    0.845966    0.993070    0.972222    0.997006    0.979042    0.987913    0.951592    2000        19.461078   0.038310    0.188263    30.621177  
[37m[36mINFO[0m[0m 03/19 01:00:28 | 0.824283    0.845966    0.988769    0.962187    0.121105    0.824283    0.845966    0.991471    0.957265    0.995509    0.970060    0.979326    0.959236    2200        21.407186   0.041655    0.133491    30.236076  
[37m[36mINFO[0m[0m 03/19 01:01:27 | 0.823063    0.848411    0.989336    0.961508    0.154202    0.823063    0.848411    0.991471    0.957265    0.996257    0.982036    0.980280    0.945223    2400        23.353293   0.031207    0.142104    30.830349  
[37m[36mINFO[0m[0m 03/19 01:02:27 | 0.873093    0.887531    0.988213    0.959228    0.132783    0.873093    0.887531    0.993603    0.963675    0.997754    0.970060    0.973282    0.943949    2600        25.299401   0.030916    0.143061    31.442983  
[37m[36mINFO[0m[0m 03/19 01:03:24 | 0.830384    0.836186    0.995644    0.965046    0.113100    0.830384    0.836186    0.995203    0.963675    1.000000    0.976048    0.991730    0.955414    2800        27.245509   0.029189    0.132082    30.462590  
[37m[36mINFO[0m[0m 03/19 01:04:36 | 0.889567    0.899756    0.995145    0.964770    0.101125    0.889567    0.899756    0.994136    0.963675    0.999251    0.979042    0.992048    0.951592    3000        29.191617   0.024052    0.200885    31.396888  
[37m[36mINFO[0m[0m 03/19 01:05:33 | 0.805369    0.848411    0.994684    0.964625    0.140704    0.805369    0.848411    0.994136    0.972222    0.998503    0.970060    0.991412    0.951592    3200        31.137725   0.013509    0.134949    30.660201  
[37m[36mINFO[0m[0m 03/19 01:06:30 | 0.827334    0.823961    0.994260    0.968891    0.131498    0.827334    0.823961    0.994136    0.967949    0.998503    0.982036    0.990140    0.956688    3400        33.083832   0.021001    0.131029    30.753104  
[37m[36mINFO[0m[0m 03/19 01:07:31 | 0.840146    0.850856    0.996638    0.968329    0.108171    0.840146    0.850856    1.000000    0.970085    0.998503    0.982036    0.991412    0.952866    3600        35.029940   0.021608    0.150106    30.754077  
[37m[36mINFO[0m[0m 03/19 01:08:27 | 0.838926    0.841076    0.996420    0.967897    0.109133    0.838926    0.841076    0.996802    0.976496    0.998503    0.973054    0.993957    0.954140    3800        36.976048   0.015484    0.128708    30.590403  
[37m[36mINFO[0m[0m 03/19 01:09:37 | 0.853569    0.848411    0.995641    0.969032    0.102942    0.853569    0.848411    0.996802    0.974359    0.997754    0.976048    0.992366    0.956688    4000        38.922156   0.023025    0.189296    31.389130  
[37m[36mINFO[0m[0m 03/19 01:10:35 | 0.804149    0.838631    0.991809    0.962762    0.122871    0.804149    0.838631    0.989872    0.961538    0.997006    0.970060    0.988550    0.956688    4200        40.868263   0.014837    0.134523    31.418423  
[37m[36mINFO[0m[0m 03/19 01:11:35 | 0.841367    0.848411    0.991129    0.964488    0.152885    0.841367    0.848411    0.990938    0.974359    0.993263    0.970060    0.989186    0.949045    4400        42.814371   0.010647    0.136186    32.580598  
[37m[36mINFO[0m[0m 03/19 01:12:36 | 0.807200    0.843521    0.992916    0.960662    0.162173    0.807200    0.843521    0.994670    0.965812    0.997754    0.976048    0.986323    0.940127    4600        44.760479   0.018523    0.150156    31.312941  
[37m[36mINFO[0m[0m 03/19 01:13:33 | 0.840146    0.858191    0.998725    0.963768    0.129896    0.840146    0.858191    0.998401    0.955128    1.000000    0.982036    0.997774    0.954140    4800        46.706587   0.020571    0.132263    30.271955  
[37m[36mINFO[0m[0m 03/19 01:14:39 | 0.895058    0.914425    0.998123    0.971302    0.130761    0.895058    0.914425    0.997868    0.970085    1.000000    0.982036    0.996501    0.961783    5000        48.652695   0.007051    0.173909    31.301894  
[37m[36mINFO[0m[0m 03/19 01:14:39 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250319_00-48-43_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 01:14:40 | ---
[37m[36mINFO[0m[0m 03/19 01:14:40 | test-domain validation(oracle) = 89.506%
[37m[36mINFO[0m[0m 03/19 01:14:40 | training-domain validation(iid) = 89.506%
[37m[36mINFO[0m[0m 03/19 01:14:40 | last = 89.506%
[37m[36mINFO[0m[0m 03/19 01:14:40 | last (inD) = 97.130%
[37m[36mINFO[0m[0m 03/19 01:14:40 | training-domain validation (iid, inD) = 97.130%
[37m[36mINFO[0m[0m 03/19 01:14:40 | === Summary ===
[37m[36mINFO[0m[0m 03/19 01:14:40 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 0 --hparams_seed 18
[37m[36mINFO[0m[0m 03/19 01:14:40 | Unique name: 250319_00-48-43_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 01:14:40 | Out path: train_output/PACS/ERM/[0]/250319_00-48-43_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 01:14:40 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 01:14:40 | Dataset: PACS

[37m[36mINFO[0m[0m 03/03 22:57:45 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/PACS/ERM/[0]/250303_22-57-45_clip_vitb16_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250303_22-57-45_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: clip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/03 22:57:45 | n_steps = 5001
[37m[36mINFO[0m[0m 03/03 22:57:45 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/03 22:57:45 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/03 22:57:45 | 
[37m[36mINFO[0m[0m 03/03 22:57:45 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/03 22:57:45 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/03 22:57:45 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/03 22:57:45 | Batch sizes for each domain: [0, 32, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/03 22:57:45 | steps-per-epoch for each domain: 58.62, 41.75, 98.25 -> min = 41.75
[37m[36mINFO[0m[0m 03/03 22:57:47 | # of params = 86196231
[37m[36mINFO[0m[0m 03/03 22:58:19 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/03 22:58:19 | 0.174497    0.158924    0.162292    0.157723    1.926576    0.174497    0.158924    0.160448    0.134615    0.123503    0.134731    0.202926    0.203822    0           0.000000    1.922687    1.131587    30.852241  
[37m[36mINFO[0m[0m 03/03 23:00:17 | 0.449664    0.479218    0.771742    0.784980    0.601544    0.449664    0.479218    0.805970    0.835470    0.841317    0.844311    0.667939    0.675159    200         4.790419    1.039525    0.431615    31.153258  
[37m[36mINFO[0m[0m 03/03 23:02:14 | 0.549115    0.559902    0.817865    0.824132    0.479820    0.549115    0.559902    0.850213    0.878205    0.938623    0.901198    0.664758    0.692994    400         9.580838    0.523390    0.433240    30.393200  
[37m[36mINFO[0m[0m 03/03 23:04:11 | 0.516168    0.520782    0.866735    0.864268    0.375778    0.516168    0.520782    0.889126    0.895299    0.961078    0.919162    0.750000    0.778344    600         14.371257   0.404961    0.433416    30.743466  
[37m[36mINFO[0m[0m 03/03 23:06:09 | 0.507016    0.528117    0.892505    0.868156    0.352777    0.507016    0.528117    0.942431    0.923077    0.979042    0.922156    0.756043    0.759236    800         19.161677   0.333464    0.434462    31.138639  
[37m[36mINFO[0m[0m 03/03 23:08:08 | 0.560708    0.621027    0.905157    0.872782    0.375869    0.560708    0.621027    0.953092    0.918803    0.959581    0.907186    0.802799    0.792357    1000        23.952096   0.279849    0.435919    31.016126  
[37m[36mINFO[0m[0m 03/03 23:10:07 | 0.557657    0.606357    0.913780    0.888838    0.335053    0.557657    0.606357    0.958955    0.927350    0.980539    0.925150    0.801845    0.814013    1200        28.742515   0.258750    0.434798    31.924573  
[37m[36mINFO[0m[0m 03/03 23:12:06 | 0.527761    0.533007    0.926346    0.879339    0.318639    0.527761    0.533007    0.964286    0.933761    0.984281    0.913174    0.830471    0.791083    1400        33.532934   0.217897    0.434474    32.852291  
[37m[36mINFO[0m[0m 03/03 23:14:05 | 0.579012    0.589242    0.930328    0.894209    0.338451    0.579012    0.589242    0.970149    0.927350    0.988772    0.922156    0.832061    0.833121    1600        38.323353   0.206179    0.434186    31.510921  
[37m[36mINFO[0m[0m 03/03 23:16:03 | 0.496034    0.476773    0.939564    0.900046    0.300515    0.496034    0.476773    0.973348    0.946581    0.991018    0.919162    0.854326    0.834395    1800        43.113772   0.180644    0.434864    31.807353  
[37m[36mINFO[0m[0m 03/03 23:18:01 | 0.557657    0.577017    0.943250    0.908138    0.290511    0.557657    0.577017    0.972281    0.927350    0.995509    0.946108    0.861959    0.850955    2000        47.904192   0.172098    0.434484    31.114048  
[37m[36mINFO[0m[0m 03/03 23:19:59 | 0.510677    0.515892    0.940361    0.895933    0.336379    0.510677    0.515892    0.977612    0.935897    0.982784    0.925150    0.860687    0.826752    2200        52.694611   0.167861    0.433535    30.985643  
[37m[36mINFO[0m[0m 03/03 23:21:57 | 0.597926    0.628362    0.956311    0.899743    0.322413    0.597926    0.628362    0.986674    0.933761    0.993263    0.922156    0.888995    0.843312    2400        57.485030   0.146865    0.434374    31.394142  
[37m[36mINFO[0m[0m 03/03 23:23:56 | 0.499695    0.498778    0.960935    0.894759    0.334152    0.499695    0.498778    0.984009    0.923077    0.993263    0.919162    0.905534    0.842038    2600        62.275449   0.137903    0.433932    31.714253  
[37m[36mINFO[0m[0m 03/03 23:25:54 | 0.566199    0.577017    0.960758    0.910521    0.297308    0.566199    0.577017    0.981343    0.940171    0.994760    0.925150    0.906170    0.866242    2800        67.065868   0.138761    0.433344    31.852246  
[37m[36mINFO[0m[0m 03/03 23:27:54 | 0.597926    0.594132    0.965017    0.911260    0.301401    0.597926    0.594132    0.989872    0.955128    0.995509    0.925150    0.909669    0.853503    3000        71.856287   0.123707    0.433135    32.629741  
[37m[36mINFO[0m[0m 03/03 23:29:51 | 0.523490    0.523227    0.954992    0.906402    0.306014    0.523490    0.523227    0.984009    0.940171    0.991018    0.919162    0.889949    0.859873    3200        76.646707   0.123819    0.433386    30.668755  
[37m[36mINFO[0m[0m 03/03 23:31:50 | 0.576571    0.584352    0.961304    0.900465    0.344894    0.576571    0.584352    0.985075    0.933761    0.997754    0.928144    0.901081    0.839490    3400        81.437126   0.113051    0.433515    32.081675  
[37m[36mINFO[0m[0m 03/03 23:33:48 | 0.533862    0.555012    0.971600    0.911546    0.296394    0.533862    0.555012    0.990405    0.952991    0.998503    0.928144    0.925891    0.853503    3600        86.227545   0.097626    0.432648    31.779652  
[37m[36mINFO[0m[0m 03/03 23:35:47 | 0.555827    0.547677    0.971110    0.913094    0.270110    0.555827    0.547677    0.994136    0.948718    0.997754    0.928144    0.921438    0.862420    3800        91.017964   0.091253    0.434051    32.518274  
[37m[36mINFO[0m[0m 03/03 23:37:47 | 0.581452    0.601467    0.969846    0.904905    0.333729    0.581452    0.601467    0.996802    0.961538    0.999251    0.925150    0.913486    0.828025    4000        95.808383   0.086835    0.433604    32.307130  
[37m[36mINFO[0m[0m 03/03 23:39:45 | 0.549725    0.550122    0.968593    0.903578    0.325081    0.549725    0.550122    0.991471    0.940171    0.997006    0.922156    0.917303    0.848408    4200        100.598802  0.088654    0.433020    31.698535  
[37m[36mINFO[0m[0m 03/03 23:41:42 | 0.577791    0.572127    0.974141    0.902269    0.352956    0.577791    0.572127    0.993070    0.933761    0.995509    0.913174    0.933842    0.859873    4400        105.389222  0.080785    0.432167    30.867695  
[37m[36mINFO[0m[0m 03/03 23:43:40 | 0.566199    0.567237    0.974181    0.898760    0.345226    0.566199    0.567237    0.993603    0.944444    0.997006    0.916168    0.931934    0.835669    4600        110.179641  0.082839    0.433334    31.274945  
[37m[36mINFO[0m[0m 03/03 23:45:39 | 0.545455    0.550122    0.975029    0.914229    0.312127    0.545455    0.550122    0.993603    0.946581    0.997006    0.931138    0.934478    0.864968    4800        114.970060  0.072807    0.434090    32.480679  
[37m[36mINFO[0m[0m 03/03 23:47:39 | 0.593655    0.611247    0.972653    0.918062    0.285202    0.593655    0.611247    0.990405    0.948718    0.996257    0.934132    0.931298    0.871338    5000        119.760479  0.080332    0.444290    30.602461  
[37m[36mINFO[0m[0m 03/03 23:47:39 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250303_22-57-45_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/03 23:48:30 | ---
[37m[36mINFO[0m[0m 03/03 23:48:30 | test-domain validation(oracle) = 59.793%
[37m[36mINFO[0m[0m 03/03 23:48:30 | training-domain validation(iid) = 59.365%
[37m[36mINFO[0m[0m 03/03 23:48:30 | last = 59.365%
[37m[36mINFO[0m[0m 03/03 23:48:30 | last (inD) = 91.806%
[37m[36mINFO[0m[0m 03/03 23:48:30 | training-domain validation (iid, inD) = 91.806%
[37m[36mINFO[0m[0m 03/03 23:48:30 | === Summary ===
[37m[36mINFO[0m[0m 03/03 23:48:30 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS
[37m[36mINFO[0m[0m 03/03 23:48:30 | Unique name: 250303_22-57-45_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/03 23:48:30 | Out path: train_output/PACS/ERM/[0]/250303_22-57-45_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/03 23:48:30 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/03 23:48:30 | Dataset: PACS

[37m[36mINFO[0m[0m 03/19 00:24:14 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 0 --hparams_seed 17
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 17
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250319_00-24-14_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250319_00-24-14_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00025159202447589334
	batch_size: 8
	weight_decay: 0.007781932002143384
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/19 00:24:14 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 00:24:14 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 00:24:14 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 00:24:14 | 
[37m[36mINFO[0m[0m 03/19 00:24:14 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 00:24:14 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 00:24:14 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 00:24:14 | Batch sizes for each domain: [0, 8, 8, 8] (total=24)
[37m[36mINFO[0m[0m 03/19 00:24:14 | steps-per-epoch for each domain: 234.50, 167.00, 393.00 -> min = 167.00
[37m[36mINFO[0m[0m 03/19 00:24:15 | # of params = 23522375
[37m[36mINFO[0m[0m 03/19 00:24:47 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 00:24:47 | 0.139109    0.141809    0.155373    0.143938    2.075107    0.139109    0.141809    0.152452    0.149573    0.119012    0.098802    0.194656    0.183439    0           0.000000    1.917060    0.963664    31.728225  
[37m[36mINFO[0m[0m 03/19 00:25:43 | 0.756559    0.726161    0.879354    0.894996    0.306035    0.756559    0.726161    0.827825    0.884615    0.952096    0.934132    0.858142    0.866242    200         1.197605    0.567473    0.120699    31.256586  
[37m[36mINFO[0m[0m 03/19 00:26:38 | 0.814521    0.823961    0.930261    0.943323    0.160241    0.814521    0.823961    0.914179    0.935897    0.964072    0.973054    0.912532    0.921019    400         2.395210    0.293195    0.119123    31.222980  
[37m[36mINFO[0m[0m 03/19 00:27:33 | 0.796217    0.816626    0.951199    0.942179    0.167677    0.796217    0.816626    0.934968    0.940171    0.981287    0.964072    0.937341    0.922293    600         3.592814    0.195392    0.114522    32.450851  
[37m[36mINFO[0m[0m 03/19 00:28:37 | 0.828554    0.843521    0.950259    0.952841    0.132414    0.828554    0.843521    0.922175    0.948718    0.982036    0.976048    0.946565    0.933758    800         4.790419    0.156804    0.162472    31.816924  
[37m[36mINFO[0m[0m 03/19 00:29:35 | 0.762660    0.804401    0.943442    0.942355    0.160754    0.762660    0.804401    0.942964    0.952991    0.970060    0.967066    0.917303    0.907006    1000        5.988024    0.141165    0.127461    32.555702  
[37m[36mINFO[0m[0m 03/19 00:30:33 | 0.823063    0.833741    0.960466    0.941023    0.168962    0.823063    0.833741    0.943497    0.918803    0.991018    0.973054    0.946883    0.931210    1200        7.185629    0.126619    0.124393    32.212963  
[37m[36mINFO[0m[0m 03/19 00:31:32 | 0.817572    0.811736    0.944220    0.924667    0.214502    0.817572    0.811736    0.929638    0.905983    0.966317    0.952096    0.936705    0.915924    1400        8.383234    0.096662    0.143920    30.518287  
[37m[36mINFO[0m[0m 03/19 00:32:27 | 0.840146    0.843521    0.975380    0.951941    0.153791    0.840146    0.843521    0.976546    0.955128    0.982036    0.949102    0.967557    0.951592    1600        9.580838    0.127160    0.116750    31.619699  
[37m[36mINFO[0m[0m 03/19 00:33:23 | 0.608298    0.628362    0.944749    0.901582    0.290927    0.608298    0.628362    0.931770    0.897436    0.952096    0.895210    0.950382    0.912102    1800        10.778443   0.125978    0.127175    30.561005  
[37m[36mINFO[0m[0m 03/19 00:34:20 | 0.695546    0.684597    0.948306    0.938693    0.198848    0.695546    0.684597    0.941898    0.935897    0.953593    0.931138    0.949427    0.949045    2000        11.976048   0.114039    0.122722    32.248140  
[37m[36mINFO[0m[0m 03/19 00:35:13 | 0.774253    0.794621    0.972121    0.951389    0.147003    0.774253    0.794621    0.973881    0.955128    0.981287    0.955090    0.961196    0.943949    2200        13.173653   0.122411    0.112087    30.553568  
[37m[36mINFO[0m[0m 03/19 00:36:12 | 0.771202    0.782396    0.976547    0.941705    0.200635    0.771202    0.782396    0.965885    0.927350    0.989521    0.955090    0.974237    0.942675    2400        14.371257   0.098645    0.141301    30.832154  
[37m[36mINFO[0m[0m 03/19 00:37:07 | 0.737645    0.748166    0.979144    0.951951    0.132664    0.737645    0.748166    0.974947    0.952991    0.989521    0.955090    0.972964    0.947771    2600        15.568862   0.079958    0.122820    31.064392  
[37m[36mINFO[0m[0m 03/19 00:38:02 | 0.724222    0.760391    0.936609    0.918401    0.226737    0.724222    0.760391    0.941365    0.925214    0.941617    0.919162    0.926845    0.910828    2800        16.766467   0.131261    0.111227    32.591627  
[37m[36mINFO[0m[0m 03/19 00:39:07 | 0.704698    0.721271    0.961466    0.934430    0.221684    0.704698    0.721271    0.946162    0.920940    0.980539    0.937126    0.957697    0.945223    3000        17.964072   0.130850    0.166746    31.244411  
[37m[36mINFO[0m[0m 03/19 00:40:02 | 0.728493    0.731051    0.945980    0.925757    0.215513    0.728493    0.731051    0.938699    0.923077    0.958084    0.919162    0.941158    0.935032    3200        19.161677   0.142462    0.118196    31.364639  
[37m[36mINFO[0m[0m 03/19 00:40:59 | 0.724832    0.750611    0.969380    0.936415    0.210148    0.724832    0.750611    0.973348    0.946581    0.974551    0.916168    0.960242    0.946497    3400        20.359281   0.139679    0.124003    32.481847  
[37m[36mINFO[0m[0m 03/19 00:41:56 | 0.638194    0.650367    0.947572    0.927058    0.235607    0.638194    0.650367    0.952026    0.935897    0.962575    0.919162    0.928117    0.926115    3600        21.556886   0.102238    0.128559    31.601217  
[37m[36mINFO[0m[0m 03/19 00:42:49 | 0.752288    0.743276    0.967671    0.933014    0.187966    0.752288    0.743276    0.953625    0.938034    0.982784    0.922156    0.966603    0.938854    3800        22.754491   0.138069    0.111494    30.159450  
[37m[36mINFO[0m[0m 03/19 00:43:50 | 0.750458    0.743276    0.960200    0.938441    0.190154    0.750458    0.743276    0.950426    0.940171    0.979790    0.940120    0.950382    0.935032    4000        23.952096   0.114569    0.146232    31.839816  
[37m[36mINFO[0m[0m 03/19 00:44:48 | 0.544844    0.579462    0.937457    0.900271    0.310493    0.544844    0.579462    0.917377    0.886752    0.944611    0.889222    0.950382    0.924841    4200        25.149701   0.122523    0.133874    31.462655  
[37m[36mINFO[0m[0m 03/19 00:45:43 | 0.559487    0.547677    0.957929    0.922455    0.237210    0.559487    0.547677    0.946162    0.925214    0.954341    0.898204    0.973282    0.943949    4400        26.347305   0.132954    0.115132    31.934540  
[37m[36mINFO[0m[0m 03/19 00:46:47 | 0.643685    0.672372    0.954033    0.922344    0.251681    0.643685    0.672372    0.958422    0.935897    0.955838    0.901198    0.947837    0.929936    4600        27.544910   0.151275    0.162177    30.971040  
[37m[36mINFO[0m[0m 03/19 00:47:41 | 0.672361    0.689487    0.936001    0.913695    0.261469    0.672361    0.689487    0.915778    0.918803    0.955838    0.910180    0.936387    0.912102    4800        28.742515   0.153876    0.117961    31.278647  
[37m[36mINFO[0m[0m 03/19 00:48:37 | 0.640024    0.640587    0.935517    0.908006    0.274776    0.640024    0.640587    0.942431    0.923077    0.942365    0.895210    0.921756    0.905732    5000        29.940120   0.147503    0.122247    31.172064  
[37m[36mINFO[0m[0m 03/19 00:48:37 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250319_00-24-14_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 00:48:39 | ---
[37m[36mINFO[0m[0m 03/19 00:48:39 | test-domain validation(oracle) = 82.855%
[37m[36mINFO[0m[0m 03/19 00:48:39 | training-domain validation(iid) = 82.855%
[37m[36mINFO[0m[0m 03/19 00:48:39 | last = 64.002%
[37m[36mINFO[0m[0m 03/19 00:48:39 | last (inD) = 90.801%
[37m[36mINFO[0m[0m 03/19 00:48:39 | training-domain validation (iid, inD) = 95.284%
[37m[36mINFO[0m[0m 03/19 00:48:39 | === Summary ===
[37m[36mINFO[0m[0m 03/19 00:48:39 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 0 --hparams_seed 17
[37m[36mINFO[0m[0m 03/19 00:48:39 | Unique name: 250319_00-24-14_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 00:48:39 | Out path: train_output/PACS/ERM/[0]/250319_00-24-14_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 00:48:39 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 00:48:39 | Dataset: PACS

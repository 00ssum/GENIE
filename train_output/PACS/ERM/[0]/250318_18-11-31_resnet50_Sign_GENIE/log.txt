[37m[36mINFO[0m[0m 03/18 18:11:31 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 0 --hparams_seed 4
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 4
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250318_18-11-31_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250318_18-11-31_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.0793009436922532e-05
	batch_size: 30
	weight_decay: 0.0007980067844361917
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/18 18:11:31 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 18:11:31 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 18:11:31 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 18:11:31 | 
[37m[36mINFO[0m[0m 03/18 18:11:31 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/18 18:11:31 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/18 18:11:31 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/18 18:11:31 | Batch sizes for each domain: [0, 30, 30, 30] (total=90)
[37m[36mINFO[0m[0m 03/18 18:11:31 | steps-per-epoch for each domain: 62.53, 44.53, 104.80 -> min = 44.53
[37m[36mINFO[0m[0m 03/18 18:11:33 | # of params = 23522375
[37m[36mINFO[0m[0m 03/18 18:12:05 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 18:12:05 | 0.196461    0.190709    0.264861    0.260939    1.873697    0.196461    0.190709    0.245736    0.252137    0.346557    0.338323    0.202290    0.192357    0           0.000000    2.033029    1.107083    31.275227  
[37m[36mINFO[0m[0m 03/18 18:13:29 | 0.777303    0.775061    0.949809    0.949570    0.156637    0.777303    0.775061    0.933902    0.944444    0.990269    0.973054    0.925254    0.931210    200         4.491018    0.387390    0.269518    30.415253  
[37m[36mINFO[0m[0m 03/18 18:15:00 | 0.829164    0.853301    0.968989    0.960408    0.137394    0.829164    0.853301    0.966951    0.965812    0.990269    0.988024    0.949746    0.927389    400         8.982036    0.118628    0.295290    31.830521  
[37m[36mINFO[0m[0m 03/18 18:16:15 | 0.866382    0.872861    0.985261    0.964214    0.106937    0.866382    0.872861    0.984542    0.978632    0.997006    0.970060    0.974237    0.943949    600         13.473054   0.072595    0.215316    31.541248  
[37m[36mINFO[0m[0m 03/18 18:17:47 | 0.845638    0.860636    0.977148    0.967204    0.127105    0.845638    0.860636    0.978145    0.970085    0.994012    0.985030    0.959288    0.946497    800         17.964072   0.055224    0.308267    30.442456  
[37m[36mINFO[0m[0m 03/18 18:19:12 | 0.856010    0.885086    0.991824    0.972736    0.093688    0.856010    0.885086    0.994670    0.972222    0.999251    0.988024    0.981552    0.957962    1000        22.455090   0.044503    0.261916    32.631266  
[37m[36mINFO[0m[0m 03/18 18:20:26 | 0.870653    0.870416    0.992457    0.968202    0.120824    0.870653    0.870416    0.995203    0.970085    0.997754    0.988024    0.984415    0.946497    1200        26.946108   0.032194    0.217755    30.398441  
[37m[36mINFO[0m[0m 03/18 18:22:02 | 0.891397    0.870416    0.993902    0.968324    0.125369    0.891397    0.870416    0.990405    0.957265    0.999251    0.991018    0.992048    0.956688    1400        31.437126   0.027564    0.327232    30.197655  
[37m[36mINFO[0m[0m 03/18 18:23:18 | 0.857840    0.872861    0.995750    0.972300    0.106891    0.857840    0.872861    0.995203    0.970085    1.000000    0.985030    0.992048    0.961783    1600        35.928144   0.024422    0.228953    30.856215  
[37m[36mINFO[0m[0m 03/18 18:24:39 | 0.849908    0.836186    0.996209    0.967190    0.125847    0.849908    0.836186    0.995736    0.963675    0.999251    0.985030    0.993639    0.952866    1800        40.419162   0.015610    0.254310    30.270783  
[37m[36mINFO[0m[0m 03/18 18:26:12 | 0.854790    0.865526    0.997025    0.970016    0.112180    0.854790    0.865526    0.997868    0.967949    0.999251    0.979042    0.993957    0.963057    2000        44.910180   0.020285    0.309059    31.251770  
[37m[36mINFO[0m[0m 03/18 18:27:29 | 0.868212    0.872861    0.996985    0.971302    0.117478    0.868212    0.872861    0.995203    0.970085    0.999251    0.982036    0.996501    0.961783    2200        49.401198   0.010652    0.219940    32.318516  
[37m[36mINFO[0m[0m 03/18 18:29:04 | 0.881635    0.885086    0.997447    0.969026    0.114748    0.881635    0.885086    0.995203    0.961538    1.000000    0.985030    0.997137    0.960510    2400        53.892216   0.009795    0.321394    31.343930  
[37m[36mINFO[0m[0m 03/18 18:30:27 | 0.862111    0.853301    0.996461    0.970038    0.113960    0.862111    0.853301    0.998401    0.967949    0.999251    0.988024    0.991730    0.954140    2600        58.383234   0.011684    0.256008    30.913346  
[37m[36mINFO[0m[0m 03/18 18:31:44 | 0.845027    0.855746    0.998335    0.973311    0.117609    0.845027    0.855746    0.998934    0.976496    0.999251    0.988024    0.996819    0.955414    2800        62.874251   0.011371    0.226382    31.975476  
[37m[36mINFO[0m[0m 03/18 18:33:19 | 0.870043    0.870416    0.998335    0.974701    0.117066    0.870043    0.870416    0.998934    0.974359    0.999251    0.979042    0.996819    0.970701    3000        67.365269   0.007880    0.321097    30.701998  
[37m[36mINFO[0m[0m 03/18 18:34:35 | 0.817572    0.843521    0.998407    0.973149    0.108748    0.817572    0.843521    0.999467    0.970085    0.999251    0.985030    0.996501    0.964331    3200        71.856287   0.008601    0.230338    30.424748  
[37m[36mINFO[0m[0m 03/18 18:35:58 | 0.869433    0.885086    0.998971    0.976558    0.105719    0.869433    0.885086    1.000000    0.972222    0.998503    0.988024    0.998410    0.969427    3400        76.347305   0.007710    0.261944    30.402108  
[37m[36mINFO[0m[0m 03/18 18:37:30 | 0.840757    0.858191    0.999115    0.975571    0.129897    0.840757    0.858191    0.998934    0.974359    1.000000    0.988024    0.998410    0.964331    3600        80.838323   0.004364    0.300864    31.700623  
[37m[36mINFO[0m[0m 03/18 18:38:45 | 0.819402    0.831296    0.997056    0.967159    0.137992    0.819402    0.831296    0.997868    0.965812    0.997754    0.970060    0.995547    0.965605    3800        85.329341   0.008993    0.214215    32.123038  
[37m[36mINFO[0m[0m 03/18 18:40:19 | 0.868212    0.875306    0.997948    0.967181    0.151385    0.868212    0.875306    0.998934    0.965812    1.000000    0.979042    0.994911    0.956688    4000        89.820359   0.006569    0.314869    31.009623  
[37m[36mINFO[0m[0m 03/18 18:41:43 | 0.877974    0.877751    0.995245    0.970168    0.141582    0.877974    0.877751    0.992004    0.976496    0.998503    0.976048    0.995229    0.957962    4200        94.311377   0.006662    0.256244    32.723025  
[37m[36mINFO[0m[0m 03/18 18:42:56 | 0.822453    0.831296    0.998051    0.970278    0.135148    0.822453    0.831296    0.999467    0.961538    0.998503    0.976048    0.996183    0.973248    4400        98.802395   0.010118    0.217124    30.059555  
[37m[36mINFO[0m[0m 03/18 18:44:30 | 0.864552    0.858191    0.998372    0.971165    0.138369    0.864552    0.858191    0.998934    0.972222    1.000000    0.982036    0.996183    0.959236    4600        103.293413  0.006911    0.314803    30.967100  
[37m[36mINFO[0m[0m 03/18 18:45:47 | 0.874314    0.853301    0.999644    0.974137    0.111252    0.874314    0.853301    1.000000    0.972222    0.999251    0.982036    0.999682    0.968153    4800        107.784431  0.005216    0.231066    30.206430  
[37m[36mINFO[0m[0m 03/18 18:47:04 | 0.852349    0.855746    0.999788    0.973711    0.120099    0.852349    0.855746    1.000000    0.967949    1.000000    0.985030    0.999364    0.968153    5000        112.275449  0.003513    0.238187    29.763304  
[37m[36mINFO[0m[0m 03/18 18:47:04 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250318_18-11-31_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 18:47:05 | ---
[37m[36mINFO[0m[0m 03/18 18:47:05 | test-domain validation(oracle) = 85.601%
[37m[36mINFO[0m[0m 03/18 18:47:05 | training-domain validation(iid) = 86.943%
[37m[36mINFO[0m[0m 03/18 18:47:05 | last = 85.235%
[37m[36mINFO[0m[0m 03/18 18:47:05 | last (inD) = 97.371%
[37m[36mINFO[0m[0m 03/18 18:47:05 | training-domain validation (iid, inD) = 97.656%
[37m[36mINFO[0m[0m 03/18 18:47:06 | === Summary ===
[37m[36mINFO[0m[0m 03/18 18:47:06 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 0 --hparams_seed 4
[37m[36mINFO[0m[0m 03/18 18:47:06 | Unique name: 250318_18-11-31_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 18:47:06 | Out path: train_output/PACS/ERM/[0]/250318_18-11-31_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 18:47:06 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 18:47:06 | Dataset: PACS

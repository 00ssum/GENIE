[37m[36mINFO[0m[0m 03/19 14:16:48 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 2 --hparams_seed 5
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 5
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250319_14-16-48_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 2
	unique_name: 250319_14-16-48_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.0002982828768978312
	batch_size: 9
	weight_decay: 0.0003180957897867641
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/19 14:16:48 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 14:16:48 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 14:16:48 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 14:16:48 | 
[37m[36mINFO[0m[0m 03/19 14:16:48 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 14:16:48 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 14:16:48 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 14:16:48 | Batch sizes for each domain: [0, 9, 9, 9] (total=27)
[37m[36mINFO[0m[0m 03/19 14:16:48 | steps-per-epoch for each domain: 208.44, 148.44, 349.33 -> min = 148.44
[37m[36mINFO[0m[0m 03/19 14:16:50 | # of params = 23522375
[37m[36mINFO[0m[0m 03/19 14:17:22 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 14:17:22 | 0.187309    0.176039    0.159382    0.155164    2.082341    0.187309    0.176039    0.167377    0.160256    0.114521    0.107784    0.196247    0.197452    0           0.000000    2.014135    0.933635    31.695574  
[37m[36mINFO[0m[0m 03/19 14:18:18 | 0.782184    0.794621    0.913198    0.912361    0.247948    0.782184    0.794621    0.883795    0.899573    0.961078    0.961078    0.894720    0.876433    200         1.347305    0.642159    0.119154    31.988803  
[37m[36mINFO[0m[0m 03/19 14:19:16 | 0.757779    0.772616    0.932729    0.919440    0.230630    0.757779    0.772616    0.925906    0.920940    0.954341    0.943114    0.917939    0.894268    400         2.694611    0.254777    0.127386    32.368976  
[37m[36mINFO[0m[0m 03/19 14:20:12 | 0.828554    0.816626    0.959236    0.938942    0.177887    0.828554    0.816626    0.953092    0.942308    0.987275    0.970060    0.937341    0.904459    600         4.041916    0.196253    0.126297    31.159752  
[37m[36mINFO[0m[0m 03/19 14:21:10 | 0.776693    0.792176    0.955570    0.940792    0.175533    0.776693    0.792176    0.941365    0.923077    0.985778    0.991018    0.939567    0.908280    800         5.389222    0.158511    0.132620    30.975297  
[37m[36mINFO[0m[0m 03/19 14:22:11 | 0.816351    0.823961    0.970545    0.947752    0.159741    0.816351    0.823961    0.966418    0.938034    0.991018    0.988024    0.954198    0.917197    1000        6.736527    0.118382    0.144641    31.935706  
[37m[36mINFO[0m[0m 03/19 14:23:07 | 0.828554    0.853301    0.969669    0.951135    0.138541    0.828554    0.853301    0.962687    0.955128    0.983533    0.967066    0.962786    0.931210    1200        8.083832    0.111080    0.127365    31.292336  
[37m[36mINFO[0m[0m 03/19 14:24:10 | 0.807200    0.794621    0.978340    0.962093    0.103828    0.807200    0.794621    0.969616    0.959402    0.996257    0.988024    0.969148    0.938854    1400        9.431138    0.131634    0.160366    30.349403  
[37m[36mINFO[0m[0m 03/19 14:25:07 | 0.821232    0.828851    0.977270    0.951700    0.140242    0.821232    0.828851    0.972281    0.961538    0.991018    0.961078    0.968511    0.932484    1600        10.778443   0.103279    0.130718    31.408747  
[37m[36mINFO[0m[0m 03/19 14:26:02 | 0.851129    0.838631    0.981812    0.955825    0.118505    0.851129    0.838631    0.983475    0.950855    0.990269    0.979042    0.971692    0.937580    1800        12.125749   0.086435    0.124562    29.713460  
[37m[36mINFO[0m[0m 03/19 14:27:06 | 0.829774    0.826406    0.987067    0.969488    0.088174    0.829774    0.826406    0.985075    0.972222    0.997754    0.991018    0.978372    0.945223    2000        13.473054   0.074655    0.165338    30.619744  
[37m[36mINFO[0m[0m 03/19 14:28:03 | 0.823063    0.836186    0.986674    0.963083    0.107121    0.823063    0.836186    0.987207    0.965812    0.994760    0.982036    0.978053    0.941401    2200        14.820359   0.053495    0.126178    31.799842  
[37m[36mINFO[0m[0m 03/19 14:28:59 | 0.735204    0.753056    0.923360    0.915185    0.343277    0.735204    0.753056    0.914712    0.899573    0.960329    0.958084    0.895038    0.887898    2400        16.167665   0.066111    0.125191    31.574302  
[37m[36mINFO[0m[0m 03/19 14:29:57 | 0.773032    0.767726    0.979822    0.955152    0.162765    0.773032    0.767726    0.987740    0.963675    0.983533    0.982036    0.968193    0.919745    2600        17.514970   0.053737    0.131696    31.516772  
[37m[36mINFO[0m[0m 03/19 14:30:52 | 0.816351    0.816626    0.985180    0.956414    0.179262    0.816351    0.816626    0.987740    0.961538    0.991018    0.979042    0.976781    0.928662    2800        18.862275   0.040708    0.119371    30.404800  
[37m[36mINFO[0m[0m 03/19 14:31:56 | 0.852959    0.853301    0.991251    0.963678    0.120798    0.852959    0.853301    0.991471    0.965812    0.998503    0.994012    0.983779    0.931210    3000        20.209581   0.039023    0.157526    32.501061  
[37m[36mINFO[0m[0m 03/19 14:32:53 | 0.825503    0.823961    0.985361    0.954863    0.155867    0.825503    0.823961    0.983475    0.957265    0.995509    0.985030    0.977099    0.922293    3200        21.556886   0.036336    0.127826    31.761301  
[37m[36mINFO[0m[0m 03/19 14:33:50 | 0.798658    0.806846    0.990082    0.961520    0.122703    0.798658    0.806846    0.990938    0.959402    0.997754    0.985030    0.981552    0.940127    3400        22.904192   0.036451    0.129771    31.461095  
[37m[36mINFO[0m[0m 03/19 14:34:55 | 0.835876    0.855746    0.987924    0.956137    0.135494    0.835876    0.855746    0.990938    0.957265    0.997006    0.985030    0.975827    0.926115    3600        24.251497   0.028298    0.157164    32.760123  
[37m[36mINFO[0m[0m 03/19 14:35:48 | 0.854790    0.860636    0.990153    0.962657    0.133039    0.854790    0.860636    0.992537    0.961538    0.997006    0.985030    0.980916    0.941401    3800        25.598802   0.024831    0.117796    30.103772  
[37m[36mINFO[0m[0m 03/19 14:36:45 | 0.871873    0.877751    0.994409    0.967216    0.110015    0.871873    0.877751    0.996269    0.972222    1.000000    0.988024    0.986959    0.941401    4000        26.946108   0.039507    0.128529    30.796095  
[37m[36mINFO[0m[0m 03/19 14:37:43 | 0.854790    0.855746    0.992270    0.968349    0.101938    0.854790    0.855746    0.992004    0.965812    0.996257    0.994012    0.988550    0.945223    4200        28.293413   0.037793    0.133634    31.920687  
[37m[36mINFO[0m[0m 03/19 14:38:42 | 0.821843    0.821516    0.988557    0.960250    0.149035    0.821843    0.821516    0.991471    0.967949    0.995509    0.979042    0.978690    0.933758    4400        29.640719   0.044103    0.126711    33.009391  
[37m[36mINFO[0m[0m 03/19 14:39:48 | 0.835265    0.826406    0.994752    0.964508    0.123248    0.835265    0.826406    0.995203    0.970085    0.997006    0.982036    0.992048    0.941401    4600        30.988024   0.028413    0.171789    31.656266  
[37m[36mINFO[0m[0m 03/19 14:40:44 | 0.854790    0.843521    0.990986    0.961077    0.153286    0.854790    0.843521    0.990938    0.967949    0.992515    0.970060    0.989504    0.945223    4800        32.335329   0.036400    0.127319    31.148785  
[37m[36mINFO[0m[0m 03/19 14:41:41 | 0.870653    0.850856    0.996742    0.971464    0.107136    0.870653    0.850856    0.996269    0.976496    1.000000    0.985030    0.993957    0.952866    5000        33.682635   0.018320    0.129926    30.680318  
[37m[36mINFO[0m[0m 03/19 14:41:41 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250319_14-16-48_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 14:41:43 | ---
[37m[36mINFO[0m[0m 03/19 14:41:43 | test-domain validation(oracle) = 87.187%
[37m[36mINFO[0m[0m 03/19 14:41:43 | training-domain validation(iid) = 87.065%
[37m[36mINFO[0m[0m 03/19 14:41:43 | last = 87.065%
[37m[36mINFO[0m[0m 03/19 14:41:43 | last (inD) = 97.146%
[37m[36mINFO[0m[0m 03/19 14:41:43 | training-domain validation (iid, inD) = 97.146%
[37m[36mINFO[0m[0m 03/19 14:41:43 | === Summary ===
[37m[36mINFO[0m[0m 03/19 14:41:43 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 2 --hparams_seed 5
[37m[36mINFO[0m[0m 03/19 14:41:43 | Unique name: 250319_14-16-48_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 14:41:43 | Out path: train_output/PACS/ERM/[0]/250319_14-16-48_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 14:41:43 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 14:41:43 | Dataset: PACS

[37m[36mINFO[0m[0m 03/18 22:33:20 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 0 --hparams_seed 13
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 13
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250318_22-33-20_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250318_22-33-20_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00014596629881421895
	batch_size: 9
	weight_decay: 0.0009399117661702502
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/18 22:33:20 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 22:33:20 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 22:33:20 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 22:33:20 | 
[37m[36mINFO[0m[0m 03/18 22:33:20 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/18 22:33:20 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/18 22:33:20 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/18 22:33:20 | Batch sizes for each domain: [0, 9, 9, 9] (total=27)
[37m[36mINFO[0m[0m 03/18 22:33:20 | steps-per-epoch for each domain: 208.44, 148.44, 349.33 -> min = 148.44
[37m[36mINFO[0m[0m 03/18 22:33:21 | # of params = 23522375
[37m[36mINFO[0m[0m 03/18 22:33:55 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 22:33:55 | 0.156193    0.156479    0.201887    0.187539    2.032051    0.156193    0.156479    0.244670    0.241453    0.160928    0.137725    0.200064    0.183439    0           0.000000    1.912682    1.349015    32.080620  
[37m[36mINFO[0m[0m 03/18 22:35:02 | 0.784015    0.779951    0.928358    0.922241    0.202787    0.784015    0.779951    0.900853    0.893162    0.974551    0.955090    0.909669    0.918471    200         1.347305    0.519250    0.169240    33.651967  
[37m[36mINFO[0m[0m 03/18 22:36:08 | 0.664430    0.689487    0.913265    0.908598    0.264317    0.664430    0.689487    0.869403    0.891026    0.969311    0.934132    0.901081    0.900637    400         2.694611    0.207953    0.172809    31.267682  
[37m[36mINFO[0m[0m 03/18 22:37:04 | 0.801098    0.821516    0.954517    0.942732    0.162247    0.801098    0.821516    0.932836    0.944444    0.981287    0.955090    0.949427    0.928662    600         4.041916    0.203283    0.121652    31.278117  
[37m[36mINFO[0m[0m 03/18 22:37:57 | 0.854179    0.836186    0.969154    0.953144    0.140455    0.854179    0.836186    0.962154    0.961538    0.989521    0.973054    0.955789    0.924841    800         5.389222    0.140874    0.113520    30.906165  
[37m[36mINFO[0m[0m 03/18 22:39:01 | 0.771812    0.779951    0.956625    0.945298    0.163095    0.771812    0.779951    0.932836    0.935897    0.989521    0.970060    0.947519    0.929936    1000        6.736527    0.116297    0.157731    31.907937  
[37m[36mINFO[0m[0m 03/18 22:40:06 | 0.788286    0.784841    0.966090    0.944034    0.182863    0.788286    0.784841    0.952026    0.933761    0.987275    0.976048    0.958969    0.922293    1200        8.083832    0.103419    0.162752    32.311426  
[37m[36mINFO[0m[0m 03/18 22:41:03 | 0.830995    0.850856    0.979197    0.959076    0.128083    0.830995    0.850856    0.978678    0.955128    0.993263    0.973054    0.965649    0.949045    1400        9.431138    0.092472    0.129477    31.327949  
[37m[36mINFO[0m[0m 03/18 22:41:59 | 0.851739    0.870416    0.983437    0.963913    0.125392    0.851739    0.870416    0.980810    0.970085    0.991766    0.970060    0.977735    0.951592    1600        10.778443   0.067109    0.118976    32.482785  
[37m[36mINFO[0m[0m 03/18 22:43:01 | 0.866992    0.875306    0.970461    0.950849    0.166374    0.866992    0.875306    0.960554    0.957265    0.990269    0.964072    0.960560    0.931210    1800        12.125749   0.065427    0.155449    30.375497  
[37m[36mINFO[0m[0m 03/18 22:44:15 | 0.693106    0.684597    0.940607    0.918392    0.304224    0.693106    0.684597    0.914179    0.903846    0.961078    0.934132    0.946565    0.917197    2000        13.473054   0.069096    0.190211    36.105910  
[37m[36mINFO[0m[0m 03/18 22:45:18 | 0.848078    0.845966    0.992604    0.969726    0.128165    0.848078    0.845966    0.994670    0.961538    1.000000    0.982036    0.983142    0.965605    2200        14.820359   0.043781    0.164331    30.601508  
[37m[36mINFO[0m[0m 03/18 22:46:20 | 0.845027    0.831296    0.983731    0.956105    0.143262    0.845027    0.831296    0.981876    0.959402    0.994760    0.970060    0.974555    0.938854    2400        16.167665   0.050493    0.141900    33.639532  
[37m[36mINFO[0m[0m 03/18 22:47:20 | 0.827944    0.838631    0.989271    0.959361    0.138020    0.827944    0.838631    0.992004    0.952991    0.997754    0.976048    0.978053    0.949045    2600        17.514970   0.037767    0.133595    33.010291  
[37m[36mINFO[0m[0m 03/18 22:48:30 | 0.773642    0.797066    0.990954    0.961913    0.151415    0.773642    0.797066    0.993070    0.961538    0.992515    0.970060    0.987277    0.954140    2800        18.862275   0.038531    0.177746    34.972298  
[37m[36mINFO[0m[0m 03/18 22:49:42 | 0.799878    0.814181    0.990989    0.968167    0.132294    0.799878    0.814181    0.989339    0.963675    0.994760    0.979042    0.988868    0.961783    3000        20.209581   0.042910    0.192263    32.685786  
[37m[36mINFO[0m[0m 03/18 22:50:45 | 0.801708    0.826406    0.989105    0.957207    0.150169    0.801708    0.826406    0.991471    0.955128    0.989521    0.961078    0.986323    0.955414    3200        21.556886   0.033825    0.141332    35.468128  
[37m[36mINFO[0m[0m 03/18 22:51:50 | 0.802929    0.799511    0.989024    0.951673    0.191738    0.802929    0.799511    0.994670    0.948718    0.996257    0.961078    0.976145    0.945223    3400        22.904192   0.035615    0.144768    35.468934  
[37m[36mINFO[0m[0m 03/18 22:52:56 | 0.841367    0.863081    0.989187    0.961216    0.147245    0.841367    0.863081    0.989339    0.970085    0.994760    0.967066    0.983461    0.946497    3600        24.251497   0.036966    0.167354    32.670092  
[37m[36mINFO[0m[0m 03/18 22:54:00 | 0.839536    0.848411    0.992161    0.967472    0.114766    0.839536    0.848411    0.992537    0.976496    0.994760    0.973054    0.989186    0.952866    3800        25.598802   0.034919    0.167454    30.788535  
[37m[36mINFO[0m[0m 03/18 22:54:58 | 0.768151    0.801956    0.975428    0.943615    0.198766    0.768151    0.801956    0.966418    0.946581    0.993263    0.967066    0.966603    0.917197    4000        26.946108   0.037101    0.126506    32.216607  
[37m[36mINFO[0m[0m 03/18 22:55:57 | 0.830384    0.843521    0.996349    0.968605    0.118991    0.830384    0.843521    0.995203    0.970085    0.999251    0.979042    0.994593    0.956688    4200        28.293413   0.027926    0.137047    32.090378  
[37m[36mINFO[0m[0m 03/18 22:57:05 | 0.764491    0.777506    0.990886    0.960353    0.140431    0.764491    0.777506    0.987740    0.963675    0.997006    0.967066    0.987913    0.950318    4400        29.640719   0.019193    0.179517    32.258487  
[37m[36mINFO[0m[0m 03/18 22:58:12 | 0.815741    0.819071    0.984478    0.955968    0.143499    0.815741    0.819071    0.988273    0.961538    0.992515    0.970060    0.972646    0.936306    4600        30.988024   0.047906    0.174549    31.373206  
[37m[36mINFO[0m[0m 03/18 22:59:10 | 0.813911    0.838631    0.995394    0.967037    0.119428    0.813911    0.838631    0.998401    0.978632    0.997006    0.967066    0.990776    0.955414    4800        32.335329   0.030667    0.131139    31.977488  
[37m[36mINFO[0m[0m 03/18 23:00:09 | 0.837096    0.838631    0.993193    0.964061    0.139721    0.837096    0.838631    0.995203    0.970085    0.995509    0.973054    0.988868    0.949045    5000        33.682635   0.033439    0.135812    31.852918  
[37m[36mINFO[0m[0m 03/18 23:00:09 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250318_22-33-20_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 23:00:11 | ---
[37m[36mINFO[0m[0m 03/18 23:00:11 | test-domain validation(oracle) = 86.699%
[37m[36mINFO[0m[0m 03/18 23:00:11 | training-domain validation(iid) = 84.808%
[37m[36mINFO[0m[0m 03/18 23:00:11 | last = 83.710%
[37m[36mINFO[0m[0m 03/18 23:00:11 | last (inD) = 96.406%
[37m[36mINFO[0m[0m 03/18 23:00:11 | training-domain validation (iid, inD) = 96.973%
[37m[36mINFO[0m[0m 03/18 23:00:11 | === Summary ===
[37m[36mINFO[0m[0m 03/18 23:00:11 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 0 --hparams_seed 13
[37m[36mINFO[0m[0m 03/18 23:00:11 | Unique name: 250318_22-33-20_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 23:00:11 | Out path: train_output/PACS/ERM/[0]/250318_22-33-20_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 23:00:11 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 23:00:11 | Dataset: PACS

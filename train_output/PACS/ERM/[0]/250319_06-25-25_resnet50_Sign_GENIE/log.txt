[37m[36mINFO[0m[0m 03/19 06:25:25 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 1 --hparams_seed 9
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 9
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250319_06-25-25_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 1
	unique_name: 250319_06-25-25_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.7532223448653515e-05
	batch_size: 36
	weight_decay: 0.007511403320794324
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/19 06:25:25 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 06:25:25 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 06:25:25 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 06:25:25 | 
[37m[36mINFO[0m[0m 03/19 06:25:25 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 06:25:25 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 06:25:25 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 06:25:25 | Batch sizes for each domain: [0, 36, 36, 36] (total=108)
[37m[36mINFO[0m[0m 03/19 06:25:25 | steps-per-epoch for each domain: 52.11, 37.11, 87.33 -> min = 37.11
[37m[36mINFO[0m[0m 03/19 06:25:26 | # of params = 23522375
[37m[36mINFO[0m[0m 03/19 06:25:58 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 06:25:58 | 0.138499    0.185819    0.186206    0.181154    1.894315    0.138499    0.185819    0.191898    0.230769    0.186377    0.140719    0.180344    0.171975    0           0.000000    2.041137    1.054408    30.962470  
[37m[36mINFO[0m[0m 03/19 06:27:27 | 0.827944    0.841076    0.957820    0.957105    0.130034    0.827944    0.841076    0.952026    0.940171    0.987275    0.991018    0.934160    0.940127    200         5.389222    0.398320    0.291528    30.723182  
[37m[36mINFO[0m[0m 03/19 06:28:53 | 0.837706    0.826406    0.976928    0.968911    0.090485    0.837706    0.826406    0.970149    0.963675    0.996257    0.994012    0.964377    0.949045    400         10.778443   0.113008    0.274604    30.390655  
[37m[36mINFO[0m[0m 03/19 06:30:17 | 0.817572    0.816626    0.985333    0.974143    0.084202    0.817572    0.816626    0.984009    0.961538    0.997754    0.994012    0.974237    0.966879    600         16.167665   0.068514    0.268422    30.566657  
[37m[36mINFO[0m[0m 03/19 06:31:48 | 0.841977    0.845966    0.990858    0.970584    0.096560    0.841977    0.845966    0.991471    0.955128    0.997006    0.991018    0.984097    0.965605    800         21.556886   0.047541    0.295967    31.548168  
[37m[36mINFO[0m[0m 03/19 06:33:07 | 0.821232    0.831296    0.992517    0.974869    0.080287    0.821232    0.831296    0.991471    0.970085    0.996257    0.994012    0.989822    0.960510    1000        26.946108   0.041624    0.246137    30.319694  
[37m[36mINFO[0m[0m 03/19 06:34:41 | 0.799878    0.809291    0.992068    0.973006    0.097996    0.799878    0.809291    0.991471    0.959402    1.000000    0.994012    0.984733    0.965605    1200        32.335329   0.027961    0.310053    32.116328  
[37m[36mINFO[0m[0m 03/19 06:36:03 | 0.827944    0.809291    0.993798    0.974994    0.085675    0.827944    0.809291    0.994136    0.965812    0.997754    0.991018    0.989504    0.968153    1400        37.724551   0.035284    0.244639    32.425120  
[37m[36mINFO[0m[0m 03/19 06:37:39 | 0.812081    0.806846    0.992136    0.972433    0.107553    0.812081    0.806846    0.994670    0.959402    0.997006    0.991018    0.984733    0.966879    1600        43.113772   0.030901    0.323141    31.251878  
[37m[36mINFO[0m[0m 03/19 06:39:00 | 0.785235    0.782396    0.995604    0.970146    0.106685    0.785235    0.782396    0.995736    0.948718    0.997754    0.991018    0.993321    0.970701    1800        48.502994   0.028702    0.247763    32.180368  
[37m[36mINFO[0m[0m 03/19 06:40:40 | 0.776693    0.770171    0.993873    0.964903    0.106284    0.776693    0.770171    0.994136    0.952991    0.999251    0.985030    0.988232    0.956688    2000        53.892216   0.035805    0.339341    31.865852  
[37m[36mINFO[0m[0m 03/19 06:42:01 | 0.733984    0.735941    0.968074    0.935168    0.205835    0.733984    0.735941    0.965352    0.908120    0.967814    0.961078    0.971056    0.936306    2200        59.281437   0.035049    0.240008    32.611189  
[37m[36mINFO[0m[0m 03/19 06:43:43 | 0.736425    0.726161    0.983852    0.948539    0.144959    0.736425    0.726161    0.978145    0.918803    0.990269    0.979042    0.983142    0.947771    2400        64.670659   0.045956    0.354568    31.538325  
[37m[36mINFO[0m[0m 03/19 06:45:02 | 0.794997    0.792176    0.992589    0.961890    0.114555    0.794997    0.792176    0.987740    0.933761    0.999251    0.985030    0.990776    0.966879    2600        70.059880   0.040602    0.241885    30.295394  
[37m[36mINFO[0m[0m 03/19 06:46:45 | 0.788896    0.792176    0.990387    0.958187    0.114358    0.788896    0.792176    0.988806    0.940171    0.994760    0.970060    0.987595    0.964331    2800        75.449102   0.039182    0.361761    30.501786  
[37m[36mINFO[0m[0m 03/19 06:48:06 | 0.769982    0.770171    0.994684    0.970151    0.093694    0.769982    0.770171    0.993070    0.961538    0.999251    0.982036    0.991730    0.966879    3000        80.838323   0.054598    0.248837    31.314559  
[37m[36mINFO[0m[0m 03/19 06:49:29 | 0.727273    0.711491    0.984938    0.954053    0.152387    0.727273    0.711491    0.974947    0.929487    0.988772    0.967066    0.991094    0.965605    3200        86.227545   0.041659    0.256976    31.509665  
[37m[36mINFO[0m[0m 03/19 06:50:49 | 0.709579    0.711491    0.989393    0.963044    0.115458    0.709579    0.711491    0.988273    0.950855    0.993263    0.979042    0.986641    0.959236    3400        91.616766   0.047693    0.247168    31.052576  
[37m[36mINFO[0m[0m 03/19 06:52:30 | 0.785845    0.799511    0.988857    0.960183    0.137337    0.785845    0.799511    0.980810    0.940171    0.996257    0.976048    0.989504    0.964331    3600        97.005988   0.071925    0.354852    30.184059  
[37m[36mINFO[0m[0m 03/19 06:53:50 | 0.713240    0.740831    0.984494    0.953053    0.155592    0.713240    0.740831    0.982409    0.925214    0.989521    0.967066    0.981552    0.966879    3800        102.395210  0.054302    0.241487    30.981115  
[37m[36mINFO[0m[0m 03/19 06:55:38 | 0.755339    0.753056    0.977650    0.953636    0.146465    0.755339    0.753056    0.971215    0.946581    0.976048    0.955090    0.985687    0.959236    4000        107.784431  0.063571    0.382801    31.625216  
[37m[36mINFO[0m[0m 03/19 06:56:58 | 0.689445    0.689487    0.991950    0.958751    0.143197    0.689445    0.689487    0.989339    0.942308    0.997006    0.967066    0.989504    0.966879    4200        113.173653  0.048773    0.246726    31.055932  
[37m[36mINFO[0m[0m 03/19 06:58:46 | 0.707138    0.709046    0.970708    0.934770    0.202849    0.707138    0.709046    0.954691    0.920940    0.994012    0.961078    0.963422    0.922293    4400        118.562874  0.057281    0.380074    31.504344  
[37m[36mINFO[0m[0m 03/19 07:00:09 | 0.725442    0.731051    0.983506    0.957070    0.125741    0.725442    0.731051    0.980810    0.957265    0.991018    0.961078    0.978690    0.952866    4600        123.952096  0.056249    0.251723    32.853247  
[37m[36mINFO[0m[0m 03/19 07:01:51 | 0.678462    0.672372    0.969636    0.933419    0.217221    0.678462    0.672372    0.948294    0.891026    0.981287    0.955090    0.979326    0.954140    4800        129.341317  0.064680    0.358990    30.336909  
[37m[36mINFO[0m[0m 03/19 07:03:13 | 0.699207    0.687042    0.990203    0.946523    0.151594    0.699207    0.687042    0.989339    0.923077    0.991766    0.961078    0.989504    0.955414    5000        134.730539  0.075009    0.253368    30.862409  
[37m[36mINFO[0m[0m 03/19 07:03:13 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250319_06-25-25_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 07:03:14 | ---
[37m[36mINFO[0m[0m 03/19 07:03:14 | test-domain validation(oracle) = 84.198%
[37m[36mINFO[0m[0m 03/19 07:03:14 | training-domain validation(iid) = 82.794%
[37m[36mINFO[0m[0m 03/19 07:03:14 | last = 69.921%
[37m[36mINFO[0m[0m 03/19 07:03:14 | last (inD) = 94.652%
[37m[36mINFO[0m[0m 03/19 07:03:14 | training-domain validation (iid, inD) = 97.499%
[37m[36mINFO[0m[0m 03/19 07:03:14 | === Summary ===
[37m[36mINFO[0m[0m 03/19 07:03:14 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 1 --hparams_seed 9
[37m[36mINFO[0m[0m 03/19 07:03:14 | Unique name: 250319_06-25-25_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 07:03:14 | Out path: train_output/PACS/ERM/[0]/250319_06-25-25_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 07:03:14 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 07:03:14 | Dataset: PACS

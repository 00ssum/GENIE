[37m[36mINFO[0m[0m 03/19 10:00:41 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 1 --hparams_seed 16
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 16
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250319_10-00-41_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 1
	unique_name: 250319_10-00-41_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 1.3198033474735314e-05
	batch_size: 10
	weight_decay: 0.001844990356992375
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/19 10:00:41 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 10:00:41 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 10:00:41 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 10:00:41 | 
[37m[36mINFO[0m[0m 03/19 10:00:41 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 10:00:41 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 10:00:41 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 10:00:41 | Batch sizes for each domain: [0, 10, 10, 10] (total=30)
[37m[36mINFO[0m[0m 03/19 10:00:41 | steps-per-epoch for each domain: 187.60, 133.60, 314.40 -> min = 133.60
[37m[36mINFO[0m[0m 03/19 10:00:42 | # of params = 23522375
[37m[36mINFO[0m[0m 03/19 10:01:13 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 10:01:13 | 0.154973    0.178484    0.192183    0.200891    1.967620    0.154973    0.178484    0.190832    0.228632    0.226048    0.227545    0.159669    0.146497    0           0.000000    2.012071    0.952321    30.772116  
[37m[36mINFO[0m[0m 03/19 10:02:23 | 0.822453    0.811736    0.902279    0.892665    0.286315    0.822453    0.811736    0.878465    0.865385    0.977545    0.982036    0.850827    0.830573    200         1.497006    0.503107    0.196364    30.851250  
[37m[36mINFO[0m[0m 03/19 10:03:20 | 0.788286    0.765281    0.931021    0.934849    0.203672    0.788286    0.765281    0.929104    0.927350    0.973054    0.988024    0.890903    0.889172    400         2.994012    0.244027    0.132360    30.408859  
[37m[36mINFO[0m[0m 03/19 10:04:19 | 0.766321    0.779951    0.957978    0.950875    0.165100    0.766321    0.779951    0.962154    0.942308    0.986527    0.988024    0.925254    0.922293    600         4.491018    0.175900    0.125727    33.625403  
[37m[36mINFO[0m[0m 03/19 10:05:26 | 0.807200    0.821516    0.968316    0.955391    0.139186    0.807200    0.821516    0.962687    0.929487    0.992515    0.994012    0.949746    0.942675    800         5.988024    0.113272    0.180103    30.755429  
[37m[36mINFO[0m[0m 03/19 10:06:23 | 0.801098    0.831296    0.948032    0.945705    0.157074    0.801098    0.831296    0.925373    0.920940    0.979790    0.976048    0.938931    0.940127    1000        7.485030    0.116128    0.127170    31.527733  
[37m[36mINFO[0m[0m 03/19 10:07:19 | 0.837096    0.848411    0.968180    0.952836    0.131926    0.837096    0.848411    0.973881    0.935897    0.987275    0.985030    0.943384    0.937580    1200        8.982036    0.097863    0.128471    30.699130  
[37m[36mINFO[0m[0m 03/19 10:08:19 | 0.829774    0.831296    0.975134    0.968625    0.103430    0.829774    0.831296    0.978145    0.965812    0.994012    0.991018    0.953244    0.949045    1400        10.479042   0.074366    0.152663    29.566119  
[37m[36mINFO[0m[0m 03/19 10:09:13 | 0.784015    0.782396    0.979721    0.957958    0.111959    0.784015    0.782396    0.978678    0.948718    0.991018    0.985030    0.969466    0.940127    1600        11.976048   0.071260    0.118984    30.225888  
[37m[36mINFO[0m[0m 03/19 10:10:15 | 0.884076    0.867971    0.987357    0.973431    0.082982    0.884076    0.867971    0.987740    0.959402    0.998503    0.994012    0.975827    0.966879    1800        13.473054   0.056556    0.150308    31.560919  
[37m[36mINFO[0m[0m 03/19 10:11:13 | 0.788286    0.784841    0.980638    0.965052    0.123240    0.788286    0.784841    0.975480    0.952991    0.992515    0.988024    0.973919    0.954140    2000        14.970060   0.053252    0.136243    30.241240  
[37m[36mINFO[0m[0m 03/19 10:12:07 | 0.820012    0.833741    0.989446    0.974143    0.097725    0.820012    0.833741    0.988806    0.961538    0.999251    0.994012    0.980280    0.966879    2200        16.467066   0.047423    0.120657    30.157114  
[37m[36mINFO[0m[0m 03/19 10:13:11 | 0.856010    0.872861    0.979359    0.965504    0.108352    0.856010    0.872861    0.979744    0.965812    0.987275    0.988024    0.971056    0.942675    2400        17.964072   0.043577    0.168962    29.970982  
[37m[36mINFO[0m[0m 03/19 10:14:07 | 0.785235    0.794621    0.988348    0.972595    0.101595    0.785235    0.794621    0.989872    0.965812    0.997754    0.994012    0.977417    0.957962    2600        19.461078   0.045395    0.131238    30.610969  
[37m[36mINFO[0m[0m 03/19 10:15:05 | 0.821843    0.816626    0.990397    0.976292    0.096619    0.821843    0.816626    0.989339    0.970085    0.997754    0.997006    0.984097    0.961783    2800        20.958084   0.022403    0.118734    33.419457  
[37m[36mINFO[0m[0m 03/19 10:16:16 | 0.839536    0.865526    0.992280    0.974718    0.088743    0.839536    0.865526    0.992537    0.965812    0.999251    0.994012    0.985051    0.964331    3000        22.455090   0.030393    0.198715    31.867608  
[37m[36mINFO[0m[0m 03/19 10:17:13 | 0.823063    0.853301    0.990403    0.969036    0.113551    0.823063    0.853301    0.991471    0.959402    0.998503    0.991018    0.981234    0.956688    3200        23.952096   0.036331    0.127773    31.092444  
[37m[36mINFO[0m[0m 03/19 10:18:11 | 0.859060    0.867971    0.992767    0.978685    0.073290    0.859060    0.867971    0.990405    0.980769    0.997754    0.982036    0.990140    0.973248    3400        25.449102   0.029422    0.127623    32.570273  
[37m[36mINFO[0m[0m 03/19 10:19:21 | 0.811470    0.823961    0.985190    0.962901    0.135539    0.811470    0.823961    0.982942    0.940171    0.997754    0.988024    0.974873    0.960510    3600        26.946108   0.027267    0.191158    31.818817  
[37m[36mINFO[0m[0m 03/19 10:20:17 | 0.849908    0.853301    0.986218    0.963068    0.142858    0.849908    0.853301    0.989339    0.955128    0.994760    0.985030    0.974555    0.949045    3800        28.443114   0.036424    0.123239    31.468230  
[37m[36mINFO[0m[0m 03/19 10:21:16 | 0.850519    0.855746    0.995463    0.971024    0.116918    0.850519    0.855746    0.996269    0.965812    0.997754    0.988024    0.992366    0.959236    4000        29.940120   0.023855    0.126909    33.408952  
[37m[36mINFO[0m[0m 03/19 10:22:19 | 0.828554    0.853301    0.992660    0.975137    0.087544    0.828554    0.853301    0.993603    0.976496    0.995509    0.982036    0.988868    0.966879    4200        31.437126   0.025991    0.163194    30.663578  
[37m[36mINFO[0m[0m 03/19 10:23:15 | 0.804759    0.792176    0.984215    0.968151    0.114934    0.804759    0.792176    0.990405    0.952991    0.973054    0.982036    0.989186    0.969427    4400        32.934132   0.022720    0.119891    31.673846  
[37m[36mINFO[0m[0m 03/19 10:24:13 | 0.837706    0.850856    0.997309    0.974558    0.094485    0.837706    0.850856    0.997335    0.963675    1.000000    0.988024    0.994593    0.971975    4600        34.431138   0.018743    0.134292    30.830098  
[37m[36mINFO[0m[0m 03/19 10:25:11 | 0.821843    0.850856    0.988432    0.965907    0.135170    0.821843    0.850856    0.988273    0.965812    0.991018    0.979042    0.986005    0.952866    4800        35.928144   0.013636    0.144717    29.755873  
[37m[36mINFO[0m[0m 03/19 10:26:07 | 0.830995    0.850856    0.996667    0.981105    0.069093    0.830995    0.850856    0.995203    0.980769    0.999251    0.988024    0.995547    0.974522    5000        37.425150   0.039382    0.117488    32.552678  
[37m[36mINFO[0m[0m 03/19 10:26:07 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250319_10-00-41_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 10:26:09 | ---
[37m[36mINFO[0m[0m 03/19 10:26:09 | test-domain validation(oracle) = 85.601%
[37m[36mINFO[0m[0m 03/19 10:26:09 | training-domain validation(iid) = 83.099%
[37m[36mINFO[0m[0m 03/19 10:26:09 | last = 83.099%
[37m[36mINFO[0m[0m 03/19 10:26:09 | last (inD) = 98.111%
[37m[36mINFO[0m[0m 03/19 10:26:09 | training-domain validation (iid, inD) = 98.111%
[37m[36mINFO[0m[0m 03/19 10:26:09 | === Summary ===
[37m[36mINFO[0m[0m 03/19 10:26:09 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 1 --hparams_seed 16
[37m[36mINFO[0m[0m 03/19 10:26:09 | Unique name: 250319_10-00-41_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 10:26:09 | Out path: train_output/PACS/ERM/[0]/250319_10-00-41_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 10:26:09 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 10:26:09 | Dataset: PACS

[37m[36mINFO[0m[0m 03/19 03:57:23 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 1 --hparams_seed 4
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 4
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250319_03-57-23_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 1
	unique_name: 250319_03-57-23_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 7.71168362195819e-05
	batch_size: 8
	weight_decay: 0.0007466379205516084
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/19 03:57:23 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 03:57:23 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 03:57:23 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 03:57:23 | 
[37m[36mINFO[0m[0m 03/19 03:57:23 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 03:57:23 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 03:57:23 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 03:57:23 | Batch sizes for each domain: [0, 8, 8, 8] (total=24)
[37m[36mINFO[0m[0m 03/19 03:57:23 | steps-per-epoch for each domain: 234.50, 167.00, 393.00 -> min = 167.00
[37m[36mINFO[0m[0m 03/19 03:57:25 | # of params = 23522375
[37m[36mINFO[0m[0m 03/19 03:57:57 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 03:57:57 | 0.169005    0.176039    0.192671    0.218739    1.981706    0.169005    0.176039    0.193497    0.235043    0.196856    0.227545    0.187659    0.193631    0           0.000000    2.109344    1.339032    31.355394  
[37m[36mINFO[0m[0m 03/19 03:58:55 | 0.669311    0.674817    0.852241    0.864739    0.370855    0.669311    0.674817    0.813433    0.809829    0.921407    0.955090    0.821883    0.829299    200         1.197605    0.736969    0.135029    31.188977  
[37m[36mINFO[0m[0m 03/19 03:59:50 | 0.740696    0.782396    0.896893    0.909923    0.245137    0.740696    0.782396    0.870469    0.884615    0.952844    0.961078    0.867366    0.884076    400         2.395210    0.304158    0.118311    31.367100  
[37m[36mINFO[0m[0m 03/19 04:00:56 | 0.818182    0.841076    0.885161    0.898560    0.293178    0.818182    0.841076    0.852878    0.876068    0.952096    0.952096    0.850509    0.867516    600         3.592814    0.217979    0.161750    32.823731  
[37m[36mINFO[0m[0m 03/19 04:02:09 | 0.834045    0.845966    0.930377    0.932538    0.191112    0.834045    0.845966    0.913646    0.912393    0.967814    0.982036    0.909669    0.903185    800         4.790419    0.175423    0.208887    31.547325  
[37m[36mINFO[0m[0m 03/19 04:03:05 | 0.865162    0.885086    0.967423    0.957808    0.130277    0.865162    0.885086    0.968017    0.944444    0.985778    0.985030    0.948473    0.943949    1000        5.988024    0.164760    0.117500    32.801287  
[37m[36mINFO[0m[0m 03/19 04:04:00 | 0.789506    0.757946    0.942037    0.928679    0.193004    0.789506    0.757946    0.931770    0.901709    0.967814    0.976048    0.926527    0.908280    1200        7.185629    0.160482    0.120608    31.110451  
[37m[36mINFO[0m[0m 03/19 04:05:07 | 0.831605    0.843521    0.978376    0.966214    0.104050    0.831605    0.843521    0.980277    0.963675    0.989521    0.991018    0.965331    0.943949    1400        8.383234    0.112300    0.182814    30.036101  
[37m[36mINFO[0m[0m 03/19 04:06:02 | 0.814521    0.819071    0.973559    0.957796    0.128199    0.814521    0.819071    0.973348    0.942308    0.990269    0.982036    0.957061    0.949045    1600        9.580838    0.094270    0.123154    30.451200  
[37m[36mINFO[0m[0m 03/19 04:06:58 | 0.829774    0.836186    0.973079    0.966615    0.103192    0.829774    0.836186    0.970149    0.959402    0.985030    0.985030    0.964059    0.955414    1800        10.778443   0.091549    0.121201    31.635343  
[37m[36mINFO[0m[0m 03/19 04:07:53 | 0.768761    0.765281    0.976970    0.958815    0.134804    0.768761    0.765281    0.982942    0.965812    0.990269    0.973054    0.957697    0.937580    2000        11.976048   0.099173    0.120671    30.641659  
[37m[36mINFO[0m[0m 03/19 04:08:49 | 0.805979    0.843521    0.975007    0.962658    0.112706    0.805979    0.843521    0.971215    0.965812    0.991018    0.982036    0.962786    0.940127    2200        13.173653   0.082459    0.114893    33.217628  
[37m[36mINFO[0m[0m 03/19 04:09:47 | 0.811470    0.801956    0.984750    0.977268    0.080731    0.811470    0.801956    0.983475    0.970085    0.991766    0.991018    0.979008    0.970701    2400        14.371257   0.073618    0.129015    32.635005  
[37m[36mINFO[0m[0m 03/19 04:10:56 | 0.849298    0.865526    0.983231    0.960923    0.131045    0.849298    0.865526    0.986141    0.955128    0.990269    0.976048    0.973282    0.951592    2600        15.568862   0.054592    0.186208    30.965296  
[37m[36mINFO[0m[0m 03/19 04:11:51 | 0.815741    0.843521    0.984372    0.961365    0.157390    0.815741    0.843521    0.990405    0.946581    0.991018    0.991018    0.971692    0.946497    2800        16.766467   0.056063    0.123274    30.455622  
[37m[36mINFO[0m[0m 03/19 04:12:47 | 0.768151    0.762836    0.978325    0.953529    0.151821    0.768151    0.762836    0.966951    0.918803    0.992515    0.994012    0.975509    0.947771    3000        17.964072   0.047657    0.120186    31.712807  
[37m[36mINFO[0m[0m 03/19 04:13:55 | 0.835876    0.828851    0.976352    0.955366    0.180830    0.835876    0.828851    0.960021    0.920940    0.999251    0.991018    0.969784    0.954140    3200        19.161677   0.046594    0.188449    30.999311  
[37m[36mINFO[0m[0m 03/19 04:14:49 | 0.787065    0.787286    0.987662    0.974008    0.097444    0.787065    0.787286    0.987740    0.967949    0.994012    0.991018    0.981234    0.963057    3400        20.359281   0.065696    0.120229    29.806673  
[37m[36mINFO[0m[0m 03/19 04:15:45 | 0.831605    0.806846    0.986390    0.963508    0.118333    0.831605    0.806846    0.988806    0.965812    0.993263    0.982036    0.977099    0.942675    3600        21.556886   0.049317    0.117194    32.645389  
[37m[36mINFO[0m[0m 03/19 04:16:54 | 0.812691    0.819071    0.992879    0.969322    0.085567    0.812691    0.819071    0.991471    0.957265    0.999251    0.994012    0.987913    0.956688    3800        22.754491   0.042941    0.177145    33.563743  
[37m[36mINFO[0m[0m 03/19 04:17:50 | 0.782184    0.772616    0.986384    0.960643    0.145470    0.782184    0.772616    0.986674    0.946581    0.992515    0.985030    0.979962    0.950318    4000        23.952096   0.034961    0.120707    31.624896  
[37m[36mINFO[0m[0m 03/19 04:18:44 | 0.765101    0.799511    0.941650    0.926976    0.260798    0.765101    0.799511    0.941365    0.916667    0.974551    0.961078    0.909033    0.903185    4200        25.149701   0.046597    0.115706    30.676048  
[37m[36mINFO[0m[0m 03/19 04:19:56 | 0.804149    0.784841    0.990256    0.971885    0.081699    0.804149    0.784841    0.994136    0.967949    0.994760    0.991018    0.981870    0.956688    4400        26.347305   0.049364    0.198601    32.601923  
[37m[36mINFO[0m[0m 03/19 04:20:53 | 0.818182    0.838631    0.992105    0.974133    0.094477    0.818182    0.838631    0.993603    0.963675    0.999251    0.988024    0.983461    0.970701    4600        27.544910   0.027096    0.132040    30.255562  
[37m[36mINFO[0m[0m 03/19 04:21:49 | 0.794387    0.779951    0.987347    0.962903    0.116386    0.794387    0.779951    0.985075    0.944444    0.997006    0.985030    0.979962    0.959236    4800        28.742515   0.032356    0.117957    32.629604  
[37m[36mINFO[0m[0m 03/19 04:22:56 | 0.741306    0.738386    0.966560    0.962465    0.147002    0.741306    0.738386    0.954691    0.938034    0.976796    0.985030    0.968193    0.964331    5000        29.940120   0.048134    0.184942    30.396053  
[37m[36mINFO[0m[0m 03/19 04:22:57 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250319_03-57-23_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 04:22:58 | ---
[37m[36mINFO[0m[0m 03/19 04:22:58 | test-domain validation(oracle) = 86.516%
[37m[36mINFO[0m[0m 03/19 04:22:58 | training-domain validation(iid) = 81.147%
[37m[36mINFO[0m[0m 03/19 04:22:58 | last = 74.131%
[37m[36mINFO[0m[0m 03/19 04:22:58 | last (inD) = 96.247%
[37m[36mINFO[0m[0m 03/19 04:22:58 | training-domain validation (iid, inD) = 97.727%
[37m[36mINFO[0m[0m 03/19 04:22:58 | === Summary ===
[37m[36mINFO[0m[0m 03/19 04:22:58 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 1 --hparams_seed 4
[37m[36mINFO[0m[0m 03/19 04:22:58 | Unique name: 250319_03-57-23_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 04:22:58 | Out path: train_output/PACS/ERM/[0]/250319_03-57-23_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 04:22:58 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 04:22:58 | Dataset: PACS

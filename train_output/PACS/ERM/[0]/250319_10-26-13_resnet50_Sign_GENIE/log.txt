[37m[36mINFO[0m[0m 03/19 10:26:13 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 1 --hparams_seed 17
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 17
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250319_10-26-13_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 1
	unique_name: 250319_10-26-13_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.0002990700776954947
	batch_size: 8
	weight_decay: 4.0966675521600606e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/19 10:26:13 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 10:26:13 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 10:26:13 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 10:26:13 | 
[37m[36mINFO[0m[0m 03/19 10:26:13 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 10:26:13 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 10:26:13 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 10:26:13 | Batch sizes for each domain: [0, 8, 8, 8] (total=24)
[37m[36mINFO[0m[0m 03/19 10:26:13 | steps-per-epoch for each domain: 234.50, 167.00, 393.00 -> min = 167.00
[37m[36mINFO[0m[0m 03/19 10:26:14 | # of params = 23522375
[37m[36mINFO[0m[0m 03/19 10:26:47 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 10:26:47 | 0.174497    0.178484    0.192671    0.220450    1.975489    0.174497    0.178484    0.193497    0.237179    0.196856    0.230539    0.187659    0.193631    0           0.000000    2.109344    1.079217    32.008753  
[37m[36mINFO[0m[0m 03/19 10:27:51 | 0.644905    0.645477    0.869849    0.890944    0.326788    0.644905    0.645477    0.857143    0.865385    0.933383    0.973054    0.819020    0.834395    200         1.197605    0.731415    0.164065    31.463766  
[37m[36mINFO[0m[0m 03/19 10:28:47 | 0.744356    0.792176    0.902329    0.918028    0.238068    0.744356    0.792176    0.885394    0.895299    0.940868    0.967066    0.880725    0.891720    400         2.395210    0.304090    0.117346    32.562431  
[37m[36mINFO[0m[0m 03/19 10:29:43 | 0.828554    0.836186    0.946190    0.955409    0.143252    0.828554    0.836186    0.938166    0.944444    0.970060    0.988024    0.930344    0.933758    600         3.592814    0.203052    0.120763    32.033339  
[37m[36mINFO[0m[0m 03/19 10:30:45 | 0.830995    0.860636    0.951706    0.956812    0.135258    0.830995    0.860636    0.941898    0.948718    0.968563    0.979042    0.944656    0.942675    800         4.790419    0.190738    0.152051    31.795268  
[37m[36mINFO[0m[0m 03/19 10:31:41 | 0.830995    0.826406    0.956224    0.955654    0.138789    0.830995    0.826406    0.946695    0.923077    0.976048    0.991018    0.945929    0.952866    1000        5.988024    0.168010    0.115466    32.894962  
[37m[36mINFO[0m[0m 03/19 10:32:37 | 0.798048    0.794621    0.945687    0.940183    0.188753    0.798048    0.794621    0.940832    0.916667    0.965569    0.979042    0.930662    0.924841    1200        7.185629    0.166566    0.120877    31.209902  
[37m[36mINFO[0m[0m 03/19 10:33:37 | 0.801098    0.819071    0.967236    0.959786    0.113747    0.801098    0.819071    0.963753    0.952991    0.985030    0.976048    0.952926    0.950318    1400        8.383234    0.125124    0.146649    31.281536  
[37m[36mINFO[0m[0m 03/19 10:34:30 | 0.769982    0.743276    0.963713    0.950562    0.145520    0.769982    0.743276    0.955224    0.931624    0.982036    0.985030    0.953880    0.935032    1600        9.580838    0.105303    0.112717    30.320913  
[37m[36mINFO[0m[0m 03/19 10:35:28 | 0.825503    0.811736    0.979621    0.958381    0.123513    0.825503    0.811736    0.979744    0.944444    0.992515    0.988024    0.966603    0.942675    1800        10.778443   0.085598    0.131012    31.162801  
[37m[36mINFO[0m[0m 03/19 10:36:26 | 0.861501    0.860636    0.980391    0.965330    0.113184    0.861501    0.860636    0.978145    0.957265    0.991018    0.982036    0.972010    0.956688    2000        11.976048   0.087306    0.136937    31.055556  
[37m[36mINFO[0m[0m 03/19 10:37:19 | 0.857840    0.858191    0.976737    0.958095    0.116831    0.857840    0.858191    0.969616    0.946581    0.991766    0.985030    0.968830    0.942675    2200        13.173653   0.068195    0.111143    30.587347  
[37m[36mINFO[0m[0m 03/19 10:38:17 | 0.872483    0.887531    0.983976    0.968034    0.101973    0.872483    0.887531    0.984542    0.974359    0.992515    0.973054    0.974873    0.956688    2400        14.371257   0.078877    0.135085    31.384955  
[37m[36mINFO[0m[0m 03/19 10:39:15 | 0.852959    0.858191    0.988984    0.973724    0.086438    0.852959    0.858191    0.992004    0.974359    0.996257    0.985030    0.978690    0.961783    2600        15.568862   0.058942    0.133923    30.549928  
[37m[36mINFO[0m[0m 03/19 10:40:09 | 0.758999    0.740831    0.980147    0.962066    0.116643    0.758999    0.740831    0.982409    0.946581    0.989521    0.988024    0.968511    0.951592    2800        16.766467   0.056670    0.115486    30.765299  
[37m[36mINFO[0m[0m 03/19 10:41:04 | 0.788896    0.784841    0.981133    0.959046    0.145851    0.788896    0.784841    0.980277    0.938034    0.989521    0.976048    0.973601    0.963057    3000        17.964072   0.063405    0.117245    31.930453  
[37m[36mINFO[0m[0m 03/19 10:42:00 | 0.799268    0.814181    0.974182    0.954076    0.163943    0.799268    0.814181    0.957889    0.933761    0.995509    0.973054    0.969148    0.955414    3200        19.161677   0.069269    0.121098    31.816624  
[37m[36mINFO[0m[0m 03/19 10:42:57 | 0.813911    0.811736    0.989720    0.962168    0.116571    0.813911    0.811736    0.987740    0.938034    0.997006    0.979042    0.984415    0.969427    3400        20.359281   0.046787    0.119876    33.486600  
[37m[36mINFO[0m[0m 03/19 10:44:07 | 0.830995    0.821516    0.987325    0.965750    0.106937    0.830995    0.821516    0.986674    0.948718    0.988024    0.988024    0.987277    0.960510    3600        21.556886   0.056442    0.188824    31.413817  
[37m[36mINFO[0m[0m 03/19 10:45:01 | 0.801708    0.809291    0.989440    0.979413    0.080118    0.801708    0.809291    0.986674    0.970085    0.998503    1.000000    0.983142    0.968153    3800        22.754491   0.025927    0.116141    31.054936  
[37m[36mINFO[0m[0m 03/19 10:45:56 | 0.850519    0.850856    0.981173    0.951841    0.174217    0.850519    0.850856    0.980810    0.944444    0.991018    0.976048    0.971692    0.935032    4000        23.952096   0.034938    0.120363    31.068858  
[37m[36mINFO[0m[0m 03/19 10:47:10 | 0.848078    0.833741    0.993695    0.970163    0.084931    0.848078    0.833741    0.995736    0.963675    0.997754    0.985030    0.987595    0.961783    4200        25.149701   0.037016    0.205996    32.847146  
[37m[36mINFO[0m[0m 03/19 10:48:05 | 0.871263    0.865526    0.991890    0.967613    0.120033    0.871263    0.865526    0.994136    0.959402    0.997754    0.988024    0.983779    0.955414    4400        26.347305   0.036679    0.118042    30.837440  
[37m[36mINFO[0m[0m 03/19 10:49:00 | 0.787065    0.777506    0.985342    0.958956    0.117095    0.787065    0.777506    0.990938    0.948718    0.996257    0.988024    0.968830    0.940127    4600        27.544910   0.052840    0.117318    32.009438  
[37m[36mINFO[0m[0m 03/19 10:50:14 | 0.848688    0.848411    0.994865    0.973859    0.075473    0.848688    0.848411    0.994136    0.967949    1.000000    0.988024    0.990458    0.965605    4800        28.742515   0.036803    0.212296    31.320587  
[37m[36mINFO[0m[0m 03/19 10:51:10 | 0.845027    0.797066    0.992423    0.968576    0.105779    0.845027    0.797066    0.995736    0.952991    0.997754    0.982036    0.983779    0.970701    5000        29.940120   0.030869    0.120856    32.073915  
[37m[36mINFO[0m[0m 03/19 10:51:10 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250319_10-26-13_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 10:51:12 | ---
[37m[36mINFO[0m[0m 03/19 10:51:12 | test-domain validation(oracle) = 87.248%
[37m[36mINFO[0m[0m 03/19 10:51:12 | training-domain validation(iid) = 80.171%
[37m[36mINFO[0m[0m 03/19 10:51:12 | last = 84.503%
[37m[36mINFO[0m[0m 03/19 10:51:12 | last (inD) = 96.858%
[37m[36mINFO[0m[0m 03/19 10:51:12 | training-domain validation (iid, inD) = 97.941%
[37m[36mINFO[0m[0m 03/19 10:51:12 | === Summary ===
[37m[36mINFO[0m[0m 03/19 10:51:12 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 1 --hparams_seed 17
[37m[36mINFO[0m[0m 03/19 10:51:12 | Unique name: 250319_10-26-13_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 10:51:12 | Out path: train_output/PACS/ERM/[0]/250319_10-26-13_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 10:51:12 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 10:51:12 | Dataset: PACS

[37m[36mINFO[0m[0m 03/18 21:44:47 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 0 --hparams_seed 11
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 11
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250318_21-44-47_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250318_21-44-47_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5.962562271631622e-05
	batch_size: 11
	weight_decay: 0.001114945719897867
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/18 21:44:47 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 21:44:47 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 21:44:47 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 21:44:47 | 
[37m[36mINFO[0m[0m 03/18 21:44:47 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/18 21:44:47 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/18 21:44:47 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/18 21:44:47 | Batch sizes for each domain: [0, 11, 11, 11] (total=33)
[37m[36mINFO[0m[0m 03/18 21:44:47 | steps-per-epoch for each domain: 170.55, 121.45, 285.82 -> min = 121.45
[37m[36mINFO[0m[0m 03/18 21:44:48 | # of params = 23522375
[37m[36mINFO[0m[0m 03/18 21:45:22 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 21:45:22 | 0.148261    0.158924    0.177429    0.153628    1.965667    0.148261    0.158924    0.191898    0.166667    0.144461    0.110778    0.195929    0.183439    0           0.000000    1.945531    0.913951    32.844550  
[37m[36mINFO[0m[0m 03/18 21:46:18 | 0.770592    0.767726    0.913492    0.923039    0.222929    0.770592    0.767726    0.903518    0.918803    0.964820    0.970060    0.872137    0.880255    200         1.646707    0.481793    0.120788    31.968826  
[37m[36mINFO[0m[0m 03/18 21:47:13 | 0.820012    0.823961    0.943822    0.944999    0.148739    0.820012    0.823961    0.921109    0.931624    0.981287    0.967066    0.929071    0.936306    400         3.293413    0.203115    0.112446    31.764112  
[37m[36mINFO[0m[0m 03/18 21:48:09 | 0.821843    0.836186    0.965778    0.951835    0.122914    0.821843    0.836186    0.958422    0.955128    0.985030    0.964072    0.953880    0.936306    600         4.940120    0.142563    0.122837    31.761951  
[37m[36mINFO[0m[0m 03/18 21:49:05 | 0.848688    0.865526    0.976042    0.960792    0.118454    0.848688    0.865526    0.972281    0.946581    0.994012    0.988024    0.961832    0.947771    800         6.586826    0.118747    0.115700    32.732640  
[37m[36mINFO[0m[0m 03/18 21:50:01 | 0.885906    0.907090    0.976680    0.958551    0.118007    0.885906    0.907090    0.978145    0.967949    0.991018    0.979042    0.960878    0.928662    1000        8.233533    0.090996    0.117505    32.228293  
[37m[36mINFO[0m[0m 03/18 21:50:57 | 0.756559    0.762836    0.974329    0.942762    0.165918    0.756559    0.762836    0.978145    0.938034    0.984281    0.973054    0.960560    0.917197    1200        9.880240    0.069494    0.121009    32.255250  
[37m[36mINFO[0m[0m 03/18 21:51:53 | 0.702257    0.694377    0.954950    0.942431    0.203260    0.702257    0.694377    0.957356    0.935897    0.968563    0.955090    0.938931    0.936306    1400        11.526946   0.068918    0.119755    32.183990  
[37m[36mINFO[0m[0m 03/18 21:52:51 | 0.847468    0.867971    0.981994    0.959950    0.120467    0.847468    0.867971    0.979211    0.963675    0.994760    0.976048    0.972010    0.940127    1600        13.173653   0.069276    0.122405    33.121395  
[37m[36mINFO[0m[0m 03/18 21:53:49 | 0.852349    0.867971    0.978769    0.955674    0.151788    0.852349    0.867971    0.979211    0.970085    0.991766    0.958084    0.965331    0.938854    1800        14.820359   0.044372    0.126445    33.247976  
[37m[36mINFO[0m[0m 03/18 21:54:47 | 0.840757    0.848411    0.986636    0.970039    0.121134    0.840757    0.848411    0.985075    0.972222    0.995509    0.985030    0.979326    0.952866    2000        16.467066   0.047428    0.126226    32.395953  
[37m[36mINFO[0m[0m 03/18 21:55:44 | 0.823063    0.809291    0.987979    0.963341    0.157234    0.823063    0.809291    0.993070    0.974359    0.990269    0.964072    0.980598    0.951592    2200        18.113772   0.026901    0.124278    32.585974  
[37m[36mINFO[0m[0m 03/18 21:56:42 | 0.810860    0.823961    0.981147    0.957823    0.126702    0.810860    0.823961    0.972814    0.955128    0.999251    0.982036    0.971374    0.936306    2400        19.760479   0.049952    0.121764    32.740588  
[37m[36mINFO[0m[0m 03/18 21:57:37 | 0.831605    0.831296    0.978876    0.950099    0.193734    0.831605    0.831296    0.992537    0.967949    0.970808    0.937126    0.973282    0.945223    2600        21.407186   0.036463    0.120476    31.296028  
[37m[36mINFO[0m[0m 03/18 21:58:33 | 0.837706    0.860636    0.992629    0.968319    0.128415    0.837706    0.860636    0.991471    0.972222    0.998503    0.976048    0.987913    0.956688    2800        23.053892   0.028643    0.116470    32.341661  
[37m[36mINFO[0m[0m 03/18 21:59:29 | 0.790726    0.819071    0.989766    0.966758    0.124647    0.790726    0.819071    0.992537    0.970085    0.997754    0.976048    0.979008    0.954140    3000        24.700599   0.028278    0.123426    31.822977  
[37m[36mINFO[0m[0m 03/18 22:00:26 | 0.783405    0.789731    0.988204    0.955953    0.159378    0.783405    0.789731    0.989872    0.950855    0.997006    0.973054    0.977735    0.943949    3200        26.347305   0.024709    0.122943    32.407931  
[37m[36mINFO[0m[0m 03/18 22:01:23 | 0.848078    0.858191    0.990437    0.964337    0.135065    0.848078    0.858191    0.993070    0.970085    0.997006    0.970060    0.981234    0.952866    3400        27.994012   0.035658    0.120265    32.867550  
[37m[36mINFO[0m[0m 03/18 22:02:18 | 0.862111    0.860636    0.995360    0.964345    0.127377    0.862111    0.860636    0.995736    0.963675    0.999251    0.979042    0.991094    0.950318    3600        29.640719   0.015209    0.116414    31.445473  
[37m[36mINFO[0m[0m 03/18 22:03:15 | 0.850519    0.850856    0.993200    0.965038    0.133656    0.850519    0.850856    0.993070    0.970085    0.999251    0.967066    0.987277    0.957962    3800        31.287425   0.019010    0.127191    31.394937  
[37m[36mINFO[0m[0m 03/18 22:04:09 | 0.810250    0.831296    0.996667    0.970294    0.112340    0.810250    0.831296    0.998401    0.972222    0.997006    0.973054    0.994593    0.965605    4000        32.934132   0.025249    0.115162    31.850608  
[37m[36mINFO[0m[0m 03/18 22:05:06 | 0.791946    0.787286    0.988232    0.959066    0.157313    0.791946    0.787286    0.989339    0.957265    0.994760    0.967066    0.980598    0.952866    4200        34.580838   0.019366    0.123910    31.910870  
[37m[36mINFO[0m[0m 03/18 22:06:03 | 0.845027    0.833741    0.994902    0.961913    0.133053    0.845027    0.833741    0.997335    0.961538    0.998503    0.970060    0.988868    0.954140    4400        36.227545   0.023433    0.123075    32.209007  
[37m[36mINFO[0m[0m 03/18 22:07:00 | 0.860891    0.853301    0.995685    0.970730    0.116190    0.860891    0.853301    0.997868    0.974359    1.000000    0.976048    0.989186    0.961783    4600        37.874251   0.011077    0.128113    31.635730  
[37m[36mINFO[0m[0m 03/18 22:07:56 | 0.844417    0.853301    0.997025    0.968182    0.122675    0.844417    0.853301    0.998934    0.974359    0.998503    0.976048    0.993639    0.954140    4800        39.520958   0.014575    0.117305    32.800230  
[37m[36mINFO[0m[0m 03/18 22:08:51 | 0.838316    0.855746    0.994400    0.966155    0.151489    0.838316    0.855746    0.993603    0.976496    0.998503    0.955090    0.991094    0.966879    5000        41.167665   0.010320    0.117085    31.428525  
[37m[36mINFO[0m[0m 03/18 22:08:51 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250318_21-44-47_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 22:08:53 | ---
[37m[36mINFO[0m[0m 03/18 22:08:53 | test-domain validation(oracle) = 88.591%
[37m[36mINFO[0m[0m 03/18 22:08:53 | training-domain validation(iid) = 86.089%
[37m[36mINFO[0m[0m 03/18 22:08:53 | last = 83.832%
[37m[36mINFO[0m[0m 03/18 22:08:53 | last (inD) = 96.615%
[37m[36mINFO[0m[0m 03/18 22:08:53 | training-domain validation (iid, inD) = 97.073%
[37m[36mINFO[0m[0m 03/18 22:08:54 | === Summary ===
[37m[36mINFO[0m[0m 03/18 22:08:54 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 0 --hparams_seed 11
[37m[36mINFO[0m[0m 03/18 22:08:54 | Unique name: 250318_21-44-47_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 22:08:54 | Out path: train_output/PACS/ERM/[0]/250318_21-44-47_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 22:08:54 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 22:08:54 | Dataset: PACS

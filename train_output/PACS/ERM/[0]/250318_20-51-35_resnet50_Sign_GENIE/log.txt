[37m[36mINFO[0m[0m 03/18 20:51:35 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 0 --hparams_seed 9
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 9
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250318_20-51-35_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250318_20-51-35_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5.5014200978340895e-05
	batch_size: 15
	weight_decay: 3.288190104805334e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/18 20:51:35 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 20:51:35 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 20:51:35 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 20:51:35 | 
[37m[36mINFO[0m[0m 03/18 20:51:35 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/18 20:51:35 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/18 20:51:35 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/18 20:51:35 | Batch sizes for each domain: [0, 15, 15, 15] (total=45)
[37m[36mINFO[0m[0m 03/18 20:51:35 | steps-per-epoch for each domain: 125.07, 89.07, 209.60 -> min = 89.07
[37m[36mINFO[0m[0m 03/18 20:51:36 | # of params = 23522375
[37m[36mINFO[0m[0m 03/18 20:52:09 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 20:52:09 | 0.217206    0.215159    0.266198    0.267732    1.899275    0.217206    0.215159    0.263326    0.318376    0.370509    0.338323    0.164758    0.146497    0           0.000000    1.963452    1.249946    31.256583  
[37m[36mINFO[0m[0m 03/18 20:53:08 | 0.732764    0.726161    0.923209    0.934520    0.198695    0.732764    0.726161    0.899254    0.929487    0.967066    0.967066    0.903308    0.907006    200         2.245509    0.415285    0.136629    31.922786  
[37m[36mINFO[0m[0m 03/18 20:54:07 | 0.824283    0.804401    0.944755    0.936078    0.194748    0.824283    0.804401    0.922708    0.923077    0.985030    0.973054    0.926527    0.912102    400         4.491018    0.150367    0.137322    31.303360  
[37m[36mINFO[0m[0m 03/18 20:55:04 | 0.818182    0.826406    0.952938    0.932972    0.199653    0.818182    0.826406    0.944563    0.933761    0.990269    0.967066    0.923982    0.898089    600         6.736527    0.116481    0.129969    31.037170  
[37m[36mINFO[0m[0m 03/18 20:56:00 | 0.787065    0.782396    0.976208    0.959938    0.122800    0.787065    0.782396    0.966418    0.961538    0.994012    0.973054    0.968193    0.945223    800         8.982036    0.083260    0.134288    29.487909  
[37m[36mINFO[0m[0m 03/18 20:56:59 | 0.831605    0.819071    0.977251    0.957367    0.141253    0.831605    0.819071    0.977612    0.957265    0.993263    0.967066    0.960878    0.947771    1000        11.227545   0.069847    0.137498    31.907544  
[37m[36mINFO[0m[0m 03/18 20:57:56 | 0.845027    0.860636    0.982486    0.963359    0.119700    0.845027    0.860636    0.984542    0.965812    0.990269    0.979042    0.972646    0.945223    1200        13.473054   0.064506    0.131501    29.799628  
[37m[36mINFO[0m[0m 03/18 20:58:54 | 0.861501    0.843521    0.987883    0.962097    0.134695    0.861501    0.843521    0.989339    0.967949    0.996257    0.982036    0.978053    0.936306    1400        15.718563   0.048081    0.133041    31.658615  
[37m[36mINFO[0m[0m 03/18 20:59:50 | 0.765101    0.782396    0.979896    0.959214    0.128945    0.765101    0.782396    0.970149    0.957265    0.996257    0.970060    0.973282    0.950318    1600        17.964072   0.037707    0.133002    29.943078  
[37m[36mINFO[0m[0m 03/18 21:00:46 | 0.825503    0.821516    0.993421    0.967032    0.111174    0.825503    0.821516    0.997868    0.965812    0.999251    0.976048    0.983142    0.959236    1800        20.209581   0.036949    0.132703    29.397939  
[37m[36mINFO[0m[0m 03/18 21:01:44 | 0.826724    0.831296    0.986508    0.951227    0.190975    0.826724    0.831296    0.987740    0.948718    0.985778    0.952096    0.986005    0.952866    2000        22.455090   0.035819    0.133510    31.052625  
[37m[36mINFO[0m[0m 03/18 21:02:42 | 0.844417    0.841076    0.993443    0.965185    0.128945    0.844417    0.841076    0.990938    0.965812    0.999251    0.973054    0.990140    0.956688    2200        24.700599   0.022099    0.129191    32.230142  
[37m[36mINFO[0m[0m 03/18 21:03:40 | 0.851739    0.855746    0.993137    0.970742    0.125804    0.851739    0.855746    0.997335    0.976496    0.999251    0.979042    0.982824    0.956688    2400        26.946108   0.023236    0.133419    31.563471  
[37m[36mINFO[0m[0m 03/18 21:04:37 | 0.836486    0.850856    0.995466    0.964899    0.139323    0.836486    0.850856    0.998934    0.967949    0.997006    0.970060    0.990458    0.956688    2600        29.191617   0.019619    0.132959    30.200219  
[37m[36mINFO[0m[0m 03/18 21:05:34 | 0.852349    0.843521    0.994400    0.961903    0.146261    0.852349    0.843521    0.995736    0.963675    0.997006    0.964072    0.990458    0.957962    2800        31.437126   0.016984    0.133039    29.683069  
[37m[36mINFO[0m[0m 03/18 21:06:29 | 0.810860    0.799511    0.981041    0.943559    0.266648    0.810860    0.799511    0.963220    0.916667    0.993263    0.970060    0.986641    0.943949    3000        33.682635   0.018074    0.129339    29.777955  
[37m[36mINFO[0m[0m 03/18 21:07:26 | 0.829164    0.809291    0.995641    0.963187    0.143036    0.829164    0.809291    0.998934    0.961538    0.996257    0.970060    0.991730    0.957962    3200        35.928144   0.020939    0.131141    30.300052  
[37m[36mINFO[0m[0m 03/18 21:08:22 | 0.873093    0.867971    0.996776    0.969446    0.152819    0.873093    0.867971    0.997868    0.976496    0.998503    0.970060    0.993957    0.961783    3400        38.173653   0.015063    0.131810    29.815158  
[37m[36mINFO[0m[0m 03/18 21:09:21 | 0.863331    0.863081    0.996130    0.974149    0.095647    0.863331    0.863081    0.997335    0.974359    0.995509    0.985030    0.995547    0.963057    3600        40.419162   0.021353    0.134280    31.856050  
[37m[36mINFO[0m[0m 03/18 21:10:21 | 0.854790    0.860636    0.998160    0.969041    0.142283    0.854790    0.860636    0.998934    0.972222    1.000000    0.982036    0.995547    0.952866    3800        42.664671   0.007601    0.135423    33.137712  
[37m[36mINFO[0m[0m 03/18 21:11:19 | 0.864552    0.875306    0.997556    0.974137    0.108945    0.864552    0.875306    0.996802    0.972222    1.000000    0.982036    0.995865    0.968153    4000        44.910180   0.019553    0.136720    30.983041  
[37m[36mINFO[0m[0m 03/18 21:12:17 | 0.832215    0.826406    0.995675    0.960214    0.167446    0.832215    0.826406    0.996269    0.961538    0.997754    0.970060    0.993003    0.949045    4200        47.155689   0.010382    0.136040    30.698578  
[37m[36mINFO[0m[0m 03/18 21:13:14 | 0.859671    0.853301    0.997378    0.966597    0.160378    0.859671    0.853301    0.997335    0.967949    0.999251    0.970060    0.995547    0.961783    4400        49.401198   0.013128    0.131912    30.734041  
[37m[36mINFO[0m[0m 03/18 21:14:11 | 0.827334    0.821516    0.997833    0.968171    0.146688    0.827334    0.821516    0.998401    0.972222    0.997006    0.973054    0.998092    0.959236    4600        51.646707   0.011720    0.134149    29.652086  
[37m[36mINFO[0m[0m 03/18 21:15:07 | 0.830384    0.828851    0.997980    0.967306    0.175379    0.830384    0.828851    0.996802    0.961538    1.000000    0.976048    0.997137    0.964331    4800        53.892216   0.006828    0.129935    30.437459  
[37m[36mINFO[0m[0m 03/18 21:16:06 | 0.861501    0.872861    0.997802    0.964909    0.144478    0.861501    0.872861    0.998401    0.965812    0.998503    0.976048    0.996501    0.952866    5000        56.137725   0.011524    0.133268    31.896590  
[37m[36mINFO[0m[0m 03/18 21:16:06 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250318_20-51-35_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 21:16:07 | ---
[37m[36mINFO[0m[0m 03/18 21:16:07 | test-domain validation(oracle) = 86.455%
[37m[36mINFO[0m[0m 03/18 21:16:07 | training-domain validation(iid) = 86.333%
[37m[36mINFO[0m[0m 03/18 21:16:07 | last = 86.150%
[37m[36mINFO[0m[0m 03/18 21:16:07 | last (inD) = 96.491%
[37m[36mINFO[0m[0m 03/18 21:16:07 | training-domain validation (iid, inD) = 97.415%
[37m[36mINFO[0m[0m 03/18 21:16:07 | === Summary ===
[37m[36mINFO[0m[0m 03/18 21:16:07 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 0 --hparams_seed 9
[37m[36mINFO[0m[0m 03/18 21:16:07 | Unique name: 250318_20-51-35_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 21:16:07 | Out path: train_output/PACS/ERM/[0]/250318_20-51-35_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 21:16:07 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 21:16:07 | Dataset: PACS

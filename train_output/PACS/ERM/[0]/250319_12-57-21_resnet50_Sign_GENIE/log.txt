[37m[36mINFO[0m[0m 03/19 12:57:21 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 2 --hparams_seed 2
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 2
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250319_12-57-21_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 2
	unique_name: 250319_12-57-21_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 7.73819221686661e-05
	batch_size: 10
	weight_decay: 8.231814847964724e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/19 12:57:21 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 12:57:21 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 12:57:21 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 12:57:21 | 
[37m[36mINFO[0m[0m 03/19 12:57:21 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 12:57:21 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 12:57:21 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 12:57:21 | Batch sizes for each domain: [0, 10, 10, 10] (total=30)
[37m[36mINFO[0m[0m 03/19 12:57:21 | steps-per-epoch for each domain: 187.60, 133.60, 314.40 -> min = 133.60
[37m[36mINFO[0m[0m 03/19 12:57:22 | # of params = 23522375
[37m[36mINFO[0m[0m 03/19 12:57:55 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 12:57:55 | 0.187309    0.176039    0.159382    0.155164    2.063141    0.187309    0.176039    0.167377    0.160256    0.114521    0.107784    0.196247    0.197452    0           0.000000    1.961896    1.340552    32.135507  
[37m[36mINFO[0m[0m 03/19 12:58:53 | 0.786455    0.797066    0.918381    0.935684    0.206194    0.786455    0.797066    0.903518    0.944444    0.956587    0.967066    0.895038    0.895541    200         1.497006    0.591016    0.126834    31.956382  
[37m[36mINFO[0m[0m 03/19 12:59:56 | 0.833435    0.838631    0.943924    0.941112    0.168097    0.833435    0.838631    0.936567    0.950855    0.982036    0.982036    0.913168    0.890446    400         2.994012    0.240400    0.167925    30.107420  
[37m[36mINFO[0m[0m 03/19 13:00:54 | 0.797437    0.821516    0.949938    0.942355    0.172323    0.797437    0.821516    0.940299    0.929487    0.982036    0.988024    0.927481    0.909554    600         4.491018    0.165778    0.134410    30.617131  
[37m[36mINFO[0m[0m 03/19 13:01:49 | 0.816962    0.821516    0.954362    0.935958    0.174222    0.816962    0.821516    0.949360    0.940171    0.978293    0.967066    0.935433    0.900637    800         5.988024    0.146327    0.121072    30.648404  
[37m[36mINFO[0m[0m 03/19 13:02:54 | 0.790726    0.784841    0.967634    0.952435    0.124028    0.790726    0.784841    0.955757    0.940171    0.993263    0.991018    0.953880    0.926115    1000        7.485030    0.114082    0.173003    30.442210  
[37m[36mINFO[0m[0m 03/19 13:03:49 | 0.856620    0.855746    0.977558    0.958547    0.104354    0.856620    0.855746    0.968017    0.959402    0.995509    0.985030    0.969148    0.931210    1200        8.982036    0.101473    0.123862    30.344877  
[37m[36mINFO[0m[0m 03/19 13:04:46 | 0.793777    0.804401    0.970500    0.951925    0.147493    0.793777    0.804401    0.978145    0.963675    0.992515    0.994012    0.940840    0.898089    1400        10.479042   0.090159    0.132450    30.421486  
[37m[36mINFO[0m[0m 03/19 13:05:44 | 0.819402    0.848411    0.977919    0.951325    0.160008    0.819402    0.848411    0.972281    0.950855    0.995509    0.991018    0.965967    0.912102    1600        11.976048   0.071207    0.135979    30.765620  
[37m[36mINFO[0m[0m 03/19 13:06:39 | 0.811470    0.814181    0.987768    0.962944    0.105189    0.811470    0.814181    0.986674    0.963675    0.994760    0.985030    0.981870    0.940127    1800        13.473054   0.058575    0.123120    30.426500  
[37m[36mINFO[0m[0m 03/19 13:07:44 | 0.812691    0.823961    0.985507    0.959260    0.123203    0.812691    0.823961    0.990405    0.961538    0.992515    0.985030    0.973601    0.931210    2000        14.970060   0.054847    0.166757    31.569729  
[37m[36mINFO[0m[0m 03/19 13:08:40 | 0.863331    0.887531    0.984154    0.958684    0.115121    0.863331    0.887531    0.984009    0.957265    0.993263    0.985030    0.975191    0.933758    2200        16.467066   0.055384    0.128330    30.470879  
[37m[36mINFO[0m[0m 03/19 13:09:36 | 0.846858    0.867971    0.985043    0.970476    0.103923    0.846858    0.867971    0.984542    0.974359    0.994760    0.988024    0.975827    0.949045    2400        17.964072   0.045936    0.127690    30.671795  
[37m[36mINFO[0m[0m 03/19 13:10:42 | 0.805979    0.816626    0.987454    0.970073    0.100769    0.805979    0.816626    0.982942    0.974359    0.998503    0.997006    0.980916    0.938854    2600        19.461078   0.040042    0.171192    31.385663  
[37m[36mINFO[0m[0m 03/19 13:11:34 | 0.868212    0.894866    0.988947    0.964529    0.116392    0.868212    0.894866    0.988806    0.970085    0.997754    0.991018    0.980280    0.932484    2800        20.958084   0.040537    0.113520    29.595157  
[37m[36mINFO[0m[0m 03/19 13:12:29 | 0.737035    0.748166    0.984900    0.960518    0.114527    0.737035    0.748166    0.979211    0.950855    0.997754    0.988024    0.977735    0.942675    3000        22.455090   0.042868    0.119105    31.619066  
[37m[36mINFO[0m[0m 03/19 13:13:24 | 0.829774    0.823961    0.994297    0.969762    0.096162    0.829774    0.823961    0.996269    0.967949    0.997754    0.991018    0.988868    0.950318    3200        23.952096   0.028098    0.122916    30.272427  
[37m[36mINFO[0m[0m 03/19 13:14:18 | 0.859671    0.865526    0.986297    0.963105    0.103733    0.859671    0.865526    0.986674    0.965812    0.999251    0.991018    0.972964    0.932484    3400        25.449102   0.040697    0.116532    30.539948  
[37m[36mINFO[0m[0m 03/19 13:15:23 | 0.800488    0.845966    0.987800    0.960798    0.130105    0.800488    0.845966    0.981343    0.959402    0.997006    0.979042    0.985051    0.943949    3600        26.946108   0.038076    0.164502    31.585317  
[37m[36mINFO[0m[0m 03/19 13:16:18 | 0.807810    0.841076    0.987749    0.962247    0.108524    0.807810    0.841076    0.993070    0.972222    0.996257    0.982036    0.973919    0.932484    3800        28.443114   0.048167    0.120503    30.965849  
[37m[36mINFO[0m[0m 03/19 13:17:18 | 0.847468    0.848411    0.993084    0.965654    0.111306    0.847468    0.848411    0.993603    0.970085    0.995509    0.988024    0.990140    0.938854    4000        29.940120   0.040256    0.143024    31.378510  
[37m[36mINFO[0m[0m 03/19 13:18:15 | 0.848078    0.855746    0.988990    0.955725    0.158036    0.848078    0.855746    0.994136    0.963675    0.997006    0.985030    0.975827    0.918471    4200        31.437126   0.022054    0.133130    30.569570  
[37m[36mINFO[0m[0m 03/19 13:19:09 | 0.802318    0.806846    0.990895    0.966343    0.116619    0.802318    0.806846    0.993603    0.967949    0.996257    0.982036    0.982824    0.949045    4400        32.934132   0.028512    0.123307    29.793399  
[37m[36mINFO[0m[0m 03/19 13:20:16 | 0.804759    0.816626    0.987504    0.961498    0.136216    0.804759    0.816626    0.979744    0.959402    0.993263    0.976048    0.989504    0.949045    4600        34.431138   0.026361    0.183732    29.798328  
[37m[36mINFO[0m[0m 03/19 13:21:10 | 0.831605    0.833741    0.993050    0.962547    0.114108    0.831605    0.833741    0.994136    0.976496    0.995509    0.985030    0.989504    0.926115    4800        35.928144   0.023930    0.122502    30.055391  
[37m[36mINFO[0m[0m 03/19 13:22:07 | 0.863941    0.882641    0.992882    0.966515    0.105518    0.863941    0.882641    0.993070    0.972222    0.999251    0.991018    0.986323    0.936306    5000        37.425150   0.032512    0.125927    30.900146  
[37m[36mINFO[0m[0m 03/19 13:22:07 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250319_12-57-21_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 13:22:08 | ---
[37m[36mINFO[0m[0m 03/19 13:22:08 | test-domain validation(oracle) = 86.821%
[37m[36mINFO[0m[0m 03/19 13:22:08 | training-domain validation(iid) = 84.686%
[37m[36mINFO[0m[0m 03/19 13:22:08 | last = 86.394%
[37m[36mINFO[0m[0m 03/19 13:22:08 | last (inD) = 96.652%
[37m[36mINFO[0m[0m 03/19 13:22:08 | training-domain validation (iid, inD) = 97.048%
[37m[36mINFO[0m[0m 03/19 13:22:08 | === Summary ===
[37m[36mINFO[0m[0m 03/19 13:22:08 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 2 --hparams_seed 2
[37m[36mINFO[0m[0m 03/19 13:22:08 | Unique name: 250319_12-57-21_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 13:22:08 | Out path: train_output/PACS/ERM/[0]/250319_12-57-21_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 13:22:08 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 13:22:08 | Dataset: PACS

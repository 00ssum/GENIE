[37m[36mINFO[0m[0m 03/19 15:35:13 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 2 --hparams_seed 8
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 8
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250319_15-35-13_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 2
	unique_name: 250319_15-35-13_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 3.019123985218396e-05
	batch_size: 9
	weight_decay: 0.0020603523571546007
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/19 15:35:13 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 15:35:13 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 15:35:13 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 15:35:13 | 
[37m[36mINFO[0m[0m 03/19 15:35:13 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 15:35:13 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 15:35:13 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 15:35:13 | Batch sizes for each domain: [0, 9, 9, 9] (total=27)
[37m[36mINFO[0m[0m 03/19 15:35:13 | steps-per-epoch for each domain: 208.44, 148.44, 349.33 -> min = 148.44
[37m[36mINFO[0m[0m 03/19 15:35:14 | # of params = 23522375
[37m[36mINFO[0m[0m 03/19 15:35:46 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 15:35:46 | 0.187309    0.176039    0.159382    0.155164    2.078305    0.187309    0.176039    0.167377    0.160256    0.114521    0.107784    0.196247    0.197452    0           0.000000    1.965911    0.960500    30.996017  
[37m[36mINFO[0m[0m 03/19 15:36:43 | 0.762050    0.784841    0.907845    0.909135    0.253110    0.762050    0.784841    0.898721    0.899573    0.958084    0.973054    0.866730    0.854777    200         1.347305    0.546414    0.125087    31.898621  
[37m[36mINFO[0m[0m 03/19 15:37:47 | 0.640635    0.650367    0.915072    0.880452    0.331635    0.640635    0.650367    0.880064    0.837607    0.951347    0.931138    0.913804    0.872611    400         2.694611    0.230819    0.164289    31.833533  
[37m[36mINFO[0m[0m 03/19 15:38:45 | 0.812691    0.828851    0.967040    0.950603    0.127200    0.812691    0.828851    0.964286    0.950855    0.990269    0.985030    0.946565    0.915924    600         4.041916    0.135590    0.125579    32.258969  
[37m[36mINFO[0m[0m 03/19 15:39:41 | 0.798658    0.801956    0.955963    0.930235    0.204821    0.798658    0.801956    0.941365    0.891026    0.987275    0.985030    0.939249    0.914650    800         5.389222    0.143779    0.126392    30.677451  
[37m[36mINFO[0m[0m 03/19 15:40:43 | 0.834045    0.836186    0.935733    0.918461    0.209754    0.834045    0.836186    0.901386    0.888889    0.982784    0.976048    0.923028    0.890446    1000        6.736527    0.124637    0.152824    31.986704  
[37m[36mINFO[0m[0m 03/19 15:41:38 | 0.826724    0.841076    0.965928    0.949613    0.145070    0.826724    0.841076    0.953092    0.944444    0.991766    0.991018    0.952926    0.913376    1200        8.083832    0.115768    0.118340    31.102442  
[37m[36mINFO[0m[0m 03/19 15:42:38 | 0.865772    0.860636    0.980180    0.971472    0.093105    0.865772    0.860636    0.972814    0.970085    0.994760    0.994012    0.972964    0.950318    1400        9.431138    0.098648    0.143297    31.516678  
[37m[36mINFO[0m[0m 03/19 15:43:36 | 0.759610    0.765281    0.978650    0.953417    0.117798    0.759610    0.765281    0.981343    0.952991    0.985778    0.976048    0.968830    0.931210    1600        10.778443   0.076269    0.135175    30.403847  
[37m[36mINFO[0m[0m 03/19 15:44:30 | 0.821232    0.806846    0.983372    0.963081    0.112776    0.821232    0.806846    0.981343    0.961538    0.993263    0.985030    0.975509    0.942675    1800        12.125749   0.065895    0.115871    30.888168  
[37m[36mINFO[0m[0m 03/19 15:45:29 | 0.824893    0.831296    0.969777    0.946781    0.146971    0.824893    0.831296    0.973881    0.950855    0.989521    0.985030    0.945929    0.904459    2000        13.473054   0.052636    0.138857    31.001577  
[37m[36mINFO[0m[0m 03/19 15:46:29 | 0.864552    0.870416    0.986431    0.967511    0.100254    0.864552    0.870416    0.985075    0.967949    0.997754    0.997006    0.976463    0.937580    2200        14.820359   0.052554    0.144530    31.566509  
[37m[36mINFO[0m[0m 03/19 15:47:25 | 0.856010    0.867971    0.986740    0.966517    0.096207    0.856010    0.867971    0.981343    0.976496    0.997006    0.988024    0.981870    0.935032    2400        16.167665   0.046227    0.123080    31.071040  
[37m[36mINFO[0m[0m 03/19 15:48:28 | 0.860891    0.877751    0.982954    0.952882    0.122505    0.860891    0.877751    0.981343    0.967949    0.995509    0.976048    0.972010    0.914650    2600        17.514970   0.046148    0.154803    32.068556  
[37m[36mINFO[0m[0m 03/19 15:49:24 | 0.823063    0.828851    0.989894    0.966486    0.099035    0.823063    0.828851    0.992004    0.978632    0.993263    0.973054    0.984415    0.947771    2800        18.862275   0.034991    0.128484    30.476372  
[37m[36mINFO[0m[0m 03/19 15:50:18 | 0.860281    0.860636    0.991351    0.974033    0.085705    0.860281    0.860636    0.987207    0.976496    0.999251    0.994012    0.987595    0.951592    3000        20.209581   0.036571    0.115201    30.851415  
[37m[36mINFO[0m[0m 03/19 15:51:21 | 0.801708    0.814181    0.989018    0.956972    0.130778    0.801708    0.814181    0.990405    0.950855    0.997006    0.985030    0.979644    0.935032    3200        21.556886   0.031316    0.158315    31.408368  
[37m[36mINFO[0m[0m 03/19 15:52:19 | 0.831605    0.831296    0.975512    0.941492    0.162838    0.831605    0.831296    0.972281    0.946581    0.994012    0.967066    0.960242    0.910828    3400        22.904192   0.042387    0.131566    31.916141  
[37m[36mINFO[0m[0m 03/19 15:53:15 | 0.800488    0.819071    0.988657    0.965064    0.109228    0.800488    0.819071    0.986141    0.955128    0.997006    0.991018    0.982824    0.949045    3600        24.251497   0.040353    0.120434    31.505934  
[37m[36mINFO[0m[0m 03/19 15:54:22 | 0.826113    0.843521    0.986873    0.966668    0.109178    0.826113    0.843521    0.993603    0.980769    0.998503    0.988024    0.968511    0.931210    3800        25.598802   0.026955    0.179261    31.759615  
[37m[36mINFO[0m[0m 03/19 15:55:19 | 0.860281    0.863081    0.992704    0.966079    0.108618    0.860281    0.863081    0.993603    0.970085    0.998503    0.988024    0.986005    0.940127    4000        26.946108   0.038972    0.129170    30.967970  
[37m[36mINFO[0m[0m 03/19 15:56:15 | 0.827334    0.823961    0.991354    0.969488    0.095934    0.827334    0.823961    0.992004    0.972222    0.997006    0.991018    0.985051    0.945223    4200        28.293413   0.031366    0.123013    31.471148  
[37m[36mINFO[0m[0m 03/19 15:57:25 | 0.746187    0.743276    0.984831    0.946871    0.221765    0.746187    0.743276    0.981343    0.940171    0.997006    0.973054    0.976145    0.927389    4400        29.640719   0.021073    0.190248    31.500757  
[37m[36mINFO[0m[0m 03/19 15:58:22 | 0.821843    0.823961    0.996140    0.969188    0.083868    0.821843    0.823961    0.997868    0.967949    0.998503    0.988024    0.992048    0.951592    4600        30.988024   0.028966    0.127414    32.041789  
[37m[36mINFO[0m[0m 03/19 15:59:18 | 0.873703    0.887531    0.994013    0.968053    0.104277    0.873703    0.887531    0.995736    0.970085    0.997754    0.985030    0.988550    0.949045    4800        32.335329   0.033156    0.120406    31.229890  
[37m[36mINFO[0m[0m 03/19 16:00:26 | 0.800488    0.814181    0.979000    0.935936    0.201936    0.800488    0.814181    0.979211    0.940171    0.985778    0.958084    0.972010    0.909554    5000        33.682635   0.026014    0.183559    31.671943  
[37m[36mINFO[0m[0m 03/19 16:00:26 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250319_15-35-13_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 16:00:28 | ---
[37m[36mINFO[0m[0m 03/19 16:00:28 | test-domain validation(oracle) = 87.370%
[37m[36mINFO[0m[0m 03/19 16:00:28 | training-domain validation(iid) = 86.028%
[37m[36mINFO[0m[0m 03/19 16:00:28 | last = 80.049%
[37m[36mINFO[0m[0m 03/19 16:00:28 | last (inD) = 93.594%
[37m[36mINFO[0m[0m 03/19 16:00:28 | training-domain validation (iid, inD) = 97.403%
[37m[36mINFO[0m[0m 03/19 16:00:28 | === Summary ===
[37m[36mINFO[0m[0m 03/19 16:00:28 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 2 --hparams_seed 8
[37m[36mINFO[0m[0m 03/19 16:00:28 | Unique name: 250319_15-35-13_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 16:00:28 | Out path: train_output/PACS/ERM/[0]/250319_15-35-13_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 16:00:28 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 16:00:28 | Dataset: PACS

[37m[36mINFO[0m[0m 03/19 16:00:32 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 2 --hparams_seed 9
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 9
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250319_16-00-32_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 2
	unique_name: 250319_16-00-32_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.716671579524612e-05
	batch_size: 29
	weight_decay: 1.71368232883332e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/19 16:00:32 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 16:00:32 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 16:00:32 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 16:00:32 | 
[37m[36mINFO[0m[0m 03/19 16:00:32 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 16:00:32 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 16:00:32 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 16:00:32 | Batch sizes for each domain: [0, 29, 29, 29] (total=87)
[37m[36mINFO[0m[0m 03/19 16:00:32 | steps-per-epoch for each domain: 64.69, 46.07, 108.41 -> min = 46.07
[37m[36mINFO[0m[0m 03/19 16:00:33 | # of params = 23522375
[37m[36mINFO[0m[0m 03/19 16:01:08 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 16:01:08 | 0.209274    0.217604    0.192507    0.200339    1.879099    0.209274    0.217604    0.221748    0.232906    0.157934    0.170659    0.197837    0.197452    0           0.000000    1.997630    1.105748    33.712082  
[37m[36mINFO[0m[0m 03/19 16:02:24 | 0.815741    0.821516    0.952246    0.949037    0.144547    0.815741    0.821516    0.938166    0.940171    0.987275    0.991018    0.931298    0.915924    200         4.341317    0.332188    0.213992    33.195828  
[37m[36mINFO[0m[0m 03/19 16:03:49 | 0.862111    0.860636    0.972139    0.949188    0.140964    0.862111    0.860636    0.960554    0.944444    0.996257    0.991018    0.959606    0.912102    400         8.682635    0.104204    0.260642    32.788001  
[37m[36mINFO[0m[0m 03/19 16:05:04 | 0.809640    0.809291    0.980258    0.952572    0.136608    0.809640    0.809291    0.974414    0.938034    0.996257    0.991018    0.970102    0.928662    600         13.023952   0.071815    0.213138    32.512192  
[37m[36mINFO[0m[0m 03/19 16:06:32 | 0.848688    0.858191    0.968064    0.946470    0.193703    0.848688    0.858191    0.955757    0.944444    0.995509    0.979042    0.952926    0.915924    800         17.365269   0.036210    0.282758    31.874646  
[37m[36mINFO[0m[0m 03/19 16:07:47 | 0.864552    0.877751    0.988672    0.962521    0.121374    0.864552    0.877751    0.994136    0.967949    0.997006    0.982036    0.974873    0.937580    1000        21.706587   0.042232    0.209917    33.137621  
[37m[36mINFO[0m[0m 03/19 16:09:22 | 0.867602    0.845966    0.991812    0.971761    0.108770    0.867602    0.845966    0.992537    0.976496    0.996257    0.991018    0.986641    0.947771    1200        26.047904   0.024341    0.314469    31.534341  
[37m[36mINFO[0m[0m 03/19 16:10:37 | 0.871873    0.867971    0.994650    0.966801    0.122614    0.871873    0.867971    0.994670    0.970085    0.998503    0.994012    0.990776    0.936306    1400        30.389222   0.015349    0.211822    32.436578  
[37m[36mINFO[0m[0m 03/19 16:12:10 | 0.876754    0.885086    0.996598    0.966641    0.106263    0.876754    0.885086    0.995203    0.967949    1.000000    0.988024    0.994593    0.943949    1600        34.730539   0.021233    0.291819    34.806243  
[37m[36mINFO[0m[0m 03/19 16:13:25 | 0.856620    0.850856    0.998690    0.971059    0.120511    0.856620    0.850856    0.998934    0.972222    1.000000    0.997006    0.997137    0.943949    1800        39.071856   0.011846    0.215184    32.000802  
[37m[36mINFO[0m[0m 03/19 16:14:50 | 0.878585    0.889976    0.996561    0.966077    0.107050    0.878585    0.889976    0.997335    0.965812    0.997754    0.991018    0.994593    0.941401    2000        43.413174   0.014170    0.261106    32.819575  
[37m[36mINFO[0m[0m 03/19 16:16:06 | 0.891397    0.880196    0.998796    0.972895    0.098474    0.891397    0.880196    0.998934    0.970085    1.000000    0.997006    0.997455    0.951592    2200        47.754491   0.012423    0.227407    31.050282  
[37m[36mINFO[0m[0m 03/19 16:17:23 | 0.887736    0.875306    0.996312    0.968351    0.108159    0.887736    0.875306    0.995203    0.970085    0.998503    0.991018    0.995229    0.943949    2400        52.095808   0.008622    0.221236    31.981128  
[37m[36mINFO[0m[0m 03/19 16:18:46 | 0.865772    0.870416    0.995959    0.967629    0.127009    0.865772    0.870416    0.996802    0.970085    0.997754    0.985030    0.993321    0.947771    2600        56.437126   0.009230    0.253944    32.291321  
[37m[36mINFO[0m[0m 03/19 16:19:59 | 0.857840    0.858191    0.996845    0.969636    0.109650    0.857840    0.858191    0.996802    0.972222    0.998503    0.994012    0.995229    0.942675    2800        60.778443   0.010432    0.212888    30.818402  
[37m[36mINFO[0m[0m 03/19 16:21:29 | 0.895058    0.897311    0.996739    0.962954    0.118178    0.895058    0.897311    0.996802    0.961538    0.998503    0.991018    0.994911    0.936306    3000        65.119760   0.010070    0.288207    32.316031  
[37m[36mINFO[0m[0m 03/19 16:22:41 | 0.860891    0.877751    0.998295    0.972908    0.106128    0.860891    0.877751    0.997335    0.976496    0.998503    0.997006    0.999046    0.945223    3200        69.461078   0.007918    0.207929    30.341265  
[37m[36mINFO[0m[0m 03/19 16:24:14 | 0.862111    0.872861    0.999077    0.971047    0.118168    0.862111    0.872861    0.998934    0.970085    0.999251    0.994012    0.999046    0.949045    3400        73.802395   0.006578    0.315711    30.395990  
[37m[36mINFO[0m[0m 03/19 16:25:29 | 0.854790    0.855746    0.995750    0.963668    0.132070    0.854790    0.855746    0.997335    0.967949    0.998503    0.988024    0.991412    0.935032    3600        78.143713   0.008151    0.212959    32.182912  
[37m[36mINFO[0m[0m 03/19 16:26:56 | 0.869433    0.892421    0.999292    0.969762    0.122637    0.869433    0.892421    0.999467    0.967949    1.000000    0.991018    0.998410    0.950318    3800        82.485030   0.006410    0.276838    31.656219  
[37m[36mINFO[0m[0m 03/19 16:28:12 | 0.863941    0.872861    0.999610    0.963255    0.164804    0.863941    0.872861    0.999467    0.970085    1.000000    0.991018    0.999364    0.928662    4000        86.826347   0.004097    0.221739    30.961121  
[37m[36mINFO[0m[0m 03/19 16:29:31 | 0.835265    0.843521    0.998616    0.966778    0.152517    0.835265    0.843521    0.997868    0.965812    0.999251    0.988024    0.998728    0.946497    4200        91.167665   0.004735    0.227473    33.736291  
[37m[36mINFO[0m[0m 03/19 16:30:53 | 0.871873    0.848411    0.993862    0.957397    0.194822    0.871873    0.848411    0.986674    0.950855    1.000000    0.985030    0.994911    0.936306    4400        95.508982   0.005572    0.247464    32.595590  
[37m[36mINFO[0m[0m 03/19 16:32:07 | 0.871873    0.872861    0.999788    0.969762    0.116708    0.871873    0.872861    1.000000    0.967949    1.000000    0.991018    0.999364    0.950318    4600        99.850299   0.006826    0.212667    31.434004  
[37m[36mINFO[0m[0m 03/19 16:33:35 | 0.857230    0.870416    0.997699    0.963107    0.204119    0.857230    0.870416    0.998934    0.970085    0.999251    0.988024    0.994911    0.931210    4800        104.191617  0.003502    0.284731    31.593736  
[37m[36mINFO[0m[0m 03/19 16:34:52 | 0.884076    0.887531    0.999788    0.970762    0.109577    0.884076    0.887531    1.000000    0.972222    1.000000    0.991018    0.999364    0.949045    5000        108.532934  0.004034    0.208600    34.623330  
[37m[36mINFO[0m[0m 03/19 16:34:52 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250319_16-00-32_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 16:34:53 | ---
[37m[36mINFO[0m[0m 03/19 16:34:53 | test-domain validation(oracle) = 89.506%
[37m[36mINFO[0m[0m 03/19 16:34:53 | training-domain validation(iid) = 86.089%
[37m[36mINFO[0m[0m 03/19 16:34:53 | last = 88.408%
[37m[36mINFO[0m[0m 03/19 16:34:53 | last (inD) = 97.076%
[37m[36mINFO[0m[0m 03/19 16:34:53 | training-domain validation (iid, inD) = 97.291%
[37m[36mINFO[0m[0m 03/19 16:34:53 | === Summary ===
[37m[36mINFO[0m[0m 03/19 16:34:53 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 2 --hparams_seed 9
[37m[36mINFO[0m[0m 03/19 16:34:53 | Unique name: 250319_16-00-32_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 16:34:53 | Out path: train_output/PACS/ERM/[0]/250319_16-00-32_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 16:34:53 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 16:34:53 | Dataset: PACS

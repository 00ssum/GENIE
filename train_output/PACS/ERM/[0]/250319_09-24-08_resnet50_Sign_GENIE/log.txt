[37m[36mINFO[0m[0m 03/19 09:24:08 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 1 --hparams_seed 15
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 15
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250319_09-24-08_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 1
	unique_name: 250319_09-24-08_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 1.7812453400894684e-05
	batch_size: 36
	weight_decay: 3.1651536009272826e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/19 09:24:08 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 09:24:08 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 09:24:08 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 09:24:08 | 
[37m[36mINFO[0m[0m 03/19 09:24:08 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 09:24:08 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 09:24:08 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 09:24:08 | Batch sizes for each domain: [0, 36, 36, 36] (total=108)
[37m[36mINFO[0m[0m 03/19 09:24:08 | steps-per-epoch for each domain: 52.11, 37.11, 87.33 -> min = 37.11
[37m[36mINFO[0m[0m 03/19 09:24:09 | # of params = 23522375
[37m[36mINFO[0m[0m 03/19 09:24:42 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 09:24:42 | 0.148871    0.185819    0.189303    0.186260    1.892412    0.148871    0.185819    0.194563    0.228632    0.192365    0.146707    0.180980    0.183439    0           0.000000    2.007716    1.492715    30.828033  
[37m[36mINFO[0m[0m 03/19 09:26:03 | 0.814521    0.833741    0.954927    0.958831    0.131382    0.814521    0.833741    0.949893    0.952991    0.990269    0.991018    0.924618    0.932484    200         5.389222    0.347984    0.249548    31.121981  
[37m[36mINFO[0m[0m 03/19 09:27:26 | 0.773032    0.775061    0.957206    0.944055    0.166483    0.773032    0.775061    0.952559    0.933761    0.982036    0.985030    0.937023    0.913376    400         10.778443   0.104826    0.252414    32.606516  
[37m[36mINFO[0m[0m 03/19 09:28:45 | 0.852959    0.863081    0.987600    0.976141    0.077535    0.852959    0.863081    0.988806    0.965812    0.996257    0.997006    0.977735    0.965605    600         16.167665   0.065325    0.243446    30.098984  
[37m[36mINFO[0m[0m 03/19 09:30:17 | 0.853569    0.853301    0.992389    0.971431    0.105390    0.853569    0.853301    0.995203    0.950855    0.998503    0.994012    0.983461    0.969427    800         21.556886   0.031257    0.310504    30.363264  
[37m[36mINFO[0m[0m 03/19 09:31:36 | 0.851129    0.865526    0.994331    0.979415    0.080267    0.851129    0.865526    0.994670    0.974359    0.998503    0.997006    0.989822    0.966879    1000        26.946108   0.021806    0.242576    30.346161  
[37m[36mINFO[0m[0m 03/19 09:33:11 | 0.823673    0.826406    0.995466    0.970024    0.090442    0.823673    0.826406    0.996802    0.961538    0.998503    0.988024    0.991094    0.960510    1200        32.335329   0.023938    0.319327    30.819776  
[37m[36mINFO[0m[0m 03/19 09:34:30 | 0.870653    0.872861    0.996240    0.971585    0.113645    0.870653    0.872861    0.995736    0.963675    0.997754    0.988024    0.995229    0.963057    1400        37.724551   0.011725    0.242670    30.371321  
[37m[36mINFO[0m[0m 03/19 09:36:07 | 0.854179    0.865526    0.996418    0.965737    0.137140    0.854179    0.865526    0.993070    0.942308    1.000000    0.988024    0.996183    0.966879    1600        43.113772   0.009880    0.330783    30.815428  
[37m[36mINFO[0m[0m 03/19 09:37:25 | 0.883466    0.865526    0.995681    0.970721    0.116642    0.883466    0.865526    0.997335    0.952991    0.999251    0.991018    0.990458    0.968153    1800        48.502994   0.010193    0.240104    30.586272  
[37m[36mINFO[0m[0m 03/19 09:39:04 | 0.855400    0.841076    0.997559    0.971584    0.119553    0.855400    0.841076    0.998401    0.959402    1.000000    0.991018    0.994275    0.964331    2000        53.892216   0.013968    0.343077    30.204966  
[37m[36mINFO[0m[0m 03/19 09:40:24 | 0.846858    0.853301    0.996065    0.978270    0.086174    0.846858    0.853301    0.996802    0.978632    0.997754    0.988024    0.993639    0.968153    2200        59.281437   0.008134    0.244815    31.048704  
[37m[36mINFO[0m[0m 03/19 09:42:02 | 0.816351    0.841076    0.994718    0.974720    0.099837    0.816351    0.841076    0.993603    0.970085    0.998503    0.991018    0.992048    0.963057    2400        64.670659   0.012856    0.339537    29.811834  
[37m[36mINFO[0m[0m 03/19 09:43:22 | 0.868212    0.850856    0.998759    0.975268    0.095728    0.868212    0.850856    0.997868    0.961538    1.000000    0.991018    0.998410    0.973248    2600        70.059880   0.006006    0.247696    30.424498  
[37m[36mINFO[0m[0m 03/19 09:44:57 | 0.840146    0.845966    0.997231    0.971141    0.122825    0.840146    0.845966    0.997868    0.967949    0.997006    0.976048    0.996819    0.969427    2800        75.449102   0.006154    0.325980    30.309766  
[37m[36mINFO[0m[0m 03/19 09:46:17 | 0.848688    0.863081    0.997487    0.975145    0.108415    0.848688    0.863081    0.997868    0.970085    1.000000    0.991018    0.994593    0.964331    3000        80.838323   0.007771    0.247775    30.148857  
[37m[36mINFO[0m[0m 03/19 09:47:49 | 0.860891    0.863081    0.996776    0.966038    0.129690    0.860891    0.863081    0.996802    0.950855    0.999251    0.988024    0.994275    0.959236    3200        86.227545   0.007682    0.307690    30.590107  
[37m[36mINFO[0m[0m 03/19 09:49:10 | 0.875534    0.885086    0.999538    0.974849    0.096821    0.875534    0.885086    1.000000    0.974359    0.999251    0.982036    0.999364    0.968153    3400        91.616766   0.004180    0.251836    30.530324  
[37m[36mINFO[0m[0m 03/19 09:50:42 | 0.862721    0.865526    0.998263    0.974149    0.123357    0.862721    0.865526    0.999467    0.974359    0.998503    0.985030    0.996819    0.963057    3600        97.005988   0.005227    0.301558    31.662153  
[37m[36mINFO[0m[0m 03/19 09:52:04 | 0.860281    0.867971    0.998584    0.975272    0.119982    0.860281    0.867971    0.998934    0.970085    1.000000    0.985030    0.996819    0.970701    3800        102.395210  0.003840    0.253060    31.655704  
[37m[36mINFO[0m[0m 03/19 09:53:34 | 0.859060    0.867971    0.998759    0.975145    0.106502    0.859060    0.867971    0.998934    0.970085    0.999251    0.991018    0.998092    0.964331    4000        107.784431  0.007940    0.297547    30.488129  
[37m[36mINFO[0m[0m 03/19 09:54:55 | 0.866382    0.860636    0.999504    0.976820    0.104685    0.866382    0.860636    0.999467    0.965812    1.000000    0.985030    0.999046    0.979618    4200        113.173653  0.002368    0.253205    30.022301  
[37m[36mINFO[0m[0m 03/19 09:56:22 | 0.849908    0.855746    0.998475    0.980964    0.091215    0.849908    0.855746    0.997335    0.974359    1.000000    0.994012    0.998092    0.974522    4400        118.562874  0.004893    0.284035    30.047394  
[37m[36mINFO[0m[0m 03/19 09:57:44 | 0.852349    0.877751    0.998229    0.983526    0.080230    0.852349    0.877751    0.997868    0.980769    1.000000    0.994012    0.996819    0.975796    4600        123.952096  0.004240    0.258884    30.152762  
[37m[36mINFO[0m[0m 03/19 09:59:11 | 0.870043    0.877751    0.999080    0.980115    0.092158    0.870043    0.877751    0.999467    0.974359    1.000000    0.994012    0.997774    0.971975    4800        129.341317  0.002597    0.274525    31.908686  
[37m[36mINFO[0m[0m 03/19 10:00:35 | 0.845638    0.853301    0.995040    0.968748    0.149751    0.845638    0.853301    0.993070    0.957265    1.000000    0.991018    0.992048    0.957962    5000        134.730539  0.004262    0.269721    30.160681  
[37m[36mINFO[0m[0m 03/19 10:00:35 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250319_09-24-08_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 10:00:36 | ---
[37m[36mINFO[0m[0m 03/19 10:00:36 | test-domain validation(oracle) = 87.553%
[37m[36mINFO[0m[0m 03/19 10:00:36 | training-domain validation(iid) = 85.235%
[37m[36mINFO[0m[0m 03/19 10:00:36 | last = 84.564%
[37m[36mINFO[0m[0m 03/19 10:00:36 | last (inD) = 96.875%
[37m[36mINFO[0m[0m 03/19 10:00:36 | training-domain validation (iid, inD) = 98.353%
[37m[36mINFO[0m[0m 03/19 10:00:36 | === Summary ===
[37m[36mINFO[0m[0m 03/19 10:00:36 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 1 --hparams_seed 15
[37m[36mINFO[0m[0m 03/19 10:00:36 | Unique name: 250319_09-24-08_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 10:00:36 | Out path: train_output/PACS/ERM/[0]/250319_09-24-08_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 10:00:36 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 10:00:36 | Dataset: PACS

[37m[36mINFO[0m[0m 03/19 04:23:02 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 1 --hparams_seed 5
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 5
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250319_04-23-02_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 1
	unique_name: 250319_04-23-02_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.0002591339485391279
	batch_size: 10
	weight_decay: 0.00020150290684242954
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/19 04:23:02 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 04:23:02 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 04:23:02 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 04:23:02 | 
[37m[36mINFO[0m[0m 03/19 04:23:02 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 04:23:02 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 04:23:02 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 04:23:02 | Batch sizes for each domain: [0, 10, 10, 10] (total=30)
[37m[36mINFO[0m[0m 03/19 04:23:02 | steps-per-epoch for each domain: 187.60, 133.60, 314.40 -> min = 133.60
[37m[36mINFO[0m[0m 03/19 04:23:03 | # of params = 23522375
[37m[36mINFO[0m[0m 03/19 04:23:34 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 04:23:34 | 0.149481    0.173594    0.188868    0.192483    1.967746    0.149481    0.173594    0.190299    0.228632    0.216317    0.203593    0.159987    0.145223    0           0.000000    2.012071    1.003744    30.433341  
[37m[36mINFO[0m[0m 03/19 04:24:32 | 0.777913    0.799511    0.908647    0.909127    0.245844    0.777913    0.799511    0.896055    0.882479    0.968563    0.985030    0.861323    0.859873    200         1.497006    0.496864    0.127366    31.993582  
[37m[36mINFO[0m[0m 03/19 04:25:27 | 0.805979    0.823961    0.926088    0.934440    0.202741    0.805979    0.823961    0.925906    0.938034    0.967814    0.985030    0.884542    0.880255    400         2.994012    0.235578    0.128653    29.732862  
[37m[36mINFO[0m[0m 03/19 04:26:39 | 0.766321    0.750611    0.954055    0.946171    0.179153    0.766321    0.750611    0.963220    0.940171    0.973054    0.976048    0.925891    0.922293    600         4.491018    0.180580    0.203860    31.374757  
[37m[36mINFO[0m[0m 03/19 04:27:37 | 0.804149    0.804401    0.956632    0.957233    0.154923    0.804149    0.804401    0.949360    0.940171    0.981287    0.985030    0.939249    0.946497    800         5.988024    0.123237    0.130744    31.009619  
[37m[36mINFO[0m[0m 03/19 04:28:31 | 0.835876    0.838631    0.973603    0.955240    0.150295    0.835876    0.838631    0.972281    0.948718    0.994012    0.973054    0.954517    0.943949    1000        7.485030    0.101143    0.117983    30.437476  
[37m[36mINFO[0m[0m 03/19 04:29:39 | 0.823673    0.833741    0.962132    0.940940    0.188455    0.823673    0.833741    0.966418    0.923077    0.990269    0.994012    0.929707    0.905732    1200        8.982036    0.099758    0.191073    30.105444  
[37m[36mINFO[0m[0m 03/19 04:30:37 | 0.792556    0.797066    0.970676    0.960657    0.123284    0.792556    0.797066    0.962154    0.952991    0.990269    0.985030    0.959606    0.943949    1400        10.479042   0.073410    0.132326    31.427738  
[37m[36mINFO[0m[0m 03/19 04:31:32 | 0.791946    0.770171    0.974920    0.958510    0.128603    0.791946    0.770171    0.982409    0.948718    0.978293    0.979042    0.964059    0.947771    1600        11.976048   0.057751    0.125074    30.625985  
[37m[36mINFO[0m[0m 03/19 04:32:42 | 0.855400    0.853301    0.979009    0.968329    0.097951    0.855400    0.853301    0.982942    0.970085    0.986527    0.982036    0.967557    0.952866    1800        13.473054   0.067503    0.200918    29.844769  
[37m[36mINFO[0m[0m 03/19 04:33:42 | 0.835876    0.836186    0.991179    0.970012    0.091985    0.835876    0.836186    0.990938    0.959402    0.998503    0.985030    0.984097    0.965605    2000        14.970060   0.053114    0.129603    33.281592  
[37m[36mINFO[0m[0m 03/19 04:34:36 | 0.798048    0.823961    0.983297    0.955374    0.139327    0.798048    0.823961    0.983475    0.938034    0.990269    0.979042    0.976145    0.949045    2200        16.467066   0.066835    0.118112    31.033701  
[37m[36mINFO[0m[0m 03/19 04:35:46 | 0.783405    0.794621    0.976079    0.953286    0.155881    0.783405    0.794621    0.975480    0.944444    0.992515    0.988024    0.960242    0.927389    2400        17.964072   0.050891    0.194803    31.102346  
[37m[36mINFO[0m[0m 03/19 04:36:44 | 0.841367    0.841076    0.992492    0.980966    0.064674    0.841367    0.841076    0.992537    0.978632    0.999251    0.991018    0.985687    0.973248    2600        19.461078   0.045214    0.130267    31.523247  
[37m[36mINFO[0m[0m 03/19 04:37:38 | 0.868212    0.880196    0.991962    0.975431    0.081101    0.868212    0.880196    0.993603    0.967949    0.998503    0.994012    0.983779    0.964331    2800        20.958084   0.035501    0.119924    30.478845  
[37m[36mINFO[0m[0m 03/19 04:38:52 | 0.844417    0.843521    0.990923    0.969576    0.112093    0.844417    0.843521    0.993070    0.957265    0.994012    0.982036    0.985687    0.969427    3000        22.455090   0.035848    0.211843    31.413247  
[37m[36mINFO[0m[0m 03/19 04:39:51 | 0.855400    0.860636    0.993455    0.966339    0.112115    0.855400    0.860636    0.996269    0.959402    1.000000    0.988024    0.984097    0.951592    3200        23.952096   0.033882    0.133180    32.369944  
[37m[36mINFO[0m[0m 03/19 04:40:47 | 0.823063    0.816626    0.990540    0.971997    0.097778    0.823063    0.816626    0.993603    0.957265    0.995509    0.988024    0.982506    0.970701    3400        25.449102   0.021823    0.117481    32.016169  
[37m[36mINFO[0m[0m 03/19 04:41:54 | 0.857840    0.845966    0.989545    0.963766    0.111471    0.857840    0.845966    0.989872    0.950855    0.996257    0.985030    0.982506    0.955414    3600        26.946108   0.033785    0.186562    30.371258  
[37m[36mINFO[0m[0m 03/19 04:42:56 | 0.848078    0.836186    0.993589    0.972020    0.102730    0.848078    0.836186    0.994670    0.961538    0.998503    0.994012    0.987595    0.960510    3800        28.443114   0.026272    0.147337    32.024121  
[37m[36mINFO[0m[0m 03/19 04:43:51 | 0.823063    0.831296    0.993297    0.972995    0.103658    0.823063    0.831296    0.988273    0.957265    0.999251    0.991018    0.992366    0.970701    4000        29.940120   0.019873    0.124972    30.340479  
[37m[36mINFO[0m[0m 03/19 04:44:57 | 0.794997    0.787286    0.982670    0.956675    0.135360    0.794997    0.787286    0.985075    0.950855    0.992515    0.979042    0.970420    0.940127    4200        31.437126   0.041819    0.178612    30.248852  
[37m[36mINFO[0m[0m 03/19 04:45:55 | 0.865772    0.855746    0.989710    0.967879    0.116531    0.865772    0.855746    0.992537    0.961538    0.990269    0.979042    0.986323    0.963057    4400        32.934132   0.022121    0.139786    29.759283  
[37m[36mINFO[0m[0m 03/19 04:46:48 | 0.809030    0.782396    0.979081    0.953099    0.157424    0.809030    0.782396    0.979211    0.957265    0.976796    0.958084    0.981234    0.943949    4600        34.431138   0.024682    0.118358    29.769920  
[37m[36mINFO[0m[0m 03/19 04:47:50 | 0.788286    0.797066    0.991102    0.968725    0.106823    0.788286    0.797066    0.988273    0.952991    0.997754    0.985030    0.987277    0.968153    4800        35.928144   0.034083    0.155826    30.645449  
[37m[36mINFO[0m[0m 03/19 04:48:55 | 0.856620    0.850856    0.994902    0.974734    0.091912    0.856620    0.850856    0.995203    0.976496    1.000000    0.991018    0.989504    0.956688    5000        37.425150   0.014465    0.169472    31.020415  
[37m[36mINFO[0m[0m 03/19 04:48:55 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250319_04-23-02_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 04:48:57 | ---
[37m[36mINFO[0m[0m 03/19 04:48:57 | test-domain validation(oracle) = 86.821%
[37m[36mINFO[0m[0m 03/19 04:48:57 | training-domain validation(iid) = 84.137%
[37m[36mINFO[0m[0m 03/19 04:48:57 | last = 85.662%
[37m[36mINFO[0m[0m 03/19 04:48:57 | last (inD) = 97.473%
[37m[36mINFO[0m[0m 03/19 04:48:57 | training-domain validation (iid, inD) = 98.097%
[37m[36mINFO[0m[0m 03/19 04:48:57 | === Summary ===
[37m[36mINFO[0m[0m 03/19 04:48:57 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 1 --hparams_seed 5
[37m[36mINFO[0m[0m 03/19 04:48:57 | Unique name: 250319_04-23-02_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 04:48:57 | Out path: train_output/PACS/ERM/[0]/250319_04-23-02_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 04:48:57 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 04:48:57 | Dataset: PACS

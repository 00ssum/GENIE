[37m[36mINFO[0m[0m 03/19 14:41:46 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 2 --hparams_seed 6
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 6
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250319_14-41-46_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 2
	unique_name: 250319_14-41-46_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00020671063342821416
	batch_size: 9
	weight_decay: 0.00021810605040355685
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/19 14:41:46 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 14:41:46 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 14:41:46 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 14:41:46 | 
[37m[36mINFO[0m[0m 03/19 14:41:46 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 14:41:46 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 14:41:46 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 14:41:46 | Batch sizes for each domain: [0, 9, 9, 9] (total=27)
[37m[36mINFO[0m[0m 03/19 14:41:46 | steps-per-epoch for each domain: 208.44, 148.44, 349.33 -> min = 148.44
[37m[36mINFO[0m[0m 03/19 14:41:48 | # of params = 23522375
[37m[36mINFO[0m[0m 03/19 14:42:21 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 14:42:21 | 0.187309    0.176039    0.159382    0.155164    2.087393    0.187309    0.176039    0.167377    0.160256    0.114521    0.107784    0.196247    0.197452    0           0.000000    1.958318    1.262359    31.989300  
[37m[36mINFO[0m[0m 03/19 14:43:17 | 0.793167    0.823961    0.908725    0.915214    0.236632    0.793167    0.823961    0.891258    0.916667    0.961826    0.955090    0.873092    0.873885    200         1.347305    0.566875    0.125779    30.644440  
[37m[36mINFO[0m[0m 03/19 14:44:15 | 0.779744    0.787286    0.930338    0.926601    0.210213    0.779744    0.787286    0.922175    0.905983    0.973802    0.991018    0.895038    0.882803    400         2.694611    0.242161    0.132582    31.604264  
[37m[36mINFO[0m[0m 03/19 14:45:17 | 0.798048    0.833741    0.961253    0.949182    0.142407    0.798048    0.833741    0.955757    0.955128    0.986527    0.979042    0.941476    0.913376    600         4.041916    0.147574    0.149226    32.694076  
[37m[36mINFO[0m[0m 03/19 14:46:15 | 0.841367    0.826406    0.957971    0.940639    0.160379    0.841367    0.826406    0.942431    0.938034    0.984281    0.973054    0.947201    0.910828    800         5.389222    0.160091    0.118698    33.867045  
[37m[36mINFO[0m[0m 03/19 14:47:19 | 0.835265    0.843521    0.965232    0.949732    0.138651    0.835265    0.843521    0.954691    0.950855    0.982036    0.976048    0.958969    0.922293    1000        6.736527    0.123214    0.158951    32.636698  
[37m[36mINFO[0m[0m 03/19 14:48:17 | 0.817572    0.826406    0.978021    0.964678    0.113231    0.817572    0.826406    0.977079    0.970085    0.991018    0.994012    0.965967    0.929936    1200        8.083832    0.097756    0.130392    31.730489  
[37m[36mINFO[0m[0m 03/19 14:49:12 | 0.843807    0.838631    0.975987    0.955571    0.113389    0.843807    0.838631    0.979211    0.950855    0.982784    0.991018    0.965967    0.924841    1400        9.431138    0.091515    0.119667    31.056099  
[37m[36mINFO[0m[0m 03/19 14:50:16 | 0.816962    0.836186    0.980934    0.959958    0.101481    0.816962    0.836186    0.979211    0.957265    0.994760    0.985030    0.968830    0.937580    1600        10.778443   0.077727    0.162300    31.017309  
[37m[36mINFO[0m[0m 03/19 14:51:11 | 0.865772    0.843521    0.971511    0.953000    0.149025    0.865772    0.843521    0.967484    0.946581    0.982036    0.985030    0.965013    0.927389    1800        12.125749   0.072007    0.120047    31.354034  
[37m[36mINFO[0m[0m 03/19 14:52:07 | 0.806589    0.804401    0.981073    0.958989    0.132293    0.806589    0.804401    0.984009    0.974359    0.991018    0.979042    0.968193    0.923567    2000        13.473054   0.061926    0.121153    31.635456  
[37m[36mINFO[0m[0m 03/19 14:53:03 | 0.816351    0.814181    0.986605    0.955131    0.148731    0.816351    0.814181    0.987207    0.963675    0.995509    0.973054    0.977099    0.928662    2200        14.820359   0.061809    0.130098    30.512573  
[37m[36mINFO[0m[0m 03/19 14:54:01 | 0.852959    0.828851    0.987095    0.967952    0.115714    0.852959    0.828851    0.985608    0.978632    0.994760    0.994012    0.980916    0.931210    2400        16.167665   0.040074    0.117224    33.990343  
[37m[36mINFO[0m[0m 03/19 14:55:06 | 0.799878    0.806846    0.982218    0.954432    0.177999    0.799878    0.806846    0.986674    0.967949    0.994012    0.973054    0.965967    0.922293    2600        17.514970   0.037998    0.165515    31.847784  
[37m[36mINFO[0m[0m 03/19 14:56:04 | 0.818792    0.821516    0.990076    0.958404    0.148219    0.818792    0.821516    0.988806    0.972222    0.997006    0.973054    0.984415    0.929936    2800        18.862275   0.028649    0.139450    30.686131  
[37m[36mINFO[0m[0m 03/19 14:57:00 | 0.762050    0.784841    0.974543    0.954696    0.170580    0.762050    0.784841    0.984009    0.965812    0.981287    0.967066    0.958333    0.931210    3000        20.209581   0.045585    0.125282    30.648434  
[37m[36mINFO[0m[0m 03/19 14:58:02 | 0.826724    0.843521    0.983924    0.955853    0.147344    0.826724    0.843521    0.980810    0.963675    0.988772    0.979042    0.982188    0.924841    3200        21.556886   0.046201    0.151484    31.809796  
[37m[36mINFO[0m[0m 03/19 14:58:59 | 0.787065    0.787286    0.992595    0.968202    0.098314    0.787065    0.787286    0.992004    0.970085    0.998503    0.988024    0.987277    0.946497    3400        22.904192   0.038313    0.119877    33.008010  
[37m[36mINFO[0m[0m 03/19 14:59:58 | 0.790116    0.801956    0.991208    0.963664    0.141460    0.790116    0.801956    0.988273    0.959402    0.997754    0.994012    0.987595    0.937580    3600        24.251497   0.027566    0.138767    30.751966  
[37m[36mINFO[0m[0m 03/19 15:00:55 | 0.851129    0.858191    0.994475    0.966355    0.114927    0.851129    0.858191    0.993603    0.970085    1.000000    0.985030    0.989822    0.943949    3800        25.598802   0.035395    0.131040    31.264662  
[37m[36mINFO[0m[0m 03/19 15:01:52 | 0.806589    0.814181    0.993555    0.963382    0.107716    0.806589    0.814181    0.996269    0.970085    0.997754    0.985030    0.986641    0.935032    4000        26.946108   0.020886    0.126231    31.783149  
[37m[36mINFO[0m[0m 03/19 15:03:00 | 0.862721    0.850856    0.992766    0.956980    0.139698    0.862721    0.850856    0.992537    0.967949    0.996257    0.973054    0.989504    0.929936    4200        28.293413   0.029164    0.182659    31.407197  
[37m[36mINFO[0m[0m 03/19 15:03:56 | 0.875534    0.867971    0.993664    0.963222    0.108507    0.875534    0.867971    0.994670    0.967949    1.000000    0.979042    0.986323    0.942675    4400        29.640719   0.021135    0.126686    30.956201  
[37m[36mINFO[0m[0m 03/19 15:04:56 | 0.826113    0.841076    0.993904    0.972609    0.089448    0.826113    0.841076    0.993070    0.972222    0.998503    0.994012    0.990140    0.951592    4600        30.988024   0.024668    0.133054    33.127449  
[37m[36mINFO[0m[0m 03/19 15:05:55 | 0.785235    0.787286    0.989171    0.962228    0.143090    0.785235    0.787286    0.987740    0.976496    0.990269    0.970060    0.989504    0.940127    4800        32.335329   0.032730    0.133821    32.251362  
[37m[36mINFO[0m[0m 03/19 15:06:51 | 0.828554    0.823961    0.992589    0.967639    0.113898    0.828554    0.823961    0.992004    0.967949    0.996257    0.991018    0.989504    0.943949    5000        33.682635   0.022267    0.122117    31.751318  
[37m[36mINFO[0m[0m 03/19 15:06:51 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250319_14-41-46_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 15:06:53 | ---
[37m[36mINFO[0m[0m 03/19 15:06:53 | test-domain validation(oracle) = 87.553%
[37m[36mINFO[0m[0m 03/19 15:06:53 | training-domain validation(iid) = 82.611%
[37m[36mINFO[0m[0m 03/19 15:06:53 | last = 82.855%
[37m[36mINFO[0m[0m 03/19 15:06:53 | last (inD) = 96.764%
[37m[36mINFO[0m[0m 03/19 15:06:53 | training-domain validation (iid, inD) = 97.261%
[37m[36mINFO[0m[0m 03/19 15:06:53 | === Summary ===
[37m[36mINFO[0m[0m 03/19 15:06:53 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 2 --hparams_seed 6
[37m[36mINFO[0m[0m 03/19 15:06:53 | Unique name: 250319_14-41-46_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 15:06:53 | Out path: train_output/PACS/ERM/[0]/250319_14-41-46_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 15:06:53 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 15:06:53 | Dataset: PACS

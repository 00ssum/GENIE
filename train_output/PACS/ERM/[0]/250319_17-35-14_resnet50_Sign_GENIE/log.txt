[37m[36mINFO[0m[0m 03/19 17:35:14 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 2 --hparams_seed 12
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 12
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250319_17-35-14_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 2
	unique_name: 250319_17-35-14_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5.346798771850428e-05
	batch_size: 44
	weight_decay: 1.8352299015720086e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/19 17:35:14 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 17:35:14 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 17:35:14 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 17:35:14 | 
[37m[36mINFO[0m[0m 03/19 17:35:14 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 17:35:14 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 17:35:14 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 17:35:14 | Batch sizes for each domain: [0, 44, 44, 44] (total=132)
[37m[36mINFO[0m[0m 03/19 17:35:14 | steps-per-epoch for each domain: 42.64, 30.36, 71.45 -> min = 30.36
[37m[36mINFO[0m[0m 03/19 17:35:15 | # of params = 23522375
[37m[36mINFO[0m[0m 03/19 17:35:48 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 17:35:48 | 0.197682    0.193154    0.178662    0.176536    1.878639    0.197682    0.193154    0.202559    0.209402    0.136228    0.122754    0.197201    0.197452    0           0.000000    1.988177    1.509904    31.874818  
[37m[36mINFO[0m[0m 03/19 17:37:22 | 0.834655    0.836186    0.971081    0.955869    0.118032    0.834655    0.836186    0.966418    0.950855    0.993263    0.997006    0.953562    0.919745    200         6.586826    0.295443    0.297192    34.266492  
[37m[36mINFO[0m[0m 03/19 17:39:12 | 0.813911    0.789731    0.982129    0.962805    0.123383    0.813911    0.789731    0.973348    0.961538    0.996257    0.988024    0.976781    0.938854    400         13.173653   0.076975    0.380436    33.512636  
[37m[36mINFO[0m[0m 03/19 17:40:44 | 0.822453    0.799511    0.986651    0.962128    0.121662    0.822453    0.799511    0.990938    0.965812    0.997006    0.997006    0.972010    0.923567    600         19.760479   0.040731    0.289183    34.629907  
[37m[36mINFO[0m[0m 03/19 17:42:29 | 0.821232    0.823961    0.982287    0.950039    0.184989    0.821232    0.823961    0.982409    0.948718    0.996257    0.988024    0.968193    0.913376    800         26.347305   0.032956    0.365187    31.714913  
[37m[36mINFO[0m[0m 03/19 17:43:59 | 0.840146    0.831296    0.995033    0.969912    0.103218    0.840146    0.831296    0.994136    0.972222    0.997006    0.991018    0.993957    0.946497    1000        32.934132   0.022203    0.290799    31.709337  
[37m[36mINFO[0m[0m 03/19 17:45:42 | 0.813301    0.814181    0.996885    0.966228    0.102705    0.813301    0.814181    0.998401    0.970085    0.999251    0.991018    0.993003    0.937580    1200        39.520958   0.018826    0.356087    32.230747  
[37m[36mINFO[0m[0m 03/19 17:47:14 | 0.842587    0.853301    0.995750    0.968361    0.115447    0.842587    0.853301    0.996269    0.967949    0.999251    0.997006    0.991730    0.940127    1400        46.107784   0.011170    0.290468    33.377046  
[37m[36mINFO[0m[0m 03/19 17:48:56 | 0.864552    0.872861    0.996561    0.968513    0.120631    0.864552    0.872861    0.997335    0.976496    0.997754    0.994012    0.994593    0.935032    1600        52.694611   0.011644    0.350132    31.913578  
[37m[36mINFO[0m[0m 03/19 17:50:29 | 0.857840    0.855746    0.997983    0.971621    0.109308    0.857840    0.855746    0.998401    0.970085    1.000000    0.997006    0.995547    0.947771    1800        59.281437   0.010642    0.287126    35.931582  
[37m[36mINFO[0m[0m 03/19 17:52:07 | 0.902990    0.907090    0.997908    0.969202    0.095943    0.902990    0.907090    0.997335    0.974359    0.999251    0.988024    0.997137    0.945223    2000        65.868263   0.006355    0.324303    33.413970  
[37m[36mINFO[0m[0m 03/19 17:53:47 | 0.870043    0.870416    0.997871    0.968063    0.103199    0.870043    0.870416    0.995203    0.967949    1.000000    0.991018    0.998410    0.945223    2200        72.455090   0.008811    0.326556    34.502403  
[37m[36mINFO[0m[0m 03/19 17:55:21 | 0.866992    0.882641    0.997733    0.967087    0.123331    0.866992    0.882641    0.998401    0.967949    0.999251    0.997006    0.995547    0.936306    2400        79.041916   0.004693    0.304875    33.351995  
[37m[36mINFO[0m[0m 03/19 17:56:53 | 0.875534    0.882641    0.998831    0.974744    0.121021    0.875534    0.882641    0.998401    0.974359    1.000000    0.997006    0.998092    0.952866    2600        85.628743   0.004587    0.300039    31.441740  
[37m[36mINFO[0m[0m 03/19 17:58:22 | 0.877364    0.887531    0.997134    0.971758    0.123495    0.877364    0.887531    0.998401    0.967949    1.000000    0.997006    0.993003    0.950318    2800        92.215569   0.005176    0.289008    31.090004  
[37m[36mINFO[0m[0m 03/19 18:00:03 | 0.887736    0.889976    0.998865    0.973472    0.129724    0.887736    0.889976    1.000000    0.978632    0.998503    0.994012    0.998092    0.947771    3000        98.802395   0.005091    0.348506    31.024651  
[37m[36mINFO[0m[0m 03/19 18:01:34 | 0.843197    0.850856    0.997908    0.974045    0.144679    0.843197    0.850856    0.998401    0.978632    0.998503    0.997006    0.996819    0.946497    3200        105.389222  0.004965    0.291743    33.493004  
[37m[36mINFO[0m[0m 03/19 18:03:18 | 0.894448    0.880196    0.999788    0.975593    0.113361    0.894448    0.880196    1.000000    0.974359    1.000000    0.997006    0.999364    0.955414    3400        111.976048  0.003727    0.354871    32.163452  
[37m[36mINFO[0m[0m 03/19 18:04:46 | 0.854790    0.850856    0.998266    0.971632    0.121476    0.854790    0.850856    0.998934    0.972222    1.000000    1.000000    0.995865    0.942675    3600        118.562874  0.003948    0.289253    30.276206  
[37m[36mINFO[0m[0m 03/19 18:06:29 | 0.879805    0.875306    0.999610    0.971760    0.099979    0.879805    0.875306    0.999467    0.972222    1.000000    0.994012    0.999364    0.949045    3800        125.149701  0.004157    0.356964    31.567567  
[37m[36mINFO[0m[0m 03/19 18:07:57 | 0.848688    0.853301    0.999433    0.975168    0.102063    0.848688    0.853301    0.998934    0.974359    1.000000    0.997006    0.999364    0.954140    4000        131.736527  0.002855    0.288734    30.521273  
[37m[36mINFO[0m[0m 03/19 18:09:42 | 0.855400    0.850856    0.998974    0.972482    0.132818    0.855400    0.850856    0.999467    0.972222    1.000000    1.000000    0.997455    0.945223    4200        138.323353  0.002530    0.363824    31.959730  
[37m[36mINFO[0m[0m 03/19 18:11:13 | 0.896888    0.907090    0.999504    0.975607    0.112113    0.896888    0.907090    0.999467    0.980769    1.000000    0.997006    0.999046    0.949045    4400        144.910180  0.003164    0.289436    32.978640  
[37m[36mINFO[0m[0m 03/19 18:12:57 | 0.898719    0.889976    0.994384    0.963934    0.162788    0.898719    0.889976    0.996269    0.970085    0.991018    0.979042    0.995865    0.942675    4600        151.497006  0.003445    0.362663    31.480657  
[37m[36mINFO[0m[0m 03/19 18:14:27 | 0.863941    0.865526    0.999716    0.976593    0.093107    0.863941    0.865526    0.999467    0.978632    1.000000    0.997006    0.999682    0.954140    4800        158.083832  0.003351    0.287787    32.967611  
[37m[36mINFO[0m[0m 03/19 18:16:12 | 0.852959    0.850856    0.999470    0.972744    0.125492    0.852959    0.850856    1.000000    0.965812    1.000000    0.997006    0.998410    0.955414    5000        164.670659  0.002092    0.364057    31.800194  
[37m[36mINFO[0m[0m 03/19 18:16:12 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250319_17-35-14_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 18:16:13 | ---
[37m[36mINFO[0m[0m 03/19 18:16:13 | test-domain validation(oracle) = 90.299%
[37m[36mINFO[0m[0m 03/19 18:16:13 | training-domain validation(iid) = 86.394%
[37m[36mINFO[0m[0m 03/19 18:16:13 | last = 85.296%
[37m[36mINFO[0m[0m 03/19 18:16:13 | last (inD) = 97.274%
[37m[36mINFO[0m[0m 03/19 18:16:13 | training-domain validation (iid, inD) = 97.659%
[37m[36mINFO[0m[0m 03/19 18:16:13 | === Summary ===
[37m[36mINFO[0m[0m 03/19 18:16:13 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 2 --hparams_seed 12
[37m[36mINFO[0m[0m 03/19 18:16:13 | Unique name: 250319_17-35-14_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 18:16:13 | Out path: train_output/PACS/ERM/[0]/250319_17-35-14_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 18:16:13 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 18:16:13 | Dataset: PACS

[37m[36mINFO[0m[0m 03/18 17:16:54 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 0 --hparams_seed 2
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 2
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250318_17-16-54_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250318_17-16-54_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 1.9041073434446342e-05
	batch_size: 9
	weight_decay: 0.0006566989842279891
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/18 17:16:54 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 17:16:54 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 17:16:54 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 17:16:54 | 
[37m[36mINFO[0m[0m 03/18 17:16:54 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/18 17:16:54 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/18 17:16:54 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/18 17:16:54 | Batch sizes for each domain: [0, 9, 9, 9] (total=27)
[37m[36mINFO[0m[0m 03/18 17:16:54 | steps-per-epoch for each domain: 208.44, 148.44, 349.33 -> min = 148.44
[37m[36mINFO[0m[0m 03/18 17:16:55 | # of params = 23522375
[37m[36mINFO[0m[0m 03/18 17:17:30 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 17:17:30 | 0.158633    0.158924    0.201962    0.187825    2.032599    0.158633    0.158924    0.242537    0.239316    0.163922    0.140719    0.199427    0.183439    0           0.000000    1.912682    1.433607    33.290433  
[37m[36mINFO[0m[0m 03/18 17:18:41 | 0.794387    0.806846    0.917388    0.940637    0.195906    0.794387    0.806846    0.892324    0.933761    0.975299    0.976048    0.884542    0.912102    200         1.347305    0.526394    0.200500    31.346576  
[37m[36mINFO[0m[0m 03/18 17:19:39 | 0.699817    0.706601    0.906685    0.909534    0.274294    0.699817    0.706601    0.850746    0.891026    0.979042    0.970060    0.890267    0.867516    400         2.694611    0.220575    0.134158    30.774185  
[37m[36mINFO[0m[0m 03/18 17:20:36 | 0.750458    0.767726    0.930376    0.926129    0.214648    0.750458    0.767726    0.915778    0.920940    0.953593    0.958084    0.921756    0.899363    600         4.041916    0.203016    0.120700    33.058867  
[37m[36mINFO[0m[0m 03/18 17:21:50 | 0.863941    0.882641    0.970155    0.947295    0.153530    0.863941    0.882641    0.968017    0.963675    0.989521    0.952096    0.952926    0.926115    800         5.389222    0.143042    0.201434    33.441134  
[37m[36mINFO[0m[0m 03/18 17:22:59 | 0.809640    0.809291    0.968876    0.954418    0.155098    0.809640    0.809291    0.966951    0.961538    0.988024    0.973054    0.951654    0.928662    1000        6.736527    0.096602    0.176352    33.649250  
[37m[36mINFO[0m[0m 03/18 17:23:57 | 0.768761    0.772616    0.946919    0.926593    0.235454    0.768761    0.772616    0.945629    0.935897    0.973054    0.961078    0.922074    0.882803    1200        8.083832    0.109451    0.124175    33.133182  
[37m[36mINFO[0m[0m 03/18 17:24:58 | 0.776083    0.792176    0.971891    0.950839    0.147128    0.776083    0.792176    0.971748    0.959402    0.988772    0.958084    0.955153    0.935032    1400        9.431138    0.084841    0.145201    32.599944  
[37m[36mINFO[0m[0m 03/18 17:26:06 | 0.812081    0.811736    0.975358    0.954098    0.148518    0.812081    0.811736    0.958422    0.933761    0.998503    0.982036    0.969148    0.946497    1600        10.778443   0.078313    0.180704    31.206770  
[37m[36mINFO[0m[0m 03/18 17:27:05 | 0.837096    0.836186    0.978730    0.957952    0.124259    0.837096    0.836186    0.973348    0.959402    0.994012    0.973054    0.968830    0.941401    1800        12.125749   0.061080    0.136533    32.396344  
[37m[36mINFO[0m[0m 03/18 17:28:02 | 0.741306    0.733496    0.973246    0.940453    0.213358    0.741306    0.733496    0.958955    0.927350    0.988772    0.964072    0.972010    0.929936    2000        13.473054   0.049291    0.122706    32.355189  
[37m[36mINFO[0m[0m 03/18 17:28:59 | 0.829774    0.826406    0.987039    0.963635    0.137099    0.829774    0.826406    0.986674    0.965812    0.999251    0.976048    0.975191    0.949045    2200        14.820359   0.048315    0.122947    32.480405  
[37m[36mINFO[0m[0m 03/18 17:29:57 | 0.837096    0.823961    0.988092    0.960066    0.143701    0.837096    0.823961    0.990938    0.961538    0.994012    0.967066    0.979326    0.951592    2400        16.167665   0.056313    0.124543    32.422993  
[37m[36mINFO[0m[0m 03/18 17:30:57 | 0.837096    0.838631    0.988806    0.957813    0.152383    0.837096    0.838631    0.989339    0.957265    0.997754    0.976048    0.979326    0.940127    2600        17.514970   0.052957    0.134078    33.107784  
[37m[36mINFO[0m[0m 03/18 17:32:06 | 0.748627    0.753056    0.985897    0.961901    0.135993    0.748627    0.753056    0.989872    0.959402    0.993263    0.967066    0.974555    0.959236    2800        18.862275   0.056825    0.182122    33.051861  
[37m[36mINFO[0m[0m 03/18 17:33:08 | 0.858450    0.853301    0.994366    0.969167    0.120590    0.858450    0.853301    0.994136    0.967949    0.998503    0.979042    0.990458    0.960510    3000        20.209581   0.040598    0.147939    32.495021  
[37m[36mINFO[0m[0m 03/18 17:34:05 | 0.841367    0.823961    0.994363    0.966457    0.140560    0.841367    0.823961    0.993603    0.961538    0.997754    0.976048    0.991730    0.961783    3200        21.556886   0.029417    0.127125    31.785768  
[37m[36mINFO[0m[0m 03/18 17:35:05 | 0.875534    0.867971    0.989468    0.963065    0.138522    0.875534    0.867971    0.986141    0.974359    0.996257    0.967066    0.986005    0.947771    3400        22.904192   0.042598    0.144345    31.137155  
[37m[36mINFO[0m[0m 03/18 17:36:15 | 0.843197    0.843521    0.991320    0.957254    0.177757    0.843197    0.843521    0.991471    0.963675    0.997754    0.973054    0.984733    0.935032    3600        24.251497   0.015397    0.189446    31.993047  
[37m[36mINFO[0m[0m 03/18 17:37:15 | 0.843807    0.843521    0.990150    0.963625    0.129491    0.843807    0.843521    0.988806    0.967949    0.998503    0.970060    0.983142    0.952866    3800        25.598802   0.031425    0.133966    32.583891  
[37m[36mINFO[0m[0m 03/18 17:38:13 | 0.806589    0.799511    0.994546    0.965783    0.147264    0.806589    0.799511    0.996269    0.974359    0.998503    0.979042    0.988868    0.943949    4000        26.946108   0.020135    0.129005    32.360232  
[37m[36mINFO[0m[0m 03/18 17:39:20 | 0.834655    0.819071    0.996065    0.971145    0.118682    0.834655    0.819071    0.996802    0.976496    0.997754    0.970060    0.993639    0.966879    4200        28.293413   0.034606    0.169405    33.453918  
[37m[36mINFO[0m[0m 03/18 17:40:30 | 0.812691    0.823961    0.992489    0.962911    0.120477    0.812691    0.823961    0.990938    0.961538    0.999251    0.973054    0.987277    0.954140    4400        29.640719   0.032651    0.189049    31.847730  
[37m[36mINFO[0m[0m 03/18 17:41:33 | 0.781574    0.777506    0.991844    0.962187    0.138845    0.781574    0.777506    0.989339    0.957265    0.997006    0.970060    0.989186    0.959236    4600        30.988024   0.024635    0.138151    35.283008  
[37m[36mINFO[0m[0m 03/18 17:42:31 | 0.854179    0.858191    0.995435    0.968746    0.117051    0.854179    0.858191    0.997868    0.976496    0.999251    0.973054    0.989186    0.956688    4800        32.335329   0.024821    0.129461    32.661834  
[37m[36mINFO[0m[0m 03/18 17:43:42 | 0.776693    0.782396    0.985410    0.951837    0.172085    0.776693    0.782396    0.990938    0.959402    0.995509    0.961078    0.969784    0.935032    5000        33.682635   0.024079    0.185885    33.822073  
[37m[36mINFO[0m[0m 03/18 17:43:42 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250318_17-16-54_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 17:43:44 | ---
[37m[36mINFO[0m[0m 03/18 17:43:44 | test-domain validation(oracle) = 86.394%
[37m[36mINFO[0m[0m 03/18 17:43:44 | training-domain validation(iid) = 83.466%
[37m[36mINFO[0m[0m 03/18 17:43:44 | last = 77.669%
[37m[36mINFO[0m[0m 03/18 17:43:44 | last (inD) = 95.184%
[37m[36mINFO[0m[0m 03/18 17:43:44 | training-domain validation (iid, inD) = 97.114%
[37m[36mINFO[0m[0m 03/18 17:43:44 | === Summary ===
[37m[36mINFO[0m[0m 03/18 17:43:44 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 0 --hparams_seed 2
[37m[36mINFO[0m[0m 03/18 17:43:44 | Unique name: 250318_17-16-54_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 17:43:44 | Out path: train_output/PACS/ERM/[0]/250318_17-16-54_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 17:43:44 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 17:43:44 | Dataset: PACS

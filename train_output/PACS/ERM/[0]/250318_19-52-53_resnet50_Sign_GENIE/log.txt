[37m[36mINFO[0m[0m 03/18 19:52:53 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 0 --hparams_seed 7
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 7
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250318_19-52-53_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250318_19-52-53_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 1.6632780446310692e-05
	batch_size: 24
	weight_decay: 5.717289389191427e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/18 19:52:53 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 19:52:53 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 19:52:53 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 19:52:53 | 
[37m[36mINFO[0m[0m 03/18 19:52:53 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/18 19:52:53 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/18 19:52:53 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/18 19:52:53 | Batch sizes for each domain: [0, 24, 24, 24] (total=72)
[37m[36mINFO[0m[0m 03/18 19:52:53 | steps-per-epoch for each domain: 78.17, 55.67, 131.00 -> min = 55.67
[37m[36mINFO[0m[0m 03/18 19:52:55 | # of params = 23522375
[37m[36mINFO[0m[0m 03/18 19:53:27 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 19:53:27 | 0.214155    0.227384    0.293163    0.288050    1.865667    0.214155    0.227384    0.272921    0.271368    0.364521    0.353293    0.242048    0.239490    0           0.000000    1.987298    1.095164    31.836133  
[37m[36mINFO[0m[0m 03/18 19:54:35 | 0.806589    0.782396    0.915926    0.920748    0.223549    0.806589    0.782396    0.898188    0.899573    0.979042    0.976048    0.870547    0.886624    200         3.592814    0.359242    0.181841    31.082845  
[37m[36mINFO[0m[0m 03/18 19:56:15 | 0.852349    0.860636    0.972225    0.962807    0.115631    0.852349    0.860636    0.972281    0.965812    0.994012    0.985030    0.950382    0.937580    400         7.185629    0.113376    0.345909    31.244596  
[37m[36mINFO[0m[0m 03/18 19:57:23 | 0.871873    0.889976    0.973912    0.960234    0.118088    0.871873    0.889976    0.972814    0.957265    0.990269    0.982036    0.958651    0.941401    600         10.778443   0.080765    0.178760    32.059631  
[37m[36mINFO[0m[0m 03/18 19:59:04 | 0.820622    0.836186    0.975639    0.955714    0.139432    0.820622    0.836186    0.980277    0.961538    0.996257    0.982036    0.950382    0.923567    800         14.371257   0.059815    0.347427    31.379323  
[37m[36mINFO[0m[0m 03/18 20:00:16 | 0.863331    0.838631    0.987917    0.965631    0.108044    0.863331    0.838631    0.990938    0.965812    0.994760    0.982036    0.978053    0.949045    1000        17.964072   0.046902    0.187711    33.996209  
[37m[36mINFO[0m[0m 03/18 20:01:44 | 0.866992    0.877751    0.988541    0.961375    0.131349    0.866992    0.877751    0.990938    0.967949    0.990269    0.976048    0.984415    0.940127    1200        21.556886   0.030297    0.266841    34.621904  
[37m[36mINFO[0m[0m 03/18 20:02:53 | 0.834045    0.853301    0.992561    0.968767    0.097732    0.834045    0.853301    0.991471    0.976496    0.999251    0.982036    0.986959    0.947771    1400        25.149701   0.035775    0.192485    31.410261  
[37m[36mINFO[0m[0m 03/18 20:04:03 | 0.878585    0.880196    0.995607    0.970051    0.110482    0.878585    0.880196    0.996269    0.974359    0.998503    0.988024    0.992048    0.947771    1600        28.742515   0.018555    0.181506    32.877228  
[37m[36mINFO[0m[0m 03/18 20:05:27 | 0.855400    0.875306    0.996212    0.973149    0.104425    0.855400    0.875306    0.996269    0.970085    1.000000    0.985030    0.992366    0.964331    1800        32.335329   0.018974    0.253225    33.455017  
[37m[36mINFO[0m[0m 03/18 20:06:32 | 0.845638    0.867971    0.996389    0.967181    0.127900    0.845638    0.867971    0.997868    0.965812    0.999251    0.979042    0.992048    0.956688    2000        35.928144   0.016451    0.176709    30.363583  
[37m[36mINFO[0m[0m 03/18 20:08:09 | 0.849298    0.885086    0.994793    0.967190    0.114526    0.849298    0.885086    0.995736    0.963675    0.998503    0.985030    0.990140    0.952866    2200        39.520958   0.014570    0.322662    32.361018  
[37m[36mINFO[0m[0m 03/18 20:09:17 | 0.866992    0.885086    0.996137    0.970161    0.105143    0.866992    0.885086    0.995203    0.959402    0.999251    0.988024    0.993957    0.963057    2400        43.113772   0.015780    0.181246    31.082032  
[37m[36mINFO[0m[0m 03/18 20:11:00 | 0.879805    0.899756    0.997942    0.976284    0.092719    0.879805    0.899756    0.998934    0.976496    0.997754    0.988024    0.997137    0.964331    2600        46.706587   0.012111    0.354201    32.946456  
[37m[36mINFO[0m[0m 03/18 20:12:09 | 0.837706    0.853301    0.998123    0.973572    0.124071    0.837706    0.853301    0.997868    0.965812    1.000000    0.988024    0.996501    0.966879    2800        50.299401   0.009956    0.187294    30.831512  
[37m[36mINFO[0m[0m 03/18 20:13:52 | 0.873093    0.899756    0.991016    0.970454    0.127197    0.873093    0.899756    0.993070    0.974359    0.989521    0.979042    0.990458    0.957962    3000        53.892216   0.013054    0.365559    29.832876  
[37m[36mINFO[0m[0m 03/18 20:15:01 | 0.874924    0.892421    0.997240    0.965781    0.112698    0.874924    0.892421    0.999467    0.970085    0.999251    0.982036    0.993003    0.945223    3200        57.485030   0.016679    0.183302    32.203773  
[37m[36mINFO[0m[0m 03/18 20:16:44 | 0.873093    0.897311    0.997060    0.972448    0.134511    0.873093    0.897311    0.996269    0.970085    1.000000    0.988024    0.994911    0.959236    3400        61.077844   0.006385    0.356123    31.949479  
[37m[36mINFO[0m[0m 03/18 20:17:52 | 0.837096    0.843521    0.997805    0.968889    0.137261    0.837096    0.843521    0.998934    0.963675    0.999251    0.985030    0.995229    0.957962    3600        64.670659   0.008191    0.185390    31.587077  
[37m[36mINFO[0m[0m 03/18 20:19:28 | 0.834045    0.853301    0.998335    0.970462    0.123611    0.834045    0.853301    0.998934    0.967949    0.999251    0.988024    0.996819    0.955414    3800        68.263473   0.006797    0.318084    32.264721  
[37m[36mINFO[0m[0m 03/18 20:20:39 | 0.881635    0.911980    0.996527    0.964912    0.149877    0.881635    0.911980    0.995736    0.974359    0.999251    0.970060    0.994593    0.950318    4000        71.856287   0.008299    0.189987    32.840333  
[37m[36mINFO[0m[0m 03/18 20:21:45 | 0.860891    0.887531    0.998831    0.977982    0.106326    0.860891    0.887531    0.998401    0.976496    1.000000    0.988024    0.998092    0.969427    4200        75.449102   0.009094    0.178894    30.517314  
[37m[36mINFO[0m[0m 03/18 20:22:52 | 0.849908    0.865526    0.999043    0.970439    0.130016    0.849908    0.865526    0.999467    0.963675    0.999251    0.982036    0.998410    0.965605    4400        79.041916   0.008438    0.171601    32.275697  
[37m[36mINFO[0m[0m 03/18 20:23:57 | 0.840146    0.855746    0.998051    0.965893    0.145372    0.840146    0.855746    0.997335    0.959402    1.000000    0.979042    0.996819    0.959236    4600        82.634731   0.008581    0.167875    31.749794  
[37m[36mINFO[0m[0m 03/18 20:25:04 | 0.856010    0.892421    0.998725    0.971014    0.115870    0.856010    0.892421    0.998401    0.967949    1.000000    0.982036    0.997774    0.963057    4800        86.227545   0.007581    0.171707    32.233723  
[37m[36mINFO[0m[0m 03/18 20:26:11 | 0.882855    0.887531    0.997019    0.974149    0.123031    0.882855    0.887531    0.996802    0.974359    0.997754    0.985030    0.996501    0.963057    5000        89.820359   0.007842    0.170866    33.020379  
[37m[36mINFO[0m[0m 03/18 20:26:11 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250318_19-52-53_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 20:26:13 | ---
[37m[36mINFO[0m[0m 03/18 20:26:13 | test-domain validation(oracle) = 88.164%
[37m[36mINFO[0m[0m 03/18 20:26:13 | training-domain validation(iid) = 86.089%
[37m[36mINFO[0m[0m 03/18 20:26:13 | last = 88.286%
[37m[36mINFO[0m[0m 03/18 20:26:13 | last (inD) = 97.415%
[37m[36mINFO[0m[0m 03/18 20:26:13 | training-domain validation (iid, inD) = 97.798%
[37m[36mINFO[0m[0m 03/18 20:26:13 | === Summary ===
[37m[36mINFO[0m[0m 03/18 20:26:13 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 0 --hparams_seed 7
[37m[36mINFO[0m[0m 03/18 20:26:13 | Unique name: 250318_19-52-53_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 20:26:13 | Out path: train_output/PACS/ERM/[0]/250318_19-52-53_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 20:26:13 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 20:26:13 | Dataset: PACS

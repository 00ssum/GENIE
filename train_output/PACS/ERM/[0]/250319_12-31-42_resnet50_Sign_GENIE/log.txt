[37m[36mINFO[0m[0m 03/19 12:31:42 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 2 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250319_12-31-42_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 2
	unique_name: 250319_12-31-42_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 3.1159521264763664e-05
	batch_size: 11
	weight_decay: 1.4650833494643601e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/19 12:31:42 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 12:31:42 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 12:31:42 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 12:31:42 | 
[37m[36mINFO[0m[0m 03/19 12:31:42 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 12:31:42 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 12:31:42 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 12:31:42 | Batch sizes for each domain: [0, 11, 11, 11] (total=33)
[37m[36mINFO[0m[0m 03/19 12:31:42 | steps-per-epoch for each domain: 170.55, 121.45, 285.82 -> min = 121.45
[37m[36mINFO[0m[0m 03/19 12:31:43 | # of params = 23522375
[37m[36mINFO[0m[0m 03/19 12:32:15 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 12:32:15 | 0.187309    0.176039    0.164444    0.158158    2.010859    0.187309    0.176039    0.166844    0.160256    0.130240    0.116766    0.196247    0.197452    0           0.000000    2.031524    1.033181    30.731297  
[37m[36mINFO[0m[0m 03/19 12:33:14 | 0.752898    0.784841    0.891214    0.890478    0.310622    0.752898    0.784841    0.855544    0.869658    0.966317    0.952096    0.851781    0.849682    200         1.646707    0.559400    0.131839    32.378393  
[37m[36mINFO[0m[0m 03/19 12:34:22 | 0.788896    0.779951    0.944173    0.940805    0.188561    0.788896    0.779951    0.939765    0.929487    0.980539    0.991018    0.912214    0.901911    400         3.293413    0.231487    0.181273    31.987322  
[37m[36mINFO[0m[0m 03/19 12:35:19 | 0.836486    0.828851    0.964222    0.953579    0.133337    0.836486    0.828851    0.953625    0.959402    0.988024    0.979042    0.951018    0.922293    600         4.940120    0.147222    0.130924    30.598948  
[37m[36mINFO[0m[0m 03/19 12:36:16 | 0.786455    0.801956    0.963126    0.949468    0.166740    0.786455    0.801956    0.961620    0.952991    0.982784    0.982036    0.944975    0.913376    800         6.586826    0.121005    0.130443    31.358321  
[37m[36mINFO[0m[0m 03/19 12:37:13 | 0.846248    0.855746    0.977991    0.966505    0.096492    0.846248    0.855746    0.972814    0.974359    0.995509    0.985030    0.965649    0.940127    1000        8.233533    0.126684    0.135399    30.127246  
[37m[36mINFO[0m[0m 03/19 12:38:08 | 0.808420    0.833741    0.981529    0.958984    0.124551    0.808420    0.833741    0.978678    0.961538    0.993263    0.988024    0.972646    0.927389    1200        9.880240    0.089829    0.123490    30.146420  
[37m[36mINFO[0m[0m 03/19 12:39:15 | 0.870043    0.885086    0.982891    0.957023    0.119398    0.870043    0.885086    0.986674    0.967949    0.994760    0.991018    0.967239    0.912102    1400        11.526946   0.076449    0.184102    30.260670  
[37m[36mINFO[0m[0m 03/19 12:40:14 | 0.825503    0.841076    0.979598    0.952168    0.142640    0.825503    0.841076    0.988806    0.961538    0.991018    0.979042    0.958969    0.915924    1600        13.173653   0.058761    0.132299    32.611323  
[37m[36mINFO[0m[0m 03/19 12:41:12 | 0.841977    0.863081    0.983805    0.958407    0.113951    0.841977    0.863081    0.986141    0.952991    0.993263    0.991018    0.972010    0.931210    1800        14.820359   0.066004    0.136607    30.090947  
[37m[36mINFO[0m[0m 03/19 12:42:16 | 0.854179    0.828851    0.987946    0.969636    0.093804    0.854179    0.828851    0.988273    0.972222    0.994012    0.994012    0.981552    0.942675    2000        16.467066   0.058530    0.164466    30.995428  
[37m[36mINFO[0m[0m 03/19 12:43:12 | 0.801098    0.794621    0.986995    0.971345    0.109467    0.801098    0.794621    0.986674    0.970085    0.996257    1.000000    0.978053    0.943949    2200        18.113772   0.047816    0.123114    31.372007  
[37m[36mINFO[0m[0m 03/19 12:44:16 | 0.813301    0.826406    0.989181    0.960093    0.136331    0.813301    0.826406    0.986141    0.950855    0.994760    0.988024    0.986641    0.941401    2400        19.760479   0.039918    0.161518    31.739024  
[37m[36mINFO[0m[0m 03/19 12:45:12 | 0.776693    0.743276    0.988308    0.959674    0.113154    0.776693    0.743276    0.986141    0.963675    0.998503    0.979042    0.980280    0.936306    2600        21.407186   0.049591    0.130515    30.202107  
[37m[36mINFO[0m[0m 03/19 12:46:08 | 0.861501    0.860636    0.992457    0.968922    0.104337    0.861501    0.860636    0.994136    0.965812    0.998503    0.997006    0.984733    0.943949    2800        23.053892   0.042346    0.125632    30.634422  
[37m[36mINFO[0m[0m 03/19 12:47:15 | 0.822453    0.819071    0.977956    0.954299    0.177616    0.822453    0.819071    0.973348    0.955128    0.995509    0.988024    0.965013    0.919745    3000        24.700599   0.032974    0.190478    29.384983  
[37m[36mINFO[0m[0m 03/19 12:48:11 | 0.840757    0.850856    0.994363    0.965652    0.105116    0.840757    0.850856    0.992537    0.965812    0.998503    0.991018    0.992048    0.940127    3200        26.347305   0.026708    0.124347    31.075541  
[37m[36mINFO[0m[0m 03/19 12:49:11 | 0.823063    0.819071    0.986887    0.955285    0.142137    0.823063    0.819071    0.980810    0.952991    0.999251    0.988024    0.980598    0.924841    3400        27.994012   0.036957    0.128402    33.711395  
[37m[36mINFO[0m[0m 03/19 12:50:11 | 0.807810    0.819071    0.987167    0.958549    0.143018    0.807810    0.819071    0.982942    0.963675    0.997006    0.982036    0.981552    0.929936    3600        29.640719   0.024645    0.142298    32.308448  
[37m[36mINFO[0m[0m 03/19 12:51:09 | 0.840146    0.838631    0.987188    0.960099    0.164274    0.840146    0.838631    0.988806    0.963675    0.988024    0.979042    0.984733    0.937580    3800        31.287425   0.031108    0.130674    31.409356  
[37m[36mINFO[0m[0m 03/19 12:52:19 | 0.857840    0.850856    0.989520    0.958287    0.147251    0.857840    0.850856    0.992004    0.970085    0.998503    0.985030    0.978053    0.919745    4000        32.934132   0.027381    0.192742    31.928348  
[37m[36mINFO[0m[0m 03/19 12:53:16 | 0.849908    0.848411    0.994755    0.963236    0.138440    0.849908    0.848411    0.995736    0.974359    0.997754    0.979042    0.990776    0.936306    4200        34.580838   0.029154    0.127150    31.021615  
[37m[36mINFO[0m[0m 03/19 12:54:13 | 0.825503    0.804401    0.995638    0.969061    0.102205    0.825503    0.804401    0.995203    0.967949    0.997754    0.994012    0.993957    0.945223    4400        36.227545   0.025142    0.130991    30.824036  
[37m[36mINFO[0m[0m 03/19 12:55:17 | 0.882245    0.863081    0.997134    0.969486    0.098918    0.882245    0.863081    0.998401    0.967949    1.000000    0.994012    0.993003    0.946497    4600        37.874251   0.014048    0.157237    32.376693  
[37m[36mINFO[0m[0m 03/19 12:56:12 | 0.881025    0.877751    0.993933    0.970323    0.102962    0.881025    0.877751    0.991471    0.965812    0.997006    0.991018    0.993321    0.954140    4800        39.520958   0.032675    0.122860    30.686497  
[37m[36mINFO[0m[0m 03/19 12:57:16 | 0.868212    0.865526    0.994409    0.961107    0.134347    0.868212    0.865526    0.996269    0.961538    1.000000    0.988024    0.986959    0.933758    5000        41.167665   0.012530    0.164028    31.453075  
[37m[36mINFO[0m[0m 03/19 12:57:16 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250319_12-31-42_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 12:57:17 | ---
[37m[36mINFO[0m[0m 03/19 12:57:17 | test-domain validation(oracle) = 87.004%
[37m[36mINFO[0m[0m 03/19 12:57:17 | training-domain validation(iid) = 80.110%
[37m[36mINFO[0m[0m 03/19 12:57:17 | last = 86.821%
[37m[36mINFO[0m[0m 03/19 12:57:17 | last (inD) = 96.111%
[37m[36mINFO[0m[0m 03/19 12:57:17 | training-domain validation (iid, inD) = 97.134%
[37m[36mINFO[0m[0m 03/19 12:57:17 | === Summary ===
[37m[36mINFO[0m[0m 03/19 12:57:17 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 2 --hparams_seed 1
[37m[36mINFO[0m[0m 03/19 12:57:17 | Unique name: 250319_12-31-42_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 12:57:17 | Out path: train_output/PACS/ERM/[0]/250319_12-31-42_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 12:57:17 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 12:57:17 | Dataset: PACS

[37m[36mINFO[0m[0m 03/19 11:31:26 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 1 --hparams_seed 19
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 19
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250319_11-31-26_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 1
	unique_name: 250319_11-31-26_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 3.7692486045276154e-05
	batch_size: 10
	weight_decay: 0.0003178970604685295
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/19 11:31:26 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 11:31:26 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 11:31:26 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 11:31:26 | 
[37m[36mINFO[0m[0m 03/19 11:31:26 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 11:31:26 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 11:31:26 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 11:31:26 | Batch sizes for each domain: [0, 10, 10, 10] (total=30)
[37m[36mINFO[0m[0m 03/19 11:31:26 | steps-per-epoch for each domain: 187.60, 133.60, 314.40 -> min = 133.60
[37m[36mINFO[0m[0m 03/19 11:31:28 | # of params = 23522375
[37m[36mINFO[0m[0m 03/19 11:32:01 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 11:32:01 | 0.139719    0.163814    0.181407    0.182160    1.970188    0.139719    0.163814    0.188166    0.224359    0.178892    0.152695    0.177163    0.169427    0           0.000000    1.974154    1.524390    31.887294  
[37m[36mINFO[0m[0m 03/19 11:33:10 | 0.809030    0.794621    0.890813    0.895241    0.288016    0.809030    0.794621    0.873667    0.882479    0.962575    0.979042    0.836196    0.824204    200         1.497006    0.570084    0.174209    33.586354  
[37m[36mINFO[0m[0m 03/19 11:34:06 | 0.754118    0.772616    0.924548    0.921161    0.217820    0.754118    0.772616    0.909915    0.897436    0.958832    0.973054    0.904898    0.892994    400         2.994012    0.271892    0.122594    31.841911  
[37m[36mINFO[0m[0m 03/19 11:35:09 | 0.737035    0.748166    0.937531    0.928695    0.225540    0.737035    0.748166    0.931237    0.912393    0.974551    0.973054    0.906807    0.900637    600         4.491018    0.179996    0.154326    32.732688  
[37m[36mINFO[0m[0m 03/19 11:36:17 | 0.845638    0.831296    0.967989    0.953685    0.137705    0.845638    0.831296    0.956823    0.935897    0.993263    0.985030    0.953880    0.940127    800         5.988024    0.127555    0.177848    31.805660  
[37m[36mINFO[0m[0m 03/19 11:37:14 | 0.787675    0.787286    0.962151    0.958786    0.133672    0.787675    0.787286    0.952559    0.948718    0.981287    0.976048    0.952608    0.951592    1000        7.485030    0.111107    0.126318    31.537673  
[37m[36mINFO[0m[0m 03/19 11:38:17 | 0.810250    0.809291    0.970232    0.953448    0.136427    0.810250    0.809291    0.970682    0.950855    0.990269    0.991018    0.949746    0.918471    1200        8.982036    0.116568    0.160361    31.159387  
[37m[36mINFO[0m[0m 03/19 11:39:26 | 0.806589    0.794621    0.981530    0.964343    0.113513    0.806589    0.794621    0.975480    0.959402    0.995509    0.982036    0.973601    0.951592    1400        10.479042   0.084527    0.177508    33.135061  
[37m[36mINFO[0m[0m 03/19 11:40:23 | 0.830995    0.831296    0.986037    0.971450    0.088523    0.830995    0.831296    0.987207    0.970085    0.994760    0.985030    0.976145    0.959236    1600        11.976048   0.073591    0.128649    31.707355  
[37m[36mINFO[0m[0m 03/19 11:41:27 | 0.849298    0.853301    0.987466    0.969910    0.089721    0.849298    0.853301    0.989339    0.967949    0.998503    0.994012    0.974555    0.947771    1800        13.473054   0.061479    0.164166    31.106758  
[37m[36mINFO[0m[0m 03/19 11:42:31 | 0.839536    0.821516    0.984092    0.964093    0.115085    0.839536    0.821516    0.985075    0.967949    0.995509    0.988024    0.971692    0.936306    2000        14.970060   0.055561    0.170455    30.367674  
[37m[36mINFO[0m[0m 03/19 11:43:27 | 0.745577    0.740831    0.982483    0.956800    0.147777    0.745577    0.740831    0.981876    0.946581    0.991018    0.976048    0.974555    0.947771    2200        16.467066   0.043628    0.123497    30.570701  
[37m[36mINFO[0m[0m 03/19 11:44:25 | 0.751678    0.753056    0.942292    0.931600    0.239091    0.751678    0.753056    0.945096    0.931624    0.924401    0.928144    0.957379    0.935032    2400        17.964072   0.062678    0.133971    31.797234  
[37m[36mINFO[0m[0m 03/19 11:45:35 | 0.768761    0.770171    0.976980    0.952699    0.150290    0.768761    0.770171    0.976013    0.938034    0.985778    0.985030    0.969148    0.935032    2600        19.461078   0.069570    0.193753    31.266694  
[37m[36mINFO[0m[0m 03/19 11:46:32 | 0.871873    0.867971    0.989437    0.965189    0.110891    0.871873    0.867971    0.985075    0.950855    0.998503    0.988024    0.984733    0.956688    2800        20.958084   0.041192    0.125359    31.437779  
[37m[36mINFO[0m[0m 03/19 11:47:31 | 0.818182    0.811736    0.968414    0.945325    0.193107    0.818182    0.811736    0.974414    0.948718    0.982036    0.970060    0.948791    0.917197    3000        22.455090   0.040470    0.125209    33.846733  
[37m[36mINFO[0m[0m 03/19 11:48:44 | 0.873093    0.872861    0.992890    0.972321    0.089209    0.873093    0.872861    0.997868    0.970085    0.999251    0.994012    0.981552    0.952866    3200        23.952096   0.041663    0.209144    31.508245  
[37m[36mINFO[0m[0m 03/19 11:49:41 | 0.869433    0.887531    0.989804    0.961790    0.129961    0.869433    0.887531    0.992537    0.946581    0.998503    0.991018    0.978372    0.947771    3400        25.449102   0.039550    0.120418    33.144478  
[37m[36mINFO[0m[0m 03/19 11:50:40 | 0.825503    0.821516    0.989901    0.969596    0.119314    0.825503    0.821516    0.992004    0.952991    0.995509    0.994012    0.982188    0.961783    3600        26.946108   0.028799    0.133849    32.119334  
[37m[36mINFO[0m[0m 03/19 11:51:53 | 0.840146    0.833741    0.993297    0.974423    0.095363    0.840146    0.833741    0.989339    0.970085    0.998503    0.985030    0.992048    0.968153    3800        28.443114   0.032012    0.204697    32.139115  
[37m[36mINFO[0m[0m 03/19 11:52:51 | 0.859060    0.860636    0.994297    0.971861    0.100608    0.859060    0.860636    0.995203    0.963675    0.998503    0.985030    0.989186    0.966879    4000        29.940120   0.034695    0.125374    33.038180  
[37m[36mINFO[0m[0m 03/19 11:53:47 | 0.831605    0.836186    0.995750    0.972719    0.108085    0.831605    0.836186    0.998401    0.957265    0.997754    0.994012    0.991094    0.966879    4200        31.437126   0.028793    0.126683    30.735647  
[37m[36mINFO[0m[0m 03/19 11:55:01 | 0.841367    0.828851    0.992940    0.964889    0.117413    0.841367    0.828851    0.994670    0.946581    0.994012    0.985030    0.990140    0.963057    4400        32.934132   0.022788    0.206057    31.892937  
[37m[36mINFO[0m[0m 03/19 11:55:57 | 0.838926    0.809291    0.994191    0.971860    0.083069    0.838926    0.809291    0.994136    0.959402    0.999251    0.988024    0.989186    0.968153    4600        34.431138   0.035723    0.126303    31.551528  
[37m[36mINFO[0m[0m 03/19 11:56:54 | 0.821232    0.797066    0.992937    0.974849    0.100864    0.821232    0.797066    0.995203    0.974359    0.992515    0.982036    0.991094    0.968153    4800        35.928144   0.015430    0.121531    32.348137  
[37m[36mINFO[0m[0m 03/19 11:58:05 | 0.825503    0.848411    0.993440    0.976994    0.085621    0.825503    0.848411    0.991471    0.974359    0.997754    0.991018    0.991094    0.965605    5000        37.425150   0.026129    0.200134    30.706067  
[37m[36mINFO[0m[0m 03/19 11:58:05 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250319_11-31-26_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 11:58:06 | ---
[37m[36mINFO[0m[0m 03/19 11:58:06 | test-domain validation(oracle) = 86.943%
[37m[36mINFO[0m[0m 03/19 11:58:06 | training-domain validation(iid) = 82.550%
[37m[36mINFO[0m[0m 03/19 11:58:06 | last = 82.550%
[37m[36mINFO[0m[0m 03/19 11:58:06 | last (inD) = 97.699%
[37m[36mINFO[0m[0m 03/19 11:58:06 | training-domain validation (iid, inD) = 97.699%
[37m[36mINFO[0m[0m 03/19 11:58:06 | === Summary ===
[37m[36mINFO[0m[0m 03/19 11:58:06 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 1 --hparams_seed 19
[37m[36mINFO[0m[0m 03/19 11:58:06 | Unique name: 250319_11-31-26_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 11:58:06 | Out path: train_output/PACS/ERM/[0]/250319_11-31-26_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 11:58:06 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 11:58:06 | Dataset: PACS

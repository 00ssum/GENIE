[37m[36mINFO[0m[0m 03/19 02:49:22 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 1 --hparams_seed 2
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 2
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250319_02-49-22_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 1
	unique_name: 250319_02-49-22_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.0001126313085293539
	batch_size: 38
	weight_decay: 0.006639128805224463
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/19 02:49:22 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 02:49:22 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 02:49:22 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 02:49:22 | 
[37m[36mINFO[0m[0m 03/19 02:49:22 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 02:49:22 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 02:49:22 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 02:49:22 | Batch sizes for each domain: [0, 38, 38, 38] (total=114)
[37m[36mINFO[0m[0m 03/19 02:49:22 | steps-per-epoch for each domain: 49.37, 35.16, 82.74 -> min = 35.16
[37m[36mINFO[0m[0m 03/19 02:49:23 | # of params = 23522375
[37m[36mINFO[0m[0m 03/19 02:49:56 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 02:49:56 | 0.137279    0.183374    0.183989    0.184839    1.882660    0.137279    0.183374    0.190299    0.232906    0.178144    0.140719    0.183524    0.180892    0           0.000000    2.024798    1.649027    30.558142  
[37m[36mINFO[0m[0m 03/19 02:51:29 | 0.863331    0.870416    0.952414    0.954832    0.142954    0.863331    0.870416    0.947761    0.935897    0.990269    0.991018    0.919211    0.937580    200         5.688623    0.380998    0.313257    30.905333  
[37m[36mINFO[0m[0m 03/19 02:52:56 | 0.846248    0.848411    0.979278    0.967063    0.092992    0.846248    0.848411    0.979744    0.963675    0.996257    0.991018    0.961832    0.946497    400         11.377246   0.111426    0.275498    31.323975  
[37m[36mINFO[0m[0m 03/19 02:54:41 | 0.862721    0.855746    0.987927    0.976282    0.084943    0.862721    0.855746    0.990405    0.972222    0.998503    0.991018    0.974873    0.965605    600         17.065868   0.066083    0.369504    31.426561  
[37m[36mINFO[0m[0m 03/19 02:56:03 | 0.820012    0.809291    0.987247    0.966474    0.112282    0.820012    0.809291    0.992537    0.952991    0.994012    0.991018    0.975191    0.955414    800         22.754491   0.043666    0.258278    30.097031  
[37m[36mINFO[0m[0m 03/19 02:57:55 | 0.805979    0.787286    0.990291    0.968736    0.104810    0.805979    0.787286    0.989339    0.955128    0.997754    0.988024    0.983779    0.963057    1000        28.443114   0.035066    0.411061    29.920806  
[37m[36mINFO[0m[0m 03/19 02:59:17 | 0.839536    0.831296    0.985470    0.967885    0.106770    0.839536    0.831296    0.985075    0.950855    0.995509    0.991018    0.975827    0.961783    1200        34.131737   0.032137    0.255376    31.056104  
[37m[36mINFO[0m[0m 03/19 03:01:10 | 0.821843    0.823961    0.990428    0.967471    0.119572    0.821843    0.823961    0.987207    0.948718    0.997754    0.997006    0.986323    0.956688    1400        39.820359   0.030596    0.410310    30.721865  
[37m[36mINFO[0m[0m 03/19 03:02:34 | 0.863331    0.865526    0.996137    0.976278    0.084859    0.863331    0.865526    0.995203    0.963675    0.999251    0.997006    0.993957    0.968153    1600        45.508982   0.026394    0.265179    31.576756  
[37m[36mINFO[0m[0m 03/19 03:04:17 | 0.809030    0.816626    0.989571    0.972858    0.094501    0.809030    0.816626    0.984542    0.959402    0.996257    0.991018    0.987913    0.968153    1800        51.197605   0.022829    0.359983    30.347941  
[37m[36mINFO[0m[0m 03/19 03:05:48 | 0.785235    0.775061    0.992807    0.969599    0.106656    0.785235    0.775061    0.994136    0.961538    0.997006    0.988024    0.987277    0.959236    2000        56.886228   0.026885    0.294884    32.028476  
[37m[36mINFO[0m[0m 03/19 03:07:20 | 0.758389    0.738386    0.976172    0.956667    0.140596    0.758389    0.738386    0.977612    0.957265    0.986527    0.970060    0.964377    0.942675    2200        62.574850   0.029303    0.296088    32.900873  
[37m[36mINFO[0m[0m 03/19 03:09:02 | 0.806589    0.828851    0.994543    0.968453    0.104764    0.806589    0.828851    0.998934    0.961538    0.995509    0.982036    0.989186    0.961783    2400        68.263473   0.030880    0.354966    31.324264  
[37m[36mINFO[0m[0m 03/19 03:10:24 | 0.794997    0.816626    0.995460    0.970010    0.099012    0.794997    0.816626    0.994670    0.955128    0.997754    0.988024    0.993957    0.966879    2600        73.952096   0.032893    0.257734    30.050332  
[37m[36mINFO[0m[0m 03/19 03:12:14 | 0.756559    0.772616    0.993436    0.966036    0.108232    0.756559    0.772616    0.995203    0.946581    0.994012    0.991018    0.991094    0.960510    2800        79.640719   0.035613    0.401581    30.142973  
[37m[36mINFO[0m[0m 03/19 03:13:37 | 0.758999    0.760391    0.983575    0.960874    0.139313    0.758999    0.760391    0.974414    0.942308    0.994760    0.967066    0.981552    0.973248    3000        85.329341   0.043067    0.259467    30.576817  
[37m[36mINFO[0m[0m 03/19 03:15:31 | 0.748627    0.757946    0.995174    0.966879    0.096536    0.748627    0.757946    0.992537    0.957265    0.997754    0.979042    0.995229    0.964331    3200        91.017964   0.030463    0.408653    32.051790  
[37m[36mINFO[0m[0m 03/19 03:16:54 | 0.711409    0.726161    0.987089    0.964193    0.125011    0.711409    0.726161    0.983475    0.955128    0.994012    0.982036    0.983779    0.955414    3400        96.706587   0.026898    0.263913    30.225653  
[37m[36mINFO[0m[0m 03/19 03:18:35 | 0.744356    0.765281    0.989334    0.961179    0.145688    0.744356    0.765281    0.987740    0.935897    0.997754    0.982036    0.982506    0.965605    3600        102.395210  0.039375    0.351432    30.904655  
[37m[36mINFO[0m[0m 03/19 03:20:06 | 0.748627    0.779951    0.991881    0.964743    0.109624    0.748627    0.779951    0.992537    0.950855    0.995509    0.979042    0.987595    0.964331    3800        108.083832  0.047281    0.305133    29.763136  
[37m[36mINFO[0m[0m 03/19 03:21:33 | 0.699817    0.701711    0.980236    0.957352    0.131768    0.699817    0.701711    0.971748    0.946581    0.990269    0.970060    0.978690    0.955414    4000        113.772455  0.054670    0.277839    31.792184  
[37m[36mINFO[0m[0m 03/19 03:23:16 | 0.754118    0.762836    0.986627    0.948810    0.144702    0.754118    0.762836    0.986674    0.933761    0.991018    0.961078    0.982188    0.951592    4200        119.461078  0.043124    0.368067    29.506119  
[37m[36mINFO[0m[0m 03/19 03:24:38 | 0.744966    0.745721    0.986786    0.953192    0.135052    0.744966    0.745721    0.984009    0.927350    0.986527    0.964072    0.989822    0.968153    4400        125.149701  0.050009    0.257451    30.459475  
[37m[36mINFO[0m[0m 03/19 03:26:32 | 0.694326    0.687042    0.990733    0.964306    0.119602    0.694326    0.687042    0.990405    0.948718    0.991018    0.976048    0.990776    0.968153    4600        130.838323  0.054501    0.419111    30.327802  
[37m[36mINFO[0m[0m 03/19 03:27:54 | 0.740696    0.738386    0.988659    0.948628    0.144036    0.740696    0.738386    0.989872    0.931624    0.982784    0.946108    0.993321    0.968153    4800        136.526946  0.051851    0.257044    30.478282  
[37m[36mINFO[0m[0m 03/19 03:29:48 | 0.706528    0.721271    0.979409    0.949233    0.155030    0.706528    0.721271    0.972281    0.929487    0.985030    0.964072    0.980916    0.954140    5000        142.215569  0.075587    0.415806    30.804319  
[37m[36mINFO[0m[0m 03/19 03:29:48 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250319_02-49-22_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 03:29:49 | ---
[37m[36mINFO[0m[0m 03/19 03:29:49 | test-domain validation(oracle) = 86.333%
[37m[36mINFO[0m[0m 03/19 03:29:49 | training-domain validation(iid) = 86.272%
[37m[36mINFO[0m[0m 03/19 03:29:49 | last = 70.653%
[37m[36mINFO[0m[0m 03/19 03:29:49 | last (inD) = 94.923%
[37m[36mINFO[0m[0m 03/19 03:29:49 | training-domain validation (iid, inD) = 97.628%
[37m[36mINFO[0m[0m 03/19 03:29:49 | === Summary ===
[37m[36mINFO[0m[0m 03/19 03:29:49 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 1 --hparams_seed 2
[37m[36mINFO[0m[0m 03/19 03:29:49 | Unique name: 250319_02-49-22_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 03:29:49 | Out path: train_output/PACS/ERM/[0]/250319_02-49-22_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 03:29:49 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 03:29:49 | Dataset: PACS

[37m[36mINFO[0m[0m 03/18 18:47:09 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 0 --hparams_seed 5
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 5
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250318_18-47-09_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250318_18-47-09_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 1.6343540304927548e-05
	batch_size: 23
	weight_decay: 3.844578840738432e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/18 18:47:09 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 18:47:09 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 18:47:09 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 18:47:09 | 
[37m[36mINFO[0m[0m 03/18 18:47:09 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/18 18:47:09 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/18 18:47:09 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/18 18:47:09 | Batch sizes for each domain: [0, 23, 23, 23] (total=69)
[37m[36mINFO[0m[0m 03/18 18:47:09 | steps-per-epoch for each domain: 81.57, 58.09, 136.70 -> min = 58.09
[37m[36mINFO[0m[0m 03/18 18:47:11 | # of params = 23522375
[37m[36mINFO[0m[0m 03/18 18:47:45 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 18:47:45 | 0.203783    0.202934    0.264415    0.264635    1.865478    0.203783    0.202934    0.247335    0.279915    0.350299    0.320359    0.195611    0.193631    0           0.000000    1.985422    1.555518    33.050264  
[37m[36mINFO[0m[0m 03/18 18:49:03 | 0.821232    0.811736    0.934535    0.931113    0.186154    0.821232    0.811736    0.923241    0.931624    0.970060    0.961078    0.910305    0.900637    200         3.443114    0.360752    0.229134    31.929761  
[37m[36mINFO[0m[0m 03/18 18:50:09 | 0.863331    0.875306    0.971586    0.958964    0.112848    0.863331    0.875306    0.969616    0.965812    0.994760    0.976048    0.950382    0.935032    400         6.886228    0.118691    0.176732    30.530674  
[37m[36mINFO[0m[0m 03/18 18:51:31 | 0.848078    0.836186    0.981077    0.967629    0.109296    0.848078    0.836186    0.979211    0.970085    0.995509    0.985030    0.968511    0.947771    600         10.329341   0.069477    0.258164    30.422563  
[37m[36mINFO[0m[0m 03/18 18:52:48 | 0.854179    0.870416    0.980185    0.963909    0.144667    0.854179    0.870416    0.980277    0.961538    0.991766    0.976048    0.968511    0.954140    800         13.772455   0.046170    0.233589    30.737041  
[37m[36mINFO[0m[0m 03/18 18:53:54 | 0.839536    0.841076    0.989479    0.963658    0.114009    0.839536    0.841076    0.993603    0.970085    0.995509    0.982036    0.979326    0.938854    1000        17.215569   0.050079    0.178293    29.939734  
[37m[36mINFO[0m[0m 03/18 18:55:14 | 0.863331    0.880196    0.990789    0.965480    0.117521    0.863331    0.880196    0.991471    0.961538    0.997754    0.982036    0.983142    0.952866    1200        20.658683   0.030322    0.244467    30.718874  
[37m[36mINFO[0m[0m 03/18 18:56:35 | 0.859060    0.853301    0.994085    0.968316    0.115687    0.859060    0.853301    0.995203    0.963675    0.998503    0.982036    0.988550    0.959236    1400        24.101796   0.029064    0.244043    32.942977  
[37m[36mINFO[0m[0m 03/18 18:57:41 | 0.830995    0.819071    0.989766    0.960099    0.139465    0.830995    0.819071    0.992537    0.963675    0.997754    0.979042    0.979008    0.937580    1600        27.544910   0.023671    0.176458    30.151317  
[37m[36mINFO[0m[0m 03/18 18:59:01 | 0.867602    0.858191    0.992449    0.962934    0.138000    0.867602    0.858191    0.989339    0.965812    0.998503    0.979042    0.989504    0.943949    1800        30.988024   0.017512    0.246904    31.261085  
[37m[36mINFO[0m[0m 03/18 19:00:22 | 0.875534    0.882641    0.992722    0.971464    0.117941    0.875534    0.882641    0.994670    0.976496    0.991766    0.985030    0.991730    0.952866    2000        34.431138   0.020399    0.238046    32.923289  
[37m[36mINFO[0m[0m 03/18 19:01:30 | 0.862721    0.870416    0.995005    0.969756    0.124467    0.862721    0.870416    0.995736    0.978632    0.998503    0.979042    0.990776    0.951592    2200        37.874251   0.018403    0.178322    32.224956  
[37m[36mINFO[0m[0m 03/18 19:02:52 | 0.834045    0.841076    0.996707    0.967905    0.152879    0.834045    0.841076    0.996802    0.970085    1.000000    0.982036    0.993321    0.951592    2400        41.317365   0.011020    0.248383    32.622408  
[37m[36mINFO[0m[0m 03/18 19:04:12 | 0.848688    0.826406    0.995463    0.964758    0.126069    0.848688    0.826406    0.997335    0.961538    0.997006    0.976048    0.992048    0.956688    2600        44.760479   0.022668    0.243456    30.950006  
[37m[36mINFO[0m[0m 03/18 19:05:18 | 0.829774    0.809291    0.996632    0.965895    0.140794    0.829774    0.809291    0.997868    0.963675    0.997754    0.976048    0.994275    0.957962    2800        48.203593   0.012482    0.177311    30.472817  
[37m[36mINFO[0m[0m 03/18 19:06:28 | 0.849298    0.836186    0.998868    0.969178    0.139787    0.849298    0.836186    0.999467    0.970085    1.000000    0.982036    0.997137    0.955414    3000        51.646707   0.010479    0.185599    32.860235  
[37m[36mINFO[0m[0m 03/18 19:07:36 | 0.836486    0.826406    0.991391    0.959066    0.223994    0.836486    0.826406    0.993070    0.957265    0.997006    0.967066    0.984097    0.952866    3200        55.089820   0.004838    0.182794    31.906168  
[37m[36mINFO[0m[0m 03/18 19:09:15 | 0.875534    0.877751    0.997627    0.969750    0.111694    0.875534    0.877751    0.998401    0.965812    0.999251    0.988024    0.995229    0.955414    3400        58.532934   0.010237    0.337311    31.761159  
[37m[36mINFO[0m[0m 03/18 19:10:21 | 0.854179    0.867971    0.998690    0.968043    0.146985    0.854179    0.867971    0.998934    0.972222    1.000000    0.979042    0.997137    0.952866    3600        61.976048   0.005063    0.176976    29.997212  
[37m[36mINFO[0m[0m 03/18 19:12:05 | 0.827334    0.853301    0.993343    0.968764    0.139718    0.827334    0.853301    0.994136    0.967949    0.999251    0.988024    0.986641    0.950318    3800        65.419162   0.009594    0.361773    31.622043  
[37m[36mINFO[0m[0m 03/18 19:13:14 | 0.840146    0.836186    0.993330    0.956496    0.191312    0.840146    0.836186    0.995203    0.957265    0.994012    0.958084    0.990776    0.954140    4000        68.862275   0.010916    0.181816    33.220083  
[37m[36mINFO[0m[0m 03/18 19:14:59 | 0.844417    0.853301    0.998550    0.971726    0.138137    0.844417    0.853301    0.999467    0.970085    1.000000    0.982036    0.996183    0.963057    4200        72.305389   0.007118    0.358756    32.624653  
[37m[36mINFO[0m[0m 03/18 19:16:09 | 0.848078    0.860636    0.998793    0.968314    0.149734    0.848078    0.860636    0.998401    0.959402    0.999251    0.985030    0.998728    0.960510    4400        75.748503   0.005173    0.183455    33.973861  
[37m[36mINFO[0m[0m 03/18 19:17:52 | 0.858450    0.863081    0.998690    0.969302    0.155416    0.858450    0.863081    0.998934    0.961538    1.000000    0.982036    0.997137    0.964331    4600        79.191617   0.002743    0.358367    30.702350  
[37m[36mINFO[0m[0m 03/18 19:19:00 | 0.847468    0.865526    0.995887    0.972877    0.135178    0.847468    0.865526    0.995203    0.978632    0.998503    0.982036    0.993957    0.957962    4800        82.634731   0.016516    0.183877    31.222403  
[37m[36mINFO[0m[0m 03/18 19:20:35 | 0.815131    0.836186    0.996664    0.968153    0.173982    0.815131    0.836186    0.992537    0.957265    1.000000    0.979042    0.997455    0.968153    5000        86.077844   0.006084    0.320529    30.951608  
[37m[36mINFO[0m[0m 03/18 19:20:35 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250318_18-47-09_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 19:20:36 | ---
[37m[36mINFO[0m[0m 03/18 19:20:36 | test-domain validation(oracle) = 87.553%
[37m[36mINFO[0m[0m 03/18 19:20:36 | training-domain validation(iid) = 84.747%
[37m[36mINFO[0m[0m 03/18 19:20:36 | last = 81.513%
[37m[36mINFO[0m[0m 03/18 19:20:36 | last (inD) = 96.815%
[37m[36mINFO[0m[0m 03/18 19:20:36 | training-domain validation (iid, inD) = 97.288%
[37m[36mINFO[0m[0m 03/18 19:20:36 | === Summary ===
[37m[36mINFO[0m[0m 03/18 19:20:36 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 0 --hparams_seed 5
[37m[36mINFO[0m[0m 03/18 19:20:36 | Unique name: 250318_18-47-09_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 19:20:36 | Out path: train_output/PACS/ERM/[0]/250318_18-47-09_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 19:20:36 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 19:20:36 | Dataset: PACS

[37m[36mINFO[0m[0m 03/19 07:28:52 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 1 --hparams_seed 11
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 11
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250319_07-28-52_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 1
	unique_name: 250319_07-28-52_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5.340583028754034e-05
	batch_size: 10
	weight_decay: 2.5000172438864113e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/19 07:28:52 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 07:28:52 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 07:28:52 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 07:28:52 | 
[37m[36mINFO[0m[0m 03/19 07:28:52 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 07:28:52 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 07:28:52 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 07:28:52 | Batch sizes for each domain: [0, 10, 10, 10] (total=30)
[37m[36mINFO[0m[0m 03/19 07:28:52 | steps-per-epoch for each domain: 187.60, 133.60, 314.40 -> min = 133.60
[37m[36mINFO[0m[0m 03/19 07:28:53 | # of params = 23522375
[37m[36mINFO[0m[0m 03/19 07:29:25 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 07:29:25 | 0.153752    0.171149    0.189563    0.195168    1.969287    0.153752    0.171149    0.191898    0.226496    0.211078    0.203593    0.165712    0.155414    0           0.000000    1.997427    0.993935    31.264768  
[37m[36mINFO[0m[0m 03/19 07:30:21 | 0.780354    0.782396    0.902168    0.900476    0.273107    0.780354    0.782396    0.894989    0.884615    0.977545    0.976048    0.833969    0.840764    200         1.497006    0.481270    0.122497    30.916131  
[37m[36mINFO[0m[0m 03/19 07:31:28 | 0.771202    0.779951    0.922870    0.926583    0.202352    0.771202    0.779951    0.920576    0.914530    0.958084    0.976048    0.889949    0.889172    400         2.994012    0.211779    0.185280    30.524054  
[37m[36mINFO[0m[0m 03/19 07:32:25 | 0.820622    0.819071    0.943767    0.939226    0.195202    0.820622    0.819071    0.942964    0.935897    0.985030    0.976048    0.903308    0.905732    600         4.491018    0.199360    0.128818    30.571345  
[37m[36mINFO[0m[0m 03/19 07:33:24 | 0.815131    0.799511    0.966963    0.956244    0.133168    0.815131    0.799511    0.955224    0.938034    0.994012    0.988024    0.951654    0.942675    800         5.988024    0.131132    0.131473    33.299364  
[37m[36mINFO[0m[0m 03/19 07:34:31 | 0.820622    0.838631    0.968119    0.958087    0.125081    0.820622    0.838631    0.967484    0.952991    0.994760    0.976048    0.942112    0.945223    1000        7.485030    0.098730    0.174554    31.916185  
[37m[36mINFO[0m[0m 03/19 07:35:28 | 0.838316    0.833741    0.975833    0.965651    0.108451    0.838316    0.833741    0.972814    0.961538    0.994760    0.994012    0.959924    0.941401    1200        8.982036    0.093157    0.136451    30.177034  
[37m[36mINFO[0m[0m 03/19 07:36:28 | 0.844417    0.831296    0.980032    0.955978    0.106267    0.844417    0.831296    0.984009    0.959402    0.997754    0.976048    0.958333    0.932484    1400        10.479042   0.068463    0.139679    31.455218  
[37m[36mINFO[0m[0m 03/19 07:37:40 | 0.757169    0.726161    0.969515    0.955237    0.146232    0.757169    0.726161    0.973881    0.940171    0.984281    0.979042    0.950382    0.946497    1600        11.976048   0.060116    0.194258    33.101235  
[37m[36mINFO[0m[0m 03/19 07:38:40 | 0.851129    0.870416    0.983338    0.975008    0.088707    0.851129    0.870416    0.981876    0.972222    0.993263    0.991018    0.974873    0.961783    1800        13.473054   0.066754    0.138852    32.483994  
[37m[36mINFO[0m[0m 03/19 07:39:37 | 0.867602    0.850856    0.981957    0.968325    0.104078    0.867602    0.850856    0.974947    0.961538    0.997006    0.988024    0.973919    0.955414    2000        14.970060   0.058612    0.128317    31.672620  
[37m[36mINFO[0m[0m 03/19 07:40:48 | 0.779134    0.775061    0.989929    0.968163    0.092785    0.779134    0.775061    0.991471    0.955128    0.993263    0.985030    0.985051    0.964331    2200        16.467066   0.055122    0.190888    32.374739  
[37m[36mINFO[0m[0m 03/19 07:41:46 | 0.886516    0.887531    0.986551    0.977403    0.074237    0.886516    0.887531    0.988806    0.963675    0.988024    0.994012    0.982824    0.974522    2400        17.964072   0.044977    0.136541    31.032274  
[37m[36mINFO[0m[0m 03/19 07:42:42 | 0.835265    0.801956    0.981860    0.957520    0.141371    0.835265    0.801956    0.980810    0.942308    0.996257    0.985030    0.968511    0.945223    2600        19.461078   0.037211    0.123370    30.809468  
[37m[36mINFO[0m[0m 03/19 07:43:44 | 0.813301    0.794621    0.993415    0.977129    0.073127    0.813301    0.794621    0.994670    0.967949    0.999251    0.994012    0.986323    0.969427    2800        20.958084   0.030205    0.161000    30.317519  
[37m[36mINFO[0m[0m 03/19 07:44:52 | 0.799878    0.806846    0.989121    0.967760    0.096229    0.799878    0.806846    0.990938    0.955128    0.995509    0.994012    0.980916    0.954140    3000        22.455090   0.036544    0.177871    31.654018  
[37m[36mINFO[0m[0m 03/19 07:45:47 | 0.814521    0.845966    0.974843    0.956790    0.144603    0.814521    0.845966    0.976546    0.948718    0.979790    0.970060    0.968193    0.951592    3200        23.952096   0.025946    0.122949    30.769484  
[37m[36mINFO[0m[0m 03/19 07:46:45 | 0.846858    0.872861    0.991322    0.972437    0.090713    0.846858    0.872861    0.995203    0.967949    0.996257    0.985030    0.982506    0.964331    3400        25.449102   0.036310    0.124935    32.935935  
[37m[36mINFO[0m[0m 03/19 07:47:55 | 0.857840    0.867971    0.994085    0.973012    0.092643    0.857840    0.867971    0.995203    0.972222    0.998503    0.985030    0.988550    0.961783    3600        26.946108   0.028757    0.191580    32.018033  
[37m[36mINFO[0m[0m 03/19 07:48:55 | 0.791946    0.794621    0.990319    0.964766    0.123658    0.791946    0.794621    0.987740    0.955128    0.996257    0.985030    0.986959    0.954140    3800        28.443114   0.023578    0.129916    33.470314  
[37m[36mINFO[0m[0m 03/19 07:49:51 | 0.870043    0.863081    0.990388    0.963340    0.127504    0.870043    0.863081    0.983475    0.946581    0.998503    0.988024    0.989186    0.955414    4000        29.940120   0.031082    0.123281    31.516175  
[37m[36mINFO[0m[0m 03/19 07:51:03 | 0.856620    0.858191    0.990041    0.972711    0.082787    0.856620    0.858191    0.993603    0.963675    0.994012    0.985030    0.982506    0.969427    4200        31.437126   0.020174    0.201492    32.244570  
[37m[36mINFO[0m[0m 03/19 07:52:01 | 0.814521    0.770171    0.977567    0.954105    0.163672    0.814521    0.770171    0.986141    0.950855    0.974551    0.970060    0.972010    0.941401    4400        32.934132   0.022143    0.134229    30.455683  
[37m[36mINFO[0m[0m 03/19 07:52:57 | 0.875534    0.870416    0.997381    0.978540    0.067386    0.875534    0.870416    0.998934    0.965812    0.999251    0.994012    0.993957    0.975796    4600        34.431138   0.021558    0.126040    30.989460  
[37m[36mINFO[0m[0m 03/19 07:54:09 | 0.823673    0.814181    0.992725    0.969865    0.099827    0.823673    0.814181    0.993070    0.963675    0.994012    0.979042    0.991094    0.966879    4800        35.928144   0.017898    0.205934    31.140024  
[37m[36mINFO[0m[0m 03/19 07:55:06 | 0.833435    0.811736    0.994646    0.974436    0.082861    0.833435    0.811736    0.995203    0.976496    0.997006    0.985030    0.991730    0.961783    5000        37.425150   0.018719    0.131406    30.345559  
[37m[36mINFO[0m[0m 03/19 07:55:06 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250319_07-28-52_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 07:55:07 | ---
[37m[36mINFO[0m[0m 03/19 07:55:07 | test-domain validation(oracle) = 88.652%
[37m[36mINFO[0m[0m 03/19 07:55:07 | training-domain validation(iid) = 87.553%
[37m[36mINFO[0m[0m 03/19 07:55:07 | last = 83.344%
[37m[36mINFO[0m[0m 03/19 07:55:07 | last (inD) = 97.444%
[37m[36mINFO[0m[0m 03/19 07:55:07 | training-domain validation (iid, inD) = 97.854%
[37m[36mINFO[0m[0m 03/19 07:55:07 | === Summary ===
[37m[36mINFO[0m[0m 03/19 07:55:07 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 1 --hparams_seed 11
[37m[36mINFO[0m[0m 03/19 07:55:07 | Unique name: 250319_07-28-52_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 07:55:07 | Out path: train_output/PACS/ERM/[0]/250319_07-28-52_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 07:55:07 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 07:55:07 | Dataset: PACS

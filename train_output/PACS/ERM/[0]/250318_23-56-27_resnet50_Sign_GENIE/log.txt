[37m[36mINFO[0m[0m 03/18 23:56:27 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 0 --hparams_seed 16
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 16
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250318_23-56-27_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250318_23-56-27_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 4.249952708249365e-05
	batch_size: 17
	weight_decay: 9.786966598736845e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/18 23:56:27 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 23:56:27 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 23:56:27 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 23:56:27 | 
[37m[36mINFO[0m[0m 03/18 23:56:28 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/18 23:56:28 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/18 23:56:28 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/18 23:56:28 | Batch sizes for each domain: [0, 17, 17, 17] (total=51)
[37m[36mINFO[0m[0m 03/18 23:56:28 | steps-per-epoch for each domain: 110.35, 78.59, 184.94 -> min = 78.59
[37m[36mINFO[0m[0m 03/18 23:56:29 | # of params = 23522375
[37m[36mINFO[0m[0m 03/18 23:57:00 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 23:57:00 | 0.205613    0.210269    0.255777    0.264677    1.888166    0.205613    0.210269    0.246269    0.303419    0.345808    0.317365    0.175254    0.173248    0           0.000000    1.949490    0.999223    30.229978  
[37m[36mINFO[0m[0m 03/18 23:58:02 | 0.784015    0.784841    0.951505    0.954698    0.142076    0.784015    0.784841    0.930704    0.946581    0.992515    0.985030    0.931298    0.932484    200         2.544910    0.396929    0.143607    33.081830  
[37m[36mINFO[0m[0m 03/18 23:59:14 | 0.841367    0.823961    0.959120    0.945184    0.157097    0.841367    0.823961    0.953625    0.942308    0.983533    0.976048    0.940204    0.917197    400         5.089820    0.127028    0.198246    32.721169  
[37m[36mINFO[0m[0m 03/19 00:00:29 | 0.837706    0.841076    0.967743    0.955542    0.143014    0.837706    0.841076    0.957356    0.957265    0.993263    0.973054    0.952608    0.936306    600         7.634731    0.105281    0.210312    32.813842  
[37m[36mINFO[0m[0m 03/19 00:01:30 | 0.835265    0.838631    0.982527    0.969738    0.103307    0.835265    0.838631    0.977612    0.963675    0.997006    0.985030    0.972964    0.960510    800         10.179641   0.067499    0.145153    32.448481  
[37m[36mINFO[0m[0m 03/19 00:02:31 | 0.818792    0.816626    0.983094    0.960522    0.124016    0.818792    0.816626    0.981876    0.959402    0.994760    0.982036    0.972646    0.940127    1000        12.724551   0.069272    0.143686    32.383235  
[37m[36mINFO[0m[0m 03/19 00:03:45 | 0.860281    0.889976    0.983914    0.962371    0.126391    0.860281    0.889976    0.983475    0.963675    0.996257    0.982036    0.972010    0.941401    1200        15.269461   0.044948    0.204955    32.545508  
[37m[36mINFO[0m[0m 03/19 00:04:57 | 0.830995    0.836186    0.992882    0.972736    0.098838    0.830995    0.836186    0.994136    0.972222    0.998503    0.988024    0.986005    0.957962    1400        17.814371   0.033020    0.200996    31.697796  
[37m[36mINFO[0m[0m 03/19 00:05:59 | 0.843197    0.843521    0.979765    0.958960    0.142111    0.843197    0.843521    0.977612    0.957265    0.994760    0.982036    0.966921    0.937580    1600        20.359281   0.029228    0.143739    33.103063  
[37m[36mINFO[0m[0m 03/19 00:07:00 | 0.842587    0.841076    0.981306    0.953528    0.173833    0.842587    0.841076    0.970149    0.942308    0.994760    0.973054    0.979008    0.945223    1800        22.904192   0.026855    0.151788    31.084717  
[37m[36mINFO[0m[0m 03/19 00:08:14 | 0.838926    0.819071    0.988798    0.961481    0.160947    0.838926    0.819071    0.984542    0.944444    0.997754    0.982036    0.984097    0.957962    2000        25.449102   0.030831    0.202757    33.104157  
[37m[36mINFO[0m[0m 03/19 00:09:24 | 0.867602    0.867971    0.994615    0.972164    0.116293    0.867602    0.867971    0.995203    0.976496    0.998503    0.982036    0.990140    0.957962    2200        27.994012   0.032471    0.195474    31.067558  
[37m[36mINFO[0m[0m 03/19 00:10:23 | 0.832825    0.841076    0.993804    0.970740    0.113968    0.832825    0.841076    0.995203    0.972222    0.999251    0.982036    0.986959    0.957962    2400        30.538922   0.026860    0.142633    30.775418  
[37m[36mINFO[0m[0m 03/19 00:11:23 | 0.838316    0.845966    0.993624    0.966897    0.139942    0.838316    0.845966    0.994136    0.972222    0.998503    0.973054    0.988232    0.955414    2600        33.083832   0.016840    0.145704    30.654152  
[37m[36mINFO[0m[0m 03/19 00:12:35 | 0.859060    0.877751    0.997094    0.971315    0.098812    0.859060    0.877751    0.997868    0.976496    0.998503    0.982036    0.994911    0.955414    2800        35.628743   0.018909    0.205379    30.400728  
[37m[36mINFO[0m[0m 03/19 00:13:45 | 0.790116    0.821516    0.990964    0.961367    0.145793    0.790116    0.821516    0.991471    0.974359    0.997006    0.967066    0.984415    0.942675    3000        38.173653   0.019622    0.200172    30.070205  
[37m[36mINFO[0m[0m 03/19 00:14:45 | 0.865162    0.867971    0.994403    0.961796    0.144455    0.865162    0.867971    0.993070    0.959402    1.000000    0.982036    0.990140    0.943949    3200        40.718563   0.011056    0.142537    31.540634  
[37m[36mINFO[0m[0m 03/19 00:15:47 | 0.863331    0.865526    0.995931    0.969466    0.099935    0.863331    0.865526    0.998401    0.972222    0.999251    0.982036    0.990140    0.954140    3400        43.263473   0.022110    0.144299    33.335536  
[37m[36mINFO[0m[0m 03/19 00:16:48 | 0.837706    0.828851    0.988841    0.960232    0.172312    0.837706    0.828851    0.988806    0.952991    0.997754    0.985030    0.979962    0.942675    3600        45.808383   0.011550    0.142286    32.250008  
[37m[36mINFO[0m[0m 03/19 00:17:48 | 0.856010    0.841076    0.998298    0.972141    0.113952    0.856010    0.841076    0.997868    0.972222    0.999251    0.976048    0.997774    0.968153    3800        48.353293   0.019039    0.150571    29.959836  
[37m[36mINFO[0m[0m 03/19 00:18:51 | 0.835876    0.848411    0.997696    0.970441    0.136707    0.835876    0.848411    0.996269    0.967949    1.000000    0.979042    0.996819    0.964331    4000        50.898204   0.007651    0.153757    32.165293  
[37m[36mINFO[0m[0m 03/19 00:19:49 | 0.840757    0.836186    0.996171    0.968752    0.158193    0.840757    0.836186    0.996802    0.965812    0.997754    0.985030    0.993957    0.955414    4200        53.443114   0.006576    0.138714    30.518401  
[37m[36mINFO[0m[0m 03/19 00:21:04 | 0.854790    0.863081    0.997839    0.964067    0.146106    0.854790    0.863081    0.997335    0.959402    1.000000    0.985030    0.996183    0.947771    4400        55.988024   0.011391    0.215643    31.953384  
[37m[36mINFO[0m[0m 03/19 00:22:03 | 0.855400    0.867971    0.998157    0.968891    0.128343    0.855400    0.867971    0.998401    0.967949    0.999251    0.982036    0.996819    0.956688    4600        58.532934   0.007685    0.139873    31.498232  
[37m[36mINFO[0m[0m 03/19 00:23:02 | 0.874314    0.855746    0.998690    0.969613    0.104418    0.874314    0.855746    0.998934    0.967949    1.000000    0.988024    0.997137    0.952866    4800        61.077844   0.016922    0.140922    30.273047  
[37m[36mINFO[0m[0m 03/19 00:24:08 | 0.860281    0.843521    0.998619    0.970867    0.116980    0.860281    0.843521    0.999467    0.972222    0.999251    0.976048    0.997137    0.964331    5000        63.622754   0.012088    0.158785    34.419885  
[37m[36mINFO[0m[0m 03/19 00:24:08 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250318_23-56-27_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 00:24:10 | ---
[37m[36mINFO[0m[0m 03/19 00:24:10 | test-domain validation(oracle) = 86.028%
[37m[36mINFO[0m[0m 03/19 00:24:10 | training-domain validation(iid) = 83.099%
[37m[36mINFO[0m[0m 03/19 00:24:10 | last = 86.028%
[37m[36mINFO[0m[0m 03/19 00:24:10 | last (inD) = 97.087%
[37m[36mINFO[0m[0m 03/19 00:24:10 | training-domain validation (iid, inD) = 97.274%
[37m[36mINFO[0m[0m 03/19 00:24:10 | === Summary ===
[37m[36mINFO[0m[0m 03/19 00:24:10 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 0 --hparams_seed 16
[37m[36mINFO[0m[0m 03/19 00:24:10 | Unique name: 250318_23-56-27_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 00:24:10 | Out path: train_output/PACS/ERM/[0]/250318_23-56-27_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 00:24:10 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 00:24:10 | Dataset: PACS

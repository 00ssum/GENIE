[37m[36mINFO[0m[0m 03/18 22:08:57 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 0 --hparams_seed 12
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 12
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250318_22-08-57_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250318_22-08-57_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00012111338094255871
	batch_size: 9
	weight_decay: 1.821145631101786e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/18 22:08:57 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 22:08:57 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 22:08:57 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 22:08:57 | 
[37m[36mINFO[0m[0m 03/18 22:08:57 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/18 22:08:57 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/18 22:08:57 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/18 22:08:57 | Batch sizes for each domain: [0, 9, 9, 9] (total=27)
[37m[36mINFO[0m[0m 03/18 22:08:57 | steps-per-epoch for each domain: 208.44, 148.44, 349.33 -> min = 148.44
[37m[36mINFO[0m[0m 03/18 22:08:58 | # of params = 23522375
[37m[36mINFO[0m[0m 03/18 22:09:30 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 22:09:30 | 0.174497    0.178484    0.217373    0.230068    2.001464    0.174497    0.178484    0.253198    0.288462    0.182635    0.182635    0.216285    0.219108    0           0.000000    2.035655    0.902537    31.020222  
[37m[36mINFO[0m[0m 03/18 22:10:23 | 0.784015    0.787286    0.920491    0.925986    0.200427    0.784015    0.787286    0.900320    0.910256    0.979790    0.967066    0.881361    0.900637    200         1.347305    0.616639    0.111654    30.459532  
[37m[36mINFO[0m[0m 03/18 22:11:19 | 0.725442    0.709046    0.908149    0.906254    0.246963    0.725442    0.709046    0.865672    0.893162    0.974551    0.958084    0.884224    0.867516    400         2.694611    0.262783    0.126904    30.467711  
[37m[36mINFO[0m[0m 03/18 22:12:12 | 0.821232    0.823961    0.952126    0.942597    0.175289    0.821232    0.823961    0.950959    0.950855    0.973802    0.952096    0.931616    0.924841    600         4.041916    0.204420    0.115479    30.306098  
[37m[36mINFO[0m[0m 03/18 22:13:05 | 0.760830    0.767726    0.949201    0.946180    0.170977    0.760830    0.767726    0.945629    0.961538    0.967814    0.961078    0.934160    0.915924    800         5.389222    0.169585    0.111406    31.018965  
[37m[36mINFO[0m[0m 03/18 22:14:02 | 0.726052    0.726161    0.940926    0.927675    0.226366    0.726052    0.726161    0.917377    0.912393    0.984281    0.961078    0.921120    0.909554    1000        6.736527    0.125297    0.117745    32.689617  
[37m[36mINFO[0m[0m 03/18 22:14:55 | 0.845638    0.877751    0.975795    0.961236    0.127121    0.845638    0.877751    0.977079    0.965812    0.991018    0.979042    0.959288    0.938854    1200        8.083832    0.120868    0.116381    30.259419  
[37m[36mINFO[0m[0m 03/18 22:15:50 | 0.779744    0.787286    0.981033    0.960349    0.134302    0.779744    0.787286    0.982409    0.955128    0.990269    0.973054    0.970420    0.952866    1400        9.431138    0.109348    0.121250    30.095093  
[37m[36mINFO[0m[0m 03/18 22:16:44 | 0.748627    0.784841    0.974328    0.952953    0.141985    0.748627    0.784841    0.958422    0.938034    0.997006    0.973054    0.967557    0.947771    1600        10.778443   0.089404    0.121754    29.773190  
[37m[36mINFO[0m[0m 03/18 22:17:38 | 0.771202    0.767726    0.982031    0.959524    0.136792    0.771202    0.767726    0.982409    0.959402    0.993263    0.979042    0.970420    0.940127    1800        12.125749   0.065425    0.114608    31.253770  
[37m[36mINFO[0m[0m 03/18 22:18:31 | 0.783405    0.777506    0.938580    0.913749    0.256374    0.783405    0.777506    0.925906    0.893162    0.973802    0.955090    0.916031    0.892994    2000        13.473054   0.082270    0.111640    30.903733  
[37m[36mINFO[0m[0m 03/18 22:19:25 | 0.812081    0.823961    0.977045    0.961934    0.153728    0.812081    0.823961    0.980810    0.961538    0.993263    0.979042    0.957061    0.945223    2200        14.820359   0.078890    0.113366    31.106679  
[37m[36mINFO[0m[0m 03/18 22:20:19 | 0.826113    0.845966    0.986957    0.964764    0.110540    0.826113    0.845966    0.989872    0.974359    0.993263    0.967066    0.977735    0.952866    2400        16.167665   0.056025    0.111878    31.477010  
[37m[36mINFO[0m[0m 03/18 22:21:13 | 0.805369    0.826406    0.982994    0.958802    0.113949    0.805369    0.826406    0.988273    0.959402    0.992515    0.973054    0.968193    0.943949    2600        17.514970   0.060922    0.111444    32.410836  
[37m[36mINFO[0m[0m 03/18 22:22:08 | 0.777303    0.777506    0.984721    0.960928    0.141669    0.777303    0.777506    0.987207    0.967949    0.991766    0.967066    0.975191    0.947771    2800        18.862275   0.053896    0.118685    30.379493  
[37m[36mINFO[0m[0m 03/18 22:23:04 | 0.760830    0.779951    0.971688    0.941175    0.168257    0.760830    0.779951    0.971215    0.927350    0.979790    0.970060    0.964059    0.926115    3000        20.209581   0.059946    0.128047    30.968627  
[37m[36mINFO[0m[0m 03/18 22:24:00 | 0.846248    0.841076    0.982333    0.956109    0.178825    0.846248    0.841076    0.988273    0.967949    0.996257    0.964072    0.962468    0.936306    3200        21.556886   0.041683    0.123129    30.799803  
[37m[36mINFO[0m[0m 03/18 22:25:00 | 0.860281    0.867971    0.989414    0.967331    0.135116    0.860281    0.867971    0.990938    0.970085    0.999251    0.979042    0.978053    0.952866    3400        22.904192   0.042116    0.141590    32.356686  
[37m[36mINFO[0m[0m 03/18 22:26:05 | 0.829774    0.845966    0.988052    0.959655    0.152252    0.829774    0.845966    0.987207    0.967949    0.994760    0.967066    0.982188    0.943949    3600        24.251497   0.027199    0.165517    31.903395  
[37m[36mINFO[0m[0m 03/18 22:27:12 | 0.768151    0.770171    0.978962    0.948381    0.171254    0.768151    0.770171    0.979211    0.948718    0.972305    0.946108    0.985369    0.950318    3800        25.598802   0.065887    0.179821    30.526259  
[37m[36mINFO[0m[0m 03/18 22:28:06 | 0.810250    0.823961    0.984634    0.962214    0.136368    0.810250    0.823961    0.988273    0.970085    0.997754    0.970060    0.967875    0.946497    4000        26.946108   0.052461    0.120473    30.491915  
[37m[36mINFO[0m[0m 03/18 22:29:04 | 0.856620    0.867971    0.993549    0.969593    0.125072    0.856620    0.867971    0.992004    0.972222    0.998503    0.976048    0.990140    0.960510    4200        28.293413   0.037089    0.125250    32.982591  
[37m[36mINFO[0m[0m 03/18 22:30:13 | 0.800488    0.814181    0.994082    0.962899    0.120816    0.800488    0.814181    0.994670    0.959402    0.997754    0.970060    0.989822    0.959236    4400        29.640719   0.030805    0.178793    32.748935  
[37m[36mINFO[0m[0m 03/18 22:31:22 | 0.826724    0.833741    0.992429    0.963337    0.122495    0.826724    0.833741    0.995736    0.965812    1.000000    0.970060    0.981552    0.954140    4600        30.988024   0.028958    0.187083    32.190467  
[37m[36mINFO[0m[0m 03/18 22:32:20 | 0.857230    0.838631    0.993418    0.965484    0.146891    0.857230    0.838631    0.996269    0.970085    0.999251    0.976048    0.984733    0.950318    4800        32.335329   0.022455    0.130907    30.825182  
[37m[36mINFO[0m[0m 03/18 22:33:14 | 0.828554    0.826406    0.990995    0.965330    0.140032    0.828554    0.826406    0.991471    0.957265    0.995509    0.982036    0.986005    0.956688    5000        33.682635   0.034622    0.120671    30.715995  
[37m[36mINFO[0m[0m 03/18 22:33:14 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250318_22-08-57_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 22:33:16 | ---
[37m[36mINFO[0m[0m 03/18 22:33:16 | test-domain validation(oracle) = 84.564%
[37m[36mINFO[0m[0m 03/18 22:33:16 | training-domain validation(iid) = 85.662%
[37m[36mINFO[0m[0m 03/18 22:33:16 | last = 82.855%
[37m[36mINFO[0m[0m 03/18 22:33:16 | last (inD) = 96.533%
[37m[36mINFO[0m[0m 03/18 22:33:16 | training-domain validation (iid, inD) = 96.959%
[37m[36mINFO[0m[0m 03/18 22:33:16 | === Summary ===
[37m[36mINFO[0m[0m 03/18 22:33:16 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 0 --hparams_seed 12
[37m[36mINFO[0m[0m 03/18 22:33:16 | Unique name: 250318_22-08-57_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 22:33:16 | Out path: train_output/PACS/ERM/[0]/250318_22-08-57_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 22:33:16 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 22:33:16 | Dataset: PACS

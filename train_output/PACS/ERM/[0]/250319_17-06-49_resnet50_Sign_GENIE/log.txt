[37m[36mINFO[0m[0m 03/19 17:06:49 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 2 --hparams_seed 11
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 11
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250319_17-06-49_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 2
	unique_name: 250319_17-06-49_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00030079935666912124
	batch_size: 16
	weight_decay: 6.276702207693199e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/19 17:06:49 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 17:06:49 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 17:06:49 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 17:06:49 | 
[37m[36mINFO[0m[0m 03/19 17:06:49 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 17:06:49 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 17:06:49 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 17:06:49 | Batch sizes for each domain: [0, 16, 16, 16] (total=48)
[37m[36mINFO[0m[0m 03/19 17:06:49 | steps-per-epoch for each domain: 117.25, 83.50, 196.50 -> min = 83.50
[37m[36mINFO[0m[0m 03/19 17:06:51 | # of params = 23522375
[37m[36mINFO[0m[0m 03/19 17:07:24 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 17:07:24 | 0.190970    0.185819    0.177233    0.186938    1.897240    0.190970    0.185819    0.208955    0.228632    0.126497    0.134731    0.196247    0.197452    0           0.000000    2.055248    1.237101    31.748655  
[37m[36mINFO[0m[0m 03/19 17:08:26 | 0.842587    0.838631    0.943439    0.935684    0.168753    0.842587    0.838631    0.921642    0.920940    0.982784    0.988024    0.925891    0.898089    200         2.395210    0.405826    0.148015    32.243834  
[37m[36mINFO[0m[0m 03/19 17:09:27 | 0.834655    0.845966    0.954398    0.945347    0.156122    0.834655    0.845966    0.939232    0.948718    0.985030    0.979042    0.938931    0.908280    400         4.790419    0.152515    0.147054    31.591913  
[37m[36mINFO[0m[0m 03/19 17:10:37 | 0.850519    0.848411    0.975521    0.957722    0.132945    0.850519    0.848411    0.977079    0.963675    0.994012    0.991018    0.955471    0.918471    600         7.185629    0.090726    0.187131    33.039091  
[37m[36mINFO[0m[0m 03/19 17:11:39 | 0.810250    0.833741    0.985401    0.969791    0.095153    0.810250    0.833741    0.986141    0.985043    0.995509    0.988024    0.974555    0.936306    800         9.580838    0.069426    0.153458    31.527660  
[37m[36mINFO[0m[0m 03/19 17:12:55 | 0.799268    0.809291    0.977337    0.949311    0.141737    0.799268    0.809291    0.985075    0.959402    0.981287    0.970060    0.965649    0.918471    1000        11.976048   0.070131    0.209994    33.791311  
[37m[36mINFO[0m[0m 03/19 17:14:00 | 0.880415    0.899756    0.980642    0.960831    0.113941    0.880415    0.899756    0.969616    0.961538    0.997754    0.991018    0.974555    0.929936    1200        14.371257   0.047397    0.150013    35.169650  
[37m[36mINFO[0m[0m 03/19 17:15:04 | 0.785845    0.809291    0.986917    0.958534    0.133095    0.785845    0.809291    0.984009    0.952991    0.995509    0.985030    0.981234    0.937580    1400        16.766467   0.049308    0.150407    33.478124  
[37m[36mINFO[0m[0m 03/19 17:16:18 | 0.845027    0.843521    0.991176    0.968065    0.108564    0.845027    0.843521    0.989339    0.972222    0.998503    0.988024    0.985687    0.943949    1600        19.161677   0.037005    0.193118    35.218870  
[37m[36mINFO[0m[0m 03/19 17:17:18 | 0.865772    0.845966    0.992704    0.968787    0.086683    0.865772    0.845966    0.992537    0.972222    0.999251    0.994012    0.986323    0.940127    1800        21.556886   0.037667    0.147544    30.368128  
[37m[36mINFO[0m[0m 03/19 17:18:32 | 0.873703    0.860636    0.995681    0.967502    0.090387    0.873703    0.860636    0.997335    0.970085    0.999251    0.991018    0.990458    0.941401    2000        23.952096   0.023393    0.206038    33.243316  
[37m[36mINFO[0m[0m 03/19 17:19:36 | 0.863331    0.860636    0.990577    0.968638    0.107189    0.863331    0.860636    0.991471    0.972222    0.997754    0.991018    0.982506    0.942675    2200        26.347305   0.022522    0.155008    32.435352  
[37m[36mINFO[0m[0m 03/19 17:20:38 | 0.812691    0.819071    0.990150    0.964529    0.130247    0.812691    0.819071    0.989872    0.970085    0.997754    0.991018    0.982824    0.932484    2400        28.742515   0.016431    0.145221    32.861543  
[37m[36mINFO[0m[0m 03/19 17:21:49 | 0.838316    0.855746    0.994543    0.966517    0.116879    0.838316    0.855746    0.995736    0.976496    0.997754    0.988024    0.990140    0.935032    2600        31.137725   0.017845    0.200138    31.748695  
[37m[36mINFO[0m[0m 03/19 17:22:49 | 0.841367    0.836186    0.990556    0.959651    0.141561    0.841367    0.836186    0.987740    0.959402    0.992515    0.973054    0.991412    0.946497    2800        33.532934   0.015514    0.139494    32.175855  
[37m[36mINFO[0m[0m 03/19 17:23:57 | 0.829774    0.821516    0.992056    0.965228    0.113007    0.829774    0.821516    0.988273    0.965812    0.997754    0.991018    0.990140    0.938854    3000        35.928144   0.023486    0.180217    31.552059  
[37m[36mINFO[0m[0m 03/19 17:25:00 | 0.788286    0.787286    0.985633    0.951566    0.181780    0.788286    0.787286    0.978678    0.944444    0.994760    0.979042    0.983461    0.931210    3200        38.323353   0.024793    0.157453    31.427197  
[37m[36mINFO[0m[0m 03/19 17:26:01 | 0.882245    0.882641    0.994294    0.961516    0.146903    0.882245    0.882641    0.992537    0.950855    0.999251    0.991018    0.991094    0.942675    3400        40.718563   0.012612    0.145646    31.508015  
[37m[36mINFO[0m[0m 03/19 17:27:22 | 0.852959    0.860636    0.997593    0.972896    0.081928    0.852959    0.860636    0.997868    0.974359    1.000000    0.994012    0.994911    0.950318    3600        43.113772   0.020724    0.242733    32.420027  
[37m[36mINFO[0m[0m 03/19 17:28:26 | 0.849298    0.850856    0.995822    0.966789    0.121715    0.849298    0.850856    0.997868    0.967949    0.998503    0.991018    0.991094    0.941401    3800        45.508982   0.014859    0.149407    34.960315  
[37m[36mINFO[0m[0m 03/19 17:29:32 | 0.873093    0.887531    0.996988    0.963956    0.117119    0.873093    0.887531    0.995736    0.970085    1.000000    0.988024    0.995229    0.933758    4000        47.904192   0.015456    0.162579    33.268965  
[37m[36mINFO[0m[0m 03/19 17:30:40 | 0.848688    0.845966    0.998089    0.968501    0.129004    0.848688    0.845966    0.998401    0.974359    1.000000    0.991018    0.995865    0.940127    4200        50.299401   0.011240    0.170220    33.636750  
[37m[36mINFO[0m[0m 03/19 17:31:44 | 0.856010    0.853301    0.997839    0.971200    0.113618    0.856010    0.853301    0.997335    0.978632    1.000000    0.991018    0.996183    0.943949    4400        52.694611   0.011919    0.147460    34.562922  
[37m[36mINFO[0m[0m 03/19 17:33:04 | 0.851129    0.838631    0.995959    0.970061    0.120783    0.851129    0.838631    0.995736    0.972222    0.998503    0.994012    0.993639    0.943949    4600        55.089820   0.014072    0.233223    33.129879  
[37m[36mINFO[0m[0m 03/19 17:34:05 | 0.826724    0.848411    0.996664    0.967079    0.158911    0.826724    0.848411    0.996802    0.974359    0.997006    0.988024    0.996183    0.938854    4800        57.485030   0.009863    0.146604    32.043305  
[37m[36mINFO[0m[0m 03/19 17:35:08 | 0.885296    0.877751    0.998123    0.969638    0.104366    0.885296    0.877751    0.997868    0.976496    1.000000    0.991018    0.996501    0.941401    5000        59.880240   0.007971    0.150526    33.169428  
[37m[36mINFO[0m[0m 03/19 17:35:08 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250319_17-06-49_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 17:35:09 | ---
[37m[36mINFO[0m[0m 03/19 17:35:09 | test-domain validation(oracle) = 88.041%
[37m[36mINFO[0m[0m 03/19 17:35:09 | training-domain validation(iid) = 85.296%
[37m[36mINFO[0m[0m 03/19 17:35:09 | last = 88.530%
[37m[36mINFO[0m[0m 03/19 17:35:09 | last (inD) = 96.964%
[37m[36mINFO[0m[0m 03/19 17:35:09 | training-domain validation (iid, inD) = 97.290%
[37m[36mINFO[0m[0m 03/19 17:35:10 | === Summary ===
[37m[36mINFO[0m[0m 03/19 17:35:10 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 2 --hparams_seed 11
[37m[36mINFO[0m[0m 03/19 17:35:10 | Unique name: 250319_17-06-49_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 17:35:10 | Out path: train_output/PACS/ERM/[0]/250319_17-06-49_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 17:35:10 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 17:35:10 | Dataset: PACS

[37m[36mINFO[0m[0m 03/19 13:50:47 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 2 --hparams_seed 4
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 4
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[0]/250319_13-50-47_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 2
	unique_name: 250319_13-50-47_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 6.164076981615215e-05
	batch_size: 11
	weight_decay: 3.184710792983041e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/19 13:50:47 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 13:50:47 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 13:50:47 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 13:50:47 | 
[37m[36mINFO[0m[0m 03/19 13:50:47 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 13:50:47 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 13:50:47 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 13:50:47 | Batch sizes for each domain: [0, 11, 11, 11] (total=33)
[37m[36mINFO[0m[0m 03/19 13:50:47 | steps-per-epoch for each domain: 170.55, 121.45, 285.82 -> min = 121.45
[37m[36mINFO[0m[0m 03/19 13:50:48 | # of params = 23522375
[37m[36mINFO[0m[0m 03/19 13:51:22 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 13:51:22 | 0.187309    0.176039    0.164871    0.162150    2.013884    0.187309    0.176039    0.167377    0.160256    0.130988    0.128743    0.196247    0.197452    0           0.000000    1.964430    1.027129    32.682308  
[37m[36mINFO[0m[0m 03/19 13:52:21 | 0.799268    0.826406    0.929436    0.926006    0.207097    0.799268    0.826406    0.908316    0.905983    0.976048    0.979042    0.903944    0.892994    200         1.646707    0.474128    0.136051    32.252795  
[37m[36mINFO[0m[0m 03/19 13:53:20 | 0.826113    0.828851    0.956674    0.948623    0.146408    0.826113    0.828851    0.940299    0.938034    0.989521    0.997006    0.940204    0.910828    400         3.293413    0.216301    0.131019    32.551428  
[37m[36mINFO[0m[0m 03/19 13:54:20 | 0.876754    0.872861    0.960390    0.947335    0.148332    0.876754    0.872861    0.949893    0.955128    0.985030    0.976048    0.946247    0.910828    600         4.940120    0.141229    0.138805    32.066220  
[37m[36mINFO[0m[0m 03/19 13:55:17 | 0.818182    0.828851    0.973881    0.958557    0.128424    0.818182    0.828851    0.972814    0.957265    0.991766    0.991018    0.957061    0.927389    800         6.586826    0.113203    0.132177    30.799120  
[37m[36mINFO[0m[0m 03/19 13:56:26 | 0.852959    0.841076    0.983904    0.963359    0.093923    0.852959    0.841076    0.988273    0.965812    0.989521    0.979042    0.973919    0.945223    1000        8.233533    0.085630    0.188279    31.059759  
[37m[36mINFO[0m[0m 03/19 13:57:24 | 0.840757    0.860636    0.983780    0.967075    0.095379    0.840757    0.860636    0.986141    0.965812    0.997006    0.994012    0.968193    0.941401    1200        9.880240    0.078908    0.132605    31.636175  
[37m[36mINFO[0m[0m 03/19 13:58:24 | 0.809640    0.801956    0.978045    0.953600    0.129002    0.809640    0.801956    0.986674    0.959402    0.980539    0.988024    0.966921    0.913376    1400        11.526946   0.058975    0.143912    31.504581  
[37m[36mINFO[0m[0m 03/19 13:59:24 | 0.823063    0.838631    0.982383    0.965377    0.111169    0.823063    0.838631    0.981876    0.965812    0.993263    0.994012    0.972010    0.936306    1600        13.173653   0.056688    0.135973    32.672713  
[37m[36mINFO[0m[0m 03/19 14:00:22 | 0.806589    0.823961    0.978423    0.952747    0.155220    0.806589    0.823961    0.979744    0.950855    0.994012    0.994012    0.961514    0.913376    1800        14.820359   0.051651    0.132176    31.506992  
[37m[36mINFO[0m[0m 03/19 14:01:31 | 0.798048    0.823961    0.987864    0.960250    0.121263    0.798048    0.823961    0.988273    0.967949    0.990269    0.979042    0.985051    0.933758    2000        16.467066   0.044755    0.185505    31.529127  
[37m[36mINFO[0m[0m 03/19 14:02:31 | 0.734594    0.755501    0.962563    0.926669    0.257931    0.734594    0.755501    0.952559    0.918803    0.976796    0.949102    0.958333    0.912102    2200        18.113772   0.035681    0.140405    31.851966  
[37m[36mINFO[0m[0m 03/19 14:03:30 | 0.778523    0.770171    0.987565    0.961809    0.118017    0.778523    0.770171    0.990405    0.965812    0.995509    0.982036    0.976781    0.937580    2400        19.760479   0.049473    0.128910    33.197918  
[37m[36mINFO[0m[0m 03/19 14:04:31 | 0.809640    0.814181    0.990914    0.960950    0.122606    0.809640    0.814181    0.992537    0.967949    0.991018    0.976048    0.989186    0.938854    2600        21.407186   0.036195    0.147081    31.801567  
[37m[36mINFO[0m[0m 03/19 14:05:28 | 0.852349    0.860636    0.990150    0.962543    0.113048    0.852349    0.860636    0.993070    0.967949    0.995509    0.991018    0.981870    0.928662    2800        23.053892   0.028917    0.126001    32.021942  
[37m[36mINFO[0m[0m 03/19 14:06:35 | 0.829774    0.841076    0.993612    0.967920    0.091127    0.829774    0.841076    0.989872    0.980769    0.997006    0.979042    0.993957    0.943949    3000        24.700599   0.024782    0.175026    31.586322  
[37m[36mINFO[0m[0m 03/19 14:07:35 | 0.816351    0.823961    0.992766    0.966916    0.098583    0.816351    0.823961    0.993603    0.967949    0.995509    0.985030    0.989186    0.947771    3200        26.347305   0.022971    0.139460    32.798744  
[37m[36mINFO[0m[0m 03/19 14:08:34 | 0.851739    0.870416    0.995039    0.963932    0.103630    0.851739    0.870416    0.994136    0.965812    0.999251    0.982036    0.991730    0.943949    3400        27.994012   0.019199    0.130651    32.572049  
[37m[36mINFO[0m[0m 03/19 14:09:37 | 0.749237    0.772616    0.989861    0.952699    0.174420    0.749237    0.772616    0.987207    0.938034    0.997006    0.985030    0.985369    0.935032    3600        29.640719   0.024154    0.150341    33.094636  
[37m[36mINFO[0m[0m 03/19 14:10:35 | 0.826724    0.843521    0.989107    0.962792    0.120325    0.826724    0.843521    0.981876    0.955128    0.996257    0.988024    0.989186    0.945223    3800        31.287425   0.022328    0.127853    32.541348  
[37m[36mINFO[0m[0m 03/19 14:11:39 | 0.814521    0.850856    0.994390    0.963212    0.132856    0.814521    0.850856    0.995203    0.970085    0.994012    0.973054    0.993957    0.946497    4000        32.934132   0.020556    0.158962    32.270756  
[37m[36mINFO[0m[0m 03/19 14:12:38 | 0.826724    0.826406    0.993162    0.961099    0.137972    0.826724    0.826406    0.994136    0.967949    0.997754    0.979042    0.987595    0.936306    4200        34.580838   0.027734    0.138007    31.285288  
[37m[36mINFO[0m[0m 03/19 14:13:37 | 0.843197    0.858191    0.995603    0.963807    0.095608    0.843197    0.858191    0.996802    0.970085    0.997006    0.985030    0.993003    0.936306    4400        36.227545   0.031814    0.126574    33.097535  
[37m[36mINFO[0m[0m 03/19 14:14:44 | 0.837706    0.848411    0.996670    0.966063    0.113569    0.837706    0.848411    0.995736    0.959402    1.000000    0.991018    0.994275    0.947771    4600        37.874251   0.010768    0.175886    32.356658  
[37m[36mINFO[0m[0m 03/19 14:15:42 | 0.824283    0.819071    0.993727    0.962944    0.112356    0.824283    0.819071    0.991471    0.963675    0.999251    0.985030    0.990458    0.940127    4800        39.520958   0.021281    0.127171    32.061629  
[37m[36mINFO[0m[0m 03/19 14:16:43 | 0.853569    0.855746    0.997908    0.972323    0.084394    0.853569    0.855746    0.996269    0.974359    1.000000    0.991018    0.997455    0.951592    5000        41.167665   0.020222    0.142891    32.468539  
[37m[36mINFO[0m[0m 03/19 14:16:43 | Cumulative gradient change saved at train_output/PACS/ERM/[0]/250319_13-50-47_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 14:16:44 | ---
[37m[36mINFO[0m[0m 03/19 14:16:44 | test-domain validation(oracle) = 87.675%
[37m[36mINFO[0m[0m 03/19 14:16:44 | training-domain validation(iid) = 85.357%
[37m[36mINFO[0m[0m 03/19 14:16:44 | last = 85.357%
[37m[36mINFO[0m[0m 03/19 14:16:44 | last (inD) = 97.232%
[37m[36mINFO[0m[0m 03/19 14:16:44 | training-domain validation (iid, inD) = 97.232%
[37m[36mINFO[0m[0m 03/19 14:16:44 | === Summary ===
[37m[36mINFO[0m[0m 03/19 14:16:44 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset PACS --trial_seed 2 --hparams_seed 4
[37m[36mINFO[0m[0m 03/19 14:16:44 | Unique name: 250319_13-50-47_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 14:16:44 | Out path: train_output/PACS/ERM/[0]/250319_13-50-47_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 14:16:44 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 14:16:44 | Dataset: PACS

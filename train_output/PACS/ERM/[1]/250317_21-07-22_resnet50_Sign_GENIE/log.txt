[37m[36mINFO[0m[0m 03/17 21:07:22 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --trial_seed 1 --hparams_seed 12 --algorithm ERM --test_envs 1 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 12
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[1]/250317_21-07-22_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250317_21-07-22_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 3.0065625733392338e-05
	batch_size: 34
	weight_decay: 4.89485556145273e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/17 21:07:22 | n_steps = 5001
[37m[36mINFO[0m[0m 03/17 21:07:22 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/17 21:07:22 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/17 21:07:22 | 
[37m[36mINFO[0m[0m 03/17 21:07:22 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/17 21:07:22 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/17 21:07:22 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/17 21:07:22 | Batch sizes for each domain: [34, 0, 34, 34] (total=102)
[37m[36mINFO[0m[0m 03/17 21:07:22 | steps-per-epoch for each domain: 48.21, 39.29, 92.47 -> min = 39.29
[37m[36mINFO[0m[0m 03/17 21:07:23 | # of params = 23522375
[37m[36mINFO[0m[0m 03/17 21:07:56 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/17 21:07:56 | 0.175906    0.211538    0.230912    0.228020    1.896080    0.247712    0.281174    0.175906    0.211538    0.205838    0.164671    0.239186    0.238217    0           0.000000    2.001022    1.270976    31.485621  
[37m[36mINFO[0m[0m 03/17 21:09:27 | 0.742004    0.747863    0.954888    0.946515    0.181416    0.942648    0.916870    0.742004    0.747863    0.993263    0.994012    0.928753    0.928662    200         5.089820    0.302132    0.279822    34.660857  
[37m[36mINFO[0m[0m 03/17 21:10:55 | 0.781983    0.786325    0.970301    0.956134    0.138564    0.971934    0.936430    0.781983    0.786325    0.991766    0.988024    0.947201    0.943949    400         10.179641   0.087359    0.277017    32.741295  
[37m[36mINFO[0m[0m 03/17 21:12:18 | 0.732409    0.726496    0.978637    0.962218    0.133686    0.975595    0.946210    0.732409    0.726496    0.996257    0.985030    0.964059    0.955414    600         15.269461   0.062666    0.247689    33.161215  
[37m[36mINFO[0m[0m 03/17 21:13:41 | 0.779318    0.769231    0.993725    0.973558    0.098870    0.993899    0.965770    0.779318    0.769231    1.000000    0.988024    0.987277    0.966879    800         20.359281   0.040210    0.250457    33.497812  
[37m[36mINFO[0m[0m 03/17 21:15:11 | 0.823561    0.811966    0.990900    0.968931    0.148555    0.990848    0.953545    0.823561    0.811966    0.997754    0.994012    0.984097    0.959236    1000        25.449102   0.029675    0.283668    33.088741  
[37m[36mINFO[0m[0m 03/17 21:16:42 | 0.797974    0.784188    0.995453    0.970747    0.115642    0.993899    0.963325    0.797974    0.784188    0.998503    0.982036    0.993957    0.966879    1200        30.538922   0.024432    0.284359    33.928474  
[37m[36mINFO[0m[0m 03/17 21:18:09 | 0.794776    0.760684    0.989067    0.958797    0.152745    0.985967    0.938875    0.794776    0.760684    1.000000    0.991018    0.981234    0.946497    1400        35.628743   0.017790    0.263250    34.501054  
[37m[36mINFO[0m[0m 03/17 21:19:31 | 0.816098    0.792735    0.996800    0.966257    0.136509    0.993899    0.941320    0.816098    0.792735    1.000000    0.988024    0.996501    0.969427    1600        40.718563   0.016152    0.245853    33.057451  
[37m[36mINFO[0m[0m 03/17 21:21:01 | 0.780384    0.767094    0.998118    0.970905    0.116202    0.998170    0.953545    0.780384    0.767094    1.000000    0.991018    0.996183    0.968153    1800        45.808383   0.020731    0.279223    34.103040  
[37m[36mINFO[0m[0m 03/17 21:22:29 | 0.812900    0.809829    0.996212    0.971996    0.139855    0.997559    0.955990    0.812900    0.809829    0.997754    0.988024    0.993321    0.971975    2000        50.898204   0.009332    0.280679    31.671650  
[37m[36mINFO[0m[0m 03/17 21:23:58 | 0.815032    0.807692    0.991584    0.960727    0.165260    0.989628    0.951100    0.815032    0.807692    0.996257    0.982036    0.988868    0.949045    2200        55.988024   0.013216    0.276744    33.574469  
[37m[36mINFO[0m[0m 03/17 21:25:21 | 0.815032    0.801282    0.996871    0.972743    0.149446    0.996339    0.963325    0.815032    0.801282    1.000000    0.988024    0.994275    0.966879    2400        61.077844   0.012133    0.235623    36.138592  
[37m[36mINFO[0m[0m 03/17 21:26:45 | 0.825160    0.814103    0.998436    0.971503    0.143095    0.998170    0.960880    0.825160    0.814103    1.000000    0.988024    0.997137    0.965605    2600        66.167665   0.011456    0.256993    32.095106  
[37m[36mINFO[0m[0m 03/17 21:28:14 | 0.818230    0.792735    0.998398    0.973419    0.112021    0.998170    0.955990    0.818230    0.792735    0.999251    0.991018    0.997774    0.973248    2800        71.257485   0.007995    0.281147    33.286566  
[37m[36mINFO[0m[0m 03/17 21:29:42 | 0.802772    0.788462    0.998444    0.976679    0.100547    0.997559    0.965770    0.802772    0.788462    1.000000    0.991018    0.997774    0.973248    3000        76.347305   0.005519    0.279929    32.208344  
[37m[36mINFO[0m[0m 03/17 21:31:04 | 0.823561    0.803419    0.998648    0.966579    0.149800    0.998170    0.948655    0.823561    0.803419    1.000000    0.988024    0.997774    0.963057    3200        81.437126   0.006436    0.238785    33.441756  
[37m[36mINFO[0m[0m 03/17 21:32:27 | 0.789446    0.769231    0.998957    0.972743    0.124454    0.998780    0.963325    0.789446    0.769231    1.000000    0.988024    0.998092    0.966879    3400        86.526946   0.004689    0.250508    33.610173  
[37m[36mINFO[0m[0m 03/17 21:33:55 | 0.797974    0.764957    0.997229    0.969207    0.131442    0.995729    0.953545    0.797974    0.764957    0.998503    0.991018    0.997455    0.963057    3600        91.616766   0.005174    0.278159    31.984715  
[37m[36mINFO[0m[0m 03/17 21:35:24 | 0.794776    0.792735    0.993320    0.963299    0.187574    0.996949    0.958435    0.794776    0.792735    0.997006    0.976048    0.986005    0.955414    3800        96.706587   0.003525    0.279352    32.853693  
[37m[36mINFO[0m[0m 03/17 21:36:48 | 0.805437    0.797009    0.999229    0.975405    0.129662    0.999390    0.965770    0.805437    0.797009    0.999251    0.991018    0.999046    0.969427    4000        101.796407  0.005253    0.261204    32.326333  
[37m[36mINFO[0m[0m 03/17 21:38:09 | 0.805437    0.777778    0.998533    0.970437    0.151946    0.998780    0.965770    0.805437    0.777778    1.000000    0.985030    0.996819    0.960510    4200        106.886228  0.007305    0.244122    32.263554  
[37m[36mINFO[0m[0m 03/17 21:39:39 | 0.803305    0.803419    0.997859    0.967394    0.146863    0.998780    0.951100    0.803305    0.803419    0.999251    0.988024    0.995547    0.963057    4400        111.976048  0.002784    0.281093    32.919978  
[37m[36mINFO[0m[0m 03/17 21:41:09 | 0.820362    0.803419    0.998708    0.973834    0.126542    0.998780    0.965770    0.820362    0.803419    0.999251    0.985030    0.998092    0.970701    4600        117.065868  0.003509    0.280339    34.187360  
[37m[36mINFO[0m[0m 03/17 21:42:39 | 0.794776    0.786325    0.996843    0.972328    0.137430    0.995729    0.953545    0.794776    0.786325    0.999251    0.994012    0.995547    0.969427    4800        122.155689  0.005395    0.279835    33.770858  
[37m[36mINFO[0m[0m 03/17 21:43:59 | 0.797974    0.769231    0.999432    0.975222    0.118747    1.000000    0.968215    0.797974    0.769231    0.999251    0.988024    0.999046    0.969427    5000        127.245509  0.003722    0.242608    32.167152  
[37m[36mINFO[0m[0m 03/17 21:43:59 | Cumulative gradient change saved at train_output/PACS/ERM/[1]/250317_21-07-22_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/17 21:44:01 | ---
[37m[36mINFO[0m[0m 03/17 21:44:01 | test-domain validation(oracle) = 82.516%
[37m[36mINFO[0m[0m 03/17 21:44:01 | training-domain validation(iid) = 80.277%
[37m[36mINFO[0m[0m 03/17 21:44:01 | last = 79.797%
[37m[36mINFO[0m[0m 03/17 21:44:01 | last (inD) = 97.522%
[37m[36mINFO[0m[0m 03/17 21:44:01 | training-domain validation (iid, inD) = 97.668%
[37m[36mINFO[0m[0m 03/17 21:44:01 | === Summary ===
[37m[36mINFO[0m[0m 03/17 21:44:01 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --trial_seed 1 --hparams_seed 12 --algorithm ERM --test_envs 1 --dataset PACS
[37m[36mINFO[0m[0m 03/17 21:44:01 | Unique name: 250317_21-07-22_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/17 21:44:01 | Out path: train_output/PACS/ERM/[1]/250317_21-07-22_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/17 21:44:01 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/17 21:44:01 | Dataset: PACS

[37m[36mINFO[0m[0m 03/03 23:48:34 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/PACS/ERM/[1]/250303_23-48-34_clip_vitb16_GENIE
	out_root: train_output/PACS/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250303_23-48-34_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: clip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/03 23:48:34 | n_steps = 5001
[37m[36mINFO[0m[0m 03/03 23:48:34 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/03 23:48:34 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/03 23:48:34 | 
[37m[36mINFO[0m[0m 03/03 23:48:34 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/03 23:48:34 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/03 23:48:34 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/03 23:48:34 | Batch sizes for each domain: [32, 0, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/03 23:48:34 | steps-per-epoch for each domain: 51.22, 41.75, 98.25 -> min = 41.75
[37m[36mINFO[0m[0m 03/03 23:48:37 | # of params = 86196231
[37m[36mINFO[0m[0m 03/03 23:49:11 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/03 23:49:11 | 0.121002    0.141026    0.161405    0.157431    1.946273    0.174497    0.176039    0.121002    0.141026    0.103293    0.098802    0.206425    0.197452    0           0.000000    1.908788    1.353195    32.526714  
[37m[36mINFO[0m[0m 03/03 23:51:08 | 0.496802    0.493590    0.728006    0.709891    0.749486    0.661989    0.665037    0.496802    0.493590    0.922156    0.895210    0.599873    0.569427    200         4.790419    1.208731    0.429760    31.415175  
[37m[36mINFO[0m[0m 03/03 23:53:05 | 0.539446    0.510684    0.819739    0.794929    0.565758    0.815741    0.787286    0.539446    0.510684    0.928144    0.889222    0.715331    0.708280    400         9.580838    0.592309    0.430356    30.916050  
[37m[36mINFO[0m[0m 03/03 23:55:02 | 0.660981    0.651709    0.866023    0.845364    0.435087    0.846858    0.821516    0.660981    0.651709    0.967814    0.931138    0.783397    0.783439    600         14.371257   0.446154    0.429327    30.816122  
[37m[36mINFO[0m[0m 03/03 23:56:59 | 0.678038    0.668803    0.881186    0.841694    0.441066    0.890177    0.828851    0.678038    0.668803    0.973802    0.919162    0.779580    0.777070    800         19.161677   0.342079    0.430536    31.585547  
[37m[36mINFO[0m[0m 03/03 23:58:58 | 0.672175    0.675214    0.903059    0.864535    0.374990    0.921293    0.865526    0.672175    0.675214    0.979042    0.919162    0.808842    0.808917    1000        23.952096   0.311917    0.432490    32.053552  
[37m[36mINFO[0m[0m 03/04 00:00:57 | 0.634861    0.628205    0.908136    0.874794    0.404776    0.921293    0.872861    0.634861    0.628205    0.974551    0.931138    0.828562    0.820382    1200        28.742515   0.268492    0.430873    32.539170  
[37m[36mINFO[0m[0m 03/04 00:02:54 | 0.684968    0.660256    0.926495    0.879133    0.349567    0.945088    0.875306    0.684968    0.660256    0.988024    0.925150    0.846374    0.836943    1400        33.532934   0.232627    0.429107    31.822680  
[37m[36mINFO[0m[0m 03/04 00:04:52 | 0.630597    0.604701    0.900557    0.842418    0.490252    0.931056    0.848411    0.630597    0.604701    0.980539    0.922156    0.790076    0.756688    1600        38.323353   0.219650    0.430918    31.614129  
[37m[36mINFO[0m[0m 03/04 00:06:50 | 0.696695    0.700855    0.930598    0.875916    0.356042    0.949969    0.865526    0.696695    0.700855    0.988772    0.943114    0.853053    0.819108    1800        43.113772   0.194156    0.430166    31.684228  
[37m[36mINFO[0m[0m 03/04 00:08:47 | 0.715352    0.743590    0.941101    0.884513    0.374828    0.967053    0.877751    0.715352    0.743590    0.989521    0.940120    0.866730    0.835669    2000        47.904192   0.179893    0.430498    30.979625  
[37m[36mINFO[0m[0m 03/04 00:10:44 | 0.694563    0.673077    0.936338    0.878269    0.421053    0.957291    0.858191    0.694563    0.673077    0.993263    0.937126    0.858461    0.839490    2200        52.694611   0.157086    0.429475    31.113990  
[37m[36mINFO[0m[0m 03/04 00:12:41 | 0.642324    0.632479    0.949668    0.885683    0.340099    0.981696    0.897311    0.642324    0.632479    0.993263    0.952096    0.874046    0.807643    2400        57.485030   0.149445    0.430269    31.065109  
[37m[36mINFO[0m[0m 03/04 00:14:38 | 0.683369    0.673077    0.955292    0.889127    0.355093    0.974375    0.892421    0.683369    0.673077    0.995509    0.943114    0.895992    0.831847    2600        62.275449   0.136581    0.429898    31.184041  
[37m[36mINFO[0m[0m 03/04 00:16:36 | 0.706823    0.685897    0.956314    0.887739    0.353690    0.976205    0.889976    0.706823    0.685897    0.991018    0.940120    0.901718    0.833121    2800        67.065868   0.135119    0.431157    31.210951  
[37m[36mINFO[0m[0m 03/04 00:18:33 | 0.710554    0.702991    0.957647    0.891542    0.357870    0.974985    0.897311    0.710554    0.702991    0.994012    0.916168    0.903944    0.861146    3000        71.856287   0.119068    0.431227    30.831450  
[37m[36mINFO[0m[0m 03/04 00:20:30 | 0.701493    0.679487    0.962358    0.866212    0.407138    0.982306    0.865526    0.701493    0.679487    0.997006    0.910180    0.907761    0.822930    3200        76.646707   0.114994    0.429732    31.301885  
[37m[36mINFO[0m[0m 03/04 00:22:28 | 0.707889    0.696581    0.966200    0.887212    0.360735    0.988408    0.885086    0.707889    0.696581    0.999251    0.928144    0.910941    0.848408    3400        81.437126   0.102134    0.429828    31.587983  
[37m[36mINFO[0m[0m 03/04 00:24:25 | 0.657783    0.675214    0.968733    0.893959    0.350122    0.986577    0.889976    0.657783    0.675214    0.998503    0.937126    0.921120    0.854777    3600        86.227545   0.101172    0.429828    31.291126  
[37m[36mINFO[0m[0m 03/04 00:26:22 | 0.727612    0.720085    0.972152    0.902281    0.316962    0.984747    0.902200    0.727612    0.720085    0.998503    0.937126    0.933206    0.867516    3800        91.017964   0.081984    0.429564    31.567585  
[37m[36mINFO[0m[0m 03/04 00:28:20 | 0.718550    0.732906    0.973555    0.912552    0.330413    0.987797    0.907090    0.718550    0.732906    0.997754    0.940120    0.935115    0.890446    4000        95.808383   0.091331    0.429559    31.513279  
[37m[36mINFO[0m[0m 03/04 00:30:17 | 0.707889    0.726496    0.977091    0.905997    0.331095    0.992678    0.902200    0.707889    0.726496    0.997754    0.952096    0.940840    0.863694    4200        100.598802  0.079530    0.429234    31.801960  
[37m[36mINFO[0m[0m 03/04 00:32:15 | 0.640725    0.651709    0.968238    0.900857    0.345093    0.984137    0.914425    0.640725    0.651709    0.998503    0.946108    0.922074    0.842038    4400        105.389222  0.074489    0.430684    31.384668  
[37m[36mINFO[0m[0m 03/04 00:34:12 | 0.757996    0.732906    0.974980    0.911599    0.317200    0.987187    0.926650    0.757996    0.732906    0.998503    0.952096    0.939249    0.856051    4600        110.179641  0.073940    0.429155    31.536463  
[37m[36mINFO[0m[0m 03/04 00:36:12 | 0.662580    0.664530    0.977759    0.903931    0.328173    0.987797    0.887531    0.662580    0.664530    0.997006    0.949102    0.948473    0.875159    4800        114.970060  0.072091    0.435674    32.242344  
[37m[36mINFO[0m[0m 03/04 00:38:09 | 0.661514    0.664530    0.976277    0.905296    0.343874    0.990238    0.902200    0.661514    0.664530    0.997754    0.955090    0.940840    0.858599    5000        119.760479  0.074275    0.429724    31.090776  
[37m[36mINFO[0m[0m 03/04 00:38:09 | Cumulative gradient change saved at train_output/PACS/ERM/[1]/250303_23-48-34_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/04 00:38:11 | ---
[37m[36mINFO[0m[0m 03/04 00:38:11 | test-domain validation(oracle) = 71.535%
[37m[36mINFO[0m[0m 03/04 00:38:11 | training-domain validation(iid) = 71.855%
[37m[36mINFO[0m[0m 03/04 00:38:11 | last = 66.151%
[37m[36mINFO[0m[0m 03/04 00:38:11 | last (inD) = 90.530%
[37m[36mINFO[0m[0m 03/04 00:38:11 | training-domain validation (iid, inD) = 91.255%
[37m[36mINFO[0m[0m 03/04 00:38:11 | === Summary ===
[37m[36mINFO[0m[0m 03/04 00:38:11 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset PACS
[37m[36mINFO[0m[0m 03/04 00:38:11 | Unique name: 250303_23-48-34_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/04 00:38:11 | Out path: train_output/PACS/ERM/[1]/250303_23-48-34_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/04 00:38:11 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/04 00:38:11 | Dataset: PACS

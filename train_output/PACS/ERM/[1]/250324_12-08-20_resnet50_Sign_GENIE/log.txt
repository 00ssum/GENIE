[37m[36mINFO[0m[0m 03/24 12:08:20 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset PACS --trial_seed 1 --hparams_seed 0
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/PACS/ERM/[1]/250324_12-08-20_resnet50_Sign_GENIE
	out_root: train_output/PACS/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250324_12-08-20_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/24 12:08:20 | n_steps = 5001
[37m[36mINFO[0m[0m 03/24 12:08:20 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/24 12:08:20 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/24 12:08:20 | 
[37m[36mINFO[0m[0m 03/24 12:08:20 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/24 12:08:20 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/24 12:08:20 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/24 12:08:20 | Batch sizes for each domain: [32, 0, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/24 12:08:20 | steps-per-epoch for each domain: 51.22, 41.75, 98.25 -> min = 41.75
[37m[36mINFO[0m[0m 03/24 12:08:21 | # of params = 23522375
[37m[36mINFO[0m[0m 03/24 12:08:54 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/24 12:08:54 | 0.178038    0.205128    0.223698    0.224713    1.902945    0.241001    0.276284    0.178038    0.205128    0.208084    0.173653    0.222010    0.224204    0           0.000000    2.002462    0.976769    32.358535  
[37m[36mINFO[0m[0m 03/24 12:10:10 | 0.718017    0.715812    0.959187    0.961737    0.125363    0.957901    0.960880    0.718017    0.715812    0.990269    0.988024    0.929389    0.936306    200         4.790419    0.308647    0.220032    31.185430  
[37m[36mINFO[0m[0m 03/24 12:11:28 | 0.826226    0.803419    0.977006    0.967360    0.112146    0.973154    0.953545    0.826226    0.803419    0.994760    0.988024    0.963104    0.960510    400         9.580838    0.088838    0.226874    32.925943  
[37m[36mINFO[0m[0m 03/24 12:12:44 | 0.742004    0.743590    0.958840    0.943384    0.200908    0.960342    0.926650    0.742004    0.743590    0.992515    0.985030    0.923664    0.918471    600         14.371257   0.055800    0.226990    30.826055  
[37m[36mINFO[0m[0m 03/24 12:14:01 | 0.795309    0.777778    0.991642    0.971596    0.108633    0.990848    0.963325    0.795309    0.777778    0.997754    0.982036    0.986323    0.969427    800         19.161677   0.043591    0.233022    30.025672  
[37m[36mINFO[0m[0m 03/24 12:15:24 | 0.758529    0.752137    0.986121    0.978399    0.093232    0.978646    0.965770    0.758529    0.752137    0.996257    1.000000    0.983461    0.969427    1000        23.952096   0.027222    0.265039    30.452909  
[37m[36mINFO[0m[0m 03/24 12:16:41 | 0.804371    0.775641    0.993997    0.974946    0.107509    0.994509    0.968215    0.804371    0.775641    0.999251    0.991018    0.988232    0.965605    1200        28.742515   0.026617    0.225739    31.923723  
[37m[36mINFO[0m[0m 03/24 12:18:12 | 0.788380    0.773504    0.993634    0.973716    0.096128    0.990238    0.955990    0.788380    0.773504    0.999251    0.997006    0.991412    0.968153    1400        33.532934   0.016998    0.293000    32.009952  
[37m[36mINFO[0m[0m 03/24 12:19:26 | 0.776652    0.756410    0.994969    0.976540    0.097505    0.993289    0.955990    0.776652    0.756410    0.999251    0.994012    0.992366    0.979618    1600        38.323353   0.016057    0.221173    29.731264  
[37m[36mINFO[0m[0m 03/24 12:20:46 | 0.789446    0.779915    0.997000    0.967992    0.113938    0.996949    0.958435    0.789446    0.779915    0.998503    0.985030    0.995547    0.960510    1800        43.113772   0.012710    0.249184    30.776525  
[37m[36mINFO[0m[0m 03/24 12:22:03 | 0.777186    0.777778    0.996209    0.977909    0.083441    0.998170    0.977995    0.777186    0.777778    1.000000    0.985030    0.990458    0.970701    2000        47.904192   0.013835    0.218428    32.463302  
[37m[36mINFO[0m[0m 03/24 12:23:24 | 0.833689    0.820513    0.997504    0.971435    0.112908    0.998780    0.965770    0.833689    0.820513    0.998503    0.988024    0.995229    0.960510    2200        52.694611   0.010137    0.235119    33.954646  
[37m[36mINFO[0m[0m 03/24 12:24:39 | 0.759062    0.762821    0.998000    0.980329    0.082127    0.996339    0.977995    0.759062    0.762821    0.999251    0.991018    0.998410    0.971975    2400        57.485030   0.017237    0.219698    31.621090  
[37m[36mINFO[0m[0m 03/24 12:25:55 | 0.742537    0.739316    0.997135    0.967164    0.101249    0.997559    0.958435    0.742537    0.739316    0.999251    0.994012    0.994593    0.949045    2600        62.275449   0.011722    0.229288    30.123529  
[37m[36mINFO[0m[0m 03/24 12:27:10 | 0.753731    0.754274    0.994573    0.972411    0.114204    0.990848    0.965770    0.753731    0.754274    0.997006    0.982036    0.995865    0.969427    2800        67.065868   0.008446    0.224983    29.857784  
[37m[36mINFO[0m[0m 03/24 12:28:28 | 0.820362    0.805556    0.997605    0.972535    0.104378    0.996949    0.958435    0.820362    0.805556    1.000000    0.991018    0.995865    0.968153    3000        71.856287   0.013008    0.230935    31.482024  
[37m[36mINFO[0m[0m 03/24 12:29:49 | 0.760128    0.735043    0.997163    0.976759    0.109241    0.998170    0.970660    0.760128    0.735043    1.000000    0.994012    0.993321    0.965605    3200        76.646707   0.006340    0.255157    30.603360  
[37m[36mINFO[0m[0m 03/24 12:31:08 | 0.799041    0.784188    0.999788    0.979090    0.084854    1.000000    0.975550    0.799041    0.784188    1.000000    0.991018    0.999364    0.970701    3400        81.437126   0.011338    0.227950    32.637813  
[37m[36mINFO[0m[0m 03/24 12:32:38 | 0.722281    0.717949    0.995370    0.971261    0.104600    0.997559    0.958435    0.722281    0.717949    1.000000    0.991018    0.988550    0.964331    3600        86.227545   0.004516    0.298347    30.449692  
[37m[36mINFO[0m[0m 03/24 12:33:52 | 0.799041    0.784188    0.998555    0.974866    0.096835    0.999390    0.963325    0.799041    0.784188    0.998503    0.988024    0.997774    0.973248    3800        91.017964   0.008848    0.221494    30.015756  
[37m[36mINFO[0m[0m 03/24 12:35:14 | 0.818763    0.794872    0.997521    0.971296    0.143398    0.997559    0.955990    0.818763    0.794872    0.998503    0.991018    0.996501    0.966879    4000        95.808383   0.005370    0.259733    29.873893  
[37m[36mINFO[0m[0m 03/24 12:36:29 | 0.828358    0.807692    0.999169    0.969666    0.145895    0.998780    0.951100    0.828358    0.807692    1.000000    0.991018    0.998728    0.966879    4200        100.598802  0.003665    0.219219    31.740839  
[37m[36mINFO[0m[0m 03/24 12:37:46 | 0.818763    0.799145    0.998708    0.973350    0.161318    0.998780    0.960880    0.818763    0.799145    0.999251    0.991018    0.998092    0.968153    4400        105.389222  0.003223    0.227900    31.165586  
[37m[36mINFO[0m[0m 03/24 12:39:02 | 0.808635    0.799145    0.998524    0.970976    0.133220    0.999390    0.968215    0.808635    0.799145    1.000000    0.988024    0.996183    0.956688    4600        110.179641  0.004471    0.222184    31.748511  
[37m[36mINFO[0m[0m 03/24 12:40:20 | 0.787313    0.790598    0.996490    0.971203    0.138915    0.998170    0.953545    0.787313    0.790598    0.999251    0.997006    0.992048    0.963057    4800        114.970060  0.004218    0.231818    31.563801  
[37m[36mINFO[0m[0m 03/24 12:41:38 | 0.803838    0.794872    0.998407    0.964490    0.151882    0.997559    0.946210    0.803838    0.794872    0.999251    0.988024    0.998410    0.959236    5000        119.760479  0.006067    0.237679    30.233397  
[37m[36mINFO[0m[0m 03/24 12:41:38 | Cumulative gradient change saved at train_output/PACS/ERM/[1]/250324_12-08-20_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/24 12:41:40 | ---
[37m[36mINFO[0m[0m 03/24 12:41:40 | test-domain validation(oracle) = 83.369%
[37m[36mINFO[0m[0m 03/24 12:41:40 | training-domain validation(iid) = 75.906%
[37m[36mINFO[0m[0m 03/24 12:41:40 | last = 80.384%
[37m[36mINFO[0m[0m 03/24 12:41:40 | last (inD) = 96.449%
[37m[36mINFO[0m[0m 03/24 12:41:40 | training-domain validation (iid, inD) = 98.033%
[37m[36mINFO[0m[0m 03/24 12:41:40 | === Summary ===
[37m[36mINFO[0m[0m 03/24 12:41:40 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset PACS --trial_seed 1 --hparams_seed 0
[37m[36mINFO[0m[0m 03/24 12:41:40 | Unique name: 250324_12-08-20_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 12:41:40 | Out path: train_output/PACS/ERM/[1]/250324_12-08-20_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 12:41:40 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/24 12:41:40 | Dataset: PACS

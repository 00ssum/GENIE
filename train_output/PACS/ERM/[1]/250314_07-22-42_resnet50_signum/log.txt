[37m[36mINFO[0m[0m 03/14 07:22:42 | Command :: /jsm0707/GENIE/train_all.py resnet50_signum config/resnet50_signum.yaml --algorithm ERM --test_envs 1 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_signum.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_signum
	out_dir: train_output/PACS/ERM/[1]/250314_07-22-42_resnet50_signum
	out_root: train_output/PACS/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250314_07-22-42_resnet50_signum
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: signum
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/14 07:22:42 | n_steps = 5001
[37m[36mINFO[0m[0m 03/14 07:22:42 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/14 07:22:42 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/14 07:22:42 | 
[37m[36mINFO[0m[0m 03/14 07:22:42 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/14 07:22:42 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/14 07:22:42 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/14 07:22:42 | Batch sizes for each domain: [32, 0, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/14 07:22:42 | steps-per-epoch for each domain: 51.22, 41.75, 98.25 -> min = 41.75
[37m[36mINFO[0m[0m 03/14 07:22:44 | # of params = 23522375
[37m[36mINFO[0m[0m 03/14 07:23:18 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/14 07:23:18 | 0.223348    0.252137    0.298979    0.291135    1.845754    0.268456    0.295844    0.223348    0.252137    0.385479    0.362275    0.243003    0.215287    0           0.000000    1.975161    2.023047    31.502350  
[37m[36mINFO[0m[0m 03/14 07:24:37 | 0.621535    0.638889    0.926231    0.910802    0.264364    0.912752    0.885086    0.621535    0.638889    0.982036    0.967066    0.883906    0.880255    200         4.790419    0.381008    0.236095    31.922389  
[37m[36mINFO[0m[0m 03/14 07:25:45 | 0.720682    0.750000    0.937802    0.941203    0.229082    0.881025    0.909535    0.720682    0.750000    0.990269    0.979042    0.942112    0.935032    400         9.580838    0.227963    0.190953    30.545653  
[37m[36mINFO[0m[0m 03/14 07:26:54 | 0.667377    0.673077    0.907640    0.892930    0.318893    0.899939    0.899756    0.667377    0.673077    0.954341    0.919162    0.868639    0.859873    600         14.371257   0.360354    0.192265    30.326555  
[37m[36mINFO[0m[0m 03/14 07:28:17 | 0.680171    0.717949    0.862941    0.850216    1.492835    0.798048    0.819071    0.680171    0.717949    0.919910    0.874251    0.870865    0.857325    800         19.161677   0.582478    0.257188    31.636100  
[37m[36mINFO[0m[0m 03/14 07:29:26 | 0.647122    0.681624    0.889829    0.868394    0.632000    0.833435    0.826406    0.647122    0.681624    0.920659    0.883234    0.915394    0.895541    1000        23.952096   0.452138    0.191581    30.253478  
[37m[36mINFO[0m[0m 03/14 07:30:36 | 0.676439    0.707265    0.887650    0.866291    0.444143    0.857840    0.838631    0.676439    0.707265    0.934880    0.904192    0.870229    0.856051    1200        28.742515   0.539303    0.192440    31.320946  
[37m[36mINFO[0m[0m 03/14 07:31:55 | 0.659382    0.658120    0.898152    0.879093    0.508325    0.822453    0.819071    0.659382    0.658120    0.971557    0.934132    0.900445    0.884076    1400        33.532934   0.594169    0.245752    30.629151  
[37m[36mINFO[0m[0m 03/14 07:33:07 | 0.714819    0.732906    0.925995    0.892670    1.330849    0.915192    0.892421    0.714819    0.732906    0.948353    0.886228    0.914440    0.899363    1600        38.323353   0.703426    0.206478    30.618646  
[37m[36mINFO[0m[0m 03/14 07:34:16 | 0.368337    0.361111    0.505030    0.521573    1.694846    0.436242    0.466993    0.368337    0.361111    0.658683    0.655689    0.420165    0.442038    1800        43.113772   1.456600    0.189043    31.281909  
[37m[36mINFO[0m[0m 03/14 07:35:25 | 0.333689    0.318376    0.395704    0.381530    6.333515    0.342892    0.349633    0.333689    0.318376    0.483533    0.419162    0.360687    0.375796    2000        47.904192   2.946482    0.190478    30.800355  
[37m[36mINFO[0m[0m 03/14 07:36:48 | 0.172708    0.162393    0.173302    0.179240    4.578160    0.186089    0.188264    0.172708    0.162393    0.232036    0.233533    0.101781    0.115924    2200        52.694611   2.788675    0.251839    32.229935  
[37m[36mINFO[0m[0m 03/14 07:37:56 | 0.306503    0.258547    0.290505    0.312663    1.867192    0.247102    0.264059    0.306503    0.258547    0.330838    0.359281    0.293575    0.314650    2400        57.485030   3.204104    0.189481    30.453514  
[37m[36mINFO[0m[0m 03/14 07:39:05 | 0.246269    0.235043    0.303176    0.313052    22.962945   0.269677    0.283619    0.246269    0.235043    0.463323    0.458084    0.176527    0.197452    2600        62.275449   2.829616    0.192800    30.457810  
[37m[36mINFO[0m[0m 03/14 07:40:26 | 0.283049    0.273504    0.302482    0.323493    50.815336   0.284320    0.288509    0.283049    0.273504    0.479042    0.473054    0.144084    0.208917    2800        67.065868   2.561228    0.249353    30.655875  
[37m[36mINFO[0m[0m 03/14 07:41:37 | 0.246802    0.247863    0.313707    0.321729    1.574968    0.190360    0.205379    0.246802    0.247863    0.464820    0.491018    0.285941    0.268790    3000        71.856287   2.558395    0.202398    30.904032  
[37m[36mINFO[0m[0m 03/14 07:42:47 | 0.293710    0.286325    0.407965    0.393954    1.601004    0.370348    0.361858    0.293710    0.286325    0.558383    0.535928    0.295165    0.284076    3200        76.646707   2.451986    0.188236    31.995961  
[37m[36mINFO[0m[0m 03/14 07:43:57 | 0.408316    0.414530    0.402558    0.398352    1.608631    0.398414    0.369193    0.408316    0.414530    0.549401    0.523952    0.259860    0.301911    3400        81.437126   2.071549    0.199919    29.918857  
[37m[36mINFO[0m[0m 03/14 07:45:18 | 0.334755    0.316239    0.421353    0.444305    1.388922    0.216595    0.268949    0.334755    0.316239    0.608533    0.625749    0.438931    0.438217    3600        86.227545   2.375455    0.252612    31.079642  
[37m[36mINFO[0m[0m 03/14 07:46:28 | 0.269723    0.258547    0.409014    0.396231    1.804918    0.294082    0.293399    0.269723    0.258547    0.608533    0.553892    0.324427    0.341401    3800        91.017964   2.324294    0.189959    31.609904  
[37m[36mINFO[0m[0m 03/14 07:47:38 | 0.381130    0.410256    0.406388    0.421962    1.364331    0.248932    0.298289    0.381130    0.410256    0.615269    0.628743    0.354962    0.338854    4000        95.808383   1.946828    0.192329    31.297251  
[37m[36mINFO[0m[0m 03/14 07:48:59 | 0.300107    0.275641    0.342596    0.362343    1.502922    0.290421    0.288509    0.300107    0.275641    0.348054    0.383234    0.389313    0.415287    4200        100.598802  1.928025    0.254819    30.634634  
[37m[36mINFO[0m[0m 03/14 07:50:09 | 0.334755    0.292735    0.422080    0.442382    1.378790    0.270287    0.290954    0.334755    0.292735    0.598054    0.601796    0.397901    0.434395    4400        105.389222  1.848017    0.188891    31.460076  
[37m[36mINFO[0m[0m 03/14 07:51:18 | 0.259062    0.241453    0.370252    0.373058    1.596867    0.212325    0.215159    0.259062    0.241453    0.537425    0.526946    0.361005    0.377070    4600        110.179641  1.898515    0.189222    31.062557  
[37m[36mINFO[0m[0m 03/14 07:52:31 | 0.279318    0.271368    0.420234    0.408980    1.753960    0.334960    0.290954    0.279318    0.271368    0.507485    0.485030    0.418257    0.450955    4800        114.970060  1.889367    0.207809    31.911148  
[37m[36mINFO[0m[0m 03/14 07:53:51 | 0.235075    0.205128    0.399197    0.417710    1.540813    0.258694    0.246944    0.235075    0.205128    0.520958    0.562874    0.417939    0.443312    5000        119.760479  1.724616    0.244148    31.422860  
[37m[36mINFO[0m[0m 03/14 07:53:51 | Cumulative gradient change saved at train_output/PACS/ERM/[1]/250314_07-22-42_resnet50_signum/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/14 07:53:53 | ---
[37m[36mINFO[0m[0m 03/14 07:53:53 | test-domain validation(oracle) = 72.068%
[37m[36mINFO[0m[0m 03/14 07:53:53 | training-domain validation(iid) = 72.068%
[37m[36mINFO[0m[0m 03/14 07:53:53 | last = 23.507%
[37m[36mINFO[0m[0m 03/14 07:53:53 | last (inD) = 41.771%
[37m[36mINFO[0m[0m 03/14 07:53:53 | training-domain validation (iid, inD) = 94.120%
[37m[36mINFO[0m[0m 03/14 07:53:53 | === Summary ===
[37m[36mINFO[0m[0m 03/14 07:53:53 | Command: /jsm0707/GENIE/train_all.py resnet50_signum config/resnet50_signum.yaml --algorithm ERM --test_envs 1 --dataset PACS
[37m[36mINFO[0m[0m 03/14 07:53:53 | Unique name: 250314_07-22-42_resnet50_signum
[37m[36mINFO[0m[0m 03/14 07:53:53 | Out path: train_output/PACS/ERM/[1]/250314_07-22-42_resnet50_signum
[37m[36mINFO[0m[0m 03/14 07:53:53 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/14 07:53:53 | Dataset: PACS

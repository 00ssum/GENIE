[37m[36mINFO[0m[0m 03/08 02:27:51 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 2 --dataset PACS --trial_seed 2 --hparams_seed 12
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 12
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/PACS/ERM/[2]/250308_02-27-51_clip_vitb16_GENIE
	out_root: train_output/PACS/ERM/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 2
	unique_name: 250308_02-27-51_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5.346798771850428e-05
	batch_size: 44
	weight_decay: 1.8352299015720086e-05
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/08 02:27:51 | n_steps = 5001
[37m[36mINFO[0m[0m 03/08 02:27:51 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/08 02:27:51 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/08 02:27:51 | 
[37m[36mINFO[0m[0m 03/08 02:27:51 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 03/08 02:27:51 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 03/08 02:27:51 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 03/08 02:27:51 | Batch sizes for each domain: [44, 44, 0, 44] (total=132)
[37m[36mINFO[0m[0m 03/08 02:27:51 | steps-per-epoch for each domain: 37.25, 42.64, 71.45 -> min = 37.25
[37m[36mINFO[0m[0m 03/08 02:27:53 | # of params = 86196231
[37m[36mINFO[0m[0m 03/08 02:28:26 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/08 02:28:26 | 0.139222    0.137725    0.176137    0.181826    1.924044    0.118975    0.144254    0.188699    0.192308    0.139222    0.137725    0.220738    0.208917    0           0.000000    1.992159    1.297520    31.598023  
[37m[36mINFO[0m[0m 03/08 02:30:40 | 0.676647    0.637725    0.681459    0.721346    0.791119    0.674802    0.723716    0.746802    0.797009    0.676647    0.637725    0.622774    0.643312    200         5.369128    1.477259    0.513054    31.688893  
[37m[36mINFO[0m[0m 03/08 02:32:54 | 0.822605    0.787425    0.821280    0.793592    0.551064    0.843807    0.794621    0.887527    0.893162    0.822605    0.787425    0.732506    0.692994    400         10.738255   0.641004    0.514768    30.962665  
[37m[36mINFO[0m[0m 03/08 02:35:08 | 0.857036    0.811377    0.881244    0.854436    0.404082    0.920073    0.863081    0.933902    0.935897    0.857036    0.811377    0.789758    0.764331    600         16.107383   0.420645    0.514986    30.736619  
[37m[36mINFO[0m[0m 03/08 02:37:22 | 0.876497    0.868263    0.909883    0.864909    0.413802    0.922514    0.870416    0.959488    0.916667    0.876497    0.868263    0.847646    0.807643    800         21.476510   0.291375    0.513822    30.768859  
[37m[36mINFO[0m[0m 03/08 02:39:37 | 0.896707    0.898204    0.919083    0.870031    0.411616    0.927395    0.850856    0.965352    0.933761    0.896707    0.898204    0.864504    0.825478    1000        26.845638   0.246067    0.514269    33.005306  
[37m[36mINFO[0m[0m 03/08 02:41:51 | 0.851048    0.787425    0.937073    0.874326    0.375819    0.951190    0.848411    0.977079    0.940171    0.851048    0.787425    0.882952    0.834395    1200        32.214765   0.205226    0.514087    30.847460  
[37m[36mINFO[0m[0m 03/08 02:44:06 | 0.894461    0.862275    0.944481    0.893844    0.306399    0.971934    0.892421    0.976013    0.957265    0.894461    0.862275    0.885496    0.831847    1400        37.583893   0.172511    0.513106    32.205422  
[37m[36mINFO[0m[0m 03/08 02:46:21 | 0.892964    0.865269    0.954296    0.885092    0.330937    0.969494    0.877751    0.990405    0.938034    0.892964    0.865269    0.902990    0.839490    1600        42.953020   0.140038    0.513864    31.856560  
[37m[36mINFO[0m[0m 03/08 02:48:35 | 0.878743    0.859281    0.959959    0.886975    0.333092    0.966443    0.865526    0.990405    0.944444    0.878743    0.859281    0.923028    0.850955    1800        48.322148   0.119208    0.513232    31.680368  
[37m[36mINFO[0m[0m 03/08 02:50:49 | 0.907186    0.883234    0.969438    0.900214    0.312972    0.990848    0.902200    0.990938    0.955128    0.907186    0.883234    0.926527    0.843312    2000        53.691275   0.111756    0.513234    31.674060  
[37m[36mINFO[0m[0m 03/08 02:53:03 | 0.899701    0.898204    0.951042    0.876572    0.416361    0.984137    0.872861    0.986674    0.959402    0.899701    0.898204    0.882316    0.797452    2200        59.060403   0.094910    0.512947    31.232537  
[37m[36mINFO[0m[0m 03/08 02:55:17 | 0.889222    0.853293    0.965284    0.891016    0.371542    0.976815    0.870416    0.987740    0.946581    0.889222    0.853293    0.931298    0.856051    2400        64.429530   0.091246    0.513158    31.357878  
[37m[36mINFO[0m[0m 03/08 02:57:30 | 0.918413    0.877246    0.973226    0.889215    0.351932    0.990848    0.887531    0.994670    0.944444    0.918413    0.877246    0.934160    0.835669    2600        69.798658   0.080630    0.513103    30.692478  
[37m[36mINFO[0m[0m 03/08 02:59:45 | 0.911677    0.874251    0.976045    0.899994    0.338353    0.990848    0.907090    0.990405    0.950855    0.911677    0.874251    0.946883    0.842038    2800        75.167785   0.074246    0.513562    31.598858  
[37m[36mINFO[0m[0m 03/08 03:01:59 | 0.880988    0.853293    0.967175    0.893070    0.370676    0.980476    0.894866    0.987207    0.942308    0.880988    0.853293    0.933842    0.842038    3000        80.536913   0.065398    0.513384    31.392787  
[37m[36mINFO[0m[0m 03/08 03:04:13 | 0.858533    0.829341    0.968845    0.880811    0.428467    0.960342    0.850856    0.990405    0.944444    0.858533    0.829341    0.955789    0.847134    3200        85.906040   0.065010    0.513302    31.250428  
[37m[36mINFO[0m[0m 03/08 03:06:26 | 0.918413    0.931138    0.976836    0.904549    0.313150    0.992068    0.904645    0.987740    0.946581    0.918413    0.931138    0.950700    0.862420    3400        91.275168   0.057270    0.512621    30.450998  
[37m[36mINFO[0m[0m 03/08 03:08:39 | 0.925898    0.907186    0.982925    0.904090    0.350306    0.994509    0.916870    0.993070    0.944444    0.925898    0.907186    0.961196    0.850955    3600        96.644295   0.044522    0.512853    30.955100  
[37m[36mINFO[0m[0m 03/08 03:10:54 | 0.927395    0.910180    0.982051    0.892810    0.378286    0.994509    0.885086    0.998401    0.955128    0.927395    0.910180    0.953244    0.838217    3800        102.013423  0.048578    0.515325    32.129302  
[37m[36mINFO[0m[0m 03/08 03:13:08 | 0.893713    0.865269    0.983048    0.907494    0.317506    0.993289    0.899756    0.993070    0.967949    0.893713    0.865269    0.962786    0.854777    4000        107.382550  0.039971    0.512988    30.595707  
[37m[36mINFO[0m[0m 03/08 03:15:20 | 0.892216    0.868263    0.986278    0.912480    0.340405    0.990238    0.904645    0.996269    0.948718    0.892216    0.868263    0.972328    0.884076    4200        112.751678  0.046388    0.512776    30.187475  
[37m[36mINFO[0m[0m 03/08 03:17:34 | 0.920659    0.904192    0.988693    0.917178    0.311633    0.996949    0.914425    0.996802    0.959402    0.920659    0.904192    0.972328    0.877707    4400        118.120805  0.036665    0.513421    30.839953  
[37m[36mINFO[0m[0m 03/08 03:19:47 | 0.892216    0.883234    0.986235    0.916500    0.317338    0.993289    0.921760    0.996269    0.955128    0.892216    0.883234    0.969148    0.872611    4600        123.489933  0.026453    0.513886    30.774471  
[37m[36mINFO[0m[0m 03/08 03:22:01 | 0.901198    0.880240    0.988842    0.911911    0.320097    0.993899    0.907090    0.996802    0.963675    0.901198    0.880240    0.975827    0.864968    4800        128.859060  0.032107    0.513466    30.615251  
[37m[36mINFO[0m[0m 03/08 03:24:14 | 0.903443    0.901198    0.989035    0.910829    0.335200    0.992678    0.892421    0.995736    0.957265    0.903443    0.901198    0.978690    0.882803    5000        134.228188  0.035294    0.513466    31.005031  
[37m[36mINFO[0m[0m 03/08 03:24:15 | Cumulative gradient change saved at train_output/PACS/ERM/[2]/250308_02-27-51_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/08 03:24:19 | ---
[37m[36mINFO[0m[0m 03/08 03:24:19 | test-domain validation(oracle) = 91.841%
[37m[36mINFO[0m[0m 03/08 03:24:19 | training-domain validation(iid) = 92.066%
[37m[36mINFO[0m[0m 03/08 03:24:19 | last = 90.344%
[37m[36mINFO[0m[0m 03/08 03:24:19 | last (inD) = 91.083%
[37m[36mINFO[0m[0m 03/08 03:24:19 | training-domain validation (iid, inD) = 91.718%
[37m[36mINFO[0m[0m 03/08 03:24:20 | === Summary ===
[37m[36mINFO[0m[0m 03/08 03:24:20 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 2 --dataset PACS --trial_seed 2 --hparams_seed 12
[37m[36mINFO[0m[0m 03/08 03:24:20 | Unique name: 250308_02-27-51_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/08 03:24:20 | Out path: train_output/PACS/ERM/[2]/250308_02-27-51_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/08 03:24:20 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/08 03:24:20 | Dataset: PACS

[37m[36mINFO[0m[0m 03/04 00:38:15 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 2 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/PACS/ERM/[2]/250304_00-38-15_clip_vitb16_GENIE
	out_root: train_output/PACS/ERM/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250304_00-38-15_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: clip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/04 00:38:15 | n_steps = 5001
[37m[36mINFO[0m[0m 03/04 00:38:15 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/04 00:38:15 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/04 00:38:15 | 
[37m[36mINFO[0m[0m 03/04 00:38:15 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 03/04 00:38:15 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 03/04 00:38:15 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 03/04 00:38:15 | Batch sizes for each domain: [32, 32, 0, 32] (total=96)
[37m[36mINFO[0m[0m 03/04 00:38:15 | steps-per-epoch for each domain: 51.22, 58.62, 98.25 -> min = 51.22
[37m[36mINFO[0m[0m 03/04 00:38:18 | # of params = 86196231
[37m[36mINFO[0m[0m 03/04 00:38:51 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/04 00:38:51 | 0.108533    0.128743    0.185042    0.165013    1.935851    0.194021    0.166259    0.172175    0.151709    0.108533    0.128743    0.188931    0.177070    0           0.000000    1.930308    1.119908    32.316023  
[37m[36mINFO[0m[0m 03/04 00:40:49 | 0.529192    0.511976    0.531862    0.564155    1.191886    0.507016    0.523227    0.565032    0.636752    0.529192    0.511976    0.523537    0.532484    200         3.904820    1.710584    0.430291    31.533098  
[37m[36mINFO[0m[0m 03/04 00:42:47 | 0.811377    0.781437    0.752304    0.764644    0.689000    0.755949    0.757946    0.809168    0.816239    0.811377    0.781437    0.691794    0.719745    400         7.809640    0.916800    0.429395    32.412871  
[37m[36mINFO[0m[0m 03/04 00:44:45 | 0.809132    0.763473    0.837976    0.839781    0.451094    0.853569    0.823961    0.894456    0.908120    0.809132    0.763473    0.765903    0.787261    600         11.714460   0.579209    0.430867    31.739733  
[37m[36mINFO[0m[0m 03/04 00:46:43 | 0.827844    0.778443    0.845600    0.833466    0.489930    0.852349    0.828851    0.917910    0.899573    0.827844    0.778443    0.766539    0.771975    800         15.619280   0.473290    0.430389    32.330902  
[37m[36mINFO[0m[0m 03/04 00:48:42 | 0.857784    0.823353    0.868716    0.847129    0.423355    0.898109    0.855746    0.927505    0.912393    0.857784    0.823353    0.780534    0.773248    1000        19.524100   0.370907    0.431516    31.928361  
[37m[36mINFO[0m[0m 03/04 00:50:40 | 0.779940    0.727545    0.877786    0.845773    0.444345    0.871263    0.821516    0.944030    0.914530    0.779940    0.727545    0.818066    0.801274    1200        23.428920   0.327956    0.430303    32.110296  
[37m[36mINFO[0m[0m 03/04 00:52:37 | 0.826347    0.805389    0.907968    0.863867    0.388994    0.928005    0.845966    0.960021    0.931624    0.826347    0.805389    0.835878    0.814013    1400        27.333740   0.284661    0.430467    31.352149  
[37m[36mINFO[0m[0m 03/04 00:54:35 | 0.854042    0.826347    0.916411    0.869675    0.387590    0.940818    0.865526    0.961087    0.929487    0.854042    0.826347    0.847328    0.814013    1600        31.238560   0.261719    0.429631    31.563150  
[37m[36mINFO[0m[0m 03/04 00:56:33 | 0.859281    0.832335    0.933190    0.882030    0.334629    0.956071    0.865526    0.978678    0.948718    0.859281    0.832335    0.864822    0.831847    1800        35.143380   0.230576    0.429717    31.975904  
[37m[36mINFO[0m[0m 03/04 00:58:30 | 0.845808    0.805389    0.927934    0.863717    0.399641    0.960952    0.845966    0.963753    0.927350    0.845808    0.805389    0.859097    0.817834    2000        39.048200   0.206747    0.430089    31.764071  
[37m[36mINFO[0m[0m 03/04 01:00:28 | 0.868263    0.871257    0.939993    0.881606    0.387105    0.960342    0.855746    0.982409    0.950855    0.868263    0.871257    0.877226    0.838217    2200        42.953020   0.191489    0.429313    31.947738  
[37m[36mINFO[0m[0m 03/04 01:02:27 | 0.823353    0.790419    0.949279    0.891283    0.345622    0.966443    0.863081    0.986674    0.957265    0.823353    0.790419    0.894720    0.853503    2400        46.857840   0.175826    0.431646    32.143547  
[37m[36mINFO[0m[0m 03/04 01:04:25 | 0.857036    0.880240    0.930052    0.879387    0.367172    0.959121    0.870416    0.967484    0.935897    0.857036    0.880240    0.863550    0.831847    2600        50.762660   0.166885    0.431212    31.861321  
[37m[36mINFO[0m[0m 03/04 01:06:23 | 0.840569    0.814371    0.948336    0.882832    0.374288    0.967663    0.877751    0.982942    0.940171    0.840569    0.814371    0.894402    0.830573    2800        54.667480   0.152287    0.431707    32.380555  
[37m[36mINFO[0m[0m 03/04 01:08:21 | 0.842814    0.823353    0.955151    0.884119    0.362691    0.980476    0.867971    0.982942    0.948718    0.842814    0.823353    0.902036    0.835669    3000        58.572300   0.141712    0.430977    31.630341  
[37m[36mINFO[0m[0m 03/04 01:10:19 | 0.857784    0.838323    0.953889    0.885324    0.361155    0.968273    0.872861    0.990405    0.948718    0.857784    0.838323    0.902990    0.834395    3200        62.477120   0.127356    0.429639    31.634241  
[37m[36mINFO[0m[0m 03/04 01:12:16 | 0.885479    0.874251    0.965166    0.901268    0.308904    0.987797    0.897311    0.988806    0.952991    0.885479    0.874251    0.918893    0.853503    3400        66.381940   0.115566    0.430099    31.498083  
[37m[36mINFO[0m[0m 03/04 01:14:14 | 0.894461    0.883234    0.964391    0.910576    0.330001    0.992068    0.909535    0.985075    0.950855    0.894461    0.883234    0.916031    0.871338    3600        70.286760   0.109988    0.429716    31.536594  
[37m[36mINFO[0m[0m 03/04 01:16:11 | 0.828593    0.802395    0.969177    0.891358    0.370735    0.985967    0.875306    0.984542    0.940171    0.828593    0.802395    0.937023    0.858599    3800        74.191580   0.109440    0.429891    31.468552  
[37m[36mINFO[0m[0m 03/04 01:18:09 | 0.861527    0.841317    0.967616    0.902693    0.336255    0.982306    0.877751    0.991471    0.961538    0.861527    0.841317    0.929071    0.868790    4000        78.096400   0.087458    0.430735    32.001336  
[37m[36mINFO[0m[0m 03/04 01:20:08 | 0.877994    0.871257    0.966595    0.897173    0.327483    0.989628    0.887531    0.992537    0.959402    0.877994    0.871257    0.917621    0.844586    4200        82.001220   0.087833    0.428560    32.321582  
[37m[36mINFO[0m[0m 03/04 01:22:06 | 0.857784    0.871257    0.971266    0.903508    0.316689    0.988408    0.880196    0.986141    0.961538    0.857784    0.871257    0.939249    0.868790    4400        85.906040   0.089759    0.431214    32.259806  
[37m[36mINFO[0m[0m 03/04 01:24:05 | 0.857784    0.856287    0.967805    0.882982    0.398495    0.986577    0.887531    0.992537    0.942308    0.857784    0.856287    0.924300    0.819108    4600        89.810860   0.088071    0.431763    33.022001  
[37m[36mINFO[0m[0m 03/04 01:26:03 | 0.867515    0.850299    0.975343    0.911726    0.324563    0.990848    0.909535    0.993070    0.959402    0.867515    0.850299    0.942112    0.866242    4800        93.715680   0.067010    0.429774    32.027236  
[37m[36mINFO[0m[0m 03/04 01:28:02 | 0.848802    0.838323    0.974515    0.898152    0.346329    0.993289    0.904645    0.984009    0.933761    0.848802    0.838323    0.946247    0.856051    5000        97.620500   0.084417    0.431451    31.837262  
[37m[36mINFO[0m[0m 03/04 01:28:02 | Cumulative gradient change saved at train_output/PACS/ERM/[2]/250304_00-38-15_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/04 01:28:04 | ---
[37m[36mINFO[0m[0m 03/04 01:28:04 | test-domain validation(oracle) = 89.446%
[37m[36mINFO[0m[0m 03/04 01:28:04 | training-domain validation(iid) = 86.751%
[37m[36mINFO[0m[0m 03/04 01:28:04 | last = 84.880%
[37m[36mINFO[0m[0m 03/04 01:28:04 | last (inD) = 89.815%
[37m[36mINFO[0m[0m 03/04 01:28:04 | training-domain validation (iid, inD) = 91.173%
[37m[36mINFO[0m[0m 03/04 01:28:04 | === Summary ===
[37m[36mINFO[0m[0m 03/04 01:28:04 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 2 --dataset PACS
[37m[36mINFO[0m[0m 03/04 01:28:04 | Unique name: 250304_00-38-15_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/04 01:28:04 | Out path: train_output/PACS/ERM/[2]/250304_00-38-15_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/04 01:28:04 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/04 01:28:04 | Dataset: PACS

[37m[36mINFO[0m[0m 03/14 07:53:56 | Command :: /jsm0707/GENIE/train_all.py resnet50_signum config/resnet50_signum.yaml --algorithm ERM --test_envs 2 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_signum.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_signum
	out_dir: train_output/PACS/ERM/[2]/250314_07-53-56_resnet50_signum
	out_root: train_output/PACS/ERM/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250314_07-53-56_resnet50_signum
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: signum
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 03/14 07:53:56 | n_steps = 5001
[37m[36mINFO[0m[0m 03/14 07:53:56 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/14 07:53:56 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/14 07:53:56 | 
[37m[36mINFO[0m[0m 03/14 07:53:56 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 03/14 07:53:56 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 03/14 07:53:56 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 03/14 07:53:56 | Batch sizes for each domain: [32, 32, 0, 32] (total=96)
[37m[36mINFO[0m[0m 03/14 07:53:56 | steps-per-epoch for each domain: 51.22, 58.62, 98.25 -> min = 51.22
[37m[36mINFO[0m[0m 03/14 07:53:57 | # of params = 23522375
[37m[36mINFO[0m[0m 03/14 07:54:29 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/14 07:54:29 | 0.169162    0.167665    0.218547    0.220459    1.863360    0.224527    0.244499    0.236141    0.250000    0.169162    0.167665    0.194975    0.166879    0           0.000000    1.977479    1.046910    30.386379  
[37m[36mINFO[0m[0m 03/14 07:55:38 | 0.887725    0.862275    0.864306    0.873881    0.504974    0.851739    0.860636    0.861407    0.878205    0.887725    0.862275    0.879771    0.882803    200         3.904820    0.522140    0.189983    31.545965  
[37m[36mINFO[0m[0m 03/14 07:56:48 | 0.933383    0.910180    0.939004    0.931465    0.370044    0.945088    0.933985    0.941898    0.950855    0.933383    0.910180    0.930025    0.909554    400         7.809640    0.300679    0.191091    31.339795  
[37m[36mINFO[0m[0m 03/14 07:57:57 | 0.887725    0.856287    0.846979    0.849527    0.704859    0.841367    0.841076    0.852878    0.878205    0.887725    0.856287    0.846692    0.829299    600         11.714460   0.419136    0.184940    31.808167  
[37m[36mINFO[0m[0m 03/14 07:59:14 | 0.902695    0.883234    0.851319    0.858766    0.476584    0.853569    0.867971    0.866738    0.873932    0.902695    0.883234    0.833651    0.834395    800         15.619280   0.524839    0.233417    30.736089  
[37m[36mINFO[0m[0m 03/14 08:00:33 | 0.845808    0.811377    0.763947    0.775787    0.851835    0.735815    0.721271    0.777719    0.822650    0.845808    0.811377    0.778308    0.783439    1000        19.524100   0.704694    0.243260    30.138512  
[37m[36mINFO[0m[0m 03/14 08:01:40 | 0.845060    0.805389    0.847535    0.843931    1.131960    0.840757    0.828851    0.862473    0.895299    0.845060    0.805389    0.839377    0.807643    1200        23.428920   0.697327    0.183419    30.281743  
[37m[36mINFO[0m[0m 03/14 08:03:00 | 0.728293    0.697605    0.730925    0.728573    1.765880    0.724222    0.726161    0.680704    0.683761    0.728293    0.697605    0.787850    0.775796    1400        27.333740   0.963391    0.239675    31.752044  
[37m[36mINFO[0m[0m 03/14 08:04:18 | 0.595060    0.541916    0.402477    0.406243    2.022497    0.496034    0.501222    0.459488    0.448718    0.595060    0.541916    0.251908    0.268790    1600        31.238560   1.837412    0.236225    31.080083  
[37m[36mINFO[0m[0m 03/14 08:05:25 | 0.619760    0.619760    0.481852    0.503208    2.309253    0.498475    0.520782    0.497335    0.514957    0.619760    0.619760    0.449746    0.473885    1800        35.143380   2.721216    0.182081    30.629142  
[37m[36mINFO[0m[0m 03/14 08:06:45 | 0.319611    0.347305    0.314294    0.326477    2.034523    0.315436    0.312958    0.347548    0.369658    0.319611    0.347305    0.279898    0.296815    2000        39.048200   2.749394    0.240429    31.362987  
[37m[36mINFO[0m[0m 03/14 08:08:04 | 0.390719    0.404192    0.369833    0.371410    1.604842    0.380720    0.378973    0.458422    0.502137    0.390719    0.404192    0.270356    0.233121    2200        42.953020   2.649871    0.236240    32.151183  
[37m[36mINFO[0m[0m 03/14 08:09:11 | 0.386976    0.392216    0.344760    0.358021    1.680242    0.280049    0.283619    0.440299    0.500000    0.386976    0.392216    0.313931    0.290446    2400        46.857840   2.587719    0.182275    30.714483  
[37m[36mINFO[0m[0m 03/14 08:10:32 | 0.282934    0.275449    0.296540    0.305856    1.788705    0.224527    0.227384    0.310768    0.358974    0.282934    0.275449    0.354326    0.331210    2600        50.762660   2.508745    0.246627    31.700574  
[37m[36mINFO[0m[0m 03/14 08:11:49 | 0.461078    0.464072    0.292031    0.304890    1.802591    0.359976    0.352078    0.308102    0.326923    0.461078    0.464072    0.208015    0.235669    2800        54.667480   2.146388    0.230961    31.096380  
[37m[36mINFO[0m[0m 03/14 08:12:56 | 0.166168    0.182635    0.102878    0.100182    7.373042    0.147651    0.132029    0.123134    0.123932    0.166168    0.182635    0.037850    0.044586    3000        58.572300   2.095750    0.182387    30.391269  
[37m[36mINFO[0m[0m 03/14 08:14:20 | 0.247006    0.257485    0.261200    0.267716    2.318657    0.256864    0.249389    0.253198    0.273504    0.247006    0.257485    0.273537    0.280255    3200        62.477120   2.244024    0.255722    32.657931  
[37m[36mINFO[0m[0m 03/14 08:15:36 | 0.268713    0.293413    0.301235    0.350873    1.765386    0.233069    0.268949    0.296908    0.369658    0.268713    0.293413    0.373728    0.414013    3400        66.381940   2.015681    0.224179    30.789984  
[37m[36mINFO[0m[0m 03/14 08:16:43 | 0.404192    0.383234    0.359613    0.371864    1.593733    0.372178    0.359413    0.350746    0.386752    0.404192    0.383234    0.355916    0.369427    3600        70.286760   2.061264    0.182368    30.632543  
[37m[36mINFO[0m[0m 03/14 08:18:06 | 0.173653    0.164671    0.198070    0.218077    2.222792    0.113484    0.117359    0.176972    0.222222    0.173653    0.164671    0.303753    0.314650    3800        74.191580   2.031271    0.260867    30.624392  
[37m[36mINFO[0m[0m 03/14 08:19:21 | 0.419910    0.416168    0.365434    0.385089    1.966567    0.312996    0.278729    0.349147    0.416667    0.419910    0.416168    0.434160    0.459873    4000        78.096400   1.906724    0.223602    30.465298  
[37m[36mINFO[0m[0m 03/14 08:20:28 | 0.383982    0.362275    0.319502    0.306192    1.727752    0.315436    0.268949    0.316098    0.324786    0.383982    0.362275    0.326972    0.324841    4200        82.001220   1.925383    0.184485    30.363312  
[37m[36mINFO[0m[0m 03/14 08:21:51 | 0.378743    0.380240    0.351853    0.372474    1.645553    0.330079    0.288509    0.340618    0.405983    0.378743    0.380240    0.384860    0.422930    4400        85.906040   1.898332    0.256645    31.060615  
[37m[36mINFO[0m[0m 03/14 08:23:07 | 0.301647    0.311377    0.286062    0.323581    2.147153    0.258694    0.281174    0.296375    0.329060    0.301647    0.311377    0.303117    0.360510    4600        89.810860   1.854136    0.223309    31.396143  
[37m[36mINFO[0m[0m 03/14 08:24:15 | 0.324850    0.338323    0.336292    0.335429    1.654962    0.315436    0.271394    0.336887    0.378205    0.324850    0.338323    0.356552    0.356688    4800        93.715680   1.885131    0.182793    31.896590  
[37m[36mINFO[0m[0m 03/14 08:25:38 | 0.372006    0.392216    0.297706    0.293056    1.941255    0.314216    0.283619    0.272921    0.301282    0.372006    0.392216    0.305980    0.294268    5000        97.620500   1.856116    0.257154    31.306431  
[37m[36mINFO[0m[0m 03/14 08:25:38 | Cumulative gradient change saved at train_output/PACS/ERM/[2]/250314_07-53-56_resnet50_signum/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/14 08:25:39 | ---
[37m[36mINFO[0m[0m 03/14 08:25:39 | test-domain validation(oracle) = 93.338%
[37m[36mINFO[0m[0m 03/14 08:25:39 | training-domain validation(iid) = 93.338%
[37m[36mINFO[0m[0m 03/14 08:25:39 | last = 37.201%
[37m[36mINFO[0m[0m 03/14 08:25:39 | last (inD) = 29.306%
[37m[36mINFO[0m[0m 03/14 08:25:39 | training-domain validation (iid, inD) = 93.146%
[37m[36mINFO[0m[0m 03/14 08:25:39 | === Summary ===
[37m[36mINFO[0m[0m 03/14 08:25:39 | Command: /jsm0707/GENIE/train_all.py resnet50_signum config/resnet50_signum.yaml --algorithm ERM --test_envs 2 --dataset PACS
[37m[36mINFO[0m[0m 03/14 08:25:39 | Unique name: 250314_07-53-56_resnet50_signum
[37m[36mINFO[0m[0m 03/14 08:25:39 | Out path: train_output/PACS/ERM/[2]/250314_07-53-56_resnet50_signum
[37m[36mINFO[0m[0m 03/14 08:25:39 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/14 08:25:39 | Dataset: PACS

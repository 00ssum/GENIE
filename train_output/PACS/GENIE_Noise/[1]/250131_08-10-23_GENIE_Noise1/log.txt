[37m[36mINFO[0m[0m 01/31 08:10:23 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py GENIE_Noise1 config/resnet50_sgd.yaml --trial_seed 1 --hparams_seed 12 --algorithm GENIE_Noise --test_envs 1 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: GENIE_Noise
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 12
	in_domain: False
	model_save: None
	mpa: False
	name: GENIE_Noise1
	out_dir: train_output/PACS/GENIE_Noise/[1]/250131_08-10-23_GENIE_Noise1
	out_root: train_output/PACS/GENIE_Noise/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250131_08-10-23_GENIE_Noise1
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 3.0065625733392338e-05
	batch_size: 34
	weight_decay: 4.89485556145273e-06
	momentum: 0.8947990666023307
	convergence_rate: 0.07002445517972558
	moving_avg: 0.9276277614189328
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 01/31 08:10:23 | n_steps = 5001
[37m[36mINFO[0m[0m 01/31 08:10:23 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/31 08:10:23 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/31 08:10:23 | Target test envs = [[1]]
[37m[36mINFO[0m[0m 01/31 08:10:23 | 
[37m[36mINFO[0m[0m 01/31 08:10:23 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 01/31 08:10:23 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 01/31 08:10:23 | Batch sizes for each domain: [34, 0, 34, 34] (total=102)
[37m[36mINFO[0m[0m 01/31 08:10:23 | steps-per-epoch for each domain: 48.21, 39.29, 92.47 -> min = 39.29
[37m[36mINFO[0m[0m 01/31 08:10:24 | # of params = 23522375
[37m[36mINFO[0m[0m 01/31 08:10:57 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/31 08:10:57 | 0.264392    0.290598    0.250237    0.269996    1.883028    0.196461    0.222494    0.264392    0.290598    0.308383    0.326347    0.245865    0.261146    0           0.000000    2.001022    1.042444    31.611178  
[37m[36mINFO[0m[0m 01/31 08:12:16 | 0.711620    0.688034    0.929693    0.925155    0.252408    0.877974    0.853301    0.711620    0.688034    0.969311    0.982036    0.941794    0.940127    200         5.089820    0.337398    0.241944    30.756180  
[37m[36mINFO[0m[0m 01/31 08:13:38 | 0.776652    0.760684    0.970043    0.949190    0.168415    0.959732    0.916870    0.776652    0.760684    0.989521    0.988024    0.960878    0.942675    400         10.179641   0.140439    0.246282    32.467296  
[37m[36mINFO[0m[0m 01/31 08:15:10 | 0.725480    0.726496    0.976140    0.946482    0.196323    0.971324    0.907090    0.725480    0.726496    0.991766    0.982036    0.965331    0.950318    600         15.269461   0.083824    0.285939    34.177203  
[37m[36mINFO[0m[0m 01/31 08:16:40 | 0.736141    0.726496    0.958278    0.937636    0.194617    0.949359    0.909535    0.736141    0.726496    0.976048    0.967066    0.949427    0.936306    800         20.359281   0.071245    0.289350    32.326745  
[37m[36mINFO[0m[0m 01/31 08:18:06 | 0.806503    0.786325    0.985988    0.960015    0.132447    0.982306    0.941320    0.806503    0.786325    0.992515    0.982036    0.983142    0.956688    1000        25.449102   0.061492    0.273572    30.805983  
[37m[36mINFO[0m[0m 01/31 08:19:28 | 0.773454    0.767094    0.992521    0.969563    0.119532    0.990848    0.958435    0.773454    0.767094    0.996257    0.991018    0.990458    0.959236    1200        30.538922   0.043077    0.254842    31.218907  
[37m[36mINFO[0m[0m 01/31 08:20:58 | 0.832623    0.831197    0.988782    0.958270    0.164090    0.985357    0.933985    0.832623    0.831197    0.996257    0.979042    0.984733    0.961783    1400        35.628743   0.039729    0.289667    31.292523  
[37m[36mINFO[0m[0m 01/31 08:22:28 | 0.745736    0.745726    0.990392    0.957684    0.149887    0.988408    0.936430    0.745736    0.745726    0.993263    0.985030    0.989504    0.951592    1600        40.718563   0.030265    0.292875    31.749303  
[37m[36mINFO[0m[0m 01/31 08:23:53 | 0.779318    0.775641    0.978996    0.945154    0.260185    0.984137    0.929095    0.779318    0.775641    0.991018    0.970060    0.961832    0.936306    1800        45.808383   0.034835    0.267272    31.499662  
[37m[36mINFO[0m[0m 01/31 08:25:16 | 0.776119    0.779915    0.994919    0.966693    0.130647    0.996339    0.951100    0.776119    0.779915    0.997006    0.991018    0.991412    0.957962    2000        50.898204   0.028183    0.253284    31.850562  
[37m[36mINFO[0m[0m 01/31 08:26:47 | 0.825693    0.814103    0.990552    0.947860    0.190831    0.987187    0.919315    0.825693    0.814103    0.994012    0.979042    0.990458    0.945223    2200        55.988024   0.022866    0.286128    34.569549  
[37m[36mINFO[0m[0m 01/31 08:28:21 | 0.738806    0.709402    0.993811    0.958728    0.163071    0.992678    0.943765    0.738806    0.709402    0.999251    0.991018    0.989504    0.941401    2400        61.077844   0.023287    0.292206    35.628548  
[37m[36mINFO[0m[0m 01/31 08:29:52 | 0.810235    0.799145    0.993862    0.948665    0.165338    0.993899    0.931540    0.810235    0.799145    0.998503    0.973054    0.989186    0.941401    2600        66.167665   0.022621    0.274404    35.372116  
[37m[36mINFO[0m[0m 01/31 08:31:21 | 0.828891    0.809829    0.992833    0.967118    0.127216    0.993899    0.951100    0.828891    0.809829    0.997006    0.991018    0.987595    0.959236    2800        71.257485   0.026882    0.269997    35.107614  
[37m[36mINFO[0m[0m 01/31 08:32:56 | 0.771855    0.764957    0.994980    0.954893    0.170546    0.992068    0.914425    0.771855    0.764957    0.997006    0.991018    0.995865    0.959236    3000        76.347305   0.013828    0.296487    36.161488  
[37m[36mINFO[0m[0m 01/31 08:34:25 | 0.796908    0.773504    0.995060    0.954027    0.172527    0.993899    0.941320    0.796908    0.773504    0.997006    0.964072    0.994275    0.956688    3200        81.437126   0.012684    0.288294    31.497937  
[37m[36mINFO[0m[0m 01/31 08:36:00 | 0.764925    0.754274    0.994186    0.956572    0.179600    0.990848    0.933985    0.764925    0.754274    0.997754    0.979042    0.993957    0.956688    3400        86.526946   0.011331    0.286130    37.237328  
[37m[36mINFO[0m[0m 01/31 08:37:21 | 0.835288    0.820513    0.995490    0.963102    0.131900    0.993899    0.943765    0.835288    0.820513    0.999251    0.985030    0.993321    0.960510    3600        91.616766   0.014877    0.249953    31.172684  
[37m[36mINFO[0m[0m 01/31 08:38:51 | 0.788380    0.769231    0.997060    0.969483    0.116056    0.997559    0.953545    0.788380    0.769231    0.997754    0.988024    0.995865    0.966879    3800        96.706587   0.019590    0.279429    34.521439  
[37m[36mINFO[0m[0m 01/31 08:40:27 | 0.809701    0.782051    0.996344    0.960886    0.173473    0.995729    0.941320    0.809701    0.782051    0.997754    0.991018    0.995547    0.950318    4000        101.796407  0.006096    0.289426    37.645861  
[37m[36mINFO[0m[0m 01/31 08:41:56 | 0.796908    0.784188    0.997466    0.963836    0.141224    0.998780    0.941320    0.796908    0.784188    0.997754    0.982036    0.995865    0.968153    4200        106.886228  0.017703    0.284636    31.619171  
[37m[36mINFO[0m[0m 01/31 08:43:17 | 0.800640    0.769231    0.996889    0.962162    0.152404    0.995119    0.948655    0.800640    0.769231    1.000000    0.976048    0.995547    0.961783    4400        111.976048  0.010132    0.241963    32.877753  
[37m[36mINFO[0m[0m 01/31 08:44:45 | 0.787846    0.773504    0.997499    0.962414    0.155076    0.996949    0.941320    0.787846    0.773504    1.000000    0.979042    0.995547    0.966879    4600        117.065868  0.012122    0.275378    33.618934  
[37m[36mINFO[0m[0m 01/31 08:46:15 | 0.825693    0.833333    0.999381    0.966706    0.178567    0.998780    0.948655    0.825693    0.833333    1.000000    0.982036    0.999364    0.969427    4800        122.155689  0.007953    0.285768    31.860817  
[37m[36mINFO[0m[0m 01/31 08:47:50 | 0.819296    0.797009    0.999470    0.958385    0.169066    1.000000    0.936430    0.819296    0.797009    1.000000    0.982036    0.998410    0.956688    5000        127.245509  0.008480    0.288366    37.734812  
[37m[36mINFO[0m[0m 01/31 08:47:50 | Cumulative gradient change saved at train_output/PACS/GENIE_Noise/[1]/250131_08-10-23_GENIE_Noise1/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/31 08:47:51 | ---
[37m[36mINFO[0m[0m 01/31 08:47:51 | test-domain validation(oracle) = 82.569%
[37m[36mINFO[0m[0m 01/31 08:47:51 | training-domain validation(iid) = 77.345%
[37m[36mINFO[0m[0m 01/31 08:47:51 | last = 81.930%
[37m[36mINFO[0m[0m 01/31 08:47:51 | last (inD) = 95.838%
[37m[36mINFO[0m[0m 01/31 08:47:51 | training-domain validation (iid, inD) = 96.956%
[37m[36mINFO[0m[0m 01/31 08:47:52 | === Summary ===
[37m[36mINFO[0m[0m 01/31 08:47:52 | Command: /jsm0707/DomainBed/Large-scale/train_all.py GENIE_Noise1 config/resnet50_sgd.yaml --trial_seed 1 --hparams_seed 12 --algorithm GENIE_Noise --test_envs 1 --dataset PACS
[37m[36mINFO[0m[0m 01/31 08:47:52 | Unique name: 250131_08-10-23_GENIE_Noise1
[37m[36mINFO[0m[0m 01/31 08:47:52 | Out path: train_output/PACS/GENIE_Noise/[1]/250131_08-10-23_GENIE_Noise1
[37m[36mINFO[0m[0m 01/31 08:47:52 | Algorithm: GENIE_Noise
[37m[36mINFO[0m[0m 01/31 08:47:52 | Dataset: PACS
[37m[36mINFO[0m[0m 01/31 08:47:52 | Max test_in: 0.8353

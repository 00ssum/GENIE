[37m[36mINFO[0m[0m 01/30 19:47:57 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py GENIE_p1 config/resnet50_sgd.yaml --trial_seed 1 --hparams_seed 12 --algorithm GENIE_p --test_envs 1 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: GENIE_p
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 12
	in_domain: False
	model_save: None
	mpa: False
	name: GENIE_p1
	out_dir: train_output/PACS/GENIE_p/[1]/250130_19-47-57_GENIE_p1
	out_root: train_output/PACS/GENIE_p/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250130_19-47-57_GENIE_p1
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 3.0065625733392338e-05
	batch_size: 34
	weight_decay: 4.89485556145273e-06
	momentum: 0.8947990666023307
	convergence_rate: 0.07002445517972558
	moving_avg: 0.9276277614189328
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 01/30 19:47:57 | n_steps = 5001
[37m[36mINFO[0m[0m 01/30 19:47:57 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/30 19:47:57 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/30 19:47:57 | Target test envs = [[1]]
[37m[36mINFO[0m[0m 01/30 19:47:57 | 
[37m[36mINFO[0m[0m 01/30 19:47:57 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 01/30 19:47:57 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 01/30 19:47:57 | Batch sizes for each domain: [34, 0, 34, 34] (total=102)
[37m[36mINFO[0m[0m 01/30 19:47:57 | steps-per-epoch for each domain: 48.21, 39.29, 92.47 -> min = 39.29
[37m[36mINFO[0m[0m 01/30 19:47:59 | # of params = 23522375
[37m[36mINFO[0m[0m 01/30 19:48:32 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/30 19:48:32 | 0.276119    0.309829    0.247838    0.268722    1.882634    0.198902    0.222494    0.276119    0.309829    0.297156    0.326347    0.247455    0.257325    0           0.000000    2.001022    1.346181    31.634597  
[37m[36mINFO[0m[0m 01/30 19:50:03 | 0.738806    0.726496    0.936478    0.926925    0.235186    0.910921    0.887531    0.738806    0.726496    0.972305    0.976048    0.926209    0.917197    200         5.089820    0.342903    0.263158    38.258797  
[37m[36mINFO[0m[0m 01/30 19:51:47 | 0.807036    0.792735    0.956384    0.928233    0.223200    0.939597    0.885086    0.807036    0.792735    0.982036    0.976048    0.947519    0.923567    400         10.179641   0.138659    0.362336    31.377534  
[37m[36mINFO[0m[0m 01/30 19:53:19 | 0.811834    0.782051    0.969782    0.942338    0.206464    0.962782    0.899756    0.811834    0.782051    0.987275    0.982036    0.959288    0.945223    600         15.269461   0.097530    0.259876    39.659287  
[37m[36mINFO[0m[0m 01/30 19:55:00 | 0.766525    0.747863    0.974606    0.955136    0.162441    0.965223    0.936430    0.766525    0.747863    0.993263    0.985030    0.965331    0.943949    800         20.359281   0.073327    0.341242    32.439753  
[37m[36mINFO[0m[0m 01/30 19:56:23 | 0.805970    0.779915    0.988920    0.957304    0.159287    0.988408    0.924205    0.805970    0.779915    0.997754    0.991018    0.980598    0.956688    1000        25.449102   0.048527    0.249102    32.962653  
[37m[36mINFO[0m[0m 01/30 19:57:56 | 0.845416    0.820513    0.989771    0.964031    0.130741    0.982916    0.948655    0.845416    0.820513    0.996257    0.988024    0.990140    0.955414    1200        30.538922   0.045230    0.298347    33.140646  
[37m[36mINFO[0m[0m 01/30 19:59:31 | 0.788380    0.773504    0.985614    0.951772    0.166826    0.979256    0.914425    0.788380    0.773504    0.994760    0.988024    0.982824    0.952866    1400        35.628743   0.038746    0.300952    34.831752  
[37m[36mINFO[0m[0m 01/30 20:01:00 | 0.810235    0.809829    0.989964    0.954883    0.189043    0.984747    0.924205    0.810235    0.809829    0.998503    0.985030    0.986641    0.955414    1600        40.718563   0.025229    0.250819    38.069837  
[37m[36mINFO[0m[0m 01/30 20:02:29 | 0.802772    0.788462    0.985930    0.952187    0.221919    0.981086    0.924205    0.802772    0.788462    0.991018    0.982036    0.985687    0.950318    1800        45.808383   0.020580    0.273132    34.938284  
[37m[36mINFO[0m[0m 01/30 20:04:02 | 0.822495    0.786325    0.993801    0.956493    0.179230    0.995119    0.948655    0.822495    0.786325    0.995509    0.973054    0.990776    0.947771    2000        50.898204   0.029103    0.266732    39.499133  
[37m[36mINFO[0m[0m 01/30 20:05:27 | 0.813433    0.807692    0.993627    0.963458    0.132912    0.995119    0.948655    0.813433    0.807692    0.996257    0.985030    0.989504    0.956688    2200        55.988024   0.031345    0.254261    34.628375  
[37m[36mINFO[0m[0m 01/30 20:07:01 | 0.788913    0.786325    0.993894    0.960874    0.167121    0.993899    0.931540    0.788913    0.786325    0.997006    0.988024    0.990776    0.963057    2400        61.077844   0.021259    0.305876    32.313000  
[37m[36mINFO[0m[0m 01/30 20:08:33 | 0.852878    0.841880    0.990296    0.953416    0.153788    0.985967    0.936430    0.852878    0.841880    0.997006    0.976048    0.987913    0.947771    2600        66.167665   0.026275    0.261998    39.894025  
[37m[36mINFO[0m[0m 01/30 20:09:56 | 0.809168    0.788462    0.996140    0.960152    0.130364    0.995119    0.931540    0.809168    0.788462    0.997754    0.982036    0.995547    0.966879    2800        71.257485   0.021027    0.247555    32.818208  
[37m[36mINFO[0m[0m 01/30 20:11:41 | 0.820362    0.805556    0.995747    0.960303    0.169325    0.995119    0.938875    0.820362    0.805556    0.996257    0.970060    0.995865    0.971975    3000        76.347305   0.012990    0.309823    43.401502  
[37m[36mINFO[0m[0m 01/30 20:13:03 | 0.814499    0.801282    0.998966    0.970115    0.112854    0.998170    0.958435    0.814499    0.801282    1.000000    0.985030    0.998728    0.966879    3200        81.437126   0.015471    0.251823    32.019383  
[37m[36mINFO[0m[0m 01/30 20:14:45 | 0.805437    0.799145    0.995465    0.952175    0.186310    0.990848    0.914425    0.805437    0.799145    1.000000    0.979042    0.995547    0.963057    3400        86.526946   0.012730    0.315354    38.713094  
[37m[36mINFO[0m[0m 01/30 20:16:07 | 0.813966    0.805556    0.994238    0.955825    0.165638    0.992068    0.926650    0.813966    0.805556    0.997006    0.979042    0.993639    0.961783    3600        91.616766   0.010553    0.251151    31.181608  
[37m[36mINFO[0m[0m 01/30 20:17:38 | 0.784648    0.775641    0.995653    0.955549    0.195101    0.996949    0.926650    0.784648    0.775641    0.997006    0.982036    0.993003    0.957962    3800        96.706587   0.014452    0.267858    37.485402  
[37m[36mINFO[0m[0m 01/30 20:19:15 | 0.823028    0.794872    0.996491    0.971513    0.124790    0.993289    0.951100    0.823028    0.794872    1.000000    0.994012    0.996183    0.969427    4000        101.796407  0.014823    0.301479    36.782145  
[37m[36mINFO[0m[0m 01/30 20:20:47 | 0.817164    0.790598    0.996986    0.959486    0.164530    0.995729    0.929095    0.817164    0.790598    1.000000    0.985030    0.995229    0.964331    4200        106.886228  0.014430    0.285771    34.915220  
[37m[36mINFO[0m[0m 01/30 20:22:27 | 0.782516    0.771368    0.996390    0.959466    0.171089    0.995119    0.948655    0.782516    0.771368    0.998503    0.973054    0.995547    0.956688    4400        111.976048  0.014736    0.285546    42.639043  
[37m[36mINFO[0m[0m 01/30 20:24:02 | 0.809701    0.792735    0.998338    0.966350    0.132061    0.997559    0.943765    0.809701    0.792735    1.000000    0.982036    0.997455    0.973248    4600        117.065868  0.006028    0.310559    32.677256  
[37m[36mINFO[0m[0m 01/30 20:25:34 | 0.745203    0.737179    0.993439    0.952197    0.203093    0.989018    0.914425    0.745203    0.737179    0.999251    0.988024    0.992048    0.954140    4800        122.155689  0.012151    0.242998    43.372639  
[37m[36mINFO[0m[0m 01/30 20:27:16 | 0.789979    0.788462    0.996703    0.959200    0.156608    0.993289    0.938875    0.789979    0.788462    1.000000    0.982036    0.996819    0.956688    5000        127.245509  0.011451    0.348044    32.068858  
[37m[36mINFO[0m[0m 01/30 20:27:16 | Cumulative gradient change saved at train_output/PACS/GENIE_p/[1]/250130_19-47-57_GENIE_p1/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/30 20:27:17 | ---
[37m[36mINFO[0m[0m 01/30 20:27:17 | test-domain validation(oracle) = 85.288%
[37m[36mINFO[0m[0m 01/30 20:27:17 | training-domain validation(iid) = 82.303%
[37m[36mINFO[0m[0m 01/30 20:27:17 | last = 78.998%
[37m[36mINFO[0m[0m 01/30 20:27:17 | last (inD) = 95.920%
[37m[36mINFO[0m[0m 01/30 20:27:17 | training-domain validation (iid, inD) = 97.151%
[37m[36mINFO[0m[0m 01/30 20:27:17 | === Summary ===
[37m[36mINFO[0m[0m 01/30 20:27:17 | Command: /jsm0707/DomainBed/Large-scale/train_all.py GENIE_p1 config/resnet50_sgd.yaml --trial_seed 1 --hparams_seed 12 --algorithm GENIE_p --test_envs 1 --dataset PACS
[37m[36mINFO[0m[0m 01/30 20:27:17 | Unique name: 250130_19-47-57_GENIE_p1
[37m[36mINFO[0m[0m 01/30 20:27:17 | Out path: train_output/PACS/GENIE_p/[1]/250130_19-47-57_GENIE_p1
[37m[36mINFO[0m[0m 01/30 20:27:17 | Algorithm: GENIE_p
[37m[36mINFO[0m[0m 01/30 20:27:17 | Dataset: PACS
[37m[36mINFO[0m[0m 01/30 20:27:17 | Max test_in: 0.8529

[37m[36mINFO[0m[0m 01/30 20:57:23 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py GENIE_p3 config/resnet50_sgd.yaml --trial_seed 0 --hparams_seed 18 --algorithm GENIE_p --test_envs 3 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: GENIE_p
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 18
	in_domain: False
	model_save: None
	mpa: False
	name: GENIE_p3
	out_dir: train_output/PACS/GENIE_p/[3]/250130_20-57-23_GENIE_p3
	out_root: train_output/PACS/GENIE_p/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250130_20-57-23_GENIE_p3
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 0.00021894640154701087
	batch_size: 13
	weight_decay: 7.1565884139944e-05
	momentum: 0.8683802947171396
	convergence_rate: 0.012803366168469622
	moving_avg: 0.9263892108829195
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 01/30 20:57:23 | n_steps = 5001
[37m[36mINFO[0m[0m 01/30 20:57:23 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/30 20:57:23 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/30 20:57:23 | Target test envs = [[3]]
[37m[36mINFO[0m[0m 01/30 20:57:23 | 
[37m[36mINFO[0m[0m 01/30 20:57:23 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 01/30 20:57:23 | Test envs = [3], name = te_S
[37m[36mINFO[0m[0m 01/30 20:57:23 | Batch sizes for each domain: [13, 13, 13, 0] (total=39)
[37m[36mINFO[0m[0m 01/30 20:57:23 | steps-per-epoch for each domain: 126.08, 144.31, 102.77 -> min = 102.77
[37m[36mINFO[0m[0m 01/30 20:57:25 | # of params = 23522375
[37m[36mINFO[0m[0m 01/30 20:57:58 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/30 20:57:58 | 0.197837    0.200000    0.212703    0.202606    1.933010    0.220866    0.202934    0.212154    0.192308    0.205090    0.212575    0.197837    0.200000    0           0.000000    2.002535    1.150851    32.367279  
[37m[36mINFO[0m[0m 01/30 20:58:53 | 0.603372    0.617834    0.915581    0.916090    0.237384    0.902379    0.911980    0.875800    0.878205    0.968563    0.958084    0.603372    0.617834    200         1.946108    0.401267    0.115638    31.446467  
[37m[36mINFO[0m[0m 01/30 20:59:58 | 0.657761    0.664968    0.951177    0.928008    0.210981    0.947529    0.897311    0.930704    0.931624    0.975299    0.955090    0.657761    0.664968    400         3.892216    0.163513    0.133408    38.695829  
[37m[36mINFO[0m[0m 01/30 21:01:18 | 0.705471    0.726115    0.970510    0.952388    0.135074    0.957291    0.931540    0.963220    0.946581    0.991018    0.979042    0.705471    0.726115    600         5.838323    0.119661    0.196534    39.705894  
[37m[36mINFO[0m[0m 01/30 21:02:16 | 0.721692    0.731210    0.978741    0.964260    0.134717    0.971324    0.946210    0.973881    0.961538    0.991018    0.985030    0.721692    0.731210    800         7.784431    0.097899    0.117797    34.643836  
[37m[36mINFO[0m[0m 01/30 21:03:19 | 0.757316    0.792357    0.981788    0.963570    0.121685    0.974375    0.953545    0.975480    0.955128    0.995509    0.982036    0.757316    0.792357    1000        9.730539    0.074386    0.141035    34.662201  
[37m[36mINFO[0m[0m 01/30 21:04:27 | 0.739504    0.736306    0.978920    0.952959    0.182006    0.967053    0.931540    0.974947    0.942308    0.994760    0.985030    0.739504    0.736306    1200        11.676647   0.051909    0.152785    36.908865  
[37m[36mINFO[0m[0m 01/30 21:05:35 | 0.737913    0.750318    0.969312    0.935687    0.219423    0.947529    0.907090    0.973881    0.935897    0.986527    0.964072    0.737913    0.750318    1400        13.622754   0.052528    0.146404    38.626534  
[37m[36mINFO[0m[0m 01/30 21:06:35 | 0.814567    0.811465    0.994344    0.974158    0.094512    0.991458    0.968215    0.993070    0.972222    0.998503    0.982036    0.814567    0.811465    1600        15.568862   0.044004    0.139460    32.071789  
[37m[36mINFO[0m[0m 01/30 21:07:33 | 0.741730    0.749045    0.982032    0.958191    0.140091    0.963392    0.951100    0.990938    0.959402    0.991766    0.964072    0.741730    0.749045    1800        17.514970   0.035430    0.125504    32.500863  
[37m[36mINFO[0m[0m 01/30 21:08:43 | 0.758270    0.750318    0.981602    0.954140    0.209187    0.974985    0.929095    0.972814    0.942308    0.997006    0.991018    0.758270    0.750318    2000        19.461078   0.028680    0.118055    46.857947  
[37m[36mINFO[0m[0m 01/30 21:09:50 | 0.744593    0.763057    0.986646    0.947886    0.191669    0.977425    0.919315    0.984009    0.942308    0.998503    0.982036    0.744593    0.763057    2200        21.407186   0.037867    0.170006    32.703627  
[37m[36mINFO[0m[0m 01/30 21:10:47 | 0.766858    0.769427    0.994238    0.969069    0.114888    0.991458    0.965770    0.992004    0.959402    0.999251    0.982036    0.766858    0.769427    2400        23.353293   0.026882    0.121542    33.196589  
[37m[36mINFO[0m[0m 01/30 21:12:00 | 0.722328    0.741401    0.994816    0.962530    0.127302    0.995119    0.955990    0.993070    0.961538    0.996257    0.970060    0.722328    0.741401    2600        25.299401   0.021995    0.119546    48.663510  
[37m[36mINFO[0m[0m 01/30 21:13:17 | 0.727417    0.727389    0.998201    0.966419    0.141099    0.996949    0.953545    0.998401    0.963675    0.999251    0.982036    0.727417    0.727389    2800        27.245509   0.007176    0.216647    33.273379  
[37m[36mINFO[0m[0m 01/30 21:14:13 | 0.761132    0.778344    0.992854    0.964385    0.130028    0.989018    0.955990    0.992537    0.955128    0.997006    0.982036    0.761132    0.778344    3000        29.191617   0.032931    0.121478    31.774369  
[37m[36mINFO[0m[0m 01/30 21:15:21 | 0.793893    0.806369    0.996982    0.971918    0.089723    0.997559    0.965770    0.994136    0.967949    0.999251    0.982036    0.793893    0.806369    3200        31.137725   0.025386    0.137065    40.985072  
[37m[36mINFO[0m[0m 01/30 21:16:27 | 0.778308    0.775796    0.997181    0.965318    0.116437    0.996339    0.951100    0.995203    0.965812    1.000000    0.979042    0.778308    0.775796    3400        33.083832   0.012785    0.144142    36.638340  
[37m[36mINFO[0m[0m 01/30 21:17:27 | 0.813295    0.817834    0.997011    0.972776    0.100056    0.995729    0.965770    0.996802    0.961538    0.998503    0.991018    0.813295    0.817834    3600        35.029940   0.019713    0.132971    33.845941  
[37m[36mINFO[0m[0m 01/30 21:18:40 | 0.710560    0.715924    0.976256    0.952147    0.209778    0.978035    0.946210    0.955224    0.940171    0.995509    0.970060    0.710560    0.715924    3800        36.976048   0.017989    0.174849    38.070755  
[37m[36mINFO[0m[0m 01/30 21:19:50 | 0.793893    0.821656    0.996164    0.977498    0.104091    0.993289    0.973105    0.995203    0.974359    1.000000    0.985030    0.793893    0.821656    4000        38.922156   0.027924    0.137572    42.135033  
[37m[36mINFO[0m[0m 01/30 21:20:55 | 0.772901    0.771975    0.995788    0.966872    0.137540    0.994509    0.960880    0.993603    0.948718    0.999251    0.991018    0.772901    0.771975    4200        40.868263   0.014060    0.143009    36.633867  
[37m[36mINFO[0m[0m 01/30 21:21:59 | 0.779898    0.785987    0.994581    0.963871    0.130433    0.992068    0.943765    0.994670    0.965812    0.997006    0.982036    0.779898    0.785987    4400        42.814371   0.008980    0.158436    32.590767  
[37m[36mINFO[0m[0m 01/30 21:23:01 | 0.754771    0.763057    0.995960    0.959964    0.152782    0.992678    0.938875    0.995203    0.952991    1.000000    0.988024    0.754771    0.763057    4600        44.760479   0.020156    0.119947    37.273726  
[37m[36mINFO[0m[0m 01/30 21:24:34 | 0.733142    0.741401    0.997052    0.958291    0.131361    0.993289    0.936430    0.997868    0.959402    1.000000    0.979042    0.733142    0.741401    4800        46.706587   0.011020    0.244211    44.820989  
[37m[36mINFO[0m[0m 01/30 21:25:32 | 0.795165    0.766879    0.997490    0.970780    0.125768    0.996949    0.965770    0.996269    0.961538    0.999251    0.985030    0.795165    0.766879    5000        48.652695   0.009651    0.124999    33.087917  
[37m[36mINFO[0m[0m 01/30 21:25:33 | Cumulative gradient change saved at train_output/PACS/GENIE_p/[3]/250130_20-57-23_GENIE_p3/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/30 21:25:34 | ---
[37m[36mINFO[0m[0m 01/30 21:25:34 | test-domain validation(oracle) = 79.389%
[37m[36mINFO[0m[0m 01/30 21:25:34 | training-domain validation(iid) = 79.389%
[37m[36mINFO[0m[0m 01/30 21:25:34 | last = 79.517%
[37m[36mINFO[0m[0m 01/30 21:25:34 | last (inD) = 97.078%
[37m[36mINFO[0m[0m 01/30 21:25:34 | training-domain validation (iid, inD) = 97.750%
[37m[36mINFO[0m[0m 01/30 21:25:34 | === Summary ===
[37m[36mINFO[0m[0m 01/30 21:25:34 | Command: /jsm0707/DomainBed/Large-scale/train_all.py GENIE_p3 config/resnet50_sgd.yaml --trial_seed 0 --hparams_seed 18 --algorithm GENIE_p --test_envs 3 --dataset PACS
[37m[36mINFO[0m[0m 01/30 21:25:34 | Unique name: 250130_20-57-23_GENIE_p3
[37m[36mINFO[0m[0m 01/30 21:25:34 | Out path: train_output/PACS/GENIE_p/[3]/250130_20-57-23_GENIE_p3
[37m[36mINFO[0m[0m 01/30 21:25:34 | Algorithm: GENIE_p
[37m[36mINFO[0m[0m 01/30 21:25:34 | Dataset: PACS
[37m[36mINFO[0m[0m 01/30 21:25:34 | Max test_in: 0.8146

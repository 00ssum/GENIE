[37m[36mINFO[0m[0m 01/30 19:11:10 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py GENIE_p0 config/resnet50_sgd.yaml --trial_seed 2 --hparams_seed 9 --algorithm GENIE_p --test_envs 0 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: GENIE_p
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 9
	in_domain: False
	model_save: None
	mpa: False
	name: GENIE_p0
	out_dir: train_output/PACS/GENIE_p/[0]/250130_19-11-10_GENIE_p0
	out_root: train_output/PACS/GENIE_p/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 2
	unique_name: 250130_19-11-10_GENIE_p0
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 2.716671579524612e-05
	batch_size: 29
	weight_decay: 1.71368232883332e-06
	momentum: 0.9092933546128503
	convergence_rate: 0.02426611940613899
	moving_avg: 0.947722940872739
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 01/30 19:11:10 | n_steps = 5001
[37m[36mINFO[0m[0m 01/30 19:11:10 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/30 19:11:10 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/30 19:11:10 | Target test envs = [[0]]
[37m[36mINFO[0m[0m 01/30 19:11:10 | 
[37m[36mINFO[0m[0m 01/30 19:11:10 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 01/30 19:11:10 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 01/30 19:11:10 | Batch sizes for each domain: [0, 29, 29, 29] (total=87)
[37m[36mINFO[0m[0m 01/30 19:11:10 | steps-per-epoch for each domain: 64.69, 46.07, 108.41 -> min = 46.07
[37m[36mINFO[0m[0m 01/30 19:11:11 | # of params = 23522375
[37m[36mINFO[0m[0m 01/30 19:11:45 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/30 19:11:45 | 0.211714    0.217604    0.197062    0.202902    1.874792    0.211714    0.217604    0.228678    0.243590    0.164671    0.167665    0.197837    0.197452    0           0.000000    1.997630    1.432755    32.323093  
[37m[36mINFO[0m[0m 01/30 19:13:16 | 0.798048    0.799511    0.963280    0.954720    0.136205    0.798048    0.799511    0.955757    0.946581    0.991018    0.994012    0.943066    0.923567    200         4.341317    0.315552    0.295709    31.619781  
[37m[36mINFO[0m[0m 01/30 19:14:51 | 0.898719    0.904645    0.971603    0.957281    0.133071    0.898719    0.904645    0.956290    0.952991    0.997006    0.994012    0.961514    0.924841    400         8.682635    0.091808    0.271068    40.068743  
[37m[36mINFO[0m[0m 01/30 19:16:12 | 0.784015    0.762836    0.977485    0.949303    0.182125    0.784015    0.762836    0.974947    0.942308    0.990269    0.982036    0.967239    0.923567    600         13.023952   0.068266    0.218580    37.182671  
[37m[36mINFO[0m[0m 01/30 19:17:43 | 0.846858    0.843521    0.991351    0.967500    0.094552    0.846858    0.843521    0.988273    0.965812    0.998503    0.994012    0.987277    0.942675    800         17.365269   0.043800    0.293703    32.100559  
[37m[36mINFO[0m[0m 01/30 19:19:12 | 0.868212    0.872861    0.994721    0.971347    0.093198    0.868212    0.872861    0.996269    0.974359    0.997754    0.997006    0.990140    0.942675    1000        21.706587   0.030510    0.234619    41.667484  
[37m[36mINFO[0m[0m 01/30 19:20:53 | 0.877364    0.885086    0.989755    0.966649    0.104827    0.877364    0.885086    0.987207    0.961538    0.997006    0.997006    0.985051    0.941401    1200        26.047904   0.025973    0.347085    31.364347  
[37m[36mINFO[0m[0m 01/30 19:22:16 | 0.866992    0.877751    0.993259    0.969051    0.118259    0.866992    0.877751    0.988273    0.970085    0.998503    0.988024    0.993003    0.949045    1400        30.389222   0.019209    0.211369    40.583022  
[37m[36mINFO[0m[0m 01/30 19:23:39 | 0.895058    0.882641    0.996564    0.974599    0.099566    0.895058    0.882641    0.996802    0.982906    0.999251    0.988024    0.993639    0.952866    1600        34.730539   0.020450    0.252346    32.840353  
[37m[36mINFO[0m[0m 01/30 19:25:13 | 0.876144    0.858191    0.995925    0.965664    0.124476    0.876144    0.858191    0.994136    0.967949    1.000000    0.994012    0.993639    0.935032    1800        39.071856   0.013481    0.300606    33.418808  
[37m[36mINFO[0m[0m 01/30 19:26:31 | 0.875534    0.880196    0.992885    0.966666    0.110404    0.875534    0.880196    0.993603    0.976496    1.000000    0.991018    0.985051    0.932484    2000        43.413174   0.024555    0.231894    31.827365  
[37m[36mINFO[0m[0m 01/30 19:27:52 | 0.897498    0.894866    0.996108    0.966666    0.113227    0.897498    0.894866    0.998934    0.976496    0.999251    0.991018    0.990140    0.932484    2200        47.754491   0.013106    0.216304    37.753305  
[37m[36mINFO[0m[0m 01/30 19:29:24 | 0.899939    0.902200    0.997590    0.975182    0.090756    0.899939    0.902200    0.997335    0.980769    0.999251    0.997006    0.996183    0.947771    2400        52.095808   0.015941    0.299410    31.724786  
[37m[36mINFO[0m[0m 01/30 19:30:45 | 0.885296    0.875306    0.986614    0.961970    0.161333    0.885296    0.875306    0.992004    0.967949    0.995509    0.988024    0.972328    0.929936    2600        56.437126   0.012166    0.215175    37.702419  
[37m[36mINFO[0m[0m 01/30 19:32:19 | 0.876144    0.885086    0.997381    0.976454    0.107461    0.876144    0.885086    0.997868    0.976496    1.000000    1.000000    0.994275    0.952866    2800        60.778443   0.007199    0.268310    40.168467  
[37m[36mINFO[0m[0m 01/30 19:33:40 | 0.852349    0.863081    0.998195    0.973470    0.108543    0.852349    0.863081    0.999467    0.974359    0.999251    0.997006    0.995865    0.949045    3000        65.119760   0.007950    0.209215    39.331511  
[37m[36mINFO[0m[0m 01/30 19:34:59 | 0.895058    0.899756    0.998934    0.978154    0.105995    0.895058    0.899756    0.998934    0.980769    0.998503    0.997006    0.999364    0.956688    3200        69.461078   0.012148    0.242148    30.686575  
[37m[36mINFO[0m[0m 01/30 19:36:28 | 0.863941    0.872861    0.998263    0.967639    0.114644    0.863941    0.872861    0.998401    0.967949    0.999251    0.991018    0.997137    0.943949    3400        73.802395   0.008613    0.275625    32.980705  
[37m[36mINFO[0m[0m 01/30 19:37:48 | 0.865162    0.865526    0.998759    0.978017    0.115143    0.865162    0.865526    0.998934    0.982906    0.999251    0.997006    0.998092    0.954140    3600        78.143713   0.004732    0.245211    31.601519  
[37m[36mINFO[0m[0m 01/30 19:39:11 | 0.846858    0.855746    0.995569    0.967214    0.130248    0.846858    0.855746    0.995203    0.967949    0.998503    0.991018    0.993003    0.942675    3800        82.485030   0.011112    0.212089    40.316134  
[37m[36mINFO[0m[0m 01/30 19:40:36 | 0.830384    0.816626    0.990369    0.958270    0.199652    0.830384    0.816626    0.989872    0.955128    1.000000    0.991018    0.981234    0.928662    4000        86.826347   0.009186    0.250990    34.951039  
[37m[36mINFO[0m[0m 01/30 19:41:49 | 0.891397    0.889976    0.999043    0.973885    0.124896    0.891397    0.889976    0.998401    0.976496    1.000000    0.991018    0.998728    0.954140    4200        91.167665   0.006452    0.211755    30.475492  
[37m[36mINFO[0m[0m 01/30 19:43:24 | 0.876144    0.899756    0.998690    0.968490    0.139564    0.876144    0.899756    0.998934    0.972222    1.000000    0.988024    0.997137    0.945223    4400        95.508982   0.005439    0.275159    39.311845  
[37m[36mINFO[0m[0m 01/30 19:44:37 | 0.829774    0.848411    0.998441    0.969901    0.125874    0.829774    0.848411    0.998934    0.970085    0.999251    0.988024    0.997137    0.951592    4600        99.850299   0.003138    0.208786    31.646349  
[37m[36mINFO[0m[0m 01/30 19:46:25 | 0.859060    0.863081    0.998796    0.973885    0.106230    0.859060    0.863081    0.998934    0.976496    1.000000    0.991018    0.997455    0.954140    4800        104.191617  0.008208    0.270762    54.335241  
[37m[36mINFO[0m[0m 01/30 19:47:52 | 0.895058    0.894866    0.998971    0.972184    0.125943    0.895058    0.894866    0.998934    0.972222    0.999251    0.994012    0.998728    0.950318    5000        108.532934  0.005987    0.270068    32.452024  
[37m[36mINFO[0m[0m 01/30 19:47:52 | Cumulative gradient change saved at train_output/PACS/GENIE_p/[0]/250130_19-11-10_GENIE_p0/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/30 19:47:53 | ---
[37m[36mINFO[0m[0m 01/30 19:47:53 | test-domain validation(oracle) = 89.872%
[37m[36mINFO[0m[0m 01/30 19:47:53 | training-domain validation(iid) = 89.506%
[37m[36mINFO[0m[0m 01/30 19:47:53 | last = 89.506%
[37m[36mINFO[0m[0m 01/30 19:47:53 | last (inD) = 97.218%
[37m[36mINFO[0m[0m 01/30 19:47:53 | training-domain validation (iid, inD) = 97.815%
[37m[36mINFO[0m[0m 01/30 19:47:53 | === Summary ===
[37m[36mINFO[0m[0m 01/30 19:47:53 | Command: /jsm0707/DomainBed/Large-scale/train_all.py GENIE_p0 config/resnet50_sgd.yaml --trial_seed 2 --hparams_seed 9 --algorithm GENIE_p --test_envs 0 --dataset PACS
[37m[36mINFO[0m[0m 01/30 19:47:53 | Unique name: 250130_19-11-10_GENIE_p0
[37m[36mINFO[0m[0m 01/30 19:47:53 | Out path: train_output/PACS/GENIE_p/[0]/250130_19-11-10_GENIE_p0
[37m[36mINFO[0m[0m 01/30 19:47:53 | Algorithm: GENIE_p
[37m[36mINFO[0m[0m 01/30 19:47:53 | Dataset: PACS
[37m[36mINFO[0m[0m 01/30 19:47:53 | Max test_in: 0.8999

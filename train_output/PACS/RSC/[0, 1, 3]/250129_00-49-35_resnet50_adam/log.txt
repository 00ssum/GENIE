[37m[36mINFO[0m[0m 01/29 00:49:35 | Command :: /jsm0707/Large-scale/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm RSC --test_envs 0 1 3 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_adam.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_adam
	out_dir: train_output/PACS/RSC/[0, 1, 3]/250129_00-49-35_resnet50_adam
	out_root: train_output/PACS/RSC/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 0
	unique_name: 250129_00-49-35_resnet50_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	rsc_f_drop_factor: 0.3333333333333333
	rsc_b_drop_factor: 0.3333333333333333
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 01/29 00:49:35 | n_steps = 5001
[37m[36mINFO[0m[0m 01/29 00:49:35 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/29 00:49:35 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/29 00:49:35 | 
[37m[36mINFO[0m[0m 01/29 00:49:35 | Testenv name escaping te_A_C_S -> te_A_C_S
[37m[36mINFO[0m[0m 01/29 00:49:35 | Test envs = [0, 1, 3], name = te_A_C_S
[37m[36mINFO[0m[0m 01/29 00:49:35 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 01/29 00:49:35 | Batch sizes for each domain: [0, 0, 32, 0] (total=32)
[37m[36mINFO[0m[0m 01/29 00:49:35 | steps-per-epoch for each domain: 41.75 -> min = 41.75
[37m[36mINFO[0m[0m 01/29 00:49:37 | # of params = 23522375
[37m[36mINFO[0m[0m 01/29 00:50:12 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/29 00:50:12 | 0.162769    0.143748    0.258982    0.263473    1.945849    0.267846    0.202934    0.103412    0.111111    0.258982    0.263473    0.117048    0.117197    0           0.000000    3.350245    2.068653    32.582078  
[37m[36mINFO[0m[0m 01/29 00:51:27 | 0.243372    0.244842    0.896707    0.865269    0.525293    0.461257    0.469438    0.113006    0.085470    0.896707    0.865269    0.155852    0.179618    200         4.790419    0.991805    0.228894    29.079878  
[37m[36mINFO[0m[0m 01/29 00:52:37 | 0.408804    0.424908    0.995509    0.970060    0.105390    0.639414    0.674817    0.260661    0.252137    0.995509    0.970060    0.326336    0.347771    400         9.580838    0.090144    0.197675    29.934957  
[37m[36mINFO[0m[0m 01/29 00:53:38 | 0.422598    0.421736    0.995509    0.958084    0.142422    0.609518    0.623472    0.362473    0.352564    0.995509    0.958084    0.295802    0.289172    600         14.371257   0.032595    0.166095    27.583577  
[37m[36mINFO[0m[0m 01/29 00:54:58 | 0.389957    0.402087    0.963323    0.907186    0.311514    0.546675    0.586797    0.326759    0.322650    0.963323    0.907186    0.296438    0.296815    800         19.161677   0.019372    0.233292    32.495669  
[37m[36mINFO[0m[0m 01/29 00:56:05 | 0.383378    0.390952    0.976048    0.931138    0.240173    0.660769    0.689487    0.244136    0.222222    0.976048    0.931138    0.245229    0.261146    1000        23.952096   0.045501    0.183315    30.747333  
[37m[36mINFO[0m[0m 01/29 00:57:14 | 0.419572    0.419969    1.000000    0.982036    0.042109    0.661989    0.662592    0.313966    0.311966    1.000000    0.982036    0.282761    0.285350    1200        28.742515   0.009855    0.205071    27.893646  
[37m[36mINFO[0m[0m 01/29 00:58:23 | 0.426278    0.439756    1.000000    0.991018    0.035058    0.649176    0.665037    0.306503    0.314103    1.000000    0.991018    0.323155    0.340127    1400        33.532934   0.003074    0.186663    31.654778  
[37m[36mINFO[0m[0m 01/29 00:59:38 | 0.408788    0.400581    0.999251    0.976048    0.073679    0.688835    0.674817    0.287846    0.260684    0.999251    0.976048    0.249682    0.266242    1600        38.323353   0.031585    0.226287    29.409788  
[37m[36mINFO[0m[0m 01/29 01:00:47 | 0.359406    0.353859    0.987275    0.952096    0.189063    0.579012    0.577017    0.240938    0.209402    0.987275    0.952096    0.258270    0.275159    1800        43.113772   0.048358    0.203411    28.169280  
[37m[36mINFO[0m[0m 01/29 01:01:51 | 0.382591    0.377604    0.995509    0.955090    0.165594    0.607688    0.603912    0.251599    0.237179    0.995509    0.955090    0.288486    0.291720    2000        47.904192   0.033436    0.183096    27.072374  
[37m[36mINFO[0m[0m 01/29 01:03:14 | 0.386071    0.390185    0.998503    0.964072    0.133590    0.625381    0.645477    0.262793    0.237179    0.998503    0.964072    0.270038    0.287898    2200        52.694611   0.005820    0.237136    35.430127  
[37m[36mINFO[0m[0m 01/29 01:04:23 | 0.392427    0.388574    0.990269    0.949102    0.196913    0.558267    0.555012    0.356610    0.348291    0.990269    0.949102    0.262405    0.262420    2400        57.485030   0.005005    0.192237    30.652344  
[37m[36mINFO[0m[0m 01/29 01:05:34 | 0.384425    0.378617    1.000000    0.979042    0.106908    0.635754    0.633252    0.274520    0.241453    1.000000    0.979042    0.243003    0.261146    2600        62.275449   0.003210    0.222812    26.595437  
[37m[36mINFO[0m[0m 01/29 01:06:50 | 0.365626    0.357434    1.000000    0.976048    0.120050    0.639414    0.635697    0.246269    0.213675    1.000000    0.976048    0.211196    0.222930    2800        67.065868   0.026314    0.190209    38.251850  
[37m[36mINFO[0m[0m 01/29 01:08:04 | 0.417812    0.406526    0.992515    0.964072    0.149520    0.657108    0.650367    0.279851    0.232906    0.992515    0.964072    0.316476    0.336306    3000        71.856287   0.018654    0.235541    26.786772  
[37m[36mINFO[0m[0m 01/29 01:09:16 | 0.469653    0.466767    0.999251    0.985030    0.101315    0.701647    0.684597    0.314499    0.299145    0.999251    0.985030    0.392812    0.416561    3200        76.646707   0.022891    0.213256    29.557052  
[37m[36mINFO[0m[0m 01/29 01:10:21 | 0.502956    0.506134    1.000000    0.979042    0.118594    0.680903    0.679707    0.353412    0.341880    1.000000    0.979042    0.474555    0.496815    3400        81.437126   0.001016    0.187976    26.518825  
[37m[36mINFO[0m[0m 01/29 01:11:52 | 0.423991    0.435352    0.997754    0.970060    0.125862    0.628432    0.623472    0.305437    0.299145    0.997754    0.970060    0.338104    0.383439    3600        86.227545   0.025054    0.278287    34.766360  
[37m[36mINFO[0m[0m 01/29 01:13:02 | 0.401082    0.400136    1.000000    0.970060    0.138746    0.661379    0.643032    0.267058    0.241453    1.000000    0.970060    0.274809    0.315924    3800        91.017964   0.001411    0.177747    34.316142  
[37m[36mINFO[0m[0m 01/29 01:14:10 | 0.438912    0.428113    1.000000    0.976048    0.126144    0.690665    0.660147    0.290512    0.264957    1.000000    0.976048    0.335560    0.359236    4000        95.808383   0.001163    0.216897    24.490082  
[37m[36mINFO[0m[0m 01/29 01:15:34 | 0.461518    0.450974    1.000000    0.976048    0.141377    0.702257    0.669927    0.315565    0.297009    1.000000    0.976048    0.366730    0.385987    4200        100.598802  0.000027    0.234109    37.891257  
[37m[36mINFO[0m[0m 01/29 01:16:42 | 0.318122    0.318404    0.984281    0.973054    0.121640    0.572300    0.574572    0.185501    0.160256    0.984281    0.973054    0.196565    0.220382    4400        105.389222  0.014830    0.205570    25.980113  
[37m[36mINFO[0m[0m 01/29 01:17:59 | 0.366918    0.360989    1.000000    0.985030    0.099889    0.644295    0.633252    0.236674    0.205128    1.000000    0.985030    0.219784    0.244586    4600        110.179641  0.051826    0.231492    31.314780  
[37m[36mINFO[0m[0m 01/29 01:19:05 | 0.332104    0.334334    0.989521    0.946108    0.224306    0.557047    0.550122    0.175906    0.168803    0.989521    0.946108    0.263359    0.284076    4800        114.970060  0.028841    0.166159    32.834199  
[37m[36mINFO[0m[0m 01/29 01:20:27 | 0.476951    0.486066    0.997754    0.967066    0.181359    0.634533    0.645477    0.401919    0.397436    0.997754    0.967066    0.394402    0.415287    5000        119.760479  0.018693    0.254371    30.973078  
[37m[36mINFO[0m[0m 01/29 01:20:27 | Cumulative gradient change saved at train_output/PACS/RSC/[0, 1, 3]/250129_00-49-35_resnet50_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/29 01:20:29 | ---
[37m[36mINFO[0m[0m 01/29 01:20:29 | test-domain validation(oracle) = 50.296%
[37m[36mINFO[0m[0m 01/29 01:20:29 | training-domain validation(iid) = 42.628%
[37m[36mINFO[0m[0m 01/29 01:20:29 | last = 47.695%
[37m[36mINFO[0m[0m 01/29 01:20:29 | last (inD) = 96.707%
[37m[36mINFO[0m[0m 01/29 01:20:29 | training-domain validation (iid, inD) = 99.102%
[37m[36mINFO[0m[0m 01/29 01:20:29 | === Summary ===
[37m[36mINFO[0m[0m 01/29 01:20:29 | Command: /jsm0707/Large-scale/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm RSC --test_envs 0 1 3 --dataset PACS
[37m[36mINFO[0m[0m 01/29 01:20:29 | Unique name: 250129_00-49-35_resnet50_adam
[37m[36mINFO[0m[0m 01/29 01:20:29 | Out path: train_output/PACS/RSC/[0, 1, 3]/250129_00-49-35_resnet50_adam
[37m[36mINFO[0m[0m 01/29 01:20:29 | Algorithm: RSC
[37m[36mINFO[0m[0m 01/29 01:20:29 | Dataset: PACS

[37m[36mINFO[0m[0m 02/15 02:31:18 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 3 --dataset PACS --trial_seed 1 --hparams_seed 5
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 5
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/PACS/RSC/[0, 1, 3]/250215_02-31-18_resnet50_GENIE
	out_root: train_output/PACS/RSC/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 1
	unique_name: 250215_02-31-18_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.0002591339485391279
	batch_size: 10
	weight_decay: 0.00020150290684242954
	rsc_f_drop_factor: 0.027640006496055525
	rsc_b_drop_factor: 0.328352644194812
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 02/15 02:31:18 | n_steps = 5001
[37m[36mINFO[0m[0m 02/15 02:31:18 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/15 02:31:18 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/15 02:31:18 | 
[37m[36mINFO[0m[0m 02/15 02:31:18 | Testenv name escaping te_A_C_S -> te_A_C_S
[37m[36mINFO[0m[0m 02/15 02:31:18 | Test envs = [0, 1, 3], name = te_A_C_S
[37m[36mINFO[0m[0m 02/15 02:31:18 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 02/15 02:31:18 | Batch sizes for each domain: [0, 0, 10, 0] (total=10)
[37m[36mINFO[0m[0m 02/15 02:31:18 | steps-per-epoch for each domain: 133.60 -> min = 133.60
[37m[36mINFO[0m[0m 02/15 02:31:20 | # of params = 23522375
[37m[36mINFO[0m[0m 02/15 02:31:50 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/15 02:31:50 | 0.101065    0.099800    0.110778    0.128743    2.045459    0.090299    0.088020    0.058635    0.053419    0.110778    0.128743    0.154262    0.157962    0           0.000000    2.311809    2.097523    28.319100  
[37m[36mINFO[0m[0m 02/15 02:32:47 | 0.387904    0.377713    0.898952    0.925150    0.236939    0.522880    0.501222    0.294776    0.277778    0.898952    0.925150    0.346056    0.354140    200         1.497006    0.584819    0.135449    29.460134  
[37m[36mINFO[0m[0m 02/15 02:33:41 | 0.425662    0.390993    0.967814    0.979042    0.071452    0.624161    0.557457    0.354478    0.303419    0.967814    0.979042    0.298346    0.312102    400         2.994012    0.234664    0.153904    23.597216  
[37m[36mINFO[0m[0m 02/15 02:34:41 | 0.453195    0.419333    0.973054    0.970060    0.088617    0.614399    0.557457    0.376866    0.318376    0.973054    0.970060    0.368321    0.382166    600         4.491018    0.162483    0.134918    32.602524  
[37m[36mINFO[0m[0m 02/15 02:35:39 | 0.467746    0.455369    0.967066    0.970060    0.079358    0.669921    0.640587    0.454691    0.440171    0.967066    0.970060    0.278626    0.285350    800         5.988024    0.166173    0.158580    26.046001  
[37m[36mINFO[0m[0m 02/15 02:36:36 | 0.452165    0.427414    0.988772    0.979042    0.056557    0.643685    0.616137    0.350213    0.311966    0.988772    0.979042    0.362595    0.354140    1000        7.485030    0.133565    0.146643    27.829111  
[37m[36mINFO[0m[0m 02/15 02:37:32 | 0.331611    0.308958    0.974551    0.982036    0.070672    0.539963    0.484108    0.256397    0.247863    0.974551    0.982036    0.198473    0.194904    1200        8.982036    0.145520    0.138344    28.245323  
[37m[36mINFO[0m[0m 02/15 02:38:23 | 0.398820    0.382999    0.938623    0.922156    0.234147    0.575351    0.564792    0.409915    0.386752    0.938623    0.922156    0.211196    0.197452    1400        10.479042   0.119992    0.136880    23.461254  
[37m[36mINFO[0m[0m 02/15 02:39:29 | 0.449788    0.403635    0.990269    0.985030    0.060348    0.640024    0.557457    0.374733    0.324786    0.990269    0.985030    0.334606    0.328662    1600        11.976048   0.079627    0.167236    32.899860  
[37m[36mINFO[0m[0m 02/15 02:40:29 | 0.482602    0.452926    0.959581    0.961078    0.136404    0.551556    0.515892    0.431237    0.399573    0.959581    0.961078    0.465013    0.443312    1800        13.473054   0.060243    0.154603    29.565308  
[37m[36mINFO[0m[0m 02/15 02:41:25 | 0.463332    0.446495    0.992515    0.967066    0.086679    0.628432    0.601467    0.328358    0.335470    0.992515    0.967066    0.433206    0.402548    2000        14.970060   0.128314    0.152997    24.814679  
[37m[36mINFO[0m[0m 02/15 02:42:20 | 0.527437    0.515885    0.986527    0.982036    0.068659    0.624771    0.591687    0.490938    0.487179    0.986527    0.982036    0.466603    0.468790    2200        16.467066   0.033661    0.134285    28.179590  
[37m[36mINFO[0m[0m 02/15 02:43:30 | 0.433493    0.408971    0.998503    0.979042    0.068840    0.625991    0.584352    0.303305    0.282051    0.998503    0.979042    0.371183    0.360510    2400        17.964072   0.029605    0.195229    30.848703  
[37m[36mINFO[0m[0m 02/15 02:44:22 | 0.482872    0.463904    0.997006    0.991018    0.025326    0.711409    0.689487    0.352345    0.316239    0.997006    0.991018    0.384860    0.385987    2600        19.461078   0.017448    0.141065    24.066453  
[37m[36mINFO[0m[0m 02/15 02:45:13 | 0.484537    0.462774    0.998503    0.988024    0.035697    0.692495    0.672372    0.381663    0.337607    0.998503    0.988024    0.379453    0.378344    2800        20.958084   0.009154    0.129997    25.176145  
[37m[36mINFO[0m[0m 02/15 02:46:17 | 0.506244    0.478622    0.998503    0.985030    0.034415    0.735815    0.696822    0.393923    0.363248    0.998503    0.985030    0.388995    0.375796    3000        22.455090   0.002416    0.150100    34.152204  
[37m[36mINFO[0m[0m 02/15 02:47:23 | 0.402717    0.401656    0.802395    0.808383    0.501411    0.483832    0.471883    0.361407    0.361111    0.802395    0.808383    0.362913    0.371975    3200        23.952096   0.054628    0.203450    24.661327  
[37m[36mINFO[0m[0m 02/15 02:48:16 | 0.458082    0.428065    0.991018    0.970060    0.078233    0.630872    0.564792    0.374733    0.346154    0.991018    0.970060    0.368639    0.373248    3400        25.449102   0.119184    0.136716    25.609489  
[37m[36mINFO[0m[0m 02/15 02:49:07 | 0.545900    0.514940    1.000000    0.994012    0.017936    0.633923    0.606357    0.511727    0.472222    1.000000    0.994012    0.492048    0.466242    3600        26.946108   0.035180    0.134021    24.029709  
[37m[36mINFO[0m[0m 02/15 02:50:05 | 0.547430    0.534726    0.994760    0.973054    0.093650    0.611959    0.594132    0.520789    0.510684    0.994760    0.973054    0.509542    0.499363    3800        28.443114   0.020517    0.162747    25.655654  
[37m[36mINFO[0m[0m 02/15 02:51:02 | 0.540479    0.530967    0.998503    0.988024    0.051041    0.622941    0.606357    0.496269    0.487179    0.998503    0.988024    0.502226    0.499363    4000        29.940120   0.034772    0.161722    24.315340  
[37m[36mINFO[0m[0m 02/15 02:52:02 | 0.632765    0.623137    0.997006    0.985030    0.040582    0.711409    0.650367    0.571429    0.589744    0.997006    0.985030    0.615458    0.629299    4200        31.437126   0.033407    0.155888    29.425160  
[37m[36mINFO[0m[0m 02/15 02:53:01 | 0.578629    0.562874    1.000000    0.988024    0.033572    0.688225    0.647922    0.529851    0.523504    1.000000    0.988024    0.517812    0.517197    4400        32.934132   0.024304    0.160658    26.926376  
[37m[36mINFO[0m[0m 02/15 02:53:53 | 0.592335    0.568566    0.999251    0.994012    0.025934    0.684564    0.655257    0.536780    0.519231    0.999251    0.994012    0.555662    0.531210    4600        34.431138   0.001179    0.123553    27.104828  
[37m[36mINFO[0m[0m 02/15 02:55:00 | 0.576841    0.549588    1.000000    0.994012    0.014552    0.723002    0.696822    0.498934    0.455128    1.000000    0.994012    0.508588    0.496815    4800        35.928144   0.000317    0.184994    29.886426  
[37m[36mINFO[0m[0m 02/15 02:55:58 | 0.523785    0.505024    0.996257    0.982036    0.069053    0.694326    0.669927    0.445096    0.420940    0.996257    0.982036    0.431934    0.424204    5000        37.425150   0.015435    0.144461    29.218381  
[37m[36mINFO[0m[0m 02/15 02:55:58 | Cumulative gradient change saved at train_output/PACS/RSC/[0, 1, 3]/250215_02-31-18_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/15 02:55:59 | ---
[37m[36mINFO[0m[0m 02/15 02:55:59 | test-domain validation(oracle) = 63.277%
[37m[36mINFO[0m[0m 02/15 02:55:59 | training-domain validation(iid) = 54.590%
[37m[36mINFO[0m[0m 02/15 02:55:59 | last = 52.379%
[37m[36mINFO[0m[0m 02/15 02:55:59 | last (inD) = 98.204%
[37m[36mINFO[0m[0m 02/15 02:55:59 | training-domain validation (iid, inD) = 99.401%
[37m[36mINFO[0m[0m 02/15 02:55:59 | === Summary ===
[37m[36mINFO[0m[0m 02/15 02:55:59 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 3 --dataset PACS --trial_seed 1 --hparams_seed 5
[37m[36mINFO[0m[0m 02/15 02:55:59 | Unique name: 250215_02-31-18_resnet50_GENIE
[37m[36mINFO[0m[0m 02/15 02:55:59 | Out path: train_output/PACS/RSC/[0, 1, 3]/250215_02-31-18_resnet50_GENIE
[37m[36mINFO[0m[0m 02/15 02:55:59 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/15 02:55:59 | Dataset: PACS

[37m[36mINFO[0m[0m 01/27 22:09:51 | Command :: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm RSC --test_envs 1 2 3 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/PACS/RSC/[1, 2, 3]/250127_22-09-51_resnet50_sgd
	out_root: train_output/PACS/RSC/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 0
	unique_name: 250127_22-09-51_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	rsc_f_drop_factor: 0.3333333333333333
	rsc_b_drop_factor: 0.3333333333333333
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 01/27 22:09:51 | n_steps = 5001
[37m[36mINFO[0m[0m 01/27 22:09:51 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/27 22:09:51 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/27 22:09:51 | 
[37m[36mINFO[0m[0m 01/27 22:09:51 | Testenv name escaping te_C_P_S -> te_C_P_S
[37m[36mINFO[0m[0m 01/27 22:09:51 | Test envs = [1, 2, 3], name = te_C_P_S
[37m[36mINFO[0m[0m 01/27 22:09:51 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 01/27 22:09:51 | Batch sizes for each domain: [32, 0, 0, 0] (total=32)
[37m[36mINFO[0m[0m 01/27 22:09:51 | steps-per-epoch for each domain: 51.22 -> min = 51.22
[37m[36mINFO[0m[0m 01/27 22:09:53 | # of params = 23522375
[37m[36mINFO[0m[0m 01/27 22:10:20 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/27 22:10:20 | 0.085167    0.104740    0.234289    0.190709    1.932782    0.234289    0.190709    0.099147    0.113248    0.096557    0.134731    0.059796    0.066242    0           0.000000    3.561891    1.744041    25.261230  
[37m[36mINFO[0m[0m 01/27 22:11:22 | 0.149745    0.153073    0.272727    0.244499    1.903506    0.272727    0.244499    0.148721    0.158120    0.105539    0.122754    0.194975    0.178344    200         3.904820    2.895502    0.175323    27.468017  
[37m[36mINFO[0m[0m 01/27 22:12:24 | 0.166457    0.169598    0.267236    0.224939    1.907545    0.267236    0.224939    0.155650    0.170940    0.149701    0.155689    0.194020    0.182166    400         7.809640    2.364808    0.179896    24.872130  
[37m[36mINFO[0m[0m 01/27 22:13:27 | 0.175294    0.181433    0.244051    0.212714    1.909911    0.244051    0.212714    0.165245    0.188034    0.169162    0.176647    0.191476    0.179618    600         11.714460   2.197796    0.168635    29.103198  
[37m[36mINFO[0m[0m 01/27 22:14:27 | 0.176863    0.186988    0.233679    0.212714    1.911415    0.233679    0.212714    0.165778    0.194444    0.173653    0.185629    0.191158    0.180892    800         15.619280   2.127677    0.167994    26.048164  
[37m[36mINFO[0m[0m 01/27 22:15:28 | 0.181657    0.184705    0.228798    0.207824    1.912075    0.228798    0.207824    0.179638    0.192308    0.172904    0.179641    0.192430    0.182166    1000        19.524100   2.082814    0.177111    25.644642  
[37m[36mINFO[0m[0m 01/27 22:16:27 | 0.190522    0.187127    0.229408    0.205379    1.913189    0.229408    0.205379    0.188699    0.196581    0.190120    0.182635    0.192748    0.182166    1200        23.428920   2.059492    0.161691    26.737303  
[37m[36mINFO[0m[0m 01/27 22:17:25 | 0.196726    0.194540    0.226358    0.205379    1.913509    0.226358    0.205379    0.188166    0.200855    0.209581    0.200599    0.192430    0.182166    1400        27.333740   2.041359    0.168205    24.733812  
[37m[36mINFO[0m[0m 01/27 22:18:26 | 0.205742    0.199103    0.226358    0.205379    1.913905    0.226358    0.205379    0.188699    0.196581    0.235778    0.218563    0.192748    0.182166    1600        31.238560   2.024575    0.175088    25.656325  
[37m[36mINFO[0m[0m 01/27 22:19:25 | 0.207960    0.201240    0.223917    0.205379    1.913859    0.223917    0.205379    0.184968    0.202991    0.247754    0.218563    0.191158    0.182166    1800        35.143380   2.013277    0.171114    24.450543  
[37m[36mINFO[0m[0m 01/27 22:20:27 | 0.209785    0.202099    0.226358    0.205379    1.913848    0.226358    0.205379    0.180171    0.200855    0.258982    0.224551    0.190204    0.180892    2000        39.048200   2.004330    0.182453    24.689239  
[37m[36mINFO[0m[0m 01/27 22:21:25 | 0.207198    0.201246    0.223917    0.205379    1.913401    0.223917    0.205379    0.176972    0.192308    0.258234    0.230539    0.186387    0.180892    2200        42.953020   1.994083    0.160909    25.481657  
[37m[36mINFO[0m[0m 01/27 22:22:25 | 0.208274    0.198546    0.224527    0.202934    1.913541    0.224527    0.202934    0.177505    0.183761    0.263473    0.233533    0.183842    0.178344    2400        46.857840   1.991587    0.170439    26.311186  
[37m[36mINFO[0m[0m 01/27 22:23:27 | 0.206540    0.197982    0.223917    0.202934    1.913494    0.223917    0.202934    0.175373    0.181624    0.264222    0.236527    0.180025    0.175796    2600        50.762660   1.983656    0.184119    24.739344  
[37m[36mINFO[0m[0m 01/27 22:24:29 | 0.206222    0.197982    0.223917    0.202934    1.913822    0.223917    0.202934    0.175373    0.181624    0.264222    0.236527    0.179071    0.175796    2800        54.667480   1.981654    0.186485    25.202114  
[37m[36mINFO[0m[0m 01/27 22:25:32 | 0.206400    0.197270    0.223307    0.202934    1.913926    0.223307    0.202934    0.175906    0.179487    0.264222    0.236527    0.179071    0.175796    3000        58.572300   1.977005    0.180402    26.172346  
[37m[36mINFO[0m[0m 01/27 22:26:33 | 0.205941    0.196421    0.223917    0.202934    1.913809    0.223917    0.202934    0.175373    0.179487    0.264970    0.236527    0.177481    0.173248    3200        62.477120   1.972880    0.173755    26.673739  
[37m[36mINFO[0m[0m 01/27 22:27:35 | 0.205414    0.194859    0.223917    0.202934    1.913681    0.223917    0.202934    0.176972    0.177350    0.264970    0.236527    0.174300    0.170701    3400        66.381940   1.970661    0.174298    26.690555  
[37m[36mINFO[0m[0m 01/27 22:28:37 | 0.200706    0.189901    0.223307    0.202934    1.913395    0.223307    0.202934    0.173774    0.175214    0.264222    0.236527    0.164122    0.157962    3600        70.286760   1.965848    0.187252    24.851053  
[37m[36mINFO[0m[0m 01/27 22:29:37 | 0.197597    0.187216    0.223307    0.202934    1.912949    0.223307    0.202934    0.174307    0.177350    0.264222    0.236527    0.154262    0.147771    3800        74.191580   1.959970    0.176475    24.464254  
[37m[36mINFO[0m[0m 01/27 22:30:38 | 0.195757    0.185230    0.223307    0.202934    1.912731    0.223307    0.202934    0.173241    0.175214    0.264222    0.236527    0.149809    0.143949    4000        78.096400   1.959141    0.179928    25.803574  
[37m[36mINFO[0m[0m 01/27 22:31:44 | 0.191831    0.182257    0.224527    0.202934    1.912755    0.224527    0.202934    0.171642    0.175214    0.264222    0.236527    0.139631    0.135032    4200        82.001220   1.957003    0.200478    25.082951  
[37m[36mINFO[0m[0m 01/27 22:32:42 | 0.188295    0.177724    0.223917    0.202934    1.912709    0.223917    0.202934    0.170576    0.173077    0.264222    0.236527    0.130089    0.123567    4400        85.906040   1.954360    0.167501    25.028162  
[37m[36mINFO[0m[0m 01/27 22:33:43 | 0.188932    0.178573    0.223917    0.202934    1.912830    0.223917    0.202934    0.170576    0.173077    0.264222    0.236527    0.131997    0.126115    4600        89.810860   1.956702    0.177722    25.706918  
[37m[36mINFO[0m[0m 01/27 22:34:44 | 0.186069    0.176025    0.223917    0.202934    1.912573    0.223917    0.202934    0.170576    0.173077    0.264222    0.236527    0.123410    0.118471    4800        93.715680   1.951768    0.184769    24.086974  
[37m[36mINFO[0m[0m 01/27 22:35:46 | 0.182287    0.172628    0.223917    0.202934    1.912433    0.223917    0.202934    0.170043    0.173077    0.264222    0.236527    0.112595    0.108280    5000        97.620500   1.952667    0.184880    24.823932  
[37m[36mINFO[0m[0m 01/27 22:35:46 | Cumulative gradient change saved at train_output/PACS/RSC/[1, 2, 3]/250127_22-09-51_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/27 22:35:47 | ---
[37m[36mINFO[0m[0m 01/27 22:35:47 | test-domain validation(oracle) = 20.979%
[37m[36mINFO[0m[0m 01/27 22:35:47 | training-domain validation(iid) = 14.974%
[37m[36mINFO[0m[0m 01/27 22:35:47 | last = 18.229%
[37m[36mINFO[0m[0m 01/27 22:35:47 | last (inD) = 20.293%
[37m[36mINFO[0m[0m 01/27 22:35:47 | training-domain validation (iid, inD) = 24.450%
[37m[36mINFO[0m[0m 01/27 22:35:47 | === Summary ===
[37m[36mINFO[0m[0m 01/27 22:35:47 | Command: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm RSC --test_envs 1 2 3 --dataset PACS
[37m[36mINFO[0m[0m 01/27 22:35:47 | Unique name: 250127_22-09-51_resnet50_sgd
[37m[36mINFO[0m[0m 01/27 22:35:47 | Out path: train_output/PACS/RSC/[1, 2, 3]/250127_22-09-51_resnet50_sgd
[37m[36mINFO[0m[0m 01/27 22:35:47 | Algorithm: RSC
[37m[36mINFO[0m[0m 01/27 22:35:47 | Dataset: PACS

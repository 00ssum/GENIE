[37m[36mINFO[0m[0m 01/28 23:49:05 | Command :: /jsm0707/Large-scale/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm RSC --test_envs 1 2 3 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_adam.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_adam
	out_dir: train_output/PACS/RSC/[1, 2, 3]/250128_23-49-05_resnet50_adam
	out_root: train_output/PACS/RSC/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 0
	unique_name: 250128_23-49-05_resnet50_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	rsc_f_drop_factor: 0.3333333333333333
	rsc_b_drop_factor: 0.3333333333333333
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 01/28 23:49:05 | n_steps = 5001
[37m[36mINFO[0m[0m 01/28 23:49:05 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/28 23:49:05 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/28 23:49:05 | 
[37m[36mINFO[0m[0m 01/28 23:49:05 | Testenv name escaping te_C_P_S -> te_C_P_S
[37m[36mINFO[0m[0m 01/28 23:49:05 | Test envs = [1, 2, 3], name = te_C_P_S
[37m[36mINFO[0m[0m 01/28 23:49:05 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 01/28 23:49:05 | Batch sizes for each domain: [32, 0, 0, 0] (total=32)
[37m[36mINFO[0m[0m 01/28 23:49:05 | steps-per-epoch for each domain: 51.22 -> min = 51.22
[37m[36mINFO[0m[0m 01/28 23:49:07 | # of params = 23522375
[37m[36mINFO[0m[0m 01/28 23:49:43 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/28 23:49:43 | 0.141096    0.142791    0.219646    0.200489    1.910079    0.219646    0.200489    0.132729    0.149573    0.094311    0.092814    0.196247    0.185987    0           0.000000    3.561891    1.202251    34.841586  
[37m[36mINFO[0m[0m 01/28 23:50:57 | 0.279455    0.266768    0.477120    0.432763    1.466503    0.477120    0.432763    0.256397    0.254274    0.376497    0.347305    0.205471    0.198726    200         3.904820    1.837463    0.216540    30.788135  
[37m[36mINFO[0m[0m 01/28 23:52:04 | 0.634636    0.619530    0.840146    0.801956    0.570290    0.840146    0.801956    0.639659    0.626068    0.830090    0.799401    0.434160    0.433121    400         7.809640    0.860389    0.171319    32.439183  
[37m[36mINFO[0m[0m 01/28 23:53:20 | 0.735461    0.729114    0.962172    0.919315    0.265734    0.962172    0.919315    0.690832    0.681624    0.908683    0.880240    0.606870    0.625478    600         11.714460   0.243522    0.204702    34.772137  
[37m[36mINFO[0m[0m 01/28 23:54:36 | 0.681726    0.670423    0.968883    0.936430    0.227865    0.968883    0.936430    0.611407    0.574786    0.904192    0.877246    0.529580    0.559236    800         15.619280   0.156990    0.212581    32.545414  
[37m[36mINFO[0m[0m 01/28 23:55:40 | 0.657744    0.656719    0.965833    0.907090    0.277954    0.965833    0.907090    0.578358    0.576923    0.905689    0.886228    0.489186    0.507006    1000        19.524100   0.094217    0.167796    30.354800  
[37m[36mINFO[0m[0m 01/28 23:56:56 | 0.749356    0.767170    0.989018    0.941320    0.179382    0.989018    0.941320    0.668977    0.698718    0.912425    0.916168    0.666667    0.686624    1200        23.428920   0.059381    0.205132    35.054994  
[37m[36mINFO[0m[0m 01/28 23:58:12 | 0.740071    0.747442    0.963392    0.889976    0.444445    0.963392    0.889976    0.628998    0.623932    0.904192    0.901198    0.687023    0.717197    1400        27.333740   0.057540    0.220447    31.705645  
[37m[36mINFO[0m[0m 01/28 23:59:17 | 0.679465    0.672470    0.989018    0.929095    0.353611    0.989018    0.929095    0.582090    0.544872    0.948353    0.931138    0.507952    0.541401    1600        31.238560   0.054463    0.177627    29.108034  
[37m[36mINFO[0m[0m 01/29 00:00:38 | 0.683595    0.677027    0.992678    0.924205    0.267635    0.992678    0.924205    0.587953    0.574786    0.930389    0.916168    0.532443    0.540127    1800        35.143380   0.030449    0.233685    34.514123  
[37m[36mINFO[0m[0m 01/29 00:01:55 | 0.660504    0.645137    0.983527    0.921760    0.486468    0.983527    0.921760    0.609275    0.574786    0.924401    0.898204    0.447837    0.462420    2000        39.048200   0.052722    0.220881    33.061991  
[37m[36mINFO[0m[0m 01/29 00:03:01 | 0.721728    0.724471    0.992068    0.924205    0.321875    0.992068    0.924205    0.668977    0.670940    0.915419    0.901198    0.580789    0.601274    2200        42.953020   0.048883    0.181280    29.438004  
[37m[36mINFO[0m[0m 01/29 00:04:17 | 0.697277    0.676609    0.983527    0.919315    0.306956    0.983527    0.919315    0.646588    0.638889    0.906437    0.862275    0.538804    0.528662    2400        46.857840   0.054961    0.223650    31.440886  
[37m[36mINFO[0m[0m 01/29 00:05:36 | 0.707193    0.700418    0.997559    0.941320    0.410734    0.997559    0.941320    0.640192    0.632479    0.905689    0.880240    0.575700    0.588535    2600        50.762660   0.033777    0.232087    32.467049  
[37m[36mINFO[0m[0m 01/29 00:06:41 | 0.688932    0.685576    0.993289    0.904645    0.361138    0.993289    0.904645    0.603945    0.604701    0.945359    0.913174    0.517494    0.538854    2800        54.667480   0.042260    0.183564    27.807067  
[37m[36mINFO[0m[0m 01/29 00:07:55 | 0.713426    0.698827    0.998780    0.933985    0.261172    0.998780    0.933985    0.646055    0.636752    0.906437    0.862275    0.587786    0.597452    3000        58.572300   0.029141    0.212446    31.921662  
[37m[36mINFO[0m[0m 01/29 00:09:15 | 0.668445    0.652946    0.987187    0.892421    0.558004    0.987187    0.892421    0.606077    0.589744    0.934880    0.895210    0.464377    0.473885    3200        62.477120   0.038843    0.234659    32.818877  
[37m[36mINFO[0m[0m 01/29 00:10:24 | 0.749439    0.738878    0.992678    0.919315    0.362120    0.992678    0.919315    0.686567    0.700855    0.917665    0.862275    0.644084    0.653503    3400        66.381940   0.018362    0.209335    27.587245  
[37m[36mINFO[0m[0m 01/29 00:11:37 | 0.705785    0.688524    0.993289    0.914425    0.350035    0.993289    0.914425    0.658849    0.647436    0.907934    0.865269    0.550573    0.552866    3600        70.286760   0.028671    0.207671    30.801080  
[37m[36mINFO[0m[0m 01/29 00:12:54 | 0.698303    0.696375    0.996339    0.929095    0.287841    0.996339    0.929095    0.652452    0.634615    0.928144    0.904192    0.514313    0.550318    3800        74.191580   0.034401    0.231886    31.092389  
[37m[36mINFO[0m[0m 01/29 00:14:03 | 0.650189    0.647017    0.990848    0.899756    0.352104    0.990848    0.899756    0.605011    0.600427    0.916168    0.892216    0.429389    0.448408    4000        78.096400   0.028335    0.206099    27.304725  
[37m[36mINFO[0m[0m 01/29 00:15:16 | 0.705852    0.703406    0.995119    0.924205    0.304515    0.995119    0.924205    0.620469    0.619658    0.919162    0.898204    0.577926    0.592357    4200        82.001220   0.025122    0.201575    33.189668  
[37m[36mINFO[0m[0m 01/29 00:16:39 | 0.711304    0.693549    0.984747    0.907090    0.356364    0.984747    0.907090    0.658849    0.634615    0.897455    0.847305    0.577608    0.598726    4400        85.906040   0.067951    0.242778    34.197238  
[37m[36mINFO[0m[0m 01/29 00:17:44 | 0.712176    0.703215    0.999390    0.919315    0.319395    0.999390    0.919315    0.619403    0.596154    0.919162    0.898204    0.597964    0.615287    4600        89.810860   0.032651    0.201790    25.282620  
[37m[36mINFO[0m[0m 01/29 00:18:55 | 0.699042    0.691797    0.996949    0.921760    0.420550    0.996949    0.921760    0.664179    0.655983    0.894461    0.865269    0.538486    0.554140    4800        93.715680   0.011043    0.209164    29.029537  
[37m[36mINFO[0m[0m 01/29 00:20:03 | 0.727017    0.707467    0.973764    0.880196    0.571641    0.973764    0.880196    0.676972    0.660256    0.880988    0.844311    0.623092    0.617834    5000        97.620500   0.054157    0.179228    31.896588  
[37m[36mINFO[0m[0m 01/29 00:20:03 | Cumulative gradient change saved at train_output/PACS/RSC/[1, 2, 3]/250128_23-49-05_resnet50_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/29 00:20:05 | ---
[37m[36mINFO[0m[0m 01/29 00:20:05 | test-domain validation(oracle) = 74.936%
[37m[36mINFO[0m[0m 01/29 00:20:05 | training-domain validation(iid) = 74.936%
[37m[36mINFO[0m[0m 01/29 00:20:05 | last = 72.702%
[37m[36mINFO[0m[0m 01/29 00:20:05 | last (inD) = 88.020%
[37m[36mINFO[0m[0m 01/29 00:20:05 | training-domain validation (iid, inD) = 94.132%
[37m[36mINFO[0m[0m 01/29 00:20:05 | === Summary ===
[37m[36mINFO[0m[0m 01/29 00:20:05 | Command: /jsm0707/Large-scale/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm RSC --test_envs 1 2 3 --dataset PACS
[37m[36mINFO[0m[0m 01/29 00:20:05 | Unique name: 250128_23-49-05_resnet50_adam
[37m[36mINFO[0m[0m 01/29 00:20:05 | Out path: train_output/PACS/RSC/[1, 2, 3]/250128_23-49-05_resnet50_adam
[37m[36mINFO[0m[0m 01/29 00:20:05 | Algorithm: RSC
[37m[36mINFO[0m[0m 01/29 00:20:05 | Dataset: PACS

[37m[36mINFO[0m[0m 01/27 23:26:43 | Command :: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm RSC --test_envs 0 1 2 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/PACS/RSC/[0, 1, 2]/250127_23-26-43_resnet50_sgd
	out_root: train_output/PACS/RSC/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 0
	unique_name: 250127_23-26-43_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	rsc_f_drop_factor: 0.3333333333333333
	rsc_b_drop_factor: 0.3333333333333333
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 01/27 23:26:43 | n_steps = 5001
[37m[36mINFO[0m[0m 01/27 23:26:43 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/27 23:26:43 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/27 23:26:43 | 
[37m[36mINFO[0m[0m 01/27 23:26:43 | Testenv name escaping te_A_C_P -> te_A_C_P
[37m[36mINFO[0m[0m 01/27 23:26:43 | Test envs = [0, 1, 2], name = te_A_C_P
[37m[36mINFO[0m[0m 01/27 23:26:43 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 01/27 23:26:43 | Batch sizes for each domain: [0, 0, 0, 32] (total=32)
[37m[36mINFO[0m[0m 01/27 23:26:43 | steps-per-epoch for each domain: 98.25 -> min = 98.25
[37m[36mINFO[0m[0m 01/27 23:26:44 | # of params = 23522375
[37m[36mINFO[0m[0m 01/27 23:27:12 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/27 23:27:12 | 0.140082    0.145658    0.045165    0.068790    2.120417    0.226358    0.190709    0.098081    0.117521    0.095808    0.128743    0.045165    0.068790    0           0.000000    3.213133    1.296674    26.420960  
[37m[36mINFO[0m[0m 01/27 23:28:06 | 0.142010    0.134726    0.221692    0.183439    1.926275    0.194021    0.161369    0.151919    0.155983    0.080090    0.086826    0.221692    0.183439    200         2.035623    2.389471    0.151136    23.744096  
[37m[36mINFO[0m[0m 01/27 23:29:04 | 0.154832    0.158588    0.227735    0.185987    1.902709    0.195241    0.183374    0.176439    0.196581    0.092814    0.095808    0.227735    0.185987    400         4.071247    2.127248    0.158619    26.078997  
[37m[36mINFO[0m[0m 01/27 23:30:01 | 0.164905    0.165760    0.233142    0.184713    1.887918    0.199512    0.198044    0.188166    0.194444    0.107036    0.104790    0.233142    0.184713    600         6.106870    2.059624    0.158554    25.063707  
[37m[36mINFO[0m[0m 01/27 23:30:58 | 0.169117    0.165840    0.237277    0.184713    1.876135    0.198902    0.193154    0.192431    0.196581    0.116018    0.107784    0.237277    0.184713    800         8.142494    2.021144    0.149935    26.711835  
[37m[36mINFO[0m[0m 01/27 23:31:55 | 0.171429    0.167409    0.241094    0.184713    1.864754    0.197071    0.193154    0.192964    0.192308    0.124251    0.116766    0.241094    0.184713    1000        10.178117   1.995622    0.158597    24.219251  
[37m[36mINFO[0m[0m 01/27 23:32:53 | 0.171882    0.164949    0.233461    0.184713    1.853546    0.197682    0.195599    0.192964    0.179487    0.125000    0.119760    0.233461    0.184713    1200        12.213740   1.973134    0.166086    24.985570  
[37m[36mINFO[0m[0m 01/27 23:33:49 | 0.172292    0.169508    0.244911    0.184713    1.843267    0.196461    0.195599    0.196162    0.190171    0.124251    0.122754    0.244911    0.184713    1400        14.249364   1.953642    0.155124    24.481529  
[37m[36mINFO[0m[0m 01/27 23:34:44 | 0.172106    0.168369    0.245865    0.185987    1.834415    0.197071    0.195599    0.193497    0.183761    0.125749    0.125749    0.245865    0.185987    1600        16.284987   1.939357    0.149456    25.182077  
[37m[36mINFO[0m[0m 01/27 23:35:42 | 0.171272    0.171607    0.249682    0.185987    1.826424    0.195851    0.198044    0.192964    0.188034    0.125000    0.128743    0.249682    0.185987    1800        18.320611   1.927694    0.169763    23.314289  
[37m[36mINFO[0m[0m 01/27 23:36:38 | 0.172152    0.173603    0.245865    0.185987    1.818514    0.196461    0.198044    0.193497    0.188034    0.126497    0.134731    0.245865    0.185987    2000        20.356234   1.914434    0.152053    26.035139  
[37m[36mINFO[0m[0m 01/27 23:37:35 | 0.174585    0.175842    0.236641    0.185987    1.812018    0.197682    0.200489    0.198827    0.192308    0.127246    0.134731    0.236641    0.185987    2200        22.391858   1.905048    0.156456    24.686134  
[37m[36mINFO[0m[0m 01/27 23:38:32 | 0.174077    0.178551    0.246819    0.185987    1.806687    0.198292    0.200489    0.196695    0.194444    0.127246    0.140719    0.246819    0.185987    2400        24.427481   1.899807    0.161758    24.495049  
[37m[36mINFO[0m[0m 01/27 23:39:30 | 0.173132    0.176311    0.236323    0.184713    1.801411    0.195241    0.198044    0.196162    0.190171    0.127994    0.140719    0.236323    0.184713    2600        26.463104   1.890137    0.157204    25.985554  
[37m[36mINFO[0m[0m 01/27 23:40:26 | 0.174198    0.176921    0.250000    0.185987    1.796833    0.195241    0.195599    0.199360    0.194444    0.127994    0.140719    0.250000    0.185987    2800        28.498728   1.881993    0.157974    24.359716  
[37m[36mINFO[0m[0m 01/27 23:41:25 | 0.175073    0.176106    0.230280    0.183439    1.792434    0.194021    0.193154    0.200959    0.194444    0.130240    0.140719    0.230280    0.183439    3000        30.534351   1.872978    0.164056    26.192489  
[37m[36mINFO[0m[0m 01/27 23:42:20 | 0.174620    0.176818    0.230280    0.183439    1.790121    0.193411    0.193154    0.200959    0.196581    0.129491    0.140719    0.230280    0.183439    3200        32.569975   1.877342    0.151042    24.798368  
[37m[36mINFO[0m[0m 01/27 23:43:16 | 0.174870    0.173866    0.234733    0.183439    1.787251    0.193411    0.190709    0.200959    0.190171    0.130240    0.140719    0.234733    0.183439    3400        34.605598   1.866614    0.156050    24.998574  
[37m[36mINFO[0m[0m 01/27 23:44:14 | 0.175277    0.172933    0.218511    0.183439    1.784072    0.194631    0.195599    0.200959    0.179487    0.130240    0.143713    0.218511    0.183439    3600        36.641221   1.856299    0.162325    25.231535  
[37m[36mINFO[0m[0m 01/27 23:45:11 | 0.175755    0.171508    0.228372    0.183439    1.781782    0.195851    0.195599    0.200426    0.175214    0.130988    0.143713    0.228372    0.183439    3800        38.676845   1.856466    0.153609    26.847586  
[37m[36mINFO[0m[0m 01/27 23:46:10 | 0.174918    0.172323    0.218193    0.183439    1.780007    0.197071    0.198044    0.196695    0.175214    0.130988    0.143713    0.218193    0.183439    4000        40.712468   1.852956    0.164020    26.000890  
[37m[36mINFO[0m[0m 01/27 23:47:06 | 0.175019    0.171611    0.210878    0.183439    1.778365    0.195241    0.198044    0.198827    0.173077    0.130988    0.143713    0.210878    0.183439    4200        42.748092   1.850993    0.157666    24.512162  
[37m[36mINFO[0m[0m 01/27 23:48:02 | 0.173322    0.170796    0.214695    0.183439    1.777206    0.194631    0.195599    0.195096    0.173077    0.130240    0.143713    0.214695    0.183439    4400        44.783715   1.851277    0.150402    25.775302  
[37m[36mINFO[0m[0m 01/27 23:48:59 | 0.173039    0.169372    0.216603    0.183439    1.776009    0.194631    0.195599    0.193497    0.168803    0.130988    0.143713    0.216603    0.183439    4600        46.819338   1.847698    0.158728    25.179816  
[37m[36mINFO[0m[0m 01/27 23:49:58 | 0.171566    0.169372    0.228372    0.183439    1.774263    0.193411    0.195599    0.190299    0.168803    0.130988    0.143713    0.228372    0.183439    4800        48.854962   1.838368    0.169825    24.996340  
[37m[36mINFO[0m[0m 01/27 23:50:56 | 0.171282    0.169901    0.240776    0.183439    1.773570    0.193411    0.198044    0.188699    0.170940    0.131737    0.140719    0.240776    0.183439    5000        50.890585   1.844856    0.161604    25.894918  
[37m[36mINFO[0m[0m 01/27 23:50:56 | Cumulative gradient change saved at train_output/PACS/RSC/[0, 1, 2]/250127_23-26-43_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/27 23:50:57 | ---
[37m[36mINFO[0m[0m 01/27 23:50:57 | test-domain validation(oracle) = 17.408%
[37m[36mINFO[0m[0m 01/27 23:50:57 | training-domain validation(iid) = 15.483%
[37m[36mINFO[0m[0m 01/27 23:50:57 | last = 17.128%
[37m[36mINFO[0m[0m 01/27 23:50:57 | last (inD) = 18.344%
[37m[36mINFO[0m[0m 01/27 23:50:57 | training-domain validation (iid, inD) = 18.599%
[37m[36mINFO[0m[0m 01/27 23:50:57 | === Summary ===
[37m[36mINFO[0m[0m 01/27 23:50:57 | Command: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm RSC --test_envs 0 1 2 --dataset PACS
[37m[36mINFO[0m[0m 01/27 23:50:57 | Unique name: 250127_23-26-43_resnet50_sgd
[37m[36mINFO[0m[0m 01/27 23:50:57 | Out path: train_output/PACS/RSC/[0, 1, 2]/250127_23-26-43_resnet50_sgd
[37m[36mINFO[0m[0m 01/27 23:50:57 | Algorithm: RSC
[37m[36mINFO[0m[0m 01/27 23:50:57 | Dataset: PACS

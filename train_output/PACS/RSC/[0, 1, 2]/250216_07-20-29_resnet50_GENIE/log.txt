[37m[36mINFO[0m[0m 02/16 07:20:29 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 2 --dataset PACS --trial_seed 1 --hparams_seed 8
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 8
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/PACS/RSC/[0, 1, 2]/250216_07-20-29_resnet50_GENIE
	out_root: train_output/PACS/RSC/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 1
	unique_name: 250216_07-20-29_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 3.335053008064847e-05
	batch_size: 18
	weight_decay: 0.00011109601170966198
	rsc_f_drop_factor: 0.18129063791925754
	rsc_b_drop_factor: 0.03567706337646076
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 02/16 07:20:29 | n_steps = 5001
[37m[36mINFO[0m[0m 02/16 07:20:29 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/16 07:20:29 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/16 07:20:29 | 
[37m[36mINFO[0m[0m 02/16 07:20:29 | Testenv name escaping te_A_C_P -> te_A_C_P
[37m[36mINFO[0m[0m 02/16 07:20:29 | Test envs = [0, 1, 2], name = te_A_C_P
[37m[36mINFO[0m[0m 02/16 07:20:29 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 02/16 07:20:29 | Batch sizes for each domain: [0, 0, 0, 18] (total=18)
[37m[36mINFO[0m[0m 02/16 07:20:29 | steps-per-epoch for each domain: 174.67 -> min = 174.67
[37m[36mINFO[0m[0m 02/16 07:20:30 | # of params = 23522375
[37m[36mINFO[0m[0m 02/16 07:20:55 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/16 07:20:55 | 0.135616    0.148127    0.187659    0.207643    1.790092    0.143380    0.161369    0.144456    0.160256    0.119012    0.122754    0.187659    0.207643    0           0.000000    2.254753    0.917596    24.558354  
[37m[36mINFO[0m[0m 02/16 07:21:58 | 0.436408    0.417498    0.817112    0.857325    0.428108    0.359365    0.325183    0.461087    0.472222    0.488772    0.455090    0.817112    0.857325    200         1.145038    1.029030    0.176977    27.259011  
[37m[36mINFO[0m[0m 02/16 07:22:55 | 0.440098    0.458692    0.831107    0.822930    0.461315    0.339231    0.315403    0.539446    0.572650    0.441617    0.488024    0.831107    0.822930    400         2.290076    0.459165    0.137460    29.416481  
[37m[36mINFO[0m[0m 02/16 07:23:53 | 0.452242    0.472603    0.926527    0.942675    0.242066    0.386821    0.361858    0.552239    0.591880    0.417665    0.464072    0.926527    0.942675    600         3.435115    0.335332    0.179791    22.529041  
[37m[36mINFO[0m[0m 02/16 07:24:57 | 0.600146    0.597771    0.953244    0.951592    0.136403    0.564369    0.515892    0.688166    0.696581    0.547904    0.580838    0.953244    0.951592    800         4.580153    0.213505    0.179539    27.990230  
[37m[36mINFO[0m[0m 02/16 07:25:56 | 0.618200    0.619819    0.946247    0.940127    0.180574    0.577181    0.562347    0.663646    0.677350    0.613772    0.619760    0.946247    0.940127    1000        5.725191    0.184231    0.150721    29.240728  
[37m[36mINFO[0m[0m 02/16 07:26:58 | 0.541459    0.552847    0.959924    0.957962    0.132305    0.541184    0.508557    0.642324    0.670940    0.440868    0.479042    0.959924    0.957962    1200        6.870229    0.166842    0.168107    28.317151  
[37m[36mINFO[0m[0m 02/16 07:28:19 | 0.541582    0.553659    0.944338    0.923567    0.233341    0.533252    0.520782    0.619936    0.613248    0.471557    0.526946    0.944338    0.923567    1400        8.015267    0.133327    0.259220    29.125772  
[37m[36mINFO[0m[0m 02/16 07:29:19 | 0.572457    0.567297    0.974873    0.957962    0.138819    0.580842    0.540342    0.649254    0.649573    0.487275    0.511976    0.974873    0.957962    1600        9.160305    0.120727    0.154642    28.835130  
[37m[36mINFO[0m[0m 02/16 07:30:17 | 0.593814    0.589618    0.983461    0.959236    0.101985    0.552776    0.525672    0.732409    0.722222    0.496257    0.520958    0.983461    0.959236    1800        10.305344   0.092488    0.160742    25.893542  
[37m[36mINFO[0m[0m 02/16 07:31:22 | 0.578020    0.590610    0.986641    0.968153    0.106044    0.546065    0.569682    0.673774    0.690171    0.514222    0.511976    0.986641    0.968153    2000        11.450382   0.096732    0.179884    28.517080  
[37m[36mINFO[0m[0m 02/16 07:32:32 | 0.543293    0.554585    0.975191    0.947771    0.189503    0.497865    0.498778    0.656716    0.641026    0.475299    0.523952    0.975191    0.947771    2200        12.595420   0.093930    0.188785    32.406560  
[37m[36mINFO[0m[0m 02/16 07:33:29 | 0.593812    0.621439    0.985051    0.957962    0.177273    0.581452    0.584352    0.705224    0.720085    0.494760    0.559880    0.985051    0.957962    2400        13.740458   0.072983    0.163518    24.290690  
[37m[36mINFO[0m[0m 02/16 07:34:31 | 0.543596    0.556512    0.993003    0.974522    0.081510    0.482611    0.493888    0.651919    0.666667    0.496257    0.508982    0.993003    0.974522    2600        14.885496   0.069662    0.189181    24.584110  
[37m[36mINFO[0m[0m 02/16 07:35:30 | 0.607237    0.609929    0.990776    0.974522    0.092988    0.598536    0.591687    0.673774    0.660256    0.549401    0.577844    0.990776    0.974522    2800        16.030534   0.071363    0.129524    32.766477  
[37m[36mINFO[0m[0m 02/16 07:36:39 | 0.552963    0.566335    0.986323    0.964331    0.107205    0.534472    0.555012    0.658849    0.670940    0.465569    0.473054    0.986323    0.964331    3000        17.175573   0.067387    0.214180    25.999662  
[37m[36mINFO[0m[0m 02/16 07:37:46 | 0.496062    0.488159    0.969784    0.942675    0.204451    0.410616    0.393643    0.698827    0.696581    0.378743    0.374251    0.969784    0.942675    3200        18.320611   0.107765    0.206798    25.413113  
[37m[36mINFO[0m[0m 02/16 07:38:39 | 0.591556    0.621969    0.986959    0.947771    0.164237    0.586943    0.586797    0.692964    0.722222    0.494760    0.556886    0.986959    0.947771    3400        19.465649   0.082448    0.142504    25.279008  
[37m[36mINFO[0m[0m 02/16 07:39:33 | 0.599237    0.601430    0.978053    0.945223    0.170988    0.617450    0.596577    0.685501    0.683761    0.494760    0.523952    0.978053    0.945223    3600        20.610687   0.080998    0.138442    26.175425  
[37m[36mINFO[0m[0m 02/16 07:40:48 | 0.620105    0.639192    0.987913    0.969427    0.132534    0.580842    0.623472    0.691898    0.692308    0.587575    0.601796    0.987913    0.969427    3800        21.755725   0.063597    0.249188    24.342195  
[37m[36mINFO[0m[0m 02/16 07:41:59 | 0.624081    0.642209    0.994911    0.974522    0.122094    0.596705    0.603912    0.720149    0.747863    0.555389    0.574850    0.994911    0.974522    4000        22.900763   0.040461    0.205974    30.095138  
[37m[36mINFO[0m[0m 02/16 07:42:54 | 0.531555    0.533965    0.986005    0.951592    0.164995    0.489323    0.452323    0.637527    0.649573    0.467814    0.500000    0.986005    0.951592    4200        24.045802   0.046151    0.145223    26.066891  
[37m[36mINFO[0m[0m 02/16 07:44:03 | 0.605117    0.620153    0.992366    0.965605    0.103580    0.613179    0.594132    0.653518    0.664530    0.548653    0.601796    0.992366    0.965605    4400        25.190840   0.044264    0.207167    27.783818  
[37m[36mINFO[0m[0m 02/16 07:45:11 | 0.479892    0.469635    0.973919    0.949045    0.140383    0.437462    0.386308    0.581557    0.585470    0.420659    0.437126    0.973919    0.949045    4600        26.335878   0.047103    0.202048    27.711413  
[37m[36mINFO[0m[0m 02/16 07:46:11 | 0.604962    0.615543    0.989822    0.963057    0.205807    0.594875    0.596577    0.694563    0.690171    0.525449    0.559880    0.989822    0.963057    4800        27.480916   0.033634    0.176122    24.642795  
[37m[36mINFO[0m[0m 02/16 07:47:13 | 0.645184    0.650995    0.996819    0.975796    0.105743    0.641245    0.633252    0.736674    0.732906    0.557635    0.586826    0.996819    0.975796    5000        28.625954   0.027320    0.188334    23.920575  
[37m[36mINFO[0m[0m 02/16 07:47:13 | Cumulative gradient change saved at train_output/PACS/RSC/[0, 1, 2]/250216_07-20-29_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/16 07:47:15 | ---
[37m[36mINFO[0m[0m 02/16 07:47:15 | test-domain validation(oracle) = 64.518%
[37m[36mINFO[0m[0m 02/16 07:47:15 | training-domain validation(iid) = 64.518%
[37m[36mINFO[0m[0m 02/16 07:47:15 | last = 64.518%
[37m[36mINFO[0m[0m 02/16 07:47:15 | last (inD) = 97.580%
[37m[36mINFO[0m[0m 02/16 07:47:15 | training-domain validation (iid, inD) = 97.580%
[37m[36mINFO[0m[0m 02/16 07:47:15 | === Summary ===
[37m[36mINFO[0m[0m 02/16 07:47:15 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 2 --dataset PACS --trial_seed 1 --hparams_seed 8
[37m[36mINFO[0m[0m 02/16 07:47:15 | Unique name: 250216_07-20-29_resnet50_GENIE
[37m[36mINFO[0m[0m 02/16 07:47:15 | Out path: train_output/PACS/RSC/[0, 1, 2]/250216_07-20-29_resnet50_GENIE
[37m[36mINFO[0m[0m 02/16 07:47:15 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/16 07:47:15 | Dataset: PACS

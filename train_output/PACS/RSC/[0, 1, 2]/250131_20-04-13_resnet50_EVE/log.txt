[37m[36mINFO[0m[0m 01/31 20:04:13 | Command :: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm RSC --test_envs 0 1 2 --dataset PACS --trial_seed 0 --hparams_seed 0
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/PACS/RSC/[0, 1, 2]/250131_20-04-13_resnet50_EVE
	out_root: train_output/PACS/RSC/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 0
	unique_name: 250131_20-04-13_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: GENIE
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	rsc_f_drop_factor: 0.3333333333333333
	rsc_b_drop_factor: 0.3333333333333333
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 01/31 20:04:14 | n_steps = 5001
[37m[36mINFO[0m[0m 01/31 20:04:14 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/31 20:04:14 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/31 20:04:14 | 
[37m[36mINFO[0m[0m 01/31 20:04:14 | Testenv name escaping te_A_C_P -> te_A_C_P
[37m[36mINFO[0m[0m 01/31 20:04:14 | Test envs = [0, 1, 2], name = te_A_C_P
[37m[36mINFO[0m[0m 01/31 20:04:14 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 01/31 20:04:14 | Batch sizes for each domain: [0, 0, 0, 32] (total=32)
[37m[36mINFO[0m[0m 01/31 20:04:14 | steps-per-epoch for each domain: 98.25 -> min = 98.25
[37m[36mINFO[0m[0m 01/31 20:04:15 | # of params = 23522375
[37m[36mINFO[0m[0m 01/31 20:04:39 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/31 20:04:39 | 0.161749    0.184774    0.218511    0.224204    1.851780    0.183649    0.202934    0.194563    0.228632    0.107036    0.122754    0.218511    0.224204    0           0.000000    3.213133    1.233557    23.319311  
[37m[36mINFO[0m[0m 01/31 20:05:37 | 0.119201    0.117678    0.208333    0.214013    1.656898    0.101281    0.097800    0.138060    0.132479    0.118263    0.122754    0.208333    0.214013    200         2.035623    1.808297    0.168590    23.817911  
[37m[36mINFO[0m[0m 01/31 20:06:36 | 0.138574    0.138683    0.395992    0.406369    1.369532    0.106162    0.102689    0.178571    0.181624    0.130988    0.131737    0.395992    0.406369    400         4.071247    1.740652    0.179443    23.136641  
[37m[36mINFO[0m[0m 01/31 20:07:37 | 0.155966    0.148111    0.552799    0.537580    1.037683    0.134838    0.144254    0.222281    0.207265    0.110778    0.092814    0.552799    0.537580    600         6.106870    1.506922    0.185061    23.541794  
[37m[36mINFO[0m[0m 01/31 20:08:45 | 0.228587    0.219470    0.671756    0.690446    0.770203    0.175107    0.180929    0.334755    0.324786    0.175898    0.152695    0.671756    0.690446    800         8.142494    1.419544    0.204186    26.552364  
[37m[36mINFO[0m[0m 01/31 20:10:18 | 0.299684    0.290640    0.795165    0.784713    0.546557    0.262965    0.264059    0.404051    0.410256    0.232036    0.197605    0.795165    0.784713    1000        10.178117   1.168452    0.280168    37.094486  
[37m[36mINFO[0m[0m 01/31 20:11:34 | 0.299191    0.284716    0.835560    0.807643    0.562392    0.228798    0.207824    0.450959    0.448718    0.217814    0.197605    0.835560    0.807643    1200        12.213740   1.026114    0.237334    27.567279  
[37m[36mINFO[0m[0m 01/31 20:12:58 | 0.354881    0.338652    0.914440    0.877707    0.369018    0.333130    0.325183    0.495736    0.487179    0.235778    0.203593    0.914440    0.877707    1400        14.249364   0.919579    0.255041    33.051824  
[37m[36mINFO[0m[0m 01/31 20:14:50 | 0.391301    0.369555    0.888677    0.862420    0.470900    0.351434    0.317848    0.509595    0.536325    0.312874    0.254491    0.888677    0.862420    1600        16.284987   0.826832    0.358015    39.661125  
[37m[36mINFO[0m[0m 01/31 20:16:06 | 0.428504    0.433278    0.952290    0.903185    0.401882    0.381940    0.403423    0.564499    0.594017    0.339072    0.302395    0.952290    0.903185    1800        18.320611   0.761010    0.252192    25.147289  
[37m[36mINFO[0m[0m 01/31 20:17:28 | 0.384691    0.381704    0.900445    0.903185    0.329866    0.289811    0.281174    0.550640    0.555556    0.313623    0.308383    0.900445    0.903185    2000        20.356234   0.680059    0.235614    33.940552  
[37m[36mINFO[0m[0m 01/31 20:19:05 | 0.433611    0.431724    0.936387    0.899363    0.461283    0.411226    0.420538    0.513859    0.551282    0.375749    0.323353    0.936387    0.899363    2200        22.391858   0.647644    0.319758    33.686756  
[37m[36mINFO[0m[0m 01/31 20:20:32 | 0.410976    0.407514    0.935115    0.896815    0.631415    0.344112    0.349633    0.563966    0.570513    0.324850    0.302395    0.935115    0.896815    2400        24.427481   0.575273    0.279067    31.035435  
[37m[36mINFO[0m[0m 01/31 20:21:58 | 0.459781    0.449472    0.911578    0.887898    0.433766    0.386211    0.398533    0.615139    0.587607    0.377994    0.362275    0.911578    0.887898    2600        26.463104   0.627415    0.282449    29.465330  
[37m[36mINFO[0m[0m 01/31 20:23:29 | 0.483644    0.461942    0.906170    0.876433    0.474301    0.410006    0.393643    0.652452    0.638889    0.388473    0.353293    0.906170    0.876433    2800        28.498728   0.497092    0.290165    32.666012  
[37m[36mINFO[0m[0m 01/31 20:24:55 | 0.484116    0.479648    0.959606    0.915924    0.585253    0.446004    0.435208    0.630597    0.632479    0.375749    0.371257    0.959606    0.915924    3000        30.534351   0.519283    0.248095    35.384792  
[37m[36mINFO[0m[0m 01/31 20:26:26 | 0.424734    0.426461    0.946247    0.914650    0.426796    0.384991    0.393643    0.538913    0.568376    0.350299    0.317365    0.946247    0.914650    3200        32.569975   0.461918    0.308796    28.380097  
[37m[36mINFO[0m[0m 01/31 20:27:54 | 0.464790    0.454286    0.936705    0.880255    0.497376    0.431361    0.418093    0.569296    0.570513    0.393713    0.374251    0.936705    0.880255    3400        34.605598   0.545919    0.300945    28.498179  
[37m[36mINFO[0m[0m 01/31 20:29:24 | 0.487951    0.476446    0.969148    0.941401    0.533775    0.420988    0.413203    0.647655    0.638889    0.395210    0.377246    0.969148    0.941401    3600        36.641221   0.442905    0.277999    34.189704  
[37m[36mINFO[0m[0m 01/31 20:30:55 | 0.437543    0.421321    0.904898    0.875159    0.437128    0.363636    0.359413    0.572495    0.581197    0.376497    0.323353    0.904898    0.875159    3800        38.676845   0.479297    0.268706    37.158197  
[37m[36mINFO[0m[0m 01/31 20:32:33 | 0.423822    0.423916    0.970738    0.927389    0.384662    0.371568    0.374083    0.612473    0.628205    0.287425    0.269461    0.970738    0.927389    4000        40.712468   0.460140    0.321388    32.900410  
[37m[36mINFO[0m[0m 01/31 20:33:49 | 0.380392    0.370615    0.956425    0.942675    0.228507    0.273337    0.278729    0.606610    0.587607    0.261228    0.245509    0.956425    0.942675    4200        42.748092   0.473492    0.248254    27.042488  
[37m[36mINFO[0m[0m 01/31 20:35:12 | 0.426235    0.408343    0.973282    0.931210    1.696219    0.379500    0.359413    0.593817    0.596154    0.305389    0.269461    0.973282    0.931210    4400        44.783715   0.388246    0.242182    34.400695  
[37m[36mINFO[0m[0m 01/31 20:37:02 | 0.361568    0.365968    0.961514    0.929936    0.264490    0.267846    0.266504    0.562367    0.591880    0.254491    0.239521    0.961514    0.929936    4600        46.819338   0.447448    0.363829    36.891179  
[37m[36mINFO[0m[0m 01/31 20:38:14 | 0.403977    0.378611    0.978372    0.922293    0.983587    0.327639    0.303178    0.610341    0.626068    0.273952    0.206587    0.978372    0.922293    4800        48.854962   0.363733    0.230250    26.498615  
[37m[36mINFO[0m[0m 01/31 20:39:27 | 0.415271    0.408545    0.972010    0.929936    0.867922    0.364857    0.347188    0.581557    0.594017    0.299401    0.284431    0.972010    0.929936    5000        50.890585   0.325345    0.180123    37.135520  
[37m[36mINFO[0m[0m 01/31 20:39:28 | Cumulative gradient change saved at train_output/PACS/RSC/[0, 1, 2]/250131_20-04-13_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/31 20:39:31 | ---
[37m[36mINFO[0m[0m 01/31 20:39:31 | test-domain validation(oracle) = 48.412%
[37m[36mINFO[0m[0m 01/31 20:39:31 | training-domain validation(iid) = 38.039%
[37m[36mINFO[0m[0m 01/31 20:39:31 | last = 41.527%
[37m[36mINFO[0m[0m 01/31 20:39:31 | last (inD) = 92.994%
[37m[36mINFO[0m[0m 01/31 20:39:31 | training-domain validation (iid, inD) = 94.268%
[37m[36mINFO[0m[0m 01/31 20:39:31 | === Summary ===
[37m[36mINFO[0m[0m 01/31 20:39:31 | Command: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm RSC --test_envs 0 1 2 --dataset PACS --trial_seed 0 --hparams_seed 0
[37m[36mINFO[0m[0m 01/31 20:39:31 | Unique name: 250131_20-04-13_resnet50_EVE
[37m[36mINFO[0m[0m 01/31 20:39:31 | Out path: train_output/PACS/RSC/[0, 1, 2]/250131_20-04-13_resnet50_EVE
[37m[36mINFO[0m[0m 01/31 20:39:31 | Algorithm: RSC
[37m[36mINFO[0m[0m 01/31 20:39:31 | Dataset: PACS

[37m[36mINFO[0m[0m 01/27 22:35:52 | Command :: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm RSC --test_envs 0 2 3 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/PACS/RSC/[0, 2, 3]/250127_22-35-52_resnet50_sgd
	out_root: train_output/PACS/RSC/[0, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 2, 3]
	trial_seed: 0
	unique_name: 250127_22-35-52_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	rsc_f_drop_factor: 0.3333333333333333
	rsc_b_drop_factor: 0.3333333333333333
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 01/27 22:35:52 | n_steps = 5001
[37m[36mINFO[0m[0m 01/27 22:35:52 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/27 22:35:52 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/27 22:35:52 | 
[37m[36mINFO[0m[0m 01/27 22:35:52 | Testenv name escaping te_A_P_S -> te_A_P_S
[37m[36mINFO[0m[0m 01/27 22:35:52 | Test envs = [0, 2, 3], name = te_A_P_S
[37m[36mINFO[0m[0m 01/27 22:35:52 | Train environments: [1], Test environments: [0, 2, 3]
[37m[36mINFO[0m[0m 01/27 22:35:52 | Batch sizes for each domain: [0, 32, 0, 0] (total=32)
[37m[36mINFO[0m[0m 01/27 22:35:52 | steps-per-epoch for each domain: 58.62 -> min = 58.62
[37m[36mINFO[0m[0m 01/27 22:35:53 | # of params = 23522375
[37m[36mINFO[0m[0m 01/27 22:36:19 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/27 22:36:19 | 0.127384    0.131410    0.123667    0.113248    2.011573    0.224527    0.190709    0.123667    0.113248    0.096557    0.134731    0.061069    0.068790    0           0.000000    3.453606    1.651253    24.399943  
[37m[36mINFO[0m[0m 01/27 22:37:18 | 0.153952    0.140784    0.148188    0.155983    1.918353    0.209884    0.176039    0.148188    0.155983    0.057635    0.062874    0.194338    0.183439    200         3.411514    2.748488    0.164846    25.764430  
[37m[36mINFO[0m[0m 01/27 22:38:19 | 0.149876    0.144044    0.181237    0.173077    1.911601    0.198292    0.185819    0.181237    0.173077    0.057635    0.062874    0.193702    0.183439    400         6.823028    2.282986    0.176901    24.833869  
[37m[36mINFO[0m[0m 01/27 22:39:19 | 0.147523    0.147221    0.192964    0.194444    1.909605    0.187919    0.183374    0.192964    0.194444    0.060629    0.074850    0.194020    0.183439    600         10.234542   2.161937    0.169740    25.948976  
[37m[36mINFO[0m[0m 01/27 22:40:18 | 0.144611    0.136626    0.216951    0.217949    1.908562    0.176937    0.151589    0.216951    0.217949    0.062874    0.074850    0.194020    0.183439    800         13.646055   2.106102    0.175247    23.698702  
[37m[36mINFO[0m[0m 01/27 22:41:17 | 0.143418    0.136992    0.211620    0.235043    1.908098    0.169616    0.146699    0.211620    0.235043    0.066617    0.080838    0.194020    0.183439    1000        17.057569   2.069982    0.168879    25.019445  
[37m[36mINFO[0m[0m 01/27 22:42:18 | 0.142348    0.137417    0.218017    0.241453    1.907703    0.161074    0.146699    0.218017    0.241453    0.070359    0.080838    0.195611    0.184713    1200        20.469083   2.047573    0.171170    26.249909  
[37m[36mINFO[0m[0m 01/27 22:43:21 | 0.142999    0.137683    0.212687    0.237179    1.907519    0.160464    0.156479    0.212687    0.237179    0.072605    0.071856    0.195929    0.184713    1400        23.880597   2.031313    0.180105    26.190747  
[37m[36mINFO[0m[0m 01/27 22:44:22 | 0.142882    0.140196    0.205757    0.250000    1.907020    0.158633    0.158924    0.205757    0.250000    0.071856    0.071856    0.198155    0.189809    1600        27.292111   2.018066    0.169363    27.468851  
[37m[36mINFO[0m[0m 01/27 22:45:18 | 0.142733    0.141480    0.221215    0.250000    1.906254    0.153752    0.149144    0.221215    0.250000    0.069611    0.077844    0.204835    0.197452    1800        30.703625   2.006284    0.156432    24.656609  
[37m[36mINFO[0m[0m 01/27 22:46:17 | 0.145874    0.139736    0.213753    0.258547    1.905781    0.149481    0.141809    0.213753    0.258547    0.071856    0.074850    0.216285    0.202548    2000        34.115139   1.999618    0.162804    25.395275  
[37m[36mINFO[0m[0m 01/27 22:47:15 | 0.152009    0.144534    0.212687    0.245726    1.905000    0.153142    0.141809    0.212687    0.245726    0.072605    0.068862    0.230280    0.222930    2200        37.526652   1.990801    0.168157    24.487976  
[37m[36mINFO[0m[0m 01/27 22:48:14 | 0.155449    0.149273    0.214819    0.243590    1.904157    0.147651    0.136919    0.214819    0.243590    0.074102    0.068862    0.244593    0.242038    2400        40.938166   1.984772    0.165052    25.533270  
[37m[36mINFO[0m[0m 01/27 22:49:12 | 0.161893    0.148747    0.210021    0.243590    1.903353    0.137889    0.132029    0.210021    0.243590    0.079341    0.056886    0.268448    0.257325    2600        44.349680   1.979878    0.164940    24.971619  
[37m[36mINFO[0m[0m 01/27 22:50:12 | 0.158813    0.144603    0.204158    0.241453    1.902831    0.136059    0.124694    0.204158    0.241453    0.080838    0.056886    0.259542    0.252229    2800        47.761194   1.976066    0.169289    25.817530  
[37m[36mINFO[0m[0m 01/27 22:51:12 | 0.153368    0.137292    0.198827    0.241453    1.902246    0.136059    0.122249    0.198827    0.241453    0.080090    0.062874    0.243957    0.226752    3000        51.172708   1.970520    0.169971    25.407330  
[37m[36mINFO[0m[0m 01/27 22:52:11 | 0.148171    0.136557    0.208422    0.243590    1.901525    0.133618    0.124694    0.208422    0.243590    0.079341    0.065868    0.231552    0.219108    3200        54.584222   1.966578    0.156799    27.490874  
[37m[36mINFO[0m[0m 01/27 22:53:08 | 0.146206    0.135317    0.207889    0.237179    1.900566    0.130567    0.122249    0.207889    0.237179    0.081587    0.065868    0.226463    0.217834    3400        57.995736   1.962422    0.166255    24.496818  
[37m[36mINFO[0m[0m 01/27 22:54:03 | 0.145118    0.134893    0.202026    0.245726    1.899872    0.128127    0.122249    0.202026    0.245726    0.084581    0.065868    0.222646    0.216561    3600        61.407249   1.961467    0.152249    24.479073  
[37m[36mINFO[0m[0m 01/27 22:55:02 | 0.144654    0.145344    0.204691    0.243590    1.898867    0.120805    0.117359    0.204691    0.243590    0.083832    0.086826    0.229326    0.231847    3800        64.818763   1.955560    0.168383    25.224765  
[37m[36mINFO[0m[0m 01/27 22:56:01 | 0.148021    0.148822    0.197228    0.232906    1.898007    0.119585    0.122249    0.197228    0.232906    0.080838    0.089820    0.243639    0.234395    4000        68.230277   1.953711    0.168859    24.436465  
[37m[36mINFO[0m[0m 01/27 22:57:01 | 0.145007    0.148822    0.204691    0.226496    1.896984    0.115314    0.122249    0.204691    0.226496    0.080838    0.089820    0.238868    0.234395    4200        71.641791   1.949662    0.162544    27.653197  
[37m[36mINFO[0m[0m 01/27 22:58:00 | 0.151216    0.151335    0.206823    0.230769    1.896136    0.118975    0.124694    0.206823    0.230769    0.083084    0.089820    0.251590    0.239490    4400        75.053305   1.946030    0.167888    25.606630  
[37m[36mINFO[0m[0m 01/27 22:58:57 | 0.153951    0.152885    0.199893    0.226496    1.895363    0.118365    0.124694    0.199893    0.226496    0.084581    0.086826    0.258906    0.247134    4600        78.464819   1.945282    0.160482    24.472734  
[37m[36mINFO[0m[0m 01/27 22:59:53 | 0.157374    0.159254    0.207356    0.228632    1.894650    0.118365    0.124694    0.207356    0.228632    0.083084    0.086826    0.270674    0.266242    4800        81.876333   1.944092    0.158114    25.011134  
[37m[36mINFO[0m[0m 01/27 23:00:53 | 0.155173    0.154307    0.197761    0.228632    1.893903    0.121415    0.124694    0.197761    0.228632    0.082335    0.089820    0.261768    0.248408    5000        85.287846   1.941720    0.169545    25.661994  
[37m[36mINFO[0m[0m 01/27 23:00:53 | Cumulative gradient change saved at train_output/PACS/RSC/[0, 2, 3]/250127_22-35-52_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/27 23:00:55 | ---
[37m[36mINFO[0m[0m 01/27 23:00:55 | test-domain validation(oracle) = 15.737%
[37m[36mINFO[0m[0m 01/27 23:00:55 | training-domain validation(iid) = 14.587%
[37m[36mINFO[0m[0m 01/27 23:00:55 | last = 15.517%
[37m[36mINFO[0m[0m 01/27 23:00:55 | last (inD) = 22.863%
[37m[36mINFO[0m[0m 01/27 23:00:55 | training-domain validation (iid, inD) = 25.855%
[37m[36mINFO[0m[0m 01/27 23:00:55 | === Summary ===
[37m[36mINFO[0m[0m 01/27 23:00:55 | Command: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm RSC --test_envs 0 2 3 --dataset PACS
[37m[36mINFO[0m[0m 01/27 23:00:55 | Unique name: 250127_22-35-52_resnet50_sgd
[37m[36mINFO[0m[0m 01/27 23:00:55 | Out path: train_output/PACS/RSC/[0, 2, 3]/250127_22-35-52_resnet50_sgd
[37m[36mINFO[0m[0m 01/27 23:00:55 | Algorithm: RSC
[37m[36mINFO[0m[0m 01/27 23:00:55 | Dataset: PACS

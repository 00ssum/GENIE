[37m[36mINFO[0m[0m 01/31 12:14:53 | Command :: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm RSC --test_envs 0 2 3 --dataset PACS --trial_seed 0 --hparams_seed 8
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 8
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/PACS/RSC/[0, 2, 3]/250131_12-14-53_resnet50_EVE
	out_root: train_output/PACS/RSC/[0, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 2, 3]
	trial_seed: 0
	unique_name: 250131_12-14-53_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: GENIE
	freeze_bn: False
	pretrained: True
	lr: 2.9932388835350315e-05
	batch_size: 16
	weight_decay: 0.0025315391809104006
	rsc_f_drop_factor: 0.05567832141307044
	rsc_b_drop_factor: 0.4714938842990282
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 01/31 12:14:53 | n_steps = 5001
[37m[36mINFO[0m[0m 01/31 12:14:53 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/31 12:14:53 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/31 12:14:53 | 
[37m[36mINFO[0m[0m 01/31 12:14:53 | Testenv name escaping te_A_P_S -> te_A_P_S
[37m[36mINFO[0m[0m 01/31 12:14:53 | Test envs = [0, 2, 3], name = te_A_P_S
[37m[36mINFO[0m[0m 01/31 12:14:53 | Train environments: [1], Test environments: [0, 2, 3]
[37m[36mINFO[0m[0m 01/31 12:14:53 | Batch sizes for each domain: [0, 16, 0, 0] (total=16)
[37m[36mINFO[0m[0m 01/31 12:14:53 | steps-per-epoch for each domain: 117.25 -> min = 117.25
[37m[36mINFO[0m[0m 01/31 12:14:55 | # of params = 23522375
[37m[36mINFO[0m[0m 01/31 12:15:23 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/31 12:15:23 | 0.108646    0.110732    0.185501    0.158120    1.953192    0.179988    0.166259    0.185501    0.158120    0.095060    0.104790    0.050891    0.061146    0           0.000000    2.366765    1.975941    25.637352  
[37m[36mINFO[0m[0m 01/31 12:16:28 | 0.363910    0.353296    0.518657    0.555556    1.040162    0.297743    0.305623    0.518657    0.555556    0.511228    0.488024    0.282761    0.266242    200         1.705757    1.704145    0.147145    35.399926  
[37m[36mINFO[0m[0m 01/31 12:17:47 | 0.565589    0.551511    0.809701    0.844017    0.501804    0.490543    0.474328    0.809701    0.844017    0.651198    0.610778    0.555025    0.569427    400         3.411514    1.005022    0.210055    36.781161  
[37m[36mINFO[0m[0m 01/31 12:18:41 | 0.609205    0.592192    0.909382    0.910256    0.244247    0.554606    0.550122    0.909382    0.910256    0.725299    0.664671    0.547710    0.561783    600         5.117271    0.606837    0.142990    25.148085  
[37m[36mINFO[0m[0m 01/31 12:19:33 | 0.647582    0.630511    0.915245    0.897436    0.316371    0.586943    0.586797    0.915245    0.897436    0.736527    0.685629    0.619275    0.619108    800         6.823028    0.388399    0.129826    25.170434  
[37m[36mINFO[0m[0m 01/31 12:20:31 | 0.675878    0.670434    0.906183    0.929487    0.221708    0.630262    0.638142    0.906183    0.929487    0.837575    0.811377    0.559796    0.561783    1000        8.528785    0.318914    0.128196    32.475824  
[37m[36mINFO[0m[0m 01/31 12:21:36 | 0.683552    0.685274    0.914179    0.908120    0.394785    0.668700    0.682152    0.914179    0.908120    0.845060    0.823353    0.536896    0.550318    1200        10.234542   0.213034    0.145717    35.186850  
[37m[36mINFO[0m[0m 01/31 12:22:34 | 0.672274    0.652067    0.958422    0.929487    0.267936    0.613789    0.594132    0.958422    0.929487    0.792665    0.745509    0.610369    0.616561    1400        11.940299   0.249316    0.142051    29.380863  
[37m[36mINFO[0m[0m 01/31 12:23:27 | 0.733644    0.720399    0.977612    0.944444    0.232610    0.674802    0.672372    0.977612    0.944444    0.818114    0.775449    0.708015    0.713376    1600        13.646055   0.111825    0.130194    26.852078  
[37m[36mINFO[0m[0m 01/31 12:24:18 | 0.709484    0.710354    0.976546    0.948718    0.207484    0.694936    0.709046    0.976546    0.948718    0.824102    0.814371    0.609415    0.607643    1800        15.351812   0.105324    0.116808    27.077588  
[37m[36mINFO[0m[0m 01/31 12:25:13 | 0.715659    0.711820    0.986141    0.963675    0.104523    0.680903    0.696822    0.986141    0.963675    0.837575    0.823353    0.628499    0.615287    2000        17.057569   0.102684    0.123543    30.654655  
[37m[36mINFO[0m[0m 01/31 12:26:23 | 0.725293    0.719430    0.993603    0.970085    0.112153    0.687614    0.687042    0.993603    0.970085    0.841317    0.811377    0.646947    0.659873    2200        18.763326   0.059702    0.173940    35.502984  
[37m[36mINFO[0m[0m 01/31 12:27:22 | 0.744668    0.736076    0.986674    0.967949    0.154579    0.743136    0.762836    0.986674    0.967949    0.873503    0.817365    0.617366    0.628025    2400        20.469083   0.097118    0.155870    27.105153  
[37m[36mINFO[0m[0m 01/31 12:28:17 | 0.696120    0.679031    0.969616    0.929487    0.331286    0.628432    0.625917    0.969616    0.929487    0.775449    0.724551    0.684478    0.686624    2600        22.174840   0.053279    0.136166    27.317985  
[37m[36mINFO[0m[0m 01/31 12:29:10 | 0.722080    0.707245    0.988806    0.961538    0.192375    0.688835    0.713936    0.988806    0.961538    0.785928    0.727545    0.691476    0.680255    2800        23.880597   0.050554    0.139052    25.540477  
[37m[36mINFO[0m[0m 01/31 12:30:00 | 0.619822    0.608299    0.945629    0.933761    0.234119    0.538743    0.559902    0.945629    0.933761    0.750749    0.709581    0.569975    0.555414    3000        25.586354   0.090183    0.124927    25.276767  
[37m[36mINFO[0m[0m 01/31 12:30:51 | 0.730239    0.723357    0.995203    0.963675    0.146583    0.684564    0.699267    0.995203    0.963675    0.850299    0.808383    0.655852    0.662420    3200        27.292111   0.080060    0.126846    25.283337  
[37m[36mINFO[0m[0m 01/31 12:31:45 | 0.752413    0.738477    0.995736    0.974359    0.152069    0.721171    0.738386    0.995736    0.974359    0.839820    0.790419    0.696247    0.686624    3400        28.997868   0.048684    0.137999    26.681571  
[37m[36mINFO[0m[0m 01/31 12:32:35 | 0.745623    0.743404    0.996802    0.944444    0.221466    0.653447    0.662592    0.996802    0.944444    0.835329    0.808383    0.748092    0.759236    3600        30.703625   0.055111    0.123574    25.165395  
[37m[36mINFO[0m[0m 01/31 12:33:27 | 0.748234    0.739360    0.989339    0.963675    0.158156    0.718121    0.735941    0.989339    0.963675    0.833832    0.790419    0.692748    0.691720    3800        32.409382   0.033819    0.127699    25.534692  
[37m[36mINFO[0m[0m 01/31 12:34:22 | 0.747709    0.746118    0.998934    0.974359    0.108231    0.690055    0.718826    0.998934    0.974359    0.832335    0.793413    0.720738    0.726115    4000        34.115139   0.034999    0.142846    26.391253  
[37m[36mINFO[0m[0m 01/31 12:35:15 | 0.728650    0.722251    0.996269    0.970085    0.114557    0.691885    0.731051    0.996269    0.970085    0.837575    0.769461    0.656489    0.666242    4200        35.820896   0.038189    0.129231    27.182913  
[37m[36mINFO[0m[0m 01/31 12:36:06 | 0.671022    0.657314    0.946695    0.923077    0.380110    0.608298    0.601467    0.946695    0.923077    0.759731    0.733533    0.645038    0.636943    4400        37.526652   0.024054    0.130888    25.587711  
[37m[36mINFO[0m[0m 01/31 12:37:03 | 0.735514    0.723188    0.994670    0.957265    0.137000    0.665650    0.674817    0.994670    0.957265    0.821108    0.772455    0.719784    0.722293    4600        39.232409   0.046773    0.147159    26.638555  
[37m[36mINFO[0m[0m 01/31 12:37:54 | 0.754073    0.755288    0.998401    0.963675    0.134986    0.694326    0.743276    0.998401    0.963675    0.842066    0.805389    0.725827    0.717197    4800        40.938166   0.028619    0.129467    25.919682  
[37m[36mINFO[0m[0m 01/31 12:38:46 | 0.722899    0.715753    0.994136    0.965812    0.140585    0.679073    0.711491    0.994136    0.965812    0.801647    0.778443    0.687977    0.657325    5000        42.643923   0.025039    0.132997    24.923555  
[37m[36mINFO[0m[0m 01/31 12:38:46 | Cumulative gradient change saved at train_output/PACS/RSC/[0, 2, 3]/250131_12-14-53_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/31 12:38:47 | ---
[37m[36mINFO[0m[0m 01/31 12:38:47 | test-domain validation(oracle) = 75.407%
[37m[36mINFO[0m[0m 01/31 12:38:47 | training-domain validation(iid) = 75.241%
[37m[36mINFO[0m[0m 01/31 12:38:47 | last = 72.290%
[37m[36mINFO[0m[0m 01/31 12:38:47 | last (inD) = 96.581%
[37m[36mINFO[0m[0m 01/31 12:38:47 | training-domain validation (iid, inD) = 97.436%
[37m[36mINFO[0m[0m 01/31 12:38:47 | === Summary ===
[37m[36mINFO[0m[0m 01/31 12:38:47 | Command: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm RSC --test_envs 0 2 3 --dataset PACS --trial_seed 0 --hparams_seed 8
[37m[36mINFO[0m[0m 01/31 12:38:47 | Unique name: 250131_12-14-53_resnet50_EVE
[37m[36mINFO[0m[0m 01/31 12:38:47 | Out path: train_output/PACS/RSC/[0, 2, 3]/250131_12-14-53_resnet50_EVE
[37m[36mINFO[0m[0m 01/31 12:38:47 | Algorithm: RSC
[37m[36mINFO[0m[0m 01/31 12:38:47 | Dataset: PACS

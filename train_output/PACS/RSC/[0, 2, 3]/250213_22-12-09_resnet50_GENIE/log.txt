[37m[36mINFO[0m[0m 02/13 22:12:09 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 2 3 --dataset PACS --trial_seed 0 --hparams_seed 20
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 20
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/PACS/RSC/[0, 2, 3]/250213_22-12-09_resnet50_GENIE
	out_root: train_output/PACS/RSC/[0, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 2, 3]
	trial_seed: 0
	unique_name: 250213_22-12-09_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.6157673767852512e-05
	batch_size: 32
	weight_decay: 1.110622050999988e-05
	rsc_f_drop_factor: 0.011558843074644498
	rsc_b_drop_factor: 0.009443205254898168
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 02/13 22:12:09 | n_steps = 5001
[37m[36mINFO[0m[0m 02/13 22:12:09 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/13 22:12:09 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/13 22:12:09 | 
[37m[36mINFO[0m[0m 02/13 22:12:09 | Testenv name escaping te_A_P_S -> te_A_P_S
[37m[36mINFO[0m[0m 02/13 22:12:09 | Test envs = [0, 2, 3], name = te_A_P_S
[37m[36mINFO[0m[0m 02/13 22:12:09 | Train environments: [1], Test environments: [0, 2, 3]
[37m[36mINFO[0m[0m 02/13 22:12:09 | Batch sizes for each domain: [0, 32, 0, 0] (total=32)
[37m[36mINFO[0m[0m 02/13 22:12:09 | steps-per-epoch for each domain: 58.62 -> min = 58.62
[37m[36mINFO[0m[0m 02/13 22:12:11 | # of params = 23522375
[37m[36mINFO[0m[0m 02/13 22:12:43 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/13 22:12:43 | 0.157842    0.144747    0.221748    0.224359    1.881124    0.148261    0.141809    0.221748    0.224359    0.098802    0.098802    0.226463    0.193631    0           0.000000    2.166714    2.330151    29.595594  
[37m[36mINFO[0m[0m 02/13 22:14:11 | 0.755275    0.732226    0.961620    0.955128    0.156843    0.751068    0.716381    0.961620    0.955128    0.852545    0.829341    0.662214    0.650955    200         3.411514    0.514844    0.268401    34.179464  
[37m[36mINFO[0m[0m 02/13 22:15:13 | 0.745488    0.735240    0.970682    0.965812    0.117602    0.706528    0.696822    0.970682    0.965812    0.879491    0.850299    0.650445    0.658599    400         6.823028    0.156670    0.183649    26.087522  
[37m[36mINFO[0m[0m 02/13 22:16:27 | 0.740402    0.731303    0.987740    0.970085    0.116204    0.718121    0.706601    0.987740    0.970085    0.863772    0.859281    0.639313    0.628025    600         10.234542   0.085592    0.211466    30.907675  
[37m[36mINFO[0m[0m 02/13 22:17:58 | 0.775713    0.770658    0.980277    0.957265    0.130801    0.727883    0.735941    0.980277    0.957265    0.877246    0.856287    0.722010    0.719745    800         13.646055   0.074113    0.264354    38.555692  
[37m[36mINFO[0m[0m 02/13 22:19:02 | 0.749341    0.740008    0.988273    0.965812    0.153724    0.717511    0.726161    0.988273    0.965812    0.860030    0.826347    0.670483    0.667516    1000        17.057569   0.038117    0.196780    24.550987  
[37m[36mINFO[0m[0m 02/13 22:20:15 | 0.742415    0.754175    0.973881    0.946581    0.156996    0.688835    0.733496    0.973881    0.946581    0.878743    0.874251    0.659669    0.654777    1200        20.469083   0.045578    0.212302    30.577701  
[37m[36mINFO[0m[0m 02/13 22:21:33 | 0.784137    0.791740    0.985608    0.965812    0.184885    0.773642    0.792176    0.985608    0.965812    0.886976    0.886228    0.691794    0.696815    1400        23.880597   0.029954    0.257959    26.115178  
[37m[36mINFO[0m[0m 02/13 22:22:44 | 0.763017    0.771199    0.994670    0.963675    0.144994    0.741306    0.757946    0.994670    0.963675    0.866766    0.856287    0.680980    0.699363    1600        27.292111   0.033297    0.187262    33.824910  
[37m[36mINFO[0m[0m 02/13 22:24:13 | 0.795760    0.800444    0.997868    0.965812    0.146101    0.779134    0.772616    0.997868    0.965812    0.900449    0.919162    0.707697    0.709554    1800        30.703625   0.014595    0.244892    40.084186  
[37m[36mINFO[0m[0m 02/13 22:25:37 | 0.740217    0.747281    0.990405    0.967949    0.186158    0.730323    0.748166    0.990405    0.967949    0.872006    0.859281    0.618321    0.634395    2000        34.115139   0.012670    0.270473    29.918566  
[37m[36mINFO[0m[0m 02/13 22:26:51 | 0.791930    0.788535    0.998934    0.974359    0.105797    0.754118    0.748166    0.998934    0.974359    0.895210    0.886228    0.726463    0.731210    2200        37.526652   0.032283    0.191887    35.588108  
[37m[36mINFO[0m[0m 02/13 22:28:39 | 0.778337    0.777052    0.997335    0.965812    0.150790    0.773642    0.787286    0.997335    0.965812    0.885479    0.871257    0.675891    0.672611    2400        40.938166   0.013602    0.316546    45.066861  
[37m[36mINFO[0m[0m 02/13 22:29:52 | 0.789732    0.785981    0.997868    0.976496    0.121282    0.741916    0.753056    0.997868    0.976496    0.869012    0.853293    0.758270    0.751592    2600        44.349680   0.015877    0.219545    28.563181  
[37m[36mINFO[0m[0m 02/13 22:30:56 | 0.797236    0.807225    0.997868    0.974359    0.166982    0.780964    0.794621    0.997868    0.974359    0.881737    0.865269    0.729008    0.761783    2800        47.761194   0.006446    0.166961    30.449870  
[37m[36mINFO[0m[0m 02/13 22:32:38 | 0.824239    0.821838    1.000000    0.965812    0.177354    0.804759    0.809291    1.000000    0.965812    0.877246    0.847305    0.790712    0.808917    3000        51.172708   0.002844    0.231482    55.643854  
[37m[36mINFO[0m[0m 02/13 22:33:53 | 0.803605    0.809682    1.000000    0.980769    0.122152    0.788286    0.799511    1.000000    0.980769    0.871257    0.856287    0.751272    0.773248    3200        54.584222   0.005853    0.228216    29.866179  
[37m[36mINFO[0m[0m 02/13 22:35:00 | 0.797123    0.794520    0.998401    0.967949    0.166153    0.777913    0.792176    0.998401    0.967949    0.876497    0.865269    0.736959    0.726115    3400        57.995736   0.008461    0.186564    29.435649  
[37m[36mINFO[0m[0m 02/13 22:36:11 | 0.780514    0.785580    0.999467    0.974359    0.115862    0.732764    0.760391    0.999467    0.974359    0.862275    0.847305    0.746501    0.749045    3600        61.407249   0.011282    0.197092    31.870748  
[37m[36mINFO[0m[0m 02/13 22:37:28 | 0.765428    0.766048    0.998401    0.959402    0.182987    0.744966    0.748166    0.998401    0.959402    0.850299    0.835329    0.701018    0.714650    3800        64.818763   0.010497    0.216333    33.972494  
[37m[36mINFO[0m[0m 02/13 22:38:47 | 0.780367    0.791925    0.997335    0.965812    0.185965    0.744356    0.765281    0.997335    0.965812    0.856287    0.865269    0.740458    0.745223    4000        68.230277   0.005407    0.251454    28.416421  
[37m[36mINFO[0m[0m 02/13 22:40:17 | 0.814444    0.813200    1.000000    0.976496    0.104633    0.794997    0.797066    1.000000    0.976496    0.901198    0.892216    0.747137    0.750318    4200        71.641791   0.002104    0.261677    37.368595  
[37m[36mINFO[0m[0m 02/13 22:41:25 | 0.803007    0.803518    0.986674    0.944444    0.243349    0.777303    0.784841    0.986674    0.944444    0.879491    0.856287    0.752226    0.769427    4400        75.053305   0.009400    0.198081    28.313340  
[37m[36mINFO[0m[0m 02/13 22:42:55 | 0.807331    0.817070    0.999467    0.967949    0.204132    0.753508    0.779951    0.999467    0.967949    0.889222    0.871257    0.779262    0.800000    4600        78.464819   0.014149    0.322009    26.187994  
[37m[36mINFO[0m[0m 02/13 22:44:27 | 0.824489    0.828028    0.999467    0.965812    0.181543    0.784625    0.799511    0.999467    0.965812    0.901946    0.892216    0.786896    0.792357    4800        81.876333   0.001714    0.308152    29.621984  
[37m[36mINFO[0m[0m 02/13 22:45:38 | 0.798441    0.800510    0.999467    0.970085    0.151080    0.746187    0.767726    0.999467    0.970085    0.883234    0.859281    0.765903    0.774522    5000        85.287846   0.001450    0.202016    30.736064  
[37m[36mINFO[0m[0m 02/13 22:45:38 | Cumulative gradient change saved at train_output/PACS/RSC/[0, 2, 3]/250213_22-12-09_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/13 22:45:40 | ---
[37m[36mINFO[0m[0m 02/13 22:45:40 | test-domain validation(oracle) = 82.449%
[37m[36mINFO[0m[0m 02/13 22:45:40 | training-domain validation(iid) = 80.361%
[37m[36mINFO[0m[0m 02/13 22:45:40 | last = 79.844%
[37m[36mINFO[0m[0m 02/13 22:45:40 | last (inD) = 97.009%
[37m[36mINFO[0m[0m 02/13 22:45:40 | training-domain validation (iid, inD) = 98.077%
[37m[36mINFO[0m[0m 02/13 22:45:40 | === Summary ===
[37m[36mINFO[0m[0m 02/13 22:45:40 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 2 3 --dataset PACS --trial_seed 0 --hparams_seed 20
[37m[36mINFO[0m[0m 02/13 22:45:40 | Unique name: 250213_22-12-09_resnet50_GENIE
[37m[36mINFO[0m[0m 02/13 22:45:40 | Out path: train_output/PACS/RSC/[0, 2, 3]/250213_22-12-09_resnet50_GENIE
[37m[36mINFO[0m[0m 02/13 22:45:40 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/13 22:45:40 | Dataset: PACS

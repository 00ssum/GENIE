[37m[36mINFO[0m[0m 02/06 18:33:59 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset PACS --trial_seed 2 --hparams_seed 4
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 4
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/PACS/RSC/[3]/250206_18-33-59_resnet50_GENIE
	out_root: train_output/PACS/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250206_18-33-59_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 6.164076981615215e-05
	batch_size: 11
	weight_decay: 3.184710792983041e-06
	rsc_f_drop_factor: 0.4783019889594706
	rsc_b_drop_factor: 0.3428937454434034
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 02/06 18:33:59 | n_steps = 5001
[37m[36mINFO[0m[0m 02/06 18:33:59 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/06 18:33:59 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/06 18:33:59 | 
[37m[36mINFO[0m[0m 02/06 18:33:59 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 02/06 18:33:59 | Test envs = [3], name = te_S
[37m[36mINFO[0m[0m 02/06 18:33:59 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/06 18:33:59 | Batch sizes for each domain: [11, 11, 11, 0] (total=33)
[37m[36mINFO[0m[0m 02/06 18:33:59 | steps-per-epoch for each domain: 149.00, 170.55, 121.45 -> min = 121.45
[37m[36mINFO[0m[0m 02/06 18:34:01 | # of params = 23522375
[37m[36mINFO[0m[0m 02/06 18:34:39 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/06 18:34:39 | 0.195611    0.196178    0.159792    0.156368    1.936478    0.179988    0.171149    0.183369    0.190171    0.116018    0.107784    0.195611    0.196178    0           0.000000    3.568795    1.735633    36.281216  
[37m[36mINFO[0m[0m 02/06 18:35:56 | 0.041031    0.039490    0.219258    0.207459    1.928068    0.223307    0.202934    0.173241    0.170940    0.261228    0.248503    0.041031    0.039490    200         1.646707    1.944096    0.205955    35.263449  
[37m[36mINFO[0m[0m 02/06 18:37:16 | 0.041031    0.039490    0.219258    0.207459    1.910969    0.223307    0.202934    0.173241    0.170940    0.261228    0.248503    0.041031    0.039490    400         3.293413    1.918153    0.211252    38.113589  
[37m[36mINFO[0m[0m 02/06 18:38:39 | 0.041031    0.039490    0.219258    0.207459    1.832569    0.223307    0.202934    0.173241    0.170940    0.261228    0.248503    0.041031    0.039490    600         4.940120    1.907928    0.224915    37.785161  
[37m[36mINFO[0m[0m 02/06 18:39:54 | 0.044211    0.044586    0.336580    0.324257    1.691102    0.325198    0.320293    0.256397    0.254274    0.428144    0.398204    0.044211    0.044586    800         6.586826    1.852159    0.197033    35.851905  
[37m[36mINFO[0m[0m 02/06 18:41:11 | 0.152036    0.173248    0.433548    0.412907    1.497611    0.417938    0.388753    0.390192    0.388889    0.492515    0.461078    0.152036    0.173248    1000        8.233533    1.789580    0.194980    37.544836  
[37m[36mINFO[0m[0m 02/06 18:42:36 | 0.390585    0.417834    0.679029    0.669930    0.936749    0.640024    0.601467    0.630597    0.668803    0.766467    0.739521    0.390585    0.417834    1200        9.880240    1.647957    0.223876    40.512868  
[37m[36mINFO[0m[0m 02/06 18:43:55 | 0.660305    0.662420    0.856807    0.860905    0.432484    0.854179    0.853301    0.811301    0.816239    0.904940    0.913174    0.660305    0.662420    1400        11.526946   1.264310    0.210430    37.119662  
[37m[36mINFO[0m[0m 02/06 18:45:16 | 0.694656    0.712102    0.912330    0.914319    0.271059    0.907871    0.907090    0.859808    0.871795    0.969311    0.964072    0.694656    0.712102    1600        13.173653   1.038837    0.213034    38.615445  
[37m[36mINFO[0m[0m 02/06 18:46:42 | 0.550573    0.564331    0.941075    0.934472    0.209738    0.930445    0.911980    0.918977    0.912393    0.973802    0.979042    0.550573    0.564331    1800        14.820359   0.947908    0.221259    40.957504  
[37m[36mINFO[0m[0m 02/06 18:48:00 | 0.619911    0.649682    0.933344    0.913656    0.258631    0.909091    0.894866    0.925373    0.905983    0.965569    0.940120    0.619911    0.649682    2000        16.467066   0.930227    0.196778    39.099112  
[37m[36mINFO[0m[0m 02/06 18:49:17 | 0.748092    0.777070    0.963489    0.938806    0.229775    0.951800    0.916870    0.949893    0.929487    0.988772    0.970060    0.748092    0.777070    2200        18.113772   0.827884    0.193238    38.487564  
[37m[36mINFO[0m[0m 02/06 18:50:38 | 0.706425    0.718471    0.966572    0.942858    0.183591    0.959121    0.921760    0.948827    0.933761    0.991766    0.973054    0.706425    0.718471    2400        19.760479   0.772016    0.221214    36.512015  
[37m[36mINFO[0m[0m 02/06 18:52:01 | 0.679389    0.700637    0.953232    0.928827    0.275913    0.937157    0.899756    0.943497    0.916667    0.979042    0.970060    0.679389    0.700637    2600        21.407186   0.765176    0.235112    36.306384  
[37m[36mINFO[0m[0m 02/06 18:53:21 | 0.691158    0.690446    0.966756    0.934487    0.196732    0.953630    0.902200    0.965352    0.925214    0.981287    0.976048    0.691158    0.690446    2800        23.053892   0.782209    0.211488    36.853131  
[37m[36mINFO[0m[0m 02/06 18:54:29 | 0.771628    0.770701    0.986217    0.962717    0.139560    0.981696    0.953545    0.982942    0.946581    0.994012    0.988024    0.771628    0.770701    3000        24.700599   0.749130    0.165686    34.993110  
[37m[36mINFO[0m[0m 02/06 18:55:45 | 0.708651    0.709554    0.981878    0.955530    0.134974    0.968883    0.948655    0.979744    0.935897    0.997006    0.982036    0.708651    0.709554    3200        26.347305   0.722174    0.207479    34.867630  
[37m[36mINFO[0m[0m 02/06 18:56:59 | 0.752545    0.750318    0.986679    0.955321    0.191078    0.984137    0.926650    0.978145    0.942308    0.997754    0.997006    0.752545    0.750318    3400        27.994012   0.714705    0.189332    35.673154  
[37m[36mINFO[0m[0m 02/06 18:58:17 | 0.759542    0.761783    0.994565    0.968377    0.123713    0.993289    0.955990    0.990405    0.955128    1.000000    0.994012    0.759542    0.761783    3600        29.640719   0.709879    0.210791    35.981091  
[37m[36mINFO[0m[0m 02/06 18:59:41 | 0.718511    0.723567    0.988546    0.952651    0.183777    0.987187    0.924205    0.982942    0.948718    0.995509    0.985030    0.718511    0.723567    3800        31.287425   0.705061    0.241993    35.434669  
[37m[36mINFO[0m[0m 02/06 19:00:59 | 0.653626    0.690446    0.986556    0.953893    0.157441    0.982916    0.926650    0.979744    0.952991    0.997006    0.982036    0.653626    0.690446    4000        32.934132   0.690055    0.218652    34.253230  
[37m[36mINFO[0m[0m 02/06 19:02:17 | 0.740140    0.743949    0.994272    0.963239    0.154369    0.991458    0.938875    0.993603    0.965812    0.997754    0.985030    0.740140    0.743949    4200        34.580838   0.686985    0.206118    36.833161  
[37m[36mINFO[0m[0m 02/06 19:03:37 | 0.632634    0.643312    0.970994    0.935421    0.251098    0.953630    0.897311    0.969083    0.935897    0.990269    0.973054    0.632634    0.643312    4400        36.227545   0.687966    0.221299    36.552832  
[37m[36mINFO[0m[0m 02/06 19:04:52 | 0.699746    0.699363    0.993286    0.962569    0.135530    0.990848    0.936430    0.992004    0.957265    0.997006    0.994012    0.699746    0.699363    4600        37.874251   0.694731    0.196058    35.546206  
[37m[36mINFO[0m[0m 02/06 19:06:11 | 0.744593    0.750318    0.986518    0.953938    0.148368    0.982916    0.941320    0.981876    0.944444    0.994760    0.976048    0.744593    0.750318    4800        39.520958   0.712356    0.210151    37.246213  
[37m[36mINFO[0m[0m 02/06 19:07:34 | 0.712150    0.717197    0.989236    0.957458    0.175863    0.979866    0.926650    0.989339    0.948718    0.998503    0.997006    0.712150    0.717197    5000        41.167665   0.704376    0.225456    37.452003  
[37m[36mINFO[0m[0m 02/06 19:07:34 | Cumulative gradient change saved at train_output/PACS/RSC/[3]/250206_18-33-59_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/06 19:07:36 | ---
[37m[36mINFO[0m[0m 02/06 19:07:36 | test-domain validation(oracle) = 74.809%
[37m[36mINFO[0m[0m 02/06 19:07:36 | training-domain validation(iid) = 75.954%
[37m[36mINFO[0m[0m 02/06 19:07:36 | last = 71.215%
[37m[36mINFO[0m[0m 02/06 19:07:36 | last (inD) = 95.746%
[37m[36mINFO[0m[0m 02/06 19:07:36 | training-domain validation (iid, inD) = 96.838%
[37m[36mINFO[0m[0m 02/06 19:07:36 | === Summary ===
[37m[36mINFO[0m[0m 02/06 19:07:36 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset PACS --trial_seed 2 --hparams_seed 4
[37m[36mINFO[0m[0m 02/06 19:07:36 | Unique name: 250206_18-33-59_resnet50_GENIE
[37m[36mINFO[0m[0m 02/06 19:07:36 | Out path: train_output/PACS/RSC/[3]/250206_18-33-59_resnet50_GENIE
[37m[36mINFO[0m[0m 02/06 19:07:36 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/06 19:07:36 | Dataset: PACS

[37m[36mINFO[0m[0m 02/10 15:20:59 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset PACS --trial_seed 1 --hparams_seed 0
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/PACS/RSC/[3]/250210_15-20-59_resnet50_GENIE
	out_root: train_output/PACS/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250210_15-20-59_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	rsc_f_drop_factor: 0.3333333333333333
	rsc_b_drop_factor: 0.3333333333333333
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 02/10 15:20:59 | n_steps = 5001
[37m[36mINFO[0m[0m 02/10 15:20:59 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/10 15:20:59 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/10 15:20:59 | 
[37m[36mINFO[0m[0m 02/10 15:20:59 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 02/10 15:20:59 | Test envs = [3], name = te_S
[37m[36mINFO[0m[0m 02/10 15:20:59 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/10 15:20:59 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 02/10 15:20:59 | steps-per-epoch for each domain: 51.22, 58.62, 41.75 -> min = 41.75
[37m[36mINFO[0m[0m 02/10 15:21:00 | # of params = 23522375
[37m[36mINFO[0m[0m 02/10 15:21:39 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/10 15:21:39 | 0.042939    0.033121    0.178088    0.168347    1.920555    0.173887    0.188264    0.169510    0.188034    0.190868    0.128743    0.042939    0.033121    0           0.000000    3.365661    1.303220    37.312390  
[37m[36mINFO[0m[0m 02/10 15:23:15 | 0.042621    0.033121    0.216454    0.218690    1.863666    0.214155    0.239609    0.176972    0.155983    0.258234    0.260479    0.042621    0.033121    200         4.790419    1.936886    0.298348    35.773712  
[37m[36mINFO[0m[0m 02/10 15:24:40 | 0.114186    0.104459    0.412092    0.424441    1.400192    0.380720    0.398533    0.386994    0.371795    0.468563    0.502994    0.114186    0.104459    400         9.580838    1.782028    0.253609    34.718450  
[37m[36mINFO[0m[0m 02/10 15:26:12 | 0.288486    0.273885    0.464437    0.505745    1.204726    0.458816    0.462103    0.521322    0.549145    0.413174    0.505988    0.288486    0.273885    600         14.371257   1.634093    0.293984    33.165174  
[37m[36mINFO[0m[0m 02/10 15:27:37 | 0.360051    0.341401    0.734184    0.734756    0.689459    0.701037    0.699267    0.672175    0.651709    0.829341    0.853293    0.360051    0.341401    800         19.161677   1.447357    0.253906    34.566854  
[37m[36mINFO[0m[0m 02/10 15:29:11 | 0.490458    0.477707    0.858513    0.846854    0.414323    0.841367    0.841076    0.822495    0.801282    0.911677    0.898204    0.490458    0.477707    1000        23.952096   1.112544    0.291956    35.119592  
[37m[36mINFO[0m[0m 02/10 15:30:36 | 0.642494    0.635669    0.909304    0.887121    0.317784    0.903600    0.880196    0.858742    0.814103    0.965569    0.967066    0.642494    0.635669    1200        28.742515   0.972512    0.254179    34.309895  
[37m[36mINFO[0m[0m 02/10 15:32:09 | 0.660941    0.661146    0.952561    0.932438    0.210701    0.947529    0.914425    0.937100    0.903846    0.973054    0.979042    0.660941    0.661146    1400        33.532934   0.839927    0.287310    35.363823  
[37m[36mINFO[0m[0m 02/10 15:33:35 | 0.659669    0.671338    0.967069    0.933481    0.194008    0.963392    0.929095    0.948294    0.895299    0.989521    0.976048    0.659669    0.671338    1600        38.323353   0.784926    0.256720    35.202182  
[37m[36mINFO[0m[0m 02/10 15:35:08 | 0.689567    0.705732    0.971508    0.937785    0.210927    0.965833    0.909535    0.958422    0.933761    0.990269    0.970060    0.689567    0.705732    1800        43.113772   0.735928    0.289960    35.171059  
[37m[36mINFO[0m[0m 02/10 15:36:31 | 0.679707    0.682803    0.972496    0.929140    0.204645    0.970714    0.907090    0.955757    0.895299    0.991018    0.985030    0.679707    0.682803    2000        47.904192   0.695696    0.241315    34.140425  
[37m[36mINFO[0m[0m 02/10 15:38:08 | 0.710878    0.708280    0.987787    0.953180    0.139424    0.983527    0.926650    0.985075    0.950855    0.994760    0.982036    0.710878    0.708280    2200        52.694611   0.670888    0.299241    37.212214  
[37m[36mINFO[0m[0m 02/10 15:39:33 | 0.722010    0.729936    0.988418    0.949250    0.184059    0.984137    0.914425    0.985608    0.942308    0.995509    0.991018    0.722010    0.729936    2400        57.485030   0.649631    0.250295    35.022036  
[37m[36mINFO[0m[0m 02/10 15:41:12 | 0.722646    0.713376    0.993378    0.957195    0.151847    0.989628    0.933985    0.992004    0.946581    0.998503    0.991018    0.722646    0.713376    2600        62.275449   0.635477    0.306032    38.177688  
[37m[36mINFO[0m[0m 02/10 15:42:37 | 0.659987    0.661146    0.991461    0.953363    0.144759    0.987187    0.924205    0.990938    0.950855    0.996257    0.985030    0.659987    0.661146    2800        67.065868   0.619158    0.249406    34.325041  
[37m[36mINFO[0m[0m 02/10 15:44:11 | 0.745229    0.740127    0.988573    0.950392    0.233955    0.981086    0.931540    0.989872    0.946581    0.994760    0.973054    0.745229    0.740127    3000        71.856287   0.596147    0.288362    36.396402  
[37m[36mINFO[0m[0m 02/10 15:45:37 | 0.690840    0.686624    0.990585    0.945426    0.233869    0.986577    0.921760    0.986674    0.929487    0.998503    0.985030    0.690840    0.686624    3200        76.646707   0.585914    0.250417    36.588216  
[37m[36mINFO[0m[0m 02/10 15:47:15 | 0.686069    0.680255    0.978794    0.943994    0.170487    0.968273    0.904645    0.973348    0.942308    0.994760    0.985030    0.686069    0.680255    3400        81.437126   0.620852    0.305540    36.123058  
[37m[36mINFO[0m[0m 02/10 15:48:43 | 0.740776    0.738854    0.990822    0.949516    0.265528    0.987187    0.924205    0.988273    0.942308    0.997006    0.982036    0.740776    0.738854    3600        86.227545   0.581998    0.249924    38.545996  
[37m[36mINFO[0m[0m 02/10 15:50:16 | 0.634224    0.644586    0.991736    0.956704    0.219550    0.987797    0.929095    0.990405    0.952991    0.997006    0.988024    0.634224    0.644586    3800        91.017964   0.568390    0.293920    34.245389  
[37m[36mINFO[0m[0m 02/10 15:51:41 | 0.700064    0.691720    0.992761    0.958988    0.174660    0.990238    0.946210    0.992537    0.948718    0.995509    0.982036    0.700064    0.691720    4000        95.808383   0.591348    0.247028    35.406619  
[37m[36mINFO[0m[0m 02/10 15:53:08 | 0.723601    0.709554    0.989392    0.956174    0.257425    0.985357    0.926650    0.988806    0.950855    0.994012    0.991018    0.723601    0.709554    4200        100.598802  0.539931    0.251985    36.588952  
[37m[36mINFO[0m[0m 02/10 15:54:41 | 0.677163    0.681529    0.995325    0.961160    0.224214    0.990238    0.926650    0.995736    0.965812    1.000000    0.991018    0.677163    0.681529    4400        105.389222  0.559010    0.262061    40.329936  
[37m[36mINFO[0m[0m 02/10 15:56:14 | 0.574109    0.592357    0.890473    0.874081    0.432219    0.843807    0.814181    0.898721    0.873932    0.928892    0.934132    0.574109    0.592357    4600        110.179641  0.581111    0.282030    37.158202  
[37m[36mINFO[0m[0m 02/10 15:57:41 | 0.697201    0.713376    0.985663    0.952952    0.270292    0.974375    0.914425    0.985608    0.959402    0.997006    0.985030    0.697201    0.713376    4800        114.970060  0.531694    0.257027    35.377115  
[37m[36mINFO[0m[0m 02/10 15:59:17 | 0.716285    0.719745    0.988207    0.953444    0.186422    0.977425    0.919315    0.990938    0.952991    0.996257    0.988024    0.716285    0.719745    5000        119.760479  0.545675    0.289000    37.903877  
[37m[36mINFO[0m[0m 02/10 15:59:17 | Cumulative gradient change saved at train_output/PACS/RSC/[3]/250210_15-20-59_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/10 15:59:18 | ---
[37m[36mINFO[0m[0m 02/10 15:59:18 | test-domain validation(oracle) = 74.523%
[37m[36mINFO[0m[0m 02/10 15:59:18 | training-domain validation(iid) = 67.716%
[37m[36mINFO[0m[0m 02/10 15:59:18 | last = 71.628%
[37m[36mINFO[0m[0m 02/10 15:59:18 | last (inD) = 95.344%
[37m[36mINFO[0m[0m 02/10 15:59:18 | training-domain validation (iid, inD) = 96.116%
[37m[36mINFO[0m[0m 02/10 15:59:18 | === Summary ===
[37m[36mINFO[0m[0m 02/10 15:59:18 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset PACS --trial_seed 1 --hparams_seed 0
[37m[36mINFO[0m[0m 02/10 15:59:18 | Unique name: 250210_15-20-59_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 15:59:18 | Out path: train_output/PACS/RSC/[3]/250210_15-20-59_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 15:59:18 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/10 15:59:18 | Dataset: PACS

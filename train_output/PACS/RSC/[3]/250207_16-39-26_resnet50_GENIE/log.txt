[37m[36mINFO[0m[0m 02/07 16:39:26 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset PACS --trial_seed 2 --hparams_seed 9
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 9
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/PACS/RSC/[3]/250207_16-39-26_resnet50_GENIE
	out_root: train_output/PACS/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250207_16-39-26_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.716671579524612e-05
	batch_size: 29
	weight_decay: 1.71368232883332e-06
	rsc_f_drop_factor: 0.2746064186252521
	rsc_b_drop_factor: 0.34625008257443546
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 02/07 16:39:26 | n_steps = 5001
[37m[36mINFO[0m[0m 02/07 16:39:26 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/07 16:39:26 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/07 16:39:26 | 
[37m[36mINFO[0m[0m 02/07 16:39:26 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 02/07 16:39:26 | Test envs = [3], name = te_S
[37m[36mINFO[0m[0m 02/07 16:39:26 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/07 16:39:26 | Batch sizes for each domain: [29, 29, 29, 0] (total=87)
[37m[36mINFO[0m[0m 02/07 16:39:26 | steps-per-epoch for each domain: 56.52, 64.69, 46.07 -> min = 46.07
[37m[36mINFO[0m[0m 02/07 16:39:27 | # of params = 23522375
[37m[36mINFO[0m[0m 02/07 16:40:03 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/07 16:40:03 | 0.041031    0.039490    0.211912    0.185909    1.911067    0.178768    0.178484    0.193497    0.166667    0.263473    0.212575    0.041031    0.039490    0           0.000000    3.242849    1.031425    34.680687  
[37m[36mINFO[0m[0m 02/07 16:41:20 | 0.041031    0.039490    0.219258    0.207459    1.830053    0.223307    0.202934    0.173241    0.170940    0.261228    0.248503    0.041031    0.039490    200         4.341317    1.925974    0.213052    34.674239  
[37m[36mINFO[0m[0m 02/07 16:42:36 | 0.315204    0.351592    0.485136    0.503637    1.349225    0.439292    0.452323    0.510128    0.510684    0.505988    0.547904    0.315204    0.351592    400         8.682635    1.782050    0.214249    33.564299  
[37m[36mINFO[0m[0m 02/07 16:43:56 | 0.433524    0.442038    0.677912    0.691883    0.916467    0.615009    0.635697    0.680704    0.694444    0.738024    0.745509    0.433524    0.442038    600         13.023952   1.538215    0.226194    34.044974  
[37m[36mINFO[0m[0m 02/07 16:45:10 | 0.409987    0.412739    0.842737    0.842749    0.463646    0.814521    0.804401    0.806503    0.822650    0.907186    0.901198    0.409987    0.412739    800         17.365269   1.286401    0.211467    32.063740  
[37m[36mINFO[0m[0m 02/07 16:46:29 | 0.607188    0.617834    0.925428    0.911771    0.277991    0.917633    0.897311    0.888593    0.873932    0.970060    0.964072    0.607188    0.617834    1000        21.706587   0.912318    0.215711    35.864307  
[37m[36mINFO[0m[0m 02/07 16:47:48 | 0.713422    0.731210    0.963262    0.937667    0.246410    0.954851    0.916870    0.946162    0.923077    0.988772    0.973054    0.713422    0.731210    1200        26.047904   0.782298    0.221345    34.806352  
[37m[36mINFO[0m[0m 02/07 16:49:08 | 0.684160    0.680255    0.953457    0.944077    0.239907    0.932276    0.916870    0.944563    0.942308    0.983533    0.973054    0.684160    0.680255    1400        30.389222   0.710141    0.219196    35.608653  
[37m[36mINFO[0m[0m 02/07 16:50:25 | 0.589695    0.615287    0.955332    0.941041    0.253605    0.938987    0.919315    0.950959    0.948718    0.976048    0.955090    0.589695    0.615287    1600        34.730539   0.629805    0.226454    32.329888  
[37m[36mINFO[0m[0m 02/07 16:51:41 | 0.666667    0.656051    0.955996    0.938002    0.332311    0.948749    0.931540    0.938699    0.897436    0.980539    0.985030    0.666667    0.656051    1800        39.071856   0.608194    0.214777    32.957741  
[37m[36mINFO[0m[0m 02/07 16:52:59 | 0.751908    0.742675    0.971174    0.946808    0.365249    0.957901    0.924205    0.965352    0.940171    0.990269    0.976048    0.751908    0.742675    2000        43.413174   0.558359    0.224935    33.241675  
[37m[36mINFO[0m[0m 02/07 16:54:17 | 0.692748    0.703185    0.975610    0.950389    0.526572    0.962782    0.914425    0.972281    0.948718    0.991766    0.988024    0.692748    0.703185    2200        47.754491   0.535874    0.223315    32.616048  
[37m[36mINFO[0m[0m 02/07 16:55:37 | 0.706743    0.700637    0.959493    0.928278    0.432569    0.948139    0.907090    0.944563    0.916667    0.985778    0.961078    0.706743    0.700637    2400        52.095808   0.574737    0.225290    35.382468  
[37m[36mINFO[0m[0m 02/07 16:56:55 | 0.681616    0.677707    0.948615    0.927006    0.456494    0.929225    0.897311    0.956290    0.946581    0.960329    0.937126    0.681616    0.677707    2600        56.437126   0.499039    0.222034    34.018408  
[37m[36mINFO[0m[0m 02/07 16:58:10 | 0.749046    0.754140    0.977440    0.947513    0.339099    0.968273    0.907090    0.972281    0.959402    0.991766    0.976048    0.749046    0.754140    2800        60.778443   0.480369    0.210702    32.516642  
[37m[36mINFO[0m[0m 02/07 16:59:29 | 0.698473    0.695541    0.965034    0.938814    0.597280    0.949969    0.889976    0.969083    0.959402    0.976048    0.967066    0.698473    0.695541    3000        65.119760   0.454742    0.218481    35.019760  
[37m[36mINFO[0m[0m 02/07 17:00:47 | 0.762087    0.766879    0.983717    0.950488    0.264036    0.973764    0.916870    0.981876    0.961538    0.995509    0.973054    0.762087    0.766879    3200        69.461078   0.431781    0.219078    34.177431  
[37m[36mINFO[0m[0m 02/07 17:02:07 | 0.704835    0.724841    0.963497    0.929452    0.693939    0.942038    0.887531    0.966418    0.933761    0.982036    0.967066    0.704835    0.724841    3400        73.802395   0.370278    0.222562    35.592578  
[37m[36mINFO[0m[0m 02/07 17:03:23 | 0.747455    0.749045    0.951345    0.926333    0.503211    0.910311    0.877751    0.974414    0.940171    0.969311    0.961078    0.747455    0.749045    3600        78.143713   0.371304    0.219283    32.540608  
[37m[36mINFO[0m[0m 02/07 17:04:41 | 0.636132    0.626752    0.925059    0.896977    0.372402    0.910921    0.877751    0.909915    0.891026    0.954341    0.922156    0.636132    0.626752    3800        82.485030   0.314559    0.220735    33.260666  
[37m[36mINFO[0m[0m 02/07 17:06:02 | 0.660941    0.659873    0.950582    0.924367    0.315715    0.940207    0.902200    0.939232    0.918803    0.972305    0.952096    0.660941    0.659873    4000        86.826347   0.337351    0.229836    35.116224  
[37m[36mINFO[0m[0m 02/07 17:07:36 | 0.716921    0.724841    0.967878    0.932898    0.520295    0.954851    0.911980    0.963753    0.931624    0.985030    0.955090    0.716921    0.724841    4200        91.167665   0.278358    0.267682    40.688792  
[37m[36mINFO[0m[0m 02/07 17:08:57 | 0.776399    0.770701    0.986799    0.951973    0.594275    0.978646    0.921760    0.987740    0.970085    0.994012    0.964072    0.776399    0.770701    4400        95.508982   0.253640    0.241567    33.047869  
[37m[36mINFO[0m[0m 02/07 17:10:16 | 0.743003    0.770701    0.970666    0.935131    0.650091    0.953020    0.897311    0.986674    0.952991    0.972305    0.955090    0.743003    0.770701    4600        99.850299   0.315883    0.229222    32.436520  
[37m[36mINFO[0m[0m 02/07 17:12:01 | 0.746501    0.747771    0.967044    0.930046    0.417374    0.953630    0.894866    0.963220    0.925214    0.984281    0.970060    0.746501    0.747771    4800        104.191617  0.361018    0.357247    34.152337  
[37m[36mINFO[0m[0m 02/07 17:13:22 | 0.834606    0.833121    0.991193    0.958367    0.376424    0.984137    0.931540    0.990938    0.976496    0.998503    0.967066    0.834606    0.833121    5000        108.532934  0.208932    0.235294    33.946581  
[37m[36mINFO[0m[0m 02/07 17:13:22 | Cumulative gradient change saved at train_output/PACS/RSC/[3]/250207_16-39-26_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/07 17:13:24 | ---
[37m[36mINFO[0m[0m 02/07 17:13:24 | test-domain validation(oracle) = 83.461%
[37m[36mINFO[0m[0m 02/07 17:13:24 | training-domain validation(iid) = 83.461%
[37m[36mINFO[0m[0m 02/07 17:13:24 | last = 83.461%
[37m[36mINFO[0m[0m 02/07 17:13:24 | last (inD) = 95.837%
[37m[36mINFO[0m[0m 02/07 17:13:24 | training-domain validation (iid, inD) = 95.837%
[37m[36mINFO[0m[0m 02/07 17:13:24 | === Summary ===
[37m[36mINFO[0m[0m 02/07 17:13:24 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset PACS --trial_seed 2 --hparams_seed 9
[37m[36mINFO[0m[0m 02/07 17:13:24 | Unique name: 250207_16-39-26_resnet50_GENIE
[37m[36mINFO[0m[0m 02/07 17:13:24 | Out path: train_output/PACS/RSC/[3]/250207_16-39-26_resnet50_GENIE
[37m[36mINFO[0m[0m 02/07 17:13:24 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/07 17:13:24 | Dataset: PACS

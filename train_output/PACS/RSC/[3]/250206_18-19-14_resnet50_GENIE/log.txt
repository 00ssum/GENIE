[37m[36mINFO[0m[0m 02/06 18:19:14 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset PACS --trial_seed 0 --hparams_seed 15
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 15
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/PACS/RSC/[3]/250206_18-19-14_resnet50_GENIE
	out_root: train_output/PACS/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250206_18-19-14_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.00010661763546249327
	batch_size: 14
	weight_decay: 9.086452814323981e-06
	rsc_f_drop_factor: 0.11638278020136433
	rsc_b_drop_factor: 0.05275887961703141
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 02/06 18:19:14 | n_steps = 5001
[37m[36mINFO[0m[0m 02/06 18:19:14 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/06 18:19:14 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/06 18:19:14 | 
[37m[36mINFO[0m[0m 02/06 18:19:14 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 02/06 18:19:14 | Test envs = [3], name = te_S
[37m[36mINFO[0m[0m 02/06 18:19:14 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/06 18:19:14 | Batch sizes for each domain: [14, 14, 14, 0] (total=42)
[37m[36mINFO[0m[0m 02/06 18:19:14 | steps-per-epoch for each domain: 117.07, 134.00, 95.43 -> min = 95.43
[37m[36mINFO[0m[0m 02/06 18:19:16 | # of params = 23522375
[37m[36mINFO[0m[0m 02/06 18:19:56 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/06 18:19:56 | 0.196565    0.197452    0.170224    0.158254    1.929697    0.193411    0.178484    0.178038    0.149573    0.139222    0.146707    0.196565    0.197452    0           0.000000    2.244091    1.352537    39.054076  
[37m[36mINFO[0m[0m 02/06 18:21:15 | 0.750000    0.745223    0.931594    0.937281    0.180721    0.914582    0.931540    0.905650    0.925214    0.974551    0.955090    0.750000    0.745223    200         2.095808    0.595973    0.189431    41.082518  
[37m[36mINFO[0m[0m 02/06 18:22:40 | 0.718830    0.713376    0.947194    0.931018    0.205372    0.925564    0.887531    0.942964    0.944444    0.973054    0.961078    0.718830    0.713376    400         4.191617    0.252920    0.221717    40.685962  
[37m[36mINFO[0m[0m 02/06 18:23:59 | 0.728690    0.741401    0.975684    0.956036    0.116512    0.967053    0.943765    0.967484    0.942308    0.992515    0.982036    0.728690    0.741401    600         6.287425    0.174822    0.209667    36.747928  
[37m[36mINFO[0m[0m 02/06 18:25:17 | 0.740776    0.741401    0.968717    0.955442    0.127021    0.957901    0.936430    0.963220    0.950855    0.985030    0.979042    0.740776    0.741401    800         8.383234    0.136745    0.214089    35.150680  
[37m[36mINFO[0m[0m 02/06 18:26:41 | 0.801527    0.820382    0.984222    0.961346    0.116903    0.977425    0.941320    0.983475    0.963675    0.991766    0.979042    0.801527    0.820382    1000        10.479042   0.103318    0.241088    36.187183  
[37m[36mINFO[0m[0m 02/06 18:28:04 | 0.767494    0.769427    0.989725    0.964362    0.127891    0.984747    0.948655    0.986674    0.959402    0.997754    0.985030    0.767494    0.769427    1200        12.574850   0.069823    0.231531    37.050262  
[37m[36mINFO[0m[0m 02/06 18:29:27 | 0.758270    0.773248    0.987493    0.965787    0.127252    0.979866    0.948655    0.985608    0.963675    0.997006    0.985030    0.758270    0.773248    1400        14.670659   0.071731    0.231145    36.767956  
[37m[36mINFO[0m[0m 02/06 18:30:55 | 0.770038    0.771975    0.985562    0.957248    0.149134    0.973764    0.921760    0.990405    0.967949    0.992515    0.982036    0.770038    0.771975    1600        16.766467   0.069293    0.247111    37.943623  
[37m[36mINFO[0m[0m 02/06 18:32:12 | 0.776399    0.794904    0.988561    0.957823    0.151008    0.981696    0.938875    0.991471    0.961538    0.992515    0.973054    0.776399    0.794904    1800        18.862275   0.054155    0.214396    34.839202  
[37m[36mINFO[0m[0m 02/06 18:33:31 | 0.766221    0.792357    0.991515    0.956970    0.176248    0.985967    0.938875    0.993070    0.952991    0.995509    0.979042    0.766221    0.792357    2000        20.958084   0.067059    0.202654    37.864980  
[37m[36mINFO[0m[0m 02/06 18:34:43 | 0.723282    0.738854    0.988914    0.961898    0.167435    0.986577    0.951100    0.982409    0.961538    0.997754    0.973054    0.723282    0.738854    2200        23.053892   0.052131    0.182964    35.682894  
[37m[36mINFO[0m[0m 02/06 18:36:04 | 0.797074    0.806369    0.995842    0.973789    0.143851    0.993289    0.955990    0.995736    0.974359    0.998503    0.991018    0.797074    0.806369    2400        25.149701   0.038372    0.212727    38.459077  
[37m[36mINFO[0m[0m 02/06 18:37:25 | 0.726781    0.728662    0.990905    0.962221    0.160437    0.984137    0.948655    0.993070    0.967949    0.995509    0.970060    0.726781    0.728662    2600        27.245509   0.041112    0.214067    37.655016  
[37m[36mINFO[0m[0m 02/06 18:38:46 | 0.716921    0.732484    0.992989    0.965890    0.165673    0.989628    0.951100    0.989339    0.961538    1.000000    0.985030    0.716921    0.732484    2800        29.341317   0.036700    0.226908    36.474091  
[37m[36mINFO[0m[0m 02/06 18:40:02 | 0.784351    0.806369    0.994653    0.968879    0.122486    0.992068    0.951100    0.994136    0.976496    0.997754    0.979042    0.784351    0.806369    3000        31.437126   0.023031    0.194065    36.771093  
[37m[36mINFO[0m[0m 02/06 18:41:21 | 0.734733    0.751592    0.997490    0.970657    0.123244    0.996949    0.973105    0.996269    0.965812    0.999251    0.973054    0.734733    0.751592    3200        33.532934   0.033900    0.202502    38.004184  
[37m[36mINFO[0m[0m 02/06 18:42:45 | 0.755725    0.797452    0.995619    0.965200    0.154944    0.993899    0.958435    0.995203    0.955128    0.997754    0.982036    0.755725    0.797452    3400        35.628743   0.029043    0.229658    38.355429  
[37m[36mINFO[0m[0m 02/06 18:44:06 | 0.792303    0.801274    0.994184    0.963197    0.203329    0.985967    0.941320    0.997335    0.972222    0.999251    0.976048    0.792303    0.801274    3600        37.724551   0.030244    0.211810    38.383079  
[37m[36mINFO[0m[0m 02/06 18:45:27 | 0.757316    0.755414    0.990598    0.958923    0.195291    0.987797    0.941320    0.987740    0.959402    0.996257    0.976048    0.757316    0.755414    3800        39.820359   0.019213    0.215524    37.969458  
[37m[36mINFO[0m[0m 02/06 18:46:52 | 0.760178    0.774522    0.995203    0.962427    0.170739    0.993289    0.953545    0.993070    0.963675    0.999251    0.970060    0.760178    0.774522    4000        41.916168   0.023193    0.225875    39.965410  
[37m[36mINFO[0m[0m 02/06 18:48:06 | 0.724873    0.742675    0.993601    0.955891    0.231760    0.993289    0.943765    0.992004    0.950855    0.995509    0.973054    0.724873    0.742675    4200        44.011976   0.024293    0.197042    35.186682  
[37m[36mINFO[0m[0m 02/06 18:49:20 | 0.735051    0.727389    0.994949    0.959292    0.171585    0.991458    0.953545    0.994136    0.957265    0.999251    0.967066    0.735051    0.727389    4400        46.107784   0.028111    0.195174    34.296816  
[37m[36mINFO[0m[0m 02/06 18:50:43 | 0.784351    0.787261    0.998582    0.966986    0.174163    0.997559    0.953545    0.998934    0.974359    0.999251    0.973054    0.784351    0.787261    4600        48.203593   0.023276    0.230748    37.237559  
[37m[36mINFO[0m[0m 02/06 18:52:05 | 0.764631    0.774522    0.993450    0.966705    0.160914    0.989628    0.953545    0.991471    0.961538    0.999251    0.985030    0.764631    0.774522    4800        50.299401   0.018755    0.231024    35.742040  
[37m[36mINFO[0m[0m 02/06 18:53:26 | 0.800891    0.796178    0.997768    0.970981    0.173123    0.995119    0.970660    0.998934    0.972222    0.999251    0.970060    0.800891    0.796178    5000        52.395210   0.020125    0.216074    37.523032  
[37m[36mINFO[0m[0m 02/06 18:53:26 | Cumulative gradient change saved at train_output/PACS/RSC/[3]/250206_18-19-14_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/06 18:53:28 | ---
[37m[36mINFO[0m[0m 02/06 18:53:28 | test-domain validation(oracle) = 80.153%
[37m[36mINFO[0m[0m 02/06 18:53:28 | training-domain validation(iid) = 79.707%
[37m[36mINFO[0m[0m 02/06 18:53:28 | last = 80.089%
[37m[36mINFO[0m[0m 02/06 18:53:28 | last (inD) = 97.098%
[37m[36mINFO[0m[0m 02/06 18:53:28 | training-domain validation (iid, inD) = 97.379%
[37m[36mINFO[0m[0m 02/06 18:53:28 | === Summary ===
[37m[36mINFO[0m[0m 02/06 18:53:28 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset PACS --trial_seed 0 --hparams_seed 15
[37m[36mINFO[0m[0m 02/06 18:53:28 | Unique name: 250206_18-19-14_resnet50_GENIE
[37m[36mINFO[0m[0m 02/06 18:53:28 | Out path: train_output/PACS/RSC/[3]/250206_18-19-14_resnet50_GENIE
[37m[36mINFO[0m[0m 02/06 18:53:28 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/06 18:53:28 | Dataset: PACS

[37m[36mINFO[0m[0m 02/06 17:56:58 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset PACS --trial_seed 2 --hparams_seed 3
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 3
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/PACS/RSC/[3]/250206_17-56-58_resnet50_GENIE
	out_root: train_output/PACS/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250206_17-56-58_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.0002649077542048787
	batch_size: 21
	weight_decay: 0.0023111806563778695
	rsc_f_drop_factor: 0.03146145565044939
	rsc_b_drop_factor: 0.0371714794770715
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 02/06 17:56:58 | n_steps = 5001
[37m[36mINFO[0m[0m 02/06 17:56:58 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/06 17:56:58 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/06 17:56:58 | 
[37m[36mINFO[0m[0m 02/06 17:56:58 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 02/06 17:56:58 | Test envs = [3], name = te_S
[37m[36mINFO[0m[0m 02/06 17:56:58 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/06 17:56:58 | Batch sizes for each domain: [21, 21, 21, 0] (total=63)
[37m[36mINFO[0m[0m 02/06 17:56:58 | steps-per-epoch for each domain: 78.05, 89.33, 63.62 -> min = 63.62
[37m[36mINFO[0m[0m 02/06 17:56:59 | # of params = 23522375
[37m[36mINFO[0m[0m 02/06 17:57:36 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/06 17:57:36 | 0.106234    0.110828    0.256906    0.273575    1.846766    0.203783    0.229829    0.251066    0.243590    0.315868    0.347305    0.106234    0.110828    0           0.000000    1.994964    1.309796    35.360176  
[37m[36mINFO[0m[0m 02/06 17:59:02 | 0.643766    0.662420    0.948505    0.958032    0.143701    0.943868    0.943765    0.921109    0.942308    0.980539    0.988024    0.643766    0.662420    200         3.143713    0.367323    0.255461    35.536741  
[37m[36mINFO[0m[0m 02/06 18:00:33 | 0.699746    0.703185    0.972161    0.951821    0.142178    0.967053    0.931540    0.962154    0.935897    0.987275    0.988024    0.699746    0.703185    400         6.287425    0.134277    0.250472    40.858274  
[37m[36mINFO[0m[0m 02/06 18:02:00 | 0.691476    0.687898    0.971878    0.952796    0.146646    0.960342    0.924205    0.968017    0.940171    0.987275    0.994012    0.691476    0.687898    600         9.431138    0.092055    0.240933    37.881178  
[37m[36mINFO[0m[0m 02/06 18:03:24 | 0.751908    0.732484    0.991510    0.962694    0.097226    0.984137    0.946210    0.994136    0.950855    0.996257    0.991018    0.751908    0.732484    800         12.574850   0.068629    0.220271    40.565460  
[37m[36mINFO[0m[0m 02/06 18:04:46 | 0.721692    0.715924    0.985900    0.960917    0.143110    0.966443    0.924205    0.992004    0.961538    0.999251    0.997006    0.721692    0.715924    1000        15.718563   0.047012    0.206126    40.208759  
[37m[36mINFO[0m[0m 02/06 18:06:09 | 0.717875    0.710828    0.976721    0.953040    0.148532    0.966443    0.926650    0.974947    0.944444    0.988772    0.988024    0.717875    0.710828    1200        18.862275   0.042757    0.214657    40.496389  
[37m[36mINFO[0m[0m 02/06 18:07:34 | 0.720102    0.721019    0.993076    0.976703    0.105430    0.992678    0.960880    0.992537    0.972222    0.994012    0.997006    0.720102    0.721019    1400        22.005988   0.035021    0.213354    42.125231  
[37m[36mINFO[0m[0m 02/06 18:09:00 | 0.715013    0.717197    0.994562    0.974059    0.099484    0.989018    0.965770    0.994670    0.959402    1.000000    0.997006    0.715013    0.717197    1600        25.149701   0.027796    0.223865    41.366610  
[37m[36mINFO[0m[0m 02/06 18:10:22 | 0.795165    0.783439    0.994751    0.976116    0.089919    0.992678    0.970660    0.993070    0.963675    0.998503    0.994012    0.795165    0.783439    1800        28.293413   0.022980    0.225424    37.355639  
[37m[36mINFO[0m[0m 02/06 18:11:45 | 0.775763    0.764331    0.995171    0.977518    0.082520    0.995119    0.963325    0.994136    0.972222    0.996257    0.997006    0.775763    0.764331    2000        31.437126   0.043577    0.233452    36.031942  
[37m[36mINFO[0m[0m 02/06 18:13:17 | 0.801209    0.784713    0.998450    0.977415    0.101538    0.996949    0.960880    0.998401    0.974359    1.000000    0.997006    0.801209    0.784713    2200        34.580838   0.012410    0.258831    40.056183  
[37m[36mINFO[0m[0m 02/06 18:14:49 | 0.785623    0.784713    0.996071    0.975872    0.097661    0.994509    0.968215    0.995203    0.959402    0.998503    1.000000    0.785623    0.784713    2400        37.724551   0.015899    0.274540    37.383265  
[37m[36mINFO[0m[0m 02/06 18:16:22 | 0.796756    0.779618    0.997008    0.973892    0.104432    0.998170    0.958435    0.993603    0.972222    0.999251    0.991018    0.796756    0.779618    2600        40.868263   0.016143    0.278959    37.187092  
[37m[36mINFO[0m[0m 02/06 18:17:53 | 0.787532    0.782166    0.997333    0.975910    0.107372    0.995729    0.965770    0.996269    0.967949    1.000000    0.994012    0.787532    0.782166    2800        44.011976   0.012536    0.266802    36.882699  
[37m[36mINFO[0m[0m 02/06 18:19:20 | 0.794529    0.806369    0.997333    0.978025    0.088642    0.995729    0.958435    0.996269    0.978632    1.000000    0.997006    0.794529    0.806369    3000        47.155689   0.019527    0.252989    36.652077  
[37m[36mINFO[0m[0m 02/06 18:20:47 | 0.780852    0.768153    0.998252    0.976763    0.103159    0.998170    0.965770    0.997335    0.976496    0.999251    0.988024    0.780852    0.768153    3200        50.299401   0.007542    0.222965    42.436277  
[37m[36mINFO[0m[0m 02/06 18:22:18 | 0.755089    0.756688    0.991988    0.953839    0.160523    0.992068    0.938875    0.986141    0.931624    0.997754    0.991018    0.755089    0.756688    3400        53.443114   0.018022    0.252233    40.256952  
[37m[36mINFO[0m[0m 02/06 18:23:47 | 0.810751    0.802548    0.997768    0.971424    0.096613    0.995119    0.943765    0.998934    0.976496    0.999251    0.994012    0.810751    0.802548    3600        56.586826   0.020052    0.248832    39.689822  
[37m[36mINFO[0m[0m 02/06 18:25:15 | 0.804389    0.791083    0.998424    0.978737    0.090162    0.996339    0.958435    0.998934    0.980769    1.000000    0.997006    0.804389    0.791083    3800        59.730539   0.011796    0.257130    36.562170  
[37m[36mINFO[0m[0m 02/06 18:26:43 | 0.803753    0.807643    0.997693    0.970471    0.108354    0.997559    0.958435    0.996269    0.967949    0.999251    0.985030    0.803753    0.807643    4000        62.874251   0.009038    0.271043    33.429116  
[37m[36mINFO[0m[0m 02/06 18:28:09 | 0.779262    0.780892    0.993325    0.964215    0.128812    0.984137    0.931540    0.997335    0.970085    0.998503    0.991018    0.779262    0.780892    4200        66.017964   0.023549    0.262189    33.818451  
[37m[36mINFO[0m[0m 02/06 18:29:35 | 0.805662    0.802548    0.999086    0.975743    0.085953    0.999390    0.958435    0.997868    0.980769    1.000000    0.988024    0.805662    0.802548    4400        69.161677   0.010256    0.260025    34.320414  
[37m[36mINFO[0m[0m 02/06 18:31:08 | 0.794847    0.791083    0.998146    0.970205    0.105756    0.998170    0.948655    0.996269    0.967949    1.000000    0.994012    0.794847    0.791083    4600        72.305389   0.011877    0.275139    37.675926  
[37m[36mINFO[0m[0m 02/06 18:32:31 | 0.794211    0.794904    0.998353    0.973481    0.098214    0.996339    0.948655    0.999467    0.980769    0.999251    0.991018    0.794211    0.794904    4800        75.449102   0.011183    0.239533    35.092969  
[37m[36mINFO[0m[0m 02/06 18:33:52 | 0.784987    0.775796    0.999238    0.975397    0.100483    0.998780    0.953545    0.998934    0.978632    1.000000    0.994012    0.784987    0.775796    5000        78.592814   0.010024    0.225031    35.645051  
[37m[36mINFO[0m[0m 02/06 18:33:52 | Cumulative gradient change saved at train_output/PACS/RSC/[3]/250206_17-56-58_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/06 18:33:54 | ---
[37m[36mINFO[0m[0m 02/06 18:33:54 | test-domain validation(oracle) = 80.375%
[37m[36mINFO[0m[0m 02/06 18:33:54 | training-domain validation(iid) = 80.439%
[37m[36mINFO[0m[0m 02/06 18:33:54 | last = 78.499%
[37m[36mINFO[0m[0m 02/06 18:33:54 | last (inD) = 97.540%
[37m[36mINFO[0m[0m 02/06 18:33:54 | training-domain validation (iid, inD) = 97.874%
[37m[36mINFO[0m[0m 02/06 18:33:54 | === Summary ===
[37m[36mINFO[0m[0m 02/06 18:33:54 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset PACS --trial_seed 2 --hparams_seed 3
[37m[36mINFO[0m[0m 02/06 18:33:54 | Unique name: 250206_17-56-58_resnet50_GENIE
[37m[36mINFO[0m[0m 02/06 18:33:54 | Out path: train_output/PACS/RSC/[3]/250206_17-56-58_resnet50_GENIE
[37m[36mINFO[0m[0m 02/06 18:33:54 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/06 18:33:54 | Dataset: PACS

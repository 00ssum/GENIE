[37m[36mINFO[0m[0m 02/06 16:51:56 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset PACS --trial_seed 2 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/PACS/RSC/[3]/250206_16-51-56_resnet50_GENIE
	out_root: train_output/PACS/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250206_16-51-56_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 3.1159521264763664e-05
	batch_size: 11
	weight_decay: 1.4650833494643601e-05
	rsc_f_drop_factor: 0.1230288403437661
	rsc_b_drop_factor: 0.041552181381268205
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 02/06 16:51:56 | n_steps = 5001
[37m[36mINFO[0m[0m 02/06 16:51:56 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/06 16:51:56 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/06 16:51:56 | 
[37m[36mINFO[0m[0m 02/06 16:51:56 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 02/06 16:51:56 | Test envs = [3], name = te_S
[37m[36mINFO[0m[0m 02/06 16:51:56 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/06 16:51:56 | Batch sizes for each domain: [11, 11, 11, 0] (total=33)
[37m[36mINFO[0m[0m 02/06 16:51:56 | steps-per-epoch for each domain: 149.00, 170.55, 121.45 -> min = 121.45
[37m[36mINFO[0m[0m 02/06 16:51:58 | # of params = 23522375
[37m[36mINFO[0m[0m 02/06 16:52:39 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/06 16:52:39 | 0.196247    0.197452    0.205412    0.215417    1.920111    0.204393    0.229829    0.194030    0.200855    0.217814    0.215569    0.196247    0.197452    0           0.000000    2.115329    1.569122    39.470464  
[37m[36mINFO[0m[0m 02/06 16:54:03 | 0.701654    0.718471    0.888185    0.880271    0.338305    0.844417    0.819071    0.859808    0.884615    0.960329    0.937126    0.701654    0.718471    200         1.646707    0.601135    0.204578    43.254079  
[37m[36mINFO[0m[0m 02/06 16:55:26 | 0.726463    0.736306    0.940979    0.944059    0.169653    0.928005    0.909535    0.913646    0.931624    0.981287    0.991018    0.726463    0.736306    400         3.293413    0.287330    0.208213    41.016667  
[37m[36mINFO[0m[0m 02/06 16:56:42 | 0.734733    0.752866    0.942484    0.926039    0.233229    0.913362    0.904645    0.944030    0.912393    0.970060    0.961078    0.734733    0.752866    600         4.940120    0.215120    0.207278    35.104076  
[37m[36mINFO[0m[0m 02/06 16:58:01 | 0.710242    0.742675    0.969925    0.960551    0.139458    0.956071    0.929095    0.962687    0.961538    0.991018    0.991018    0.710242    0.742675    800         6.586826    0.136081    0.216977    34.888377  
[37m[36mINFO[0m[0m 02/06 16:59:14 | 0.642812    0.653503    0.977475    0.960756    0.118583    0.961562    0.933985    0.981343    0.957265    0.989521    0.991018    0.642812    0.653503    1000        8.233533    0.126729    0.195927    34.465338  
[37m[36mINFO[0m[0m 02/06 17:00:32 | 0.644402    0.644586    0.973255    0.954121    0.131038    0.962782    0.938875    0.974947    0.944444    0.982036    0.979042    0.644402    0.644586    1200        9.880240    0.109359    0.204580    36.264578  
[37m[36mINFO[0m[0m 02/06 17:01:56 | 0.701018    0.708280    0.983943    0.956402    0.115541    0.977425    0.938875    0.978145    0.942308    0.996257    0.988024    0.701018    0.708280    1400        11.526946   0.085777    0.238519    36.662300  
[37m[36mINFO[0m[0m 02/06 17:03:13 | 0.620547    0.644586    0.979897    0.949250    0.157574    0.965833    0.914425    0.981343    0.942308    0.992515    0.991018    0.620547    0.644586    1600        13.173653   0.090689    0.215542    33.504461  
[37m[36mINFO[0m[0m 02/06 17:04:30 | 0.798982    0.787261    0.980214    0.956235    0.137926    0.972544    0.931540    0.977079    0.955128    0.991018    0.982036    0.798982    0.787261    1800        14.820359   0.090323    0.210647    35.705264  
[37m[36mINFO[0m[0m 02/06 17:05:48 | 0.694975    0.731210    0.982480    0.960774    0.160262    0.977425    0.941320    0.979744    0.967949    0.990269    0.973054    0.694975    0.731210    2000        16.467066   0.073247    0.220507    33.718249  
[37m[36mINFO[0m[0m 02/06 17:07:01 | 0.779262    0.793631    0.993576    0.965662    0.111056    0.988408    0.938875    0.993070    0.970085    0.999251    0.988024    0.779262    0.793631    2200        18.113772   0.066554    0.197421    33.644291  
[37m[36mINFO[0m[0m 02/06 17:08:21 | 0.663804    0.661146    0.987746    0.963730    0.135285    0.985967    0.943765    0.984009    0.959402    0.993263    0.988024    0.663804    0.661146    2400        19.760479   0.055566    0.208136    38.186075  
[37m[36mINFO[0m[0m 02/06 17:09:44 | 0.745547    0.749045    0.985991    0.967189    0.128945    0.978035    0.941320    0.986674    0.972222    0.993263    0.988024    0.745547    0.749045    2600        21.407186   0.062715    0.230060    37.039081  
[37m[36mINFO[0m[0m 02/06 17:11:05 | 0.702290    0.733758    0.953077    0.916477    0.306932    0.901159    0.853301    0.968550    0.923077    0.989521    0.973054    0.702290    0.733758    2800        23.053892   0.071493    0.210294    38.906975  
[37m[36mINFO[0m[0m 02/06 17:12:20 | 0.809478    0.808917    0.995928    0.972365    0.104024    0.994509    0.955990    0.996269    0.970085    0.997006    0.991018    0.809478    0.808917    3000        24.700599   0.053906    0.198650    35.357173  
[37m[36mINFO[0m[0m 02/06 17:13:38 | 0.740776    0.736306    0.977512    0.955889    0.188992    0.968273    0.926650    0.971748    0.952991    0.992515    0.988024    0.740776    0.736306    3200        26.347305   0.054004    0.208171    36.363144  
[37m[36mINFO[0m[0m 02/06 17:14:58 | 0.726145    0.737580    0.995613    0.975419    0.099193    0.992068    0.960880    0.996269    0.974359    0.998503    0.991018    0.726145    0.737580    3400        27.994012   0.042113    0.177237    44.090946  
[37m[36mINFO[0m[0m 02/06 17:16:20 | 0.814249    0.815287    0.995914    0.971755    0.101560    0.993289    0.958435    0.995203    0.965812    0.999251    0.991018    0.814249    0.815287    3600        29.640719   0.045779    0.180069    45.675224  
[37m[36mINFO[0m[0m 02/06 17:17:36 | 0.753499    0.765605    0.990449    0.959636    0.136856    0.985967    0.941320    0.989872    0.961538    0.995509    0.976048    0.753499    0.765605    3800        31.287425   0.028275    0.182270    40.182893  
[37m[36mINFO[0m[0m 02/06 17:18:52 | 0.701018    0.717197    0.990536    0.955293    0.218287    0.989018    0.936430    0.993070    0.974359    0.989521    0.955090    0.701018    0.717197    4000        32.934132   0.026199    0.179309    39.834126  
[37m[36mINFO[0m[0m 02/06 17:20:09 | 0.772265    0.782166    0.991804    0.960085    0.144058    0.987797    0.948655    0.993603    0.961538    0.994012    0.970060    0.772265    0.782166    4200        34.580838   0.063831    0.176128    42.280014  
[37m[36mINFO[0m[0m 02/06 17:21:22 | 0.763359    0.768153    0.996803    0.962016    0.128474    0.993289    0.943765    0.997868    0.972222    0.999251    0.970060    0.763359    0.768153    4400        36.227545   0.060190    0.188609    35.338343  
[37m[36mINFO[0m[0m 02/06 17:22:39 | 0.780852    0.773248    0.994023    0.963871    0.117961    0.991458    0.943765    0.993603    0.965812    0.997006    0.982036    0.780852    0.773248    4600        37.874251   0.033127    0.194235    37.312681  
[37m[36mINFO[0m[0m 02/06 17:24:01 | 0.752863    0.751592    0.994014    0.964282    0.135883    0.992068    0.953545    0.991471    0.957265    0.998503    0.982036    0.752863    0.751592    4800        39.520958   0.026711    0.206019    40.977700  
[37m[36mINFO[0m[0m 02/06 17:25:20 | 0.718511    0.741401    0.985223    0.953687    0.197847    0.974985    0.921760    0.986674    0.957265    0.994012    0.982036    0.718511    0.741401    5000        41.167665   0.027544    0.210526    37.395993  
[37m[36mINFO[0m[0m 02/06 17:25:20 | Cumulative gradient change saved at train_output/PACS/RSC/[3]/250206_16-51-56_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/06 17:25:22 | ---
[37m[36mINFO[0m[0m 02/06 17:25:22 | test-domain validation(oracle) = 81.425%
[37m[36mINFO[0m[0m 02/06 17:25:22 | training-domain validation(iid) = 72.615%
[37m[36mINFO[0m[0m 02/06 17:25:22 | last = 71.851%
[37m[36mINFO[0m[0m 02/06 17:25:22 | last (inD) = 95.369%
[37m[36mINFO[0m[0m 02/06 17:25:22 | training-domain validation (iid, inD) = 97.542%
[37m[36mINFO[0m[0m 02/06 17:25:22 | === Summary ===
[37m[36mINFO[0m[0m 02/06 17:25:22 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset PACS --trial_seed 2 --hparams_seed 1
[37m[36mINFO[0m[0m 02/06 17:25:22 | Unique name: 250206_16-51-56_resnet50_GENIE
[37m[36mINFO[0m[0m 02/06 17:25:22 | Out path: train_output/PACS/RSC/[3]/250206_16-51-56_resnet50_GENIE
[37m[36mINFO[0m[0m 02/06 17:25:22 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/06 17:25:22 | Dataset: PACS

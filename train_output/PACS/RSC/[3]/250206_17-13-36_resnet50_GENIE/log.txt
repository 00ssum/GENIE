[37m[36mINFO[0m[0m 02/06 17:13:37 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset PACS --trial_seed 0 --hparams_seed 13
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 13
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/PACS/RSC/[3]/250206_17-13-36_resnet50_GENIE
	out_root: train_output/PACS/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250206_17-13-36_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.00014596629881421895
	batch_size: 9
	weight_decay: 0.0009399117661702502
	rsc_f_drop_factor: 0.07911276161410186
	rsc_b_drop_factor: 0.09127471665318299
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 02/06 17:13:37 | n_steps = 5001
[37m[36mINFO[0m[0m 02/06 17:13:37 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/06 17:13:37 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/06 17:13:37 | 
[37m[36mINFO[0m[0m 02/06 17:13:37 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 02/06 17:13:37 | Test envs = [3], name = te_S
[37m[36mINFO[0m[0m 02/06 17:13:37 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/06 17:13:37 | Batch sizes for each domain: [9, 9, 9, 0] (total=27)
[37m[36mINFO[0m[0m 02/06 17:13:37 | steps-per-epoch for each domain: 182.11, 208.44, 148.44 -> min = 148.44
[37m[36mINFO[0m[0m 02/06 17:13:38 | # of params = 23522375
[37m[36mINFO[0m[0m 02/06 17:14:19 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/06 17:14:19 | 0.196565    0.197452    0.167209    0.158784    1.980462    0.194631    0.180929    0.177505    0.151709    0.129491    0.143713    0.196565    0.197452    0           0.000000    2.180956    1.544310    39.349643  
[37m[36mINFO[0m[0m 02/06 17:15:35 | 0.581425    0.568153    0.911656    0.909010    0.244778    0.881635    0.909535    0.879531    0.850427    0.973802    0.967066    0.581425    0.568153    200         1.347305    0.633910    0.164797    43.489948  
[37m[36mINFO[0m[0m 02/06 17:16:57 | 0.777036    0.783439    0.907629    0.908031    0.267598    0.873093    0.872861    0.882729    0.908120    0.967066    0.943114    0.777036    0.783439    400         2.694611    0.305278    0.176084    46.302741  
[37m[36mINFO[0m[0m 02/06 17:18:10 | 0.723282    0.713376    0.952625    0.946297    0.149338    0.932886    0.929095    0.946695    0.948718    0.978293    0.961078    0.723282    0.713376    600         4.041916    0.280924    0.166700    39.824988  
[37m[36mINFO[0m[0m 02/06 17:19:19 | 0.702290    0.698089    0.964977    0.949070    0.176147    0.958511    0.933985    0.949893    0.940171    0.986527    0.973054    0.702290    0.698089    800         5.389222    0.164413    0.160547    37.074022  
[37m[36mINFO[0m[0m 02/06 17:20:30 | 0.758588    0.738854    0.971411    0.950575    0.160763    0.949969    0.929095    0.971748    0.946581    0.992515    0.976048    0.758588    0.738854    1000        6.736527    0.150757    0.171060    36.579185  
[37m[36mINFO[0m[0m 02/06 17:21:42 | 0.765585    0.769427    0.976740    0.950613    0.151363    0.963392    0.926650    0.972814    0.955128    0.994012    0.970060    0.765585    0.769427    1200        8.083832    0.119075    0.176805    36.477472  
[37m[36mINFO[0m[0m 02/06 17:22:57 | 0.723601    0.717197    0.982490    0.948171    0.155396    0.972544    0.936430    0.982409    0.952991    0.992515    0.955090    0.723601    0.717197    1400        9.431138    0.108454    0.186479    38.030530  
[37m[36mINFO[0m[0m 02/06 17:24:16 | 0.743003    0.771975    0.966153    0.927829    0.239734    0.958511    0.899756    0.950426    0.916667    0.989521    0.967066    0.743003    0.771975    1600        10.778443   0.090551    0.197966    38.768629  
[37m[36mINFO[0m[0m 02/06 17:25:33 | 0.705789    0.717197    0.987148    0.957419    0.120487    0.983527    0.946210    0.982409    0.952991    0.995509    0.973054    0.705789    0.717197    1800        12.125749   0.082190    0.192620    39.105412  
[37m[36mINFO[0m[0m 02/06 17:26:46 | 0.754771    0.777070    0.970234    0.947170    0.179083    0.956681    0.919315    0.963753    0.955128    0.990269    0.967066    0.754771    0.777070    2000        13.473054   0.087373    0.167601    39.603789  
[37m[36mINFO[0m[0m 02/06 17:28:01 | 0.817112    0.839490    0.970745    0.929352    0.244420    0.953630    0.902200    0.969083    0.933761    0.989521    0.952096    0.817112    0.839490    2200        14.820359   0.070187    0.165850    40.958184  
[37m[36mINFO[0m[0m 02/06 17:29:14 | 0.773537    0.773248    0.988418    0.967698    0.120437    0.984137    0.953545    0.985608    0.976496    0.995509    0.973054    0.773537    0.773248    2400        16.167665   0.072953    0.160957    41.077802  
[37m[36mINFO[0m[0m 02/06 17:30:27 | 0.683206    0.672611    0.984732    0.953484    0.170326    0.981086    0.933985    0.981343    0.959402    0.991766    0.967066    0.683206    0.672611    2600        17.514970   0.056702    0.163925    40.242068  
[37m[36mINFO[0m[0m 02/06 17:31:46 | 0.788168    0.800000    0.996762    0.965767    0.113404    0.995729    0.958435    0.996802    0.965812    0.997754    0.973054    0.788168    0.800000    2800        18.862275   0.032383    0.176287    43.516001  
[37m[36mINFO[0m[0m 02/06 17:32:55 | 0.786578    0.782166    0.993852    0.963570    0.119259    0.989018    0.953545    0.992537    0.955128    1.000000    0.982036    0.786578    0.782166    3000        20.209581   0.046148    0.150532    39.302793  
[37m[36mINFO[0m[0m 02/06 17:34:04 | 0.701336    0.703185    0.990697    0.960187    0.154801    0.981696    0.951100    0.994136    0.959402    0.996257    0.970060    0.701336    0.703185    3200        21.556886   0.054003    0.158706    37.244405  
[37m[36mINFO[0m[0m 02/06 17:35:19 | 0.776399    0.779618    0.994957    0.961060    0.155613    0.990848    0.941320    0.996269    0.965812    0.997754    0.976048    0.776399    0.779618    3400        22.904192   0.034934    0.173320    40.474835  
[37m[36mINFO[0m[0m 02/06 17:36:31 | 0.791985    0.803822    0.991177    0.952875    0.150145    0.987187    0.936430    0.989339    0.955128    0.997006    0.967066    0.791985    0.803822    3600        24.251497   0.029786    0.163914    39.010925  
[37m[36mINFO[0m[0m 02/06 17:37:44 | 0.768448    0.773248    0.991083    0.954829    0.139124    0.984137    0.938875    0.993603    0.961538    0.995509    0.964072    0.768448    0.773248    3800        25.598802   0.063100    0.166614    39.954679  
[37m[36mINFO[0m[0m 02/06 17:38:59 | 0.741412    0.764331    0.994082    0.964849    0.133705    0.992068    0.953545    0.994670    0.967949    0.995509    0.973054    0.741412    0.764331    4000        26.946108   0.037341    0.168997    41.459039  
[37m[36mINFO[0m[0m 02/06 17:40:07 | 0.764949    0.778344    0.973414    0.935908    0.233721    0.944478    0.902200    0.987740    0.944444    0.988024    0.961078    0.764949    0.778344    4200        28.293413   0.033073    0.155012    36.655582  
[37m[36mINFO[0m[0m 02/06 17:41:18 | 0.721056    0.749045    0.984715    0.950959    0.216156    0.982306    0.931540    0.977079    0.957265    0.994760    0.964072    0.721056    0.749045    4400        29.640719   0.041852    0.153700    40.455624  
[37m[36mINFO[0m[0m 02/06 17:42:33 | 0.745547    0.765605    0.997748    0.964724    0.125226    0.996339    0.943765    0.998401    0.974359    0.998503    0.976048    0.745547    0.765605    4600        30.988024   0.040775    0.161698    42.615529  
[37m[36mINFO[0m[0m 02/06 17:43:46 | 0.721374    0.738854    0.995407    0.963528    0.131386    0.993899    0.955990    0.993070    0.961538    0.999251    0.973054    0.721374    0.738854    4800        32.335329   0.037992    0.166018    39.403380  
[37m[36mINFO[0m[0m 02/06 17:44:59 | 0.726781    0.736306    0.996625    0.967718    0.151119    0.993289    0.943765    0.997335    0.974359    0.999251    0.985030    0.726781    0.736306    5000        33.682635   0.031094    0.173634    38.206714  
[37m[36mINFO[0m[0m 02/06 17:44:59 | Cumulative gradient change saved at train_output/PACS/RSC/[3]/250206_17-13-36_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/06 17:45:01 | ---
[37m[36mINFO[0m[0m 02/06 17:45:01 | test-domain validation(oracle) = 81.711%
[37m[36mINFO[0m[0m 02/06 17:45:01 | training-domain validation(iid) = 72.678%
[37m[36mINFO[0m[0m 02/06 17:45:01 | last = 72.678%
[37m[36mINFO[0m[0m 02/06 17:45:01 | last (inD) = 96.772%
[37m[36mINFO[0m[0m 02/06 17:45:01 | training-domain validation (iid, inD) = 96.772%
[37m[36mINFO[0m[0m 02/06 17:45:01 | === Summary ===
[37m[36mINFO[0m[0m 02/06 17:45:01 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset PACS --trial_seed 0 --hparams_seed 13
[37m[36mINFO[0m[0m 02/06 17:45:01 | Unique name: 250206_17-13-36_resnet50_GENIE
[37m[36mINFO[0m[0m 02/06 17:45:01 | Out path: train_output/PACS/RSC/[3]/250206_17-13-36_resnet50_GENIE
[37m[36mINFO[0m[0m 02/06 17:45:01 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/06 17:45:01 | Dataset: PACS

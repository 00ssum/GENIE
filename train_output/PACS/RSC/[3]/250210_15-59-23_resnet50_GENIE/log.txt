[37m[36mINFO[0m[0m 02/10 15:59:23 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset PACS --trial_seed 2 --hparams_seed 12
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 12
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/PACS/RSC/[3]/250210_15-59-23_resnet50_GENIE
	out_root: train_output/PACS/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250210_15-59-23_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5.346798771850428e-05
	batch_size: 44
	weight_decay: 1.8352299015720086e-05
	rsc_f_drop_factor: 0.3799895564860098
	rsc_b_drop_factor: 0.03414045373033975
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 02/10 15:59:23 | n_steps = 5001
[37m[36mINFO[0m[0m 02/10 15:59:23 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/10 15:59:23 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/10 15:59:23 | 
[37m[36mINFO[0m[0m 02/10 15:59:23 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 02/10 15:59:23 | Test envs = [3], name = te_S
[37m[36mINFO[0m[0m 02/10 15:59:23 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/10 15:59:23 | Batch sizes for each domain: [44, 44, 44, 0] (total=132)
[37m[36mINFO[0m[0m 02/10 15:59:23 | steps-per-epoch for each domain: 37.25, 42.64, 30.36 -> min = 30.36
[37m[36mINFO[0m[0m 02/10 15:59:25 | # of params = 23522375
[37m[36mINFO[0m[0m 02/10 16:00:03 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/10 16:00:03 | 0.042303    0.045860    0.267349    0.258361    1.852274    0.226358    0.227384    0.255330    0.239316    0.320359    0.308383    0.042303    0.045860    0           0.000000    2.122546    1.441526    36.870128  
[37m[36mINFO[0m[0m 02/10 16:01:57 | 0.624364    0.648408    0.967742    0.953656    0.131596    0.954851    0.941320    0.957356    0.931624    0.991018    0.988024    0.624364    0.648408    200         6.586826    0.433395    0.391632    35.377464  
[37m[36mINFO[0m[0m 02/10 16:03:36 | 0.765585    0.777070    0.988487    0.967950    0.095621    0.986577    0.955990    0.981876    0.950855    0.997006    0.997006    0.765585    0.777070    400         13.173653   0.171015    0.310631    36.706159  
[37m[36mINFO[0m[0m 02/10 16:05:27 | 0.720738    0.712102    0.985770    0.969618    0.093867    0.985357    0.958435    0.974947    0.959402    0.997006    0.991018    0.720738    0.712102    600         19.760479   0.119245    0.368818    37.884242  
[37m[36mINFO[0m[0m 02/10 16:07:07 | 0.763995    0.752866    0.986282    0.968605    0.101300    0.986577    0.968215    0.976013    0.946581    0.996257    0.991018    0.763995    0.752866    800         26.347305   0.098905    0.311739    37.581954  
[37m[36mINFO[0m[0m 02/10 16:08:52 | 0.756043    0.750318    0.993530    0.971005    0.086517    0.989018    0.960880    0.993070    0.955128    0.998503    0.997006    0.756043    0.750318    1000        32.934132   0.090814    0.342914    35.780435  
[37m[36mINFO[0m[0m 02/10 16:10:37 | 0.730916    0.737580    0.991929    0.972791    0.098649    0.984747    0.955990    0.992537    0.974359    0.998503    0.988024    0.730916    0.737580    1200        39.520958   0.079031    0.334615    38.245403  
[37m[36mINFO[0m[0m 02/10 16:12:18 | 0.766539    0.763057    0.996266    0.978112    0.102422    0.995729    0.970660    0.993070    0.963675    1.000000    1.000000    0.766539    0.763057    1400        46.107784   0.075624    0.315770    38.054940  
[37m[36mINFO[0m[0m 02/10 16:14:13 | 0.688613    0.681529    0.994670    0.967649    0.131965    0.993289    0.965770    0.991471    0.940171    0.999251    0.997006    0.688613    0.681529    1600        52.694611   0.066387    0.393385    36.741771  
[37m[36mINFO[0m[0m 02/10 16:15:51 | 0.728372    0.727389    0.997134    0.975073    0.123383    0.996949    0.955990    0.995203    0.972222    0.999251    0.997006    0.728372    0.727389    1800        59.281437   0.063624    0.307488    36.132573  
[37m[36mINFO[0m[0m 02/10 16:17:45 | 0.755725    0.761783    0.997562    0.971168    0.148581    0.996949    0.968215    0.995736    0.957265    1.000000    0.988024    0.755725    0.761783    2000        65.868263   0.065116    0.388272    36.584644  
[37m[36mINFO[0m[0m 02/10 16:19:23 | 0.784351    0.784713    0.998576    0.977415    0.124516    0.995729    0.960880    1.000000    0.974359    1.000000    0.997006    0.784351    0.784713    2200        72.455090   0.057204    0.311009    35.713052  
[37m[36mINFO[0m[0m 02/10 16:21:12 | 0.810115    0.798726    0.998734    0.975053    0.107501    0.996949    0.965770    1.000000    0.974359    0.999251    0.985030    0.810115    0.798726    2400        79.041916   0.059774    0.352901    38.127760  
[37m[36mINFO[0m[0m 02/10 16:22:58 | 0.780216    0.792357    0.997840    0.968129    0.147029    0.995119    0.953545    0.998401    0.965812    1.000000    0.985030    0.780216    0.792357    2600        85.628743   0.055825    0.342730    37.977131  
[37m[36mINFO[0m[0m 02/10 16:24:37 | 0.798346    0.785987    0.997485    0.974852    0.132126    0.995119    0.960880    0.997335    0.963675    1.000000    1.000000    0.798346    0.785987    2800        92.215569   0.057081    0.319559    34.890447  
[37m[36mINFO[0m[0m 02/10 16:26:27 | 0.746819    0.750318    0.998278    0.976116    0.137114    0.998780    0.970660    0.996802    0.963675    0.999251    0.994012    0.746819    0.750318    3000        98.802395   0.051941    0.366853    36.557691  
[37m[36mINFO[0m[0m 02/10 16:28:09 | 0.776081    0.779618    0.996955    0.968986    0.153280    0.992678    0.953545    0.998934    0.959402    0.999251    0.994012    0.776081    0.779618    3200        105.389222  0.056174    0.319602    38.289849  
[37m[36mINFO[0m[0m 02/10 16:30:09 | 0.742366    0.750318    0.996596    0.965094    0.188020    0.995119    0.938875    0.994670    0.959402    1.000000    0.997006    0.742366    0.750318    3400        111.976048  0.065100    0.408446    37.831146  
[37m[36mINFO[0m[0m 02/10 16:31:45 | 0.749364    0.746497    0.998404    0.975602    0.201051    0.997559    0.958435    0.998401    0.974359    0.999251    0.994012    0.749364    0.746497    3600        118.562874  0.044969    0.305965    35.109734  
[37m[36mINFO[0m[0m 02/10 16:33:38 | 0.819656    0.814013    0.997438    0.975667    0.141335    0.995729    0.963325    0.997335    0.963675    0.999251    1.000000    0.819656    0.814013    3800        125.149701  0.060860    0.381063    36.771334  
[37m[36mINFO[0m[0m 02/10 16:35:17 | 0.774491    0.770701    0.998272    0.973039    0.228930    0.996949    0.958435    0.997868    0.963675    1.000000    0.997006    0.774491    0.770701    4000        131.736527  0.047661    0.321461    34.663796  
[37m[36mINFO[0m[0m 02/10 16:36:57 | 0.758270    0.764331    0.994708    0.965177    0.163667    0.990848    0.951100    0.996269    0.959402    0.997006    0.985030    0.758270    0.764331    4200        138.323353  0.052243    0.318972    35.587760  
[37m[36mINFO[0m[0m 02/10 16:38:53 | 0.792303    0.793631    0.999573    0.980961    0.196122    1.000000    0.970660    0.999467    0.972222    0.999251    1.000000    0.792303    0.793631    4400        144.910180  0.053252    0.376655    41.597847  
[37m[36mINFO[0m[0m 02/10 16:40:31 | 0.751590    0.765605    0.997590    0.960287    0.224341    0.995119    0.936430    0.998401    0.959402    0.999251    0.985030    0.751590    0.765605    4600        151.497006  0.047010    0.307531    35.775505  
[37m[36mINFO[0m[0m 02/10 16:42:25 | 0.805980    0.787261    0.998831    0.974669    0.215975    0.997559    0.963325    0.998934    0.963675    1.000000    0.997006    0.805980    0.787261    4800        158.083832  0.056929    0.389766    36.645599  
[37m[36mINFO[0m[0m 02/10 16:44:04 | 0.763677    0.760510    0.998180    0.963711    0.306162    0.998170    0.953545    0.997868    0.961538    0.998503    0.976048    0.763677    0.760510    5000        164.670659  0.046265    0.318370    35.373069  
[37m[36mINFO[0m[0m 02/10 16:44:05 | Cumulative gradient change saved at train_output/PACS/RSC/[3]/250210_15-59-23_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/10 16:44:06 | ---
[37m[36mINFO[0m[0m 02/10 16:44:06 | test-domain validation(oracle) = 81.966%
[37m[36mINFO[0m[0m 02/10 16:44:06 | training-domain validation(iid) = 79.230%
[37m[36mINFO[0m[0m 02/10 16:44:06 | last = 76.368%
[37m[36mINFO[0m[0m 02/10 16:44:06 | last (inD) = 96.371%
[37m[36mINFO[0m[0m 02/10 16:44:06 | training-domain validation (iid, inD) = 98.096%
[37m[36mINFO[0m[0m 02/10 16:44:06 | === Summary ===
[37m[36mINFO[0m[0m 02/10 16:44:06 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset PACS --trial_seed 2 --hparams_seed 12
[37m[36mINFO[0m[0m 02/10 16:44:06 | Unique name: 250210_15-59-23_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 16:44:06 | Out path: train_output/PACS/RSC/[3]/250210_15-59-23_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 16:44:06 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/10 16:44:06 | Dataset: PACS

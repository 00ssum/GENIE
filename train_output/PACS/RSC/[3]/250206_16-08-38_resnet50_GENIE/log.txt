[37m[36mINFO[0m[0m 02/06 16:08:38 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset PACS --trial_seed 0 --hparams_seed 11
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 11
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/PACS/RSC/[3]/250206_16-08-38_resnet50_GENIE
	out_root: train_output/PACS/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250206_16-08-38_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5.962562271631622e-05
	batch_size: 11
	weight_decay: 0.001114945719897867
	rsc_f_drop_factor: 0.4274398027176696
	rsc_b_drop_factor: 0.4906745147717738
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 02/06 16:08:38 | n_steps = 5001
[37m[36mINFO[0m[0m 02/06 16:08:38 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/06 16:08:38 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/06 16:08:38 | 
[37m[36mINFO[0m[0m 02/06 16:08:38 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 02/06 16:08:38 | Test envs = [3], name = te_S
[37m[36mINFO[0m[0m 02/06 16:08:38 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/06 16:08:38 | Batch sizes for each domain: [11, 11, 11, 0] (total=33)
[37m[36mINFO[0m[0m 02/06 16:08:38 | steps-per-epoch for each domain: 149.00, 170.55, 121.45 -> min = 121.45
[37m[36mINFO[0m[0m 02/06 16:08:39 | # of params = 23522375
[37m[36mINFO[0m[0m 02/06 16:09:14 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/06 16:09:14 | 0.139313    0.156688    0.176927    0.156004    1.951565    0.204393    0.185819    0.164712    0.117521    0.161677    0.164671    0.139313    0.156688    0           0.000000    4.299326    0.929937    34.407601  
[37m[36mINFO[0m[0m 02/06 16:10:19 | 0.041031    0.039490    0.219901    0.204892    1.920623    0.223307    0.202934    0.172175    0.175214    0.264222    0.236527    0.041031    0.039490    200         1.646707    1.946346    0.144703    35.599902  
[37m[36mINFO[0m[0m 02/06 16:11:35 | 0.041031    0.039490    0.219901    0.204892    1.918336    0.223307    0.202934    0.172175    0.175214    0.264222    0.236527    0.041031    0.039490    400         3.293413    1.921988    0.186166    38.433597  
[37m[36mINFO[0m[0m 02/06 16:12:44 | 0.041031    0.039490    0.219901    0.204892    1.906114    0.223307    0.202934    0.172175    0.175214    0.264222    0.236527    0.041031    0.039490    600         4.940120    1.919362    0.161986    36.855130  
[37m[36mINFO[0m[0m 02/06 16:13:55 | 0.041031    0.039490    0.219901    0.204892    1.901876    0.223307    0.202934    0.172175    0.175214    0.264222    0.236527    0.041031    0.039490    800         6.586826    1.913519    0.175629    35.634785  
[37m[36mINFO[0m[0m 02/06 16:15:07 | 0.041031    0.039490    0.219901    0.204892    1.886702    0.223307    0.202934    0.172175    0.175214    0.264222    0.236527    0.041031    0.039490    1000        8.233533    1.909409    0.187584    34.688905  
[37m[36mINFO[0m[0m 02/06 16:16:19 | 0.041031    0.039490    0.221851    0.206419    1.797340    0.223917    0.205379    0.172175    0.177350    0.269461    0.236527    0.041031    0.039490    1200        9.880240    1.893242    0.187066    34.988326  
[37m[36mINFO[0m[0m 02/06 16:17:30 | 0.046756    0.042038    0.339594    0.323991    1.708933    0.336181    0.310513    0.261194    0.254274    0.421407    0.407186    0.046756    0.042038    1400        11.526946   1.866386    0.151956    40.248950  
[37m[36mINFO[0m[0m 02/06 16:18:45 | 0.045165    0.042038    0.350648    0.333380    1.618782    0.347773    0.320293    0.270789    0.260684    0.433383    0.419162    0.045165    0.042038    1600        13.173653   1.831314    0.193310    36.254914  
[37m[36mINFO[0m[0m 02/06 16:20:06 | 0.222328    0.235669    0.518069    0.520324    1.424743    0.455766    0.442543    0.513859    0.555556    0.584581    0.562874    0.222328    0.235669    1800        14.820359   1.793821    0.220833    36.829820  
[37m[36mINFO[0m[0m 02/06 16:21:27 | 0.406489    0.408917    0.651285    0.661241    1.088418    0.585723    0.618582    0.615139    0.649573    0.752994    0.715569    0.406489    0.408917    2000        16.467066   1.707323    0.201651    41.183517  
[37m[36mINFO[0m[0m 02/06 16:22:48 | 0.509224    0.486624    0.732067    0.743678    0.831112    0.692495    0.718826    0.690832    0.730769    0.812874    0.781437    0.509224    0.486624    2200        18.113772   1.605624    0.184236    43.736879  
[37m[36mINFO[0m[0m 02/06 16:24:05 | 0.422392    0.425478    0.793204    0.778406    0.589379    0.725442    0.738386    0.792644    0.803419    0.861527    0.793413    0.422392    0.425478    2400        19.760479   1.411150    0.175377    41.619858  
[37m[36mINFO[0m[0m 02/06 16:25:19 | 0.654580    0.658599    0.907795    0.913351    0.272158    0.879805    0.904645    0.886994    0.910256    0.956587    0.925150    0.654580    0.658599    2600        21.407186   1.346862    0.194159    36.018170  
[37m[36mINFO[0m[0m 02/06 16:26:38 | 0.538486    0.533758    0.930288    0.921232    0.259794    0.924954    0.902200    0.892857    0.912393    0.973054    0.949102    0.538486    0.533758    2800        23.053892   1.259321    0.208233    36.963176  
[37m[36mINFO[0m[0m 02/06 16:27:54 | 0.548028    0.552866    0.918027    0.919073    0.271553    0.887126    0.894866    0.901386    0.910256    0.965569    0.952096    0.548028    0.552866    3000        24.700599   1.206923    0.190412    38.055996  
[37m[36mINFO[0m[0m 02/06 16:29:07 | 0.706107    0.735032    0.930474    0.905491    0.281989    0.921904    0.880196    0.902452    0.893162    0.967066    0.943114    0.706107    0.735032    3200        26.347305   1.180697    0.162954    40.172807  
[37m[36mINFO[0m[0m 02/06 16:30:24 | 0.659033    0.670064    0.948013    0.942568    0.179000    0.932276    0.921760    0.934968    0.950855    0.976796    0.955090    0.659033    0.670064    3400        27.994012   1.101122    0.194834    38.388320  
[37m[36mINFO[0m[0m 02/06 16:31:45 | 0.585878    0.600000    0.937001    0.930208    0.196179    0.923734    0.919315    0.938166    0.940171    0.949102    0.931138    0.585878    0.600000    3600        29.640719   1.099057    0.221075    36.840524  
[37m[36mINFO[0m[0m 02/06 16:33:07 | 0.726145    0.733758    0.977810    0.946681    0.181705    0.971934    0.931540    0.967484    0.959402    0.994012    0.949102    0.726145    0.733758    3800        31.287425   1.090136    0.198499    42.422467  
[37m[36mINFO[0m[0m 02/06 16:34:21 | 0.563613    0.563057    0.954168    0.914250    0.281474    0.947529    0.902200    0.934435    0.897436    0.980539    0.943114    0.563613    0.563057    4000        32.934132   1.055475    0.165006    40.941851  
[37m[36mINFO[0m[0m 02/06 16:35:34 | 0.746819    0.769427    0.971752    0.938809    0.221078    0.970104    0.933985    0.961620    0.927350    0.983533    0.955090    0.746819    0.769427    4200        34.580838   1.078152    0.189524    35.139071  
[37m[36mINFO[0m[0m 02/06 16:36:49 | 0.773537    0.802548    0.972945    0.938478    0.232460    0.962782    0.919315    0.964286    0.938034    0.991766    0.958084    0.773537    0.802548    4400        36.227545   1.045688    0.203166    33.878746  
[37m[36mINFO[0m[0m 02/06 16:38:08 | 0.688295    0.691720    0.971652    0.943381    0.178132    0.956681    0.907090    0.971748    0.952991    0.986527    0.970060    0.688295    0.691720    4600        37.874251   1.091914    0.190547    41.380998  
[37m[36mINFO[0m[0m 02/06 16:39:22 | 0.730916    0.729936    0.978561    0.946172    0.212457    0.967053    0.919315    0.977612    0.955128    0.991018    0.964072    0.730916    0.729936    4800        39.520958   1.026448    0.174420    38.756678  
[37m[36mINFO[0m[0m 02/06 16:40:39 | 0.638359    0.643312    0.980197    0.957274    0.200455    0.973764    0.946210    0.972814    0.961538    0.994012    0.964072    0.638359    0.643312    5000        41.167665   1.057145    0.189137    38.813192  
[37m[36mINFO[0m[0m 02/06 16:40:39 | Cumulative gradient change saved at train_output/PACS/RSC/[3]/250206_16-08-38_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/06 16:40:41 | ---
[37m[36mINFO[0m[0m 02/06 16:40:41 | test-domain validation(oracle) = 77.354%
[37m[36mINFO[0m[0m 02/06 16:40:41 | training-domain validation(iid) = 63.836%
[37m[36mINFO[0m[0m 02/06 16:40:41 | last = 63.836%
[37m[36mINFO[0m[0m 02/06 16:40:41 | last (inD) = 95.727%
[37m[36mINFO[0m[0m 02/06 16:40:41 | training-domain validation (iid, inD) = 95.727%
[37m[36mINFO[0m[0m 02/06 16:40:41 | === Summary ===
[37m[36mINFO[0m[0m 02/06 16:40:41 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset PACS --trial_seed 0 --hparams_seed 11
[37m[36mINFO[0m[0m 02/06 16:40:41 | Unique name: 250206_16-08-38_resnet50_GENIE
[37m[36mINFO[0m[0m 02/06 16:40:41 | Out path: train_output/PACS/RSC/[3]/250206_16-08-38_resnet50_GENIE
[37m[36mINFO[0m[0m 02/06 16:40:41 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/06 16:40:41 | Dataset: PACS

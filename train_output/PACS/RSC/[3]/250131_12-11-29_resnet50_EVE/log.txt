[37m[36mINFO[0m[0m 01/31 12:11:29 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm RSC --test_envs 3 --dataset PACS --trial_seed 0 --hparams_seed 6
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 6
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/PACS/RSC/[3]/250131_12-11-29_resnet50_EVE
	out_root: train_output/PACS/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250131_12-11-29_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: GENIE
	freeze_bn: False
	pretrained: True
	lr: 1.5764387170443743e-05
	batch_size: 19
	weight_decay: 0.0006024239579587198
	rsc_f_drop_factor: 0.19876770246536363
	rsc_b_drop_factor: 0.08199629172100226
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 01/31 12:11:29 | n_steps = 5001
[37m[36mINFO[0m[0m 01/31 12:11:29 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/31 12:11:29 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/31 12:11:29 | Target test envs = [[3]]
[37m[36mINFO[0m[0m 01/31 12:11:29 | 
[37m[36mINFO[0m[0m 01/31 12:11:29 | Testenv name escaping te_S -> te_S
[37m[36mINFO[0m[0m 01/31 12:11:29 | Test envs = [3], name = te_S
[37m[36mINFO[0m[0m 01/31 12:11:29 | Batch sizes for each domain: [19, 19, 19, 0] (total=57)
[37m[36mINFO[0m[0m 01/31 12:11:29 | steps-per-epoch for each domain: 86.26, 98.74, 70.32 -> min = 70.32
[37m[36mINFO[0m[0m 01/31 12:11:30 | # of params = 23522375
[37m[36mINFO[0m[0m 01/31 12:12:08 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/31 12:12:08 | 0.199746    0.196178    0.270253    0.258174    1.867948    0.231849    0.229829    0.251066    0.254274    0.327844    0.290419    0.199746    0.196178    0           0.000000    2.293641    1.434498    36.670181  
[37m[36mINFO[0m[0m 01/31 12:13:28 | 0.760178    0.761783    0.940999    0.947402    0.171577    0.927395    0.931540    0.904584    0.931624    0.991018    0.979042    0.760178    0.761783    200         2.844311    0.588974    0.212348    36.995282  
[37m[36mINFO[0m[0m 01/31 12:14:41 | 0.743957    0.745223    0.974134    0.961125    0.114264    0.964002    0.946210    0.965885    0.955128    0.992515    0.982036    0.743957    0.745223    400         5.688623    0.213880    0.199352    33.333172  
[37m[36mINFO[0m[0m 01/31 12:15:56 | 0.770038    0.777070    0.974922    0.952837    0.139313    0.965833    0.938875    0.966418    0.946581    0.992515    0.973054    0.770038    0.777070    600         8.532934    0.133080    0.192466    36.291640  
[37m[36mINFO[0m[0m 01/31 12:17:03 | 0.764949    0.763057    0.990436    0.967051    0.119192    0.984747    0.958435    0.988806    0.963675    0.997754    0.979042    0.764949    0.763057    800         11.377246   0.084662    0.166422    33.596490  
[37m[36mINFO[0m[0m 01/31 12:18:18 | 0.746501    0.751592    0.985239    0.958066    0.148187    0.971934    0.941320    0.988273    0.965812    0.995509    0.967066    0.746501    0.751592    1000        14.221557   0.078795    0.195956    35.619401  
[37m[36mINFO[0m[0m 01/31 12:19:31 | 0.768130    0.769427    0.991236    0.961368    0.158954    0.985967    0.948655    0.987740    0.959402    1.000000    0.976048    0.768130    0.769427    1200        17.065868   0.066659    0.200391    32.381492  
[37m[36mINFO[0m[0m 01/31 12:20:41 | 0.753817    0.764331    0.993948    0.962976    0.165035    0.993899    0.946210    0.990938    0.963675    0.997006    0.979042    0.753817    0.764331    1400        19.910180   0.059195    0.179575    34.060570  
[37m[36mINFO[0m[0m 01/31 12:22:03 | 0.763041    0.760510    0.990219    0.967603    0.159824    0.989018    0.968215    0.989872    0.961538    0.991766    0.973054    0.763041    0.760510    1600        22.754491   0.040316    0.219511    37.753198  
[37m[36mINFO[0m[0m 01/31 12:23:14 | 0.798664    0.791083    0.995080    0.969576    0.141751    0.992068    0.960880    0.994670    0.965812    0.998503    0.982036    0.798664    0.791083    1800        25.598802   0.047413    0.186727    33.496650  
[37m[36mINFO[0m[0m 01/31 12:24:28 | 0.788486    0.784713    0.995701    0.969290    0.124996    0.997559    0.960880    0.992537    0.967949    0.997006    0.979042    0.788486    0.784713    2000        28.443114   0.038765    0.169475    40.404100  
[37m[36mINFO[0m[0m 01/31 12:25:47 | 0.749682    0.746497    0.995430    0.968902    0.123845    0.990238    0.958435    0.996802    0.972222    0.999251    0.976048    0.749682    0.746497    2200        31.287425   0.039383    0.220733    34.437074  
[37m[36mINFO[0m[0m 01/31 12:26:57 | 0.687977    0.682803    0.984544    0.957765    0.178763    0.977425    0.951100    0.982942    0.955128    0.993263    0.967066    0.687977    0.682803    2400        34.131737   0.041852    0.187174    32.558120  
[37m[36mINFO[0m[0m 01/31 12:28:23 | 0.803435    0.819108    0.999009    0.973240    0.151749    0.997559    0.963325    0.999467    0.974359    1.000000    0.982036    0.803435    0.819108    2600        36.976048   0.039693    0.219460    42.713716  
[37m[36mINFO[0m[0m 01/31 12:29:35 | 0.791349    0.798726    0.996707    0.970391    0.181556    0.996949    0.963325    0.994670    0.965812    0.998503    0.982036    0.791349    0.798726    2800        39.820359   0.026008    0.194158    32.579178  
[37m[36mINFO[0m[0m 01/31 12:30:49 | 0.756997    0.759236    0.997722    0.959674    0.215898    0.995729    0.938875    0.998934    0.970085    0.998503    0.970060    0.756997    0.759236    3000        42.664671   0.024566    0.193798    35.220858  
[37m[36mINFO[0m[0m 01/31 12:32:04 | 0.780216    0.775796    0.997891    0.970532    0.165538    0.996339    0.963325    0.997335    0.972222    1.000000    0.976048    0.780216    0.775796    3200        45.508982   0.032780    0.187053    37.080356  
[37m[36mINFO[0m[0m 01/31 12:33:11 | 0.738868    0.737580    0.990765    0.962141    0.248633    0.990238    0.953545    0.992537    0.965812    0.989521    0.967066    0.738868    0.737580    3400        48.353293   0.031972    0.170014    33.640613  
[37m[36mINFO[0m[0m 01/31 12:34:25 | 0.694656    0.703185    0.996885    0.962998    0.191477    0.996949    0.953545    0.995203    0.959402    0.998503    0.976048    0.694656    0.703185    3600        51.197605   0.030943    0.205704    32.441319  
[37m[36mINFO[0m[0m 01/31 12:35:39 | 0.782125    0.792357    0.998831    0.970243    0.173789    0.997559    0.946210    0.998934    0.976496    1.000000    0.988024    0.782125    0.792357    3800        54.041916   0.024655    0.183543    37.280903  
[37m[36mINFO[0m[0m 01/31 12:36:58 | 0.743321    0.766879    0.993812    0.954219    0.239414    0.993289    0.941320    0.994136    0.957265    0.994012    0.964072    0.743321    0.766879    4000        56.886228   0.024916    0.216118    36.060482  
[37m[36mINFO[0m[0m 01/31 12:38:12 | 0.796120    0.805096    0.997820    0.970635    0.186221    0.996339    0.965770    0.997868    0.970085    0.999251    0.976048    0.796120    0.805096    4200        59.730539   0.024487    0.196027    34.079941  
[37m[36mINFO[0m[0m 01/31 12:39:37 | 0.752226    0.761783    0.999212    0.967888    0.246331    0.998170    0.968215    0.999467    0.959402    1.000000    0.976048    0.752226    0.761783    4400        62.574850   0.014765    0.218302    41.441501  
[37m[36mINFO[0m[0m 01/31 12:40:44 | 0.723601    0.715924    0.992830    0.958968    0.250945    0.992678    0.955990    0.988806    0.950855    0.997006    0.970060    0.723601    0.715924    4600        65.419162   0.020244    0.173219    32.462904  
[37m[36mINFO[0m[0m 01/31 12:41:51 | 0.806298    0.807643    0.997696    0.956155    0.240846    0.995119    0.936430    0.999467    0.952991    0.998503    0.979042    0.806298    0.807643    4800        68.263473   0.020893    0.177586    32.058247  
[37m[36mINFO[0m[0m 01/31 12:43:15 | 0.792939    0.793631    0.998298    0.956561    0.286915    0.997559    0.946210    0.997335    0.959402    1.000000    0.964072    0.792939    0.793631    5000        71.107784   0.021792    0.237603    35.656395  
[37m[36mINFO[0m[0m 01/31 12:43:15 | Cumulative gradient change saved at train_output/PACS/RSC/[3]/250131_12-11-29_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/31 12:43:16 | ---
[37m[36mINFO[0m[0m 01/31 12:43:16 | test-domain validation(oracle) = 80.344%
[37m[36mINFO[0m[0m 01/31 12:43:16 | training-domain validation(iid) = 80.344%
[37m[36mINFO[0m[0m 01/31 12:43:16 | last = 79.294%
[37m[36mINFO[0m[0m 01/31 12:43:16 | last (inD) = 95.656%
[37m[36mINFO[0m[0m 01/31 12:43:16 | training-domain validation (iid, inD) = 97.324%
[37m[36mINFO[0m[0m 01/31 12:43:16 | === Summary ===
[37m[36mINFO[0m[0m 01/31 12:43:16 | Command: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm RSC --test_envs 3 --dataset PACS --trial_seed 0 --hparams_seed 6
[37m[36mINFO[0m[0m 01/31 12:43:16 | Unique name: 250131_12-11-29_resnet50_EVE
[37m[36mINFO[0m[0m 01/31 12:43:16 | Out path: train_output/PACS/RSC/[3]/250131_12-11-29_resnet50_EVE
[37m[36mINFO[0m[0m 01/31 12:43:16 | Algorithm: RSC
[37m[36mINFO[0m[0m 01/31 12:43:16 | Dataset: PACS
[37m[36mINFO[0m[0m 01/31 12:43:16 | Max test_in: 0.8063

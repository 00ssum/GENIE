[37m[36mINFO[0m[0m 01/26 04:36:49 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 1 --dataset PACS --trial_seed 1 --hparams_seed 13
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 13
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/PACS/CORAL/[1]/250126_04-36-49_resnet50_EVE
	out_root: train_output/PACS/CORAL/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250126_04-36-49_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: GENIE
	freeze_bn: False
	pretrained: True
	lr: 6.984990754803203e-05
	batch_size: 13
	weight_decay: 2.888048423418205e-06
	mmd_gamma: 7.302291555616863
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 01/26 04:36:49 | n_steps = 5001
[37m[36mINFO[0m[0m 01/26 04:36:49 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/26 04:36:49 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/26 04:36:49 | Target test envs = [[1]]
[37m[36mINFO[0m[0m 01/26 04:36:49 | 
[37m[36mINFO[0m[0m 01/26 04:36:49 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 01/26 04:36:49 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 01/26 04:36:49 | Batch sizes for each domain: [13, 0, 13, 13] (total=39)
[37m[36mINFO[0m[0m 01/26 04:36:49 | steps-per-epoch for each domain: 126.08, 102.77, 241.85 -> min = 102.77
[37m[36mINFO[0m[0m 01/26 04:36:51 | # of params = 23522375
[37m[36mINFO[0m[0m 01/26 04:37:24 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 01/26 04:37:24 | 0.146055    0.160256    0.193656    0.172128    1.945808    0.160464    0.139364    0.146055    0.160256    0.139970    0.110778    0.280534    0.266242    0           0.000000    1.980155    0.093688    1.307470    31.498527  
[37m[36mINFO[0m[0m 01/26 04:38:35 | 0.681770    0.683761    0.881367    0.895763    0.355857    0.826113    0.838631    0.681770    0.683761    0.965569    0.976048    0.852417    0.872611    200         1.946108    1.024380    0.013667    0.203206    30.818108  
[37m[36mINFO[0m[0m 01/26 04:39:50 | 0.722281    0.722222    0.941381    0.948653    0.181515    0.932886    0.933985    0.722281    0.722222    0.979042    0.982036    0.912214    0.929936    400         3.892216    0.284165    0.012100    0.216319    31.112760  
[37m[36mINFO[0m[0m 01/26 04:41:01 | 0.763326    0.764957    0.959751    0.944543    0.171171    0.952410    0.924205    0.763326    0.764957    0.987275    0.982036    0.939567    0.927389    600         5.838323    0.172252    0.009980    0.203872    30.302355  
[37m[36mINFO[0m[0m 01/26 04:42:13 | 0.775586    0.762821    0.955806    0.945370    0.179962    0.957901    0.936430    0.775586    0.762821    0.982036    0.985030    0.927481    0.914650    800         7.784431    0.134369    0.008573    0.201278    31.012197  
[37m[36mINFO[0m[0m 01/26 04:43:23 | 0.796375    0.788462    0.968223    0.946895    0.158507    0.959732    0.929095    0.796375    0.788462    0.995509    0.988024    0.949427    0.923567    1000        9.730539    0.118003    0.007434    0.200678    30.392435  
[37m[36mINFO[0m[0m 01/26 04:44:33 | 0.750533    0.743590    0.977916    0.951921    0.136124    0.981086    0.914425    0.750533    0.743590    0.994012    0.991018    0.958651    0.950318    1200        11.676647   0.088989    0.006961    0.201452    29.899362  
[37m[36mINFO[0m[0m 01/26 04:45:47 | 0.816098    0.820513    0.979711    0.959302    0.126597    0.976815    0.943765    0.816098    0.820513    0.994760    0.994012    0.967557    0.940127    1400        13.622754   0.075742    0.006269    0.215286    30.609780  
[37m[36mINFO[0m[0m 01/26 04:46:59 | 0.770256    0.771368    0.982332    0.962803    0.125401    0.984137    0.955990    0.770256    0.771368    0.996257    0.991018    0.966603    0.941401    1600        15.568862   0.062355    0.006077    0.203216    30.871557  
[37m[36mINFO[0m[0m 01/26 04:48:08 | 0.785181    0.779915    0.988052    0.967049    0.113277    0.987187    0.955990    0.785181    0.779915    0.997006    0.991018    0.979962    0.954140    1800        17.514970   0.063795    0.005626    0.194553    30.382896  
[37m[36mINFO[0m[0m 01/26 04:49:22 | 0.782516    0.799145    0.969646    0.949341    0.151622    0.949969    0.924205    0.782516    0.799145    0.987275    0.976048    0.971692    0.947771    2000        19.461078   0.059334    0.005180    0.207646    31.569928  
[37m[36mINFO[0m[0m 01/26 04:50:35 | 0.816098    0.805556    0.992765    0.972557    0.095928    0.993899    0.958435    0.816098    0.805556    0.997754    1.000000    0.986641    0.959236    2200        21.407186   0.046577    0.005086    0.209175    31.168267  
[37m[36mINFO[0m[0m 01/26 04:51:46 | 0.787846    0.777778    0.993857    0.971825    0.087599    0.992068    0.968215    0.787846    0.777778    1.000000    0.988024    0.989504    0.959236    2400        23.353293   0.049891    0.004864    0.198214    31.205375  
[37m[36mINFO[0m[0m 01/26 04:52:59 | 0.780917    0.779915    0.978138    0.950924    0.177185    0.975595    0.933985    0.780917    0.779915    0.994760    0.985030    0.964059    0.933758    2600        25.299401   0.037987    0.004608    0.206983    31.502804  
[37m[36mINFO[0m[0m 01/26 04:54:12 | 0.795309    0.788462    0.990664    0.970688    0.101210    0.992068    0.958435    0.795309    0.788462    0.995509    0.988024    0.984415    0.965605    2800        27.245509   0.040494    0.004362    0.208460    31.051582  
[37m[36mINFO[0m[0m 01/26 04:55:23 | 0.772921    0.769231    0.990922    0.968184    0.103990    0.991458    0.946210    0.772921    0.769231    0.996257    0.994012    0.985051    0.964331    3000        29.191617   0.033694    0.004285    0.202991    30.402129  
[37m[36mINFO[0m[0m 01/26 04:56:34 | 0.802239    0.784188    0.995888    0.970539    0.095377    0.995729    0.958435    0.802239    0.784188    0.999251    0.985030    0.992684    0.968153    3200        31.137725   0.028268    0.004053    0.204796    30.932190  
[37m[36mINFO[0m[0m 01/26 04:57:47 | 0.798507    0.799145    0.990590    0.961793    0.127461    0.987187    0.946210    0.798507    0.799145    0.994760    0.985030    0.989822    0.954140    3400        33.083832   0.023960    0.003771    0.200847    31.968563  
[37m[36mINFO[0m[0m 01/26 04:58:57 | 0.798507    0.784188    0.995957    0.970422    0.104942    0.995729    0.948655    0.798507    0.784188    0.998503    0.997006    0.993639    0.965605    3600        35.029940   0.028843    0.003738    0.198610    31.182847  
[37m[36mINFO[0m[0m 01/26 05:00:11 | 0.792111    0.775641    0.996011    0.968565    0.097776    0.999390    0.958435    0.792111    0.775641    0.998503    0.988024    0.990140    0.959236    3800        36.976048   0.026124    0.003837    0.204818    32.122445  
[37m[36mINFO[0m[0m 01/26 05:01:22 | 0.805437    0.777778    0.997533    0.975395    0.078112    0.999390    0.975550    0.805437    0.777778    0.999251    0.985030    0.993957    0.965605    4000        38.922156   0.022684    0.003705    0.204022    30.517314  
[37m[36mINFO[0m[0m 01/26 05:02:35 | 0.822495    0.794872    0.998533    0.978067    0.083910    0.998780    0.968215    0.822495    0.794872    1.000000    0.994012    0.996819    0.971975    4200        40.868263   0.018067    0.003567    0.206627    31.301143  
[37m[36mINFO[0m[0m 01/26 05:03:48 | 0.805970    0.779915    0.997791    0.970205    0.101059    0.998780    0.953545    0.805970    0.779915    1.000000    0.994012    0.994593    0.963057    4400        42.814371   0.018422    0.003294    0.202682    32.284191  
[37m[36mINFO[0m[0m 01/26 05:05:01 | 0.798507    0.767094    0.997481    0.977401    0.080865    0.998170    0.965770    0.798507    0.767094    1.000000    0.997006    0.994275    0.969427    4600        44.760479   0.014259    0.003235    0.205705    31.869105  
[37m[36mINFO[0m[0m 01/26 05:06:13 | 0.817164    0.805556    0.995453    0.971766    0.091188    0.993899    0.963325    0.817164    0.805556    0.998503    0.994012    0.993957    0.957962    4800        46.706587   0.024130    0.003145    0.201068    32.362862  
[37m[36mINFO[0m[0m 01/26 05:07:25 | 0.803838    0.777778    0.991123    0.958728    0.138430    0.992678    0.943765    0.803838    0.777778    0.998503    0.991018    0.982188    0.941401    5000        48.652695   0.023927    0.003185    0.199916    31.883268  
[37m[36mINFO[0m[0m 01/26 05:07:25 | Cumulative gradient change saved at train_output/PACS/CORAL/[1]/250126_04-36-49_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/26 05:07:27 | ---
[37m[36mINFO[0m[0m 01/26 05:07:27 | test-domain validation(oracle) = 81.610%
[37m[36mINFO[0m[0m 01/26 05:07:27 | training-domain validation(iid) = 82.249%
[37m[36mINFO[0m[0m 01/26 05:07:27 | last = 80.384%
[37m[36mINFO[0m[0m 01/26 05:07:27 | last (inD) = 95.873%
[37m[36mINFO[0m[0m 01/26 05:07:27 | training-domain validation (iid, inD) = 97.807%
[37m[36mINFO[0m[0m 01/26 05:07:27 | === Summary ===
[37m[36mINFO[0m[0m 01/26 05:07:27 | Command: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 1 --dataset PACS --trial_seed 1 --hparams_seed 13
[37m[36mINFO[0m[0m 01/26 05:07:27 | Unique name: 250126_04-36-49_resnet50_EVE
[37m[36mINFO[0m[0m 01/26 05:07:27 | Out path: train_output/PACS/CORAL/[1]/250126_04-36-49_resnet50_EVE
[37m[36mINFO[0m[0m 01/26 05:07:27 | Algorithm: CORAL
[37m[36mINFO[0m[0m 01/26 05:07:27 | Dataset: PACS
[37m[36mINFO[0m[0m 01/26 05:07:27 | Max test_in: 0.8225

[37m[36mINFO[0m[0m 01/27 10:23:45 | Command :: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 1 2 3 --dataset PACS --trial_seed 1 --hparams_seed 7
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 7
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/PACS/CORAL/[1, 2, 3]/250127_10-23-45_resnet50_EVE
	out_root: train_output/PACS/CORAL/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 1
	unique_name: 250127_10-23-45_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: GENIE
	freeze_bn: False
	pretrained: True
	lr: 0.00025471109765784857
	batch_size: 39
	weight_decay: 9.10622179414602e-05
	mmd_gamma: 8.495822994867268
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 01/27 10:23:45 | n_steps = 5001
[37m[36mINFO[0m[0m 01/27 10:23:45 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/27 10:23:45 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/27 10:23:45 | 
[37m[36mINFO[0m[0m 01/27 10:23:45 | Testenv name escaping te_C_P_S -> te_C_P_S
[37m[36mINFO[0m[0m 01/27 10:23:45 | Test envs = [1, 2, 3], name = te_C_P_S
[37m[36mINFO[0m[0m 01/27 10:23:45 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 01/27 10:23:45 | Batch sizes for each domain: [39, 0, 0, 0] (total=39)
[37m[36mINFO[0m[0m 01/27 10:23:45 | steps-per-epoch for each domain: 42.03 -> min = 42.03
[37m[36mINFO[0m[0m 01/27 10:23:46 | # of params = 23522375
[37m[36mINFO[0m[0m 01/27 10:24:12 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 01/27 10:24:12 | 0.177950    0.180082    0.257474    0.234719    1.867870    0.257474    0.234719    0.195629    0.185897    0.151198    0.146707    0.187023    0.207643    0           0.000000    2.077543    0.000000    1.226691    24.837062  
[37m[36mINFO[0m[0m 01/27 10:25:11 | 0.732787    0.734884    0.954851    0.914425    0.273661    0.954851    0.914425    0.648188    0.617521    0.965569    0.982036    0.584606    0.605096    200         4.758999    0.446784    0.000000    0.165009    25.958439  
[37m[36mINFO[0m[0m 01/27 10:26:09 | 0.774607    0.759998    0.985357    0.951100    0.181613    0.985357    0.951100    0.644456    0.613248    0.959581    0.952096    0.719784    0.714650    400         9.517999    0.121390    0.000000    0.169860    23.778044  
[37m[36mINFO[0m[0m 01/27 10:27:06 | 0.764989    0.770521    0.967053    0.938875    0.239317    0.967053    0.938875    0.702026    0.685897    0.945359    0.967066    0.647583    0.658599    600         14.276998   0.093508    0.000000    0.161493    23.573008  
[37m[36mINFO[0m[0m 01/27 10:28:02 | 0.699909    0.691696    0.980476    0.943765    0.212439    0.980476    0.943765    0.607143    0.542735    0.950599    0.982036    0.541985    0.550318    800         19.035998   0.068544    0.000000    0.160310    24.673752  
[37m[36mINFO[0m[0m 01/27 10:29:01 | 0.728671    0.712309    0.984137    0.931540    0.233320    0.984137    0.931540    0.646055    0.604701    0.961078    0.964072    0.578880    0.568153    1000        23.794997   0.037088    0.000000    0.159601    26.340438  
[37m[36mINFO[0m[0m 01/27 10:30:00 | 0.776463    0.764016    0.995729    0.943765    0.186739    0.995729    0.943765    0.745203    0.692308    0.950599    0.964072    0.633588    0.635669    1200        28.553996   0.036209    0.000000    0.165220    25.929034  
[37m[36mINFO[0m[0m 01/27 10:30:58 | 0.778806    0.755796    0.998170    0.955990    0.217627    0.998170    0.955990    0.745736    0.683761    0.966317    0.967066    0.624364    0.616561    1400        33.312996   0.016615    0.000000    0.160305    26.118846  
[37m[36mINFO[0m[0m 01/27 10:31:57 | 0.765729    0.758244    0.996339    0.951100    0.188104    0.996339    0.951100    0.676439    0.630342    0.961078    0.973054    0.659669    0.671338    1600        38.071995   0.021244    0.000000    0.169858    25.262408  
[37m[36mINFO[0m[0m 01/27 10:32:55 | 0.805168    0.788077    0.995729    0.953545    0.183337    0.995729    0.953545    0.741471    0.705128    0.955838    0.952096    0.718193    0.707006    1800        42.830995   0.023558    0.000000    0.166444    24.964540  
[37m[36mINFO[0m[0m 01/27 10:33:56 | 0.797281    0.795419    0.996949    0.946210    0.226970    0.996949    0.946210    0.712687    0.673077    0.947605    0.973054    0.731552    0.740127    2000        47.589994   0.031968    0.000000    0.163092    27.603427  
[37m[36mINFO[0m[0m 01/27 10:34:54 | 0.791687    0.782690    0.991458    0.929095    0.332844    0.991458    0.929095    0.739872    0.694444    0.938623    0.958084    0.696565    0.695541    2200        52.348993   0.019720    0.000000    0.166249    25.201868  
[37m[36mINFO[0m[0m 01/27 10:35:52 | 0.813273    0.819299    0.999390    0.958435    0.178538    0.999390    0.958435    0.739872    0.730769    0.961078    0.964072    0.738868    0.763057    2400        57.107993   0.015325    0.000000    0.166009    24.573359  
[37m[36mINFO[0m[0m 01/27 10:36:50 | 0.805100    0.801461    0.998780    0.951100    0.236989    0.998780    0.951100    0.759062    0.722222    0.958084    0.970060    0.698155    0.712102    2600        61.866992   0.015777    0.000000    0.163740    25.139222  
[37m[36mINFO[0m[0m 01/27 10:37:46 | 0.778814    0.767145    0.996949    0.953545    0.335097    0.996949    0.953545    0.726546    0.685897    0.956587    0.976048    0.653308    0.639490    2800        66.625991   0.004704    0.000000    0.161754    23.249950  
[37m[36mINFO[0m[0m 01/27 10:38:45 | 0.811546    0.802822    0.999390    0.955990    0.219132    0.999390    0.955990    0.728145    0.702991    0.958084    0.964072    0.748410    0.741401    3000        71.384991   0.007392    0.000000    0.162542    26.306009  
[37m[36mINFO[0m[0m 01/27 10:39:43 | 0.803013    0.800671    0.995729    0.946210    0.323376    0.995729    0.946210    0.713753    0.690171    0.961826    0.964072    0.733461    0.747771    3200        76.143990   0.004031    0.000000    0.162773    25.828615  
[37m[36mINFO[0m[0m 01/27 10:40:39 | 0.796948    0.794548    1.000000    0.946210    0.222244    1.000000    0.946210    0.746802    0.715812    0.970060    0.985030    0.673982    0.682803    3400        80.902990   0.017667    0.000000    0.162061    24.012689  
[37m[36mINFO[0m[0m 01/27 10:41:36 | 0.811711    0.808973    1.000000    0.948655    0.226795    1.000000    0.948655    0.760128    0.737179    0.958084    0.961078    0.716921    0.728662    3600        85.661989   0.004745    0.000000    0.162109    24.158271  
[37m[36mINFO[0m[0m 01/27 10:42:34 | 0.755414    0.734816    0.998170    0.943765    0.187427    0.998170    0.943765    0.671109    0.608974    0.953593    0.961078    0.641539    0.634395    3800        90.420988   0.023396    0.000000    0.161461    25.392715  
[37m[36mINFO[0m[0m 01/27 10:43:30 | 0.799194    0.793069    0.999390    0.941320    0.249481    0.999390    0.941320    0.737207    0.709402    0.958084    0.964072    0.702290    0.705732    4000        95.179988   0.016165    0.000000    0.160534    23.992710  
[37m[36mINFO[0m[0m 01/27 10:44:27 | 0.802587    0.799219    0.988408    0.941320    0.335221    0.988408    0.941320    0.760128    0.739316    0.955838    0.964072    0.691794    0.694268    4200        99.938987   0.005178    0.000000    0.155633    25.870710  
[37m[36mINFO[0m[0m 01/27 10:45:24 | 0.803366    0.796649    0.996339    0.936430    0.276932    0.996339    0.936430    0.764392    0.739316    0.953593    0.955090    0.692112    0.695541    4400        104.697987  0.004753    0.000000    0.161349    24.787158  
[37m[36mINFO[0m[0m 01/27 10:46:20 | 0.775565    0.763048    1.000000    0.953545    0.201818    1.000000    0.953545    0.691898    0.643162    0.955090    0.958084    0.679707    0.687898    4600        109.456986  0.000950    0.000000    0.162101    23.250720  
[37m[36mINFO[0m[0m 01/27 10:47:16 | 0.764830    0.759180    0.999390    0.943765    0.287461    0.999390    0.943765    0.766525    0.747863    0.959581    0.964072    0.568384    0.565605    4800        114.215985  0.004346    0.000000    0.161238    24.563041  
[37m[36mINFO[0m[0m 01/27 10:48:12 | 0.776971    0.760775    1.000000    0.955990    0.267519    1.000000    0.955990    0.751066    0.709402    0.951347    0.955090    0.628499    0.617834    5000        118.974985  0.001619    0.000000    0.160117    23.633288  
[37m[36mINFO[0m[0m 01/27 10:48:12 | Cumulative gradient change saved at train_output/PACS/CORAL/[1, 2, 3]/250127_10-23-45_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/27 10:48:14 | ---
[37m[36mINFO[0m[0m 01/27 10:48:14 | test-domain validation(oracle) = 81.327%
[37m[36mINFO[0m[0m 01/27 10:48:14 | training-domain validation(iid) = 81.327%
[37m[36mINFO[0m[0m 01/27 10:48:14 | last = 77.697%
[37m[36mINFO[0m[0m 01/27 10:48:14 | last (inD) = 95.599%
[37m[36mINFO[0m[0m 01/27 10:48:14 | training-domain validation (iid, inD) = 95.844%
[37m[36mINFO[0m[0m 01/27 10:48:14 | === Summary ===
[37m[36mINFO[0m[0m 01/27 10:48:14 | Command: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 1 2 3 --dataset PACS --trial_seed 1 --hparams_seed 7
[37m[36mINFO[0m[0m 01/27 10:48:14 | Unique name: 250127_10-23-45_resnet50_EVE
[37m[36mINFO[0m[0m 01/27 10:48:14 | Out path: train_output/PACS/CORAL/[1, 2, 3]/250127_10-23-45_resnet50_EVE
[37m[36mINFO[0m[0m 01/27 10:48:14 | Algorithm: CORAL
[37m[36mINFO[0m[0m 01/27 10:48:14 | Dataset: PACS

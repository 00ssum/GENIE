[37m[36mINFO[0m[0m 01/28 01:54:39 | Command :: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 0 2 3 --dataset PACS --trial_seed 0 --hparams_seed 7
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 7
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/PACS/CORAL/[0, 2, 3]/250128_01-54-39_resnet50_EVE
	out_root: train_output/PACS/CORAL/[0, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 2, 3]
	trial_seed: 0
	unique_name: 250128_01-54-39_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: GENIE
	freeze_bn: False
	pretrained: True
	lr: 1.6632780446310692e-05
	batch_size: 24
	weight_decay: 5.717289389191427e-06
	mmd_gamma: 3.812683559377669
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 01/28 01:54:39 | n_steps = 5001
[37m[36mINFO[0m[0m 01/28 01:54:39 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/28 01:54:39 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/28 01:54:39 | 
[37m[36mINFO[0m[0m 01/28 01:54:39 | Testenv name escaping te_A_P_S -> te_A_P_S
[37m[36mINFO[0m[0m 01/28 01:54:39 | Test envs = [0, 2, 3], name = te_A_P_S
[37m[36mINFO[0m[0m 01/28 01:54:39 | Train environments: [1], Test environments: [0, 2, 3]
[37m[36mINFO[0m[0m 01/28 01:54:39 | Batch sizes for each domain: [0, 24, 0, 0] (total=24)
[37m[36mINFO[0m[0m 01/28 01:54:39 | steps-per-epoch for each domain: 78.17 -> min = 78.17
[37m[36mINFO[0m[0m 01/28 01:54:40 | # of params = 23522375
[37m[36mINFO[0m[0m 01/28 01:55:09 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 01/28 01:55:09 | 0.152080    0.149470    0.208955    0.164530    1.940275    0.134228    0.112469    0.208955    0.164530    0.115269    0.125749    0.206743    0.210191    0           0.000000    2.102752    0.000000    1.232145    27.194876  
[37m[36mINFO[0m[0m 01/28 01:56:14 | 0.679624    0.658888    0.928571    0.933761    0.208249    0.635143    0.601467    0.928571    0.933761    0.812126    0.799401    0.591603    0.575796    200         2.558635    0.450822    0.000000    0.166222    31.576009  
[37m[36mINFO[0m[0m 01/28 01:57:19 | 0.760461    0.752283    0.971215    0.965812    0.163419    0.725442    0.713936    0.971215    0.965812    0.857784    0.856287    0.698155    0.686624    400         5.117271    0.158408    0.000000    0.136992    37.968946  
[37m[36mINFO[0m[0m 01/28 01:58:26 | 0.696384    0.683356    0.973348    0.967949    0.160139    0.677242    0.679707    0.973348    0.967949    0.851796    0.835329    0.560115    0.535032    600         7.675906    0.119054    0.000000    0.140109    38.169529  
[37m[36mINFO[0m[0m 01/28 01:59:30 | 0.774158    0.756498    0.988273    0.965812    0.113667    0.768761    0.755501    0.988273    0.965812    0.857784    0.850299    0.695929    0.663694    800         10.234542   0.096693    0.000000    0.153416    33.315274  
[37m[36mINFO[0m[0m 01/28 02:00:29 | 0.768672    0.747552    0.992537    0.972222    0.106879    0.746797    0.721271    0.992537    0.972222    0.894461    0.874251    0.664758    0.647134    1000        12.793177   0.050133    0.000000    0.165274    26.294969  
[37m[36mINFO[0m[0m 01/28 02:01:31 | 0.758652    0.758909    0.990938    0.972222    0.124422    0.761440    0.765281    0.990938    0.972222    0.861527    0.850299    0.652990    0.661146    1200        15.351812   0.039439    0.000000    0.168682    27.836595  
[37m[36mINFO[0m[0m 01/28 02:02:35 | 0.785227    0.775193    0.998401    0.967949    0.148583    0.769372    0.777506    0.998401    0.967949    0.888473    0.865269    0.697837    0.682803    1400        17.910448   0.019075    0.000000    0.143250    35.669871  
[37m[36mINFO[0m[0m 01/28 02:03:46 | 0.770818    0.757993    0.992004    0.963675    0.160461    0.694936    0.694377    0.992004    0.963675    0.892964    0.880240    0.724555    0.699363    1600        20.469083   0.025341    0.000000    0.157208    39.502897  
[37m[36mINFO[0m[0m 01/28 02:04:48 | 0.771027    0.775683    0.996802    0.967949    0.146908    0.709579    0.721271    0.996802    0.967949    0.865269    0.859281    0.738232    0.746497    1800        23.027719   0.030189    0.000000    0.144715    32.544060  
[37m[36mINFO[0m[0m 01/28 02:05:53 | 0.722114    0.715958    0.994136    0.974359    0.135485    0.730933    0.753056    0.994136    0.974359    0.847305    0.811377    0.588104    0.583439    2000        25.586354   0.037326    0.000000    0.127581    38.548765  
[37m[36mINFO[0m[0m 01/28 02:06:50 | 0.766496    0.773149    0.996802    0.967949    0.152291    0.718121    0.750611    0.996802    0.967949    0.868263    0.859281    0.713104    0.709554    2200        28.144989   0.021117    0.000000    0.125561    31.946924  
[37m[36mINFO[0m[0m 01/28 02:07:49 | 0.773702    0.774719    1.000000    0.974359    0.107721    0.717511    0.731051    1.000000    0.974359    0.876497    0.868263    0.727099    0.724841    2400        30.703625   0.015954    0.000000    0.159907    27.402020  
[37m[36mINFO[0m[0m 01/28 02:09:06 | 0.729446    0.747642    0.998401    0.970085    0.096602    0.693716    0.735941    0.998401    0.970085    0.828593    0.820359    0.666031    0.686624    2600        33.262260   0.034078    0.000000    0.199569    37.125731  
[37m[36mINFO[0m[0m 01/28 02:10:14 | 0.790109    0.792190    0.998934    0.978632    0.108666    0.762050    0.787286    0.998934    0.978632    0.890719    0.868263    0.717557    0.721019    2800        35.820896   0.005289    0.000000    0.144656    38.446331  
[37m[36mINFO[0m[0m 01/28 02:11:07 | 0.795524    0.797043    0.997868    0.976496    0.105522    0.780354    0.797066    0.997868    0.976496    0.885479    0.883234    0.720738    0.710828    3000        38.379531   0.007355    0.000000    0.123565    28.819343  
[37m[36mINFO[0m[0m 01/28 02:12:04 | 0.748823    0.742059    1.000000    0.976496    0.090889    0.724832    0.743276    1.000000    0.976496    0.813623    0.778443    0.708015    0.704459    3200        40.938166   0.007787    0.000000    0.151790    26.426391  
[37m[36mINFO[0m[0m 01/28 02:13:08 | 0.766165    0.746965    0.998934    0.976496    0.116567    0.724222    0.711491    0.998934    0.976496    0.844311    0.808383    0.729962    0.721019    3400        43.496802   0.005000    0.000000    0.170267    29.974877  
[37m[36mINFO[0m[0m 01/28 02:14:13 | 0.792824    0.786129    0.998934    0.980769    0.100552    0.734594    0.753056    0.998934    0.980769    0.875749    0.856287    0.768130    0.749045    3600        46.055437   0.015054    0.000000    0.148723    35.142374  
[37m[36mINFO[0m[0m 01/28 02:15:16 | 0.812034    0.810587    0.996802    0.972222    0.110782    0.765711    0.765281    0.996802    0.972222    0.876497    0.856287    0.793893    0.810191    3800        48.614072   0.030651    0.000000    0.135674    35.177619  
[37m[36mINFO[0m[0m 01/28 02:16:10 | 0.839137    0.830690    1.000000    0.978632    0.094567    0.816351    0.801956    1.000000    0.978632    0.904940    0.895210    0.796120    0.794904    4000        51.172708   0.009676    0.000000    0.134022    27.330073  
[37m[36mINFO[0m[0m 01/28 02:17:12 | 0.820800    0.819699    1.000000    0.985043    0.098028    0.805369    0.804401    1.000000    0.985043    0.876497    0.871257    0.780534    0.783439    4200        53.731343   0.001678    0.000000    0.174517    26.388529  
[37m[36mINFO[0m[0m 01/28 02:18:15 | 0.827225    0.827708    1.000000    0.985043    0.099391    0.811470    0.811736    1.000000    0.985043    0.892216    0.889222    0.777990    0.782166    4400        56.289979   0.000180    0.000000    0.137653    35.565414  
[37m[36mINFO[0m[0m 01/28 02:19:23 | 0.824113    0.819046    0.998401    0.970085    0.144327    0.780354    0.799511    0.998401    0.970085    0.897455    0.865269    0.794529    0.792357    4600        58.848614   0.002670    0.000000    0.145739    38.746013  
[37m[36mINFO[0m[0m 01/28 02:20:19 | 0.805995    0.797215    0.999467    0.982906    0.095450    0.775473    0.772616    0.999467    0.982906    0.877246    0.871257    0.765267    0.747771    4800        61.407249   0.000666    0.000000    0.144324    27.410383  
[37m[36mINFO[0m[0m 01/28 02:21:22 | 0.761382    0.767741    0.997335    0.970085    0.127991    0.732154    0.733496    0.997335    0.970085    0.854790    0.865269    0.697201    0.704459    5000        63.965885   0.005985    0.000000    0.173289    28.442486  
[37m[36mINFO[0m[0m 01/28 02:21:23 | Cumulative gradient change saved at train_output/PACS/CORAL/[0, 2, 3]/250128_01-54-39_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/28 02:21:24 | ---
[37m[36mINFO[0m[0m 01/28 02:21:24 | test-domain validation(oracle) = 83.914%
[37m[36mINFO[0m[0m 01/28 02:21:24 | training-domain validation(iid) = 82.080%
[37m[36mINFO[0m[0m 01/28 02:21:24 | last = 76.138%
[37m[36mINFO[0m[0m 01/28 02:21:24 | last (inD) = 97.009%
[37m[36mINFO[0m[0m 01/28 02:21:24 | training-domain validation (iid, inD) = 98.504%
[37m[36mINFO[0m[0m 01/28 02:21:24 | === Summary ===
[37m[36mINFO[0m[0m 01/28 02:21:24 | Command: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 0 2 3 --dataset PACS --trial_seed 0 --hparams_seed 7
[37m[36mINFO[0m[0m 01/28 02:21:24 | Unique name: 250128_01-54-39_resnet50_EVE
[37m[36mINFO[0m[0m 01/28 02:21:24 | Out path: train_output/PACS/CORAL/[0, 2, 3]/250128_01-54-39_resnet50_EVE
[37m[36mINFO[0m[0m 01/28 02:21:24 | Algorithm: CORAL
[37m[36mINFO[0m[0m 01/28 02:21:24 | Dataset: PACS

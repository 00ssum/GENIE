[37m[36mINFO[0m[0m 01/29 15:59:21 | Command :: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 0 1 3 --dataset PACS --trial_seed 1 --hparams_seed 11
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 11
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/PACS/CORAL/[0, 1, 3]/250129_15-59-21_resnet50_EVE
	out_root: train_output/PACS/CORAL/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 1
	unique_name: 250129_15-59-21_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: GENIE
	freeze_bn: False
	pretrained: True
	lr: 5.340583028754034e-05
	batch_size: 10
	weight_decay: 2.5000172438864113e-05
	mmd_gamma: 0.5908712349982728
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 01/29 15:59:21 | n_steps = 5001
[37m[36mINFO[0m[0m 01/29 15:59:21 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/29 15:59:21 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/29 15:59:21 | 
[37m[36mINFO[0m[0m 01/29 15:59:21 | Testenv name escaping te_A_C_S -> te_A_C_S
[37m[36mINFO[0m[0m 01/29 15:59:21 | Test envs = [0, 1, 3], name = te_A_C_S
[37m[36mINFO[0m[0m 01/29 15:59:21 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 01/29 15:59:21 | Batch sizes for each domain: [0, 0, 10, 0] (total=10)
[37m[36mINFO[0m[0m 01/29 15:59:21 | steps-per-epoch for each domain: 133.60 -> min = 133.60
[37m[36mINFO[0m[0m 01/29 15:59:22 | # of params = 23522375
[37m[36mINFO[0m[0m 01/29 15:59:57 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 01/29 15:59:57 | 0.100959    0.099800    0.109281    0.122754    2.059594    0.090299    0.088020    0.058635    0.053419    0.109281    0.122754    0.153944    0.157962    0           0.000000    2.171292    0.000000    1.650511    33.291902  
[37m[36mINFO[0m[0m 01/29 16:00:52 | 0.346782    0.336573    0.940120    0.970060    0.093061    0.561928    0.537897    0.220149    0.209402    0.940120    0.970060    0.258270    0.262420    200         1.497006    0.356190    0.000000    0.145396    25.028582  
[37m[36mINFO[0m[0m 01/29 16:01:52 | 0.458688    0.441927    0.946108    0.958084    0.116283    0.649786    0.613692    0.331557    0.331197    0.946108    0.958084    0.394720    0.380892    400         2.994012    0.132389    0.000000    0.152425    29.106477  
[37m[36mINFO[0m[0m 01/29 16:03:07 | 0.372283    0.370248    0.955838    0.952096    0.144602    0.625381    0.618582    0.279318    0.269231    0.955838    0.952096    0.212150    0.222930    600         4.491018    0.170658    0.000000    0.151196    44.937221  
[37m[36mINFO[0m[0m 01/29 16:04:07 | 0.327178    0.318478    0.945359    0.961078    0.133215    0.556437    0.537897    0.221215    0.220085    0.945359    0.961078    0.203880    0.197452    800         5.988024    0.136923    0.000000    0.140407    31.181521  
[37m[36mINFO[0m[0m 01/29 16:04:59 | 0.393184    0.366289    0.970060    0.973054    0.090424    0.611959    0.569682    0.318230    0.282051    0.970060    0.973054    0.249364    0.247134    1000        7.485030    0.118593    0.000000    0.130905    26.583815  
[37m[36mINFO[0m[0m 01/29 16:05:53 | 0.484557    0.474725    0.991766    0.991018    0.033918    0.624771    0.611247    0.445629    0.429487    0.991766    0.991018    0.383270    0.383439    1200        8.982036    0.095347    0.000000    0.143677    25.302272  
[37m[36mINFO[0m[0m 01/29 16:07:06 | 0.461430    0.434920    0.981287    0.976048    0.052546    0.649786    0.601467    0.400853    0.350427    0.981287    0.976048    0.333651    0.352866    1400        10.479042   0.080717    0.000000    0.175107    37.397173  
[37m[36mINFO[0m[0m 01/29 16:08:05 | 0.495458    0.473321    0.943114    0.937126    0.148421    0.543014    0.506112    0.514925    0.474359    0.943114    0.937126    0.428435    0.439490    1600        11.976048   0.116646    0.000000    0.131166    32.804305  
[37m[36mINFO[0m[0m 01/29 16:08:55 | 0.344467    0.326930    0.970060    0.970060    0.126647    0.550336    0.513447    0.255330    0.239316    0.970060    0.970060    0.227735    0.228025    1800        13.473054   0.041446    0.000000    0.120071    25.023709  
[37m[36mINFO[0m[0m 01/29 16:09:54 | 0.417386    0.406354    0.977545    0.976048    0.057971    0.615619    0.603912    0.323561    0.311966    0.977545    0.976048    0.312977    0.303185    2000        14.970060   0.072202    0.000000    0.113932    36.577794  
[37m[36mINFO[0m[0m 01/29 16:10:56 | 0.489368    0.471766    0.994012    0.982036    0.044161    0.617450    0.596577    0.430171    0.405983    0.994012    0.982036    0.420483    0.412739    2200        16.467066   0.039507    0.000000    0.167728    28.586235  
[37m[36mINFO[0m[0m 01/29 16:12:00 | 0.401466    0.384459    0.988024    0.979042    0.064158    0.605247    0.577017    0.311301    0.288462    0.988024    0.979042    0.287850    0.287898    2400        17.964072   0.048987    0.000000    0.175980    28.298744  
[37m[36mINFO[0m[0m 01/29 16:12:55 | 0.562242    0.546006    0.979790    0.976048    0.064653    0.641245    0.601467    0.537846    0.538462    0.979790    0.976048    0.507634    0.498089    2600        19.461078   0.070941    0.000000    0.117180    32.054749  
[37m[36mINFO[0m[0m 01/29 16:14:04 | 0.595971    0.591433    0.994760    0.997006    0.026680    0.699817    0.677262    0.555970    0.568376    0.994760    0.997006    0.532125    0.528662    2800        20.958084   0.023489    0.000000    0.140808    39.657670  
[37m[36mINFO[0m[0m 01/29 16:14:56 | 0.568571    0.551539    0.992515    0.988024    0.035343    0.699817    0.660147    0.550107    0.532051    0.992515    0.988024    0.455789    0.462420    3000        22.455090   0.041863    0.000000    0.131939    25.145828  
[37m[36mINFO[0m[0m 01/29 16:16:01 | 0.460905    0.436331    0.997006    0.979042    0.051965    0.668090    0.630807    0.372068    0.341880    0.997006    0.979042    0.342557    0.336306    3200        23.952096   0.065434    0.000000    0.167245    31.786324  
[37m[36mINFO[0m[0m 01/29 16:17:02 | 0.420759    0.402135    0.991766    0.988024    0.049323    0.682733    0.652812    0.332090    0.314103    0.991766    0.988024    0.247455    0.239490    3400        25.449102   0.025223    0.000000    0.110364    38.993492  
[37m[36mINFO[0m[0m 01/29 16:17:57 | 0.476410    0.449063    0.994760    0.982036    0.048076    0.661379    0.589242    0.410981    0.397436    0.994760    0.982036    0.356870    0.360510    3600        26.946108   0.029252    0.000000    0.141921    26.186073  
[37m[36mINFO[0m[0m 01/29 16:18:52 | 0.418753    0.389931    0.995509    0.979042    0.092917    0.645516    0.584352    0.336887    0.314103    0.995509    0.979042    0.273855    0.271338    3800        28.443114   0.010806    0.000000    0.150974    25.290142  
[37m[36mINFO[0m[0m 01/29 16:20:00 | 0.449907    0.427619    0.998503    0.988024    0.041493    0.696156    0.640587    0.373667    0.369658    0.998503    0.988024    0.279898    0.272611    4000        29.940120   0.015315    0.000000    0.157416    36.394500  
[37m[36mINFO[0m[0m 01/29 16:21:06 | 0.427693    0.401833    0.997754    0.985030    0.088643    0.674802    0.608802    0.351279    0.348291    0.997754    0.985030    0.256997    0.248408    4200        31.437126   0.001039    0.000000    0.138084    38.648250  
[37m[36mINFO[0m[0m 01/29 16:22:01 | 0.481299    0.471410    0.992515    0.976048    0.100653    0.597926    0.557457    0.446162    0.446581    0.992515    0.976048    0.399809    0.410191    4400        32.934132   0.010224    0.000000    0.135937    27.391514  
[37m[36mINFO[0m[0m 01/29 16:22:55 | 0.570572    0.575230    0.999251    0.985030    0.041276    0.652837    0.618582    0.506397    0.549145    0.999251    0.985030    0.552481    0.557962    4600        34.431138   0.042536    0.000000    0.133053    26.921232  
[37m[36mINFO[0m[0m 01/29 16:24:11 | 0.570030    0.561875    0.999251    0.991018    0.016360    0.693716    0.647922    0.489339    0.519231    0.999251    0.991018    0.527036    0.518471    4800        35.928144   0.001116    0.000000    0.155770    45.453701  
[37m[36mINFO[0m[0m 01/29 16:25:01 | 0.534377    0.534542    0.993263    0.973054    0.073113    0.676632    0.625917    0.417910    0.433761    0.993263    0.973054    0.508588    0.543949    5000        37.425150   0.013277    0.000000    0.119048    26.267421  
[37m[36mINFO[0m[0m 01/29 16:25:01 | Cumulative gradient change saved at train_output/PACS/CORAL/[0, 1, 3]/250129_15-59-21_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/29 16:25:03 | ---
[37m[36mINFO[0m[0m 01/29 16:25:03 | test-domain validation(oracle) = 59.597%
[37m[36mINFO[0m[0m 01/29 16:25:03 | training-domain validation(iid) = 59.597%
[37m[36mINFO[0m[0m 01/29 16:25:03 | last = 53.438%
[37m[36mINFO[0m[0m 01/29 16:25:03 | last (inD) = 97.305%
[37m[36mINFO[0m[0m 01/29 16:25:03 | training-domain validation (iid, inD) = 99.701%
[37m[36mINFO[0m[0m 01/29 16:25:03 | === Summary ===
[37m[36mINFO[0m[0m 01/29 16:25:03 | Command: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 0 1 3 --dataset PACS --trial_seed 1 --hparams_seed 11
[37m[36mINFO[0m[0m 01/29 16:25:03 | Unique name: 250129_15-59-21_resnet50_EVE
[37m[36mINFO[0m[0m 01/29 16:25:03 | Out path: train_output/PACS/CORAL/[0, 1, 3]/250129_15-59-21_resnet50_EVE
[37m[36mINFO[0m[0m 01/29 16:25:03 | Algorithm: CORAL
[37m[36mINFO[0m[0m 01/29 16:25:03 | Dataset: PACS

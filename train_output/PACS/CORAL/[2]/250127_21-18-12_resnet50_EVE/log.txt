[37m[36mINFO[0m[0m 01/27 21:18:12 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 2 --dataset PACS --trial_seed 2 --hparams_seed 9
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 9
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/PACS/CORAL/[2]/250127_21-18-12_resnet50_EVE
	out_root: train_output/PACS/CORAL/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 2
	unique_name: 250127_21-18-12_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: GENIE
	freeze_bn: False
	pretrained: True
	lr: 2.716671579524612e-05
	batch_size: 29
	weight_decay: 1.71368232883332e-06
	mmd_gamma: 1.254370045611671
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 01/27 21:18:12 | n_steps = 5001
[37m[36mINFO[0m[0m 01/27 21:18:12 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/27 21:18:12 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/27 21:18:12 | Target test envs = [[2]]
[37m[36mINFO[0m[0m 01/27 21:18:12 | 
[37m[36mINFO[0m[0m 01/27 21:18:12 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 01/27 21:18:12 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 01/27 21:18:12 | Batch sizes for each domain: [29, 29, 0, 29] (total=87)
[37m[36mINFO[0m[0m 01/27 21:18:12 | steps-per-epoch for each domain: 56.52, 64.69, 108.41 -> min = 56.52
[37m[36mINFO[0m[0m 01/27 21:18:13 | # of params = 23522375
[37m[36mINFO[0m[0m 01/27 21:18:47 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 01/27 21:18:47 | 0.107036    0.110778    0.193214    0.185244    1.885073    0.186699    0.180929    0.196695    0.177350    0.107036    0.110778    0.196247    0.197452    0           0.000000    1.959573    0.077312    1.267917    32.135648  
[37m[36mINFO[0m[0m 01/27 21:20:07 | 0.958832    0.964072    0.930642    0.921945    0.245242    0.942038    0.933985    0.925906    0.933761    0.958832    0.964072    0.923982    0.898089    200         3.538743    0.487628    0.045570    0.240234    32.374457  
[37m[36mINFO[0m[0m 01/27 21:21:24 | 0.975299    0.970060    0.970258    0.942067    0.179109    0.975595    0.953545    0.973348    0.940171    0.975299    0.970060    0.961832    0.932484    400         7.077486    0.145550    0.027782    0.222857    32.134184  
[37m[36mINFO[0m[0m 01/27 21:22:38 | 0.976048    0.973054    0.979275    0.942690    0.166604    0.985967    0.951100    0.979211    0.950855    0.976048    0.973054    0.972646    0.926115    600         10.616229   0.086608    0.023049    0.208329    31.759326  
[37m[36mINFO[0m[0m 01/27 21:23:55 | 0.974551    0.991018    0.985067    0.950497    0.156975    0.985357    0.951100    0.991471    0.961538    0.974551    0.991018    0.978372    0.938854    800         14.154973   0.060254    0.019073    0.226893    31.220366  
[37m[36mINFO[0m[0m 01/27 21:25:15 | 0.976048    0.979042    0.990625    0.958373    0.123665    0.987797    0.965770    0.996802    0.967949    0.976048    0.979042    0.987277    0.941401    1000        17.693716   0.049495    0.017110    0.232319    33.495565  
[37m[36mINFO[0m[0m 01/27 21:26:31 | 0.981287    0.979042    0.992882    0.952525    0.134956    0.997559    0.955990    0.992537    0.948718    0.981287    0.979042    0.988550    0.952866    1200        21.232459   0.030929    0.015503    0.209038    33.973728  
[37m[36mINFO[0m[0m 01/27 21:27:47 | 0.977545    0.985030    0.993490    0.953346    0.146436    0.995119    0.951100    0.996802    0.970085    0.977545    0.985030    0.988550    0.938854    1400        24.771202   0.026380    0.014134    0.223044    31.222625  
[37m[36mINFO[0m[0m 01/27 21:29:07 | 0.978293    0.991018    0.997628    0.962161    0.127670    0.997559    0.968215    0.997868    0.967949    0.978293    0.991018    0.997455    0.950318    1600        28.309945   0.020214    0.013179    0.234513    32.975278  
[37m[36mINFO[0m[0m 01/27 21:30:22 | 0.974551    0.988024    0.996000    0.952874    0.156275    0.995119    0.943765    0.997335    0.965812    0.974551    0.988024    0.995547    0.949045    1800        31.848688   0.017424    0.012147    0.205502    34.016631  
[37m[36mINFO[0m[0m 01/27 21:31:40 | 0.976796    0.976048    0.998321    0.963209    0.129861    0.998780    0.965770    1.000000    0.978632    0.976796    0.976048    0.996183    0.945223    2000        35.387431   0.015685    0.011016    0.228263    32.536514  
[37m[36mINFO[0m[0m 01/27 21:33:00 | 0.983533    0.988024    0.997877    0.957134    0.134280    0.997559    0.953545    0.998934    0.970085    0.983533    0.988024    0.997137    0.947771    2200        38.926174   0.014768    0.010732    0.237420    31.983326  
[37m[36mINFO[0m[0m 01/27 21:34:16 | 0.979042    0.997006    0.998484    0.961496    0.126411    0.999390    0.955990    0.997335    0.974359    0.979042    0.997006    0.998728    0.954140    2400        42.464918   0.009876    0.010044    0.212960    33.286274  
[37m[36mINFO[0m[0m 01/27 21:35:32 | 0.978293    0.991018    0.999089    0.959764    0.126660    0.999390    0.958435    0.999467    0.974359    0.978293    0.991018    0.998410    0.946497    2600        46.003661   0.008548    0.009301    0.215110    32.487019  
[37m[36mINFO[0m[0m 01/27 21:36:53 | 0.976048    0.973054    0.998115    0.959188    0.128358    0.998170    0.958435    0.998401    0.970085    0.976048    0.973054    0.997774    0.949045    2800        49.542404   0.009997    0.008973    0.243874    32.634998  
[37m[36mINFO[0m[0m 01/27 21:38:08 | 0.977545    0.979042    0.997585    0.961140    0.132962    0.995729    0.960880    0.998934    0.972222    0.977545    0.979042    0.998092    0.950318    3000        53.081147   0.010291    0.008567    0.208293    33.476260  
[37m[36mINFO[0m[0m 01/27 21:39:24 | 0.971557    0.982036    0.997284    0.962599    0.149258    0.996949    0.968215    0.998401    0.974359    0.971557    0.982036    0.996501    0.945223    3200        56.619890   0.008462    0.008131    0.221222    32.046763  
[37m[36mINFO[0m[0m 01/27 21:40:47 | 0.970808    0.985030    0.999398    0.958168    0.141292    1.000000    0.951100    0.999467    0.974359    0.970808    0.985030    0.998728    0.949045    3400        60.158633   0.009218    0.008318    0.246596    33.556597  
[37m[36mINFO[0m[0m 01/27 21:42:03 | 0.976048    0.979042    0.996788    0.955572    0.160351    0.994509    0.953545    0.998401    0.967949    0.976048    0.979042    0.997455    0.945223    3600        63.697376   0.010340    0.007804    0.216457    32.249518  
[37m[36mINFO[0m[0m 01/27 21:43:20 | 0.975299    0.979042    0.999195    0.963688    0.129810    0.999390    0.970660    0.999467    0.970085    0.975299    0.979042    0.998728    0.950318    3800        67.236120   0.007194    0.007612    0.220071    32.573677  
[37m[36mINFO[0m[0m 01/27 21:44:41 | 0.973054    0.994012    0.998602    0.958476    0.150173    0.998780    0.958435    0.998934    0.967949    0.973054    0.994012    0.998092    0.949045    4000        70.774863   0.005480    0.007324    0.238150    33.683109  
[37m[36mINFO[0m[0m 01/27 21:45:56 | 0.976796    0.979042    0.999610    0.963839    0.131828    1.000000    0.960880    0.999467    0.976496    0.976796    0.979042    0.999364    0.954140    4200        74.313606   0.005531    0.007158    0.219832    31.284189  
[37m[36mINFO[0m[0m 01/27 21:47:11 | 0.976796    0.967066    0.998161    0.958627    0.154787    0.997559    0.958435    0.999467    0.972222    0.976796    0.967066    0.997455    0.945223    4400        77.852349   0.005371    0.006725    0.211819    31.541360  
[37m[36mINFO[0m[0m 01/27 21:48:29 | 0.982036    0.982036    0.998957    0.965332    0.121194    0.998780    0.965770    1.000000    0.978632    0.982036    0.982036    0.998092    0.951592    4600        81.391092   0.005162    0.006699    0.230203    32.190651  
[37m[36mINFO[0m[0m 01/27 21:49:47 | 0.975299    0.979042    0.999716    0.964332    0.137966    1.000000    0.965770    0.999467    0.974359    0.975299    0.979042    0.999682    0.952866    4800        84.929835   0.004057    0.006344    0.235139    31.140699  
[37m[36mINFO[0m[0m 01/27 21:51:00 | 0.982784    0.979042    0.999822    0.967982    0.120046    1.000000    0.968215    0.999467    0.976496    0.982784    0.979042    1.000000    0.959236    5000        88.468578   0.004264    0.006123    0.203599    32.128264  
[37m[36mINFO[0m[0m 01/27 21:51:00 | Cumulative gradient change saved at train_output/PACS/CORAL/[2]/250127_21-18-12_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/27 21:51:02 | ---
[37m[36mINFO[0m[0m 01/27 21:51:02 | test-domain validation(oracle) = 97.904%
[37m[36mINFO[0m[0m 01/27 21:51:02 | training-domain validation(iid) = 98.278%
[37m[36mINFO[0m[0m 01/27 21:51:02 | last = 98.278%
[37m[36mINFO[0m[0m 01/27 21:51:02 | last (inD) = 96.798%
[37m[36mINFO[0m[0m 01/27 21:51:02 | training-domain validation (iid, inD) = 96.798%
[37m[36mINFO[0m[0m 01/27 21:51:02 | === Summary ===
[37m[36mINFO[0m[0m 01/27 21:51:02 | Command: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 2 --dataset PACS --trial_seed 2 --hparams_seed 9
[37m[36mINFO[0m[0m 01/27 21:51:02 | Unique name: 250127_21-18-12_resnet50_EVE
[37m[36mINFO[0m[0m 01/27 21:51:02 | Out path: train_output/PACS/CORAL/[2]/250127_21-18-12_resnet50_EVE
[37m[36mINFO[0m[0m 01/27 21:51:02 | Algorithm: CORAL
[37m[36mINFO[0m[0m 01/27 21:51:02 | Dataset: PACS
[37m[36mINFO[0m[0m 01/27 21:51:02 | Max test_in: 0.9835

[37m[36mINFO[0m[0m 01/31 08:47:56 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py GENIE_Mask1 config/resnet50_sgd.yaml --trial_seed 1 --hparams_seed 12 --algorithm GENIE_Mask --test_envs 1 --dataset PACS
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: GENIE_Mask
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: PACS
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 12
	in_domain: False
	model_save: None
	mpa: False
	name: GENIE_Mask1
	out_dir: train_output/PACS/GENIE_Mask/[1]/250131_08-47-56_GENIE_Mask1
	out_root: train_output/PACS/GENIE_Mask/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250131_08-47-56_GENIE_Mask1
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 3.0065625733392338e-05
	batch_size: 34
	weight_decay: 4.89485556145273e-06
	momentum: 0.8947990666023307
	convergence_rate: 0.07002445517972558
	moving_avg: 0.9276277614189328
	p: 0.2693854289835246
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[PACS] #envs=4, #classes=7
	env0: A (#2048)
	env1: C (#2344)
	env2: P (#1670)
	env3: S (#3929)

[37m[36mINFO[0m[0m 01/31 08:47:57 | n_steps = 5001
[37m[36mINFO[0m[0m 01/31 08:47:57 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/31 08:47:57 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/31 08:47:57 | Target test envs = [[1]]
[37m[36mINFO[0m[0m 01/31 08:47:57 | 
[37m[36mINFO[0m[0m 01/31 08:47:57 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 01/31 08:47:57 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 01/31 08:47:57 | Batch sizes for each domain: [34, 0, 34, 34] (total=102)
[37m[36mINFO[0m[0m 01/31 08:47:57 | steps-per-epoch for each domain: 48.21, 39.29, 92.47 -> min = 39.29
[37m[36mINFO[0m[0m 01/31 08:47:58 | # of params = 23522375
[37m[36mINFO[0m[0m 01/31 08:48:33 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/31 08:48:33 | 0.280384    0.320513    0.246764    0.263580    1.873019    0.197682    0.227384    0.280384    0.320513    0.311377    0.335329    0.231234    0.228025    0           0.000000    2.001022    1.398837    33.273795  
[37m[36mINFO[0m[0m 01/31 08:49:47 | 0.789446    0.775641    0.949701    0.942650    0.168599    0.934106    0.916870    0.789446    0.775641    0.978293    0.976048    0.936705    0.935032    200         5.089820    0.342417    0.217359    30.999837  
[37m[36mINFO[0m[0m 01/31 08:51:20 | 0.826759    0.826923    0.970170    0.946598    0.156214    0.970104    0.929095    0.826759    0.826923    0.986527    0.982036    0.953880    0.928662    400         10.179641   0.131545    0.248615    42.910338  
[37m[36mINFO[0m[0m 01/31 08:52:46 | 0.735075    0.728632    0.977700    0.953689    0.146950    0.974375    0.929095    0.735075    0.728632    0.996257    0.988024    0.962468    0.943949    600         15.269461   0.086791    0.251842    34.662592  
[37m[36mINFO[0m[0m 01/31 08:54:09 | 0.796908    0.801282    0.980562    0.966027    0.106412    0.979256    0.948655    0.796908    0.801282    0.995509    0.994012    0.966921    0.955414    800         20.359281   0.079294    0.260114    31.065515  
[37m[36mINFO[0m[0m 01/31 08:55:32 | 0.672708    0.673077    0.944292    0.911605    0.272862    0.917633    0.877751    0.672708    0.673077    0.982036    0.964072    0.933206    0.892994    1000        25.449102   0.057794    0.224362    37.833043  
[37m[36mINFO[0m[0m 01/31 08:56:52 | 0.807569    0.809829    0.981713    0.947496    0.164630    0.979866    0.943765    0.807569    0.809829    0.993263    0.970060    0.972010    0.928662    1200        30.538922   0.047806    0.231019    33.359194  
[37m[36mINFO[0m[0m 01/31 08:58:15 | 0.801706    0.803419    0.988211    0.962963    0.122408    0.973764    0.933985    0.801706    0.803419    0.998503    0.988024    0.992366    0.966879    1400        35.628743   0.042728    0.254095    32.798562  
[37m[36mINFO[0m[0m 01/31 08:59:51 | 0.792644    0.782051    0.982698    0.947884    0.168160    0.970714    0.926650    0.792644    0.782051    0.995509    0.973054    0.981870    0.943949    1600        40.718563   0.036241    0.262345    43.668848  
[37m[36mINFO[0m[0m 01/31 09:01:11 | 0.785714    0.767094    0.991510    0.963941    0.169827    0.992678    0.953545    0.785714    0.767094    0.997754    0.979042    0.984097    0.959236    1800        45.808383   0.029751    0.246879    30.071290  
[37m[36mINFO[0m[0m 01/31 09:02:29 | 0.783049    0.784188    0.989408    0.955857    0.158515    0.981696    0.916870    0.783049    0.784188    0.999251    0.994012    0.987277    0.956688    2000        50.898204   0.028153    0.225112    33.238814  
[37m[36mINFO[0m[0m 01/31 09:04:02 | 0.819829    0.805556    0.992228    0.963043    0.127870    0.990848    0.938875    0.819829    0.805556    0.992515    0.991018    0.993321    0.959236    2200        55.988024   0.029283    0.270103    39.341839  
[37m[36mINFO[0m[0m 01/31 09:05:25 | 0.770256    0.750000    0.984905    0.954173    0.204784    0.978646    0.933985    0.770256    0.750000    0.991018    0.982036    0.985051    0.946497    2400        61.077844   0.019202    0.259557    30.804542  
[37m[36mINFO[0m[0m 01/31 09:06:54 | 0.837420    0.826923    0.995860    0.961447    0.163779    0.995119    0.931540    0.837420    0.826923    0.998503    0.991018    0.993957    0.961783    2600        66.167665   0.025974    0.256881    37.158488  
[37m[36mINFO[0m[0m 01/31 09:08:15 | 0.811834    0.790598    0.996817    0.966855    0.150872    0.997559    0.948655    0.811834    0.790598    0.999251    0.985030    0.993639    0.966879    2800        71.257485   0.017405    0.236362    33.506447  
[37m[36mINFO[0m[0m 01/31 09:09:34 | 0.817697    0.792735    0.998005    0.963204    0.198804    0.998170    0.936430    0.817697    0.792735    0.997754    0.985030    0.998092    0.968153    3000        76.347305   0.009784    0.235645    31.746371  
[37m[36mINFO[0m[0m 01/31 09:11:07 | 0.845416    0.818376    0.996238    0.965305    0.153119    0.995729    0.948655    0.845416    0.818376    0.997754    0.988024    0.995229    0.959236    3200        81.437126   0.015786    0.258073    41.731037  
[37m[36mINFO[0m[0m 01/31 09:12:35 | 0.801173    0.788462    0.992132    0.950867    0.224993    0.988408    0.916870    0.801173    0.788462    0.996257    0.979042    0.991730    0.956688    3400        86.526946   0.009987    0.259107    36.610650  
[37m[36mINFO[0m[0m 01/31 09:13:54 | 0.798507    0.797009    0.997908    0.968336    0.128790    0.997559    0.953545    0.798507    0.797009    0.997754    0.982036    0.998410    0.969427    3600        91.616766   0.016798    0.236515    31.452909  
[37m[36mINFO[0m[0m 01/31 09:15:17 | 0.828891    0.809829    0.996470    0.960740    0.154218    0.996949    0.948655    0.828891    0.809829    0.998503    0.973054    0.993957    0.960510    3800        96.706587   0.012028    0.234197    35.302547  
[37m[36mINFO[0m[0m 01/31 09:16:43 | 0.784115    0.792735    0.997826    0.964295    0.156799    0.996339    0.938875    0.784115    0.792735    1.000000    0.982036    0.997137    0.971975    4000        101.796407  0.011222    0.256261    34.870165  
[37m[36mINFO[0m[0m 01/31 09:18:07 | 0.843817    0.833333    0.994043    0.954551    0.214379    0.990848    0.926650    0.843817    0.833333    0.997006    0.979042    0.994275    0.957962    4200        106.886228  0.015557    0.256939    32.546397  
[37m[36mINFO[0m[0m 01/31 09:19:35 | 0.832623    0.805556    0.999479    0.968336    0.121220    0.999390    0.953545    0.832623    0.805556    1.000000    0.982036    0.999046    0.969427    4400        111.976048  0.011507    0.257916    36.352852  
[37m[36mINFO[0m[0m 01/31 09:20:50 | 0.814499    0.786325    0.990020    0.948009    0.168381    0.987797    0.919315    0.814499    0.786325    0.996257    0.982036    0.986005    0.942675    4600        117.065868  0.012587    0.221737    31.121468  
[37m[36mINFO[0m[0m 01/31 09:22:13 | 0.835288    0.837607    0.998974    0.968094    0.116989    0.997559    0.951100    0.835288    0.837607    1.000000    0.985030    0.999364    0.968153    4800        122.155689  0.012688    0.241117    34.587263  
[37m[36mINFO[0m[0m 01/31 09:23:41 | 0.768657    0.750000    0.995627    0.956813    0.201404    0.993899    0.936430    0.768657    0.750000    0.997754    0.976048    0.995229    0.957962    5000        127.245509  0.014028    0.259709    36.142386  
[37m[36mINFO[0m[0m 01/31 09:23:41 | Cumulative gradient change saved at train_output/PACS/GENIE_Mask/[1]/250131_08-47-56_GENIE_Mask1/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/31 09:23:42 | ---
[37m[36mINFO[0m[0m 01/31 09:23:42 | test-domain validation(oracle) = 83.529%
[37m[36mINFO[0m[0m 01/31 09:23:42 | training-domain validation(iid) = 79.851%
[37m[36mINFO[0m[0m 01/31 09:23:42 | last = 76.866%
[37m[36mINFO[0m[0m 01/31 09:23:42 | last (inD) = 95.681%
[37m[36mINFO[0m[0m 01/31 09:23:42 | training-domain validation (iid, inD) = 96.834%
[37m[36mINFO[0m[0m 01/31 09:23:42 | === Summary ===
[37m[36mINFO[0m[0m 01/31 09:23:42 | Command: /jsm0707/DomainBed/Large-scale/train_all.py GENIE_Mask1 config/resnet50_sgd.yaml --trial_seed 1 --hparams_seed 12 --algorithm GENIE_Mask --test_envs 1 --dataset PACS
[37m[36mINFO[0m[0m 01/31 09:23:42 | Unique name: 250131_08-47-56_GENIE_Mask1
[37m[36mINFO[0m[0m 01/31 09:23:42 | Out path: train_output/PACS/GENIE_Mask/[1]/250131_08-47-56_GENIE_Mask1
[37m[36mINFO[0m[0m 01/31 09:23:42 | Algorithm: GENIE_Mask
[37m[36mINFO[0m[0m 01/31 09:23:42 | Dataset: PACS
[37m[36mINFO[0m[0m 01/31 09:23:42 | Max test_in: 0.8454

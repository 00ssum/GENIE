[37m[36mINFO[0m[0m 01/26 17:15:23 | Command :: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm SAM --test_envs 0 1 3 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: SAM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/OfficeHome/SAM/[0, 1, 3]/250126_17-15-23_resnet50_sgd
	out_root: train_output/OfficeHome/SAM/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 0
	unique_name: 250126_17-15-23_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	rho: 0.05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 01/26 17:15:23 | n_steps = 5001
[37m[36mINFO[0m[0m 01/26 17:15:23 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/26 17:15:23 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/26 17:15:23 | 
[37m[36mINFO[0m[0m 01/26 17:15:23 | Testenv name escaping te_A_C_R -> te_A_C_R
[37m[36mINFO[0m[0m 01/26 17:15:23 | Test envs = [0, 1, 3], name = te_A_C_R
[37m[36mINFO[0m[0m 01/26 17:15:23 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 01/26 17:15:23 | Batch sizes for each domain: [0, 0, 32, 0] (total=32)
[37m[36mINFO[0m[0m 01/26 17:15:23 | steps-per-epoch for each domain: 111.00 -> min = 111.00
[37m[36mINFO[0m[0m 01/26 17:15:24 | # of params = 23641217
[37m[36mINFO[0m[0m 01/26 17:17:14 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/26 17:17:14 | 0.017681    0.016577    0.012950    0.015784    4.259435    0.020082    0.026804    0.016896    0.014891    0.012950    0.015784    0.016064    0.008037    0           0.000000    4.773594    0.999722    108.771983 
[37m[36mINFO[0m[0m 01/26 17:19:43 | 0.035711    0.029422    0.051239    0.047351    4.102409    0.033471    0.030928    0.034937    0.028637    0.051239    0.047351    0.038726    0.028703    200         1.801802    4.355087    0.169491    114.582092 
[37m[36mINFO[0m[0m 01/26 17:22:06 | 0.046521    0.043110    0.084741    0.077790    4.052920    0.043254    0.032990    0.045533    0.043528    0.084741    0.077790    0.050775    0.052813    400         3.603604    4.208645    0.164247    110.813805 
[37m[36mINFO[0m[0m 01/26 17:24:28 | 0.061285    0.064739    0.131475    0.116122    3.976318    0.052008    0.047423    0.063001    0.071019    0.131475    0.116122    0.068847    0.075775    600         5.405405    4.149790    0.160078    108.939738 
[37m[36mINFO[0m[0m 01/26 17:26:46 | 0.096835    0.103044    0.216216    0.198422    3.825501    0.074665    0.065979    0.096506    0.106529    0.216216    0.198422    0.119334    0.136625    800         7.207207    4.069249    0.157879    106.797599 
[37m[36mINFO[0m[0m 01/26 17:29:11 | 0.146858    0.146692    0.294200    0.288613    3.411159    0.111226    0.094845    0.148339    0.152348    0.294200    0.288613    0.181010    0.192882    1000        9.009009    3.891660    0.160878    112.362067 
[37m[36mINFO[0m[0m 01/26 17:31:30 | 0.273765    0.262738    0.516047    0.531003    2.281339    0.222451    0.202062    0.238259    0.230241    0.516047    0.531003    0.360585    0.355913    1200        10.810811   3.376126    0.158799    106.358826 
[37m[36mINFO[0m[0m 01/26 17:33:54 | 0.433363    0.419979    0.759291    0.737317    1.114301    0.371267    0.362887    0.354525    0.334479    0.759291    0.737317    0.574297    0.562572    1400        12.612613   2.414700    0.156760    112.609052 
[37m[36mINFO[0m[0m 01/26 17:36:13 | 0.485785    0.481672    0.841498    0.815107    0.768049    0.438208    0.430928    0.376289    0.364261    0.841498    0.815107    0.642857    0.649828    1600        14.414414   1.696011    0.165589    106.203227 
[37m[36mINFO[0m[0m 01/26 17:38:34 | 0.511536    0.520573    0.873311    0.845547    0.623328    0.452111    0.474227    0.402635    0.397480    0.873311    0.845547    0.679862    0.690011    1800        16.216216   1.449331    0.162332    108.176853 
[37m[36mINFO[0m[0m 01/26 17:40:56 | 0.523983    0.534557    0.898367    0.853439    0.573241    0.471679    0.498969    0.409221    0.402062    0.898367    0.853439    0.691050    0.702641    2000        18.018018   1.245555    0.164477    108.585138 
[37m[36mINFO[0m[0m 01/26 17:43:11 | 0.538401    0.538225    0.916667    0.868095    0.504282    0.484552    0.503093    0.424399    0.405498    0.916667    0.868095    0.706254    0.706085    2200        19.819820   1.120962    0.157321    102.899099 
[37m[36mINFO[0m[0m 01/26 17:45:35 | 0.541836    0.553351    0.926802    0.882751    0.477954    0.487127    0.527835    0.433849    0.419244    0.926802    0.882751    0.704532    0.712974    2400        21.621622   1.037776    0.166976    110.935805 
[37m[36mINFO[0m[0m 01/26 17:48:03 | 0.546842    0.555879    0.935811    0.890643    0.436823    0.491246    0.521649    0.435853    0.422680    0.935811    0.890643    0.713425    0.723307    2600        23.423423   0.933662    0.170977    112.996806 
[37m[36mINFO[0m[0m 01/26 17:50:28 | 0.549949    0.559848    0.943412    0.894025    0.421076    0.497425    0.527835    0.443299    0.430699    0.943412    0.894025    0.709122    0.721010    2800        25.225225   0.886696    0.167639    111.031079 
[37m[36mINFO[0m[0m 01/26 17:52:50 | 0.552188    0.563361    0.947635    0.892897    0.403315    0.493821    0.536082    0.446449    0.432990    0.947635    0.892897    0.716294    0.721010    3000        27.027027   0.806394    0.166312    108.485248 
[37m[36mINFO[0m[0m 01/26 17:55:16 | 0.558128    0.562214    0.952140    0.898534    0.381171    0.501030    0.536082    0.448454    0.431844    0.952140    0.898534    0.724900    0.718714    3200        28.828829   0.775676    0.172645    111.112375 
[37m[36mINFO[0m[0m 01/26 17:57:42 | 0.556449    0.565969    0.955518    0.898534    0.369764    0.497425    0.527835    0.446163    0.434135    0.955518    0.898534    0.725760    0.735936    3400        30.630631   0.717222    0.161597    114.314473 
[37m[36mINFO[0m[0m 01/26 18:00:04 | 0.559276    0.564742    0.961430    0.903044    0.355039    0.498455    0.540206    0.451031    0.423826    0.961430    0.903044    0.728342    0.730195    3600        32.432432   0.687029    0.164279    107.899215 
[37m[36mINFO[0m[0m 01/26 18:02:27 | 0.564562    0.561073    0.961430    0.906426    0.346817    0.515448    0.536082    0.444444    0.421535    0.961430    0.906426    0.733792    0.725603    3800        34.234234   0.655664    0.175877    108.409973 
[37m[36mINFO[0m[0m 01/26 18:04:50 | 0.551119    0.552521    0.961712    0.900789    0.349653    0.494336    0.509278    0.441867    0.421535    0.961712    0.900789    0.717154    0.726751    4000        36.036036   0.620603    0.176634    106.925814 
[37m[36mINFO[0m[0m 01/26 18:07:13 | 0.561680    0.568178    0.971002    0.907554    0.321819    0.505664    0.540206    0.448740    0.435281    0.971002    0.907554    0.730637    0.729047    4200        37.837838   0.612121    0.187119    106.383208 
[37m[36mINFO[0m[0m 01/26 18:09:40 | 0.564562    0.571234    0.973255    0.907554    0.319108    0.507724    0.540206    0.456472    0.442153    0.973255    0.907554    0.729489    0.731343    4400        39.639640   0.584378    0.190926    108.740991 
[37m[36mINFO[0m[0m 01/26 18:12:04 | 0.558188    0.571774    0.975507    0.918828    0.311749    0.499485    0.536082    0.446163    0.441008    0.975507    0.918828    0.728916    0.738232    4600        41.441441   0.567098    0.167231    109.403139 
[37m[36mINFO[0m[0m 01/26 18:14:32 | 0.559580    0.568487    0.973255    0.918828    0.304099    0.503090    0.542268    0.447308    0.429553    0.973255    0.918828    0.728342    0.733639    4800        43.243243   0.536885    0.165750    114.892759 
[37m[36mINFO[0m[0m 01/26 18:17:01 | 0.555689    0.565126    0.974381    0.907554    0.310275    0.494851    0.540206    0.442726    0.422680    0.974381    0.907554    0.729489    0.732491    5000        45.045045   0.510968    0.161997    116.863250 
[37m[36mINFO[0m[0m 01/26 18:17:01 | Cumulative gradient change saved at train_output/OfficeHome/SAM/[0, 1, 3]/250126_17-15-23_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/26 18:17:03 | ---
[37m[36mINFO[0m[0m 01/26 18:17:03 | test-domain validation(oracle) = 55.819%
[37m[36mINFO[0m[0m 01/26 18:17:03 | training-domain validation(iid) = 55.819%
[37m[36mINFO[0m[0m 01/26 18:17:03 | last = 55.569%
[37m[36mINFO[0m[0m 01/26 18:17:03 | last (inD) = 90.755%
[37m[36mINFO[0m[0m 01/26 18:17:03 | training-domain validation (iid, inD) = 91.883%
[37m[36mINFO[0m[0m 01/26 18:17:03 | === Summary ===
[37m[36mINFO[0m[0m 01/26 18:17:03 | Command: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm SAM --test_envs 0 1 3 --dataset OfficeHome
[37m[36mINFO[0m[0m 01/26 18:17:03 | Unique name: 250126_17-15-23_resnet50_sgd
[37m[36mINFO[0m[0m 01/26 18:17:03 | Out path: train_output/OfficeHome/SAM/[0, 1, 3]/250126_17-15-23_resnet50_sgd
[37m[36mINFO[0m[0m 01/26 18:17:03 | Algorithm: SAM
[37m[36mINFO[0m[0m 01/26 18:17:03 | Dataset: OfficeHome

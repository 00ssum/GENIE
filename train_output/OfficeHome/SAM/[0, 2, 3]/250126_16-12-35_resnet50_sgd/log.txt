[37m[36mINFO[0m[0m 01/26 16:12:35 | Command :: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm SAM --test_envs 0 2 3 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: SAM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/OfficeHome/SAM/[0, 2, 3]/250126_16-12-35_resnet50_sgd
	out_root: train_output/OfficeHome/SAM/[0, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 2, 3]
	trial_seed: 0
	unique_name: 250126_16-12-35_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	rho: 0.05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 01/26 16:12:35 | n_steps = 5001
[37m[36mINFO[0m[0m 01/26 16:12:35 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/26 16:12:35 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/26 16:12:35 | 
[37m[36mINFO[0m[0m 01/26 16:12:35 | Testenv name escaping te_A_P_R -> te_A_P_R
[37m[36mINFO[0m[0m 01/26 16:12:35 | Test envs = [0, 2, 3], name = te_A_P_R
[37m[36mINFO[0m[0m 01/26 16:12:35 | Train environments: [1], Test environments: [0, 2, 3]
[37m[36mINFO[0m[0m 01/26 16:12:35 | Batch sizes for each domain: [0, 32, 0, 0] (total=32)
[37m[36mINFO[0m[0m 01/26 16:12:35 | steps-per-epoch for each domain: 109.12 -> min = 109.12
[37m[36mINFO[0m[0m 01/26 16:12:36 | # of params = 23641217
[37m[36mINFO[0m[0m 01/26 16:14:23 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/26 16:14:23 | 0.016178    0.016875    0.016896    0.014891    4.233290    0.020082    0.026804    0.016896    0.014891    0.012387    0.015784    0.016064    0.008037    0           0.000000    4.572393    1.173814    106.053349 
[37m[36mINFO[0m[0m 01/26 16:16:46 | 0.026395    0.029244    0.043242    0.032073    4.121532    0.025747    0.030928    0.043242    0.032073    0.025901    0.032694    0.027539    0.024110    200         1.832761    4.344304    0.168205    109.033820 
[37m[36mINFO[0m[0m 01/26 16:19:13 | 0.043071    0.042023    0.069301    0.063001    4.100903    0.039650    0.045361    0.069301    0.063001    0.042230    0.043968    0.047332    0.036739    400         3.665521    4.230310    0.171550    112.341220 
[37m[36mINFO[0m[0m 01/26 16:21:46 | 0.054518    0.054674    0.090206    0.079038    4.081055    0.048404    0.053608    0.090206    0.079038    0.054336    0.051860    0.060815    0.058553    600         5.498282    4.194615    0.195868    113.539961 
[37m[36mINFO[0m[0m 01/26 16:24:16 | 0.070137    0.071756    0.116552    0.105384    4.053586    0.067971    0.063918    0.116552    0.105384    0.067568    0.073281    0.074871    0.078071    800         7.331042    4.167384    0.178269    113.836913 
[37m[36mINFO[0m[0m 01/26 16:26:44 | 0.082509    0.080581    0.144903    0.129439    4.016975    0.083419    0.072165    0.144903    0.129439    0.074606    0.081172    0.089501    0.088404    1000        9.163803    4.144359    0.172162    113.678591 
[37m[36mINFO[0m[0m 01/26 16:29:14 | 0.094269    0.097476    0.165521    0.135166    3.964311    0.094233    0.098969    0.165521    0.135166    0.085304    0.093574    0.103270    0.099885    1200        10.996564   4.107192    0.166495    116.684455 
[37m[36mINFO[0m[0m 01/26 16:31:43 | 0.106747    0.111375    0.197595    0.168385    3.881742    0.108651    0.113402    0.197595    0.168385    0.096847    0.109357    0.114745    0.111366    1400        12.829324   4.055630    0.169269    114.130035 
[37m[36mINFO[0m[0m 01/26 16:34:03 | 0.121553    0.133984    0.203036    0.172967    3.732890    0.129763    0.140206    0.203036    0.172967    0.108390    0.126268    0.126506    0.135476    1600        14.662085   3.977294    0.160896    108.200478 
[37m[36mINFO[0m[0m 01/26 16:36:24 | 0.174333    0.189378    0.272050    0.227950    3.443491    0.166838    0.181443    0.272050    0.227950    0.173142    0.199549    0.183018    0.187141    1800        16.494845   3.819167    0.158974    108.486274 
[37m[36mINFO[0m[0m 01/26 16:38:51 | 0.268538    0.257655    0.385166    0.336770    2.915889    0.243048    0.226804    0.385166    0.336770    0.271115    0.268320    0.291452    0.277842    2000        18.327606   3.548943    0.165550    113.859942 
[37m[36mINFO[0m[0m 01/26 16:41:11 | 0.364630    0.351502    0.508305    0.430699    2.299462    0.326982    0.286598    0.508305    0.430699    0.372185    0.384442    0.394722    0.383467    2200        20.160367   3.103392    0.149801    110.139764 
[37m[36mINFO[0m[0m 01/26 16:43:41 | 0.443031    0.438840    0.620561    0.517755    1.856383    0.399073    0.393814    0.620561    0.517755    0.453829    0.457723    0.476190    0.464983    2400        21.993127   2.690411    0.168415    115.440377 
[37m[36mINFO[0m[0m 01/26 16:46:01 | 0.493370    0.484825    0.699026    0.615120    1.562356    0.429454    0.435052    0.699026    0.615120    0.506194    0.505073    0.544464    0.514351    2600        23.825888   2.266711    0.165960    107.134907 
[37m[36mINFO[0m[0m 01/26 16:48:32 | 0.515143    0.505863    0.745991    0.647194    1.428719    0.451081    0.451546    0.745991    0.647194    0.531813    0.529876    0.562536    0.536165    2800        25.658648   2.060791    0.164418    117.147080 
[37m[36mINFO[0m[0m 01/26 16:51:04 | 0.540220    0.536683    0.778637    0.668958    1.303249    0.474253    0.494845    0.778637    0.668958    0.554899    0.541150    0.591509    0.574053    3000        27.491409   1.830230    0.158131    120.349834 
[37m[36mINFO[0m[0m 01/26 16:53:34 | 0.548541    0.543499    0.801833    0.673540    1.226235    0.479403    0.482474    0.801833    0.673540    0.568975    0.567080    0.597246    0.580941    3200        29.324170   1.703105    0.177373    114.400921 
[37m[36mINFO[0m[0m 01/26 16:56:04 | 0.553768    0.548372    0.821879    0.686140    1.171282    0.474253    0.496907    0.821879    0.686140    0.574887    0.556933    0.612163    0.591274    3400        31.156930   1.562453    0.185664    112.095203 
[37m[36mINFO[0m[0m 01/26 16:58:39 | 0.566042    0.565659    0.837915    0.696449    1.126174    0.499485    0.521649    0.837915    0.696449    0.583896    0.580609    0.614745    0.594719    3600        32.989691   1.451571    0.193003    116.238968 
[37m[36mINFO[0m[0m 01/26 17:01:08 | 0.560554    0.563781    0.856529    0.713631    1.093428    0.479403    0.511340    0.856529    0.713631    0.589809    0.576099    0.612450    0.603904    3800        34.822451   1.382196    0.179649    113.082176 
[37m[36mINFO[0m[0m 01/26 17:03:35 | 0.572175    0.577213    0.862257    0.725086    1.056486    0.488671    0.517526    0.862257    0.725086    0.601633    0.594138    0.626219    0.619977    4000        36.655212   1.292290    0.189020    108.818917 
[37m[36mINFO[0m[0m 01/26 17:05:58 | 0.575398    0.578283    0.876289    0.723940    1.066093    0.493821    0.519588    0.876289    0.723940    0.605293    0.594138    0.627080    0.621125    4200        38.487973   1.229004    0.175172    107.336065 
[37m[36mINFO[0m[0m 01/26 17:08:20 | 0.581007    0.582302    0.886025    0.734250    1.020994    0.496395    0.523711    0.886025    0.734250    0.610079    0.599775    0.636546    0.623421    4400        40.320733   1.217458    0.161211    109.319244 
[37m[36mINFO[0m[0m 01/26 17:10:38 | 0.576633    0.577894    0.889462    0.738832    1.000320    0.498970    0.519588    0.889462    0.738832    0.605856    0.595265    0.625072    0.618829    4600        42.153494   1.117987    0.167597    104.659796 
[37m[36mINFO[0m[0m 01/26 17:12:57 | 0.578072    0.584797    0.895762    0.745704    0.984759    0.493821    0.527835    0.895762    0.745704    0.605856    0.604284    0.634538    0.622273    4800        43.986254   1.049834    0.159776    107.079970 
[37m[36mINFO[0m[0m 01/26 17:15:17 | 0.586278    0.591793    0.903494    0.744559    0.972459    0.506179    0.534021    0.903494    0.744559    0.609797    0.611048    0.642857    0.630310    5000        45.819015   1.038858    0.161368    107.822159 
[37m[36mINFO[0m[0m 01/26 17:15:18 | Cumulative gradient change saved at train_output/OfficeHome/SAM/[0, 2, 3]/250126_16-12-35_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/26 17:15:19 | ---
[37m[36mINFO[0m[0m 01/26 17:15:19 | test-domain validation(oracle) = 58.628%
[37m[36mINFO[0m[0m 01/26 17:15:19 | training-domain validation(iid) = 57.807%
[37m[36mINFO[0m[0m 01/26 17:15:19 | last = 58.628%
[37m[36mINFO[0m[0m 01/26 17:15:19 | last (inD) = 74.456%
[37m[36mINFO[0m[0m 01/26 17:15:19 | training-domain validation (iid, inD) = 74.570%
[37m[36mINFO[0m[0m 01/26 17:15:19 | === Summary ===
[37m[36mINFO[0m[0m 01/26 17:15:19 | Command: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm SAM --test_envs 0 2 3 --dataset OfficeHome
[37m[36mINFO[0m[0m 01/26 17:15:19 | Unique name: 250126_16-12-35_resnet50_sgd
[37m[36mINFO[0m[0m 01/26 17:15:19 | Out path: train_output/OfficeHome/SAM/[0, 2, 3]/250126_16-12-35_resnet50_sgd
[37m[36mINFO[0m[0m 01/26 17:15:19 | Algorithm: SAM
[37m[36mINFO[0m[0m 01/26 17:15:19 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 03/18 22:22:12 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 0 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/OfficeHome/ERM/[0]/250318_22-22-12_resnet50_Sign_GENIE
	out_root: train_output/OfficeHome/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250318_22-22-12_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5.0781288859686544e-05
	batch_size: 44
	weight_decay: 0.00046410133598234803
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/18 22:22:12 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 22:22:12 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 22:22:12 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 22:22:12 | 
[37m[36mINFO[0m[0m 03/18 22:22:12 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/18 22:22:12 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/18 22:22:12 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/18 22:22:12 | Batch sizes for each domain: [0, 44, 44, 44] (total=132)
[37m[36mINFO[0m[0m 03/18 22:22:12 | steps-per-epoch for each domain: 79.36, 80.73, 79.23 -> min = 79.23
[37m[36mINFO[0m[0m 03/18 22:22:14 | # of params = 23641217
[37m[36mINFO[0m[0m 03/18 22:24:13 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 22:24:13 | 0.017508    0.020619    0.014251    0.012178    4.226969    0.017508    0.020619    0.012600    0.008018    0.013514    0.010147    0.016638    0.018370    0           0.000000    4.252323    1.500146    117.562280 
[37m[36mINFO[0m[0m 03/18 22:28:39 | 0.614830    0.618557    0.831272    0.777301    0.839594    0.614830    0.618557    0.767468    0.682703    0.878097    0.846674    0.848250    0.802526    200         2.524383    1.414262    0.729245    120.216165 
[37m[36mINFO[0m[0m 03/18 22:33:10 | 0.612255    0.643299    0.891628    0.803132    0.800306    0.612255    0.643299    0.857961    0.736541    0.927365    0.871477    0.889558    0.801378    400         5.048766    0.472237    0.759408    119.326123 
[37m[36mINFO[0m[0m 03/18 22:37:38 | 0.623584    0.635052    0.925464    0.807673    0.812920    0.623584    0.635052    0.902921    0.722795    0.940597    0.881623    0.932874    0.818599    600         7.573150    0.300390    0.741681    119.627869 
[37m[36mINFO[0m[0m 03/18 22:42:06 | 0.617405    0.649485    0.955276    0.821731    0.807159    0.617405    0.649485    0.935853    0.746850    0.971284    0.895152    0.958692    0.823192    800         10.097533   0.209372    0.742893    119.879064 
[37m[36mINFO[0m[0m 03/18 22:46:36 | 0.627188    0.639175    0.959767    0.813782    0.804039    0.627188    0.639175    0.944444    0.750286    0.971002    0.880496    0.963855    0.810563    1000        12.621916   0.157789    0.746300    120.257847 
[37m[36mINFO[0m[0m 03/18 22:51:11 | 0.615345    0.614433    0.971838    0.827811    0.818545    0.615345    0.614433    0.954754    0.758305    0.981700    0.900789    0.979059    0.824340    1200        15.146299   0.141679    0.769503    121.126261 
[37m[36mINFO[0m[0m 03/18 22:55:39 | 0.632853    0.620619    0.973054    0.832031    0.825158    0.632853    0.620619    0.954754    0.762887    0.985923    0.898534    0.978485    0.834673    1400        17.670683   0.108399    0.751566    117.606211 
[37m[36mINFO[0m[0m 03/18 23:00:07 | 0.613800    0.606186    0.975745    0.826268    0.904078    0.613800    0.606186    0.965349    0.756014    0.982827    0.903044    0.979059    0.819747    1600        20.195066   0.098924    0.752084    117.927547 
[37m[36mINFO[0m[0m 03/18 23:04:40 | 0.605561    0.616495    0.979364    0.819076    0.966101    0.605561    0.616495    0.968786    0.752577    0.984797    0.890643    0.984509    0.814007    1800        22.719449   0.076502    0.754482    122.014477 
[37m[36mINFO[0m[0m 03/18 23:09:17 | 0.619979    0.626804    0.980312    0.821334    0.921530    0.619979    0.626804    0.970218    0.757159    0.985923    0.896280    0.984796    0.810563    2000        25.243832   0.068572    0.772584    122.319988 
[37m[36mINFO[0m[0m 03/18 23:13:39 | 0.626159    0.630928    0.985153    0.830097    0.895268    0.626159    0.630928    0.974800    0.762887    0.991273    0.901917    0.989386    0.825488    2200        27.768216   0.064755    0.714809    118.702330 
[37m[36mINFO[0m[0m 03/18 23:18:00 | 0.624099    0.645361    0.987163    0.821372    0.983387    0.624099    0.645361    0.979954    0.752577    0.990428    0.890643    0.991107    0.820896    2400        30.292599   0.047343    0.716240    118.245222 
[37m[36mINFO[0m[0m 03/18 23:22:25 | 0.630278    0.643299    0.987242    0.827845    1.007284    0.630278    0.643299    0.978236    0.750286    0.993243    0.896280    0.990247    0.836969    2600        32.816982   0.051330    0.734991    117.307468 
[37m[36mINFO[0m[0m 03/18 23:26:44 | 0.628218    0.647423    0.986192    0.825923    0.944352    0.628218    0.647423    0.975372    0.761741    0.993243    0.896280    0.989960    0.819747    2800        35.341365   0.047541    0.715574    116.816946 
[37m[36mINFO[0m[0m 03/18 23:31:11 | 0.637487    0.641237    0.989062    0.833552    0.873865    0.637487    0.641237    0.981386    0.758305    0.992399    0.900789    0.993402    0.841561    3000        37.865749   0.039591    0.746180    117.262130 
[37m[36mINFO[0m[0m 03/18 23:35:36 | 0.617405    0.616495    0.988395    0.828189    0.990979    0.617405    0.616495    0.981386    0.756014    0.992117    0.901917    0.991681    0.826636    3200        40.390132   0.044432    0.727095    119.905035 
[37m[36mINFO[0m[0m 03/18 23:40:02 | 0.618435    0.632990    0.990759    0.838810    0.905367    0.618435    0.632990    0.981386    0.761741    0.996340    0.916573    0.994550    0.838117    3400        42.914515   0.039503    0.735336    118.143867 
[37m[36mINFO[0m[0m 03/18 23:44:25 | 0.596807    0.597938    0.987063    0.823984    1.038454    0.596807    0.597938    0.979095    0.758305    0.991273    0.900789    0.990820    0.812859    3600        45.438898   0.035895    0.721642    119.288720 
[37m[36mINFO[0m[0m 03/18 23:48:47 | 0.624614    0.624742    0.990394    0.834651    0.984652    0.624614    0.624742    0.983963    0.768614    0.993243    0.907554    0.993976    0.827784    3800        47.963282   0.035192    0.718364    118.458135 
[37m[36mINFO[0m[0m 03/18 23:53:11 | 0.629248    0.622680    0.989070    0.831247    1.007582    0.629248    0.622680    0.981100    0.760596    0.991273    0.901917    0.994836    0.831228    4000        50.487665   0.033260    0.728832    118.344493 
[37m[36mINFO[0m[0m 03/18 23:57:34 | 0.607106    0.628866    0.989619    0.830072    0.973022    0.607106    0.628866    0.980241    0.750286    0.995214    0.907554    0.993402    0.832377    4200        53.012048   0.031878    0.731787    115.959395 
[37m[36mINFO[0m[0m 03/19 00:01:58 | 0.620494    0.643299    0.992005    0.833521    0.947919    0.620494    0.643299    0.985395    0.762887    0.995495    0.905299    0.995123    0.832377    4400        55.536431   0.030694    0.745356    115.053046 
[37m[36mINFO[0m[0m 03/19 00:06:22 | 0.621524    0.665979    0.992000    0.836137    1.003524    0.621524    0.665979    0.983963    0.772050    0.996340    0.914318    0.995697    0.822044    4600        58.060815   0.027470    0.725694    119.475710 
[37m[36mINFO[0m[0m 03/19 00:10:48 | 0.623069    0.635052    0.990578    0.825113    0.996672    0.623069    0.635052    0.983677    0.746850    0.994369    0.905299    0.993689    0.823192    4800        60.585198   0.027372    0.742891    117.129159 
[37m[36mINFO[0m[0m 03/19 00:15:07 | 0.615345    0.635052    0.992185    0.832344    1.048800    0.615345    0.635052    0.983104    0.754868    0.997466    0.910936    0.995984    0.831228    5000        63.109581   0.026948    0.710230    116.858158 
[37m[36mINFO[0m[0m 03/19 00:15:07 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[0]/250318_22-22-12_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 00:15:09 | ---
[37m[36mINFO[0m[0m 03/19 00:15:09 | test-domain validation(oracle) = 62.152%
[37m[36mINFO[0m[0m 03/19 00:15:09 | training-domain validation(iid) = 61.843%
[37m[36mINFO[0m[0m 03/19 00:15:09 | last = 61.535%
[37m[36mINFO[0m[0m 03/19 00:15:09 | last (inD) = 83.234%
[37m[36mINFO[0m[0m 03/19 00:15:09 | training-domain validation (iid, inD) = 83.881%
[37m[36mINFO[0m[0m 03/19 00:15:09 | === Summary ===
[37m[36mINFO[0m[0m 03/19 00:15:09 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 0 --hparams_seed 1
[37m[36mINFO[0m[0m 03/19 00:15:09 | Unique name: 250318_22-22-12_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 00:15:09 | Out path: train_output/OfficeHome/ERM/[0]/250318_22-22-12_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 00:15:09 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 00:15:09 | Dataset: OfficeHome

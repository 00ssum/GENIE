[37m[36mINFO[0m[0m 02/27 04:21:16 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_adam config/clip_vitb16_adam.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_adam.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_adam
	out_dir: train_output/OfficeHome/ERM/[0]/250227_04-21-16_clip_vitb16_adam
	out_root: train_output/OfficeHome/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250227_04-21-16_clip_vitb16_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: clip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/27 04:21:16 | n_steps = 5001
[37m[36mINFO[0m[0m 02/27 04:21:16 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/27 04:21:16 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/27 04:21:16 | 
[37m[36mINFO[0m[0m 02/27 04:21:16 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 02/27 04:21:16 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 02/27 04:21:16 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 02/27 04:21:16 | Batch sizes for each domain: [0, 32, 32, 32] (total=96)
[37m[36mINFO[0m[0m 02/27 04:21:16 | steps-per-epoch for each domain: 109.12, 111.00, 108.94 -> min = 108.94
[37m[36mINFO[0m[0m 02/27 04:21:20 | # of params = 86225985
[37m[36mINFO[0m[0m 02/27 04:23:59 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/27 04:23:59 | 0.048404    0.055670    0.039238    0.037647    4.175851    0.048404    0.055670    0.026346    0.025200    0.037725    0.036077    0.053643    0.051665    0           0.000000    4.212853    1.517379    157.220542 
[37m[36mINFO[0m[0m 02/27 04:28:40 | 0.651905    0.639175    0.863576    0.811916    0.757731    0.651905    0.639175    0.825315    0.733104    0.890484    0.874859    0.874928    0.827784    200         1.835915    1.232221    0.683308    144.607141 
[37m[36mINFO[0m[0m 02/27 04:33:28 | 0.618435    0.657732    0.896993    0.811184    0.769501    0.618435    0.657732    0.856243    0.734250    0.925957    0.869222    0.908778    0.830080    400         3.671830    0.479774    0.643013    159.297649 
[37m[36mINFO[0m[0m 02/27 04:38:08 | 0.621009    0.632990    0.921945    0.834797    0.652195    0.621009    0.632990    0.903207    0.784651    0.937500    0.881623    0.925129    0.838117    600         5.507745    0.329276    0.637909    152.573195 
[37m[36mINFO[0m[0m 02/27 04:42:43 | 0.580844    0.608247    0.929135    0.817189    0.768094    0.580844    0.608247    0.902635    0.735395    0.949887    0.888388    0.934882    0.827784    800         7.343660    0.245376    0.686074    137.642342 
[37m[36mINFO[0m[0m 02/27 04:47:21 | 0.590113    0.573196    0.941747    0.821073    0.731631    0.590113    0.573196    0.928694    0.760596    0.949043    0.875986    0.947504    0.826636    1000        9.179575    0.226729    0.718078    134.516532 
[37m[36mINFO[0m[0m 02/27 04:51:48 | 0.587539    0.585567    0.933462    0.810424    0.842692    0.587539    0.585567    0.922394    0.754868    0.944257    0.865840    0.933735    0.810563    1200        11.015491   0.179969    0.691053    128.871013 
[37m[36mINFO[0m[0m 02/27 04:56:29 | 0.597837    0.624742    0.956425    0.822892    0.777957    0.597837    0.624742    0.940435    0.757159    0.970721    0.891770    0.958118    0.819747    1400        12.851406   0.188722    0.697740    141.556176 
[37m[36mINFO[0m[0m 02/27 05:00:58 | 0.600927    0.622680    0.967559    0.833610    0.722820    0.600927    0.622680    0.953608    0.781214    0.978041    0.888388    0.971027    0.831228    1600        14.687321   0.153465    0.654701    137.733916 
[37m[36mINFO[0m[0m 02/27 05:05:27 | 0.602472    0.628866    0.964991    0.846504    0.695908    0.602472    0.628866    0.951031    0.799542    0.976070    0.905299    0.967871    0.834673    1800        16.523236   0.145353    0.662665    136.082970 
[37m[36mINFO[0m[0m 02/27 05:09:57 | 0.634912    0.635052    0.974984    0.848103    0.665029    0.634912    0.635052    0.964777    0.800687    0.982264    0.894025    0.977912    0.849598    2000        18.359151   0.114728    0.705987    129.489319 
[37m[36mINFO[0m[0m 02/27 05:14:25 | 0.552523    0.540206    0.959510    0.801973    0.852872    0.552523    0.540206    0.948740    0.741123    0.965935    0.872604    0.963855    0.792193    2200        20.195066   0.121790    0.672329    133.259377 
[37m[36mINFO[0m[0m 02/27 05:18:45 | 0.545314    0.556701    0.964603    0.830558    0.784208    0.545314    0.556701    0.959622    0.786942    0.976070    0.886133    0.958118    0.818599    2400        22.030981   0.121111    0.631758    133.504805 
[37m[36mINFO[0m[0m 02/27 05:23:05 | 0.560762    0.567010    0.971469    0.824787    0.802601    0.560762    0.567010    0.965636    0.773196    0.978604    0.892897    0.970166    0.808266    2600        23.866896   0.104377    0.659155    127.905891 
[37m[36mINFO[0m[0m 02/27 05:27:10 | 0.573635    0.562887    0.979359    0.832759    0.735116    0.573635    0.562887    0.971077    0.775487    0.985360    0.903044    0.981641    0.819747    2800        25.702811   0.095429    0.591752    126.721234 
[37m[36mINFO[0m[0m 02/27 05:31:16 | 0.556643    0.554639    0.977179    0.822576    0.798782    0.556643    0.554639    0.966781    0.786942    0.982827    0.877114    0.981928    0.803674    3000        27.538726   0.099857    0.590993    128.007875 
[37m[36mINFO[0m[0m 02/27 05:35:26 | 0.530896    0.523711    0.967590    0.808479    0.942803    0.530896    0.523711    0.966781    0.759450    0.971847    0.870349    0.964142    0.795637    3200        29.374641   0.091213    0.582942    133.174190 
[37m[36mINFO[0m[0m 02/27 05:39:30 | 0.523687    0.494845    0.966062    0.803513    0.902806    0.523687    0.494845    0.964204    0.765178    0.971847    0.868095    0.962134    0.777268    3400        31.210557   0.106198    0.576372    129.170163 
[37m[36mINFO[0m[0m 02/27 05:43:37 | 0.534501    0.556701    0.970890    0.807634    0.909875    0.534501    0.556701    0.956186    0.754868    0.980293    0.883878    0.976190    0.784156    3600        33.046472   0.108534    0.565027    133.379684 
[37m[36mINFO[0m[0m 02/27 05:47:39 | 0.529866    0.538144    0.973742    0.808066    0.838764    0.529866    0.538144    0.966208    0.744559    0.981982    0.877114    0.973035    0.802526    3800        34.882387   0.103128    0.559890    130.826731 
[37m[36mINFO[0m[0m 02/27 05:51:41 | 0.508754    0.494845    0.970809    0.808119    0.857547    0.508754    0.494845    0.963631    0.765178    0.977196    0.865840    0.971601    0.793341    4000        36.718302   0.074655    0.530979    135.698175 
[37m[36mINFO[0m[0m 02/27 05:55:44 | 0.574150    0.573196    0.985152    0.820236    0.862729    0.574150    0.573196    0.975945    0.754868    0.991273    0.888388    0.988239    0.817451    4200        38.554217   0.087514    0.540930    134.858219 
[37m[36mINFO[0m[0m 02/27 05:59:51 | 0.521112    0.527835    0.975954    0.807792    0.923604    0.521112    0.527835    0.974513    0.765178    0.979167    0.856821    0.974182    0.801378    4400        40.390132   0.087993    0.578609    131.382725 
[37m[36mINFO[0m[0m 02/27 06:03:58 | 0.569516    0.583505    0.981837    0.824412    0.874543    0.569516    0.583505    0.976231    0.789233    0.986205    0.889515    0.983075    0.794489    4600        42.226047   0.076681    0.569198    132.943229 
[37m[36mINFO[0m[0m 02/27 06:07:58 | 0.537075    0.544330    0.977943    0.819860    0.908175    0.537075    0.544330    0.971077    0.773196    0.982545    0.885006    0.980207    0.801378    4800        44.061962   0.065821    0.556798    128.744752 
[37m[36mINFO[0m[0m 02/27 06:12:06 | 0.487127    0.480412    0.963011    0.793575    1.015708    0.487127    0.480412    0.953608    0.739977    0.971284    0.869222    0.964142    0.771527    5000        45.897877   0.072936    0.580162    132.060370 
[37m[36mINFO[0m[0m 02/27 06:12:07 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[0]/250227_04-21-16_clip_vitb16_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/27 06:12:10 | ---
[37m[36mINFO[0m[0m 02/27 06:12:10 | test-domain validation(oracle) = 61.843%
[37m[36mINFO[0m[0m 02/27 06:12:10 | training-domain validation(iid) = 63.491%
[37m[36mINFO[0m[0m 02/27 06:12:10 | last = 48.713%
[37m[36mINFO[0m[0m 02/27 06:12:10 | last (inD) = 79.358%
[37m[36mINFO[0m[0m 02/27 06:12:10 | training-domain validation (iid, inD) = 84.810%
[37m[36mINFO[0m[0m 02/27 06:12:10 | === Summary ===
[37m[36mINFO[0m[0m 02/27 06:12:10 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_adam config/clip_vitb16_adam.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome
[37m[36mINFO[0m[0m 02/27 06:12:10 | Unique name: 250227_04-21-16_clip_vitb16_adam
[37m[36mINFO[0m[0m 02/27 06:12:10 | Out path: train_output/OfficeHome/ERM/[0]/250227_04-21-16_clip_vitb16_adam
[37m[36mINFO[0m[0m 02/27 06:12:10 | Algorithm: ERM
[37m[36mINFO[0m[0m 02/27 06:12:10 | Dataset: OfficeHome

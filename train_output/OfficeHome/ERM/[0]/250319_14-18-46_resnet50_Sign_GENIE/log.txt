[37m[36mINFO[0m[0m 03/19 14:18:46 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 0 --hparams_seed 13
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 13
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/OfficeHome/ERM/[0]/250319_14-18-46_resnet50_Sign_GENIE
	out_root: train_output/OfficeHome/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250319_14-18-46_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00014596629881421895
	batch_size: 9
	weight_decay: 0.0009399117661702502
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/19 14:18:46 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 14:18:46 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 14:18:46 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 14:18:46 | 
[37m[36mINFO[0m[0m 03/19 14:18:46 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 14:18:46 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 14:18:46 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 14:18:46 | Batch sizes for each domain: [0, 9, 9, 9] (total=27)
[37m[36mINFO[0m[0m 03/19 14:18:46 | steps-per-epoch for each domain: 388.00, 394.67, 387.33 -> min = 387.33
[37m[36mINFO[0m[0m 03/19 14:18:47 | # of params = 23641217
[37m[36mINFO[0m[0m 03/19 14:20:46 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 14:20:46 | 0.020597    0.016495    0.019852    0.020911    4.240979    0.020597    0.016495    0.017182    0.026346    0.019426    0.019166    0.022949    0.017222    0           0.000000    4.246830    1.028526    118.366645 
[37m[36mINFO[0m[0m 03/19 14:23:16 | 0.460350    0.470103    0.675344    0.657996    1.288856    0.460350    0.470103    0.589633    0.573883    0.722973    0.719278    0.713425    0.680827    200         0.516351    2.214014    0.169920    115.452918 
[37m[36mINFO[0m[0m 03/19 14:25:50 | 0.526262    0.544330    0.716352    0.686150    1.153644    0.526262    0.544330    0.638603    0.592211    0.766047    0.744081    0.744406    0.722158    400         1.032702    1.127340    0.180662    118.508921 
[37m[36mINFO[0m[0m 03/19 14:28:28 | 0.495366    0.521649    0.773149    0.713064    1.082609    0.495366    0.521649    0.712772    0.621993    0.820101    0.782413    0.786575    0.734788    600         1.549053    0.886701    0.192715    119.306013 
[37m[36mINFO[0m[0m 03/19 14:31:02 | 0.513903    0.544330    0.809188    0.737383    1.015089    0.513903    0.544330    0.767755    0.659794    0.847128    0.806088    0.812679    0.746269    800         2.065404    0.734113    0.162746    121.042177 
[37m[36mINFO[0m[0m 03/19 14:33:37 | 0.514933    0.550515    0.798220    0.729011    1.090612    0.514933    0.550515    0.733104    0.660939    0.845721    0.798196    0.815835    0.727899    1000        2.581756    0.634985    0.181690    119.265624 
[37m[36mINFO[0m[0m 03/19 14:36:11 | 0.549434    0.577320    0.861838    0.774348    0.921805    0.549434    0.577320    0.826460    0.712486    0.893018    0.825254    0.866036    0.785304    1200        3.098107    0.594815    0.182662    117.461912 
[37m[36mINFO[0m[0m 03/19 14:38:46 | 0.507209    0.562887    0.841909    0.752315    0.923513    0.507209    0.562887    0.813288    0.705613    0.870214    0.799324    0.842226    0.752009    1400        3.614458    0.543925    0.174895    119.929888 
[37m[36mINFO[0m[0m 03/19 14:41:19 | 0.537590    0.591753    0.879074    0.780336    0.857750    0.537590    0.591753    0.855384    0.726231    0.901745    0.845547    0.880092    0.769231    1600        4.130809    0.451038    0.179687    116.797270 
[37m[36mINFO[0m[0m 03/19 14:43:51 | 0.560247    0.571134    0.887705    0.792635    0.893323    0.560247    0.571134    0.853666    0.729668    0.913007    0.836528    0.896443    0.811711    1800        4.647160    0.420959    0.160746    119.726017 
[37m[36mINFO[0m[0m 03/19 14:46:25 | 0.546344    0.556701    0.889788    0.779253    0.900050    0.546344    0.556701    0.861684    0.722795    0.915541    0.835400    0.892140    0.779564    2000        5.163511    0.396005    0.181435    118.183580 
[37m[36mINFO[0m[0m 03/19 14:48:59 | 0.574665    0.579381    0.893108    0.775405    0.939310    0.574665    0.579381    0.864834    0.713631    0.919482    0.839910    0.895009    0.772675    2200        5.679862    0.343368    0.180059    117.353257 
[37m[36mINFO[0m[0m 03/19 14:51:36 | 0.550978    0.575258    0.913986    0.789378    0.951367    0.550978    0.575258    0.897766    0.723940    0.926520    0.869222    0.917671    0.774971    2400        6.196213    0.349753    0.189781    119.535375 
[37m[36mINFO[0m[0m 03/19 14:54:10 | 0.548919    0.544330    0.902306    0.784210    0.939594    0.548919    0.544330    0.886312    0.728522    0.914696    0.837655    0.905909    0.786452    2600        6.712565    0.328853    0.172879    119.125930 
[37m[36mINFO[0m[0m 03/19 14:56:43 | 0.562822    0.575258    0.914680    0.784109    0.889241    0.562822    0.575258    0.888316    0.725086    0.938626    0.854566    0.917097    0.772675    2800        7.228916    0.290414    0.176261    117.592633 
[37m[36mINFO[0m[0m 03/19 14:59:17 | 0.526777    0.538144    0.921528    0.778012    0.914559    0.526777    0.538144    0.899771    0.709049    0.943412    0.852311    0.921400    0.772675    3000        7.745267    0.259656    0.173108    119.934638 
[37m[36mINFO[0m[0m 03/19 15:01:51 | 0.576210    0.595876    0.930305    0.810672    0.766536    0.576210    0.595876    0.912371    0.750286    0.945383    0.888388    0.933161    0.793341    3200        8.261618    0.260074    0.167420    119.888176 
[37m[36mINFO[0m[0m 03/19 15:04:26 | 0.562822    0.608247    0.949299    0.820617    0.788741    0.562822    0.608247    0.931558    0.757159    0.964245    0.888388    0.952094    0.816303    3400        8.777969    0.241243    0.184604    118.006474 
[37m[36mINFO[0m[0m 03/19 15:06:56 | 0.588568    0.593814    0.942740    0.805799    0.864819    0.588568    0.593814    0.923540    0.743414    0.958896    0.872604    0.945783    0.801378    3600        9.294320    0.197108    0.159858    118.299969 
[37m[36mINFO[0m[0m 03/19 15:09:30 | 0.576210    0.579381    0.934408    0.793946    0.929626    0.576210    0.579381    0.924971    0.737686    0.945664    0.871477    0.932587    0.772675    3800        9.810671    0.210964    0.165692    121.364207 
[37m[36mINFO[0m[0m 03/19 15:12:12 | 0.579815    0.564948    0.921342    0.765833    1.002485    0.579815    0.564948    0.890893    0.693013    0.943412    0.843292    0.929719    0.761194    4000        10.327022   0.198066    0.221758    117.287652 
[37m[36mINFO[0m[0m 03/19 15:14:48 | 0.529351    0.523711    0.933133    0.776914    1.077583    0.529351    0.523711    0.918671    0.723940    0.951295    0.842165    0.929432    0.764638    4200        10.843373   0.171787    0.191548    117.314599 
[37m[36mINFO[0m[0m 03/19 15:17:27 | 0.566426    0.583505    0.950776    0.797821    0.854137    0.566426    0.583505    0.941294    0.738832    0.956644    0.863585    0.954389    0.791045    4400        11.359725   0.173775    0.191239    120.575263 
[37m[36mINFO[0m[0m 03/19 15:20:10 | 0.542739    0.550515    0.950070    0.795452    0.930065    0.542739    0.550515    0.934135    0.734250    0.963119    0.875986    0.952955    0.776119    4600        11.876076   0.167096    0.221573    118.936333 
[37m[36mINFO[0m[0m 03/19 15:22:42 | 0.519053    0.554639    0.937020    0.783338    0.991312    0.519053    0.554639    0.920962    0.731959    0.956363    0.854566    0.933735    0.763490    4800        12.392427   0.168124    0.176809    117.194013 
[37m[36mINFO[0m[0m 03/19 15:25:28 | 0.568486    0.573196    0.956155    0.807299    0.869421    0.568486    0.573196    0.945304    0.756014    0.967624    0.875986    0.955536    0.789897    5000        12.908778   0.182091    0.229514    120.093023 
[37m[36mINFO[0m[0m 03/19 15:25:28 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[0]/250319_14-18-46_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 15:25:30 | ---
[37m[36mINFO[0m[0m 03/19 15:25:30 | test-domain validation(oracle) = 56.282%
[37m[36mINFO[0m[0m 03/19 15:25:30 | training-domain validation(iid) = 56.282%
[37m[36mINFO[0m[0m 03/19 15:25:30 | last = 56.849%
[37m[36mINFO[0m[0m 03/19 15:25:30 | last (inD) = 80.730%
[37m[36mINFO[0m[0m 03/19 15:25:30 | training-domain validation (iid, inD) = 82.062%
[37m[36mINFO[0m[0m 03/19 15:25:30 | === Summary ===
[37m[36mINFO[0m[0m 03/19 15:25:30 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 0 --hparams_seed 13
[37m[36mINFO[0m[0m 03/19 15:25:30 | Unique name: 250319_14-18-46_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 15:25:30 | Out path: train_output/OfficeHome/ERM/[0]/250319_14-18-46_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 15:25:30 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 15:25:30 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 03/19 04:07:09 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 0 --hparams_seed 5
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 5
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/OfficeHome/ERM/[0]/250319_04-07-09_resnet50_Sign_GENIE
	out_root: train_output/OfficeHome/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250319_04-07-09_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 1.6343540304927548e-05
	batch_size: 23
	weight_decay: 3.844578840738432e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/19 04:07:09 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 04:07:09 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 04:07:09 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 04:07:09 | 
[37m[36mINFO[0m[0m 03/19 04:07:09 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 04:07:09 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 04:07:09 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 04:07:09 | Batch sizes for each domain: [0, 23, 23, 23] (total=69)
[37m[36mINFO[0m[0m 03/19 04:07:09 | steps-per-epoch for each domain: 151.83, 154.43, 151.57 -> min = 151.57
[37m[36mINFO[0m[0m 03/19 04:07:10 | # of params = 23641217
[37m[36mINFO[0m[0m 03/19 04:09:09 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 04:09:09 | 0.013388    0.010309    0.013879    0.010649    4.224586    0.013388    0.010309    0.012600    0.005727    0.011824    0.010147    0.017212    0.016073    0           0.000000    4.256174    1.469690    117.468310 
[37m[36mINFO[0m[0m 03/19 04:12:21 | 0.562822    0.571134    0.768205    0.731278    0.973981    0.562822    0.571134    0.699026    0.636884    0.817005    0.806088    0.788583    0.750861    200         1.319564    1.592504    0.379886    115.751778 
[37m[36mINFO[0m[0m 03/19 04:15:29 | 0.609681    0.616495    0.864620    0.784564    0.829786    0.609681    0.616495    0.826174    0.711340    0.891610    0.844419    0.876076    0.797933    400         2.639128    0.624538    0.369964    114.597862 
[37m[36mINFO[0m[0m 03/19 04:18:38 | 0.590628    0.600000    0.890443    0.785248    0.844813    0.590628    0.600000    0.855670    0.710195    0.918356    0.857948    0.897303    0.787600    600         3.958692    0.454958    0.362537    116.809395 
[37m[36mINFO[0m[0m 03/19 04:21:48 | 0.595263    0.639175    0.913071    0.810749    0.824286    0.595263    0.639175    0.887171    0.749141    0.936092    0.875986    0.915950    0.807118    800         5.278256    0.341623    0.372227    114.998893 
[37m[36mINFO[0m[0m 03/19 04:24:58 | 0.582904    0.624742    0.914318    0.791368    0.821468    0.582904    0.624742    0.880298    0.713631    0.936092    0.857948    0.926563    0.802526    1000        6.597820    0.270944    0.363546    117.267806 
[37m[36mINFO[0m[0m 03/19 04:28:08 | 0.579300    0.591753    0.935626    0.806500    0.826107    0.579300    0.591753    0.915521    0.745704    0.950450    0.882751    0.940906    0.791045    1200        7.917384    0.231208    0.374087    115.182922 
[37m[36mINFO[0m[0m 03/19 04:31:16 | 0.613800    0.608247    0.953210    0.813450    0.839235    0.613800    0.608247    0.938431    0.765178    0.965090    0.870349    0.956110    0.804822    1400        9.236948    0.180654    0.370479    114.399331 
[37m[36mINFO[0m[0m 03/19 04:34:27 | 0.597322    0.637113    0.952843    0.806193    0.852053    0.597322    0.637113    0.943299    0.736541    0.962275    0.871477    0.952955    0.810563    1600        10.556512   0.154316    0.367718    116.677600 
[37m[36mINFO[0m[0m 03/19 04:37:38 | 0.592688    0.608247    0.961548    0.819036    0.886916    0.592688    0.608247    0.941867    0.750286    0.976914    0.897407    0.965863    0.809414    1800        11.876076   0.152906    0.361660    119.188477 
[37m[36mINFO[0m[0m 03/19 04:40:47 | 0.623584    0.630928    0.965094    0.809243    0.954701    0.623584    0.630928    0.947881    0.752577    0.975225    0.871477    0.972174    0.803674    2000        13.195640   0.120830    0.362008    116.443828 
[37m[36mINFO[0m[0m 03/19 04:43:57 | 0.609681    0.626804    0.970323    0.825968    0.907044    0.609681    0.626804    0.956758    0.774341    0.979167    0.887260    0.975043    0.816303    2200        14.515204   0.115528    0.374534    115.174648 
[37m[36mINFO[0m[0m 03/19 04:47:05 | 0.580330    0.581443    0.967854    0.811453    0.917940    0.580330    0.581443    0.959622    0.757159    0.976070    0.885006    0.967871    0.792193    2400        15.834768   0.102144    0.361345    115.784541 
[37m[36mINFO[0m[0m 03/19 04:50:18 | 0.616890    0.624742    0.970781    0.821735    0.870107    0.616890    0.624742    0.957617    0.760596    0.982264    0.892897    0.972461    0.811711    2600        17.154332   0.092815    0.366440    119.496767 
[37m[36mINFO[0m[0m 03/19 04:53:26 | 0.588568    0.589691    0.975170    0.814537    0.946721    0.588568    0.589691    0.964204    0.762887    0.983108    0.880496    0.978199    0.800230    2800        18.473896   0.082997    0.358929    116.566428 
[37m[36mINFO[0m[0m 03/19 04:56:39 | 0.598867    0.595876    0.978310    0.832782    0.908382    0.598867    0.595876    0.970504    0.782360    0.985079    0.898534    0.979346    0.817451    3000        19.793460   0.090544    0.368721    119.075975 
[37m[36mINFO[0m[0m 03/19 04:59:46 | 0.595778    0.606186    0.978887    0.825205    1.057573    0.595778    0.606186    0.966495    0.772050    0.984797    0.887260    0.985370    0.816303    3200        21.113024   0.059994    0.363176    114.760014 
[37m[36mINFO[0m[0m 03/19 05:03:01 | 0.618435    0.589691    0.980583    0.819084    0.986432    0.618435    0.589691    0.968499    0.750286    0.988739    0.889515    0.984509    0.817451    3400        22.432587   0.060938    0.375359    118.929702 
[37m[36mINFO[0m[0m 03/19 05:06:10 | 0.618435    0.602062    0.984678    0.818661    1.010715    0.618435    0.602062    0.975372    0.758305    0.990709    0.895152    0.987952    0.802526    3600        23.752151   0.059665    0.370658    114.935409 
[37m[36mINFO[0m[0m 03/19 05:09:17 | 0.606591    0.622680    0.982588    0.820180    1.025110    0.606591    0.622680    0.972222    0.746850    0.988739    0.898534    0.986804    0.815155    3800        25.071715   0.052405    0.375640    112.120341 
[37m[36mINFO[0m[0m 03/19 05:12:29 | 0.609166    0.620619    0.985646    0.813026    1.047039    0.609166    0.620619    0.976231    0.756014    0.988739    0.878241    0.991968    0.804822    4000        26.391279   0.050348    0.377759    116.323497 
[37m[36mINFO[0m[0m 03/19 05:15:39 | 0.626674    0.637113    0.984019    0.816427    1.030638    0.626674    0.637113    0.972222    0.749141    0.989302    0.886133    0.990534    0.814007    4200        27.710843   0.052746    0.371485    115.768542 
[37m[36mINFO[0m[0m 03/19 05:18:51 | 0.615345    0.628866    0.985258    0.816427    0.958681    0.615345    0.628866    0.976231    0.749141    0.989583    0.886133    0.989960    0.814007    4400        29.030407   0.053369    0.376837    117.067846 
[37m[36mINFO[0m[0m 03/19 05:22:06 | 0.622554    0.622680    0.986578    0.829325    1.015683    0.622554    0.622680    0.975659    0.762887    0.992680    0.903044    0.991394    0.822044    4600        30.349971   0.051702    0.391518    116.653235 
[37m[36mINFO[0m[0m 03/19 05:25:24 | 0.604531    0.622680    0.983921    0.825919    0.922605    0.604531    0.622680    0.976804    0.766323    0.989302    0.896280    0.985657    0.815155    4800        31.669535   0.043696    0.396422    118.336266 
[37m[36mINFO[0m[0m 03/19 05:28:39 | 0.595778    0.591753    0.981543    0.819855    1.114686    0.595778    0.591753    0.972795    0.769759    0.987613    0.886133    0.984223    0.803674    5000        32.989099   0.042688    0.397410    116.135084 
[37m[36mINFO[0m[0m 03/19 05:28:40 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[0]/250319_04-07-09_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 05:28:41 | ---
[37m[36mINFO[0m[0m 03/19 05:28:41 | test-domain validation(oracle) = 59.526%
[37m[36mINFO[0m[0m 03/19 05:28:41 | training-domain validation(iid) = 59.887%
[37m[36mINFO[0m[0m 03/19 05:28:41 | last = 59.578%
[37m[36mINFO[0m[0m 03/19 05:28:41 | last (inD) = 81.986%
[37m[36mINFO[0m[0m 03/19 05:28:41 | training-domain validation (iid, inD) = 83.278%
[37m[36mINFO[0m[0m 03/19 05:28:41 | === Summary ===
[37m[36mINFO[0m[0m 03/19 05:28:41 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 0 --hparams_seed 5
[37m[36mINFO[0m[0m 03/19 05:28:41 | Unique name: 250319_04-07-09_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 05:28:41 | Out path: train_output/OfficeHome/ERM/[0]/250319_04-07-09_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 05:28:41 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 05:28:41 | Dataset: OfficeHome

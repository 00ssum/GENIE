[37m[36mINFO[0m[0m 03/19 10:40:26 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 0 --hparams_seed 10
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 10
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/OfficeHome/ERM/[0]/250319_10-40-26_resnet50_Sign_GENIE
	out_root: train_output/OfficeHome/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250319_10-40-26_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.5980189819232268e-05
	batch_size: 22
	weight_decay: 1.2831747186887755e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/19 10:40:26 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 10:40:26 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 10:40:26 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 10:40:26 | 
[37m[36mINFO[0m[0m 03/19 10:40:26 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 10:40:26 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 10:40:26 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 10:40:26 | Batch sizes for each domain: [0, 22, 22, 22] (total=66)
[37m[36mINFO[0m[0m 03/19 10:40:26 | steps-per-epoch for each domain: 158.73, 161.45, 158.45 -> min = 158.45
[37m[36mINFO[0m[0m 03/19 10:40:27 | # of params = 23641217
[37m[36mINFO[0m[0m 03/19 10:42:28 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 10:42:28 | 0.015963    0.012371    0.015011    0.017482    4.227383    0.015963    0.012371    0.013746    0.014891    0.014077    0.018038    0.017212    0.019518    0           0.000000    4.314472    1.319816    119.625627 
[37m[36mINFO[0m[0m 03/19 10:45:38 | 0.561277    0.606186    0.755954    0.714591    1.050108    0.561277    0.606186    0.669817    0.609393    0.806306    0.784667    0.791738    0.749713    200         1.262192    2.036504    0.367962    116.724199 
[37m[36mINFO[0m[0m 03/19 10:48:44 | 0.584449    0.593814    0.839584    0.768567    0.828822    0.584449    0.593814    0.786082    0.674685    0.877534    0.836528    0.855135    0.794489    400         2.524383    0.863595    0.352554    115.505598 
[37m[36mINFO[0m[0m 03/19 10:51:50 | 0.627188    0.672165    0.879677    0.787628    0.778017    0.627188    0.672165    0.831901    0.709049    0.914414    0.844419    0.892714    0.809414    600         3.786575    0.645005    0.347457    116.432419 
[37m[36mINFO[0m[0m 03/19 10:55:08 | 0.618950    0.622680    0.893764    0.796641    0.787068    0.618950    0.622680    0.854238    0.717068    0.922579    0.871477    0.904475    0.801378    800         5.048766    0.495827    0.411599    115.828186 
[37m[36mINFO[0m[0m 03/19 10:58:26 | 0.595263    0.606186    0.906514    0.801700    0.841495    0.595263    0.606186    0.878293    0.733104    0.930462    0.855693    0.910786    0.816303    1000        6.310958    0.389501    0.407383    116.390747 
[37m[36mINFO[0m[0m 03/19 11:01:43 | 0.617405    0.635052    0.930531    0.808078    0.805421    0.617405    0.635052    0.900630    0.737686    0.956081    0.875986    0.934882    0.810563    1200        7.573150    0.340148    0.403622    116.185422 
[37m[36mINFO[0m[0m 03/19 11:05:00 | 0.609166    0.628866    0.937801    0.818007    0.770421    0.609166    0.628866    0.914948    0.757159    0.954392    0.877114    0.944062    0.819747    1400        8.835341    0.273389    0.404396    115.850061 
[37m[36mINFO[0m[0m 03/19 11:08:16 | 0.610196    0.635052    0.943457    0.811180    0.821229    0.610196    0.635052    0.917526    0.747995    0.967061    0.868095    0.945783    0.817451    1600        10.097533   0.260194    0.401396    116.423809 
[37m[36mINFO[0m[0m 03/19 11:11:32 | 0.594748    0.608247    0.947314    0.808496    0.866708    0.594748    0.608247    0.928694    0.745704    0.960867    0.869222    0.952381    0.810563    1800        11.359725   0.237993    0.395422    116.051912 
[37m[36mINFO[0m[0m 03/19 11:14:47 | 0.599382    0.626804    0.955300    0.819944    0.819039    0.599382    0.626804    0.941008    0.753723    0.967061    0.873732    0.957831    0.832377    2000        12.621916   0.194461    0.385727    118.635435 
[37m[36mINFO[0m[0m 03/19 11:18:00 | 0.630278    0.651546    0.959861    0.819821    0.837813    0.630278    0.651546    0.941581    0.760596    0.971565    0.892897    0.966437    0.805970    2200        13.884108   0.183191    0.386886    115.809993 
[37m[36mINFO[0m[0m 03/19 11:21:18 | 0.577240    0.620619    0.963170    0.813045    0.849482    0.577240    0.620619    0.945876    0.749141    0.977196    0.875986    0.966437    0.814007    2400        15.146299   0.168438    0.386079    120.556338 
[37m[36mINFO[0m[0m 03/19 11:24:33 | 0.630278    0.641237    0.971352    0.823283    0.820177    0.630278    0.641237    0.955040    0.764032    0.982827    0.889515    0.976190    0.816303    2600        16.408491   0.153890    0.387366    116.938474 
[37m[36mINFO[0m[0m 03/19 11:27:49 | 0.632338    0.659794    0.966602    0.818365    0.887458    0.632338    0.659794    0.951317    0.752577    0.978322    0.881623    0.970166    0.820896    2800        17.670683   0.126765    0.403999    115.900037 
[37m[36mINFO[0m[0m 03/19 11:31:08 | 0.623069    0.647423    0.978703    0.835453    0.822507    0.623069    0.647423    0.970218    0.783505    0.983390    0.899662    0.982501    0.823192    3000        18.932874   0.103686    0.404634    117.708745 
[37m[36mINFO[0m[0m 03/19 11:34:23 | 0.613800    0.645361    0.971459    0.825913    0.922658    0.613800    0.645361    0.956758    0.765178    0.980856    0.897407    0.976764    0.815155    3200        20.195066   0.109291    0.367494    121.709362 
[37m[36mINFO[0m[0m 03/19 11:37:29 | 0.611226    0.620619    0.973183    0.816088    0.908104    0.611226    0.620619    0.961054    0.764032    0.980011    0.877114    0.978485    0.807118    3400        21.457258   0.107369    0.347789    116.224324 
[37m[36mINFO[0m[0m 03/19 11:40:38 | 0.621524    0.657732    0.980292    0.830147    0.883786    0.621524    0.657732    0.968786    0.760596    0.989302    0.894025    0.982788    0.835821    3600        22.719449   0.090917    0.352453    118.778773 
[37m[36mINFO[0m[0m 03/19 11:43:47 | 0.615860    0.639175    0.975732    0.817527    0.958850    0.615860    0.639175    0.960767    0.749141    0.985360    0.894025    0.981067    0.809414    3800        23.981641   0.085830    0.355664    117.136424 
[37m[36mINFO[0m[0m 03/19 11:47:02 | 0.624614    0.643299    0.972608    0.817972    1.004777    0.624614    0.643299    0.961054    0.766323    0.980293    0.881623    0.976477    0.805970    4000        25.243832   0.088077    0.372910    121.282073 
[37m[36mINFO[0m[0m 03/19 11:50:15 | 0.618435    0.643299    0.983155    0.830068    0.924841    0.618435    0.643299    0.971936    0.765178    0.989865    0.906426    0.987665    0.818599    4200        26.506024   0.090477    0.360552    120.151860 
[37m[36mINFO[0m[0m 03/19 11:53:19 | 0.619464    0.643299    0.979445    0.818627    0.989394    0.619464    0.643299    0.963918    0.747995    0.987613    0.901917    0.986804    0.805970    4400        27.768216   0.081789    0.350019    114.716087 
[37m[36mINFO[0m[0m 03/19 11:56:32 | 0.590628    0.612371    0.982207    0.831966    1.006519    0.590628    0.612371    0.973368    0.775487    0.988457    0.907554    0.984796    0.812859    4600        29.030407   0.081538    0.365184    119.557055 
[37m[36mINFO[0m[0m 03/19 11:59:44 | 0.621009    0.622680    0.979733    0.824470    0.967131    0.621009    0.622680    0.968499    0.759450    0.987050    0.883878    0.983649    0.830080    4800        30.292599   0.078553    0.361979    119.260667 
[37m[36mINFO[0m[0m 03/19 12:02:56 | 0.600412    0.628866    0.979555    0.816411    1.118915    0.600412    0.628866    0.967068    0.751432    0.985079    0.888388    0.986517    0.809414    5000        31.554791   0.066735    0.381853    115.838991 
[37m[36mINFO[0m[0m 03/19 12:02:56 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[0]/250319_10-40-26_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 12:02:57 | ---
[37m[36mINFO[0m[0m 03/19 12:02:57 | test-domain validation(oracle) = 62.719%
[37m[36mINFO[0m[0m 03/19 12:02:57 | training-domain validation(iid) = 62.307%
[37m[36mINFO[0m[0m 03/19 12:02:57 | last = 60.041%
[37m[36mINFO[0m[0m 03/19 12:02:57 | last (inD) = 81.641%
[37m[36mINFO[0m[0m 03/19 12:02:57 | training-domain validation (iid, inD) = 83.545%
[37m[36mINFO[0m[0m 03/19 12:02:57 | === Summary ===
[37m[36mINFO[0m[0m 03/19 12:02:57 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 0 --hparams_seed 10
[37m[36mINFO[0m[0m 03/19 12:02:57 | Unique name: 250319_10-40-26_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 12:02:57 | Out path: train_output/OfficeHome/ERM/[0]/250319_10-40-26_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 12:02:57 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 12:02:57 | Dataset: OfficeHome

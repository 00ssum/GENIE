[37m[36mINFO[0m[0m 03/19 02:36:04 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 0 --hparams_seed 4
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 4
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/OfficeHome/ERM/[0]/250319_02-36-04_resnet50_Sign_GENIE
	out_root: train_output/OfficeHome/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250319_02-36-04_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.0793009436922532e-05
	batch_size: 30
	weight_decay: 0.0007980067844361917
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/19 02:36:04 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 02:36:04 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 02:36:04 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 02:36:04 | 
[37m[36mINFO[0m[0m 03/19 02:36:04 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 02:36:04 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 02:36:04 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 02:36:04 | Batch sizes for each domain: [0, 30, 30, 30] (total=90)
[37m[36mINFO[0m[0m 03/19 02:36:04 | steps-per-epoch for each domain: 116.40, 118.40, 116.20 -> min = 116.20
[37m[36mINFO[0m[0m 03/19 02:36:05 | # of params = 23641217
[37m[36mINFO[0m[0m 03/19 02:38:03 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 02:38:03 | 0.019053    0.012371    0.011978    0.014442    4.225196    0.019053    0.012371    0.011455    0.014891    0.010135    0.014656    0.014343    0.013777    0           0.000000    4.296294    1.102969    116.363890 
[37m[36mINFO[0m[0m 03/19 02:41:37 | 0.604016    0.620619    0.791027    0.740804    0.935315    0.604016    0.620619    0.718213    0.655212    0.835304    0.810598    0.819564    0.756602    200         1.721170    1.969583    0.484735    117.430111 
[37m[36mINFO[0m[0m 03/19 02:45:10 | 0.606076    0.639175    0.854848    0.788651    0.804577    0.606076    0.639175    0.799828    0.701031    0.896959    0.865840    0.867757    0.799082    400         3.442341    0.748861    0.484412    115.846594 
[37m[36mINFO[0m[0m 03/19 02:48:42 | 0.624614    0.672165    0.889833    0.799641    0.777701    0.624614    0.672165    0.844502    0.706758    0.925113    0.882751    0.899885    0.809414    600         5.163511    0.512524    0.472700    117.587645 
[37m[36mINFO[0m[0m 03/19 02:52:15 | 0.643666    0.665979    0.913914    0.814913    0.747419    0.643666    0.665979    0.877721    0.744559    0.939752    0.883878    0.924269    0.816303    800         6.884682    0.422718    0.479446    117.160353 
[37m[36mINFO[0m[0m 03/19 02:55:45 | 0.615860    0.628866    0.930464    0.816083    0.740983    0.615860    0.628866    0.904353    0.752577    0.951295    0.879369    0.935743    0.816303    1000        8.605852    0.321167    0.465470    116.963858 
[37m[36mINFO[0m[0m 03/19 02:59:19 | 0.638002    0.655670    0.942763    0.829412    0.701820    0.638002    0.655670    0.922967    0.766323    0.955236    0.888388    0.950086    0.833525    1200        10.327022   0.275008    0.476126    118.776745 
[37m[36mINFO[0m[0m 03/19 03:02:53 | 0.617405    0.616495    0.949224    0.822185    0.750712    0.617405    0.616495    0.930412    0.770905    0.961149    0.880496    0.956110    0.815155    1400        12.048193   0.220784    0.484016    117.432966 
[37m[36mINFO[0m[0m 03/19 03:06:28 | 0.628733    0.665979    0.961283    0.816413    0.844186    0.628733    0.665979    0.943872    0.739977    0.973255    0.889515    0.966724    0.819747    1600        13.769363   0.191956    0.484989    118.064580 
[37m[36mINFO[0m[0m 03/19 03:10:02 | 0.622039    0.647423    0.966246    0.822110    0.820539    0.622039    0.647423    0.948740    0.751432    0.974381    0.895152    0.975617    0.819747    1800        15.490534   0.169629    0.484808    116.733780 
[37m[36mINFO[0m[0m 03/19 03:13:38 | 0.613800    0.637113    0.963778    0.823276    0.902349    0.613800    0.637113    0.950172    0.756014    0.971284    0.891770    0.969880    0.822044    2000        17.211704   0.136469    0.493028    117.576211 
[37m[36mINFO[0m[0m 03/19 03:17:13 | 0.623069    0.661856    0.972129    0.824082    0.877448    0.623069    0.661856    0.960195    0.774341    0.980574    0.882751    0.975617    0.815155    2200        18.932874   0.124826    0.484961    117.711772 
[37m[36mINFO[0m[0m 03/19 03:20:51 | 0.613800    0.645361    0.976979    0.825969    0.853211    0.613800    0.645361    0.965063    0.773196    0.984234    0.887260    0.981641    0.817451    2400        20.654045   0.109563    0.502793    117.529582 
[37m[36mINFO[0m[0m 03/19 03:24:25 | 0.621009    0.643299    0.977660    0.828220    0.876609    0.621009    0.643299    0.964490    0.769759    0.982545    0.895152    0.985944    0.819747    2600        22.375215   0.106421    0.479998    117.636174 
[37m[36mINFO[0m[0m 03/19 03:27:56 | 0.616375    0.657732    0.974212    0.828198    0.840209    0.616375    0.657732    0.961913    0.770905    0.983671    0.898534    0.977051    0.815155    2800        24.096386   0.100492    0.478983    115.284989 
[37m[36mINFO[0m[0m 03/19 03:31:32 | 0.621524    0.653608    0.979538    0.827030    0.876008    0.621524    0.653608    0.967354    0.760596    0.987613    0.903044    0.983649    0.817451    3000        25.817556   0.093231    0.483295    119.515082 
[37m[36mINFO[0m[0m 03/19 03:35:00 | 0.629763    0.643299    0.982026    0.822496    0.826593    0.629763    0.643299    0.971649    0.757159    0.987050    0.894025    0.987378    0.816303    3200        27.538726   0.076431    0.467219    114.946874 
[37m[36mINFO[0m[0m 03/19 03:38:37 | 0.613800    0.616495    0.982864    0.836130    0.859579    0.613800    0.616495    0.973081    0.772050    0.990428    0.915445    0.985083    0.820896    3400        29.259897   0.071283    0.494146    117.654417 
[37m[36mINFO[0m[0m 03/19 03:42:06 | 0.617405    0.618557    0.985345    0.835017    0.870367    0.617405    0.618557    0.976231    0.781214    0.990991    0.908681    0.988812    0.815155    3600        30.981067   0.078976    0.471837    115.064629 
[37m[36mINFO[0m[0m 03/19 03:45:39 | 0.616375    0.657732    0.985538    0.835062    0.923509    0.616375    0.657732    0.976518    0.784651    0.990709    0.900789    0.989386    0.819747    3800        32.702238   0.063562    0.477223    117.232682 
[37m[36mINFO[0m[0m 03/19 03:49:13 | 0.617920    0.637113    0.986573    0.829720    0.915104    0.617920    0.637113    0.975086    0.773196    0.993525    0.899662    0.991107    0.816303    4000        34.423408   0.067542    0.485618    117.333462 
[37m[36mINFO[0m[0m 03/19 03:52:47 | 0.599897    0.614433    0.985932    0.821318    0.974058    0.599897    0.614433    0.978236    0.759450    0.988739    0.898534    0.990820    0.805970    4200        36.144578   0.056670    0.476654    118.114167 
[37m[36mINFO[0m[0m 03/19 03:56:25 | 0.611740    0.641237    0.978491    0.824408    0.905933    0.611740    0.641237    0.966208    0.758305    0.987050    0.894025    0.982215    0.820896    4400        37.865749   0.058648    0.502634    117.280485 
[37m[36mINFO[0m[0m 03/19 03:59:59 | 0.624614    0.647423    0.988388    0.834998    0.922649    0.624614    0.647423    0.977663    0.760596    0.993525    0.914318    0.993976    0.830080    4600        39.586919   0.049420    0.496326    115.270158 
[37m[36mINFO[0m[0m 03/19 04:03:33 | 0.632853    0.647423    0.989054    0.834636    0.887445    0.632853    0.647423    0.979954    0.778923    0.993806    0.908681    0.993402    0.816303    4800        41.308090   0.047695    0.488629    115.751514 
[37m[36mINFO[0m[0m 03/19 04:07:03 | 0.619464    0.635052    0.988855    0.841873    0.805096    0.619464    0.635052    0.978522    0.778923    0.995214    0.914318    0.992828    0.832377    5000        43.029260   0.050466    0.474326    115.806754 
[37m[36mINFO[0m[0m 03/19 04:07:04 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[0]/250319_02-36-04_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 04:07:05 | ---
[37m[36mINFO[0m[0m 03/19 04:07:05 | test-domain validation(oracle) = 62.461%
[37m[36mINFO[0m[0m 03/19 04:07:05 | training-domain validation(iid) = 61.946%
[37m[36mINFO[0m[0m 03/19 04:07:05 | last = 61.946%
[37m[36mINFO[0m[0m 03/19 04:07:05 | last (inD) = 84.187%
[37m[36mINFO[0m[0m 03/19 04:07:05 | training-domain validation (iid, inD) = 84.187%
[37m[36mINFO[0m[0m 03/19 04:07:05 | === Summary ===
[37m[36mINFO[0m[0m 03/19 04:07:05 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 0 --hparams_seed 4
[37m[36mINFO[0m[0m 03/19 04:07:05 | Unique name: 250319_02-36-04_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 04:07:05 | Out path: train_output/OfficeHome/ERM/[0]/250319_02-36-04_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 04:07:05 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 04:07:05 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 03/11 18:45:48 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 2 --hparams_seed 10
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 10
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/OfficeHome/ERM/[0]/250311_18-45-48_clip_vitb16_GENIE
	out_root: train_output/OfficeHome/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 2
	unique_name: 250311_18-45-48_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 7.494887873901297e-05
	batch_size: 23
	weight_decay: 0.000495139494108363
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/11 18:45:48 | n_steps = 5001
[37m[36mINFO[0m[0m 03/11 18:45:48 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/11 18:45:48 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/11 18:45:48 | 
[37m[36mINFO[0m[0m 03/11 18:45:48 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/11 18:45:48 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/11 18:45:48 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/11 18:45:48 | Batch sizes for each domain: [0, 23, 23, 23] (total=69)
[37m[36mINFO[0m[0m 03/11 18:45:48 | steps-per-epoch for each domain: 151.83, 154.43, 151.57 -> min = 151.57
[37m[36mINFO[0m[0m 03/11 18:45:50 | # of params = 86225985
[37m[36mINFO[0m[0m 03/11 18:47:48 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/11 18:47:48 | 0.011329    0.026804    0.016981    0.011797    4.201580    0.011329    0.026804    0.015750    0.014891    0.019989    0.009019    0.015204    0.011481    0           0.000000    4.249291    1.723963    116.526958 
[37m[36mINFO[0m[0m 03/11 18:51:23 | 0.018538    0.022680    0.035596    0.027710    4.116251    0.018538    0.022680    0.035223    0.017182    0.038288    0.034949    0.033276    0.030999    200         1.319564    4.153272    0.494332    115.448938 
[37m[36mINFO[0m[0m 03/11 18:54:46 | 0.058187    0.059794    0.070637    0.064605    3.913673    0.058187    0.059794    0.064433    0.052692    0.074043    0.067644    0.073437    0.073479    400         2.639128    4.046339    0.439745    115.615099 
[37m[36mINFO[0m[0m 03/11 18:58:03 | 0.163234    0.150515    0.312029    0.296636    2.780678    0.163234    0.150515    0.261741    0.239404    0.367117    0.338219    0.307229    0.312285    600         3.958692    3.382398    0.411119    114.801810 
[37m[36mINFO[0m[0m 03/11 19:01:25 | 0.307930    0.313402    0.571737    0.533556    1.831079    0.307930    0.313402    0.461913    0.430699    0.681869    0.622322    0.571429    0.547646    800         5.278256    2.298903    0.407877    120.660027 
[37m[36mINFO[0m[0m 03/11 19:04:59 | 0.349640    0.373196    0.689413    0.604161    1.486866    0.349640    0.373196    0.588774    0.471936    0.781532    0.711387    0.697935    0.629162    1000        6.597820    1.462259    0.453712    122.897927 
[37m[36mINFO[0m[0m 03/11 19:08:39 | 0.364573    0.397938    0.787197    0.679692    1.182872    0.364573    0.397938    0.701604    0.561283    0.867962    0.802706    0.792025    0.675086    1200        7.917384    0.991594    0.516438    117.126994 
[37m[36mINFO[0m[0m 03/11 19:12:20 | 0.429969    0.461856    0.841473    0.710617    1.067068    0.429969    0.461856    0.776632    0.620848    0.897241    0.807215    0.850545    0.703789    1400        9.236948    0.769090    0.531068    114.219334 
[37m[36mINFO[0m[0m 03/11 19:16:00 | 0.407312    0.472165    0.846873    0.715506    1.066896    0.407312    0.472165    0.798969    0.616266    0.903153    0.821871    0.838497    0.708381    1600        10.556512   0.596159    0.509594    118.288774 
[37m[36mINFO[0m[0m 03/11 19:19:30 | 0.426365    0.447423    0.892773    0.738675    0.968900    0.426365    0.447423    0.852520    0.648339    0.928209    0.846674    0.897590    0.721010    1800        11.876076   0.499091    0.457212    118.422425 
[37m[36mINFO[0m[0m 03/11 19:22:46 | 0.441813    0.501031    0.909231    0.744392    0.966291    0.441813    0.501031    0.870561    0.642612    0.940034    0.851184    0.917097    0.739380    2000        13.195640   0.387434    0.389742    118.574614 
[37m[36mINFO[0m[0m 03/11 19:26:02 | 0.407312    0.445361    0.920785    0.745524    0.971071    0.407312    0.445361    0.891180    0.644903    0.955800    0.853439    0.915376    0.738232    2200        14.515204   0.312480    0.393062    116.884885 
[37m[36mINFO[0m[0m 03/11 19:29:24 | 0.432029    0.463918    0.922899    0.744008    1.003578    0.432029    0.463918    0.886025    0.643757    0.954673    0.851184    0.927998    0.737084    2400        15.834768   0.285315    0.429559    115.729807 
[37m[36mINFO[0m[0m 03/11 19:33:03 | 0.475798    0.511340    0.940924    0.758163    0.943694    0.475798    0.511340    0.915235    0.678121    0.959459    0.847802    0.948078    0.748565    2600        17.154332   0.215690    0.487859    121.371763 
[37m[36mINFO[0m[0m 03/11 19:36:45 | 0.442842    0.474227    0.941946    0.754283    0.989346    0.442842    0.474227    0.920389    0.656357    0.963682    0.859076    0.941767    0.747417    2800        18.473896   0.209184    0.528533    117.058334 
[37m[36mINFO[0m[0m 03/11 19:40:26 | 0.455201    0.498969    0.958680    0.780928    0.867914    0.455201    0.498969    0.935281    0.701031    0.977477    0.877114    0.963282    0.764638    3000        19.793460   0.186143    0.521976    116.235665 
[37m[36mINFO[0m[0m 03/11 19:43:59 | 0.458805    0.517526    0.968783    0.785807    0.855694    0.458805    0.517526    0.958477    0.709049    0.980574    0.891770    0.967298    0.756602    3200        21.113024   0.152416    0.453713    122.417374 
[37m[36mINFO[0m[0m 03/11 19:47:24 | 0.459835    0.523711    0.962812    0.775983    0.890457    0.459835    0.523711    0.949313    0.697595    0.972973    0.872604    0.966150    0.757750    3400        22.432587   0.133608    0.421733    120.112456 
[37m[36mINFO[0m[0m 03/11 19:50:44 | 0.485067    0.511340    0.971743    0.784371    0.902801    0.485067    0.511340    0.953608    0.711340    0.981700    0.875986    0.979920    0.765786    3600        23.752151   0.120306    0.404354    119.053308 
[37m[36mINFO[0m[0m 03/11 19:54:15 | 0.500515    0.509278    0.976959    0.793832    0.859885    0.500515    0.509278    0.963918    0.715922    0.987613    0.892897    0.979346    0.772675    3800        25.071715   0.100801    0.451907    120.556463 
[37m[36mINFO[0m[0m 03/11 19:57:51 | 0.482492    0.529897    0.979536    0.801092    0.849055    0.482492    0.529897    0.971649    0.712486    0.987613    0.895152    0.979346    0.795637    4000        26.391279   0.090213    0.495533    117.176113 
[37m[36mINFO[0m[0m 03/11 20:01:14 | 0.442327    0.496907    0.970609    0.772946    0.942212    0.442327    0.496907    0.960767    0.682703    0.978885    0.870349    0.972174    0.765786    4200        27.710843   0.094067    0.421729    119.005700 
[37m[36mINFO[0m[0m 03/11 20:04:37 | 0.460865    0.486598    0.977012    0.778291    0.926526    0.460865    0.486598    0.969359    0.699885    0.978604    0.870349    0.983075    0.764638    4400        29.030407   0.084374    0.407111    121.569417 
[37m[36mINFO[0m[0m 03/11 20:07:52 | 0.474253    0.540206    0.980197    0.785413    0.868109    0.474253    0.540206    0.967068    0.687285    0.989302    0.896280    0.984223    0.772675    4600        30.349971   0.084450    0.387344    117.154113 
[37m[36mINFO[0m[0m 03/11 20:11:19 | 0.473738    0.515464    0.982208    0.793490    0.902005    0.473738    0.515464    0.974513    0.689576    0.988176    0.889515    0.983936    0.801378    4800        31.669535   0.068685    0.448743    117.753642 
[37m[36mINFO[0m[0m 03/11 20:15:04 | 0.483522    0.536082    0.980778    0.782760    0.930563    0.483522    0.536082    0.969931    0.717068    0.987894    0.888388    0.984509    0.742824    5000        32.989099   0.058913    0.524702    119.472581 
[37m[36mINFO[0m[0m 03/11 20:15:04 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[0]/250311_18-45-48_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/11 20:15:07 | ---
[37m[36mINFO[0m[0m 03/11 20:15:07 | test-domain validation(oracle) = 47.425%
[37m[36mINFO[0m[0m 03/11 20:15:07 | training-domain validation(iid) = 48.249%
[37m[36mINFO[0m[0m 03/11 20:15:07 | last = 48.352%
[37m[36mINFO[0m[0m 03/11 20:15:07 | last (inD) = 78.276%
[37m[36mINFO[0m[0m 03/11 20:15:07 | training-domain validation (iid, inD) = 80.109%
[37m[36mINFO[0m[0m 03/11 20:15:07 | === Summary ===
[37m[36mINFO[0m[0m 03/11 20:15:07 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 2 --hparams_seed 10
[37m[36mINFO[0m[0m 03/11 20:15:07 | Unique name: 250311_18-45-48_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/11 20:15:07 | Out path: train_output/OfficeHome/ERM/[0]/250311_18-45-48_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/11 20:15:07 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/11 20:15:07 | Dataset: OfficeHome

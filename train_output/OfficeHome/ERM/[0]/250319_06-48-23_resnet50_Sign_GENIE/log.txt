[37m[36mINFO[0m[0m 03/19 06:48:23 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 0 --hparams_seed 7
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 7
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/OfficeHome/ERM/[0]/250319_06-48-23_resnet50_Sign_GENIE
	out_root: train_output/OfficeHome/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250319_06-48-23_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 1.6632780446310692e-05
	batch_size: 24
	weight_decay: 5.717289389191427e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/19 06:48:23 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 06:48:23 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 06:48:23 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 06:48:23 | 
[37m[36mINFO[0m[0m 03/19 06:48:23 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 06:48:23 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 06:48:23 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 06:48:23 | Batch sizes for each domain: [0, 24, 24, 24] (total=72)
[37m[36mINFO[0m[0m 03/19 06:48:23 | steps-per-epoch for each domain: 145.50, 148.00, 145.25 -> min = 145.25
[37m[36mINFO[0m[0m 03/19 06:48:25 | # of params = 23641217
[37m[36mINFO[0m[0m 03/19 06:50:25 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 06:50:25 | 0.013903    0.010309    0.012360    0.011802    4.225491    0.013903    0.010309    0.011168    0.008018    0.010135    0.009019    0.015777    0.018370    0           0.000000    4.250364    2.428544    118.014323 
[37m[36mINFO[0m[0m 03/19 06:53:44 | 0.568486    0.569072    0.775939    0.730561    0.970291    0.568486    0.569072    0.693585    0.627721    0.819257    0.799324    0.814974    0.764638    200         1.376936    1.574495    0.415166    115.382218 
[37m[36mINFO[0m[0m 03/19 06:57:01 | 0.598352    0.602062    0.847178    0.777309    0.841727    0.598352    0.602062    0.796678    0.699885    0.885417    0.843292    0.859438    0.788749    400         2.753873    0.613427    0.406705    116.328912 
[37m[36mINFO[0m[0m 03/19 07:00:18 | 0.570546    0.602062    0.872216    0.778115    0.864600    0.570546    0.602062    0.836483    0.701031    0.899212    0.836528    0.880952    0.796785    600         4.130809    0.446410    0.410798    114.977487 
[37m[36mINFO[0m[0m 03/19 07:03:37 | 0.589083    0.597938    0.906101    0.794411    0.833283    0.589083    0.597938    0.875716    0.729668    0.935529    0.859076    0.907057    0.794489    800         5.507745    0.316355    0.397492    119.215813 
[37m[36mINFO[0m[0m 03/19 07:06:51 | 0.577755    0.587629    0.933249    0.809257    0.874433    0.577755    0.587629    0.913230    0.743414    0.948480    0.870349    0.938038    0.814007    1000        6.884682    0.253529    0.389878    116.315387 
[37m[36mINFO[0m[0m 03/19 07:10:07 | 0.602987    0.637113    0.943207    0.814895    0.825447    0.602987    0.637113    0.926976    0.750286    0.960304    0.886133    0.942341    0.808266    1200        8.261618    0.219893    0.388134    117.937094 
[37m[36mINFO[0m[0m 03/19 07:13:24 | 0.601957    0.620619    0.946234    0.812234    0.807591    0.601957    0.620619    0.922967    0.736541    0.965935    0.885006    0.949799    0.815155    1400        9.638554    0.188542    0.401086    116.971375 
[37m[36mINFO[0m[0m 03/19 07:16:41 | 0.617920    0.610309    0.959095    0.816405    0.906317    0.617920    0.610309    0.939863    0.750286    0.971847    0.889515    0.965577    0.809414    1600        11.015491   0.153114    0.385582    119.337887 
[37m[36mINFO[0m[0m 03/19 07:19:57 | 0.598867    0.608247    0.960334    0.808453    0.892031    0.598867    0.608247    0.943585    0.738832    0.972128    0.877114    0.965290    0.809414    1800        12.392427   0.142560    0.401510    116.126174 
[37m[36mINFO[0m[0m 03/19 07:23:14 | 0.585479    0.606186    0.965663    0.810757    0.960924    0.585479    0.606186    0.954467    0.737686    0.975225    0.875986    0.967298    0.818599    2000        13.769363   0.121883    0.392518    118.295779 
[37m[36mINFO[0m[0m 03/19 07:26:31 | 0.593203    0.608247    0.961499    0.811530    0.908296    0.593203    0.608247    0.951317    0.745704    0.968750    0.873732    0.964429    0.815155    2200        15.146299   0.110144    0.401761    116.647886 
[37m[36mINFO[0m[0m 03/19 07:29:50 | 0.600927    0.610309    0.976138    0.815687    0.983711    0.600927    0.610309    0.964777    0.751432    0.981137    0.881623    0.982501    0.814007    2400        16.523236   0.089463    0.403106    118.394324 
[37m[36mINFO[0m[0m 03/19 07:33:07 | 0.622554    0.630928    0.978027    0.822102    0.925585    0.622554    0.630928    0.965922    0.744559    0.984797    0.897407    0.983362    0.824340    2600        17.900172   0.083097    0.395606    118.254714 
[37m[36mINFO[0m[0m 03/19 07:36:22 | 0.592688    0.581443    0.975898    0.818734    0.935975    0.592688    0.581443    0.961054    0.744559    0.989302    0.885006    0.977338    0.826636    2800        19.277108   0.076962    0.391015    116.296893 
[37m[36mINFO[0m[0m 03/19 07:39:36 | 0.610711    0.595876    0.976584    0.814105    0.926589    0.610711    0.595876    0.962486    0.737686    0.986486    0.891770    0.980780    0.812859    3000        20.654045   0.069523    0.399823    114.527240 
[37m[36mINFO[0m[0m 03/19 07:42:53 | 0.596292    0.610309    0.970891    0.816791    0.975018    0.596292    0.610309    0.957331    0.764032    0.980011    0.887260    0.975330    0.799082    3200        22.030981   0.063293    0.386403    119.293342 
[37m[36mINFO[0m[0m 03/19 07:46:14 | 0.580844    0.614433    0.980305    0.822155    0.966327    0.580844    0.614433    0.967640    0.756014    0.987331    0.887260    0.985944    0.823192    3400        23.407917   0.061941    0.405334    119.924494 
[37m[36mINFO[0m[0m 03/19 07:49:29 | 0.584964    0.585567    0.981726    0.821074    0.891239    0.584964    0.585567    0.974800    0.767468    0.988739    0.874859    0.981641    0.820896    3600        24.784854   0.056545    0.388481    117.926780 
[37m[36mINFO[0m[0m 03/19 07:52:45 | 0.610196    0.635052    0.981460    0.819037    0.919200    0.610196    0.635052    0.969931    0.739977    0.985923    0.898534    0.988526    0.818599    3800        26.161790   0.059697    0.384095    118.529620 
[37m[36mINFO[0m[0m 03/19 07:56:00 | 0.611226    0.624742    0.986294    0.826699    0.938911    0.611226    0.624742    0.975659    0.747995    0.992117    0.896280    0.991107    0.835821    4000        27.538726   0.052971    0.387135    117.498584 
[37m[36mINFO[0m[0m 03/19 07:59:14 | 0.599897    0.612371    0.985910    0.820568    1.001445    0.599897    0.612371    0.976518    0.749141    0.992399    0.897407    0.988812    0.815155    4200        28.915663   0.052293    0.405064    113.745159 
[37m[36mINFO[0m[0m 03/19 08:02:32 | 0.595263    0.602062    0.985821    0.820588    0.974846    0.595263    0.602062    0.976518    0.758305    0.991273    0.892897    0.989673    0.810563    4400        30.292599   0.042598    0.397990    117.483674 
[37m[36mINFO[0m[0m 03/19 08:05:48 | 0.607106    0.610309    0.986955    0.812610    1.058814    0.607106    0.610309    0.977950    0.753723    0.993243    0.883878    0.989673    0.800230    4600        31.669535   0.043697    0.398623    116.671549 
[37m[36mINFO[0m[0m 03/19 08:09:09 | 0.589598    0.626804    0.985541    0.817135    0.965508    0.589598    0.626804    0.977377    0.742268    0.990146    0.896280    0.989099    0.812859    4800        33.046472   0.049325    0.417759    117.723241 
[37m[36mINFO[0m[0m 03/19 08:12:23 | 0.610711    0.608247    0.985817    0.819419    1.088180    0.610711    0.608247    0.974800    0.741123    0.992117    0.898534    0.990534    0.818599    5000        34.423408   0.045880    0.395447    114.972226 
[37m[36mINFO[0m[0m 03/19 08:12:23 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[0]/250319_06-48-23_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 08:12:25 | ---
[37m[36mINFO[0m[0m 03/19 08:12:25 | test-domain validation(oracle) = 60.299%
[37m[36mINFO[0m[0m 03/19 08:12:25 | training-domain validation(iid) = 61.123%
[37m[36mINFO[0m[0m 03/19 08:12:25 | last = 61.071%
[37m[36mINFO[0m[0m 03/19 08:12:25 | last (inD) = 81.942%
[37m[36mINFO[0m[0m 03/19 08:12:25 | training-domain validation (iid, inD) = 82.670%
[37m[36mINFO[0m[0m 03/19 08:12:25 | === Summary ===
[37m[36mINFO[0m[0m 03/19 08:12:25 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 0 --hparams_seed 7
[37m[36mINFO[0m[0m 03/19 08:12:25 | Unique name: 250319_06-48-23_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 08:12:25 | Out path: train_output/OfficeHome/ERM/[0]/250319_06-48-23_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 08:12:25 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 08:12:25 | Dataset: OfficeHome

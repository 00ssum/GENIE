[37m[36mINFO[0m[0m 03/19 05:28:45 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 0 --hparams_seed 6
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 6
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/OfficeHome/ERM/[0]/250319_05-28-45_resnet50_Sign_GENIE
	out_root: train_output/OfficeHome/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250319_05-28-45_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 1.5764387170443743e-05
	batch_size: 19
	weight_decay: 0.0006024239579587198
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/19 05:28:45 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 05:28:45 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 05:28:45 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 05:28:45 | 
[37m[36mINFO[0m[0m 03/19 05:28:45 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 05:28:45 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 05:28:45 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 05:28:45 | Batch sizes for each domain: [0, 19, 19, 19] (total=57)
[37m[36mINFO[0m[0m 03/19 05:28:45 | steps-per-epoch for each domain: 183.79, 186.95, 183.47 -> min = 183.47
[37m[36mINFO[0m[0m 03/19 05:28:47 | # of params = 23641217
[37m[36mINFO[0m[0m 03/19 05:30:47 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 05:30:47 | 0.014933    0.006186    0.013583    0.014080    4.227513    0.014933    0.006186    0.012600    0.013746    0.013232    0.011274    0.014917    0.017222    0           0.000000    4.240231    2.516531    117.387393 
[37m[36mINFO[0m[0m 03/19 05:33:56 | 0.562822    0.597938    0.780758    0.733210    0.964804    0.562822    0.597938    0.710767    0.630011    0.826858    0.803833    0.804647    0.765786    200         1.090075    1.720101    0.366507    115.338861 
[37m[36mINFO[0m[0m 03/19 05:37:06 | 0.601442    0.618557    0.838627    0.765526    0.866713    0.601442    0.618557    0.786655    0.674685    0.877534    0.833145    0.851692    0.788749    400         2.180149    0.730834    0.368969    116.220469 
[37m[36mINFO[0m[0m 03/19 05:40:17 | 0.583419    0.612371    0.854272    0.781472    0.838821    0.583419    0.612371    0.801546    0.697595    0.897241    0.851184    0.864028    0.795637    600         3.270224    0.557235    0.365123    118.459785 
[37m[36mINFO[0m[0m 03/19 05:43:30 | 0.567456    0.600000    0.890176    0.786841    0.866663    0.567456    0.600000    0.855097    0.719359    0.915259    0.846674    0.900172    0.794489    800         4.360298    0.409842    0.384357    116.171760 
[37m[36mINFO[0m[0m 03/19 05:46:42 | 0.576725    0.622680    0.918798    0.795508    0.784640    0.576725    0.622680    0.891753    0.714777    0.937218    0.869222    0.927424    0.802526    1000        5.450373    0.366576    0.379388    116.226728 
[37m[36mINFO[0m[0m 03/19 05:49:54 | 0.580330    0.624742    0.925332    0.801585    0.816251    0.580330    0.624742    0.901775    0.730813    0.946509    0.874859    0.927711    0.799082    1200        6.540448    0.297370    0.381769    115.401063 
[37m[36mINFO[0m[0m 03/19 05:53:09 | 0.602987    0.616495    0.942741    0.809580    0.845311    0.602987    0.616495    0.917526    0.739977    0.959178    0.880496    0.951520    0.808266    1400        7.630522    0.249606    0.382976    118.593777 
[37m[36mINFO[0m[0m 03/19 05:56:24 | 0.595263    0.620619    0.942066    0.800841    0.840198    0.595263    0.620619    0.918099    0.729668    0.960023    0.871477    0.948078    0.801378    1600        8.720597    0.208316    0.380930    118.049242 
[37m[36mINFO[0m[0m 03/19 05:59:23 | 0.614830    0.614433    0.954914    0.811516    0.795464    0.614830    0.614433    0.940435    0.746850    0.967624    0.875986    0.956684    0.811711    1800        9.810671    0.188332    0.311365    117.080166 
[37m[36mINFO[0m[0m 03/19 06:02:24 | 0.587024    0.575258    0.952983    0.817205    0.817323    0.587024    0.575258    0.935567    0.750286    0.971002    0.883878    0.952381    0.817451    2000        10.900746   0.158407    0.319744    116.598709 
[37m[36mINFO[0m[0m 03/19 06:05:28 | 0.598867    0.606186    0.962733    0.812991    0.914645    0.598867    0.606186    0.952176    0.756014    0.970158    0.883878    0.965863    0.799082    2200        11.990820   0.145700    0.325526    119.355916 
[37m[36mINFO[0m[0m 03/19 06:08:30 | 0.611740    0.616495    0.966406    0.806541    0.939625    0.611740    0.616495    0.947881    0.737686    0.979448    0.877114    0.971888    0.804822    2400        13.080895   0.120284    0.320172    117.845988 
[37m[36mINFO[0m[0m 03/19 06:11:27 | 0.586509    0.591753    0.969383    0.808855    0.862829    0.586509    0.591753    0.956186    0.750286    0.976633    0.872604    0.975330    0.803674    2600        14.170970   0.118992    0.308191    115.440408 
[37m[36mINFO[0m[0m 03/19 06:14:30 | 0.609166    0.630928    0.968883    0.821723    0.898643    0.609166    0.630928    0.954467    0.749141    0.980293    0.896280    0.971888    0.819747    2800        15.261044   0.092961    0.331387    117.179675 
[37m[36mINFO[0m[0m 03/19 06:17:32 | 0.596292    0.600000    0.963017    0.800833    0.997821    0.596292    0.600000    0.947308    0.739977    0.971002    0.871477    0.970740    0.791045    3000        16.351119   0.111949    0.315209    118.876207 
[37m[36mINFO[0m[0m 03/19 06:20:32 | 0.595778    0.612371    0.974307    0.824399    0.905383    0.595778    0.612371    0.962772    0.761741    0.983671    0.895152    0.976477    0.816303    3200        17.441193   0.095554    0.316825    116.333464 
[37m[36mINFO[0m[0m 03/19 06:23:33 | 0.593203    0.591753    0.970512    0.814116    0.907861    0.593203    0.591753    0.957331    0.750286    0.979448    0.888388    0.974756    0.803674    3400        18.531268   0.086120    0.320282    117.095077 
[37m[36mINFO[0m[0m 03/19 06:26:30 | 0.592173    0.616495    0.974780    0.819100    0.863551    0.592173    0.616495    0.958763    0.766323    0.984797    0.885006    0.980780    0.805970    3600        19.621343   0.085705    0.297143    117.089029 
[37m[36mINFO[0m[0m 03/19 06:29:33 | 0.607106    0.641237    0.970706    0.824794    0.908705    0.607106    0.641237    0.954754    0.772050    0.979167    0.891770    0.978199    0.810563    3800        20.711417   0.083619    0.340554    114.647114 
[37m[36mINFO[0m[0m 03/19 06:32:35 | 0.596292    0.614433    0.980119    0.822100    0.990017    0.596292    0.614433    0.971649    0.765178    0.986205    0.895152    0.982501    0.805970    4000        21.801492   0.073813    0.343082    114.311574 
[37m[36mINFO[0m[0m 03/19 06:35:37 | 0.604531    0.614433    0.981646    0.824764    0.836690    0.604531    0.614433    0.972795    0.766323    0.986486    0.897407    0.985657    0.810563    4200        22.891566   0.072951    0.325766    116.541904 
[37m[36mINFO[0m[0m 03/19 06:38:42 | 0.606076    0.622680    0.980029    0.828999    0.901398    0.606076    0.622680    0.970504    0.778923    0.985360    0.891770    0.984223    0.816303    4400        23.981641   0.061448    0.344408    116.427644 
[37m[36mINFO[0m[0m 03/19 06:41:52 | 0.594748    0.630928    0.979913    0.822496    0.925620    0.594748    0.630928    0.965063    0.765178    0.989020    0.892897    0.985657    0.809414    4600        25.071715   0.077726    0.359767    117.410919 
[37m[36mINFO[0m[0m 03/19 06:45:04 | 0.606591    0.616495    0.983463    0.824006    0.989627    0.606591    0.616495    0.975372    0.766323    0.986205    0.896280    0.988812    0.809414    4800        26.161790   0.055064    0.361432    119.727875 
[37m[36mINFO[0m[0m 03/19 06:48:17 | 0.606076    0.600000    0.983906    0.817107    1.009935    0.606076    0.600000    0.972222    0.743414    0.992117    0.900789    0.987378    0.807118    5000        27.251865   0.058013    0.365572    120.026463 
[37m[36mINFO[0m[0m 03/19 06:48:17 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[0]/250319_05-28-45_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 06:48:18 | ---
[37m[36mINFO[0m[0m 03/19 06:48:18 | test-domain validation(oracle) = 60.711%
[37m[36mINFO[0m[0m 03/19 06:48:18 | training-domain validation(iid) = 60.608%
[37m[36mINFO[0m[0m 03/19 06:48:18 | last = 60.608%
[37m[36mINFO[0m[0m 03/19 06:48:18 | last (inD) = 81.711%
[37m[36mINFO[0m[0m 03/19 06:48:18 | training-domain validation (iid, inD) = 82.900%
[37m[36mINFO[0m[0m 03/19 06:48:18 | === Summary ===
[37m[36mINFO[0m[0m 03/19 06:48:18 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 0 --hparams_seed 6
[37m[36mINFO[0m[0m 03/19 06:48:18 | Unique name: 250319_05-28-45_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 06:48:18 | Out path: train_output/OfficeHome/ERM/[0]/250319_05-28-45_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 06:48:18 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 06:48:18 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 03/19 15:25:33 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 0 --hparams_seed 14
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 14
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/OfficeHome/ERM/[0]/250319_15-25-33_resnet50_Sign_GENIE
	out_root: train_output/OfficeHome/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250319_15-25-33_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.1399727535070965e-05
	batch_size: 16
	weight_decay: 0.00022842646099519332
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/19 15:25:33 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 15:25:33 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 15:25:33 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 15:25:33 | 
[37m[36mINFO[0m[0m 03/19 15:25:33 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 15:25:33 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 15:25:33 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 15:25:33 | Batch sizes for each domain: [0, 16, 16, 16] (total=48)
[37m[36mINFO[0m[0m 03/19 15:25:33 | steps-per-epoch for each domain: 218.25, 222.00, 217.88 -> min = 217.88
[37m[36mINFO[0m[0m 03/19 15:25:35 | # of params = 23641217
[37m[36mINFO[0m[0m 03/19 15:27:35 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 15:27:35 | 0.019567    0.006186    0.016640    0.012551    4.226770    0.019567    0.006186    0.017468    0.011455    0.013232    0.011274    0.019220    0.014925    0           0.000000    4.268681    1.263231    118.729322 
[37m[36mINFO[0m[0m 03/19 15:30:28 | 0.554583    0.567010    0.758779    0.721720    1.038636    0.554583    0.567010    0.671535    0.615120    0.813063    0.807215    0.791738    0.742824    200         0.917958    1.782544    0.269389    119.528219 
[37m[36mINFO[0m[0m 03/19 15:33:20 | 0.569001    0.591753    0.819345    0.751931    0.958118    0.569001    0.591753    0.764032    0.671249    0.859234    0.803833    0.834768    0.780712    400         1.835915    0.752200    0.270252    117.976294 
[37m[36mINFO[0m[0m 03/19 15:36:12 | 0.561792    0.600000    0.830458    0.756817    0.996809    0.561792    0.600000    0.775773    0.671249    0.869932    0.818489    0.845668    0.780712    600         2.753873    0.588035    0.265574    118.964770 
[37m[36mINFO[0m[0m 03/19 15:39:05 | 0.564367    0.571134    0.878246    0.780689    0.829244    0.564367    0.571134    0.834192    0.702176    0.913570    0.853439    0.886976    0.786452    800         3.671830    0.470485    0.271103    118.615137 
[37m[36mINFO[0m[0m 03/19 15:41:54 | 0.580330    0.612371    0.900698    0.795542    0.854010    0.580330    0.612371    0.870561    0.725086    0.928491    0.862458    0.903041    0.799082    1000        4.589788    0.387340    0.258540    116.576615 
[37m[36mINFO[0m[0m 03/19 15:44:49 | 0.597322    0.597938    0.909726    0.787925    0.847025    0.597322    0.597938    0.874857    0.703322    0.936937    0.859076    0.917384    0.801378    1200        5.507745    0.330550    0.255138    123.969145 
[37m[36mINFO[0m[0m 03/19 15:47:34 | 0.571061    0.589691    0.931704    0.803936    0.847802    0.571061    0.589691    0.912371    0.749141    0.951014    0.863585    0.931727    0.799082    1400        6.425703    0.273107    0.247125    116.363837 
[37m[36mINFO[0m[0m 03/19 15:50:25 | 0.603502    0.602062    0.928831    0.812624    0.798890    0.603502    0.602062    0.898625    0.735395    0.952984    0.883878    0.934882    0.818599    1600        7.343660    0.255463    0.266183    117.713557 
[37m[36mINFO[0m[0m 03/19 15:53:19 | 0.585479    0.595876    0.936200    0.798160    0.925361    0.585479    0.595876    0.918958    0.731959    0.950169    0.871477    0.939472    0.791045    1800        8.261618    0.216934    0.263388    121.111290 
[37m[36mINFO[0m[0m 03/19 15:56:13 | 0.574665    0.585567    0.953087    0.818333    0.855582    0.574665    0.585567    0.930412    0.758305    0.970158    0.886133    0.958692    0.810563    2000        9.179575    0.204701    0.256675    122.803896 
[37m[36mINFO[0m[0m 03/19 15:59:01 | 0.598352    0.589691    0.956512    0.816847    0.924229    0.598352    0.589691    0.933276    0.754868    0.972691    0.879369    0.963569    0.816303    2200        10.097533   0.174506    0.260457    115.987496 
[37m[36mINFO[0m[0m 03/19 16:01:51 | 0.595263    0.641237    0.960334    0.804251    0.954622    0.595263    0.641237    0.941867    0.737686    0.972410    0.875986    0.966724    0.799082    2400        11.015491   0.158520    0.257411    117.815106 
[37m[36mINFO[0m[0m 03/19 16:04:44 | 0.575180    0.575258    0.955906    0.808500    0.859622    0.575180    0.575258    0.941008    0.731959    0.961993    0.870349    0.964716    0.823192    2600        11.933448   0.152739    0.283778    116.461818 
[37m[36mINFO[0m[0m 03/19 16:07:47 | 0.566426    0.571134    0.956341    0.809110    0.926999    0.566426    0.571134    0.937572    0.736541    0.969032    0.895152    0.962421    0.795637    2800        12.851406   0.134577    0.297505    123.381398 
[37m[36mINFO[0m[0m 03/19 16:10:46 | 0.558187    0.571134    0.967661    0.811934    0.931990    0.558187    0.571134    0.954181    0.754868    0.976914    0.869222    0.971888    0.811711    3000        13.769363   0.128494    0.314286    116.256519 
[37m[36mINFO[0m[0m 03/19 16:13:50 | 0.574150    0.610309    0.962310    0.805760    0.931869    0.574150    0.610309    0.945017    0.747995    0.977196    0.878241    0.964716    0.791045    3200        14.687321   0.106265    0.302527    123.708612 
[37m[36mINFO[0m[0m 03/19 16:16:47 | 0.608651    0.612371    0.965854    0.809966    1.020516    0.608651    0.612371    0.949885    0.744559    0.975788    0.879369    0.971888    0.805970    3400        15.605278   0.090602    0.290048    118.605896 
[37m[36mINFO[0m[0m 03/19 16:19:42 | 0.585479    0.602062    0.976416    0.829018    0.946838    0.585479    0.602062    0.965636    0.762887    0.982545    0.890643    0.981067    0.833525    3600        16.523236   0.086384    0.279446    119.093109 
[37m[36mINFO[0m[0m 03/19 16:22:37 | 0.601442    0.628866    0.971460    0.809175    0.951383    0.601442    0.628866    0.959622    0.751432    0.980574    0.882751    0.974182    0.793341    3800        17.441193   0.094686    0.295854    116.176613 
[37m[36mINFO[0m[0m 03/19 16:25:45 | 0.588054    0.630928    0.973365    0.815237    0.982458    0.588054    0.630928    0.957045    0.741123    0.981982    0.894025    0.981067    0.810563    4000        18.359151   0.093354    0.321302    123.629530 
[37m[36mINFO[0m[0m 03/19 16:28:49 | 0.602472    0.639175    0.977837    0.817163    0.951132    0.602472    0.639175    0.970218    0.751432    0.984234    0.890643    0.979059    0.809414    4200        19.277108   0.087379    0.308508    121.908755 
[37m[36mINFO[0m[0m 03/19 16:31:45 | 0.580330    0.614433    0.976703    0.824411    0.976523    0.580330    0.614433    0.966208    0.764032    0.982545    0.892897    0.981354    0.816303    4400        20.195066   0.074083    0.284971    119.812862 
[37m[36mINFO[0m[0m 03/19 16:34:47 | 0.576210    0.571134    0.980973    0.819030    0.951823    0.576210    0.571134    0.970790    0.758305    0.987331    0.897407    0.984796    0.801378    4600        21.113024   0.076070    0.309072    120.147379 
[37m[36mINFO[0m[0m 03/19 16:37:42 | 0.589083    0.600000    0.982682    0.826665    0.976003    0.589083    0.600000    0.973368    0.765178    0.989020    0.899662    0.985657    0.815155    4800        22.030981   0.066519    0.269954    120.480009 
[37m[36mINFO[0m[0m 03/19 16:40:37 | 0.595778    0.630928    0.983910    0.813776    1.039132    0.595778    0.630928    0.971936    0.758305    0.991554    0.880496    0.988239    0.802526    5000        22.948939   0.054040    0.293274    116.894987 
[37m[36mINFO[0m[0m 03/19 16:40:37 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[0]/250319_15-25-33_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 16:40:39 | ---
[37m[36mINFO[0m[0m 03/19 16:40:39 | test-domain validation(oracle) = 59.526%
[37m[36mINFO[0m[0m 03/19 16:40:39 | training-domain validation(iid) = 58.548%
[37m[36mINFO[0m[0m 03/19 16:40:39 | last = 59.578%
[37m[36mINFO[0m[0m 03/19 16:40:39 | last (inD) = 81.378%
[37m[36mINFO[0m[0m 03/19 16:40:39 | training-domain validation (iid, inD) = 82.902%
[37m[36mINFO[0m[0m 03/19 16:40:39 | === Summary ===
[37m[36mINFO[0m[0m 03/19 16:40:39 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 0 --hparams_seed 14
[37m[36mINFO[0m[0m 03/19 16:40:39 | Unique name: 250319_15-25-33_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 16:40:39 | Out path: train_output/OfficeHome/ERM/[0]/250319_15-25-33_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 16:40:39 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 16:40:39 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 03/19 13:12:04 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 0 --hparams_seed 12
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 12
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/OfficeHome/ERM/[0]/250319_13-12-04_resnet50_Sign_GENIE
	out_root: train_output/OfficeHome/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250319_13-12-04_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00012111338094255871
	batch_size: 9
	weight_decay: 1.821145631101786e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/19 13:12:04 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 13:12:04 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 13:12:04 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 13:12:04 | 
[37m[36mINFO[0m[0m 03/19 13:12:04 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 13:12:04 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 13:12:04 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 13:12:04 | Batch sizes for each domain: [0, 9, 9, 9] (total=27)
[37m[36mINFO[0m[0m 03/19 13:12:04 | steps-per-epoch for each domain: 388.00, 394.67, 387.33 -> min = 387.33
[37m[36mINFO[0m[0m 03/19 13:12:05 | # of params = 23641217
[37m[36mINFO[0m[0m 03/19 13:14:06 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 13:14:06 | 0.021112    0.010309    0.021737    0.023951    4.238517    0.021112    0.010309    0.016323    0.027491    0.023930    0.022548    0.024957    0.021814    0           0.000000    4.337849    1.064967    120.165330 
[37m[36mINFO[0m[0m 03/19 13:16:38 | 0.416066    0.432990    0.622588    0.606010    1.427463    0.416066    0.432990    0.529210    0.516609    0.678773    0.653890    0.659782    0.647532    200         0.516351    2.658495    0.182736    115.171842 
[37m[36mINFO[0m[0m 03/19 13:19:08 | 0.536560    0.550515    0.727780    0.706591    1.124366    0.536560    0.550515    0.638603    0.597938    0.788570    0.780158    0.756168    0.741676    400         1.032702    1.390585    0.166890    117.269945 
[37m[36mINFO[0m[0m 03/19 13:21:45 | 0.514933    0.540206    0.739958    0.698205    1.183475    0.514933    0.540206    0.680412    0.608247    0.794482    0.773393    0.744980    0.712974    600         1.549053    1.062436    0.186006    118.933376 
[37m[36mINFO[0m[0m 03/19 13:24:10 | 0.508754    0.515464    0.763934    0.692186    1.136894    0.508754    0.515464    0.705326    0.607102    0.811374    0.756483    0.775100    0.712974    800         2.065404    0.925080    0.159940    113.697494 
[37m[36mINFO[0m[0m 03/19 13:26:45 | 0.526777    0.575258    0.799981    0.728336    1.027373    0.526777    0.575258    0.743700    0.642612    0.838401    0.785795    0.817843    0.756602    1000        2.581756    0.801766    0.187239    117.496501 
[37m[36mINFO[0m[0m 03/19 13:29:16 | 0.536045    0.558763    0.830575    0.752669    0.957329    0.536045    0.558763    0.784651    0.680412    0.865709    0.807215    0.841365    0.770379    1200        3.098107    0.754161    0.170946    116.435163 
[37m[36mINFO[0m[0m 03/19 13:31:58 | 0.543769    0.575258    0.847730    0.775105    0.858203    0.543769    0.575258    0.798969    0.713631    0.888514    0.826381    0.855709    0.785304    1400        3.614458    0.689944    0.227291    116.623944 
[37m[36mINFO[0m[0m 03/19 13:34:33 | 0.550978    0.569072    0.856277    0.773188    0.862559    0.550978    0.569072    0.819301    0.710195    0.880912    0.827508    0.868617    0.781860    1600        4.130809    0.604202    0.195340    116.421623 
[37m[36mINFO[0m[0m 03/19 13:37:06 | 0.504119    0.531959    0.853417    0.746225    0.969982    0.504119    0.531959    0.815865    0.680412    0.879786    0.797069    0.864601    0.761194    1800        4.647160    0.555199    0.176640    116.925964 
[37m[36mINFO[0m[0m 03/19 13:39:49 | 0.543769    0.579381    0.877634    0.772438    0.925094    0.543769    0.579381    0.845647    0.698740    0.903435    0.826381    0.883821    0.792193    2000        5.163511    0.513397    0.231170    116.628619 
[37m[36mINFO[0m[0m 03/19 13:42:25 | 0.550978    0.583505    0.881013    0.781510    0.908480    0.550978    0.583505    0.847365    0.720504    0.913288    0.842165    0.882387    0.781860    2200        5.679862    0.487648    0.202432    115.436948 
[37m[36mINFO[0m[0m 03/19 13:44:57 | 0.593718    0.585567    0.897606    0.796335    0.825664    0.593718    0.585567    0.858820    0.725086    0.919482    0.857948    0.914515    0.805970    2400        6.196213    0.461903    0.179838    116.703957 
[37m[36mINFO[0m[0m 03/19 13:47:40 | 0.579300    0.618557    0.899171    0.788729    0.860779    0.579300    0.618557    0.873711    0.725086    0.927646    0.850056    0.896156    0.791045    2600        6.712565    0.434074    0.231106    116.093377 
[37m[36mINFO[0m[0m 03/19 13:50:15 | 0.523687    0.544330    0.900417    0.779548    0.858477    0.523687    0.544330    0.881730    0.728522    0.926520    0.848929    0.893001    0.761194    2800        7.228916    0.378426    0.194415    116.447550 
[37m[36mINFO[0m[0m 03/19 13:52:44 | 0.559217    0.571134    0.895855    0.782322    0.867478    0.559217    0.571134    0.854525    0.713631    0.924550    0.835400    0.908491    0.797933    3000        7.745267    0.358974    0.167922    115.356331 
[37m[36mINFO[0m[0m 03/19 13:55:14 | 0.570546    0.581443    0.922500    0.811524    0.788270    0.570546    0.581443    0.896907    0.753723    0.941160    0.873732    0.929432    0.807118    3200        8.261618    0.338711    0.162446    117.412054 
[37m[36mINFO[0m[0m 03/19 13:57:48 | 0.541710    0.569072    0.911567    0.781498    0.858724    0.541710    0.569072    0.885452    0.726231    0.932151    0.843292    0.917097    0.774971    3400        8.777969    0.310523    0.194590    115.224395 
[37m[36mINFO[0m[0m 03/19 14:00:17 | 0.569001    0.589691    0.917001    0.799768    0.863677    0.569001    0.589691    0.892612    0.747995    0.934122    0.856821    0.924269    0.794489    3600        9.294320    0.330865    0.167992    115.919709 
[37m[36mINFO[0m[0m 03/19 14:02:59 | 0.555613    0.579381    0.927551    0.796745    0.819066    0.555613    0.579381    0.906930    0.743414    0.942849    0.851184    0.932874    0.795637    3800        9.810671    0.329150    0.198962    122.154449 
[37m[36mINFO[0m[0m 03/19 14:05:33 | 0.548404    0.587629    0.917765    0.790579    0.877316    0.548404    0.587629    0.897194    0.735395    0.933840    0.859076    0.922260    0.777268    4000        10.327022   0.318761    0.169009    119.393304 
[37m[36mINFO[0m[0m 03/19 14:08:12 | 0.543254    0.577320    0.915680    0.786010    0.902347    0.543254    0.577320    0.895475    0.731959    0.931025    0.855693    0.920539    0.770379    4200        10.843373   0.275175    0.191900    121.560829 
[37m[36mINFO[0m[0m 03/19 14:10:48 | 0.552008    0.575258    0.939897    0.800935    0.956857    0.552008    0.575258    0.928121    0.750286    0.954392    0.853439    0.937177    0.799082    4400        11.359725   0.242057    0.177326    120.071256 
[37m[36mINFO[0m[0m 03/19 14:13:27 | 0.571061    0.591753    0.945112    0.800118    0.870115    0.571061    0.591753    0.921249    0.736541    0.961993    0.863585    0.952094    0.800230    4600        11.876076   0.256105    0.178781    122.787555 
[37m[36mINFO[0m[0m 03/19 14:16:01 | 0.553038    0.571134    0.934679    0.795522    0.974011    0.553038    0.571134    0.912658    0.733104    0.949324    0.864713    0.942054    0.788749    4800        12.392427   0.252046    0.190683    116.494787 
[37m[36mINFO[0m[0m 03/19 14:18:40 | 0.567971    0.583505    0.944662    0.804648    0.861714    0.567971    0.583505    0.924112    0.746850    0.957207    0.872604    0.952668    0.794489    5000        12.908778   0.234108    0.175247    123.908139 
[37m[36mINFO[0m[0m 03/19 14:18:40 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[0]/250319_13-12-04_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 14:18:41 | ---
[37m[36mINFO[0m[0m 03/19 14:18:41 | test-domain validation(oracle) = 57.930%
[37m[36mINFO[0m[0m 03/19 14:18:41 | training-domain validation(iid) = 57.055%
[37m[36mINFO[0m[0m 03/19 14:18:41 | last = 56.797%
[37m[36mINFO[0m[0m 03/19 14:18:41 | last (inD) = 80.465%
[37m[36mINFO[0m[0m 03/19 14:18:41 | training-domain validation (iid, inD) = 81.152%
[37m[36mINFO[0m[0m 03/19 14:18:41 | === Summary ===
[37m[36mINFO[0m[0m 03/19 14:18:41 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 0 --hparams_seed 12
[37m[36mINFO[0m[0m 03/19 14:18:41 | Unique name: 250319_13-12-04_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 14:18:41 | Out path: train_output/OfficeHome/ERM/[0]/250319_13-12-04_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 14:18:41 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 14:18:41 | Dataset: OfficeHome

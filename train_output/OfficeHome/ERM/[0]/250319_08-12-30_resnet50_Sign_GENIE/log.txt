[37m[36mINFO[0m[0m 03/19 08:12:30 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 0 --hparams_seed 8
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 8
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/OfficeHome/ERM/[0]/250319_08-12-30_resnet50_Sign_GENIE
	out_root: train_output/OfficeHome/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250319_08-12-30_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.9932388835350315e-05
	batch_size: 16
	weight_decay: 0.0025315391809104006
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/19 08:12:30 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 08:12:30 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 08:12:30 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 08:12:30 | 
[37m[36mINFO[0m[0m 03/19 08:12:30 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 08:12:30 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 08:12:30 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 08:12:30 | Batch sizes for each domain: [0, 16, 16, 16] (total=48)
[37m[36mINFO[0m[0m 03/19 08:12:30 | steps-per-epoch for each domain: 218.25, 222.00, 217.88 -> min = 217.88
[37m[36mINFO[0m[0m 03/19 08:12:31 | # of params = 23641217
[37m[36mINFO[0m[0m 03/19 08:14:33 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 08:14:33 | 0.020597    0.006186    0.016157    0.012934    4.227255    0.020597    0.006186    0.016896    0.011455    0.014077    0.011274    0.017499    0.016073    0           0.000000    4.261035    2.328873    119.629608 
[37m[36mINFO[0m[0m 03/19 08:17:34 | 0.549434    0.573196    0.740064    0.718035    1.074599    0.549434    0.573196    0.653494    0.610538    0.795327    0.784667    0.771371    0.758898    200         0.917958    1.850927    0.317886    117.447421 
[37m[36mINFO[0m[0m 03/19 08:20:38 | 0.580330    0.571134    0.815439    0.750351    0.936837    0.580330    0.571134    0.747995    0.654066    0.858390    0.813980    0.839931    0.783008    400         1.835915    0.790690    0.337485    116.640682 
[37m[36mINFO[0m[0m 03/19 08:23:42 | 0.576210    0.583505    0.842000    0.767892    0.914921    0.576210    0.583505    0.784651    0.701031    0.888795    0.818489    0.852553    0.784156    600         2.753873    0.611155    0.328925    118.036274 
[37m[36mINFO[0m[0m 03/19 08:26:41 | 0.566941    0.562887    0.883492    0.797045    0.787336    0.566941    0.562887    0.841638    0.715922    0.914977    0.868095    0.893861    0.807118    800         3.671830    0.525334    0.306568    117.196456 
[37m[36mINFO[0m[0m 03/19 08:29:39 | 0.565396    0.597938    0.887393    0.787525    0.846292    0.565396    0.597938    0.859679    0.717068    0.916385    0.860203    0.886116    0.785304    1000        4.589788    0.401345    0.301636    117.996272 
[37m[36mINFO[0m[0m 03/19 08:32:34 | 0.575695    0.571134    0.898579    0.774597    0.906808    0.575695    0.571134    0.859966    0.688431    0.931869    0.850056    0.903901    0.785304    1200        5.507745    0.347228    0.290721    116.526405 
[37m[36mINFO[0m[0m 03/19 08:35:20 | 0.582904    0.618557    0.919589    0.808090    0.829381    0.582904    0.618557    0.887171    0.731959    0.948761    0.874859    0.922834    0.817451    1400        6.425703    0.311278    0.251917    115.740103 
[37m[36mINFO[0m[0m 03/19 08:38:07 | 0.609681    0.630928    0.920368    0.805083    0.809671    0.609681    0.630928    0.893184    0.741123    0.945946    0.864713    0.921974    0.809414    1600        7.343660    0.277117    0.263529    114.142023 
[37m[36mINFO[0m[0m 03/19 08:40:58 | 0.572606    0.612371    0.934844    0.801667    0.826978    0.572606    0.612371    0.910367    0.739977    0.953547    0.860203    0.940620    0.804822    1800        8.261618    0.248388    0.272104    116.427035 
[37m[36mINFO[0m[0m 03/19 08:43:45 | 0.562307    0.569072    0.932928    0.803159    0.862704    0.562307    0.569072    0.907503    0.736541    0.954392    0.866967    0.936890    0.805970    2000        9.179575    0.246558    0.259196    115.652380 
[37m[36mINFO[0m[0m 03/19 08:46:31 | 0.573120    0.585567    0.948058    0.809995    0.815771    0.573120    0.585567    0.927549    0.751432    0.964245    0.873732    0.952381    0.804822    2200        10.097533   0.193918    0.258729    114.234253 
[37m[36mINFO[0m[0m 03/19 08:49:25 | 0.553038    0.571134    0.946145    0.795491    0.904024    0.553038    0.571134    0.925544    0.728522    0.964527    0.870349    0.948365    0.787600    2400        11.015491   0.177568    0.272004    119.311351 
[37m[36mINFO[0m[0m 03/19 08:52:15 | 0.574150    0.577320    0.951890    0.810764    0.814293    0.574150    0.577320    0.937572    0.756014    0.962275    0.872604    0.955823    0.803674    2600        11.933448   0.175730    0.262624    117.707784 
[37m[36mINFO[0m[0m 03/19 08:55:04 | 0.571576    0.577320    0.960136    0.814912    0.830192    0.571576    0.577320    0.943013    0.754868    0.973255    0.882751    0.964142    0.807118    2800        12.851406   0.156883    0.273244    114.648786 
[37m[36mINFO[0m[0m 03/19 08:57:53 | 0.539650    0.542268    0.956424    0.801246    0.858143    0.539650    0.542268    0.939290    0.745704    0.971002    0.865840    0.958979    0.792193    3000        13.769363   0.154127    0.256785    116.856124 
[37m[36mINFO[0m[0m 03/19 09:00:43 | 0.573635    0.614433    0.961098    0.812989    0.889551    0.573635    0.614433    0.949885    0.758305    0.971847    0.883878    0.961561    0.796785    3200        14.687321   0.130470    0.262623    117.470579 
[37m[36mINFO[0m[0m 03/19 09:03:34 | 0.594748    0.614433    0.955679    0.811165    0.807623    0.594748    0.614433    0.934994    0.750286    0.968187    0.870349    0.963855    0.812859    3400        15.605278   0.126521    0.275471    115.939281 
[37m[36mINFO[0m[0m 03/19 09:06:24 | 0.583934    0.614433    0.966533    0.814184    0.894865    0.583934    0.614433    0.951890    0.751432    0.974099    0.877114    0.973609    0.814007    3600        16.523236   0.111268    0.262167    117.588578 
[37m[36mINFO[0m[0m 03/19 09:09:11 | 0.579815    0.595876    0.972681    0.822924    0.822665    0.579815    0.595876    0.959336    0.760596    0.983953    0.886133    0.974756    0.822044    3800        17.441193   0.102803    0.263886    114.362439 
[37m[36mINFO[0m[0m 03/19 09:11:57 | 0.557158    0.567010    0.966432    0.815316    0.890093    0.557158    0.567010    0.953895    0.764032    0.974662    0.878241    0.970740    0.803674    4000        18.359151   0.111101    0.251922    115.642674 
[37m[36mINFO[0m[0m 03/19 09:14:50 | 0.565396    0.564948    0.969562    0.824028    0.869352    0.565396    0.564948    0.955040    0.754868    0.978604    0.894025    0.975043    0.823192    4200        19.277108   0.118711    0.289434    115.031574 
[37m[36mINFO[0m[0m 03/19 09:17:44 | 0.549434    0.554639    0.969773    0.807733    0.923477    0.549434    0.554639    0.957331    0.751432    0.975225    0.868095    0.976764    0.803674    4400        20.195066   0.097048    0.280742    117.794192 
[37m[36mINFO[0m[0m 03/19 09:20:39 | 0.544284    0.542268    0.964603    0.803857    0.983134    0.544284    0.542268    0.953608    0.744559    0.976633    0.877114    0.963569    0.789897    4600        21.113024   0.102949    0.282082    118.558400 
[37m[36mINFO[0m[0m 03/19 09:23:27 | 0.556128    0.591753    0.971849    0.812321    0.950428    0.556128    0.591753    0.960195    0.758305    0.979448    0.868095    0.975904    0.810563    4800        22.030981   0.104248    0.261393    116.489746 
[37m[36mINFO[0m[0m 03/19 09:26:17 | 0.571061    0.583505    0.978203    0.825599    0.838829    0.571061    0.583505    0.968786    0.766323    0.987050    0.886133    0.978772    0.824340    5000        22.948939   0.083463    0.270157    115.245106 
[37m[36mINFO[0m[0m 03/19 09:26:17 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[0]/250319_08-12-30_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 09:26:18 | ---
[37m[36mINFO[0m[0m 03/19 09:26:18 | test-domain validation(oracle) = 60.968%
[37m[36mINFO[0m[0m 03/19 09:26:18 | training-domain validation(iid) = 57.106%
[37m[36mINFO[0m[0m 03/19 09:26:18 | last = 57.106%
[37m[36mINFO[0m[0m 03/19 09:26:18 | last (inD) = 82.560%
[37m[36mINFO[0m[0m 03/19 09:26:18 | training-domain validation (iid, inD) = 82.560%
[37m[36mINFO[0m[0m 03/19 09:26:18 | === Summary ===
[37m[36mINFO[0m[0m 03/19 09:26:18 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 0 --hparams_seed 8
[37m[36mINFO[0m[0m 03/19 09:26:18 | Unique name: 250319_08-12-30_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 09:26:18 | Out path: train_output/OfficeHome/ERM/[0]/250319_08-12-30_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 09:26:18 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 09:26:18 | Dataset: OfficeHome

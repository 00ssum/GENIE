[37m[36mINFO[0m[0m 03/19 12:03:02 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 0 --hparams_seed 11
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 11
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/OfficeHome/ERM/[0]/250319_12-03-02_resnet50_Sign_GENIE
	out_root: train_output/OfficeHome/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250319_12-03-02_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5.962562271631622e-05
	batch_size: 11
	weight_decay: 0.001114945719897867
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/19 12:03:02 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 12:03:02 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 12:03:02 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 12:03:02 | 
[37m[36mINFO[0m[0m 03/19 12:03:02 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 12:03:02 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 12:03:02 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 12:03:02 | Batch sizes for each domain: [0, 11, 11, 11] (total=33)
[37m[36mINFO[0m[0m 03/19 12:03:02 | steps-per-epoch for each domain: 317.45, 322.91, 316.91 -> min = 316.91
[37m[36mINFO[0m[0m 03/19 12:03:03 | # of params = 23641217
[37m[36mINFO[0m[0m 03/19 12:05:04 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 12:05:04 | 0.021112    0.012371    0.020892    0.020897    4.229524    0.021112    0.012371    0.020332    0.026346    0.021115    0.021421    0.021228    0.014925    0           0.000000    4.299575    2.425076    118.016608 
[37m[36mINFO[0m[0m 03/19 12:07:57 | 0.510814    0.548454    0.716412    0.687216    1.172489    0.510814    0.548454    0.615693    0.581901    0.788851    0.758737    0.744693    0.721010    200         0.631096    2.071402    0.255555    121.809525 
[37m[36mINFO[0m[0m 03/19 12:10:54 | 0.535530    0.550515    0.777882    0.727943    1.026124    0.535530    0.550515    0.701604    0.647194    0.828829    0.786922    0.803213    0.749713    400         1.262192    0.964473    0.287451    120.252415 
[37m[36mINFO[0m[0m 03/19 12:13:42 | 0.526777    0.525773    0.793248    0.730173    0.975584    0.526777    0.525773    0.737973    0.634593    0.845158    0.799324    0.796615    0.756602    600         1.893287    0.763944    0.251287    117.197523 
[37m[36mINFO[0m[0m 03/19 12:16:27 | 0.516478    0.544330    0.813413    0.726306    1.018732    0.516478    0.544330    0.753723    0.641466    0.860642    0.804961    0.825875    0.732491    800         2.524383    0.618439    0.238326    118.039195 
[37m[36mINFO[0m[0m 03/19 12:19:08 | 0.556128    0.560825    0.858250    0.787282    0.807859    0.556128    0.560825    0.812715    0.723940    0.887106    0.836528    0.874928    0.801378    1000        3.155479    0.587006    0.211877    118.258716 
[37m[36mINFO[0m[0m 03/19 12:21:49 | 0.515963    0.560825    0.855646    0.756008    1.009698    0.515963    0.560825    0.813860    0.691867    0.890484    0.822999    0.862593    0.753157    1200        3.786575    0.475126    0.198347    120.771450 
[37m[36mINFO[0m[0m 03/19 12:24:33 | 0.567456    0.600000    0.887086    0.784625    0.816874    0.567456    0.600000    0.858820    0.721649    0.904561    0.833145    0.897877    0.799082    1400        4.417671    0.414659    0.229912    118.675554 
[37m[36mINFO[0m[0m 03/19 12:27:18 | 0.563337    0.577320    0.878317    0.771589    0.968309    0.563337    0.577320    0.860252    0.709049    0.900056    0.838782    0.874641    0.766935    1600        5.048766    0.368917    0.245545    116.041598 
[37m[36mINFO[0m[0m 03/19 12:30:10 | 0.541710    0.564948    0.890200    0.767369    0.989714    0.541710    0.564948    0.862543    0.676976    0.910755    0.844419    0.897303    0.780712    1800        5.679862    0.362933    0.268541    117.595972 
[37m[36mINFO[0m[0m 03/19 12:33:04 | 0.561277    0.571134    0.911075    0.787158    0.900174    0.561277    0.571134    0.876002    0.714777    0.935248    0.857948    0.921974    0.788749    2000        6.310958    0.332756    0.278650    118.510944 
[37m[36mINFO[0m[0m 03/19 12:35:40 | 0.540680    0.567010    0.921843    0.798183    0.911693    0.540680    0.567010    0.902062    0.720504    0.938626    0.869222    0.924842    0.804822    2200        6.942054    0.265688    0.201736    115.802205 
[37m[36mINFO[0m[0m 03/19 12:38:15 | 0.581359    0.591753    0.914113    0.772619    0.989041    0.581359    0.591753    0.888603    0.691867    0.937500    0.860203    0.916236    0.765786    2400        7.573150    0.247336    0.193303    116.053153 
[37m[36mINFO[0m[0m 03/19 12:40:50 | 0.597322    0.606186    0.940562    0.813830    0.785308    0.597322    0.606186    0.919530    0.750286    0.955800    0.872604    0.946357    0.818599    2600        8.204246    0.257127    0.198597    115.542673 
[37m[36mINFO[0m[0m 03/19 12:43:24 | 0.588568    0.632990    0.948183    0.811494    0.830997    0.588568    0.632990    0.926403    0.757159    0.959741    0.878241    0.958405    0.799082    2800        8.835341    0.213009    0.191651    115.195740 
[37m[36mINFO[0m[0m 03/19 12:46:03 | 0.585479    0.610309    0.945683    0.808825    0.892692    0.585479    0.610309    0.925258    0.744559    0.961993    0.878241    0.949799    0.803674    3000        9.466437    0.194083    0.201916    119.411862 
[37m[36mINFO[0m[0m 03/19 12:48:38 | 0.565396    0.546392    0.939680    0.803922    0.880529    0.565396    0.546392    0.919817    0.739977    0.959178    0.866967    0.940046    0.804822    3200        10.097533   0.196119    0.201283    114.514244 
[37m[36mINFO[0m[0m 03/19 12:51:12 | 0.535015    0.569072    0.955372    0.817192    0.825579    0.535015    0.569072    0.936140    0.758305    0.971284    0.885006    0.958692    0.808266    3400        10.728629   0.205373    0.187922    115.955904 
[37m[36mINFO[0m[0m 03/19 12:53:49 | 0.549949    0.567010    0.953288    0.801553    0.970270    0.549949    0.567010    0.938144    0.745704    0.967905    0.878241    0.953815    0.780712    3600        11.359725   0.156468    0.206835    116.356025 
[37m[36mINFO[0m[0m 03/19 12:56:25 | 0.559732    0.591753    0.943224    0.799373    0.964784    0.559732    0.591753    0.922680    0.737686    0.958052    0.860203    0.948939    0.800230    3800        11.990820   0.169214    0.194307    116.188818 
[37m[36mINFO[0m[0m 03/19 12:59:00 | 0.564367    0.581443    0.951129    0.822154    0.853331    0.564367    0.581443    0.942440    0.766323    0.961149    0.886133    0.949799    0.814007    4000        12.621916   0.137816    0.191660    116.656098 
[37m[36mINFO[0m[0m 03/19 13:01:37 | 0.569516    0.571134    0.961749    0.804956    0.941937    0.569516    0.571134    0.943299    0.736541    0.975225    0.886133    0.966724    0.792193    4200        13.253012   0.139640    0.206305    115.920129 
[37m[36mINFO[0m[0m 03/19 13:04:14 | 0.528321    0.569072    0.948242    0.799635    1.013647    0.528321    0.569072    0.929267    0.733104    0.965372    0.880496    0.950086    0.785304    4400        13.884108   0.134830    0.205497    115.939373 
[37m[36mINFO[0m[0m 03/19 13:06:46 | 0.544799    0.554639    0.956647    0.806542    0.883018    0.544799    0.554639    0.945017    0.744559    0.965372    0.875986    0.959552    0.799082    4600        14.515204   0.133730    0.186365    114.958872 
[37m[36mINFO[0m[0m 03/19 13:09:24 | 0.552008    0.552577    0.954916    0.803479    0.944596    0.552008    0.552577    0.940435    0.746850    0.967342    0.875986    0.956971    0.787600    4800        15.146299   0.145839    0.214959    114.895036 
[37m[36mINFO[0m[0m 03/19 13:11:58 | 0.564882    0.569072    0.963116    0.802335    0.997355    0.564882    0.569072    0.946735    0.750286    0.970439    0.874859    0.972174    0.781860    5000        15.777395   0.121209    0.197249    114.976593 
[37m[36mINFO[0m[0m 03/19 13:11:58 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[0]/250319_12-03-02_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 13:11:59 | ---
[37m[36mINFO[0m[0m 03/19 13:11:59 | test-domain validation(oracle) = 58.857%
[37m[36mINFO[0m[0m 03/19 13:11:59 | training-domain validation(iid) = 56.437%
[37m[36mINFO[0m[0m 03/19 13:11:59 | last = 56.488%
[37m[36mINFO[0m[0m 03/19 13:11:59 | last (inD) = 80.234%
[37m[36mINFO[0m[0m 03/19 13:11:59 | training-domain validation (iid, inD) = 82.215%
[37m[36mINFO[0m[0m 03/19 13:11:59 | === Summary ===
[37m[36mINFO[0m[0m 03/19 13:11:59 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 0 --hparams_seed 11
[37m[36mINFO[0m[0m 03/19 13:11:59 | Unique name: 250319_12-03-02_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 13:11:59 | Out path: train_output/OfficeHome/ERM/[0]/250319_12-03-02_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 13:11:59 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 13:11:59 | Dataset: OfficeHome

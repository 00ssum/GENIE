[37m[36mINFO[0m[0m 03/17 22:38:11 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --trial_seed 2 --hparams_seed 10 --algorithm ERM --test_envs 0 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 10
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/OfficeHome/ERM/[0]/250317_22-38-11_resnet50_Sign_GENIE
	out_root: train_output/OfficeHome/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 2
	unique_name: 250317_22-38-11_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 7.494887873901297e-05
	batch_size: 23
	weight_decay: 0.000495139494108363
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/17 22:38:11 | n_steps = 5001
[37m[36mINFO[0m[0m 03/17 22:38:11 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/17 22:38:11 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/17 22:38:11 | 
[37m[36mINFO[0m[0m 03/17 22:38:11 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/17 22:38:11 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/17 22:38:11 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/17 22:38:11 | Batch sizes for each domain: [0, 23, 23, 23] (total=69)
[37m[36mINFO[0m[0m 03/17 22:38:11 | steps-per-epoch for each domain: 151.83, 154.43, 151.57 -> min = 151.57
[37m[36mINFO[0m[0m 03/17 22:38:12 | # of params = 23641217
[37m[36mINFO[0m[0m 03/17 22:40:17 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/17 22:40:17 | 0.021112    0.022680    0.016815    0.021708    4.213333    0.021112    0.022680    0.014605    0.021764    0.016047    0.014656    0.019793    0.028703    0           0.000000    4.278715    1.118812    123.645756 
[37m[36mINFO[0m[0m 03/17 22:43:34 | 0.571576    0.548454    0.758765    0.727523    0.973689    0.571576    0.548454    0.668099    0.624284    0.815597    0.795941    0.792599    0.762342    200         1.319564    2.182992    0.398544    117.905648 
[37m[36mINFO[0m[0m 03/17 22:46:46 | 0.593203    0.585567    0.824337    0.763960    0.820443    0.593203    0.585567    0.756300    0.684994    0.871903    0.837655    0.844808    0.769231    400         2.639128    0.850637    0.375332    117.103784 
[37m[36mINFO[0m[0m 03/17 22:49:59 | 0.613285    0.628866    0.865288    0.791037    0.758959    0.613285    0.628866    0.813574    0.718213    0.893018    0.848929    0.889271    0.805970    600         3.958692    0.616668    0.383506    115.838889 
[37m[36mINFO[0m[0m 03/17 22:53:17 | 0.607621    0.632990    0.896729    0.794473    0.729483    0.607621    0.632990    0.856816    0.747995    0.922297    0.846674    0.911073    0.788749    800         5.278256    0.496843    0.389738    120.163067 
[37m[36mINFO[0m[0m 03/17 22:56:34 | 0.608136    0.643299    0.908984    0.812240    0.721164    0.608136    0.643299    0.874570    0.746850    0.933277    0.882751    0.919105    0.807118    1000        6.597820    0.410380    0.397408    117.821100 
[37m[36mINFO[0m[0m 03/17 22:59:49 | 0.627703    0.649485    0.918972    0.820277    0.718152    0.627703    0.649485    0.895189    0.764032    0.939752    0.880496    0.921974    0.816303    1200        7.917384    0.334135    0.382928    118.170265 
[37m[36mINFO[0m[0m 03/17 23:02:59 | 0.602987    0.616495    0.935609    0.819898    0.745694    0.602987    0.616495    0.910939    0.759450    0.953547    0.880496    0.942341    0.819747    1400        9.236948    0.298200    0.381689    114.088068 
[37m[36mINFO[0m[0m 03/17 23:06:17 | 0.589083    0.600000    0.928853    0.822182    0.789533    0.589083    0.600000    0.900630    0.757159    0.949324    0.882751    0.936604    0.826636    1600        10.556512   0.254908    0.404840    116.699524 
[37m[36mINFO[0m[0m 03/17 23:09:32 | 0.611226    0.641237    0.946377    0.817227    0.811679    0.611226    0.641237    0.929553    0.775487    0.957770    0.877114    0.951807    0.799082    1800        11.876076   0.233788    0.371131    120.186723 
[37m[36mINFO[0m[0m 03/17 23:12:48 | 0.601442    0.624742    0.948515    0.821404    0.762666    0.601442    0.624742    0.925544    0.782360    0.967905    0.881623    0.952094    0.800230    2000        13.195640   0.189851    0.388799    118.392961 
[37m[36mINFO[0m[0m 03/17 23:16:06 | 0.612770    0.645361    0.961473    0.830213    0.761531    0.612770    0.645361    0.943872    0.791523    0.973536    0.879369    0.967011    0.819747    2200        14.515204   0.186855    0.402197    117.622192 
[37m[36mINFO[0m[0m 03/17 23:19:21 | 0.595263    0.618557    0.962617    0.835135    0.806834    0.595263    0.618557    0.943872    0.789233    0.974099    0.888388    0.969880    0.827784    2400        15.834768   0.145928    0.399523    115.789896 
[37m[36mINFO[0m[0m 03/17 23:22:39 | 0.602472    0.630928    0.968023    0.829056    0.812572    0.602472    0.630928    0.949885    0.785796    0.980574    0.881623    0.973609    0.819747    2600        17.154332   0.140060    0.403592    116.612780 
[37m[36mINFO[0m[0m 03/17 23:25:57 | 0.620494    0.616495    0.973643    0.833571    0.810548    0.620494    0.616495    0.958763    0.778923    0.983108    0.895152    0.979059    0.826636    2800        18.473896   0.114035    0.401564    117.377693 
[37m[36mINFO[0m[0m 03/17 23:29:13 | 0.621009    0.659794    0.968698    0.826361    0.812344    0.621009    0.659794    0.951604    0.778923    0.979448    0.885006    0.975043    0.815155    3000        19.793460   0.119445    0.397658    116.829241 
[37m[36mINFO[0m[0m 03/17 23:32:26 | 0.617920    0.639175    0.976098    0.829362    0.816521    0.617920    0.639175    0.961054    0.777778    0.987894    0.895152    0.979346    0.815155    3200        21.113024   0.111746    0.389855    114.929355 
[37m[36mINFO[0m[0m 03/17 23:35:43 | 0.609681    0.663918    0.976406    0.833924    0.816885    0.609681    0.663918    0.961054    0.781214    0.984516    0.899662    0.983649    0.820896    3400        22.432587   0.098888    0.398149    117.826239 
[37m[36mINFO[0m[0m 03/17 23:39:00 | 0.631823    0.657732    0.973443    0.827873    0.801418    0.631823    0.657732    0.962199    0.776632    0.984234    0.888388    0.973896    0.818599    3600        23.752151   0.093434    0.395781    117.937054 
[37m[36mINFO[0m[0m 03/17 23:42:19 | 0.625644    0.641237    0.983067    0.829745    0.846741    0.625644    0.641237    0.973654    0.776632    0.988457    0.895152    0.987091    0.817451    3800        25.071715   0.091691    0.393008    119.798699 
[37m[36mINFO[0m[0m 03/17 23:45:41 | 0.631823    0.645361    0.980787    0.829429    0.966297    0.631823    0.645361    0.967640    0.789233    0.986768    0.882751    0.987952    0.816303    4000        26.391279   0.076529    0.418895    117.971029 
[37m[36mINFO[0m[0m 03/17 23:49:05 | 0.612255    0.637113    0.980888    0.838837    0.830923    0.612255    0.637113    0.967354    0.790378    0.985923    0.908681    0.989386    0.817451    4200        27.710843   0.081332    0.409142    122.722812 
[37m[36mINFO[0m[0m 03/17 23:52:26 | 0.616375    0.670103    0.984872    0.835083    0.785067    0.616375    0.670103    0.973940    0.793814    0.990428    0.896280    0.990247    0.815155    4400        29.030407   0.079845    0.409399    119.031127 
[37m[36mINFO[0m[0m 03/17 23:55:46 | 0.622039    0.645361    0.983739    0.835483    0.758350    0.622039    0.645361    0.975945    0.798396    0.987894    0.892897    0.987378    0.815155    4600        30.349971   0.076364    0.404032    119.416333 
[37m[36mINFO[0m[0m 03/17 23:59:08 | 0.623069    0.641237    0.984778    0.834291    0.832588    0.623069    0.641237    0.973940    0.783505    0.990146    0.901917    0.990247    0.817451    4800        31.669535   0.076027    0.407570    120.352662 
[37m[36mINFO[0m[0m 03/18 00:02:29 | 0.618950    0.641237    0.982962    0.832054    0.825350    0.618950    0.641237    0.971936    0.786942    0.990146    0.891770    0.986804    0.817451    5000        32.989099   0.067052    0.413977    118.037576 
[37m[36mINFO[0m[0m 03/18 00:02:29 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[0]/250317_22-38-11_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 00:02:30 | ---
[37m[36mINFO[0m[0m 03/18 00:02:30 | test-domain validation(oracle) = 61.637%
[37m[36mINFO[0m[0m 03/18 00:02:30 | training-domain validation(iid) = 61.226%
[37m[36mINFO[0m[0m 03/18 00:02:30 | last = 61.895%
[37m[36mINFO[0m[0m 03/18 00:02:30 | last (inD) = 83.205%
[37m[36mINFO[0m[0m 03/18 00:02:30 | training-domain validation (iid, inD) = 83.884%
[37m[36mINFO[0m[0m 03/18 00:02:30 | === Summary ===
[37m[36mINFO[0m[0m 03/18 00:02:30 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --trial_seed 2 --hparams_seed 10 --algorithm ERM --test_envs 0 --dataset OfficeHome
[37m[36mINFO[0m[0m 03/18 00:02:30 | Unique name: 250317_22-38-11_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 00:02:30 | Out path: train_output/OfficeHome/ERM/[0]/250317_22-38-11_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 00:02:30 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 00:02:30 | Dataset: OfficeHome

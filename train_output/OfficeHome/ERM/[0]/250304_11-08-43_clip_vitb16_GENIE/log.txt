[37m[36mINFO[0m[0m 03/04 11:08:43 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/OfficeHome/ERM/[0]/250304_11-08-43_clip_vitb16_GENIE
	out_root: train_output/OfficeHome/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250304_11-08-43_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: clip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/04 11:08:43 | n_steps = 5001
[37m[36mINFO[0m[0m 03/04 11:08:43 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/04 11:08:43 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/04 11:08:43 | 
[37m[36mINFO[0m[0m 03/04 11:08:43 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/04 11:08:43 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/04 11:08:43 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/04 11:08:43 | Batch sizes for each domain: [0, 32, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/04 11:08:43 | steps-per-epoch for each domain: 109.12, 111.00, 108.94 -> min = 108.94
[37m[36mINFO[0m[0m 03/04 11:08:46 | # of params = 86225985
[37m[36mINFO[0m[0m 03/04 11:10:40 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/04 11:10:40 | 0.020082    0.022680    0.015576    0.014461    4.208026    0.020082    0.022680    0.010596    0.008018    0.015766    0.012401    0.020367    0.022962    0           0.000000    4.212853    1.110347    113.733510 
[37m[36mINFO[0m[0m 03/04 11:14:17 | 0.057673    0.065979    0.054025    0.061504    3.995250    0.057673    0.065979    0.042955    0.040092    0.056869    0.075536    0.062249    0.068886    200         1.835915    4.078228    0.515692    113.139143 
[37m[36mINFO[0m[0m 03/04 11:17:57 | 0.062822    0.080412    0.083226    0.083509    3.795823    0.062822    0.080412    0.063574    0.065292    0.094595    0.103720    0.091509    0.081515    400         3.671830    3.922181    0.522594    115.423229 
[37m[36mINFO[0m[0m 03/04 11:21:33 | 0.123584    0.164948    0.280227    0.266932    2.911078    0.123584    0.164948    0.225086    0.209622    0.349099    0.317926    0.266495    0.273249    600         5.507745    3.380180    0.514460    113.821043 
[37m[36mINFO[0m[0m 03/04 11:25:08 | 0.264161    0.282474    0.524350    0.492643    1.937555    0.264161    0.282474    0.449026    0.388316    0.600788    0.559188    0.523236    0.530425    800         7.343660    2.270511    0.505124    113.349363 
[37m[36mINFO[0m[0m 03/04 11:28:44 | 0.418126    0.447423    0.750880    0.672680    1.249904    0.418126    0.447423    0.664089    0.555556    0.822917    0.760992    0.765634    0.701493    1000        9.179575    1.329883    0.512089    113.631690 
[37m[36mINFO[0m[0m 03/04 11:32:21 | 0.394439    0.430928    0.792407    0.666573    1.219817    0.394439    0.430928    0.736254    0.561283    0.842342    0.757610    0.798623    0.680827    1200        11.015491   0.878523    0.521764    112.601800 
[37m[36mINFO[0m[0m 03/04 11:35:59 | 0.435118    0.459794    0.854721    0.737661    0.997180    0.435118    0.459794    0.796105    0.634593    0.902309    0.826381    0.865749    0.752009    1400        12.851406   0.630839    0.525203    112.955439 
[37m[36mINFO[0m[0m 03/04 11:39:35 | 0.448507    0.457732    0.882486    0.724718    1.052400    0.448507    0.457732    0.838488    0.634593    0.923142    0.815107    0.885829    0.724455    1600        14.687321   0.502845    0.514542    113.139829 
[37m[36mINFO[0m[0m 03/04 11:43:14 | 0.487127    0.515464    0.914489    0.753663    0.988838    0.487127    0.515464    0.884593    0.665521    0.938908    0.834273    0.919966    0.761194    1800        16.523236   0.387465    0.520255    115.389539 
[37m[36mINFO[0m[0m 03/04 11:46:51 | 0.473223    0.484536    0.939098    0.756655    0.980072    0.473223    0.484536    0.916380    0.674685    0.960867    0.844419    0.940046    0.750861    2000        18.359151   0.286043    0.515707    113.339597 
[37m[36mINFO[0m[0m 03/04 11:50:27 | 0.460350    0.490722    0.948741    0.763946    0.956340    0.460350    0.490722    0.931558    0.694158    0.961712    0.838782    0.952955    0.758898    2200        20.195066   0.215781    0.497839    116.623256 
[37m[36mINFO[0m[0m 03/04 11:54:05 | 0.472709    0.498969    0.955471    0.768432    0.966733    0.472709    0.498969    0.938431    0.688431    0.970439    0.856821    0.957544    0.760046    2400        22.030981   0.179740    0.523822    112.754408 
[37m[36mINFO[0m[0m 03/04 11:57:43 | 0.459835    0.494845    0.952538    0.751318    1.022133    0.459835    0.494845    0.934994    0.674685    0.965935    0.841037    0.956684    0.738232    2600        23.866896   0.153601    0.518184    114.525372 
[37m[36mINFO[0m[0m 03/04 12:01:21 | 0.459835    0.490722    0.968337    0.773330    0.973698    0.459835    0.490722    0.955040    0.690722    0.975788    0.869222    0.974182    0.760046    2800        25.702811   0.121042    0.520174    113.797790 
[37m[36mINFO[0m[0m 03/04 12:04:55 | 0.441298    0.449485    0.961835    0.760084    1.043039    0.441298    0.449485    0.945590    0.676976    0.976633    0.846674    0.963282    0.756602    3000        27.538726   0.126414    0.504313    113.852681 
[37m[36mINFO[0m[0m 03/04 12:08:28 | 0.483007    0.505155    0.974145    0.782883    0.893358    0.483007    0.505155    0.964777    0.709049    0.978885    0.869222    0.978772    0.770379    3200        29.374641   0.100685    0.504199    112.390546 
[37m[36mINFO[0m[0m 03/04 12:12:06 | 0.464985    0.505155    0.974207    0.771055    0.980061    0.464985    0.505155    0.961627    0.698740    0.984516    0.864713    0.976477    0.749713    3400        31.210557   0.102546    0.514076    115.121699 
[37m[36mINFO[0m[0m 03/04 12:15:48 | 0.505149    0.538144    0.974398    0.776000    0.948718    0.505149    0.538144    0.961913    0.693013    0.984516    0.870349    0.976764    0.764638    3600        33.046472   0.083412    0.523665    116.967160 
[37m[36mINFO[0m[0m 03/04 12:19:26 | 0.451596    0.494845    0.975354    0.779488    0.961891    0.451596    0.494845    0.964777    0.699885    0.984234    0.862458    0.977051    0.776119    3800        34.882387   0.081176    0.520902    113.902000 
[37m[36mINFO[0m[0m 03/04 12:23:01 | 0.476313    0.476289    0.976315    0.777247    0.980141    0.476313    0.476289    0.965349    0.698740    0.983390    0.853439    0.980207    0.779564    4000        36.718302   0.081037    0.500894    114.385831 
[37m[36mINFO[0m[0m 03/04 12:26:38 | 0.480947    0.509278    0.978499    0.791612    0.957314    0.480947    0.509278    0.967068    0.723940    0.985642    0.879369    0.982788    0.771527    4200        38.554217   0.075163    0.513243    114.436463 
[37m[36mINFO[0m[0m 03/04 12:30:18 | 0.485582    0.519588    0.982702    0.788626    0.939129    0.485582    0.519588    0.977950    0.723940    0.985360    0.866967    0.984796    0.774971    4400        40.390132   0.063676    0.523884    115.272188 
[37m[36mINFO[0m[0m 03/04 12:33:59 | 0.487642    0.505155    0.981268    0.781344    0.967559    0.487642    0.505155    0.972222    0.702176    0.985923    0.871477    0.985657    0.770379    4600        42.226047   0.058158    0.531074    114.942087 
[37m[36mINFO[0m[0m 03/04 12:37:38 | 0.484037    0.498969    0.984495    0.785968    1.007953    0.484037    0.498969    0.977090    0.705613    0.989302    0.865840    0.987091    0.786452    4800        44.061962   0.062153    0.521452    114.506974 
[37m[36mINFO[0m[0m 03/04 12:41:20 | 0.478888    0.544330    0.983732    0.775669    0.999627    0.478888    0.544330    0.973654    0.697595    0.989302    0.861330    0.988239    0.768083    5000        45.897877   0.062474    0.537918    115.011871 
[37m[36mINFO[0m[0m 03/04 12:41:21 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[0]/250304_11-08-43_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/04 12:41:23 | ---
[37m[36mINFO[0m[0m 03/04 12:41:23 | test-domain validation(oracle) = 47.889%
[37m[36mINFO[0m[0m 03/04 12:41:23 | training-domain validation(iid) = 48.095%
[37m[36mINFO[0m[0m 03/04 12:41:23 | last = 47.889%
[37m[36mINFO[0m[0m 03/04 12:41:23 | last (inD) = 77.567%
[37m[36mINFO[0m[0m 03/04 12:41:23 | training-domain validation (iid, inD) = 79.161%
[37m[36mINFO[0m[0m 03/04 12:41:23 | === Summary ===
[37m[36mINFO[0m[0m 03/04 12:41:23 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome
[37m[36mINFO[0m[0m 03/04 12:41:23 | Unique name: 250304_11-08-43_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/04 12:41:23 | Out path: train_output/OfficeHome/ERM/[0]/250304_11-08-43_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/04 12:41:23 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/04 12:41:23 | Dataset: OfficeHome

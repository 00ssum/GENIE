[37m[36mINFO[0m[0m 03/19 09:26:22 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 0 --hparams_seed 9
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 9
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/OfficeHome/ERM/[0]/250319_09-26-22_resnet50_Sign_GENIE
	out_root: train_output/OfficeHome/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250319_09-26-22_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5.5014200978340895e-05
	batch_size: 15
	weight_decay: 3.288190104805334e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/19 09:26:22 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 09:26:22 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 09:26:22 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 09:26:22 | 
[37m[36mINFO[0m[0m 03/19 09:26:22 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 09:26:22 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 09:26:22 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 09:26:22 | Batch sizes for each domain: [0, 15, 15, 15] (total=45)
[37m[36mINFO[0m[0m 03/19 09:26:22 | steps-per-epoch for each domain: 232.80, 236.80, 232.40 -> min = 232.40
[37m[36mINFO[0m[0m 03/19 09:26:24 | # of params = 23641217
[37m[36mINFO[0m[0m 03/19 09:28:24 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 09:28:24 | 0.019053    0.008247    0.016734    0.014074    4.227468    0.019053    0.008247    0.017182    0.012600    0.013514    0.012401    0.019507    0.017222    0           0.000000    4.289608    2.420737    117.339126 
[37m[36mINFO[0m[0m 03/19 09:31:21 | 0.542225    0.554639    0.740570    0.706587    1.064475    0.542225    0.554639    0.666094    0.611684    0.789696    0.779030    0.765921    0.729047    200         0.860585    1.862321    0.306625    116.233391 
[37m[36mINFO[0m[0m 03/19 09:34:20 | 0.584449    0.604124    0.821268    0.774264    0.875672    0.584449    0.604124    0.766896    0.687285    0.857264    0.842165    0.839644    0.793341    400         1.721170    0.815122    0.320862    114.700670 
[37m[36mINFO[0m[0m 03/19 09:37:24 | 0.565911    0.583505    0.849183    0.764043    0.920889    0.565911    0.583505    0.801546    0.684994    0.885417    0.824126    0.860585    0.783008    600         2.581756    0.614201    0.329232    117.705406 
[37m[36mINFO[0m[0m 03/19 09:40:28 | 0.579815    0.583505    0.877217    0.788793    0.846257    0.579815    0.583505    0.845647    0.713631    0.893863    0.841037    0.892140    0.811711    800         3.442341    0.492037    0.341662    116.230395 
[37m[36mINFO[0m[0m 03/19 09:43:31 | 0.557158    0.583505    0.882706    0.787136    0.844003    0.557158    0.583505    0.845074    0.715922    0.918074    0.861330    0.884968    0.784156    1000        4.302926    0.422163    0.336265    115.889370 
[37m[36mINFO[0m[0m 03/19 09:46:36 | 0.560762    0.579381    0.888208    0.784137    0.853788    0.560762    0.579381    0.857102    0.706758    0.908784    0.852311    0.898738    0.793341    1200        5.163511    0.371420    0.328862    118.822271 
[37m[36mINFO[0m[0m 03/19 09:49:33 | 0.571061    0.595876    0.918784    0.797884    0.803475    0.571061    0.595876    0.894903    0.737686    0.939189    0.853439    0.922260    0.802526    1400        6.024096    0.317605    0.302990    116.495829 
[37m[36mINFO[0m[0m 03/19 09:52:29 | 0.577240    0.614433    0.931836    0.804260    0.804022    0.577240    0.614433    0.908076    0.726231    0.945664    0.875986    0.941767    0.810563    1600        6.884682    0.251336    0.299110    116.129742 
[37m[36mINFO[0m[0m 03/19 09:55:26 | 0.558187    0.548454    0.926083    0.797378    0.949364    0.558187    0.548454    0.900630    0.727377    0.948761    0.874859    0.928858    0.789897    1800        7.745267    0.230003    0.300413    116.541322 
[37m[36mINFO[0m[0m 03/19 09:58:19 | 0.587024    0.606186    0.943910    0.803574    0.838310    0.587024    0.606186    0.926403    0.730813    0.954955    0.862458    0.950373    0.817451    2000        8.605852    0.222985    0.289078    115.607933 
[37m[36mINFO[0m[0m 03/19 10:01:13 | 0.573120    0.618557    0.951844    0.812253    0.816268    0.573120    0.618557    0.936426    0.757159    0.969595    0.879369    0.949512    0.800230    2200        9.466437    0.187581    0.290477    115.704445 
[37m[36mINFO[0m[0m 03/19 10:03:59 | 0.562307    0.581443    0.948369    0.808552    0.890529    0.562307    0.581443    0.938144    0.762887    0.959459    0.857948    0.947504    0.804822    2400        10.327022   0.188788    0.258181    114.765774 
[37m[36mINFO[0m[0m 03/19 10:06:45 | 0.573120    0.616495    0.963120    0.809986    0.949108    0.573120    0.616495    0.955613    0.754868    0.969032    0.874859    0.964716    0.800230    2600        11.187608   0.143700    0.247536    116.386611 
[37m[36mINFO[0m[0m 03/19 10:09:30 | 0.587539    0.595876    0.959108    0.809883    0.833603    0.587539    0.595876    0.942153    0.744559    0.969595    0.892897    0.965577    0.792193    2800        12.048193   0.139251    0.238506    117.224695 
[37m[36mINFO[0m[0m 03/19 10:12:17 | 0.563337    0.569072    0.953098    0.807701    0.984297    0.563337    0.569072    0.929840    0.749141    0.968468    0.873732    0.960987    0.800230    3000        12.908778   0.124673    0.253867    116.182748 
[37m[36mINFO[0m[0m 03/19 10:15:02 | 0.569001    0.585567    0.962063    0.804616    1.051870    0.569001    0.585567    0.952176    0.743414    0.970158    0.878241    0.963855    0.792193    3200        13.769363   0.126428    0.244714    116.167019 
[37m[36mINFO[0m[0m 03/19 10:17:55 | 0.592688    0.622680    0.965574    0.816804    0.975704    0.592688    0.622680    0.952176    0.756014    0.974381    0.886133    0.970166    0.808266    3400        14.629948   0.114212    0.259750    121.269023 
[37m[36mINFO[0m[0m 03/19 10:20:47 | 0.572606    0.604124    0.970336    0.810662    0.959226    0.572606    0.604124    0.957617    0.744559    0.976914    0.890643    0.976477    0.796785    3600        15.490534   0.095677    0.256477    120.716629 
[37m[36mINFO[0m[0m 03/19 10:23:36 | 0.582904    0.600000    0.962058    0.803442    1.125565    0.582904    0.600000    0.951604    0.731959    0.971002    0.883878    0.963569    0.794489    3800        16.351119   0.092238    0.251591    117.865514 
[37m[36mINFO[0m[0m 03/19 10:26:21 | 0.596807    0.606186    0.974696    0.825512    0.954813    0.596807    0.606186    0.963631    0.762887    0.982545    0.900789    0.977912    0.812859    4000        17.211704   0.105715    0.238276    117.889131 
[37m[36mINFO[0m[0m 03/19 10:29:09 | 0.589598    0.583505    0.971650    0.804633    1.009117    0.589598    0.583505    0.960767    0.738832    0.980574    0.875986    0.973609    0.799082    4200        18.072289   0.094443    0.246436    118.415548 
[37m[36mINFO[0m[0m 03/19 10:32:00 | 0.559217    0.593814    0.969501    0.819885    0.895351    0.559217    0.593814    0.957904    0.758305    0.972973    0.882751    0.977625    0.818599    4400        18.932874   0.094610    0.262720    118.629019 
[37m[36mINFO[0m[0m 03/19 10:34:47 | 0.583934    0.604124    0.973277    0.822868    0.962255    0.583934    0.604124    0.962199    0.752577    0.980293    0.896280    0.977338    0.819747    4600        19.793460   0.088283    0.253764    115.752664 
[37m[36mINFO[0m[0m 03/19 10:37:35 | 0.578785    0.585567    0.976030    0.818341    0.968490    0.578785    0.585567    0.962772    0.766323    0.983390    0.883878    0.981928    0.804822    4800        20.654045   0.071106    0.259129    117.041889 
[37m[36mINFO[0m[0m 03/19 10:40:20 | 0.579815    0.575258    0.980107    0.823620    0.974219    0.579815    0.575258    0.967640    0.769759    0.988457    0.896280    0.984223    0.804822    5000        21.514630   0.063746    0.252458    114.182215 
[37m[36mINFO[0m[0m 03/19 10:40:20 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[0]/250319_09-26-22_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 10:40:22 | ---
[37m[36mINFO[0m[0m 03/19 10:40:22 | test-domain validation(oracle) = 59.269%
[37m[36mINFO[0m[0m 03/19 10:40:22 | training-domain validation(iid) = 59.681%
[37m[36mINFO[0m[0m 03/19 10:40:22 | last = 57.981%
[37m[36mINFO[0m[0m 03/19 10:40:22 | last (inD) = 82.362%
[37m[36mINFO[0m[0m 03/19 10:40:22 | training-domain validation (iid, inD) = 82.551%
[37m[36mINFO[0m[0m 03/19 10:40:22 | === Summary ===
[37m[36mINFO[0m[0m 03/19 10:40:22 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 0 --hparams_seed 9
[37m[36mINFO[0m[0m 03/19 10:40:22 | Unique name: 250319_09-26-22_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 10:40:22 | Out path: train_output/OfficeHome/ERM/[0]/250319_09-26-22_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 10:40:22 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 10:40:22 | Dataset: OfficeHome

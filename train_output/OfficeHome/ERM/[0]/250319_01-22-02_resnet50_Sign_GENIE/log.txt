[37m[36mINFO[0m[0m 03/19 01:22:02 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 0 --hparams_seed 3
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 3
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/OfficeHome/ERM/[0]/250319_01-22-02_resnet50_Sign_GENIE
	out_root: train_output/OfficeHome/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250319_01-22-02_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 6.166705009429313e-05
	batch_size: 14
	weight_decay: 3.4412812120883604e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/19 01:22:02 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 01:22:02 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 01:22:02 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 01:22:02 | 
[37m[36mINFO[0m[0m 03/19 01:22:02 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/19 01:22:02 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/19 01:22:02 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 01:22:02 | Batch sizes for each domain: [0, 14, 14, 14] (total=42)
[37m[36mINFO[0m[0m 03/19 01:22:02 | steps-per-epoch for each domain: 249.43, 253.71, 249.00 -> min = 249.00
[37m[36mINFO[0m[0m 03/19 01:22:04 | # of params = 23641217
[37m[36mINFO[0m[0m 03/19 01:24:07 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 01:24:07 | 0.024717    0.016495    0.018248    0.025466    4.226805    0.024717    0.016495    0.017468    0.029782    0.016047    0.024803    0.021228    0.021814    0           0.000000    4.429144    2.135545    120.946486 
[37m[36mINFO[0m[0m 03/19 01:27:02 | 0.524202    0.546392    0.721682    0.694344    1.121139    0.524202    0.546392    0.625716    0.580756    0.786318    0.782413    0.753012    0.719862    200         0.803213    2.395689    0.296976    115.666781 
[37m[36mINFO[0m[0m 03/19 01:29:56 | 0.566426    0.573196    0.782906    0.739688    0.967021    0.566426    0.573196    0.715636    0.648339    0.834459    0.806088    0.798623    0.764638    400         1.606426    1.043031    0.280966    117.245393 
[37m[36mINFO[0m[0m 03/19 01:32:45 | 0.562822    0.562887    0.816716    0.753802    0.939744    0.562822    0.562887    0.752291    0.672394    0.867680    0.810598    0.830178    0.778416    600         2.409639    0.837340    0.258202    117.433960 
[37m[36mINFO[0m[0m 03/19 01:35:39 | 0.583934    0.597938    0.832719    0.753669    0.923088    0.583934    0.597938    0.781787    0.657503    0.874718    0.834273    0.841652    0.769231    800         3.212851    0.672485    0.275932    119.123841 
[37m[36mINFO[0m[0m 03/19 01:38:38 | 0.585994    0.624742    0.842734    0.757611    0.947165    0.585994    0.624742    0.794387    0.687285    0.877534    0.811725    0.856282    0.773823    1000        4.016064    0.604838    0.303720    118.372537 
[37m[36mINFO[0m[0m 03/19 01:41:33 | 0.593718    0.641237    0.880734    0.788251    0.833068    0.593718    0.641237    0.839920    0.705613    0.912725    0.868095    0.889558    0.791045    1200        4.819277    0.496439    0.272322    119.965946 
[37m[36mINFO[0m[0m 03/19 01:44:23 | 0.604531    0.624742    0.899524    0.788680    0.834412    0.604531    0.624742    0.861111    0.717068    0.933559    0.859076    0.903901    0.789897    1400        5.622490    0.450149    0.268573    116.788833 
[37m[36mINFO[0m[0m 03/19 01:47:18 | 0.558702    0.620619    0.904655    0.803915    0.796668    0.558702    0.620619    0.884021    0.739977    0.921453    0.868095    0.908491    0.803674    1600        6.425703    0.382043    0.288028    117.105144 
[37m[36mINFO[0m[0m 03/19 01:50:10 | 0.584449    0.604124    0.912299    0.798202    0.782939    0.584449    0.604124    0.883162    0.722795    0.937500    0.865840    0.916236    0.805970    1800        7.228916    0.385733    0.266044    119.245205 
[37m[36mINFO[0m[0m 03/19 01:53:02 | 0.596292    0.632990    0.930160    0.796602    0.832971    0.596292    0.632990    0.902921    0.731959    0.954110    0.875986    0.933448    0.781860    2000        8.032129    0.322587    0.265476    118.656981 
[37m[36mINFO[0m[0m 03/19 01:55:54 | 0.544284    0.569072    0.912842    0.782190    0.943245    0.544284    0.569072    0.879152    0.713631    0.942849    0.856821    0.916523    0.776119    2200        8.835341    0.302355    0.282438    116.002375 
[37m[36mINFO[0m[0m 03/19 01:58:51 | 0.579815    0.608247    0.928871    0.794010    0.917045    0.579815    0.608247    0.902921    0.726231    0.946227    0.862458    0.937464    0.793341    2400        9.638554    0.260847    0.295639    117.091301 
[37m[36mINFO[0m[0m 03/19 02:01:49 | 0.561277    0.595876    0.940441    0.805025    0.841869    0.561277    0.595876    0.917812    0.744559    0.960023    0.873732    0.943488    0.796785    2600        10.441767   0.249240    0.304584    116.993401 
[37m[36mINFO[0m[0m 03/19 02:04:52 | 0.559217    0.579381    0.941860    0.799331    0.956072    0.559217    0.579381    0.922680    0.729668    0.961993    0.868095    0.940906    0.800230    2800        11.244980   0.231523    0.327952    118.232484 
[37m[36mINFO[0m[0m 03/19 02:07:53 | 0.589598    0.608247    0.953683    0.812250    0.901956    0.589598    0.608247    0.938144    0.760596    0.965935    0.879369    0.956971    0.796785    3000        12.048193   0.221586    0.305152    119.132785 
[37m[36mINFO[0m[0m 03/19 02:10:50 | 0.597322    0.626804    0.957377    0.811892    0.880964    0.597322    0.626804    0.937858    0.745704    0.971565    0.877114    0.962708    0.812859    3200        12.851406   0.216378    0.295976    118.487226 
[37m[36mINFO[0m[0m 03/19 02:13:46 | 0.587024    0.597938    0.951218    0.805811    0.892662    0.587024    0.597938    0.932131    0.744559    0.963119    0.870349    0.958405    0.802526    3400        13.654618   0.174977    0.290783    117.635910 
[37m[36mINFO[0m[0m 03/19 02:16:38 | 0.564367    0.595876    0.959300    0.814537    0.867396    0.564367    0.595876    0.946735    0.764032    0.969032    0.880496    0.962134    0.799082    3600        14.457831   0.191783    0.273530    117.575010 
[37m[36mINFO[0m[0m 03/19 02:19:30 | 0.598867    0.618557    0.960615    0.809928    0.908036    0.598867    0.618557    0.951031    0.749141    0.972410    0.885006    0.958405    0.795637    3800        15.261044   0.176768    0.269191    117.887315 
[37m[36mINFO[0m[0m 03/19 02:22:19 | 0.603502    0.620619    0.959965    0.823263    0.878749    0.603502    0.620619    0.943299    0.773196    0.970158    0.891770    0.966437    0.804822    4000        16.064257   0.168801    0.261909    116.327837 
[37m[36mINFO[0m[0m 03/19 02:25:03 | 0.584449    0.616495    0.967744    0.814924    1.017362    0.584449    0.616495    0.951604    0.767468    0.979167    0.879369    0.972461    0.797933    4200        16.867470   0.153323    0.238132    116.900330 
[37m[36mINFO[0m[0m 03/19 02:27:44 | 0.601442    0.620619    0.971623    0.819874    0.927742    0.601442    0.620619    0.952463    0.772050    0.985642    0.882751    0.976764    0.804822    4400        17.670683   0.152907    0.225696    115.634389 
[37m[36mINFO[0m[0m 03/19 02:30:26 | 0.592688    0.600000    0.970034    0.810709    0.908310    0.592688    0.600000    0.956186    0.756014    0.979448    0.881623    0.974469    0.794489    4600        18.473896   0.124606    0.237493    114.198823 
[37m[36mINFO[0m[0m 03/19 02:33:11 | 0.604531    0.632990    0.975362    0.822493    0.900824    0.604531    0.632990    0.960195    0.760596    0.983390    0.894025    0.982501    0.812859    4800        19.277108   0.121736    0.247019    116.185534 
[37m[36mINFO[0m[0m 03/19 02:35:59 | 0.584964    0.573196    0.968615    0.808834    0.946030    0.584964    0.573196    0.952463    0.741123    0.977477    0.877114    0.975904    0.808266    5000        20.080321   0.102835    0.246484    118.455457 
[37m[36mINFO[0m[0m 03/19 02:35:59 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[0]/250319_01-22-02_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 02:36:00 | ---
[37m[36mINFO[0m[0m 03/19 02:36:00 | test-domain validation(oracle) = 59.372%
[37m[36mINFO[0m[0m 03/19 02:36:00 | training-domain validation(iid) = 60.350%
[37m[36mINFO[0m[0m 03/19 02:36:00 | last = 58.496%
[37m[36mINFO[0m[0m 03/19 02:36:00 | last (inD) = 80.883%
[37m[36mINFO[0m[0m 03/19 02:36:00 | training-domain validation (iid, inD) = 82.326%
[37m[36mINFO[0m[0m 03/19 02:36:00 | === Summary ===
[37m[36mINFO[0m[0m 03/19 02:36:00 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset OfficeHome --trial_seed 0 --hparams_seed 3
[37m[36mINFO[0m[0m 03/19 02:36:00 | Unique name: 250319_01-22-02_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 02:36:00 | Out path: train_output/OfficeHome/ERM/[0]/250319_01-22-02_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 02:36:00 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 02:36:00 | Dataset: OfficeHome

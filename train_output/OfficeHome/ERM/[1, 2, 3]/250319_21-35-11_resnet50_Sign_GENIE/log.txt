[37m[36mINFO[0m[0m 03/19 21:35:11 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 2 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/OfficeHome/ERM/[1, 2, 3]/250319_21-35-11_resnet50_Sign_GENIE
	out_root: train_output/OfficeHome/ERM/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 0
	unique_name: 250319_21-35-11_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5.0781288859686544e-05
	batch_size: 44
	weight_decay: 0.00046410133598234803
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/19 21:35:11 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 21:35:11 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 21:35:11 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 21:35:11 | 
[37m[36mINFO[0m[0m 03/19 21:35:11 | Testenv name escaping te_C_P_R -> te_C_P_R
[37m[36mINFO[0m[0m 03/19 21:35:11 | Test envs = [1, 2, 3], name = te_C_P_R
[37m[36mINFO[0m[0m 03/19 21:35:11 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 03/19 21:35:11 | Batch sizes for each domain: [44, 0, 0, 0] (total=44)
[37m[36mINFO[0m[0m 03/19 21:35:11 | steps-per-epoch for each domain: 44.14 -> min = 44.14
[37m[36mINFO[0m[0m 03/19 21:35:12 | # of params = 23641217
[37m[36mINFO[0m[0m 03/19 21:36:56 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 21:36:56 | 0.025868    0.025485    0.044284    0.045361    4.190257    0.044284    0.045361    0.025200    0.022910    0.019989    0.022548    0.032415    0.030999    0           0.000000    4.248192    1.285584    103.116112 
[37m[36mINFO[0m[0m 03/19 21:39:41 | 0.527292    0.507369    0.875901    0.698969    1.256685    0.875901    0.698969    0.412944    0.392898    0.531813    0.528749    0.637120    0.600459    200         4.531411    1.571311    0.318916    101.436399 
[37m[36mINFO[0m[0m 03/19 21:42:27 | 0.534825    0.536359    0.932029    0.692784    1.345030    0.932029    0.692784    0.403207    0.427262    0.551239    0.540023    0.650029    0.641791    400         9.062822    0.333596    0.326992    100.564372 
[37m[36mINFO[0m[0m 03/19 21:45:11 | 0.559455    0.549294    0.970649    0.736082    1.202412    0.970649    0.736082    0.438144    0.437572    0.569538    0.551297    0.670683    0.659013    600         13.594233   0.162426    0.314471    100.733000 
[37m[36mINFO[0m[0m 03/19 21:47:56 | 0.567899    0.563690    0.988671    0.744330    1.352774    0.988671    0.744330    0.425544    0.439863    0.596284    0.574972    0.681870    0.676234    800         18.125644   0.091363    0.308567    103.366577 
[37m[36mINFO[0m[0m 03/19 21:50:42 | 0.567096    0.548916    0.994336    0.727835    1.484825    0.994336    0.727835    0.436140    0.430699    0.601351    0.551297    0.663798    0.664753    1000        22.657055   0.060504    0.317456    102.174020 
[37m[36mINFO[0m[0m 03/19 21:53:25 | 0.565536    0.561741    0.989701    0.744330    1.444475    0.989701    0.744330    0.427262    0.431844    0.591779    0.581736    0.677567    0.671642    1200        27.188465   0.048971    0.305327    101.990660 
[37m[36mINFO[0m[0m 03/19 21:56:07 | 0.568322    0.559938    0.992276    0.748454    1.472459    0.992276    0.748454    0.442153    0.439863    0.588401    0.562570    0.674412    0.677382    1400        31.719876   0.033074    0.310037    100.305064 
[37m[36mINFO[0m[0m 03/19 21:58:48 | 0.558305    0.543524    0.995881    0.738144    1.475588    0.995881    0.738144    0.416667    0.412371    0.586993    0.559188    0.671256    0.659013    1600        36.251287   0.026675    0.303431    100.242093 
[37m[36mINFO[0m[0m 03/19 22:01:34 | 0.545233    0.532875    0.990216    0.723711    1.473436    0.990216    0.723711    0.416094    0.406644    0.567568    0.549042    0.652037    0.642939    1800        40.782698   0.058111    0.311310    103.230602 
[37m[36mINFO[0m[0m 03/19 22:04:18 | 0.559940    0.544678    0.995881    0.742268    1.480377    0.995881    0.742268    0.422394    0.413517    0.585023    0.558061    0.672404    0.662457    2000        45.314109   0.025369    0.321023    100.668139 
[37m[36mINFO[0m[0m 03/19 22:07:02 | 0.581036    0.565524    0.995881    0.752577    1.533340    0.995881    0.752577    0.451317    0.435281    0.603322    0.588501    0.688468    0.672790    2200        49.845520   0.014778    0.307203    101.841221 
[37m[36mINFO[0m[0m 03/19 22:09:43 | 0.593193    0.581880    0.988671    0.754639    1.497933    0.988671    0.754639    0.468499    0.457045    0.614865    0.602029    0.696213    0.686567    2400        54.376931   0.010659    0.312372    98.875935  
[37m[36mINFO[0m[0m 03/19 22:12:26 | 0.578851    0.562098    0.995881    0.756701    1.625467    0.995881    0.756701    0.445017    0.428408    0.601633    0.586246    0.689902    0.671642    2600        58.908342   0.014130    0.298297    102.755032 
[37m[36mINFO[0m[0m 03/19 22:15:08 | 0.592674    0.580006    0.995366    0.760825    1.412037    0.995366    0.760825    0.455040    0.451317    0.622466    0.596392    0.700516    0.692308    2800        63.439753   0.011172    0.306672    100.971933 
[37m[36mINFO[0m[0m 03/19 22:17:50 | 0.578254    0.559494    0.998455    0.754639    1.578376    0.998455    0.754639    0.445590    0.438717    0.605293    0.572717    0.683878    0.667049    3000        67.971164   0.009637    0.307516    100.126009 
[37m[36mINFO[0m[0m 03/19 22:20:34 | 0.576178    0.568249    0.993821    0.752577    1.448884    0.993821    0.752577    0.448740    0.455899    0.600507    0.578354    0.679289    0.670494    3200        72.502575   0.010676    0.317650    100.834436 
[37m[36mINFO[0m[0m 03/19 22:23:15 | 0.570835    0.559055    0.990216    0.731959    1.485204    0.990216    0.731959    0.446735    0.441008    0.598818    0.581736    0.666954    0.654420    3400        77.033986   0.020392    0.306361    99.926610  
[37m[36mINFO[0m[0m 03/19 22:26:01 | 0.565442    0.553057    0.993306    0.748454    1.496329    0.993306    0.748454    0.431558    0.430699    0.591216    0.562570    0.673551    0.665901    3600        81.565396   0.015165    0.310856    103.655181 
[37m[36mINFO[0m[0m 03/19 22:28:42 | 0.561304    0.543507    0.994336    0.760825    1.589153    0.994336    0.760825    0.418385    0.416953    0.596565    0.561443    0.668962    0.652124    3800        86.096807   0.022872    0.305611    100.035837 
[37m[36mINFO[0m[0m 03/19 22:31:24 | 0.575839    0.559184    0.995881    0.773196    1.466769    0.995881    0.773196    0.454467    0.461627    0.593187    0.558061    0.679862    0.657865    4000        90.628218   0.010489    0.304482    100.831538 
[37m[36mINFO[0m[0m 03/19 22:34:08 | 0.584664    0.563338    0.996395    0.767010    1.517677    0.996395    0.767010    0.457331    0.444444    0.603604    0.569335    0.693058    0.676234    4200        95.159629   0.010317    0.318631    100.783481 
[37m[36mINFO[0m[0m 03/19 22:36:49 | 0.579399    0.568605    0.995881    0.748454    1.427882    0.995881    0.748454    0.448454    0.445590    0.605293    0.583991    0.684452    0.676234    4400        99.691040   0.013211    0.306009    99.471589  
[37m[36mINFO[0m[0m 03/19 22:39:31 | 0.581282    0.571424    0.994851    0.742268    1.532603    0.994851    0.742268    0.447881    0.469645    0.610079    0.558061    0.685886    0.686567    4600        104.222451  0.011893    0.309665    100.140539 
[37m[36mINFO[0m[0m 03/19 22:42:13 | 0.560697    0.544712    0.994336    0.744330    1.634537    0.994336    0.744330    0.423540    0.414662    0.586149    0.552424    0.672404    0.667049    4800        108.753862  0.010116    0.313037    99.735171  
[37m[36mINFO[0m[0m 03/19 22:44:56 | 0.577678    0.557252    0.996395    0.738144    1.699468    0.996395    0.738144    0.439863    0.422680    0.606137    0.565953    0.687034    0.683123    5000        113.285273  0.012323    0.309058    100.313752 
[37m[36mINFO[0m[0m 03/19 22:44:56 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[1, 2, 3]/250319_21-35-11_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 22:44:57 | ---
[37m[36mINFO[0m[0m 03/19 22:44:57 | test-domain validation(oracle) = 59.319%
[37m[36mINFO[0m[0m 03/19 22:44:57 | training-domain validation(iid) = 57.584%
[37m[36mINFO[0m[0m 03/19 22:44:57 | last = 57.768%
[37m[36mINFO[0m[0m 03/19 22:44:57 | last (inD) = 73.814%
[37m[36mINFO[0m[0m 03/19 22:44:57 | training-domain validation (iid, inD) = 77.320%
[37m[36mINFO[0m[0m 03/19 22:44:57 | === Summary ===
[37m[36mINFO[0m[0m 03/19 22:44:57 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 2 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 1
[37m[36mINFO[0m[0m 03/19 22:44:57 | Unique name: 250319_21-35-11_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 22:44:57 | Out path: train_output/OfficeHome/ERM/[1, 2, 3]/250319_21-35-11_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 22:44:57 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 22:44:57 | Dataset: OfficeHome

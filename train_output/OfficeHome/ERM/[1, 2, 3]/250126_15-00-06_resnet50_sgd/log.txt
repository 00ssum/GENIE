[37m[36mINFO[0m[0m 01/26 15:00:06 | Command :: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm ERM --test_envs 1 2 3 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/OfficeHome/ERM/[1, 2, 3]/250126_15-00-06_resnet50_sgd
	out_root: train_output/OfficeHome/ERM/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 0
	unique_name: 250126_15-00-06_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 01/26 15:00:06 | n_steps = 5001
[37m[36mINFO[0m[0m 01/26 15:00:06 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/26 15:00:06 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/26 15:00:06 | 
[37m[36mINFO[0m[0m 01/26 15:00:06 | Testenv name escaping te_C_P_R -> te_C_P_R
[37m[36mINFO[0m[0m 01/26 15:00:06 | Test envs = [1, 2, 3], name = te_C_P_R
[37m[36mINFO[0m[0m 01/26 15:00:06 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 01/26 15:00:06 | Batch sizes for each domain: [32, 0, 0, 0] (total=32)
[37m[36mINFO[0m[0m 01/26 15:00:06 | steps-per-epoch for each domain: 60.69 -> min = 60.69
[37m[36mINFO[0m[0m 01/26 15:00:07 | # of params = 23641217
[37m[36mINFO[0m[0m 01/26 15:01:59 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/26 15:01:59 | 0.015211    0.012904    0.015963    0.026804    4.255101    0.015963    0.026804    0.017182    0.014891    0.012387    0.015784    0.016064    0.008037    0           0.000000    4.231345    0.867306    110.649270 
[37m[36mINFO[0m[0m 01/26 15:04:35 | 0.018542    0.014044    0.027806    0.045361    4.196039    0.027806    0.045361    0.020905    0.016037    0.014640    0.016911    0.020080    0.009185    200         3.295572    4.196058    0.239232    108.118220 
[37m[36mINFO[0m[0m 01/26 15:07:23 | 0.021779    0.017863    0.043769    0.051546    4.149818    0.043769    0.051546    0.025773    0.018328    0.016329    0.018038    0.023236    0.017222    400         6.591143    4.145958    0.239150    120.031347 
[37m[36mINFO[0m[0m 01/26 15:10:14 | 0.025772    0.020159    0.055098    0.063918    4.107423    0.055098    0.063918    0.028923    0.018328    0.019707    0.018038    0.028686    0.024110    600         9.886715    4.092258    0.275235    115.870707 
[37m[36mINFO[0m[0m 01/26 15:12:52 | 0.030150    0.023988    0.064367    0.080412    4.066344    0.064367    0.080412    0.034078    0.024055    0.022523    0.016911    0.033850    0.030999    800         13.182286   4.061811    0.242930    108.960821 
[37m[36mINFO[0m[0m 01/26 15:15:39 | 0.036807    0.030467    0.077755    0.084536    4.024037    0.077755    0.084536    0.038660    0.032073    0.027872    0.020293    0.043890    0.039036    1000        16.477858   4.024929    0.246778    117.481474 
[37m[36mINFO[0m[0m 01/26 15:18:44 | 0.043758    0.036565    0.097837    0.096907    3.975445    0.097837    0.096907    0.043528    0.038946    0.032095    0.023675    0.055651    0.047072    1200        19.773429   3.968928    0.285569    127.609289 
[37m[36mINFO[0m[0m 01/26 15:21:35 | 0.054126    0.048355    0.109681    0.123711    3.917759    0.109681    0.123711    0.051260    0.044674    0.039977    0.034949    0.071142    0.065442    1400        23.069001   3.907086    0.252946    119.811438 
[37m[36mINFO[0m[0m 01/26 15:24:29 | 0.068874    0.068108    0.143666    0.164948    3.852352    0.143666    0.164948    0.061569    0.057274    0.050676    0.057497    0.094378    0.089552    1600        26.364573   3.851916    0.248324    124.409467 
[37m[36mINFO[0m[0m 01/26 15:27:25 | 0.086451    0.083348    0.180227    0.197938    3.776543    0.180227    0.197938    0.075029    0.073310    0.067286    0.066516    0.117040    0.110218    1800        29.660144   3.766910    0.246372    126.383002 
[37m[36mINFO[0m[0m 01/26 15:30:14 | 0.105382    0.103873    0.210093    0.228866    3.681572    0.210093    0.228866    0.094788    0.085911    0.081081    0.087937    0.140275    0.137773    2000        32.955716   3.682019    0.267184    114.540287 
[37m[36mINFO[0m[0m 01/26 15:32:54 | 0.122473    0.126296    0.251287    0.257732    3.560691    0.251287    0.257732    0.109107    0.109966    0.098818    0.110485    0.159495    0.158439    2200        36.251287   3.565455    0.243749    111.785502 
[37m[36mINFO[0m[0m 01/26 15:35:37 | 0.141858    0.144958    0.271370    0.276289    3.412321    0.271370    0.276289    0.126861    0.129439    0.116554    0.122886    0.182157    0.182549    2400        39.546859   3.428389    0.231002    116.477718 
[37m[36mINFO[0m[0m 01/26 15:38:18 | 0.164939    0.166578    0.312049    0.305155    3.229731    0.312049    0.305155    0.142325    0.147766    0.139640    0.152198    0.212851    0.199770    2600        42.842430   3.295654    0.231718    113.891201 
[37m[36mINFO[0m[0m 01/26 15:40:59 | 0.194073    0.193593    0.357878    0.352577    3.001751    0.357878    0.352577    0.162085    0.163803    0.172860    0.175874    0.247275    0.241102    2800        46.138002   3.063743    0.238368    113.273445 
[37m[36mINFO[0m[0m 01/26 15:43:43 | 0.221026    0.221739    0.401648    0.391753    2.763277    0.401648    0.391753    0.173826    0.174112    0.204110    0.202931    0.285141    0.288175    3000        49.433574   2.804590    0.238078    115.619430 
[37m[36mINFO[0m[0m 01/26 15:46:22 | 0.252454    0.254069    0.460865    0.453608    2.492073    0.460865    0.453608    0.195876    0.200458    0.237331    0.232244    0.324154    0.329506    3200        52.729145   2.520331    0.246362    110.222538 
[37m[36mINFO[0m[0m 01/26 15:49:04 | 0.291640    0.295817    0.511843    0.501031    2.239558    0.511843    0.501031    0.219931    0.233677    0.283502    0.285231    0.371486    0.368542    3400        56.024717   2.210299    0.248071    112.090407 
[37m[36mINFO[0m[0m 01/26 15:51:45 | 0.332389    0.331563    0.565396    0.527835    2.002124    0.565396    0.527835    0.250859    0.261168    0.323761    0.319053    0.422547    0.414466    3600        59.320288   1.913038    0.242067    111.723902 
[37m[36mINFO[0m[0m 01/26 15:54:24 | 0.367903    0.366511    0.604531    0.538144    1.834428    0.604531    0.538144    0.275773    0.276060    0.360923    0.359639    0.467011    0.463835    3800        62.615860   1.657433    0.232989    112.260699 
[37m[36mINFO[0m[0m 01/26 15:57:10 | 0.387906    0.385136    0.642122    0.589691    1.719982    0.642122    0.589691    0.291237    0.289805    0.386824    0.378805    0.485657    0.486797    4000        65.911432   1.470755    0.249712    115.536290 
[37m[36mINFO[0m[0m 01/26 15:59:53 | 0.420646    0.422384    0.679197    0.595876    1.632387    0.679197    0.595876    0.317583    0.318442    0.423986    0.417136    0.520367    0.531573    4200        69.207003   1.276628    0.242074    113.640579 
[37m[36mINFO[0m[0m 01/26 16:02:31 | 0.434110    0.431486    0.717817    0.591753    1.555945    0.717817    0.591753    0.326460    0.327606    0.441160    0.429538    0.534710    0.537313    4400        72.502575   1.135766    0.238630    110.468671 
[37m[36mINFO[0m[0m 01/26 16:05:09 | 0.453155    0.448927    0.735839    0.610309    1.496319    0.735839    0.610309    0.337342    0.333333    0.467905    0.455468    0.554217    0.557979    4600        75.798146   0.997944    0.234073    110.251904 
[37m[36mINFO[0m[0m 01/26 16:07:50 | 0.466181    0.462953    0.751802    0.624742    1.448146    0.751802    0.624742    0.351088    0.355097    0.478322    0.474634    0.569134    0.559127    4800        79.093718   0.925137    0.235140    113.758640 
[37m[36mINFO[0m[0m 01/26 16:10:31 | 0.476680    0.475446    0.775489    0.637113    1.416550    0.775489    0.637113    0.350802    0.352806    0.496622    0.497182    0.582616    0.576349    5000        82.389289   0.862491    0.252518    111.005428 
[37m[36mINFO[0m[0m 01/26 16:10:32 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[1, 2, 3]/250126_15-00-06_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/26 16:10:33 | ---
[37m[36mINFO[0m[0m 01/26 16:10:33 | test-domain validation(oracle) = 47.668%
[37m[36mINFO[0m[0m 01/26 16:10:33 | training-domain validation(iid) = 47.668%
[37m[36mINFO[0m[0m 01/26 16:10:33 | last = 47.668%
[37m[36mINFO[0m[0m 01/26 16:10:33 | last (inD) = 63.711%
[37m[36mINFO[0m[0m 01/26 16:10:33 | training-domain validation (iid, inD) = 63.711%
[37m[36mINFO[0m[0m 01/26 16:10:33 | === Summary ===
[37m[36mINFO[0m[0m 01/26 16:10:33 | Command: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm ERM --test_envs 1 2 3 --dataset OfficeHome
[37m[36mINFO[0m[0m 01/26 16:10:33 | Unique name: 250126_15-00-06_resnet50_sgd
[37m[36mINFO[0m[0m 01/26 16:10:33 | Out path: train_output/OfficeHome/ERM/[1, 2, 3]/250126_15-00-06_resnet50_sgd
[37m[36mINFO[0m[0m 01/26 16:10:33 | Algorithm: ERM
[37m[36mINFO[0m[0m 01/26 16:10:33 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 02/27 09:48:49 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_adam config/clip_vitb16_adam.yaml --algorithm ERM --test_envs 3 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_adam.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_adam
	out_dir: train_output/OfficeHome/ERM/[3]/250227_09-48-49_clip_vitb16_adam
	out_root: train_output/OfficeHome/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250227_09-48-49_clip_vitb16_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: clip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/27 09:48:49 | n_steps = 5001
[37m[36mINFO[0m[0m 02/27 09:48:49 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/27 09:48:49 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/27 09:48:49 | 
[37m[36mINFO[0m[0m 02/27 09:48:49 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 02/27 09:48:49 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 02/27 09:48:49 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/27 09:48:49 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 02/27 09:48:49 | steps-per-epoch for each domain: 60.69, 109.12, 111.00 -> min = 60.69
[37m[36mINFO[0m[0m 02/27 09:48:52 | # of params = 86225985
[37m[36mINFO[0m[0m 02/27 09:50:59 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/27 09:50:59 | 0.044750    0.045924    0.043503    0.048815    4.166273    0.061277    0.068041    0.031787    0.038946    0.037444    0.039459    0.044750    0.045924    0           0.000000    4.166363    1.142679    126.482279 
[37m[36mINFO[0m[0m 02/27 09:54:29 | 0.746414    0.763490    0.830206    0.770722    0.932772    0.845005    0.750515    0.786942    0.727377    0.858671    0.834273    0.746414    0.763490    200         3.295572    1.849803    0.408617    128.241261 
[37m[36mINFO[0m[0m 02/27 09:57:57 | 0.767355    0.779564    0.904216    0.789596    0.841113    0.923275    0.740206    0.864261    0.753723    0.925113    0.874859    0.767355    0.779564    400         6.591143    0.515072    0.406054    126.970082 
[37m[36mINFO[0m[0m 02/27 10:01:25 | 0.767642    0.794489    0.934361    0.783828    0.863574    0.956746    0.742268    0.903207    0.741123    0.943131    0.868095    0.767642    0.794489    600         9.886715    0.313924    0.410600    125.536871 
[37m[36mINFO[0m[0m 02/27 10:04:53 | 0.760184    0.766935    0.938287    0.780462    0.901650    0.958290    0.719588    0.908935    0.752577    0.947635    0.869222    0.760184    0.766935    800         13.182286   0.252972    0.410639    125.411230 
[37m[36mINFO[0m[0m 02/27 10:08:28 | 0.757028    0.760046    0.952867    0.788346    0.908266    0.972709    0.734021    0.928121    0.765178    0.957770    0.865840    0.757028    0.760046    1000        16.477858   0.190466    0.408121    133.653089 
[37m[36mINFO[0m[0m 02/27 10:11:55 | 0.724613    0.742824    0.957336    0.781749    0.955909    0.969619    0.715464    0.938144    0.758305    0.964245    0.871477    0.724613    0.742824    1200        19.773429   0.183347    0.408897    125.116654 
[37m[36mINFO[0m[0m 02/27 10:15:24 | 0.746988    0.763490    0.965838    0.801885    0.909989    0.973738    0.758763    0.954181    0.770905    0.969595    0.875986    0.746988    0.763490    1400        23.069001   0.133111    0.409387    127.778261 
[37m[36mINFO[0m[0m 02/27 10:18:51 | 0.713425    0.742824    0.951937    0.765895    1.096933    0.968074    0.701031    0.920676    0.730813    0.967061    0.865840    0.713425    0.742824    1600        26.364573   0.164224    0.410529    124.329786 
[37m[36mINFO[0m[0m 02/27 10:22:18 | 0.730637    0.756602    0.958276    0.767036    1.055075    0.969619    0.713402    0.938431    0.735395    0.966779    0.852311    0.730637    0.756602    1800        29.660144   0.117994    0.408494    125.083306 
[37m[36mINFO[0m[0m 02/27 10:25:42 | 0.687608    0.710677    0.957009    0.769108    1.070006    0.957261    0.676289    0.945017    0.766323    0.968750    0.864713    0.687608    0.710677    2000        32.955716   0.129639    0.409471    122.911352 
[37m[36mINFO[0m[0m 02/27 10:29:13 | 0.732932    0.733639    0.974385    0.792655    0.971489    0.983522    0.717526    0.959622    0.772050    0.980011    0.888388    0.732932    0.733639    2200        36.251287   0.119561    0.408272    128.848230 
[37m[36mINFO[0m[0m 02/27 10:32:48 | 0.726908    0.746269    0.976459    0.790434    1.025126    0.983522    0.715464    0.961340    0.766323    0.984516    0.889515    0.726908    0.746269    2400        39.546859   0.076684    0.407159    133.149773 
[37m[36mINFO[0m[0m 02/27 10:36:27 | 0.722031    0.754305    0.972226    0.787488    1.052952    0.980947    0.715464    0.961913    0.777778    0.973818    0.869222    0.722031    0.754305    2600        42.842430   0.106997    0.410146    137.853714 
[37m[36mINFO[0m[0m 02/27 10:40:08 | 0.720597    0.749713    0.972545    0.787223    1.027126    0.976828    0.711340    0.962486    0.774341    0.978322    0.875986    0.720597    0.749713    2800        46.138002   0.081581    0.408023    138.814661 
[37m[36mINFO[0m[0m 02/27 10:43:44 | 0.725473    0.739380    0.973872    0.780919    1.052342    0.982492    0.705155    0.962772    0.753723    0.976351    0.883878    0.725473    0.739380    3000        49.433574   0.116246    0.408921    133.904773 
[37m[36mINFO[0m[0m 02/27 10:47:11 | 0.704246    0.731343    0.975587    0.785185    1.058716    0.981977    0.715464    0.964490    0.768614    0.980293    0.871477    0.704246    0.731343    3200        52.729145   0.075845    0.408699    125.437954 
[37m[36mINFO[0m[0m 02/27 10:50:43 | 0.699369    0.724455    0.964568    0.760561    1.132707    0.968589    0.680412    0.950172    0.737686    0.974944    0.863585    0.699369    0.724455    3400        56.024717   0.099664    0.408828    130.837801 
[37m[36mINFO[0m[0m 02/27 10:54:19 | 0.698508    0.704937    0.973185    0.771702    1.036223    0.974768    0.676289    0.964777    0.759450    0.980011    0.879369    0.698508    0.704937    3600        59.320288   0.104796    0.411711    133.283654 
[37m[36mINFO[0m[0m 02/27 10:57:47 | 0.666667    0.672790    0.968504    0.741207    1.225053    0.970649    0.657732    0.960481    0.710195    0.974381    0.855693    0.666667    0.672790    3800        62.615860   0.080637    0.409644    126.059783 
[37m[36mINFO[0m[0m 02/27 11:01:20 | 0.707688    0.706085    0.974713    0.753849    1.247552    0.980433    0.657732    0.967354    0.756014    0.976351    0.847802    0.707688    0.706085    4000        65.911432   0.092323    0.410133    130.493972 
[37m[36mINFO[0m[0m 02/27 11:05:02 | 0.718589    0.734788    0.980769    0.786190    1.090164    0.988671    0.719588    0.971936    0.769759    0.981700    0.869222    0.718589    0.734788    4200        69.207003   0.072675    0.410826    140.203060 
[37m[36mINFO[0m[0m 02/27 11:08:35 | 0.723465    0.738232    0.982740    0.778523    1.097580    0.988671    0.688660    0.971936    0.772050    0.987613    0.874859    0.723465    0.738232    4400        72.502575   0.060594    0.410532    130.508705 
[37m[36mINFO[0m[0m 02/27 11:12:06 | 0.687321    0.711825    0.976584    0.769190    1.185999    0.978373    0.684536    0.971649    0.759450    0.979730    0.863585    0.687321    0.711825    4600        75.798146   0.087697    0.413467    129.164901 
[37m[36mINFO[0m[0m 02/27 11:15:43 | 0.688468    0.692308    0.978650    0.751775    1.223057    0.983522    0.672165    0.967068    0.733104    0.985360    0.850056    0.688468    0.692308    4800        79.093718   0.071781    0.406108    135.577835 
[37m[36mINFO[0m[0m 02/27 11:19:23 | 0.690476    0.702641    0.975274    0.766120    1.181789    0.985582    0.696907    0.962199    0.749141    0.978041    0.852311    0.690476    0.702641    5000        82.389289   0.088808    0.408704    138.072960 
[37m[36mINFO[0m[0m 02/27 11:19:23 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[3]/250227_09-48-49_clip_vitb16_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/27 11:19:28 | ---
[37m[36mINFO[0m[0m 02/27 11:19:28 | test-domain validation(oracle) = 76.764%
[37m[36mINFO[0m[0m 02/27 11:19:28 | training-domain validation(iid) = 74.699%
[37m[36mINFO[0m[0m 02/27 11:19:28 | last = 69.048%
[37m[36mINFO[0m[0m 02/27 11:19:28 | last (inD) = 76.612%
[37m[36mINFO[0m[0m 02/27 11:19:28 | training-domain validation (iid, inD) = 80.188%
[37m[36mINFO[0m[0m 02/27 11:19:28 | === Summary ===
[37m[36mINFO[0m[0m 02/27 11:19:28 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_adam config/clip_vitb16_adam.yaml --algorithm ERM --test_envs 3 --dataset OfficeHome
[37m[36mINFO[0m[0m 02/27 11:19:28 | Unique name: 250227_09-48-49_clip_vitb16_adam
[37m[36mINFO[0m[0m 02/27 11:19:28 | Out path: train_output/OfficeHome/ERM/[3]/250227_09-48-49_clip_vitb16_adam
[37m[36mINFO[0m[0m 02/27 11:19:28 | Algorithm: ERM
[37m[36mINFO[0m[0m 02/27 11:19:28 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 03/18 19:05:27 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm ERM --test_envs 3 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/ERM/[3]/250318_19-05-27_resnet50_GENIE
	out_root: train_output/OfficeHome/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250318_19-05-27_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/18 19:05:27 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 19:05:27 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 19:05:27 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 19:05:27 | 
[37m[36mINFO[0m[0m 03/18 19:05:27 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 03/18 19:05:27 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 03/18 19:05:27 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/18 19:05:27 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 03/18 19:05:27 | steps-per-epoch for each domain: 60.69, 109.12, 111.00 -> min = 60.69
[37m[36mINFO[0m[0m 03/18 19:05:28 | # of params = 23641217
[37m[36mINFO[0m[0m 03/18 19:07:29 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 19:07:29 | 0.019220    0.022962    0.015697    0.013056    4.223333    0.022142    0.016495    0.010309    0.008018    0.014640    0.014656    0.019220    0.022962    0           0.000000    4.305778    2.135273    118.914913 
[37m[36mINFO[0m[0m 03/18 19:10:24 | 0.736087    0.734788    0.790350    0.717349    1.060674    0.793512    0.703093    0.740263    0.658648    0.837275    0.790304    0.736087    0.734788    200         3.295572    1.635065    0.291084    116.772126 
[37m[36mINFO[0m[0m 03/18 19:13:22 | 0.765634    0.771527    0.879499    0.777645    0.918746    0.895469    0.746392    0.837342    0.733104    0.905687    0.853439    0.765634    0.771527    400         6.591143    0.534122    0.293675    118.739676 
[37m[36mINFO[0m[0m 03/18 19:16:19 | 0.764773    0.757750    0.918005    0.772633    0.945505    0.938208    0.736082    0.879152    0.719359    0.936655    0.862458    0.764773    0.757750    600         9.886715    0.361514    0.293760    118.659874 
[37m[36mINFO[0m[0m 03/18 19:19:16 | 0.755881    0.729047    0.929903    0.767585    1.024855    0.946962    0.715464    0.907216    0.709049    0.935529    0.878241    0.755881    0.729047    800         13.182286   0.254235    0.281998    119.931086 
[37m[36mINFO[0m[0m 03/18 19:22:12 | 0.765634    0.754305    0.938705    0.769936    1.190759    0.949022    0.725773    0.915235    0.717068    0.951858    0.866967    0.765634    0.754305    1000        16.477858   0.181854    0.303174    115.475077 
[37m[36mINFO[0m[0m 03/18 19:25:11 | 0.779403    0.764638    0.967705    0.788438    1.088269    0.979403    0.740206    0.950458    0.747995    0.973255    0.877114    0.779403    0.764638    1200        19.773429   0.145721    0.302285    118.644535 
[37m[36mINFO[0m[0m 03/18 19:28:11 | 0.776822    0.774971    0.963460    0.781202    1.121865    0.975283    0.729897    0.940435    0.739977    0.974662    0.873732    0.776822    0.774971    1400        23.069001   0.119111    0.306920    119.118167 
[37m[36mINFO[0m[0m 03/18 19:31:07 | 0.757315    0.747417    0.961579    0.778095    1.187844    0.970134    0.731959    0.944444    0.733104    0.970158    0.869222    0.757315    0.747417    1600        26.364573   0.097973    0.298891    115.574993 
[37m[36mINFO[0m[0m 03/18 19:34:05 | 0.777682    0.766935    0.969114    0.787442    1.163176    0.977343    0.748454    0.955899    0.750286    0.974099    0.863585    0.777682    0.766935    1800        29.660144   0.094488    0.294398    119.813149 
[37m[36mINFO[0m[0m 03/18 19:36:57 | 0.765347    0.760046    0.976891    0.781889    1.184252    0.988157    0.731959    0.963631    0.739977    0.978885    0.873732    0.765347    0.760046    2000        32.955716   0.083552    0.274263    116.232252 
[37m[36mINFO[0m[0m 03/18 19:39:54 | 0.782846    0.761194    0.981631    0.791762    1.134352    0.990216    0.742268    0.966781    0.749141    0.987894    0.883878    0.782846    0.761194    2200        36.251287   0.062663    0.275819    121.774596 
[37m[36mINFO[0m[0m 03/18 19:42:49 | 0.777969    0.761194    0.984262    0.796250    1.164978    0.991246    0.734021    0.973081    0.767468    0.988457    0.887260    0.777969    0.761194    2400        39.546859   0.050583    0.286118    117.850985 
[37m[36mINFO[0m[0m 03/18 19:45:46 | 0.778830    0.778416    0.986743    0.796115    1.163035    0.990731    0.758763    0.977663    0.745704    0.991836    0.883878    0.778830    0.778416    2600        42.842430   0.058277    0.291835    119.110824 
[37m[36mINFO[0m[0m 03/18 19:48:34 | 0.760184    0.743972    0.981020    0.790358    1.181335    0.989186    0.717526    0.969359    0.764032    0.984516    0.889515    0.760184    0.743972    2800        46.138002   0.050910    0.270753    113.919763 
[37m[36mINFO[0m[0m 03/18 19:51:33 | 0.764200    0.763490    0.982377    0.789425    1.278491    0.988157    0.734021    0.971363    0.756014    0.987613    0.878241    0.764200    0.763490    3000        49.433574   0.047389    0.295238    119.735810 
[37m[36mINFO[0m[0m 03/18 19:54:31 | 0.779690    0.757750    0.986062    0.792138    1.183747    0.991246    0.731959    0.976231    0.759450    0.990709    0.885006    0.779690    0.757750    3200        52.729145   0.046589    0.298301    118.288611 
[37m[36mINFO[0m[0m 03/18 19:57:32 | 0.776248    0.776119    0.989489    0.796644    1.199057    0.996395    0.734021    0.979954    0.770905    0.992117    0.885006    0.776248    0.776119    3400        56.024717   0.040375    0.306249    119.818528 
[37m[36mINFO[0m[0m 03/18 20:00:39 | 0.783133    0.766935    0.986455    0.795410    1.231566    0.990731    0.736082    0.976518    0.762887    0.992117    0.887260    0.783133    0.766935    3600        59.320288   0.037369    0.322443    122.468940 
[37m[36mINFO[0m[0m 03/18 20:03:33 | 0.780551    0.773823    0.988602    0.806201    1.124482    0.994336    0.764948    0.977663    0.770905    0.993806    0.882751    0.780551    0.773823    3800        62.615860   0.038772    0.277737    118.103977 
[37m[36mINFO[0m[0m 03/18 20:06:22 | 0.781985    0.762342    0.990262    0.793959    1.251622    0.995881    0.734021    0.981100    0.760596    0.993806    0.887260    0.781985    0.762342    4000        65.911432   0.029751    0.266688    116.421906 
[37m[36mINFO[0m[0m 03/18 20:09:15 | 0.777395    0.776119    0.989152    0.788537    1.368596    0.995366    0.725773    0.981100    0.752577    0.990991    0.887260    0.777395    0.776119    4200        69.207003   0.031041    0.285034    115.907886 
[37m[36mINFO[0m[0m 03/18 20:12:12 | 0.779690    0.760046    0.988616    0.801113    1.260243    0.993821    0.756701    0.977377    0.754868    0.994651    0.891770    0.779690    0.760046    4400        72.502575   0.033371    0.301249    116.927046 
[37m[36mINFO[0m[0m 03/18 20:15:09 | 0.785427    0.770379    0.989292    0.799867    1.243538    0.996395    0.748454    0.978236    0.754868    0.993243    0.896280    0.785427    0.770379    4600        75.798146   0.030946    0.277890    121.367538 
[37m[36mINFO[0m[0m 03/18 20:18:11 | 0.775674    0.757750    0.986816    0.786811    1.380212    0.991246    0.742268    0.976804    0.736541    0.992399    0.881623    0.775674    0.757750    4800        79.093718   0.032233    0.316154    118.056495 
[37m[36mINFO[0m[0m 03/18 20:21:05 | 0.771371    0.762342    0.989543    0.800237    1.152208    0.992276    0.748454    0.983391    0.753723    0.992962    0.898534    0.771371    0.762342    5000        82.389289   0.033093    0.281158    117.704591 
[37m[36mINFO[0m[0m 03/18 20:21:05 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[3]/250318_19-05-27_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 20:21:06 | ---
[37m[36mINFO[0m[0m 03/18 20:21:06 | test-domain validation(oracle) = 77.883%
[37m[36mINFO[0m[0m 03/18 20:21:06 | training-domain validation(iid) = 78.055%
[37m[36mINFO[0m[0m 03/18 20:21:06 | last = 77.137%
[37m[36mINFO[0m[0m 03/18 20:21:06 | last (inD) = 80.024%
[37m[36mINFO[0m[0m 03/18 20:21:06 | training-domain validation (iid, inD) = 80.620%
[37m[36mINFO[0m[0m 03/18 20:21:06 | === Summary ===
[37m[36mINFO[0m[0m 03/18 20:21:06 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm ERM --test_envs 3 --dataset OfficeHome
[37m[36mINFO[0m[0m 03/18 20:21:06 | Unique name: 250318_19-05-27_resnet50_GENIE
[37m[36mINFO[0m[0m 03/18 20:21:06 | Out path: train_output/OfficeHome/ERM/[3]/250318_19-05-27_resnet50_GENIE
[37m[36mINFO[0m[0m 03/18 20:21:06 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 20:21:06 | Dataset: OfficeHome

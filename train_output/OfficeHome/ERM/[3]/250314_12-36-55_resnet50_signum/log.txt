[37m[36mINFO[0m[0m 03/14 12:36:55 | Command :: /jsm0707/GENIE/train_all.py resnet50_signum config/resnet50_signum.yaml --algorithm ERM --test_envs 3 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_signum.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_signum
	out_dir: train_output/OfficeHome/ERM/[3]/250314_12-36-55_resnet50_signum
	out_root: train_output/OfficeHome/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250314_12-36-55_resnet50_signum
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: signum
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/14 12:36:55 | n_steps = 5001
[37m[36mINFO[0m[0m 03/14 12:36:55 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/14 12:36:55 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/14 12:36:55 | 
[37m[36mINFO[0m[0m 03/14 12:36:55 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 03/14 12:36:55 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 03/14 12:36:55 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/14 12:36:55 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 03/14 12:36:55 | steps-per-epoch for each domain: 60.69, 109.12, 111.00 -> min = 60.69
[37m[36mINFO[0m[0m 03/14 12:36:56 | # of params = 23641217
[37m[36mINFO[0m[0m 03/14 12:38:51 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/14 12:38:51 | 0.020080    0.027555    0.016579    0.009033    4.203380    0.024202    0.012371    0.011741    0.004582    0.013795    0.010147    0.020080    0.027555    0           0.000000    4.305778    0.967768    114.293217 
[37m[36mINFO[0m[0m 03/14 12:41:30 | 0.720597    0.694604    0.794864    0.716217    1.104148    0.795057    0.678351    0.750573    0.654066    0.838964    0.816234    0.720597    0.694604    200         3.295572    1.489365    0.235654    111.276342 
[37m[36mINFO[0m[0m 03/14 12:44:08 | 0.745267    0.737084    0.871944    0.744400    1.030451    0.887230    0.709278    0.833333    0.694158    0.895270    0.829763    0.745267    0.737084    400         6.591143    0.632245    0.227219    112.668361 
[37m[36mINFO[0m[0m 03/14 12:46:47 | 0.723178    0.730195    0.875958    0.746574    1.314767    0.886715    0.713402    0.843356    0.703322    0.897804    0.822999    0.723178    0.730195    600         9.886715    0.442721    0.227977    113.958344 
[37m[36mINFO[0m[0m 03/14 12:49:27 | 0.736087    0.729047    0.921436    0.764182    1.197344    0.941813    0.719588    0.891753    0.729668    0.930743    0.843292    0.736087    0.729047    800         13.182286   0.379737    0.229313    114.013654 
[37m[36mINFO[0m[0m 03/14 12:52:06 | 0.742111    0.734788    0.929208    0.771429    0.997309    0.952626    0.727835    0.898625    0.727377    0.936374    0.859076    0.742111    0.734788    1000        16.477858   0.341816    0.226784    113.226516 
[37m[36mINFO[0m[0m 03/14 12:54:46 | 0.724326    0.715270    0.898985    0.738273    2.568972    0.920700    0.688660    0.854238    0.693013    0.922016    0.833145    0.724326    0.715270    1200        19.773429   0.342472    0.230310    113.820474 
[37m[36mINFO[0m[0m 03/14 12:57:24 | 0.701951    0.712974    0.902152    0.736595    1.608843    0.923275    0.694845    0.864261    0.696449    0.918919    0.818489    0.701951    0.712974    1400        23.069001   0.367195    0.229793    112.439270 
[37m[36mINFO[0m[0m 03/14 13:00:03 | 0.678715    0.699196    0.861400    0.695255    3.036937    0.868177    0.628866    0.821879    0.662085    0.894144    0.794814    0.678715    0.699196    1600        26.364573   0.414428    0.230920    113.122388 
[37m[36mINFO[0m[0m 03/14 13:02:45 | 0.710557    0.717566    0.902821    0.729187    1.967705    0.916066    0.678351    0.876575    0.690722    0.915822    0.818489    0.710557    0.717566    1800        29.660144   0.498075    0.239944    113.413431 
[37m[36mINFO[0m[0m 03/14 13:05:24 | 0.676133    0.655568    0.865642    0.682478    2.908006    0.885685    0.612371    0.822165    0.635739    0.889077    0.799324    0.676133    0.655568    2000        32.955716   0.609412    0.229490    113.670757 
[37m[36mINFO[0m[0m 03/14 13:08:01 | 0.698221    0.699196    0.872020    0.736211    3.855598    0.873841    0.661856    0.839347    0.713631    0.902872    0.833145    0.698221    0.699196    2200        36.251287   0.667147    0.224532    111.999134 
[37m[36mINFO[0m[0m 03/14 13:10:37 | 0.670970    0.660161    0.844240    0.695795    5.318386    0.843975    0.635052    0.806987    0.658648    0.881757    0.793687    0.670970    0.660161    2400        39.546859   0.884850    0.223704    110.955676 
[37m[36mINFO[0m[0m 03/14 13:13:15 | 0.615318    0.633754    0.766977    0.628017    2.441853    0.753347    0.579381    0.733677    0.588774    0.813908    0.715896    0.615318    0.633754    2600        42.842430   1.008671    0.227007    112.635831 
[37m[36mINFO[0m[0m 03/14 13:15:56 | 0.627367    0.637199    0.778776    0.637607    2.076993    0.786303    0.575258    0.728236    0.601375    0.821791    0.736189    0.627367    0.637199    2800        46.138002   1.126488    0.227132    115.159767 
[37m[36mINFO[0m[0m 03/14 13:18:34 | 0.626793    0.641791    0.795801    0.656604    1.717536    0.787333    0.618557    0.757446    0.611684    0.842624    0.739572    0.626793    0.641791    3000        49.433574   1.232056    0.231926    112.037539 
[37m[36mINFO[0m[0m 03/14 13:21:13 | 0.565691    0.590126    0.721608    0.578075    4.267060    0.703913    0.501031    0.685853    0.560137    0.775056    0.673055    0.565691    0.590126    3200        52.729145   1.376108    0.218447    115.452014 
[37m[36mINFO[0m[0m 03/14 13:23:52 | 0.463855    0.481056    0.522593    0.457464    4.819230    0.491246    0.435052    0.480813    0.387171    0.595721    0.550169    0.463855    0.481056    3400        56.024717   1.776253    0.224605    114.115753 
[37m[36mINFO[0m[0m 03/14 13:26:31 | 0.413368    0.442021    0.495101    0.436707    3.905191    0.492276    0.420619    0.437285    0.356243    0.555743    0.533258    0.413368    0.442021    3600        59.320288   2.315617    0.225295    113.663909 
[37m[36mINFO[0m[0m 03/14 13:29:11 | 0.359725    0.362801    0.405942    0.374646    4.062016    0.352214    0.309278    0.360825    0.328751    0.504786    0.485908    0.359725    0.362801    3800        62.615860   3.611203    0.221669    115.476526 
[37m[36mINFO[0m[0m 03/14 13:31:50 | 0.153758    0.165327    0.160590    0.157359    4.775745    0.160659    0.158763    0.143184    0.136312    0.177928    0.177001    0.153758    0.165327    4000        65.911432   4.721097    0.227976    113.744914 
[37m[36mINFO[0m[0m 03/14 13:34:29 | 0.115318    0.126292    0.118683    0.123826    6.407279    0.116375    0.119588    0.088774    0.101947    0.150901    0.149944    0.115318    0.126292    4200        69.207003   4.516313    0.226853    113.883204 
[37m[36mINFO[0m[0m 03/14 13:37:08 | 0.088640    0.107922    0.088929    0.086371    4.231393    0.061792    0.063918    0.085624    0.081329    0.119369    0.113867    0.088640    0.107922    4400        72.502575   4.316426    0.226182    113.518747 
[37m[36mINFO[0m[0m 03/14 13:39:49 | 0.144578    0.157290    0.143293    0.144610    3.717673    0.117920    0.098969    0.134593    0.144330    0.177365    0.190530    0.144578    0.157290    4600        75.798146   4.404982    0.226338    115.639160 
[37m[36mINFO[0m[0m 03/14 13:42:29 | 0.092083    0.101033    0.101986    0.111158    3.762121    0.075695    0.092784    0.098225    0.106529    0.132038    0.134160    0.092083    0.101033    4800        79.093718   4.309709    0.227551    114.452269 
[37m[36mINFO[0m[0m 03/14 13:45:11 | 0.072863    0.079219    0.065513    0.063461    4.077130    0.065911    0.070103    0.049828    0.049255    0.080800    0.071026    0.072863    0.079219    5000        82.389289   4.352873    0.229097    116.117792 
[37m[36mINFO[0m[0m 03/14 13:45:11 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[3]/250314_12-36-55_resnet50_signum/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/14 13:45:12 | ---
[37m[36mINFO[0m[0m 03/14 13:45:12 | test-domain validation(oracle) = 74.527%
[37m[36mINFO[0m[0m 03/14 13:45:12 | training-domain validation(iid) = 74.211%
[37m[36mINFO[0m[0m 03/14 13:45:12 | last = 7.286%
[37m[36mINFO[0m[0m 03/14 13:45:12 | last (inD) = 6.346%
[37m[36mINFO[0m[0m 03/14 13:45:12 | training-domain validation (iid, inD) = 77.143%
[37m[36mINFO[0m[0m 03/14 13:45:13 | === Summary ===
[37m[36mINFO[0m[0m 03/14 13:45:13 | Command: /jsm0707/GENIE/train_all.py resnet50_signum config/resnet50_signum.yaml --algorithm ERM --test_envs 3 --dataset OfficeHome
[37m[36mINFO[0m[0m 03/14 13:45:13 | Unique name: 250314_12-36-55_resnet50_signum
[37m[36mINFO[0m[0m 03/14 13:45:13 | Out path: train_output/OfficeHome/ERM/[3]/250314_12-36-55_resnet50_signum
[37m[36mINFO[0m[0m 03/14 13:45:13 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/14 13:45:13 | Dataset: OfficeHome

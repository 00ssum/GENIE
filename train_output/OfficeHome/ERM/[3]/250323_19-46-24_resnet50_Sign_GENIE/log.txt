[37m[36mINFO[0m[0m 03/23 19:46:24 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 4
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 4
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/OfficeHome/ERM/[3]/250323_19-46-24_resnet50_Sign_GENIE
	out_root: train_output/OfficeHome/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250323_19-46-24_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.0793009436922532e-05
	batch_size: 30
	weight_decay: 0.0007980067844361917
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/23 19:46:24 | n_steps = 5001
[37m[36mINFO[0m[0m 03/23 19:46:24 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/23 19:46:24 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/23 19:46:24 | 
[37m[36mINFO[0m[0m 03/23 19:46:24 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 03/23 19:46:24 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 03/23 19:46:24 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/23 19:46:24 | Batch sizes for each domain: [30, 30, 30, 0] (total=90)
[37m[36mINFO[0m[0m 03/23 19:46:24 | steps-per-epoch for each domain: 64.73, 116.40, 118.40 -> min = 64.73
[37m[36mINFO[0m[0m 03/23 19:46:25 | # of params = 23641217
[37m[36mINFO[0m[0m 03/23 19:48:29 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/23 19:48:29 | 0.020080    0.024110    0.015088    0.010554    4.220136    0.020597    0.012371    0.010309    0.008018    0.014358    0.011274    0.020080    0.024110    0           0.000000    4.318769    1.335720    123.058825 
[37m[36mINFO[0m[0m 03/23 19:51:34 | 0.712851    0.690011    0.729456    0.691951    1.163764    0.726571    0.680412    0.671821    0.625430    0.789977    0.770011    0.712851    0.690011    200         3.089598    2.372227    0.316079    121.323907 
[37m[36mINFO[0m[0m 03/23 19:54:35 | 0.774527    0.762342    0.845537    0.751130    0.935254    0.859938    0.721649    0.792383    0.689576    0.884291    0.842165    0.774527    0.762342    400         6.179197    0.846665    0.287782    123.911480 
[37m[36mINFO[0m[0m 03/23 19:57:29 | 0.769650    0.785304    0.880620    0.768300    0.876438    0.898558    0.731959    0.836770    0.728522    0.906532    0.844419    0.769650    0.785304    600         9.268795    0.577693    0.245523    124.124732 
[37m[36mINFO[0m[0m 03/23 20:00:33 | 0.760184    0.750861    0.909049    0.764840    0.953165    0.923275    0.721649    0.872566    0.723940    0.931306    0.848929    0.760184    0.750861    800         12.358393   0.449486    0.295816    125.402855 
[37m[36mINFO[0m[0m 03/23 20:03:41 | 0.773666    0.773823    0.934631    0.794162    0.942370    0.956746    0.762887    0.901203    0.756014    0.945946    0.863585    0.773666    0.773823    1000        15.447992   0.329580    0.316572    124.711241 
[37m[36mINFO[0m[0m 03/23 20:06:34 | 0.779403    0.792193    0.949981    0.801561    0.833783    0.968074    0.767010    0.923253    0.758305    0.958615    0.879369    0.779403    0.792193    1200        18.537590   0.258047    0.246249    123.017165 
[37m[36mINFO[0m[0m 03/23 20:09:30 | 0.775100    0.776119    0.950969    0.778776    0.988191    0.972194    0.744330    0.921535    0.721649    0.959178    0.870349    0.775100    0.776119    1400        21.627188   0.215514    0.261456    124.019920 
[37m[36mINFO[0m[0m 03/23 20:12:39 | 0.769937    0.778416    0.962175    0.795669    1.025036    0.979918    0.750515    0.937858    0.754868    0.968750    0.881623    0.769937    0.778416    1600        24.716787   0.183358    0.320250    124.698050 
[37m[36mINFO[0m[0m 03/23 20:15:39 | 0.774240    0.784156    0.963936    0.791511    1.053240    0.980947    0.750515    0.939576    0.750286    0.971284    0.873732    0.774240    0.784156    1800        27.806385   0.150383    0.298089    120.913485 
[37m[36mINFO[0m[0m 03/23 20:18:31 | 0.786288    0.783008    0.972120    0.785247    1.043957    0.987642    0.721649    0.946735    0.745704    0.981982    0.888388    0.786288    0.783008    2000        30.895984   0.137736    0.231179    125.192995 
[37m[36mINFO[0m[0m 03/23 20:21:31 | 0.773666    0.768083    0.971525    0.804314    1.011490    0.986097    0.762887    0.949313    0.757159    0.979167    0.892897    0.773666    0.768083    2200        33.985582   0.117750    0.292651    121.747820 
[37m[36mINFO[0m[0m 03/23 20:24:38 | 0.782559    0.795637    0.978572    0.797490    1.094353    0.988157    0.742268    0.962199    0.766323    0.985360    0.883878    0.782559    0.795637    2400        37.075180   0.116267    0.315080    124.230991 
[37m[36mINFO[0m[0m 03/23 20:27:35 | 0.782272    0.777268    0.975842    0.793953    1.105872    0.985067    0.744330    0.960195    0.749141    0.982264    0.888388    0.782272    0.777268    2600        40.164779   0.093986    0.270356    122.631118 
[37m[36mINFO[0m[0m 03/23 20:30:25 | 0.778830    0.778416    0.983249    0.805426    1.016064    0.992276    0.764948    0.965636    0.766323    0.991836    0.885006    0.778830    0.778416    2800        43.254377   0.084934    0.255208    119.254772 
[37m[36mINFO[0m[0m 03/23 20:33:32 | 0.767642    0.757750    0.980746    0.792204    1.100229    0.986612    0.742268    0.973081    0.761741    0.982545    0.872604    0.767642    0.757750    3000        46.343975   0.087707    0.321024    123.006129 
[37m[36mINFO[0m[0m 03/23 20:36:39 | 0.783133    0.777268    0.982707    0.798342    1.034093    0.991761    0.750515    0.966495    0.762887    0.989865    0.881623    0.783133    0.777268    3200        49.433574   0.096809    0.321384    122.302776 
[37m[36mINFO[0m[0m 03/23 20:39:31 | 0.792599    0.772675    0.987013    0.805126    1.081543    0.993821    0.762887    0.975945    0.768614    0.991273    0.883878    0.792599    0.772675    3400        52.523172   0.072516    0.258410    120.084101 
[37m[36mINFO[0m[0m 03/23 20:42:32 | 0.792312    0.776119    0.987545    0.813995    1.037448    0.994851    0.779381    0.976231    0.766323    0.991554    0.896280    0.792312    0.776119    3600        55.612770   0.060520    0.283811    124.941469 
[37m[36mINFO[0m[0m 03/23 20:45:43 | 0.775100    0.747417    0.985034    0.800886    0.998020    0.993821    0.744330    0.974513    0.781214    0.986768    0.877114    0.775100    0.747417    3800        58.702369   0.068716    0.328320    125.398474 
[37m[36mINFO[0m[0m 03/23 20:48:48 | 0.791165    0.785304    0.988568    0.816746    1.045862    0.995366    0.779381    0.977377    0.789233    0.992962    0.881623    0.791165    0.785304    4000        61.791967   0.054668    0.286617    127.078541 
[37m[36mINFO[0m[0m 03/23 20:51:35 | 0.772806    0.777268    0.986005    0.795709    1.027493    0.992791    0.727835    0.974513    0.770905    0.990709    0.888388    0.772806    0.777268    4200        64.881565   0.050413    0.234725    120.032542 
[37m[36mINFO[0m[0m 03/23 20:54:37 | 0.788583    0.776119    0.988849    0.813102    1.059896    0.992791    0.762887    0.979668    0.784651    0.994088    0.891770    0.788583    0.776119    4400        67.971164   0.047921    0.300204    121.735505 
[37m[36mINFO[0m[0m 03/23 20:57:45 | 0.763913    0.750861    0.987009    0.807441    1.163726    0.991246    0.773196    0.977663    0.769759    0.992117    0.879369    0.763913    0.750861    4600        71.060762   0.045420    0.319289    124.364131 
[37m[36mINFO[0m[0m 03/23 21:00:41 | 0.766495    0.745121    0.986888    0.798089    1.290487    0.994336    0.746392    0.973368    0.761741    0.992962    0.886133    0.766495    0.745121    4800        74.150360   0.048098    0.236833    129.201690 
[37m[36mINFO[0m[0m 03/23 21:03:39 | 0.784567    0.764638    0.987399    0.799170    1.206889    0.993821    0.748454    0.977950    0.765178    0.990428    0.883878    0.784567    0.764638    5000        77.239959   0.043382    0.288590    120.336334 
[37m[36mINFO[0m[0m 03/23 21:03:40 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[3]/250323_19-46-24_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/23 21:03:41 | ---
[37m[36mINFO[0m[0m 03/23 21:03:41 | test-domain validation(oracle) = 78.256%
[37m[36mINFO[0m[0m 03/23 21:03:41 | training-domain validation(iid) = 79.116%
[37m[36mINFO[0m[0m 03/23 21:03:41 | last = 78.457%
[37m[36mINFO[0m[0m 03/23 21:03:41 | last (inD) = 79.917%
[37m[36mINFO[0m[0m 03/23 21:03:41 | training-domain validation (iid, inD) = 81.675%
[37m[36mINFO[0m[0m 03/23 21:03:41 | === Summary ===
[37m[36mINFO[0m[0m 03/23 21:03:41 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 4
[37m[36mINFO[0m[0m 03/23 21:03:41 | Unique name: 250323_19-46-24_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/23 21:03:41 | Out path: train_output/OfficeHome/ERM/[3]/250323_19-46-24_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/23 21:03:41 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/23 21:03:41 | Dataset: OfficeHome

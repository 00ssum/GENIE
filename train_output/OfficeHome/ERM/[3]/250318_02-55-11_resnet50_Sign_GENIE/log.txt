[37m[36mINFO[0m[0m 03/18 02:55:11 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --trial_seed 0 --hparams_seed 20 --algorithm ERM --test_envs 3 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 20
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/OfficeHome/ERM/[3]/250318_02-55-11_resnet50_Sign_GENIE
	out_root: train_output/OfficeHome/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250318_02-55-11_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.6157673767852512e-05
	batch_size: 32
	weight_decay: 1.110622050999988e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/18 02:55:11 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 02:55:11 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 02:55:11 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 02:55:11 | 
[37m[36mINFO[0m[0m 03/18 02:55:11 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 03/18 02:55:11 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 03/18 02:55:11 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/18 02:55:11 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 03/18 02:55:11 | steps-per-epoch for each domain: 60.69, 109.12, 111.00 -> min = 60.69
[37m[36mINFO[0m[0m 03/18 02:55:12 | # of params = 23641217
[37m[36mINFO[0m[0m 03/18 02:57:07 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 02:57:07 | 0.020080    0.024110    0.015746    0.011553    4.214938    0.023687    0.016495    0.010882    0.008018    0.012669    0.010147    0.020080    0.024110    0           0.000000    4.414792    1.001250    114.193290 
[37m[36mINFO[0m[0m 03/18 02:59:57 | 0.726621    0.722158    0.736342    0.699224    1.092193    0.738414    0.701031    0.676976    0.630011    0.793637    0.766629    0.726621    0.722158    200         3.295572    2.396774    0.284172    113.249330 
[37m[36mINFO[0m[0m 03/18 03:02:45 | 0.752725    0.764638    0.838610    0.748536    0.956610    0.847065    0.731959    0.790951    0.686140    0.877815    0.827508    0.752725    0.764638    400         6.591143    0.824389    0.249190    118.602034 
[37m[36mINFO[0m[0m 03/18 03:05:28 | 0.776248    0.764638    0.894890    0.767559    0.910371    0.915551    0.719588    0.848511    0.728522    0.920608    0.854566    0.776248    0.764638    600         9.886715    0.558926    0.227713    116.956850 
[37m[36mINFO[0m[0m 03/18 03:08:12 | 0.780551    0.762342    0.924652    0.776823    0.935879    0.945932    0.748454    0.885739    0.731959    0.942286    0.850056    0.780551    0.762342    800         13.182286   0.408932    0.248988    114.071153 
[37m[36mINFO[0m[0m 03/18 03:11:08 | 0.769363    0.763490    0.930958    0.785906    0.941552    0.953141    0.746392    0.895475    0.731959    0.944257    0.879369    0.769363    0.763490    1000        16.477858   0.308435    0.287798    118.591971 
[37m[36mINFO[0m[0m 03/18 03:13:51 | 0.760184    0.757750    0.939882    0.781339    0.901979    0.958290    0.748454    0.908935    0.733104    0.952421    0.862458    0.760184    0.757750    1200        19.773429   0.254364    0.246130    114.123830 
[37m[36mINFO[0m[0m 03/18 03:16:31 | 0.788870    0.773823    0.956673    0.791734    0.928705    0.976313    0.754639    0.924112    0.745704    0.969595    0.874859    0.788870    0.773823    1400        23.069001   0.203015    0.226153    114.768264 
[37m[36mINFO[0m[0m 03/18 03:19:18 | 0.796328    0.779564    0.969873    0.805154    0.899820    0.989186    0.760825    0.939576    0.761741    0.980856    0.892897    0.796328    0.779564    1600        26.364573   0.155671    0.262925    114.450290 
[37m[36mINFO[0m[0m 03/18 03:22:12 | 0.787435    0.780712    0.969295    0.799399    0.980385    0.981977    0.752577    0.947022    0.761741    0.978885    0.883878    0.787435    0.780712    1800        29.660144   0.135281    0.281098    117.259314 
[37m[36mINFO[0m[0m 03/18 03:24:55 | 0.779977    0.756602    0.970682    0.790464    1.122676    0.986097    0.756701    0.949599    0.730813    0.976351    0.883878    0.779977    0.756602    2000        32.955716   0.138068    0.239738    114.943753 
[37m[36mINFO[0m[0m 03/18 03:27:39 | 0.773379    0.765786    0.977403    0.796961    1.015305    0.991761    0.756701    0.957904    0.751432    0.982545    0.882751    0.773379    0.765786    2200        36.251287   0.125061    0.234480    116.969950 
[37m[36mINFO[0m[0m 03/18 03:30:27 | 0.777395    0.758898    0.982272    0.799634    1.076317    0.993306    0.767010    0.964490    0.749141    0.989020    0.882751    0.777395    0.758898    2400        39.546859   0.089678    0.272782    114.221823 
[37m[36mINFO[0m[0m 03/18 03:33:16 | 0.788009    0.773823    0.983287    0.803076    1.050651    0.988671    0.756701    0.969072    0.770905    0.992117    0.881623    0.788009    0.773823    2600        42.842430   0.095917    0.262953    116.486622 
[37m[36mINFO[0m[0m 03/18 03:36:03 | 0.781411    0.771527    0.982001    0.809531    1.020799    0.990731    0.767010    0.968786    0.773196    0.986486    0.888388    0.781411    0.771527    2800        46.138002   0.079809    0.245761    117.385738 
[37m[36mINFO[0m[0m 03/18 03:38:45 | 0.787149    0.779564    0.983265    0.817339    1.139002    0.989701    0.783505    0.970790    0.783505    0.989302    0.885006    0.787149    0.779564    3000        49.433574   0.073179    0.233859    114.779717 
[37m[36mINFO[0m[0m 03/18 03:41:34 | 0.785427    0.766935    0.985210    0.798706    1.085888    0.991246    0.750515    0.974800    0.760596    0.989583    0.885006    0.785427    0.766935    3200        52.729145   0.066203    0.280528    113.480255 
[37m[36mINFO[0m[0m 03/18 03:44:20 | 0.786862    0.770379    0.983254    0.799099    1.089354    0.992791    0.750515    0.969359    0.764032    0.987613    0.882751    0.786862    0.770379    3400        56.024717   0.067437    0.249473    116.489947 
[37m[36mINFO[0m[0m 03/18 03:47:03 | 0.764200    0.756602    0.985239    0.799845    1.082566    0.992791    0.750515    0.971936    0.762887    0.990991    0.886133    0.764200    0.756602    3600        59.320288   0.059025    0.239149    114.950521 
[37m[36mINFO[0m[0m 03/18 03:49:48 | 0.781698    0.776119    0.988664    0.815763    1.107815    0.992791    0.783505    0.980241    0.769759    0.992962    0.894025    0.781698    0.776119    3800        62.615860   0.054125    0.250122    114.260681 
[37m[36mINFO[0m[0m 03/18 03:52:40 | 0.775674    0.768083    0.989179    0.811016    1.022155    0.994336    0.767010    0.980241    0.769759    0.992962    0.896280    0.775674    0.768083    4000        65.911432   0.056649    0.282468    116.228098 
[37m[36mINFO[0m[0m 03/18 03:55:25 | 0.781698    0.768083    0.988895    0.796985    1.206523    0.994336    0.746392    0.979668    0.766323    0.992680    0.878241    0.781698    0.768083    4200        69.207003   0.047413    0.241673    116.646371 
[37m[36mINFO[0m[0m 03/18 03:58:07 | 0.786288    0.763490    0.988558    0.811047    1.164117    0.995881    0.767010    0.978522    0.775487    0.991273    0.890643    0.786288    0.763490    4400        72.502575   0.054947    0.228746    115.523373 
[37m[36mINFO[0m[0m 03/18 04:00:58 | 0.788583    0.772675    0.988236    0.805631    1.162196    0.993821    0.769072    0.976518    0.758305    0.994369    0.889515    0.788583    0.772675    4600        75.798146   0.047949    0.264409    118.057791 
[37m[36mINFO[0m[0m 03/18 04:03:50 | 0.779977    0.764638    0.988796    0.811798    1.165498    0.994336    0.777320    0.978809    0.765178    0.993243    0.892897    0.779977    0.764638    4800        79.093718   0.045705    0.278854    116.511688 
[37m[36mINFO[0m[0m 03/18 04:06:32 | 0.790017    0.780712    0.990911    0.811969    1.075193    0.996395    0.762887    0.982532    0.783505    0.993806    0.889515    0.790017    0.780712    5000        82.389289   0.037270    0.239765    113.941722 
[37m[36mINFO[0m[0m 03/18 04:06:32 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[3]/250318_02-55-11_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 04:06:33 | ---
[37m[36mINFO[0m[0m 03/18 04:06:33 | test-domain validation(oracle) = 78.744%
[37m[36mINFO[0m[0m 03/18 04:06:33 | training-domain validation(iid) = 78.715%
[37m[36mINFO[0m[0m 03/18 04:06:33 | last = 79.002%
[37m[36mINFO[0m[0m 03/18 04:06:33 | last (inD) = 81.197%
[37m[36mINFO[0m[0m 03/18 04:06:33 | training-domain validation (iid, inD) = 81.734%
[37m[36mINFO[0m[0m 03/18 04:06:33 | === Summary ===
[37m[36mINFO[0m[0m 03/18 04:06:33 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --trial_seed 0 --hparams_seed 20 --algorithm ERM --test_envs 3 --dataset OfficeHome
[37m[36mINFO[0m[0m 03/18 04:06:33 | Unique name: 250318_02-55-11_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 04:06:33 | Out path: train_output/OfficeHome/ERM/[3]/250318_02-55-11_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 04:06:33 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 04:06:33 | Dataset: OfficeHome

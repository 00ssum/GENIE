[37m[36mINFO[0m[0m 03/04 15:33:11 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_sgd config/clip_vitb16_sgd.yaml --algorithm ERM --test_envs 3 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_sgd
	out_dir: train_output/OfficeHome/ERM/[3]/250304_15-33-11_clip_vitb16_sgd
	out_root: train_output/OfficeHome/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250304_15-33-11_clip_vitb16_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: clip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/04 15:33:11 | n_steps = 5001
[37m[36mINFO[0m[0m 03/04 15:33:11 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/04 15:33:11 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/04 15:33:11 | 
[37m[36mINFO[0m[0m 03/04 15:33:11 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 03/04 15:33:11 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 03/04 15:33:11 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/04 15:33:11 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 03/04 15:33:11 | steps-per-epoch for each domain: 60.69, 109.12, 111.00 -> min = 60.69
[37m[36mINFO[0m[0m 03/04 15:33:14 | # of params = 86225985
[37m[36mINFO[0m[0m 03/04 15:35:08 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/04 15:35:08 | 0.018933    0.019518    0.017688    0.021075    4.211358    0.013903    0.026804    0.018328    0.021764    0.020833    0.014656    0.018933    0.019518    0           0.000000    4.166363    1.119991    113.255681 
[37m[36mINFO[0m[0m 03/04 15:38:21 | 0.024383    0.026406    0.026945    0.026266    4.174720    0.022142    0.028866    0.024628    0.020619    0.034065    0.029312    0.024383    0.026406    200         3.295572    4.194620    0.409278    110.787659 
[37m[36mINFO[0m[0m 03/04 15:41:34 | 0.036431    0.030999    0.043582    0.038792    4.141764    0.043254    0.026804    0.029496    0.032073    0.057995    0.057497    0.036431    0.030999    400         6.591143    4.157110    0.409970    111.573348 
[37m[36mINFO[0m[0m 03/04 15:44:48 | 0.054791    0.048220    0.054696    0.052153    4.118529    0.049949    0.045361    0.040378    0.038946    0.073761    0.072153    0.054791    0.048220    600         9.886715    4.125940    0.409883    112.006722 
[37m[36mINFO[0m[0m 03/04 15:48:00 | 0.077453    0.063146    0.083150    0.077032    4.074079    0.086509    0.070103    0.062715    0.057274    0.100225    0.103720    0.077453    0.063146    800         13.182286   4.091068    0.411106    109.373960 
[37m[36mINFO[0m[0m 03/04 15:51:16 | 0.102697    0.090700    0.106688    0.104003    4.044781    0.106591    0.111340    0.087629    0.071019    0.125845    0.129651    0.102697    0.090700    1000        16.477858   4.055642    0.412752    113.134963 
[37m[36mINFO[0m[0m 03/04 15:54:32 | 0.128227    0.119403    0.127489    0.133506    4.010342    0.132338    0.136082    0.107675    0.111111    0.142455    0.153326    0.128227    0.119403    1200        19.773429   4.018373    0.411854    114.051787 
[37m[36mINFO[0m[0m 03/04 15:57:48 | 0.153184    0.146958    0.166251    0.155871    3.971083    0.174562    0.156701    0.142039    0.127148    0.182151    0.183766    0.153184    0.146958    1400        23.069001   3.985092    0.406991    114.572807 
[37m[36mINFO[0m[0m 03/04 16:01:02 | 0.183305    0.171068    0.198540    0.187348    3.932110    0.198249    0.189691    0.174399    0.162658    0.222973    0.209696    0.183305    0.171068    1600        26.364573   3.941431    0.405971    112.992193 
[37m[36mINFO[0m[0m 03/04 16:04:14 | 0.216581    0.196326    0.234844    0.222510    3.891874    0.234295    0.212371    0.204754    0.194731    0.265484    0.260428    0.216581    0.196326    1800        29.660144   3.898426    0.403770    111.037936 
[37m[36mINFO[0m[0m 03/04 16:07:34 | 0.252725    0.235362    0.275993    0.267411    3.849418    0.262616    0.249485    0.252864    0.234822    0.312500    0.317926    0.252725    0.235362    2000        32.955716   3.854657    0.417629    116.161505 
[37m[36mINFO[0m[0m 03/04 16:10:49 | 0.286288    0.264064    0.312103    0.304749    3.803543    0.298146    0.288660    0.279210    0.278351    0.358953    0.347238    0.286288    0.264064    2200        36.251287   3.814277    0.414144    112.231329 
[37m[36mINFO[0m[0m 03/04 16:14:01 | 0.324441    0.318025    0.347590    0.330533    3.755851    0.347580    0.309278    0.305269    0.301260    0.389921    0.381060    0.324441    0.318025    2400        39.546859   3.762604    0.410262    110.499598 
[37m[36mINFO[0m[0m 03/04 16:17:15 | 0.359151    0.358209    0.379851    0.358631    3.705002    0.378476    0.340206    0.339061    0.325315    0.422016    0.410372    0.359151    0.358209    2600        42.842430   3.703902    0.406896    112.081028 
[37m[36mINFO[0m[0m 03/04 16:20:32 | 0.382960    0.393800    0.411256    0.390148    3.649568    0.417096    0.381443    0.363688    0.345934    0.452984    0.443067    0.382960    0.393800    2800        46.138002   3.647773    0.408890    114.958929 
[37m[36mINFO[0m[0m 03/04 16:23:45 | 0.409065    0.409874    0.436776    0.413853    3.592176    0.444902    0.418557    0.383162    0.357388    0.482264    0.465614    0.409065    0.409874    3000        49.433574   3.593402    0.410283    111.133059 
[37m[36mINFO[0m[0m 03/04 16:27:03 | 0.443775    0.450057    0.461725    0.439908    3.533148    0.462925    0.443299    0.413803    0.384880    0.508446    0.491545    0.443775    0.450057    3200        52.729145   3.539150    0.409155    115.946763 
[37m[36mINFO[0m[0m 03/04 16:30:21 | 0.474469    0.476464    0.491580    0.465233    3.470456    0.496395    0.455670    0.434708    0.414662    0.543637    0.525366    0.474469    0.476464    3400        56.024717   3.461396    0.407937    116.502767 
[37m[36mINFO[0m[0m 03/04 16:33:34 | 0.500861    0.501722    0.524268    0.491105    3.405994    0.522657    0.484536    0.468786    0.431844    0.581363    0.556933    0.500861    0.501722    3600        59.320288   3.409435    0.408696    111.586565 
[37m[36mINFO[0m[0m 03/04 16:36:46 | 0.531555    0.530425    0.553528    0.516448    3.341479    0.553038    0.507216    0.500000    0.454754    0.607545    0.587373    0.531555    0.530425    3800        62.615860   3.341888    0.409505    109.942719 
[37m[36mINFO[0m[0m 03/04 16:39:57 | 0.557659    0.548794    0.576391    0.540893    3.273262    0.564882    0.523711    0.526060    0.484536    0.638232    0.614431    0.557659    0.548794    4000        65.911432   3.263296    0.408113    109.661017 
[37m[36mINFO[0m[0m 03/04 16:43:08 | 0.578600    0.570608    0.596652    0.554542    3.203815    0.586509    0.534021    0.544101    0.497136    0.659347    0.632469    0.578600    0.570608    4200        69.207003   3.191964    0.406171    109.813175 
[37m[36mINFO[0m[0m 03/04 16:46:20 | 0.604131    0.594719    0.616789    0.579656    3.132904    0.598867    0.552577    0.572165    0.523482    0.679336    0.662909    0.604131    0.594719    4400        72.502575   3.119087    0.407382    110.521342 
[37m[36mINFO[0m[0m 03/04 16:49:33 | 0.624498    0.618829    0.637009    0.599738    3.063216    0.624614    0.575258    0.589061    0.546392    0.697354    0.677565    0.624498    0.618829    4600        75.798146   3.046591    0.405945    111.761034 
[37m[36mINFO[0m[0m 03/04 16:52:46 | 0.643431    0.640643    0.653220    0.617059    2.991391    0.648816    0.600000    0.601947    0.556701    0.708896    0.694476    0.643431    0.640643    4800        79.093718   2.971051    0.407393    111.665421 
[37m[36mINFO[0m[0m 03/04 16:55:57 | 0.656913    0.656716    0.661920    0.627115    2.925201    0.657570    0.616495    0.612257    0.565865    0.715935    0.698985    0.656913    0.656716    5000        82.389289   2.898223    0.405745    109.503557 
[37m[36mINFO[0m[0m 03/04 16:55:57 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[3]/250304_15-33-11_clip_vitb16_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/04 16:56:01 | ---
[37m[36mINFO[0m[0m 03/04 16:56:01 | test-domain validation(oracle) = 65.691%
[37m[36mINFO[0m[0m 03/04 16:56:01 | training-domain validation(iid) = 65.691%
[37m[36mINFO[0m[0m 03/04 16:56:01 | last = 65.691%
[37m[36mINFO[0m[0m 03/04 16:56:01 | last (inD) = 62.712%
[37m[36mINFO[0m[0m 03/04 16:56:01 | training-domain validation (iid, inD) = 62.712%
[37m[36mINFO[0m[0m 03/04 16:56:01 | === Summary ===
[37m[36mINFO[0m[0m 03/04 16:56:01 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_sgd config/clip_vitb16_sgd.yaml --algorithm ERM --test_envs 3 --dataset OfficeHome
[37m[36mINFO[0m[0m 03/04 16:56:01 | Unique name: 250304_15-33-11_clip_vitb16_sgd
[37m[36mINFO[0m[0m 03/04 16:56:01 | Out path: train_output/OfficeHome/ERM/[3]/250304_15-33-11_clip_vitb16_sgd
[37m[36mINFO[0m[0m 03/04 16:56:01 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/04 16:56:01 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 03/04 15:45:58 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 3 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/OfficeHome/ERM/[3]/250304_15-45-58_clip_vitb16_GENIE
	out_root: train_output/OfficeHome/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250304_15-45-58_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: clip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/04 15:45:58 | n_steps = 5001
[37m[36mINFO[0m[0m 03/04 15:45:58 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/04 15:45:58 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/04 15:45:58 | 
[37m[36mINFO[0m[0m 03/04 15:45:58 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 03/04 15:45:58 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 03/04 15:45:58 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/04 15:45:58 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 03/04 15:45:58 | steps-per-epoch for each domain: 60.69, 109.12, 111.00 -> min = 60.69
[37m[36mINFO[0m[0m 03/04 15:46:00 | # of params = 86225985
[37m[36mINFO[0m[0m 03/04 15:47:54 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/04 15:47:54 | 0.018933    0.019518    0.017704    0.013850    4.209004    0.024202    0.026804    0.011455    0.005727    0.017455    0.009019    0.018933    0.019518    0           0.000000    4.166363    1.151721    113.013620 
[37m[36mINFO[0m[0m 03/04 15:51:14 | 0.071142    0.074627    0.068851    0.078180    3.893507    0.065396    0.082474    0.056415    0.063001    0.084741    0.089064    0.071142    0.074627    200         3.295572    4.032461    0.428634    114.453699 
[37m[36mINFO[0m[0m 03/04 15:54:36 | 0.213712    0.221584    0.229139    0.197724    3.188582    0.195675    0.173196    0.194444    0.179840    0.297297    0.240135    0.213712    0.221584    400         6.591143    3.522729    0.430619    114.979764 
[37m[36mINFO[0m[0m 03/04 15:57:55 | 0.456971    0.462687    0.510956    0.450279    2.160301    0.487127    0.432990    0.441294    0.366552    0.604448    0.551297    0.456971    0.462687    600         9.886715    2.480052    0.429194    113.094126 
[37m[36mINFO[0m[0m 03/04 16:01:14 | 0.583764    0.590126    0.703009    0.587339    1.622879    0.706488    0.523711    0.630298    0.526919    0.772241    0.711387    0.583764    0.590126    800         13.182286   1.500599    0.428534    113.327548 
[37m[36mINFO[0m[0m 03/04 16:04:33 | 0.589501    0.594719    0.772489    0.624304    1.446625    0.795057    0.569072    0.693299    0.536082    0.829110    0.767756    0.589501    0.594719    1000        16.477858   0.971855    0.428622    113.642094 
[37m[36mINFO[0m[0m 03/04 16:07:52 | 0.645439    0.661309    0.846680    0.670945    1.322547    0.865602    0.622680    0.776632    0.576174    0.897804    0.813980    0.645439    0.661309    1200        19.773429   0.673798    0.433658    112.722992 
[37m[36mINFO[0m[0m 03/04 16:11:11 | 0.629662    0.630310    0.875346    0.664910    1.322635    0.894439    0.583505    0.827320    0.625430    0.904279    0.785795    0.629662    0.630310    1400        23.069001   0.499031    0.428862    112.489108 
[37m[36mINFO[0m[0m 03/04 16:14:29 | 0.649168    0.679679    0.920729    0.692749    1.228169    0.941298    0.610309    0.880011    0.647194    0.940878    0.820744    0.649168    0.679679    1600        26.364573   0.368221    0.429622    112.119319 
[37m[36mINFO[0m[0m 03/04 16:17:47 | 0.655766    0.664753    0.936159    0.712132    1.213735    0.963440    0.630928    0.892898    0.667812    0.952140    0.837655    0.655766    0.664753    1800        29.660144   0.246352    0.429163    112.285389 
[37m[36mINFO[0m[0m 03/04 16:21:08 | 0.651176    0.662457    0.940389    0.703237    1.248873    0.958805    0.622680    0.901775    0.642612    0.960586    0.844419    0.651176    0.662457    2000        32.955716   0.220228    0.429817    115.542001 
[37m[36mINFO[0m[0m 03/04 16:24:27 | 0.625359    0.622273    0.944254    0.689853    1.317373    0.969104    0.606186    0.911798    0.643757    0.951858    0.819617    0.625359    0.622273    2200        36.251287   0.191415    0.430681    112.783649 
[37m[36mINFO[0m[0m 03/04 16:27:45 | 0.654905    0.652124    0.963467    0.714804    1.205947    0.975283    0.641237    0.941581    0.665521    0.973536    0.837655    0.654905    0.652124    2400        39.546859   0.169596    0.427879    112.388980 
[37m[36mINFO[0m[0m 03/04 16:31:08 | 0.664085    0.670494    0.966154    0.710486    1.278643    0.974768    0.612371    0.949313    0.673540    0.974381    0.845547    0.664085    0.670494    2600        42.842430   0.128196    0.429026    117.161940 
[37m[36mINFO[0m[0m 03/04 16:34:25 | 0.647160    0.654420    0.966999    0.711304    1.280659    0.975283    0.612371    0.952176    0.686140    0.973536    0.835400    0.647160    0.654420    2800        46.138002   0.114136    0.428624    111.384626 
[37m[36mINFO[0m[0m 03/04 16:37:44 | 0.662077    0.675086    0.968560    0.727103    1.223372    0.968074    0.647423    0.956186    0.682703    0.981419    0.851184    0.662077    0.675086    3000        49.433574   0.111613    0.429330    112.813198 
[37m[36mINFO[0m[0m 03/04 16:41:02 | 0.664659    0.663605    0.978097    0.748606    1.170506    0.983522    0.672165    0.968786    0.702176    0.981982    0.871477    0.664659    0.663605    3200        52.729145   0.091280    0.430114    111.643498 
[37m[36mINFO[0m[0m 03/04 16:44:18 | 0.683878    0.692308    0.982722    0.757036    1.118039    0.986612    0.682474    0.973940    0.722795    0.987613    0.865840    0.683878    0.692308    3400        56.024717   0.068329    0.430129    110.325932 
[37m[36mINFO[0m[0m 03/04 16:47:37 | 0.675559    0.714122    0.982673    0.729129    1.233273    0.990216    0.653608    0.968499    0.675830    0.989302    0.857948    0.675559    0.714122    3600        59.320288   0.066402    0.429645    112.687800 
[37m[36mINFO[0m[0m 03/04 16:50:57 | 0.677854    0.676234    0.986232    0.746116    1.186408    0.991761    0.657732    0.975945    0.714777    0.990991    0.865840    0.677854    0.676234    3800        62.615860   0.050342    0.431207    114.281942 
[37m[36mINFO[0m[0m 03/04 16:54:15 | 0.697074    0.691160    0.986528    0.751731    1.168601    0.989186    0.680412    0.980813    0.702176    0.989583    0.872604    0.697074    0.691160    4000        65.911432   0.054942    0.431508    111.815659 
[37m[36mINFO[0m[0m 03/04 16:57:34 | 0.683592    0.701493    0.985418    0.755971    1.165956    0.990731    0.678351    0.975659    0.710195    0.989865    0.879369    0.683592    0.701493    4200        69.207003   0.047124    0.430799    113.040563 
[37m[36mINFO[0m[0m 03/04 17:00:52 | 0.676420    0.685419    0.982568    0.735355    1.281633    0.988157    0.649485    0.971936    0.691867    0.987613    0.864713    0.676420    0.685419    4400        72.502575   0.041103    0.431417    111.063632 
[37m[36mINFO[0m[0m 03/04 17:04:10 | 0.685600    0.701493    0.988321    0.756255    1.203534    0.991761    0.682474    0.980241    0.717068    0.992962    0.869222    0.685600    0.701493    4600        75.798146   0.047596    0.429966    112.114493 
[37m[36mINFO[0m[0m 03/04 17:07:27 | 0.674986    0.680827    0.982928    0.740630    1.259056    0.988157    0.672165    0.969072    0.686140    0.991554    0.863585    0.674986    0.680827    4800        79.093718   0.060238    0.428098    111.556504 
[37m[36mINFO[0m[0m 03/04 17:10:43 | 0.670970    0.678530    0.985818    0.734298    1.259289    0.990216    0.657732    0.977090    0.682703    0.990146    0.862458    0.670970    0.678530    5000        82.389289   0.043548    0.428369    110.619325 
[37m[36mINFO[0m[0m 03/04 17:10:44 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[3]/250304_15-45-58_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/04 17:10:46 | ---
[37m[36mINFO[0m[0m 03/04 17:10:46 | test-domain validation(oracle) = 67.556%
[37m[36mINFO[0m[0m 03/04 17:10:46 | training-domain validation(iid) = 68.388%
[37m[36mINFO[0m[0m 03/04 17:10:46 | last = 67.097%
[37m[36mINFO[0m[0m 03/04 17:10:46 | last (inD) = 73.430%
[37m[36mINFO[0m[0m 03/04 17:10:46 | training-domain validation (iid, inD) = 75.704%
[37m[36mINFO[0m[0m 03/04 17:10:46 | === Summary ===
[37m[36mINFO[0m[0m 03/04 17:10:46 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 3 --dataset OfficeHome
[37m[36mINFO[0m[0m 03/04 17:10:46 | Unique name: 250304_15-45-58_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/04 17:10:46 | Out path: train_output/OfficeHome/ERM/[3]/250304_15-45-58_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/04 17:10:46 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/04 17:10:46 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 03/18 01:22:05 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/OfficeHome/ERM/[3]/250318_01-22-05_resnet50_Sign_GENIE
	out_root: train_output/OfficeHome/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250318_01-22-05_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/18 01:22:05 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 01:22:05 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 01:22:05 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 01:22:05 | 
[37m[36mINFO[0m[0m 03/18 01:22:05 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 03/18 01:22:05 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 03/18 01:22:05 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/18 01:22:05 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 03/18 01:22:05 | steps-per-epoch for each domain: 60.69, 109.12, 111.00 -> min = 60.69
[37m[36mINFO[0m[0m 03/18 01:22:06 | # of params = 23641217
[37m[36mINFO[0m[0m 03/18 01:24:04 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 01:24:04 | 0.019220    0.022962    0.014977    0.012687    4.223408    0.021112    0.016495    0.010023    0.009164    0.013795    0.012401    0.019220    0.022962    0           0.000000    4.305778    1.131398    116.271083 
[37m[36mINFO[0m[0m 03/18 01:26:55 | 0.738669    0.732491    0.791973    0.716474    1.049461    0.798146    0.707216    0.737400    0.659794    0.840372    0.782413    0.738669    0.732491    200         3.295572    1.634199    0.267182    118.309880 
[37m[36mINFO[0m[0m 03/18 01:29:44 | 0.767355    0.753157    0.875379    0.770619    0.942528    0.885685    0.740206    0.834765    0.718213    0.905687    0.853439    0.767355    0.753157    400         6.591143    0.532744    0.256418    117.408630 
[37m[36mINFO[0m[0m 03/18 01:32:34 | 0.773953    0.754305    0.916786    0.768921    0.972287    0.940783    0.734021    0.876861    0.715922    0.932714    0.856821    0.773953    0.754305    600         9.886715    0.361703    0.269658    115.757251 
[37m[36mINFO[0m[0m 03/18 01:35:22 | 0.756454    0.752009    0.937850    0.778947    0.983782    0.959835    0.740206    0.906644    0.729668    0.947072    0.866967    0.756454    0.752009    800         13.182286   0.255488    0.264130    115.126932 
[37m[36mINFO[0m[0m 03/18 01:38:08 | 0.764200    0.758898    0.948693    0.778816    1.038878    0.964470    0.742268    0.924685    0.717068    0.956926    0.877114    0.764200    0.758898    1000        16.477858   0.179409    0.247399    117.088234 
[37m[36mINFO[0m[0m 03/18 01:41:24 | 0.762478    0.758898    0.960301    0.783762    1.160126    0.979403    0.731959    0.935567    0.738832    0.965935    0.880496    0.762478    0.758898    1200        19.773429   0.145520    0.387348    118.158448 
[37m[36mINFO[0m[0m 03/18 01:44:27 | 0.767068    0.755454    0.954793    0.785390    1.031605    0.970649    0.750515    0.925544    0.729668    0.968187    0.875986    0.767068    0.755454    1400        23.069001   0.126068    0.327255    117.647014 
[37m[36mINFO[0m[0m 03/18 01:47:13 | 0.774814    0.770379    0.969636    0.784255    1.138980    0.980433    0.738144    0.949026    0.726231    0.979448    0.888388    0.774814    0.770379    1600        26.364573   0.099253    0.259226    114.291243 
[37m[36mINFO[0m[0m 03/18 01:49:55 | 0.770797    0.750861    0.969183    0.789737    1.193471    0.977343    0.746392    0.951604    0.745704    0.978604    0.877114    0.770797    0.750861    1800        29.660144   0.086541    0.232223    115.347255 
[37m[36mINFO[0m[0m 03/18 01:52:35 | 0.783419    0.773823    0.981704    0.797249    1.118797    0.991246    0.748454    0.968786    0.757159    0.985079    0.886133    0.783419    0.773823    2000        32.955716   0.077488    0.233051    113.319504 
[37m[36mINFO[0m[0m 03/18 01:55:14 | 0.782559    0.768083    0.981192    0.791421    1.141115    0.989186    0.729897    0.966495    0.753723    0.987894    0.890643    0.782559    0.768083    2200        36.251287   0.062802    0.223510    114.469288 
[37m[36mINFO[0m[0m 03/18 01:57:57 | 0.774814    0.769231    0.982425    0.789654    1.186815    0.992276    0.738144    0.969359    0.752577    0.985642    0.878241    0.774814    0.769231    2400        39.546859   0.054375    0.233552    116.235838 
[37m[36mINFO[0m[0m 03/18 02:00:50 | 0.784280    0.777268    0.984866    0.798882    1.094309    0.990216    0.756701    0.974800    0.759450    0.989583    0.880496    0.784280    0.777268    2600        42.842430   0.054998    0.287914    115.233307 
[37m[36mINFO[0m[0m 03/18 02:03:59 | 0.772232    0.753157    0.983436    0.796551    1.173592    0.990731    0.748454    0.973654    0.767468    0.985923    0.873732    0.772232    0.753157    2800        46.138002   0.050477    0.370300    115.038048 
[37m[36mINFO[0m[0m 03/18 02:07:17 | 0.760757    0.761194    0.978411    0.787886    1.205119    0.985067    0.734021    0.966495    0.749141    0.983671    0.880496    0.760757    0.761194    3000        49.433574   0.047132    0.414774    115.467247 
[37m[36mINFO[0m[0m 03/18 02:10:22 | 0.777969    0.756602    0.985900    0.799763    1.128317    0.990731    0.742268    0.977950    0.769759    0.989020    0.887260    0.777969    0.756602    3200        52.729145   0.048100    0.334233    117.850310 
[37m[36mINFO[0m[0m 03/18 02:13:14 | 0.777108    0.753157    0.986342    0.797524    1.276675    0.989186    0.740206    0.981100    0.760596    0.988739    0.891770    0.777108    0.753157    3400        56.024717   0.039058    0.281175    115.691961 
[37m[36mINFO[0m[0m 03/18 02:15:58 | 0.772519    0.761194    0.983141    0.791069    1.169168    0.988157    0.729897    0.973654    0.758305    0.987613    0.885006    0.772519    0.761194    3600        59.320288   0.048424    0.233835    117.463373 
[37m[36mINFO[0m[0m 03/18 02:18:42 | 0.786575    0.771527    0.990541    0.804730    1.183385    0.993306    0.750515    0.983104    0.762887    0.995214    0.900789    0.786575    0.771527    3800        62.615860   0.036684    0.242484    115.249941 
[37m[36mINFO[0m[0m 03/18 02:21:25 | 0.777682    0.760046    0.988577    0.793336    1.314007    0.992791    0.740206    0.981386    0.750286    0.991554    0.889515    0.777682    0.760046    4000        65.911432   0.034627    0.236494    115.478283 
[37m[36mINFO[0m[0m 03/18 02:24:08 | 0.777969    0.770379    0.989791    0.789807    1.326851    0.995881    0.734021    0.980813    0.757159    0.992680    0.878241    0.777969    0.770379    4200        69.207003   0.028399    0.234806    115.937045 
[37m[36mINFO[0m[0m 03/18 02:26:51 | 0.774527    0.753157    0.988794    0.804544    1.248722    0.994336    0.746392    0.978522    0.774341    0.993525    0.892897    0.774527    0.753157    4400        72.502575   0.032946    0.245135    114.225029 
[37m[36mINFO[0m[0m 03/18 02:29:52 | 0.776248    0.768083    0.987842    0.798153    1.250744    0.991761    0.734021    0.978522    0.772050    0.993243    0.888388    0.776248    0.768083    4600        75.798146   0.034007    0.325529    115.703184 
[37m[36mINFO[0m[0m 03/18 02:33:12 | 0.780264    0.773823    0.989414    0.795731    1.276199    0.992791    0.736082    0.979954    0.752577    0.995495    0.898534    0.780264    0.773823    4800        79.093718   0.033410    0.412748    117.981760 
[37m[36mINFO[0m[0m 03/18 02:36:27 | 0.779116    0.761194    0.990951    0.792994    1.196094    0.995366    0.727835    0.983963    0.754868    0.993525    0.896280    0.779116    0.761194    5000        82.389289   0.028435    0.388897    116.664490 
[37m[36mINFO[0m[0m 03/18 02:36:27 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[3]/250318_01-22-05_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 02:36:29 | ---
[37m[36mINFO[0m[0m 03/18 02:36:29 | test-domain validation(oracle) = 78.428%
[37m[36mINFO[0m[0m 03/18 02:36:29 | training-domain validation(iid) = 78.657%
[37m[36mINFO[0m[0m 03/18 02:36:29 | last = 77.912%
[37m[36mINFO[0m[0m 03/18 02:36:29 | last (inD) = 79.299%
[37m[36mINFO[0m[0m 03/18 02:36:29 | training-domain validation (iid, inD) = 80.473%
[37m[36mINFO[0m[0m 03/18 02:36:29 | === Summary ===
[37m[36mINFO[0m[0m 03/18 02:36:29 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset OfficeHome
[37m[36mINFO[0m[0m 03/18 02:36:29 | Unique name: 250318_01-22-05_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 02:36:29 | Out path: train_output/OfficeHome/ERM/[3]/250318_01-22-05_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 02:36:29 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 02:36:29 | Dataset: OfficeHome

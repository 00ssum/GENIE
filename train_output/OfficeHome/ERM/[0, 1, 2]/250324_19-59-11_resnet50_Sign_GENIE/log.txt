[37m[36mINFO[0m[0m 03/24 19:59:11 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset OfficeHome --trial_seed 0 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/OfficeHome/ERM/[0, 1, 2]/250324_19-59-11_resnet50_Sign_GENIE
	out_root: train_output/OfficeHome/ERM/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 0
	unique_name: 250324_19-59-11_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5.0781288859686544e-05
	batch_size: 44
	weight_decay: 0.00046410133598234803
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/24 19:59:11 | n_steps = 5001
[37m[36mINFO[0m[0m 03/24 19:59:11 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/24 19:59:11 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/24 19:59:11 | 
[37m[36mINFO[0m[0m 03/24 19:59:11 | Testenv name escaping te_A_C_P -> te_A_C_P
[37m[36mINFO[0m[0m 03/24 19:59:11 | Test envs = [0, 1, 2], name = te_A_C_P
[37m[36mINFO[0m[0m 03/24 19:59:11 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 03/24 19:59:11 | Batch sizes for each domain: [0, 0, 0, 44] (total=44)
[37m[36mINFO[0m[0m 03/24 19:59:11 | steps-per-epoch for each domain: 79.23 -> min = 79.23
[37m[36mINFO[0m[0m 03/24 19:59:12 | # of params = 23641217
[37m[36mINFO[0m[0m 03/24 20:01:00 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/24 20:01:00 | 0.026967    0.031259    0.027252    0.024110    4.197747    0.030896    0.039175    0.026919    0.030928    0.023086    0.023675    0.027252    0.024110    0           0.000000    4.256127    1.359166    106.887719 
[37m[36mINFO[0m[0m 03/24 20:05:18 | 0.542182    0.538787    0.858003    0.747417    0.862103    0.513903    0.540206    0.418385    0.396334    0.694257    0.679820    0.858003    0.747417    200         2.524383    1.306607    0.743225    109.096942 
[37m[36mINFO[0m[0m 03/24 20:09:28 | 0.595841    0.581143    0.926277    0.787600    0.760909    0.585994    0.610309    0.480527    0.434135    0.721002    0.698985    0.926277    0.787600    400         5.048766    0.387690    0.732135    103.389621 
[37m[36mINFO[0m[0m 03/24 20:13:43 | 0.567655    0.544721    0.943775    0.785304    0.843125    0.558187    0.567010    0.437572    0.397480    0.707207    0.669673    0.943775    0.785304    600         7.573150    0.219907    0.734293    108.563419 
[37m[36mINFO[0m[0m 03/24 20:17:51 | 0.563874    0.545814    0.960987    0.803674    0.825160    0.541195    0.531959    0.438717    0.397480    0.711712    0.708005    0.960987    0.803674    800         10.097533   0.165150    0.727946    102.398408 
[37m[36mINFO[0m[0m 03/24 20:22:03 | 0.573655    0.554010    0.965863    0.792193    0.901096    0.547889    0.527835    0.462772    0.430699    0.710304    0.703495    0.965863    0.792193    1000        12.621916   0.112722    0.737469    104.805848 
[37m[36mINFO[0m[0m 03/24 20:26:16 | 0.561429    0.547778    0.969019    0.800230    0.997376    0.549949    0.562887    0.419530    0.382589    0.714809    0.697858    0.969019    0.800230    1200        15.146299   0.093980    0.730769    106.595337 
[37m[36mINFO[0m[0m 03/24 20:30:30 | 0.579044    0.576957    0.985944    0.801378    0.832207    0.546344    0.564948    0.461340    0.441008    0.729448    0.724915    0.985944    0.801378    1400        17.670683   0.071294    0.749025    104.334059 
[37m[36mINFO[0m[0m 03/24 20:34:49 | 0.568494    0.550766    0.985657    0.793341    1.098348    0.547889    0.531959    0.429553    0.410080    0.728041    0.710259    0.985657    0.793341    1600        20.195066   0.054483    0.752642    108.212862 
[37m[36mINFO[0m[0m 03/24 20:39:01 | 0.594807    0.574855    0.992255    0.820896    0.811723    0.589083    0.581443    0.463918    0.424971    0.731419    0.718151    0.992255    0.820896    1800        22.719449   0.052390    0.713420    109.454638 
[37m[36mINFO[0m[0m 03/24 20:43:18 | 0.607650    0.588812    0.992828    0.819747    0.873561    0.588568    0.585567    0.491982    0.459336    0.742399    0.721533    0.992828    0.819747    2000        25.243832   0.039733    0.743464    107.634230 
[37m[36mINFO[0m[0m 03/24 20:47:32 | 0.602868    0.598902    0.993976    0.817451    0.934866    0.591658    0.610309    0.476518    0.452463    0.740428    0.733935    0.993976    0.817451    2200        27.768216   0.030075    0.741569    105.899155 
[37m[36mINFO[0m[0m 03/24 20:51:46 | 0.601473    0.590713    0.992255    0.807118    1.071696    0.591143    0.583505    0.475945    0.451317    0.737331    0.737317    0.992255    0.807118    2400        30.292599   0.022189    0.735193    107.474330 
[37m[36mINFO[0m[0m 03/24 20:56:02 | 0.611598    0.599883    0.993976    0.809414    0.940691    0.579300    0.573196    0.508591    0.490263    0.746903    0.736189    0.993976    0.809414    2600        32.816982   0.029703    0.742823    107.381892 
[37m[36mINFO[0m[0m 03/24 21:00:18 | 0.585632    0.572532    0.991681    0.794489    0.988122    0.561792    0.558763    0.466781    0.420389    0.728322    0.738444    0.991681    0.794489    2800        35.341365   0.033993    0.732475    108.955395 
[37m[36mINFO[0m[0m 03/24 21:04:33 | 0.595511    0.583754    0.995410    0.814007    1.015443    0.568486    0.587629    0.475086    0.438717    0.742962    0.724915    0.995410    0.814007    3000        37.865749   0.017996    0.747400    105.703731 
[37m[36mINFO[0m[0m 03/24 21:08:45 | 0.613367    0.597580    0.994550    0.812859    0.959585    0.605561    0.604124    0.484822    0.450172    0.749718    0.738444    0.994550    0.812859    3200        40.390132   0.029316    0.736972    104.628169 
[37m[36mINFO[0m[0m 03/24 21:13:01 | 0.599715    0.593193    0.996271    0.809414    1.066580    0.587539    0.600000    0.477090    0.449026    0.734516    0.730552    0.996271    0.809414    3400        42.914515   0.019887    0.731506    109.933365 
[37m[36mINFO[0m[0m 03/24 21:17:13 | 0.602819    0.597520    0.993115    0.818599    0.981636    0.585479    0.604124    0.483677    0.438717    0.739302    0.749718    0.993115    0.818599    3600        45.438898   0.016916    0.730171    105.495595 
[37m[36mINFO[0m[0m 03/24 21:21:28 | 0.603552    0.590166    0.994836    0.788749    1.137707    0.573635    0.577320    0.498282    0.453608    0.738739    0.739572    0.994836    0.788749    3800        47.963282   0.015536    0.725993    110.324854 
[37m[36mINFO[0m[0m 03/24 21:25:42 | 0.602649    0.586402    0.995697    0.814007    1.033268    0.595778    0.577320    0.477090    0.452463    0.735079    0.729425    0.995697    0.814007    4000        50.487665   0.016215    0.725262    108.890556 
[37m[36mINFO[0m[0m 03/24 21:30:00 | 0.606630    0.586332    0.996845    0.824340    0.961948    0.582389    0.569072    0.493414    0.461627    0.744088    0.728298    0.996845    0.824340    4200        53.012048   0.011904    0.741495    109.762067 
[37m[36mINFO[0m[0m 03/24 21:34:15 | 0.616591    0.605126    0.997131    0.832377    0.851250    0.595263    0.604124    0.500286    0.455899    0.754223    0.755355    0.997131    0.832377    4400        55.536431   0.014533    0.731891    107.979861 
[37m[36mINFO[0m[0m 03/24 21:38:24 | 0.606514    0.584228    0.997131    0.822044    1.008434    0.590113    0.573196    0.482245    0.443299    0.747185    0.736189    0.997131    0.822044    4600        58.060815   0.007258    0.713885    106.710362 
[37m[36mINFO[0m[0m 03/24 21:42:40 | 0.606322    0.585462    0.997131    0.827784    0.952437    0.591143    0.571134    0.487113    0.451317    0.740709    0.733935    0.997131    0.827784    4800        60.585198   0.009848    0.728818    110.556093 
[37m[36mINFO[0m[0m 03/24 21:47:00 | 0.597869    0.573627    0.996271    0.807118    1.152919    0.558702    0.542268    0.489691    0.459336    0.745214    0.719278    0.996271    0.807118    5000        63.109581   0.007409    0.744818    110.853966 
[37m[36mINFO[0m[0m 03/24 21:47:00 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[0, 1, 2]/250324_19-59-11_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/24 21:47:02 | ---
[37m[36mINFO[0m[0m 03/24 21:47:02 | test-domain validation(oracle) = 61.659%
[37m[36mINFO[0m[0m 03/24 21:47:02 | training-domain validation(iid) = 61.659%
[37m[36mINFO[0m[0m 03/24 21:47:02 | last = 59.787%
[37m[36mINFO[0m[0m 03/24 21:47:02 | last (inD) = 80.712%
[37m[36mINFO[0m[0m 03/24 21:47:02 | training-domain validation (iid, inD) = 83.238%
[37m[36mINFO[0m[0m 03/24 21:47:02 | === Summary ===
[37m[36mINFO[0m[0m 03/24 21:47:02 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset OfficeHome --trial_seed 0 --hparams_seed 1
[37m[36mINFO[0m[0m 03/24 21:47:02 | Unique name: 250324_19-59-11_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 21:47:02 | Out path: train_output/OfficeHome/ERM/[0, 1, 2]/250324_19-59-11_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 21:47:02 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/24 21:47:02 | Dataset: OfficeHome

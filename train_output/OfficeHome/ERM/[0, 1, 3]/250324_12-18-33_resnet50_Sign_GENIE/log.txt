[37m[36mINFO[0m[0m 03/24 12:18:33 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/OfficeHome/ERM/[0, 1, 3]/250324_12-18-33_resnet50_Sign_GENIE
	out_root: train_output/OfficeHome/ERM/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 0
	unique_name: 250324_12-18-33_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5.0781288859686544e-05
	batch_size: 44
	weight_decay: 0.00046410133598234803
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/24 12:18:34 | n_steps = 5001
[37m[36mINFO[0m[0m 03/24 12:18:34 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/24 12:18:34 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/24 12:18:34 | 
[37m[36mINFO[0m[0m 03/24 12:18:34 | Testenv name escaping te_A_C_R -> te_A_C_R
[37m[36mINFO[0m[0m 03/24 12:18:34 | Test envs = [0, 1, 3], name = te_A_C_R
[37m[36mINFO[0m[0m 03/24 12:18:34 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 03/24 12:18:34 | Batch sizes for each domain: [0, 0, 44, 0] (total=44)
[37m[36mINFO[0m[0m 03/24 12:18:34 | steps-per-epoch for each domain: 80.73 -> min = 80.73
[37m[36mINFO[0m[0m 03/24 12:18:35 | # of params = 23641217
[37m[36mINFO[0m[0m 03/24 12:20:23 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/24 12:20:23 | 0.023294    0.024682    0.026464    0.025930    4.186682    0.025747    0.024742    0.024055    0.028637    0.026464    0.025930    0.020080    0.020666    0           0.000000    4.330637    2.146374    105.549962 
[37m[36mINFO[0m[0m 03/24 12:23:04 | 0.464403    0.472574    0.887106    0.821871    0.634094    0.394439    0.418557    0.380584    0.363116    0.887106    0.821871    0.618187    0.636051    200         2.477477    1.281659    0.292549    102.844324 
[37m[36mINFO[0m[0m 03/24 12:25:50 | 0.487776    0.503440    0.929336    0.860203    0.597333    0.433574    0.461856    0.378580    0.394044    0.929336    0.860203    0.651176    0.654420    400         4.954955    0.269102    0.301396    105.419258 
[37m[36mINFO[0m[0m 03/24 12:28:31 | 0.500350    0.496495    0.965372    0.861330    0.547489    0.470134    0.463918    0.370275    0.365407    0.965372    0.861330    0.660643    0.660161    600         7.432432    0.176880    0.265158    108.570716 
[37m[36mINFO[0m[0m 03/24 12:31:10 | 0.507747    0.513839    0.976914    0.874859    0.493275    0.453656    0.459794    0.404066    0.410080    0.976914    0.874859    0.665519    0.671642    800         9.909910    0.099628    0.257925    107.139328 
[37m[36mINFO[0m[0m 03/24 12:33:41 | 0.508111    0.515828    0.980574    0.891770    0.511476    0.456746    0.457732    0.398912    0.412371    0.980574    0.891770    0.668675    0.677382    1000        12.387387   0.068398    0.235546    104.122983 
[37m[36mINFO[0m[0m 03/24 12:36:15 | 0.479780    0.479454    0.981982    0.890643    0.467053    0.415036    0.418557    0.379439    0.374570    0.981982    0.890643    0.644865    0.645235    1200        14.864865   0.054832    0.243370    105.176304 
[37m[36mINFO[0m[0m 03/24 12:38:55 | 0.474071    0.474031    0.985923    0.888388    0.526683    0.406797    0.410309    0.377148    0.367698    0.985923    0.888388    0.638267    0.644087    1400        17.342342   0.046525    0.249754    110.080507 
[37m[36mINFO[0m[0m 03/24 12:41:27 | 0.510408    0.508889    0.991273    0.892897    0.554727    0.451596    0.449485    0.403207    0.387171    0.991273    0.892897    0.676420    0.690011    1600        19.819820   0.041541    0.236195    104.415342 
[37m[36mINFO[0m[0m 03/24 12:44:00 | 0.496887    0.509782    0.992680    0.903044    0.491417    0.445417    0.496907    0.379725    0.372279    0.992680    0.903044    0.665519    0.660161    1800        22.297297   0.039964    0.255626    101.618063 
[37m[36mINFO[0m[0m 03/24 12:46:42 | 0.493724    0.505749    0.992399    0.896280    0.484578    0.407312    0.420619    0.420103    0.418099    0.992399    0.896280    0.653758    0.678530    2000        24.774775   0.031583    0.266147    109.310079 
[37m[36mINFO[0m[0m 03/24 12:49:21 | 0.510875    0.522706    0.990428    0.877114    0.557192    0.469619    0.498969    0.393757    0.386025    0.990428    0.877114    0.669248    0.683123    2200        27.252252   0.033823    0.260879    106.315142 
[37m[36mINFO[0m[0m 03/24 12:52:02 | 0.504987    0.510479    0.994369    0.892897    0.441589    0.448507    0.478351    0.390034    0.380298    0.994369    0.892897    0.676420    0.672790    2400        29.729730   0.028816    0.278783    105.076747 
[37m[36mINFO[0m[0m 03/24 12:54:46 | 0.500681    0.508649    0.988739    0.892897    0.477269    0.445932    0.476289    0.399198    0.373425    0.988739    0.892897    0.656913    0.676234    2600        32.207207   0.029098    0.286902    107.069009 
[37m[36mINFO[0m[0m 03/24 12:57:29 | 0.511016    0.531200    0.991273    0.895152    0.495273    0.445417    0.486598    0.419530    0.400916    0.991273    0.895152    0.668101    0.706085    2800        34.684685   0.023118    0.268506    109.243601 
[37m[36mINFO[0m[0m 03/24 13:00:13 | 0.532848    0.538067    0.996622    0.904171    0.454515    0.464470    0.496907    0.436712    0.418099    0.996622    0.904171    0.697361    0.699196    3000        37.162162   0.014358    0.284983    107.281883 
[37m[36mINFO[0m[0m 03/24 13:03:00 | 0.512755    0.521176    0.995495    0.901917    0.525775    0.439753    0.468041    0.431271    0.415808    0.995495    0.901917    0.667240    0.679679    3200        39.639640   0.010477    0.299424    107.065811 
[37m[36mINFO[0m[0m 03/24 13:05:41 | 0.529140    0.535016    0.993525    0.914318    0.420898    0.463955    0.486598    0.434135    0.414662    0.993525    0.914318    0.689329    0.703789    3400        42.117117   0.015614    0.287555    103.366523 
[37m[36mINFO[0m[0m 03/24 13:08:13 | 0.531882    0.523014    0.996340    0.909808    0.471548    0.477343    0.459794    0.431844    0.422680    0.996340    0.909808    0.686460    0.686567    3600        44.594595   0.010284    0.239961    104.017463 
[37m[36mINFO[0m[0m 03/24 13:10:53 | 0.507452    0.509947    0.996059    0.901917    0.503824    0.451596    0.472165    0.388889    0.382589    0.996059    0.901917    0.681870    0.675086    3800        47.072072   0.010979    0.278204    104.095222 
[37m[36mINFO[0m[0m 03/24 13:13:34 | 0.509948    0.512312    0.997185    0.891770    0.577697    0.448507    0.459794    0.409221    0.404353    0.997185    0.891770    0.672117    0.672790    4000        49.549550   0.010153    0.279472    105.563071 
[37m[36mINFO[0m[0m 03/24 13:16:10 | 0.514726    0.505582    0.996340    0.903044    0.512861    0.443357    0.445361    0.422680    0.412371    0.996340    0.903044    0.678141    0.659013    4200        52.027027   0.019923    0.253642    105.116395 
[37m[36mINFO[0m[0m 03/24 13:18:47 | 0.507417    0.511629    0.996059    0.897407    0.470352    0.442327    0.457732    0.397766    0.398625    0.996059    0.897407    0.682157    0.678530    4400        54.504505   0.011186    0.266117    103.502805 
[37m[36mINFO[0m[0m 03/24 13:21:29 | 0.524008    0.520359    0.998029    0.906426    0.473489    0.450566    0.449485    0.433276    0.402062    0.998029    0.906426    0.688181    0.709529    4600        56.981982   0.008495    0.281757    105.568580 
[37m[36mINFO[0m[0m 03/24 13:24:07 | 0.488416    0.481452    0.995777    0.898534    0.594356    0.424305    0.406186    0.378580    0.376861    0.995777    0.898534    0.662364    0.661309    4800        59.459459   0.009212    0.275167    103.298251 
[37m[36mINFO[0m[0m 03/24 13:26:40 | 0.506996    0.514077    0.996903    0.910936    0.496844    0.438208    0.453608    0.404066    0.404353    0.996903    0.910936    0.678715    0.684271    5000        61.936937   0.011657    0.242807    104.350993 
[37m[36mINFO[0m[0m 03/24 13:26:40 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[0, 1, 3]/250324_12-18-33_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/24 13:26:41 | ---
[37m[36mINFO[0m[0m 03/24 13:26:41 | test-domain validation(oracle) = 53.285%
[37m[36mINFO[0m[0m 03/24 13:26:41 | training-domain validation(iid) = 52.914%
[37m[36mINFO[0m[0m 03/24 13:26:41 | last = 50.700%
[37m[36mINFO[0m[0m 03/24 13:26:41 | last (inD) = 91.094%
[37m[36mINFO[0m[0m 03/24 13:26:41 | training-domain validation (iid, inD) = 91.432%
[37m[36mINFO[0m[0m 03/24 13:26:41 | === Summary ===
[37m[36mINFO[0m[0m 03/24 13:26:41 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 1
[37m[36mINFO[0m[0m 03/24 13:26:41 | Unique name: 250324_12-18-33_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 13:26:41 | Out path: train_output/OfficeHome/ERM/[0, 1, 3]/250324_12-18-33_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 13:26:41 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/24 13:26:41 | Dataset: OfficeHome

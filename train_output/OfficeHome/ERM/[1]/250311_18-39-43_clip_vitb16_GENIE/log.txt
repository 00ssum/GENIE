[37m[36mINFO[0m[0m 03/11 18:39:43 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 14
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 14
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/OfficeHome/ERM/[1]/250311_18-39-43_clip_vitb16_GENIE
	out_root: train_output/OfficeHome/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250311_18-39-43_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.1399727535070965e-05
	batch_size: 16
	weight_decay: 0.00022842646099519332
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/11 18:39:43 | n_steps = 5001
[37m[36mINFO[0m[0m 03/11 18:39:43 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/11 18:39:43 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/11 18:39:43 | 
[37m[36mINFO[0m[0m 03/11 18:39:43 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/11 18:39:43 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/11 18:39:43 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/11 18:39:43 | Batch sizes for each domain: [16, 0, 16, 16] (total=48)
[37m[36mINFO[0m[0m 03/11 18:39:43 | steps-per-epoch for each domain: 121.38, 222.00, 217.88 -> min = 121.38
[37m[36mINFO[0m[0m 03/11 18:39:47 | # of params = 86225985
[37m[36mINFO[0m[0m 03/11 18:41:44 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/11 18:41:44 | 0.024341    0.021764    0.021653    0.023844    4.201598    0.025747    0.022680    0.024341    0.021764    0.019707    0.028185    0.019507    0.020666    0           0.000000    4.157923    1.525641    116.115699 
[37m[36mINFO[0m[0m 03/11 18:44:39 | 0.058992    0.042383    0.106396    0.107708    3.690546    0.105561    0.121649    0.058992    0.042383    0.095439    0.094701    0.118187    0.106774    200         1.647786    3.957266    0.285439    117.386137 
[37m[36mINFO[0m[0m 03/11 18:47:30 | 0.177835    0.180985    0.396378    0.391509    2.421271    0.314624    0.321649    0.177835    0.180985    0.461430    0.446449    0.413081    0.406429    400         3.295572    3.109462    0.278176    115.205525 
[37m[36mINFO[0m[0m 03/11 18:50:42 | 0.255441    0.264605    0.646357    0.595659    1.570157    0.577240    0.470103    0.255441    0.264605    0.722128    0.687711    0.639702    0.629162    600         4.943357    1.904761    0.370305    117.853144 
[37m[36mINFO[0m[0m 03/11 18:53:40 | 0.297824    0.301260    0.730129    0.650872    1.293583    0.672503    0.538144    0.297824    0.301260    0.797860    0.749718    0.720023    0.664753    800         6.591143    1.276022    0.312817    115.770036 
[37m[36mINFO[0m[0m 03/11 18:56:32 | 0.342497    0.352806    0.801982    0.720825    1.080727    0.766735    0.630928    0.342497    0.352806    0.859234    0.813980    0.779977    0.717566    1000        8.238929    0.906683    0.279823    115.853945 
[37m[36mINFO[0m[0m 03/11 18:59:25 | 0.302405    0.326460    0.823239    0.701818    1.095614    0.809475    0.589691    0.302405    0.326460    0.854448    0.798196    0.805795    0.717566    1200        9.886715    0.706362    0.274784    118.362001 
[37m[36mINFO[0m[0m 03/11 19:02:21 | 0.321306    0.328751    0.854653    0.713529    1.113717    0.839856    0.600000    0.321306    0.328751    0.890484    0.821871    0.833620    0.718714    1400        11.534501   0.616967    0.297114    116.499836 
[37m[36mINFO[0m[0m 03/11 19:05:29 | 0.349943    0.344788    0.881017    0.725390    1.017400    0.872297    0.620619    0.349943    0.344788    0.911318    0.819617    0.859438    0.735936    1600        13.182286   0.463586    0.348012    118.743224 
[37m[36mINFO[0m[0m 03/11 19:08:46 | 0.369129    0.380298    0.915316    0.750333    0.924985    0.919670    0.653608    0.369129    0.380298    0.933277    0.854566    0.893001    0.742824    1800        14.830072   0.359494    0.404010    116.035650 
[37m[36mINFO[0m[0m 03/11 19:12:08 | 0.370848    0.373425    0.923130    0.732423    0.996464    0.927909    0.624742    0.370848    0.373425    0.933277    0.833145    0.908204    0.739380    2000        16.477858   0.299911    0.422083    117.067471 
[37m[36mINFO[0m[0m 03/11 19:15:23 | 0.365120    0.350515    0.936842    0.752000    0.947411    0.937178    0.639175    0.365120    0.350515    0.947072    0.859076    0.926277    0.757750    2200        18.125644   0.273739    0.384828    118.169767 
[37m[36mINFO[0m[0m 03/11 19:18:28 | 0.360538    0.363116    0.937944    0.750388    0.999344    0.943872    0.653608    0.360538    0.363116    0.944257    0.845547    0.925703    0.752009    2400        19.773429   0.224525    0.333911    117.785510 
[37m[36mINFO[0m[0m 03/11 19:21:20 | 0.368557    0.381443    0.951749    0.763512    0.907476    0.955716    0.645361    0.368557    0.381443    0.958052    0.878241    0.941480    0.766935    2600        21.421215   0.183541    0.281586    116.538303 
[37m[36mINFO[0m[0m 03/11 19:24:09 | 0.371707    0.387171    0.955937    0.764424    0.913280    0.955201    0.653608    0.371707    0.387171    0.964245    0.865840    0.948365    0.773823    2800        23.069001   0.187542    0.266777    115.676071 
[37m[36mINFO[0m[0m 03/11 19:27:07 | 0.386312    0.374570    0.966312    0.755894    0.938982    0.971164    0.635052    0.386312    0.374570    0.966498    0.873732    0.961274    0.758898    3000        24.716787   0.147331    0.290111    119.744144 
[37m[36mINFO[0m[0m 03/11 19:30:08 | 0.394330    0.387171    0.967029    0.771100    0.946181    0.972194    0.668041    0.394330    0.387171    0.967905    0.873732    0.960987    0.771527    3200        26.364573   0.109210    0.326222    115.147713 
[37m[36mINFO[0m[0m 03/11 19:33:18 | 0.382302    0.357388    0.973021    0.762238    0.949373    0.979403    0.647423    0.382302    0.357388    0.974944    0.886133    0.964716    0.753157    3400        28.012358   0.102246    0.377313    115.251820 
[37m[36mINFO[0m[0m 03/11 19:36:37 | 0.381730    0.398625    0.976088    0.783957    0.908494    0.978373    0.680412    0.381730    0.398625    0.980011    0.885006    0.969880    0.786452    3600        29.660144   0.092527    0.421871    114.334701 
[37m[36mINFO[0m[0m 03/11 19:39:54 | 0.372566    0.368843    0.972792    0.763964    0.971141    0.980433    0.663918    0.372566    0.368843    0.974662    0.877114    0.963282    0.750861    3800        31.307930   0.093587    0.401114    116.355390 
[37m[36mINFO[0m[0m 03/11 19:42:58 | 0.377721    0.369989    0.977598    0.783147    0.909701    0.978888    0.692784    0.377721    0.369989    0.980011    0.878241    0.973896    0.778416    4000        32.955716   0.087398    0.321207    120.157626 
[37m[36mINFO[0m[0m 03/11 19:45:54 | 0.395475    0.375716    0.985677    0.781726    0.876456    0.989186    0.668041    0.395475    0.375716    0.986205    0.888388    0.981641    0.788749    4200        34.603502   0.060279    0.286964    118.451230 
[37m[36mINFO[0m[0m 03/11 19:48:50 | 0.369989    0.375716    0.983333    0.781654    0.975609    0.983007    0.680412    0.369989    0.375716    0.985923    0.886133    0.981067    0.778416    4400        36.251287   0.060086    0.278652    120.145740 
[37m[36mINFO[0m[0m 03/11 19:51:48 | 0.417239    0.407789    0.989973    0.797253    0.831175    0.991246    0.701031    0.417239    0.407789    0.990146    0.898534    0.988526    0.792193    4600        37.899073   0.044712    0.295416    118.931695 
[37m[36mINFO[0m[0m 03/11 19:54:55 | 0.404066    0.413517    0.990924    0.805163    0.832500    0.991246    0.703093    0.404066    0.413517    0.990991    0.906426    0.990534    0.805970    4800        39.546859   0.036490    0.340907    118.924289 
[37m[36mINFO[0m[0m 03/11 19:58:10 | 0.367698    0.389462    0.983270    0.776716    0.937530    0.984552    0.668041    0.367698    0.389462    0.986486    0.894025    0.978772    0.768083    5000        41.194645   0.053520    0.384204    118.317811 
[37m[36mINFO[0m[0m 03/11 19:58:10 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[1]/250311_18-39-43_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/11 19:58:20 | ---
[37m[36mINFO[0m[0m 03/11 19:58:20 | test-domain validation(oracle) = 40.407%
[37m[36mINFO[0m[0m 03/11 19:58:20 | training-domain validation(iid) = 40.407%
[37m[36mINFO[0m[0m 03/11 19:58:20 | last = 36.770%
[37m[36mINFO[0m[0m 03/11 19:58:20 | last (inD) = 77.672%
[37m[36mINFO[0m[0m 03/11 19:58:20 | training-domain validation (iid, inD) = 80.516%
[37m[36mINFO[0m[0m 03/11 19:58:20 | === Summary ===
[37m[36mINFO[0m[0m 03/11 19:58:20 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 14
[37m[36mINFO[0m[0m 03/11 19:58:20 | Unique name: 250311_18-39-43_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/11 19:58:20 | Out path: train_output/OfficeHome/ERM/[1]/250311_18-39-43_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/11 19:58:20 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/11 19:58:20 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 03/11 22:40:59 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 4
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 4
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/OfficeHome/ERM/[1]/250311_22-40-59_clip_vitb16_GENIE
	out_root: train_output/OfficeHome/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250311_22-40-59_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.0793009436922532e-05
	batch_size: 30
	weight_decay: 0.0007980067844361917
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/11 22:40:59 | n_steps = 5001
[37m[36mINFO[0m[0m 03/11 22:40:59 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/11 22:40:59 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/11 22:40:59 | 
[37m[36mINFO[0m[0m 03/11 22:40:59 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/11 22:40:59 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/11 22:40:59 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/11 22:40:59 | Batch sizes for each domain: [30, 0, 30, 30] (total=90)
[37m[36mINFO[0m[0m 03/11 22:40:59 | steps-per-epoch for each domain: 64.73, 118.40, 116.20 -> min = 64.73
[37m[36mINFO[0m[0m 03/11 22:41:02 | # of params = 86225985
[37m[36mINFO[0m[0m 03/11 22:43:00 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/11 22:43:00 | 0.018614    0.013746    0.016787    0.014962    4.189556    0.018538    0.016495    0.018614    0.013746    0.016047    0.016911    0.015777    0.011481    0           0.000000    4.189220    1.115993    116.835613 
[37m[36mINFO[0m[0m 03/11 22:46:51 | 0.125143    0.137457    0.257058    0.244499    3.096610    0.226571    0.232990    0.125143    0.137457    0.295608    0.253664    0.248996    0.246843    200         3.089598    3.784367    0.561614    119.001025 
[37m[36mINFO[0m[0m 03/11 22:50:42 | 0.315578    0.308133    0.687916    0.659209    1.405925    0.628733    0.597938    0.315578    0.308133    0.750563    0.705750    0.684452    0.673938    400         6.179197    2.239328    0.574876    116.481376 
[37m[36mINFO[0m[0m 03/11 22:54:19 | 0.359107    0.387171    0.811388    0.741307    0.995995    0.768795    0.653608    0.359107    0.387171    0.856419    0.828636    0.808950    0.741676    600         9.268795    0.997408    0.491705    118.350931 
[37m[36mINFO[0m[0m 03/11 22:58:18 | 0.394044    0.400916    0.874436    0.764144    0.905746    0.863543    0.663918    0.394044    0.400916    0.900901    0.847802    0.858864    0.780712    800         12.358393   0.631610    0.589780    120.633646 
[37m[36mINFO[0m[0m 03/11 23:01:59 | 0.418099    0.397480    0.920741    0.789129    0.775388    0.922760    0.686598    0.418099    0.397480    0.933840    0.877114    0.905622    0.803674    1000        15.447992   0.446555    0.507165    120.307106 
[37m[36mINFO[0m[0m 03/11 23:05:52 | 0.381157    0.382589    0.941723    0.805012    0.786779    0.943357    0.709278    0.381157    0.382589    0.954673    0.892897    0.927137    0.812859    1200        18.537590   0.285722    0.573301    117.618140 
[37m[36mINFO[0m[0m 03/11 23:09:45 | 0.434135    0.420389    0.955062    0.806031    0.784299    0.956231    0.713402    0.434135    0.420389    0.960304    0.888388    0.948652    0.816303    1400        21.627188   0.213850    0.572664    118.532830 
[37m[36mINFO[0m[0m 03/11 23:13:29 | 0.375143    0.368843    0.949245    0.775150    0.910453    0.951081    0.659794    0.375143    0.368843    0.958615    0.888388    0.938038    0.777268    1600        24.716787   0.168194    0.539053    116.255893 
[37m[36mINFO[0m[0m 03/11 23:17:26 | 0.403780    0.394044    0.962471    0.795115    0.821202    0.969104    0.701031    0.403780    0.394044    0.966216    0.872604    0.952094    0.811711    1800        27.806385   0.153123    0.588073    120.014200 
[37m[36mINFO[0m[0m 03/11 23:21:14 | 0.450745    0.428408    0.975279    0.807040    0.774391    0.977343    0.705155    0.450745    0.428408    0.978041    0.899662    0.970453    0.816303    2000        30.895984   0.113635    0.538736    119.777417 
[37m[36mINFO[0m[0m 03/11 23:25:09 | 0.394616    0.396334    0.971976    0.801104    0.834752    0.971164    0.707216    0.394616    0.396334    0.978041    0.918828    0.966724    0.777268    2200        33.985582   0.091465    0.577658    119.222798 
[37m[36mINFO[0m[0m 03/11 23:28:53 | 0.410653    0.387171    0.978180    0.796502    0.859324    0.980947    0.690722    0.410653    0.387171    0.981419    0.897407    0.972174    0.801378    2400        37.075180   0.090430    0.542138    116.223922 
[37m[36mINFO[0m[0m 03/11 23:32:42 | 0.453895    0.426117    0.985140    0.821342    0.755926    0.985582    0.719588    0.453895    0.426117    0.987050    0.912063    0.982788    0.832377    2600        40.164779   0.071708    0.566459    115.068565 
[37m[36mINFO[0m[0m 03/11 23:36:39 | 0.426403    0.407789    0.984472    0.826075    0.751043    0.986097    0.736082    0.426403    0.407789    0.983671    0.912063    0.983649    0.830080    2800        43.254377   0.086344    0.597186    117.526077 
[37m[36mINFO[0m[0m 03/11 23:40:26 | 0.420676    0.413517    0.988212    0.820259    0.788272    0.987127    0.717526    0.420676    0.413517    0.990991    0.914318    0.986517    0.828932    3000        46.343975   0.052254    0.540529    119.717036 
[37m[36mINFO[0m[0m 03/11 23:44:21 | 0.426403    0.408935    0.987317    0.811407    0.831093    0.988157    0.709278    0.426403    0.408935    0.990146    0.910936    0.983649    0.814007    3200        49.433574   0.045064    0.588004    117.018650 
[37m[36mINFO[0m[0m 03/11 23:48:03 | 0.466781    0.458190    0.991086    0.839023    0.746142    0.991761    0.756701    0.466781    0.458190    0.992399    0.919955    0.989099    0.840413    3400        52.523172   0.043943    0.514419    119.314987 
[37m[36mINFO[0m[0m 03/11 23:52:03 | 0.440149    0.453608    0.986952    0.808975    0.811469    0.990731    0.713402    0.440149    0.453608    0.987050    0.907554    0.983075    0.805970    3600        55.612770   0.044618    0.611304    117.069545 
[37m[36mINFO[0m[0m 03/11 23:55:48 | 0.422108    0.441008    0.980103    0.805906    0.894805    0.974768    0.705155    0.422108    0.441008    0.986768    0.897407    0.978772    0.815155    3800        58.702369   0.055282    0.524916    120.316192 
[37m[36mINFO[0m[0m 03/11 23:59:44 | 0.437858    0.408935    0.989991    0.809296    0.833875    0.990731    0.694845    0.437858    0.408935    0.990428    0.907554    0.988812    0.825488    4000        61.791967   0.061619    0.585342    118.808217 
[37m[36mINFO[0m[0m 03/12 00:03:43 | 0.433276    0.431844    0.988675    0.804659    0.924410    0.990216    0.707216    0.433276    0.431844    0.989865    0.900789    0.985944    0.805970    4200        64.881565   0.042486    0.596531    119.537751 
[37m[36mINFO[0m[0m 03/12 00:07:25 | 0.396907    0.395189    0.988380    0.810883    0.849034    0.988157    0.703093    0.396907    0.395189    0.988457    0.909808    0.988526    0.819747    4400        67.971164   0.054231    0.506829    121.242707 
[37m[36mINFO[0m[0m 03/12 00:11:20 | 0.437858    0.445590    0.985517    0.804815    0.883087    0.985582    0.703093    0.437858    0.445590    0.987894    0.900789    0.983075    0.810563    4600        71.060762   0.032548    0.600355    114.788355 
[37m[36mINFO[0m[0m 03/12 00:15:08 | 0.412944    0.400916    0.986292    0.809734    0.868216    0.988157    0.713402    0.412944    0.400916    0.985923    0.908681    0.984796    0.807118    4800        74.150360   0.035614    0.551546    117.715022 
[37m[36mINFO[0m[0m 03/12 00:18:56 | 0.437285    0.419244    0.989810    0.818636    0.854745    0.990731    0.719588    0.437285    0.419244    0.988739    0.916573    0.989960    0.819747    5000        77.239959   0.041558    0.564950    114.889272 
[37m[36mINFO[0m[0m 03/12 00:18:56 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[1]/250311_22-40-59_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/12 00:18:58 | ---
[37m[36mINFO[0m[0m 03/12 00:18:58 | test-domain validation(oracle) = 46.678%
[37m[36mINFO[0m[0m 03/12 00:18:58 | training-domain validation(iid) = 46.678%
[37m[36mINFO[0m[0m 03/12 00:18:58 | last = 43.729%
[37m[36mINFO[0m[0m 03/12 00:18:58 | last (inD) = 81.864%
[37m[36mINFO[0m[0m 03/12 00:18:58 | training-domain validation (iid, inD) = 83.902%
[37m[36mINFO[0m[0m 03/12 00:18:58 | === Summary ===
[37m[36mINFO[0m[0m 03/12 00:18:58 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 4
[37m[36mINFO[0m[0m 03/12 00:18:58 | Unique name: 250311_22-40-59_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 00:18:58 | Out path: train_output/OfficeHome/ERM/[1]/250311_22-40-59_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 00:18:58 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/12 00:18:58 | Dataset: OfficeHome

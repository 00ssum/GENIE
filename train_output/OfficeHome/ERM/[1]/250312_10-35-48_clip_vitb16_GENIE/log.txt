[37m[36mINFO[0m[0m 03/12 10:35:48 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 2 --hparams_seed 16
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 16
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/OfficeHome/ERM/[1]/250312_10-35-48_clip_vitb16_GENIE
	out_root: train_output/OfficeHome/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 2
	unique_name: 250312_10-35-48_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.15290264354828e-05
	batch_size: 18
	weight_decay: 0.008257233595621347
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/12 10:35:48 | n_steps = 5001
[37m[36mINFO[0m[0m 03/12 10:35:48 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/12 10:35:48 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/12 10:35:48 | 
[37m[36mINFO[0m[0m 03/12 10:35:48 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/12 10:35:48 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/12 10:35:48 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/12 10:35:48 | Batch sizes for each domain: [18, 0, 18, 18] (total=54)
[37m[36mINFO[0m[0m 03/12 10:35:48 | steps-per-epoch for each domain: 107.89, 197.33, 193.67 -> min = 107.89
[37m[36mINFO[0m[0m 03/12 10:35:51 | # of params = 86225985
[37m[36mINFO[0m[0m 03/12 10:37:48 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/12 10:37:48 | 0.018041    0.017182    0.016745    0.015373    4.202954    0.016478    0.016495    0.018041    0.017182    0.019989    0.012401    0.013769    0.017222    0           0.000000    4.221091    2.443166    115.121757 
[37m[36mINFO[0m[0m 03/12 10:41:02 | 0.055269    0.048110    0.098847    0.096167    3.833756    0.084449    0.082474    0.055269    0.048110    0.100788    0.096956    0.111302    0.109070    200         1.853759    4.023103    0.391059    115.028173 
[37m[36mINFO[0m[0m 03/12 10:44:17 | 0.141180    0.161512    0.294952    0.280566    2.869297    0.266220    0.232990    0.141180    0.161512    0.309685    0.301015    0.308950    0.307692    400         3.707518    3.362455    0.385487    118.217030 
[37m[36mINFO[0m[0m 03/12 10:47:20 | 0.233391    0.255441    0.546563    0.495573    1.934185    0.481462    0.389691    0.233391    0.255441    0.627534    0.593010    0.530694    0.504018    600         5.561277    2.367501    0.332476    116.678032 
[37m[36mINFO[0m[0m 03/12 10:50:19 | 0.282073    0.298969    0.676874    0.604378    1.552349    0.603502    0.488660    0.282073    0.298969    0.758446    0.711387    0.668675    0.613088    800         7.415036    1.537501    0.311453    116.494407 
[37m[36mINFO[0m[0m 03/12 10:53:20 | 0.297537    0.301260    0.734686    0.637550    1.354538    0.692070    0.525773    0.297537    0.301260    0.791104    0.751973    0.720884    0.634902    1000        9.268795    1.064652    0.344656    112.186415 
[37m[36mINFO[0m[0m 03/12 10:56:33 | 0.319588    0.320733    0.781334    0.645886    1.327944    0.750257    0.525773    0.319588    0.320733    0.836430    0.765502    0.757315    0.646383    1200        11.122554   0.917659    0.393261    114.257302 
[37m[36mINFO[0m[0m 03/12 10:59:33 | 0.293242    0.298969    0.815462    0.675597    1.225070    0.791452    0.546392    0.293242    0.298969    0.862050    0.785795    0.792886    0.694604    1400        12.976313   0.753163    0.321301    115.661692 
[37m[36mINFO[0m[0m 03/12 11:02:33 | 0.344502    0.356243    0.834118    0.687953    1.191395    0.802781    0.569072    0.344502    0.356243    0.867962    0.815107    0.831612    0.679679    1600        14.830072   0.651969    0.325785    114.569950 
[37m[36mINFO[0m[0m 03/12 11:05:30 | 0.298683    0.305842    0.853997    0.678831    1.234842    0.837281    0.540206    0.298683    0.305842    0.888795    0.795941    0.835915    0.700344    1800        16.683831   0.646009    0.313544    114.901609 
[37m[36mINFO[0m[0m 03/12 11:08:27 | 0.288946    0.310424    0.823717    0.634461    1.374468    0.810505    0.490722    0.288946    0.310424    0.863457    0.785795    0.797189    0.626866    2000        18.537590   0.626456    0.315275    113.914068 
[37m[36mINFO[0m[0m 03/12 11:11:34 | 0.306415    0.320733    0.855848    0.666742    1.302603    0.852729    0.544330    0.306415    0.320733    0.881194    0.807215    0.833620    0.648680    2200        20.391349   0.561355    0.359784    114.908715 
[37m[36mINFO[0m[0m 03/12 11:14:47 | 0.313860    0.321879    0.860005    0.658907    1.291270    0.861483    0.523711    0.313860    0.321879    0.881757    0.776776    0.836776    0.676234    2400        22.245108   0.556609    0.392766    114.616724 
[37m[36mINFO[0m[0m 03/12 11:18:02 | 0.333333    0.361970    0.853736    0.656163    1.356690    0.839341    0.536082    0.333333    0.361970    0.887387    0.773393    0.834481    0.659013    2600        24.098867   0.558603    0.404325    114.387768 
[37m[36mINFO[0m[0m 03/12 11:21:15 | 0.301260    0.320733    0.840451    0.640074    1.460431    0.823378    0.509278    0.301260    0.320733    0.876689    0.754228    0.821285    0.656716    2800        25.952626   0.508559    0.378938    116.848962 
[37m[36mINFO[0m[0m 03/12 11:24:16 | 0.286082    0.293242    0.830930    0.626576    1.494708    0.816169    0.490722    0.286082    0.293242    0.868243    0.760992    0.808376    0.628014    3000        27.806385   0.580057    0.325394    115.953978 
[37m[36mINFO[0m[0m 03/12 11:27:12 | 0.290664    0.323024    0.825303    0.615608    1.562813    0.811020    0.501031    0.290664    0.323024    0.866554    0.738444    0.798336    0.607348    3200        29.660144   0.619649    0.303977    114.945043 
[37m[36mINFO[0m[0m 03/12 11:30:17 | 0.273196    0.293242    0.838366    0.614044    1.498960    0.824923    0.480412    0.273196    0.293242    0.879505    0.746336    0.810671    0.615385    3400        31.513903   0.603374    0.337061    118.008237 
[37m[36mINFO[0m[0m 03/12 11:33:26 | 0.275200    0.296678    0.831697    0.621558    1.581732    0.811020    0.482474    0.275200    0.296678    0.868525    0.756483    0.815548    0.625718    3600        33.367662   0.586234    0.369302    114.924580 
[37m[36mINFO[0m[0m 03/12 11:36:41 | 0.247995    0.256586    0.786792    0.559733    1.783344    0.763131    0.391753    0.247995    0.256586    0.848536    0.727170    0.748709    0.560276    3800        35.221421   0.620643    0.405804    113.629940 
[37m[36mINFO[0m[0m 03/12 11:39:55 | 0.272623    0.261168    0.842929    0.615762    1.568140    0.841401    0.498969    0.272623    0.261168    0.875282    0.726043    0.812106    0.622273    4000        37.075180   0.674051    0.400840    114.166461 
[37m[36mINFO[0m[0m 03/12 11:43:14 | 0.272050    0.293242    0.821146    0.599221    1.640763    0.794027    0.465979    0.272050    0.293242    0.870214    0.756483    0.799197    0.575201    4200        38.928939   0.630985    0.396895    119.656138 
[37m[36mINFO[0m[0m 03/12 11:46:18 | 0.262027    0.285223    0.780939    0.560965    1.812105    0.745623    0.424742    0.262027    0.285223    0.836149    0.696731    0.761044    0.561424    4400        40.782698   0.647120    0.343561    114.688186 
[37m[36mINFO[0m[0m 03/12 11:49:16 | 0.246850    0.229095    0.789532    0.572525    1.714284    0.769825    0.441237    0.246850    0.229095    0.843750    0.706877    0.755020    0.569460    4600        42.636457   0.716005    0.324056    113.873949 
[37m[36mINFO[0m[0m 03/12 11:52:13 | 0.256586    0.260023    0.771573    0.549931    1.888536    0.748713    0.422680    0.256586    0.260023    0.831926    0.698985    0.734079    0.528129    4800        44.490216   0.715695    0.314108    113.953636 
[37m[36mINFO[0m[0m 03/12 11:55:08 | 0.258591    0.260023    0.826915    0.574990    1.719185    0.833677    0.447423    0.258591    0.260023    0.853322    0.703495    0.793746    0.574053    5000        46.343975   0.788166    0.310217    113.119879 
[37m[36mINFO[0m[0m 03/12 11:55:09 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[1]/250312_10-35-48_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/12 11:55:11 | ---
[37m[36mINFO[0m[0m 03/12 11:55:11 | test-domain validation(oracle) = 33.333%
[37m[36mINFO[0m[0m 03/12 11:55:11 | training-domain validation(iid) = 34.450%
[37m[36mINFO[0m[0m 03/12 11:55:11 | last = 25.859%
[37m[36mINFO[0m[0m 03/12 11:55:11 | last (inD) = 57.499%
[37m[36mINFO[0m[0m 03/12 11:55:11 | training-domain validation (iid, inD) = 68.795%
[37m[36mINFO[0m[0m 03/12 11:55:11 | === Summary ===
[37m[36mINFO[0m[0m 03/12 11:55:11 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 2 --hparams_seed 16
[37m[36mINFO[0m[0m 03/12 11:55:11 | Unique name: 250312_10-35-48_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 11:55:11 | Out path: train_output/OfficeHome/ERM/[1]/250312_10-35-48_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 11:55:11 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/12 11:55:11 | Dataset: OfficeHome

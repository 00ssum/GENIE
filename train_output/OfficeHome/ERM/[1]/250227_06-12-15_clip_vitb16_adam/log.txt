[37m[36mINFO[0m[0m 02/27 06:12:15 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_adam config/clip_vitb16_adam.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_adam.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_adam
	out_dir: train_output/OfficeHome/ERM/[1]/250227_06-12-15_clip_vitb16_adam
	out_root: train_output/OfficeHome/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250227_06-12-15_clip_vitb16_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: clip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/27 06:12:15 | n_steps = 5001
[37m[36mINFO[0m[0m 02/27 06:12:15 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/27 06:12:15 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/27 06:12:15 | 
[37m[36mINFO[0m[0m 02/27 06:12:15 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 02/27 06:12:15 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 02/27 06:12:15 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 02/27 06:12:15 | Batch sizes for each domain: [32, 0, 32, 32] (total=96)
[37m[36mINFO[0m[0m 02/27 06:12:15 | steps-per-epoch for each domain: 60.69, 111.00, 108.94 -> min = 60.69
[37m[36mINFO[0m[0m 02/27 06:12:18 | # of params = 86225985
[37m[36mINFO[0m[0m 02/27 06:14:32 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/27 06:14:32 | 0.032360    0.041237    0.076463    0.069460    4.136268    0.093718    0.098969    0.032360    0.041237    0.061374    0.043968    0.074297    0.065442    0           0.000000    4.191761    1.320437    132.880296 
[37m[36mINFO[0m[0m 02/27 06:18:44 | 0.572451    0.552119    0.890672    0.820397    0.715509    0.892379    0.760825    0.572451    0.552119    0.896678    0.873732    0.882960    0.826636    200         3.295572    1.137582    0.585533    134.745606 
[37m[36mINFO[0m[0m 02/27 06:23:02 | 0.563860    0.564719    0.928817    0.826115    0.684175    0.940268    0.762887    0.563860    0.564719    0.927365    0.864713    0.918818    0.850746    400         6.591143    0.392756    0.598757    138.069048 
[37m[36mINFO[0m[0m 02/27 06:27:14 | 0.546105    0.516609    0.941142    0.826825    0.666257    0.953141    0.762887    0.546105    0.516609    0.942286    0.873732    0.927998    0.843858    600         9.886715    0.252523    0.577325    136.834351 
[37m[36mINFO[0m[0m 02/27 06:31:32 | 0.559851    0.529210    0.942402    0.815809    0.750345    0.946962    0.738144    0.559851    0.529210    0.946509    0.888388    0.933735    0.820896    800         13.182286   0.214156    0.593438    138.870792 
[37m[36mINFO[0m[0m 02/27 06:35:43 | 0.566151    0.555556    0.958620    0.810074    0.782024    0.967559    0.729897    0.566151    0.555556    0.964527    0.875986    0.943775    0.824340    1000        16.477858   0.192876    0.559057    139.055349 
[37m[36mINFO[0m[0m 02/27 06:40:00 | 0.537514    0.536082    0.955907    0.795141    0.867099    0.956231    0.721649    0.537514    0.536082    0.962838    0.865840    0.948652    0.797933    1200        19.773429   0.168624    0.604766    136.157660 
[37m[36mINFO[0m[0m 02/27 06:44:20 | 0.556701    0.540664    0.967519    0.801903    0.901996    0.974253    0.723711    0.556701    0.540664    0.968750    0.873732    0.959552    0.808266    1400        23.069001   0.115567    0.633859    133.683181 
[37m[36mINFO[0m[0m 02/27 06:48:36 | 0.514605    0.502864    0.962535    0.802006    0.875868    0.962410    0.698969    0.514605    0.502864    0.966216    0.885006    0.958979    0.822044    1600        26.364573   0.122528    0.604658    135.105022 
[37m[36mINFO[0m[0m 02/27 06:52:50 | 0.534078    0.516609    0.964602    0.802433    0.892871    0.967559    0.715464    0.534078    0.516609    0.971284    0.900789    0.954963    0.791045    1800        29.660144   0.112868    0.644988    124.117027 
[37m[36mINFO[0m[0m 02/27 06:57:06 | 0.538373    0.521191    0.968219    0.798541    0.932604    0.970134    0.698969    0.538373    0.521191    0.973536    0.888388    0.960987    0.808266    2000        32.955716   0.100817    0.667888    122.737375 
[37m[36mINFO[0m[0m 02/27 07:01:30 | 0.522337    0.492554    0.966060    0.793696    0.950419    0.973223    0.709278    0.522337    0.492554    0.963682    0.865840    0.961274    0.805970    2200        36.251287   0.082554    0.649785    133.844636 
[37m[36mINFO[0m[0m 02/27 07:06:02 | 0.545246    0.528064    0.977491    0.818998    0.844435    0.976313    0.744330    0.545246    0.528064    0.982264    0.891770    0.973896    0.820896    2400        39.546859   0.106754    0.688994    134.928174 
[37m[36mINFO[0m[0m 02/27 07:10:25 | 0.504009    0.493700    0.975329    0.806015    0.921214    0.972709    0.715464    0.504009    0.493700    0.982827    0.878241    0.970453    0.824340    2600        42.842430   0.091218    0.653492    132.235162 
[37m[36mINFO[0m[0m 02/27 07:14:48 | 0.548396    0.532646    0.977648    0.804705    0.901716    0.979918    0.727835    0.548396    0.532646    0.981137    0.890643    0.971888    0.795637    2800        46.138002   0.089389    0.658899    131.188537 
[37m[36mINFO[0m[0m 02/27 07:19:12 | 0.513173    0.502864    0.977792    0.809000    0.918814    0.973738    0.725773    0.513173    0.502864    0.980293    0.889515    0.979346    0.811711    3000        49.433574   0.095368    0.657170    132.365320 
[37m[36mINFO[0m[0m 02/27 07:23:35 | 0.540378    0.502864    0.977085    0.806202    0.912861    0.977343    0.717526    0.540378    0.502864    0.979730    0.897407    0.974182    0.803674    3200        52.729145   0.077847    0.638953    135.008564 
[37m[36mINFO[0m[0m 02/27 07:28:05 | 0.548110    0.507446    0.975288    0.802198    0.950216    0.974253    0.703093    0.548110    0.507446    0.980011    0.890643    0.971601    0.812859    3400        56.024717   0.089342    0.624176    145.247962 
[37m[36mINFO[0m[0m 02/27 07:32:22 | 0.499714    0.479954    0.976087    0.792598    1.025815    0.981977    0.717526    0.499714    0.479954    0.973536    0.869222    0.972748    0.791045    3600        59.320288   0.075061    0.591918    138.344906 
[37m[36mINFO[0m[0m 02/27 07:36:58 | 0.522050    0.514318    0.982257    0.808979    0.950642    0.986612    0.725773    0.522050    0.514318    0.983108    0.892897    0.977051    0.808266    3800        62.615860   0.069544    0.661622    144.244344 
[37m[36mINFO[0m[0m 02/27 07:41:42 | 0.541237    0.525773    0.974793    0.798999    0.942515    0.981462    0.709278    0.541237    0.525773    0.969595    0.874859    0.973322    0.812859    4000        65.911432   0.088217    0.687779    146.521160 
[37m[36mINFO[0m[0m 02/27 07:46:12 | 0.521478    0.502864    0.980415    0.810195    0.905057    0.982492    0.736082    0.521478    0.502864    0.981700    0.880496    0.977051    0.814007    4200        69.207003   0.078383    0.640095    141.984880 
[37m[36mINFO[0m[0m 02/27 07:50:52 | 0.514032    0.499427    0.987830    0.814731    0.901924    0.992791    0.746392    0.514032    0.499427    0.987050    0.888388    0.983649    0.809414    4400        72.502575   0.061334    0.701234    139.757570 
[37m[36mINFO[0m[0m 02/27 07:55:13 | 0.492554    0.470790    0.981977    0.799227    0.974952    0.980947    0.711340    0.492554    0.470790    0.985923    0.887260    0.979059    0.799082    4600        75.798146   0.069856    0.635016    133.963536 
[37m[36mINFO[0m[0m 02/27 07:59:29 | 0.512027    0.495991    0.980289    0.804544    0.906913    0.980433    0.711340    0.512027    0.495991    0.983671    0.894025    0.976764    0.808266    4800        79.093718   0.085676    0.629974    129.555938 
[37m[36mINFO[0m[0m 02/27 08:03:45 | 0.470504    0.452463    0.984712    0.804996    0.943788    0.990216    0.711340    0.470504    0.452463    0.981419    0.882751    0.982501    0.820896    5000        82.389289   0.058544    0.654658    124.871349 
[37m[36mINFO[0m[0m 02/27 08:03:45 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[1]/250227_06-12-15_clip_vitb16_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/27 08:03:50 | ---
[37m[36mINFO[0m[0m 02/27 08:03:50 | test-domain validation(oracle) = 56.386%
[37m[36mINFO[0m[0m 02/27 08:03:50 | training-domain validation(iid) = 54.611%
[37m[36mINFO[0m[0m 02/27 08:03:50 | last = 47.050%
[37m[36mINFO[0m[0m 02/27 08:03:50 | last (inD) = 80.500%
[37m[36mINFO[0m[0m 02/27 08:03:50 | training-domain validation (iid, inD) = 82.683%
[37m[36mINFO[0m[0m 02/27 08:03:50 | === Summary ===
[37m[36mINFO[0m[0m 02/27 08:03:50 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_adam config/clip_vitb16_adam.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome
[37m[36mINFO[0m[0m 02/27 08:03:50 | Unique name: 250227_06-12-15_clip_vitb16_adam
[37m[36mINFO[0m[0m 02/27 08:03:50 | Out path: train_output/OfficeHome/ERM/[1]/250227_06-12-15_clip_vitb16_adam
[37m[36mINFO[0m[0m 02/27 08:03:50 | Algorithm: ERM
[37m[36mINFO[0m[0m 02/27 08:03:50 | Dataset: OfficeHome

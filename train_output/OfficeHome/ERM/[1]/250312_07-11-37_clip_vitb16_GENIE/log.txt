[37m[36mINFO[0m[0m 03/12 07:11:37 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 10
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 10
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/OfficeHome/ERM/[1]/250312_07-11-37_clip_vitb16_GENIE
	out_root: train_output/OfficeHome/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250312_07-11-37_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.5980189819232268e-05
	batch_size: 22
	weight_decay: 1.2831747186887755e-05
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/12 07:11:38 | n_steps = 5001
[37m[36mINFO[0m[0m 03/12 07:11:38 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/12 07:11:38 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/12 07:11:38 | 
[37m[36mINFO[0m[0m 03/12 07:11:38 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/12 07:11:38 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/12 07:11:38 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/12 07:11:38 | Batch sizes for each domain: [22, 0, 22, 22] (total=66)
[37m[36mINFO[0m[0m 03/12 07:11:38 | steps-per-epoch for each domain: 88.27, 161.45, 158.45 -> min = 88.27
[37m[36mINFO[0m[0m 03/12 07:11:40 | # of params = 86225985
[37m[36mINFO[0m[0m 03/12 07:13:38 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/12 07:13:38 | 0.015750    0.010309    0.018855    0.018158    4.200944    0.021627    0.022680    0.015750    0.010309    0.018300    0.019166    0.016638    0.012629    0           0.000000    4.256740    1.291384    116.859103 
[37m[36mINFO[0m[0m 03/12 07:16:48 | 0.038373    0.050401    0.056765    0.068911    3.949318    0.057158    0.080412    0.038373    0.050401    0.054617    0.060879    0.058520    0.065442    200         2.265705    4.079877    0.376866    114.853432 
[37m[36mINFO[0m[0m 03/12 07:19:58 | 0.117125    0.129439    0.186348    0.186325    3.281199    0.153450    0.160825    0.117125    0.129439    0.198480    0.200676    0.207114    0.197474    400         4.531411    3.744387    0.377047    114.333949 
[37m[36mINFO[0m[0m 03/12 07:23:08 | 0.224513    0.217640    0.494873    0.464193    2.059358    0.445417    0.391753    0.224513    0.217640    0.550676    0.517475    0.488526    0.483352    600         6.797116    2.707234    0.373259    115.778661 
[37m[36mINFO[0m[0m 03/12 07:26:20 | 0.301260    0.300115    0.715298    0.629896    1.354655    0.669413    0.513402    0.301260    0.300115    0.772523    0.703495    0.703959    0.672790    800         9.062822    1.518210    0.366566    118.076168 
[37m[36mINFO[0m[0m 03/12 07:29:39 | 0.332474    0.347079    0.787043    0.680230    1.159062    0.759526    0.581443    0.332474    0.347079    0.830518    0.749718    0.771084    0.709529    1000        11.328527   0.974028    0.411236    117.297728 
[37m[36mINFO[0m[0m 03/12 07:33:05 | 0.354238    0.360825    0.852702    0.726458    0.996254    0.832132    0.600000    0.354238    0.360825    0.882601    0.835400    0.843373    0.743972    1200        13.594233   0.711955    0.455337    114.387206 
[37m[36mINFO[0m[0m 03/12 07:36:35 | 0.346506    0.360825    0.881753    0.749523    0.906046    0.869207    0.647423    0.346506    0.360825    0.904279    0.837655    0.871773    0.763490    1400        15.859938   0.550010    0.485280    113.473758 
[37m[36mINFO[0m[0m 03/12 07:40:14 | 0.376861    0.382589    0.911681    0.758149    0.915998    0.903708    0.659794    0.376861    0.382589    0.938908    0.852311    0.892427    0.762342    1600        18.125644   0.406099    0.515805    114.938788 
[37m[36mINFO[0m[0m 03/12 07:43:51 | 0.415521    0.415808    0.929263    0.779406    0.885025    0.933574    0.680412    0.415521    0.415808    0.942568    0.878241    0.911647    0.779564    1800        20.391349   0.320480    0.510035    115.864430 
[37m[36mINFO[0m[0m 03/12 07:47:20 | 0.379725    0.391753    0.946704    0.774591    0.897426    0.951596    0.688660    0.379725    0.391753    0.949043    0.863585    0.939472    0.771527    2000        22.657055   0.240709    0.463651    115.723380 
[37m[36mINFO[0m[0m 03/12 07:50:42 | 0.416953    0.424971    0.956424    0.784912    0.893406    0.963440    0.686598    0.416953    0.424971    0.958615    0.878241    0.947217    0.789897    2200        24.922760   0.233387    0.428735    116.454000 
[37m[36mINFO[0m[0m 03/12 07:53:53 | 0.385452    0.391753    0.963388    0.789108    0.859569    0.970134    0.686598    0.385452    0.391753    0.966216    0.880496    0.953815    0.800230    2400        27.188465   0.182802    0.380050    115.362569 
[37m[36mINFO[0m[0m 03/12 07:57:01 | 0.371134    0.372279    0.946917    0.754790    0.982642    0.946447    0.657732    0.371134    0.372279    0.961430    0.851184    0.932874    0.755454    2600        29.454171   0.150631    0.365212    114.825186 
[37m[36mINFO[0m[0m 03/12 08:00:11 | 0.410653    0.399771    0.965897    0.784695    0.896226    0.970649    0.680412    0.410653    0.399771    0.974662    0.889515    0.952381    0.784156    2800        31.719876   0.157605    0.371093    115.419816 
[37m[36mINFO[0m[0m 03/12 08:03:28 | 0.403494    0.397480    0.978148    0.796146    0.842446    0.981977    0.701031    0.403494    0.397480    0.980293    0.891770    0.972174    0.795637    3000        33.985582   0.113196    0.400407    116.728780 
[37m[36mINFO[0m[0m 03/12 08:06:50 | 0.382302    0.364261    0.979038    0.784417    0.898124    0.984552    0.688660    0.382302    0.364261    0.975225    0.883878    0.977338    0.780712    3200        36.251287   0.094962    0.431165    116.266018 
[37m[36mINFO[0m[0m 03/12 08:10:18 | 0.398053    0.394044    0.970342    0.791296    0.893772    0.977343    0.709278    0.398053    0.394044    0.972410    0.882751    0.961274    0.781860    3400        38.516993   0.099417    0.479338    112.169272 
[37m[36mINFO[0m[0m 03/12 08:13:53 | 0.434422    0.419244    0.982021    0.803091    0.826500    0.987642    0.709278    0.434422    0.419244    0.983953    0.894025    0.974469    0.805970    3600        40.782698   0.085103    0.507603    113.237800 
[37m[36mINFO[0m[0m 03/12 08:17:08 | 0.389462    0.394044    0.976450    0.791399    0.945583    0.976828    0.684536    0.389462    0.394044    0.977477    0.894025    0.975043    0.795637    3800        43.048404   0.078450    0.392683    116.749577 
[37m[36mINFO[0m[0m 03/12 08:20:20 | 0.402921    0.403207    0.979487    0.788253    0.956887    0.981462    0.686598    0.402921    0.403207    0.983390    0.895152    0.973609    0.783008    4000        45.314109   0.069507    0.379523    116.060593 
[37m[36mINFO[0m[0m 03/12 08:23:36 | 0.411512    0.411226    0.983701    0.790722    0.921273    0.989186    0.705155    0.411512    0.411226    0.981137    0.877114    0.980780    0.789897    4200        47.579815   0.062704    0.395440    116.511000 
[37m[36mINFO[0m[0m 03/12 08:27:00 | 0.405212    0.394044    0.981500    0.794135    0.930296    0.980947    0.692784    0.405212    0.394044    0.985642    0.896280    0.977912    0.793341    4400        49.845520   0.068133    0.459461    111.747966 
[37m[36mINFO[0m[0m 03/12 08:30:26 | 0.408076    0.424971    0.985999    0.799932    0.875241    0.985582    0.701031    0.408076    0.424971    0.987331    0.898534    0.985083    0.800230    4600        52.111226   0.059919    0.448055    116.351519 
[37m[36mINFO[0m[0m 03/12 08:33:39 | 0.399771    0.400916    0.984671    0.800335    0.913783    0.985582    0.701031    0.399771    0.400916    0.985642    0.895152    0.982788    0.804822    4800        54.376931   0.056669    0.387262    115.493222 
[37m[36mINFO[0m[0m 03/12 08:36:55 | 0.417526    0.404353    0.989373    0.800102    0.876695    0.989186    0.696907    0.417526    0.404353    0.991554    0.896280    0.987378    0.807118    5000        56.642636   0.051718    0.404790    115.640867 
[37m[36mINFO[0m[0m 03/12 08:36:55 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[1]/250312_07-11-37_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/12 08:36:58 | ---
[37m[36mINFO[0m[0m 03/12 08:36:58 | test-domain validation(oracle) = 41.695%
[37m[36mINFO[0m[0m 03/12 08:36:58 | training-domain validation(iid) = 43.442%
[37m[36mINFO[0m[0m 03/12 08:36:58 | last = 41.753%
[37m[36mINFO[0m[0m 03/12 08:36:58 | last (inD) = 80.010%
[37m[36mINFO[0m[0m 03/12 08:36:58 | training-domain validation (iid, inD) = 80.309%
[37m[36mINFO[0m[0m 03/12 08:36:58 | === Summary ===
[37m[36mINFO[0m[0m 03/12 08:36:58 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 10
[37m[36mINFO[0m[0m 03/12 08:36:58 | Unique name: 250312_07-11-37_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 08:36:58 | Out path: train_output/OfficeHome/ERM/[1]/250312_07-11-37_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 08:36:58 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/12 08:36:58 | Dataset: OfficeHome

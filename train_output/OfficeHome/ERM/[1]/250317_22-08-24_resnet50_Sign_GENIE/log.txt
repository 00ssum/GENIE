[37m[36mINFO[0m[0m 03/17 22:08:24 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/OfficeHome/ERM/[1]/250317_22-08-24_resnet50_Sign_GENIE
	out_root: train_output/OfficeHome/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250317_22-08-24_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/17 22:08:24 | n_steps = 5001
[37m[36mINFO[0m[0m 03/17 22:08:24 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/17 22:08:24 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/17 22:08:24 | 
[37m[36mINFO[0m[0m 03/17 22:08:24 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/17 22:08:24 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/17 22:08:24 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/17 22:08:24 | Batch sizes for each domain: [32, 0, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/17 22:08:24 | steps-per-epoch for each domain: 60.69, 111.00, 108.94 -> min = 60.69
[37m[36mINFO[0m[0m 03/17 22:08:25 | # of params = 23641217
[37m[36mINFO[0m[0m 03/17 22:10:25 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/17 22:10:25 | 0.013173    0.010309    0.017625    0.018271    4.218161    0.024717    0.020619    0.013173    0.010309    0.012669    0.013529    0.015491    0.020666    0           0.000000    4.262303    2.529158    117.701762 
[37m[36mINFO[0m[0m 03/17 22:14:10 | 0.493414    0.489118    0.839738    0.789555    0.768260    0.822348    0.744330    0.493414    0.489118    0.859516    0.825254    0.837349    0.799082    200         3.295572    1.352847    0.537566    117.008407 
[37m[36mINFO[0m[0m 03/17 22:18:06 | 0.488259    0.478809    0.894848    0.805124    0.784706    0.891349    0.742268    0.488259    0.478809    0.907939    0.857948    0.885255    0.815155    400         6.591143    0.420498    0.566413    123.177428 
[37m[36mINFO[0m[0m 03/17 22:21:58 | 0.503436    0.500573    0.937614    0.802369    0.788436    0.948507    0.723711    0.503436    0.500573    0.938345    0.860203    0.925990    0.823192    600         9.886715    0.269718    0.556729    120.754153 
[37m[36mINFO[0m[0m 03/17 22:25:45 | 0.511741    0.495991    0.950879    0.822377    0.785305    0.961895    0.767010    0.511741    0.495991    0.952703    0.887260    0.938038    0.812859    800         13.182286   0.182453    0.527172    121.002083 
[37m[36mINFO[0m[0m 03/17 22:29:40 | 0.502005    0.491409    0.967258    0.820699    0.824548    0.973738    0.740206    0.502005    0.491409    0.967624    0.889515    0.960413    0.832377    1000        16.477858   0.142507    0.573807    120.360450 
[37m[36mINFO[0m[0m 03/17 22:33:30 | 0.489118    0.475372    0.972260    0.825161    0.829618    0.977343    0.764948    0.489118    0.475372    0.971565    0.882751    0.967871    0.827784    1200        19.773429   0.115542    0.546430    120.658437 
[37m[36mINFO[0m[0m 03/17 22:37:22 | 0.508305    0.493700    0.978491    0.827928    0.841322    0.985582    0.750515    0.508305    0.493700    0.980011    0.895152    0.969880    0.838117    1400        23.069001   0.076679    0.553742    121.676855 
[37m[36mINFO[0m[0m 03/17 22:41:12 | 0.507446    0.477663    0.974044    0.818539    0.964792    0.979918    0.736082    0.507446    0.477663    0.976351    0.892897    0.965863    0.826636    1600        26.364573   0.067564    0.549898    119.122928 
[37m[36mINFO[0m[0m 03/17 22:44:54 | 0.515464    0.517755    0.979255    0.810085    0.886759    0.983007    0.742268    0.515464    0.517755    0.980574    0.860203    0.974182    0.827784    1800        29.660144   0.059208    0.537751    115.341428 
[37m[36mINFO[0m[0m 03/17 22:48:40 | 0.522337    0.487973    0.985209    0.828971    0.971937    0.992276    0.752577    0.522337    0.487973    0.981137    0.899662    0.982215    0.834673    2000        32.955716   0.051774    0.536290    118.217664 
[37m[36mINFO[0m[0m 03/17 22:52:27 | 0.504868    0.486827    0.987156    0.823960    0.984977    0.990216    0.744330    0.504868    0.486827    0.988176    0.894025    0.983075    0.833525    2200        36.251287   0.049352    0.542512    118.369567 
[37m[36mINFO[0m[0m 03/17 22:56:13 | 0.533219    0.510882    0.987096    0.818800    0.976810    0.989186    0.740206    0.533219    0.510882    0.988739    0.887260    0.983362    0.828932    2400        39.546859   0.042658    0.554544    115.354996 
[37m[36mINFO[0m[0m 03/17 23:00:04 | 0.539233    0.508591    0.988098    0.826327    1.095347    0.990216    0.742268    0.539233    0.508591    0.990428    0.895152    0.983649    0.841561    2600        42.842430   0.042966    0.550255    120.753649 
[37m[36mINFO[0m[0m 03/17 23:03:46 | 0.526919    0.504009    0.987802    0.832806    1.016610    0.990731    0.760825    0.526919    0.504009    0.988739    0.909808    0.983936    0.827784    2800        46.138002   0.034333    0.523249    117.899099 
[37m[36mINFO[0m[0m 03/17 23:07:32 | 0.542955    0.522337    0.993634    0.839084    0.916773    0.994851    0.767010    0.542955    0.522337    0.994369    0.908681    0.991681    0.841561    3000        49.433574   0.027873    0.549984    115.185355 
[37m[36mINFO[0m[0m 03/17 23:11:13 | 0.523769    0.521191    0.989094    0.825247    0.983411    0.991761    0.752577    0.523769    0.521191    0.989865    0.882751    0.985657    0.840413    3200        52.729145   0.025385    0.524791    116.623590 
[37m[36mINFO[0m[0m 03/17 23:15:03 | 0.523482    0.507446    0.989632    0.817140    1.082858    0.992791    0.744330    0.523482    0.507446    0.989302    0.882751    0.986804    0.824340    3400        56.024717   0.030377    0.558897    118.486408 
[37m[36mINFO[0m[0m 03/17 23:18:51 | 0.533792    0.513173    0.991129    0.826312    1.021331    0.990731    0.752577    0.533792    0.513173    0.991836    0.896280    0.990820    0.830080    3600        59.320288   0.030318    0.544435    118.380153 
[37m[36mINFO[0m[0m 03/17 23:22:42 | 0.556128    0.528064    0.990688    0.823201    0.983563    0.992791    0.744330    0.556128    0.528064    0.988739    0.892897    0.990534    0.832377    3800        62.615860   0.027260    0.570685    117.208589 
[37m[36mINFO[0m[0m 03/17 23:26:32 | 0.533792    0.499427    0.993505    0.830075    1.049762    0.993306    0.754639    0.533792    0.499427    0.993806    0.894025    0.993402    0.841561    4000        65.911432   0.020207    0.562585    116.958962 
[37m[36mINFO[0m[0m 03/17 23:30:19 | 0.540378    0.508591    0.992809    0.824593    1.122250    0.993821    0.736082    0.540378    0.508591    0.994932    0.904171    0.989673    0.833525    4200        69.207003   0.017886    0.552967    116.828450 
[37m[36mINFO[0m[0m 03/17 23:34:06 | 0.523482    0.490263    0.992184    0.824879    1.125699    0.993306    0.760825    0.523482    0.490263    0.990991    0.891770    0.992255    0.822044    4400        72.502575   0.020858    0.549145    117.042611 
[37m[36mINFO[0m[0m 03/17 23:37:59 | 0.526919    0.518900    0.991568    0.819713    1.042325    0.991761    0.746392    0.526919    0.518900    0.991836    0.887260    0.991107    0.825488    4600        75.798146   0.020370    0.561029    120.580020 
[37m[36mINFO[0m[0m 03/17 23:41:46 | 0.529210    0.506300    0.993544    0.834817    1.025189    0.992276    0.769072    0.529210    0.506300    0.993806    0.905299    0.994550    0.830080    4800        79.093718   0.018795    0.541697    119.221899 
[37m[36mINFO[0m[0m 03/17 23:45:36 | 0.537514    0.516609    0.995135    0.841102    0.917109    0.995366    0.775258    0.537514    0.516609    0.995777    0.903044    0.994263    0.845006    5000        82.389289   0.017707    0.549589    120.236157 
[37m[36mINFO[0m[0m 03/17 23:45:37 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[1]/250317_22-08-24_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/17 23:45:39 | ---
[37m[36mINFO[0m[0m 03/17 23:45:39 | test-domain validation(oracle) = 55.613%
[37m[36mINFO[0m[0m 03/17 23:45:39 | training-domain validation(iid) = 53.751%
[37m[36mINFO[0m[0m 03/17 23:45:39 | last = 53.751%
[37m[36mINFO[0m[0m 03/17 23:45:39 | last (inD) = 84.110%
[37m[36mINFO[0m[0m 03/17 23:45:39 | training-domain validation (iid, inD) = 84.110%
[37m[36mINFO[0m[0m 03/17 23:45:39 | === Summary ===
[37m[36mINFO[0m[0m 03/17 23:45:39 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome
[37m[36mINFO[0m[0m 03/17 23:45:39 | Unique name: 250317_22-08-24_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/17 23:45:39 | Out path: train_output/OfficeHome/ERM/[1]/250317_22-08-24_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/17 23:45:39 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/17 23:45:39 | Dataset: OfficeHome

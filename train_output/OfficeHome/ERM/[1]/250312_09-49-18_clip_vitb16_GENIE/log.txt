[37m[36mINFO[0m[0m 03/12 09:49:18 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 1 --hparams_seed 4
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 4
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/OfficeHome/ERM/[1]/250312_09-49-18_clip_vitb16_GENIE
	out_root: train_output/OfficeHome/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250312_09-49-18_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 7.71168362195819e-05
	batch_size: 8
	weight_decay: 0.0007466379205516084
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/12 09:49:18 | n_steps = 5001
[37m[36mINFO[0m[0m 03/12 09:49:18 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/12 09:49:18 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/12 09:49:18 | 
[37m[36mINFO[0m[0m 03/12 09:49:18 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/12 09:49:18 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/12 09:49:18 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/12 09:49:18 | Batch sizes for each domain: [8, 0, 8, 8] (total=24)
[37m[36mINFO[0m[0m 03/12 09:49:18 | steps-per-epoch for each domain: 242.75, 444.00, 435.75 -> min = 242.75
[37m[36mINFO[0m[0m 03/12 09:49:20 | # of params = 86225985
[37m[36mINFO[0m[0m 03/12 09:51:19 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/12 09:51:19 | 0.026060    0.020619    0.013814    0.015254    4.205115    0.011329    0.008247    0.026060    0.020619    0.015484    0.020293    0.014630    0.017222    0           0.000000    4.249409    1.220893    117.586153 
[37m[36mINFO[0m[0m 03/12 09:53:55 | 0.023769    0.025200    0.038374    0.042744    4.038578    0.043254    0.057732    0.023769    0.025200    0.037444    0.037204    0.034423    0.033295    200         0.823893    4.120376    0.203429    115.568825 
[37m[36mINFO[0m[0m 03/12 09:56:34 | 0.041810    0.035510    0.065134    0.074580    3.924420    0.059217    0.092784    0.041810    0.035510    0.064471    0.058625    0.071715    0.072331    400         1.647786    4.032093    0.209445    116.741564 
[37m[36mINFO[0m[0m 03/12 09:59:18 | 0.057847    0.046964    0.099435    0.096120    3.758241    0.091658    0.096907    0.057847    0.046964    0.100507    0.077790    0.106139    0.113662    600         2.471679    3.883796    0.239609    116.393345 
[37m[36mINFO[0m[0m 03/12 10:02:02 | 0.104811    0.101947    0.197903    0.182401    3.234321    0.156540    0.142268    0.104811    0.101947    0.227759    0.206313    0.209409    0.198622    800         3.295572    3.518773    0.251222    113.542047 
[37m[36mINFO[0m[0m 03/12 10:04:44 | 0.175544    0.180985    0.338562    0.319227    2.659909    0.269825    0.243299    0.175544    0.180985    0.407939    0.360767    0.337923    0.353617    1000        4.119464    2.970838    0.225370    116.310417 
[37m[36mINFO[0m[0m 03/12 10:07:14 | 0.192726    0.200458    0.462523    0.417980    2.233408    0.382595    0.331959    0.192726    0.200458    0.540259    0.497182    0.464716    0.424799    1200        4.943357    2.395356    0.178684    114.302850 
[37m[36mINFO[0m[0m 03/12 10:09:46 | 0.237113    0.235968    0.509780    0.471559    2.049629    0.427909    0.371134    0.237113    0.235968    0.597128    0.567080    0.504303    0.476464    1400        5.767250    2.073483    0.161366    120.297963 
[37m[36mINFO[0m[0m 03/12 10:12:12 | 0.228809    0.245132    0.575481    0.509732    1.904708    0.496395    0.418557    0.228809    0.245132    0.667511    0.602029    0.562536    0.508611    1600        6.591143    1.848970    0.158023    114.040623 
[37m[36mINFO[0m[0m 03/12 10:14:41 | 0.236541    0.238259    0.568192    0.488136    1.941847    0.485067    0.371134    0.236541    0.238259    0.663570    0.609921    0.555938    0.483352    1800        7.415036    1.754941    0.156564    117.620100 
[37m[36mINFO[0m[0m 03/12 10:17:11 | 0.260309    0.254296    0.657097    0.570052    1.664660    0.602472    0.451546    0.260309    0.254296    0.731700    0.671928    0.637120    0.586682    2000        8.238929    1.576934    0.164777    117.083849 
[37m[36mINFO[0m[0m 03/12 10:19:48 | 0.230527    0.234822    0.627569    0.530593    1.846804    0.555613    0.404124    0.230527    0.234822    0.723536    0.659526    0.603557    0.528129    2200        9.062822    1.368864    0.184473    119.816702 
[37m[36mINFO[0m[0m 03/12 10:22:21 | 0.275487    0.286369    0.698287    0.569065    1.608031    0.650360    0.443299    0.275487    0.286369    0.779842    0.696731    0.664659    0.567164    2400        9.886715    1.327383    0.188993    116.087554 
[37m[36mINFO[0m[0m 03/12 10:24:55 | 0.243986    0.274914    0.724070    0.578382    1.560304    0.685891    0.451546    0.243986    0.274914    0.783221    0.686584    0.703098    0.597015    2600        10.710608   1.110212    0.187965    116.035063 
[37m[36mINFO[0m[0m 03/12 10:27:35 | 0.278351    0.294387    0.751572    0.604726    1.517807    0.717302    0.488660    0.278351    0.294387    0.811655    0.717024    0.725760    0.608496    2800        11.534501   1.022082    0.193346    121.315746 
[37m[36mINFO[0m[0m 03/12 10:30:09 | 0.276919    0.289805    0.748402    0.579016    1.571581    0.711637    0.451546    0.276919    0.289805    0.817849    0.708005    0.715720    0.577497    3000        12.358393   1.001987    0.203972    113.035636 
[37m[36mINFO[0m[0m 03/12 10:32:49 | 0.260882    0.281787    0.765511    0.589259    1.606805    0.737899    0.451546    0.260882    0.281787    0.812218    0.722661    0.746414    0.593571    3200        13.182286   0.915647    0.229866    113.931879 
[37m[36mINFO[0m[0m 03/12 10:35:33 | 0.293242    0.304696    0.798663    0.604329    1.548504    0.785788    0.463918    0.293242    0.304696    0.846002    0.747463    0.764200    0.601607    3400        14.006179   0.791105    0.252229    114.205944 
[37m[36mINFO[0m[0m 03/12 10:38:07 | 0.273482    0.269187    0.812730    0.619607    1.489328    0.799176    0.494845    0.273482    0.269187    0.854448    0.748591    0.784567    0.615385    3600        14.830072   0.805538    0.161837    121.582500 
[37m[36mINFO[0m[0m 03/12 10:40:52 | 0.294101    0.305842    0.832297    0.623851    1.432471    0.826982    0.488660    0.294101    0.305842    0.874155    0.781285    0.795754    0.601607    3800        15.653965   0.669686    0.253699    113.872167 
[37m[36mINFO[0m[0m 03/12 10:43:34 | 0.286655    0.296678    0.832965    0.619632    1.517395    0.818229    0.472165    0.286655    0.296678    0.881757    0.759865    0.798910    0.626866    4000        16.477858   0.636562    0.229265    115.949978 
[37m[36mINFO[0m[0m 03/12 10:46:02 | 0.309278    0.350515    0.872512    0.635338    1.416980    0.876931    0.498969    0.309278    0.350515    0.897804    0.779030    0.842800    0.628014    4200        17.301751   0.567259    0.157958    116.218924 
[37m[36mINFO[0m[0m 03/12 10:48:28 | 0.298969    0.316151    0.859236    0.637908    1.437858    0.854789    0.513402    0.298969    0.316151    0.892455    0.770011    0.830465    0.630310    4400        18.125644   0.507671    0.148855    116.258663 
[37m[36mINFO[0m[0m 03/12 10:51:03 | 0.317583    0.332188    0.872022    0.641361    1.425456    0.863543    0.511340    0.317583    0.332188    0.904561    0.781285    0.847963    0.631458    4600        18.949537   0.510260    0.192935    116.251534 
[37m[36mINFO[0m[0m 03/12 10:53:44 | 0.315578    0.334479    0.887937    0.640702    1.448185    0.881565    0.509278    0.315578    0.334479    0.910473    0.776776    0.871773    0.636051    4800        19.773429   0.443384    0.211540    118.797743 
[37m[36mINFO[0m[0m 03/12 10:56:31 | 0.307560    0.300115    0.905007    0.659941    1.409033    0.913491    0.546392    0.307560    0.300115    0.922297    0.780158    0.879231    0.653272    5000        20.597322   0.378028    0.252253    116.408630 
[37m[36mINFO[0m[0m 03/12 10:56:31 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[1]/250312_09-49-18_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/12 10:56:33 | ---
[37m[36mINFO[0m[0m 03/12 10:56:33 | test-domain validation(oracle) = 30.928%
[37m[36mINFO[0m[0m 03/12 10:56:33 | training-domain validation(iid) = 30.756%
[37m[36mINFO[0m[0m 03/12 10:56:33 | last = 30.756%
[37m[36mINFO[0m[0m 03/12 10:56:33 | last (inD) = 65.994%
[37m[36mINFO[0m[0m 03/12 10:56:33 | training-domain validation (iid, inD) = 65.994%
[37m[36mINFO[0m[0m 03/12 10:56:33 | === Summary ===
[37m[36mINFO[0m[0m 03/12 10:56:33 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 1 --hparams_seed 4
[37m[36mINFO[0m[0m 03/12 10:56:33 | Unique name: 250312_09-49-18_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 10:56:33 | Out path: train_output/OfficeHome/ERM/[1]/250312_09-49-18_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 10:56:33 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/12 10:56:33 | Dataset: OfficeHome

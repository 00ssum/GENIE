[37m[36mINFO[0m[0m 03/12 06:56:22 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 2 --hparams_seed 11
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 11
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/OfficeHome/ERM/[1]/250312_06-56-22_clip_vitb16_GENIE
	out_root: train_output/OfficeHome/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 2
	unique_name: 250312_06-56-22_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.00030079935666912124
	batch_size: 16
	weight_decay: 6.276702207693199e-06
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/12 06:56:22 | n_steps = 5001
[37m[36mINFO[0m[0m 03/12 06:56:22 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/12 06:56:22 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/12 06:56:22 | 
[37m[36mINFO[0m[0m 03/12 06:56:22 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/12 06:56:22 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/12 06:56:22 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/12 06:56:22 | Batch sizes for each domain: [16, 0, 16, 16] (total=48)
[37m[36mINFO[0m[0m 03/12 06:56:22 | steps-per-epoch for each domain: 121.38, 222.00, 217.88 -> min = 121.38
[37m[36mINFO[0m[0m 03/12 06:56:24 | # of params = 86225985
[37m[36mINFO[0m[0m 03/12 06:58:20 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/12 06:58:20 | 0.018614    0.012600    0.015317    0.015088    4.203283    0.014418    0.024742    0.018614    0.012600    0.016329    0.007892    0.015204    0.012629    0           0.000000    4.184824    1.012228    114.721222 
[37m[36mINFO[0m[0m 03/12 07:01:15 | 0.050115    0.036655    0.089417    0.083401    3.880727    0.096807    0.078351    0.050115    0.036655    0.081081    0.082300    0.090361    0.089552    200         1.647786    4.045094    0.293103    116.291875 
[37m[36mINFO[0m[0m 03/12 07:04:10 | 0.160367    0.171821    0.332237    0.301121    2.784902    0.286818    0.251546    0.160367    0.171821    0.383446    0.329200    0.326449    0.322618    400         3.295572    3.385532    0.293963    116.248029 
[37m[36mINFO[0m[0m 03/12 07:07:01 | 0.269759    0.260023    0.594709    0.558258    1.732786    0.528836    0.476289    0.269759    0.260023    0.667511    0.632469    0.587780    0.566016    600         4.943357    2.204061    0.294471    112.155411 
[37m[36mINFO[0m[0m 03/12 07:09:49 | 0.258305    0.254296    0.650835    0.572376    1.639398    0.596292    0.476289    0.258305    0.254296    0.700732    0.639233    0.655479    0.601607    800         6.591143    1.391884    0.279888    111.610754 
[37m[36mINFO[0m[0m 03/12 07:12:41 | 0.316724    0.303551    0.766815    0.661895    1.265716    0.723996    0.556701    0.316724    0.303551    0.825732    0.772266    0.750717    0.656716    1000        8.238929    1.037333    0.287505    115.062744 
[37m[36mINFO[0m[0m 03/12 07:15:35 | 0.324170    0.323024    0.803577    0.677045    1.199490    0.786818    0.571134    0.324170    0.323024    0.849099    0.771139    0.774814    0.688863    1200        9.886715    0.810117    0.293172    114.937376 
[37m[36mINFO[0m[0m 03/12 07:18:31 | 0.340779    0.329897    0.850305    0.714222    1.093993    0.832132    0.612371    0.340779    0.329897    0.883727    0.819617    0.835055    0.710677    1400        11.534501   0.653123    0.297721    116.688998 
[37m[36mINFO[0m[0m 03/12 07:21:25 | 0.341924    0.340206    0.874944    0.720654    1.045001    0.854274    0.616495    0.341924    0.340206    0.906532    0.806088    0.864028    0.739380    1600        13.182286   0.529330    0.278711    117.748495 
[37m[36mINFO[0m[0m 03/12 07:24:22 | 0.337915    0.344788    0.875251    0.709386    1.102778    0.866632    0.602062    0.337915    0.344788    0.904561    0.798196    0.854561    0.727899    1800        14.830072   0.415539    0.299222    117.157736 
[37m[36mINFO[0m[0m 03/12 07:27:18 | 0.344215    0.359679    0.899036    0.716357    1.135745    0.897528    0.595876    0.344215    0.359679    0.919200    0.822999    0.880379    0.730195    2000        16.477858   0.368425    0.299960    116.292184 
[37m[36mINFO[0m[0m 03/12 07:30:25 | 0.360252    0.356243    0.919703    0.728852    1.053451    0.922245    0.608247    0.360252    0.356243    0.934685    0.830891    0.902180    0.747417    2200        18.125644   0.305090    0.336696    119.963982 
[37m[36mINFO[0m[0m 03/12 07:33:36 | 0.389175    0.387171    0.947968    0.734479    1.004885    0.958290    0.620619    0.389175    0.387171    0.950732    0.835400    0.934882    0.747417    2400        19.773429   0.248686    0.373784    116.504116 
[37m[36mINFO[0m[0m 03/12 07:36:48 | 0.345074    0.349370    0.957418    0.742347    1.042766    0.967044    0.622680    0.345074    0.349370    0.961149    0.850056    0.944062    0.754305    2600        21.421215   0.183503    0.389231    114.038741 
[37m[36mINFO[0m[0m 03/12 07:40:08 | 0.385452    0.382589    0.955320    0.734430    1.051171    0.967559    0.620619    0.385452    0.382589    0.957207    0.843292    0.941193    0.739380    2800        23.069001   0.164435    0.423379    114.655906 
[37m[36mINFO[0m[0m 03/12 07:43:27 | 0.398912    0.400916    0.960156    0.744330    1.042189    0.964470    0.641237    0.398912    0.400916    0.967061    0.848929    0.948939    0.742824    3000        24.716787   0.165394    0.415804    116.607438 
[37m[36mINFO[0m[0m 03/12 07:46:41 | 0.358820    0.375716    0.963220    0.746046    1.018627    0.970134    0.626804    0.358820    0.375716    0.962556    0.845547    0.956971    0.765786    3200        26.364573   0.143091    0.365003    120.537434 
[37m[36mINFO[0m[0m 03/12 07:49:43 | 0.364548    0.389462    0.965369    0.748082    1.027516    0.967559    0.630928    0.364548    0.389462    0.971002    0.862458    0.957544    0.750861    3400        28.012358   0.131309    0.331766    115.398864 
[37m[36mINFO[0m[0m 03/12 07:52:37 | 0.397194    0.380298    0.974647    0.765027    0.944938    0.984037    0.647423    0.397194    0.380298    0.977196    0.868095    0.962708    0.779564    3600        29.660144   0.114205    0.282851    117.943498 
[37m[36mINFO[0m[0m 03/12 07:55:25 | 0.407503    0.402062    0.977686    0.769546    0.959890    0.984037    0.670103    0.407503    0.402062    0.980574    0.864713    0.968445    0.773823    3800        31.307930   0.098704    0.256327    116.266608 
[37m[36mINFO[0m[0m 03/12 07:58:18 | 0.385739    0.378007    0.976852    0.747085    1.032912    0.981462    0.641237    0.385739    0.378007    0.976633    0.836528    0.972461    0.763490    4000        32.955716   0.093150    0.296527    114.444655 
[37m[36mINFO[0m[0m 03/12 08:01:16 | 0.405498    0.381443    0.982967    0.777923    0.906059    0.988157    0.680412    0.405498    0.381443    0.982545    0.870349    0.978199    0.783008    4200        34.603502   0.068154    0.305589    116.576812 
[37m[36mINFO[0m[0m 03/12 08:04:15 | 0.392898    0.390607    0.972052    0.765644    1.047940    0.971164    0.659794    0.392898    0.390607    0.981137    0.878241    0.963855    0.758898    4400        36.251287   0.071961    0.327859    113.572982 
[37m[36mINFO[0m[0m 03/12 08:07:22 | 0.405212    0.387171    0.983290    0.768317    0.973841    0.981977    0.649485    0.405212    0.387171    0.983671    0.880496    0.984223    0.774971    4600        37.899073   0.063008    0.357703    114.778764 
[37m[36mINFO[0m[0m 03/12 08:10:36 | 0.363975    0.374570    0.973489    0.750866    1.084238    0.974253    0.639175    0.363975    0.374570    0.977196    0.856821    0.969019    0.756602    4800        39.546859   0.077817    0.389140    116.093175 
[37m[36mINFO[0m[0m 03/12 08:13:58 | 0.393184    0.395189    0.984867    0.756926    1.020798    0.987642    0.649485    0.393184    0.395189    0.987613    0.865840    0.979346    0.755454    5000        41.194645   0.065152    0.422268    117.914079 
[37m[36mINFO[0m[0m 03/12 08:13:58 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[1]/250312_06-56-22_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/12 08:14:00 | ---
[37m[36mINFO[0m[0m 03/12 08:14:00 | test-domain validation(oracle) = 40.750%
[37m[36mINFO[0m[0m 03/12 08:14:00 | training-domain validation(iid) = 40.550%
[37m[36mINFO[0m[0m 03/12 08:14:00 | last = 39.318%
[37m[36mINFO[0m[0m 03/12 08:14:00 | last (inD) = 75.693%
[37m[36mINFO[0m[0m 03/12 08:14:00 | training-domain validation (iid, inD) = 77.792%
[37m[36mINFO[0m[0m 03/12 08:14:00 | === Summary ===
[37m[36mINFO[0m[0m 03/12 08:14:00 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 2 --hparams_seed 11
[37m[36mINFO[0m[0m 03/12 08:14:00 | Unique name: 250312_06-56-22_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 08:14:00 | Out path: train_output/OfficeHome/ERM/[1]/250312_06-56-22_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 08:14:00 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/12 08:14:00 | Dataset: OfficeHome

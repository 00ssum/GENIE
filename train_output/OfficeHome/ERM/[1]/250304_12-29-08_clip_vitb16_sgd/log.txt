[37m[36mINFO[0m[0m 03/04 12:29:08 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_sgd config/clip_vitb16_sgd.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_sgd
	out_dir: train_output/OfficeHome/ERM/[1]/250304_12-29-08_clip_vitb16_sgd
	out_root: train_output/OfficeHome/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250304_12-29-08_clip_vitb16_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: clip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/04 12:29:08 | n_steps = 5001
[37m[36mINFO[0m[0m 03/04 12:29:08 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/04 12:29:08 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/04 12:29:08 | 
[37m[36mINFO[0m[0m 03/04 12:29:08 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/04 12:29:08 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/04 12:29:08 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/04 12:29:08 | Batch sizes for each domain: [32, 0, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/04 12:29:08 | steps-per-epoch for each domain: 60.69, 111.00, 108.94 -> min = 60.69
[37m[36mINFO[0m[0m 03/04 12:29:11 | # of params = 86225985
[37m[36mINFO[0m[0m 03/04 12:31:04 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/04 12:31:04 | 0.019473    0.020619    0.017509    0.020326    4.201583    0.013903    0.026804    0.019473    0.020619    0.020552    0.014656    0.018072    0.019518    0           0.000000    4.191761    1.121928    111.972186 
[37m[36mINFO[0m[0m 03/04 12:34:39 | 0.024055    0.021764    0.025945    0.029769    4.161920    0.019053    0.026804    0.024055    0.021764    0.031532    0.034949    0.027252    0.027555    200         3.295572    4.176634    0.513952    112.084686 
[37m[36mINFO[0m[0m 03/04 12:38:16 | 0.029782    0.035510    0.053555    0.047227    4.125635    0.053038    0.047423    0.029782    0.035510    0.057714    0.056370    0.049914    0.037887    400         6.591143    4.138962    0.530464    111.353369 
[37m[36mINFO[0m[0m 03/04 12:41:51 | 0.039805    0.044674    0.076626    0.073027    4.088651    0.075695    0.068041    0.039805    0.044674    0.083615    0.090192    0.070568    0.060850    600         9.886715    4.102710    0.512101    111.858213 
[37m[36mINFO[0m[0m 03/04 12:45:29 | 0.054124    0.052692    0.107994    0.094453    4.050836    0.105046    0.094845    0.054124    0.052692    0.117962    0.112740    0.100975    0.075775    800         13.182286   4.062887    0.511087    116.227326 
[37m[36mINFO[0m[0m 03/04 12:48:59 | 0.075888    0.069874    0.136554    0.132231    4.012664    0.131308    0.131959    0.075888    0.069874    0.146396    0.151071    0.131956    0.113662    1000        16.477858   4.023173    0.488250    112.103845 
[37m[36mINFO[0m[0m 03/04 12:52:33 | 0.100229    0.093929    0.172518    0.167492    3.973097    0.165294    0.164948    0.100229    0.093929    0.182151    0.188275    0.170109    0.149254    1200        19.773429   3.984029    0.509717    112.279611 
[37m[36mINFO[0m[0m 03/04 12:56:09 | 0.116838    0.114548    0.207902    0.203787    3.929881    0.194130    0.202062    0.116838    0.114548    0.219595    0.218715    0.209983    0.190586    1400        23.069001   3.939762    0.529098    110.015363 
[37m[36mINFO[0m[0m 03/04 12:59:43 | 0.141753    0.135166    0.248173    0.235214    3.884618    0.226571    0.226804    0.141753    0.135166    0.264077    0.245772    0.253873    0.233065    1600        26.364573   3.891491    0.510457    112.222302 
[37m[36mINFO[0m[0m 03/04 13:03:19 | 0.166667    0.161512    0.298606    0.284670    3.834681    0.267250    0.253608    0.166667    0.161512    0.330518    0.315671    0.298049    0.284730    1800        29.660144   3.844845    0.523199    110.681141 
[37m[36mINFO[0m[0m 03/04 13:06:53 | 0.196449    0.191294    0.348079    0.336682    3.781486    0.316684    0.294845    0.196449    0.191294    0.375000    0.378805    0.352553    0.336395    2000        32.955716   3.794797    0.504837    113.196817 
[37m[36mINFO[0m[0m 03/04 13:10:28 | 0.235395    0.245132    0.393472    0.382807    3.724780    0.365088    0.334021    0.235395    0.245132    0.420608    0.416009    0.394722    0.398393    2200        36.251287   3.742347    0.521056    110.760714 
[37m[36mINFO[0m[0m 03/04 13:14:05 | 0.268328    0.258877    0.438631    0.417883    3.663027    0.412976    0.373196    0.268328    0.258877    0.461149    0.445321    0.441767    0.435132    2400        39.546859   3.679233    0.527084    111.696734 
[37m[36mINFO[0m[0m 03/04 13:17:38 | 0.302405    0.288660    0.469623    0.453215    3.599209    0.439238    0.414433    0.302405    0.288660    0.498029    0.482525    0.471601    0.462687    2600        42.842430   3.610863    0.518345    109.533321 
[37m[36mINFO[0m[0m 03/04 13:21:11 | 0.329897    0.320733    0.517549    0.493217    3.528667    0.500000    0.453608    0.329897    0.320733    0.537444    0.519729    0.515204    0.506315    2800        46.138002   3.538907    0.515166    109.668383 
[37m[36mINFO[0m[0m 03/04 13:24:48 | 0.343643    0.335624    0.538922    0.524561    3.454388    0.513388    0.478351    0.343643    0.335624    0.570101    0.560316    0.533276    0.535017    3000        49.433574   3.466101    0.531211    111.372406 
[37m[36mINFO[0m[0m 03/04 13:28:23 | 0.363688    0.359679    0.576024    0.553436    3.381802    0.542225    0.509278    0.363688    0.359679    0.608108    0.590755    0.577740    0.560276    3200        52.729145   3.397770    0.513586    111.772828 
[37m[36mINFO[0m[0m 03/04 13:31:57 | 0.380584    0.374570    0.606610    0.582079    3.301037    0.580844    0.525773    0.380584    0.374570    0.634854    0.623450    0.604131    0.597015    3400        56.024717   3.318336    0.517330    110.377480 
[37m[36mINFO[0m[0m 03/04 13:35:35 | 0.400916    0.403207    0.637827    0.615106    3.221284    0.612255    0.569072    0.400916    0.403207    0.665541    0.649380    0.635686    0.626866    3600        59.320288   3.246011    0.534178    111.466199 
[37m[36mINFO[0m[0m 03/04 13:39:09 | 0.422394    0.424971    0.655078    0.633909    3.144395    0.632338    0.585567    0.422394    0.424971    0.674550    0.664036    0.658348    0.652124    3800        62.615860   3.168735    0.515031    111.271378 
[37m[36mINFO[0m[0m 03/04 13:42:45 | 0.442153    0.450172    0.679415    0.663980    3.059224    0.657055    0.626804    0.442153    0.450172    0.699606    0.685457    0.681583    0.679679    4000        65.911432   3.075893    0.521392    111.069545 
[37m[36mINFO[0m[0m 03/04 13:46:21 | 0.459622    0.458190    0.701769    0.678546    2.978110    0.684346    0.643299    0.459622    0.458190    0.720158    0.704622    0.700803    0.687715    4200        69.207003   3.010004    0.531363    109.898400 
[37m[36mINFO[0m[0m 03/04 13:49:55 | 0.474513    0.470790    0.711861    0.691863    2.896938    0.696189    0.653608    0.474513    0.470790    0.731419    0.715896    0.707975    0.706085    4400        72.502575   2.909588    0.513299    111.610714 
[37m[36mINFO[0m[0m 03/04 13:53:26 | 0.488545    0.476518    0.725434    0.702559    2.820222    0.708548    0.661856    0.488545    0.476518    0.748592    0.730552    0.719162    0.715270    4600        75.798146   2.858374    0.503887    110.624937 
[37m[36mINFO[0m[0m 03/04 13:57:00 | 0.500000    0.485682    0.736776    0.712713    2.747628    0.722966    0.686598    0.500000    0.485682    0.758446    0.731680    0.728916    0.719862    4800        79.093718   2.867242    0.503498    112.498250 
[37m[36mINFO[0m[0m 03/04 14:00:32 | 0.511168    0.498282    0.747113    0.729143    2.670417    0.739959    0.694845    0.511168    0.498282    0.760417    0.747463    0.740964    0.745121    5000        82.389289   2.690051    0.503590    111.975439 
[37m[36mINFO[0m[0m 03/04 14:00:33 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[1]/250304_12-29-08_clip_vitb16_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/04 14:00:36 | ---
[37m[36mINFO[0m[0m 03/04 14:00:36 | test-domain validation(oracle) = 51.117%
[37m[36mINFO[0m[0m 03/04 14:00:36 | training-domain validation(iid) = 51.117%
[37m[36mINFO[0m[0m 03/04 14:00:36 | last = 51.117%
[37m[36mINFO[0m[0m 03/04 14:00:36 | last (inD) = 72.914%
[37m[36mINFO[0m[0m 03/04 14:00:36 | training-domain validation (iid, inD) = 72.914%
[37m[36mINFO[0m[0m 03/04 14:00:36 | === Summary ===
[37m[36mINFO[0m[0m 03/04 14:00:36 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_sgd config/clip_vitb16_sgd.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome
[37m[36mINFO[0m[0m 03/04 14:00:36 | Unique name: 250304_12-29-08_clip_vitb16_sgd
[37m[36mINFO[0m[0m 03/04 14:00:36 | Out path: train_output/OfficeHome/ERM/[1]/250304_12-29-08_clip_vitb16_sgd
[37m[36mINFO[0m[0m 03/04 14:00:36 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/04 14:00:36 | Dataset: OfficeHome

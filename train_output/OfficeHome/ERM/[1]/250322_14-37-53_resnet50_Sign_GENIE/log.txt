[37m[36mINFO[0m[0m 03/22 14:37:53 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 8
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 8
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/OfficeHome/ERM/[1]/250322_14-37-53_resnet50_Sign_GENIE
	out_root: train_output/OfficeHome/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250322_14-37-53_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.9932388835350315e-05
	batch_size: 16
	weight_decay: 0.0025315391809104006
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/22 14:37:53 | n_steps = 5001
[37m[36mINFO[0m[0m 03/22 14:37:53 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/22 14:37:53 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/22 14:37:53 | 
[37m[36mINFO[0m[0m 03/22 14:37:53 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/22 14:37:53 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/22 14:37:53 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/22 14:37:53 | Batch sizes for each domain: [16, 0, 16, 16] (total=48)
[37m[36mINFO[0m[0m 03/22 14:37:53 | steps-per-epoch for each domain: 121.38, 222.00, 217.88 -> min = 121.38
[37m[36mINFO[0m[0m 03/22 14:37:55 | # of params = 23641217
[37m[36mINFO[0m[0m 03/22 14:39:58 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/22 14:39:58 | 0.019473    0.014891    0.020115    0.019094    4.216279    0.024202    0.018557    0.019473    0.014891    0.015203    0.016911    0.020941    0.021814    0           0.000000    4.286860    2.261617    120.665735 
[37m[36mINFO[0m[0m 03/22 14:42:49 | 0.475372    0.457045    0.770032    0.742151    0.971762    0.727085    0.701031    0.475372    0.457045    0.797297    0.772266    0.785714    0.753157    200         1.647786    1.697852    0.291205    113.153499 
[37m[36mINFO[0m[0m 03/22 14:45:48 | 0.484250    0.483391    0.842150    0.764531    0.859356    0.820803    0.701031    0.484250    0.483391    0.865428    0.804961    0.840218    0.787600    400         3.295572    0.693011    0.295717    119.746665 
[37m[36mINFO[0m[0m 03/22 14:48:39 | 0.508018    0.512027    0.880529    0.795114    0.769258    0.880536    0.746392    0.508018    0.512027    0.893581    0.842165    0.867470    0.796785    600         4.943357    0.503141    0.282432    114.486039 
[37m[36mINFO[0m[0m 03/22 14:51:30 | 0.506014    0.489118    0.892817    0.773851    0.865403    0.883625    0.690722    0.506014    0.489118    0.912725    0.846674    0.882100    0.784156    800         6.591143    0.397735    0.272093    116.283525 
[37m[36mINFO[0m[0m 03/22 14:54:21 | 0.495991    0.494845    0.905223    0.788598    0.876260    0.899073    0.705155    0.495991    0.494845    0.914414    0.848929    0.902180    0.811711    1000        8.238929    0.327363    0.259140    118.983648 
[37m[36mINFO[0m[0m 03/22 14:57:15 | 0.489977    0.457045    0.926994    0.809099    0.801206    0.942842    0.748454    0.489977    0.457045    0.927928    0.857948    0.910212    0.820896    1200        9.886715    0.271569    0.286283    117.368242 
[37m[36mINFO[0m[0m 03/22 15:00:09 | 0.499427    0.499427    0.938023    0.811127    0.762720    0.946962    0.744330    0.499427    0.499427    0.943412    0.864713    0.923695    0.824340    1400        11.534501   0.243158    0.260879    121.132122 
[37m[36mINFO[0m[0m 03/22 15:02:57 | 0.519187    0.507446    0.944943    0.807736    0.856996    0.947992    0.740206    0.519187    0.507446    0.946791    0.881623    0.940046    0.801378    1600        13.182286   0.213253    0.260265    116.586407 
[37m[36mINFO[0m[0m 03/22 15:05:47 | 0.488545    0.467354    0.955050    0.801206    0.800609    0.970649    0.734021    0.488545    0.467354    0.951014    0.861330    0.943488    0.808266    1800        14.830072   0.186149    0.261499    116.913560 
[37m[36mINFO[0m[0m 03/22 15:08:44 | 0.528064    0.492554    0.939659    0.793821    0.913522    0.947992    0.727835    0.528064    0.492554    0.950732    0.855693    0.920252    0.797933    2000        16.477858   0.136286    0.294897    118.893738 
[37m[36mINFO[0m[0m 03/22 15:11:39 | 0.495418    0.475372    0.952949    0.801392    0.883941    0.959320    0.727835    0.495418    0.475372    0.958333    0.869222    0.941193    0.807118    2200        18.125644   0.136653    0.275915    119.656943 
[37m[36mINFO[0m[0m 03/22 15:14:35 | 0.533219    0.522337    0.972022    0.815149    0.804250    0.978373    0.746392    0.533219    0.522337    0.972691    0.882751    0.965003    0.816303    2400        19.773429   0.134981    0.288479    117.784455 
[37m[36mINFO[0m[0m 03/22 15:17:26 | 0.510882    0.504009    0.971411    0.822971    0.844296    0.978888    0.762887    0.510882    0.504009    0.975507    0.878241    0.959839    0.827784    2600        21.421215   0.113032    0.267156    117.356155 
[37m[36mINFO[0m[0m 03/22 15:20:17 | 0.515750    0.512027    0.973293    0.814479    0.856989    0.983007    0.756701    0.515750    0.512027    0.970721    0.865840    0.966150    0.820896    2800        23.069001   0.107636    0.266278    117.706343 
[37m[36mINFO[0m[0m 03/22 15:23:05 | 0.511168    0.486827    0.967125    0.800548    0.892181    0.969619    0.729897    0.511168    0.486827    0.968187    0.869222    0.963569    0.802526    3000        24.716787   0.109984    0.262096    116.008239 
[37m[36mINFO[0m[0m 03/22 15:25:54 | 0.528637    0.512027    0.969674    0.804242    0.903408    0.972709    0.731959    0.528637    0.512027    0.969876    0.878241    0.966437    0.802526    3200        26.364573   0.116952    0.250880    118.916693 
[37m[36mINFO[0m[0m 03/22 15:28:44 | 0.563001    0.542955    0.978114    0.832407    0.838486    0.982492    0.762887    0.563001    0.542955    0.982545    0.899662    0.969306    0.834673    3400        28.012358   0.093724    0.267878    116.669258 
[37m[36mINFO[0m[0m 03/22 15:31:34 | 0.517755    0.489118    0.958954    0.801881    1.033165    0.959320    0.734021    0.517755    0.489118    0.961430    0.875986    0.956110    0.795637    3600        29.660144   0.080100    0.269899    115.610467 
[37m[36mINFO[0m[0m 03/22 15:34:25 | 0.538660    0.518900    0.978835    0.817997    0.888976    0.984037    0.752577    0.538660    0.518900    0.980293    0.879369    0.972174    0.822044    3800        31.307930   0.084423    0.264091    118.178452 
[37m[36mINFO[0m[0m 03/22 15:37:18 | 0.532073    0.518900    0.987425    0.826140    0.861178    0.991246    0.758763    0.532073    0.518900    0.984797    0.886133    0.986231    0.833525    4000        32.955716   0.076309    0.272345    118.562165 
[37m[36mINFO[0m[0m 03/22 15:40:10 | 0.495132    0.466208    0.968933    0.806490    0.949551    0.975283    0.713402    0.495132    0.466208    0.965653    0.875986    0.965863    0.830080    4200        34.603502   0.064441    0.283756    115.330298 
[37m[36mINFO[0m[0m 03/22 15:43:01 | 0.541237    0.518900    0.985316    0.821166    0.816225    0.989186    0.748454    0.541237    0.518900    0.982827    0.887260    0.983936    0.827784    4400        36.251287   0.076097    0.268037    116.895740 
[37m[36mINFO[0m[0m 03/22 15:45:49 | 0.513746    0.498282    0.981621    0.814082    0.872554    0.988157    0.731959    0.513746    0.498282    0.983671    0.896280    0.973035    0.814007    4600        37.899073   0.070910    0.265886    115.016268 
[37m[36mINFO[0m[0m 03/22 15:48:40 | 0.525487    0.520046    0.983712    0.811018    0.892423    0.983007    0.734021    0.525487    0.520046    0.986486    0.883878    0.981641    0.815155    4800        39.546859   0.062385    0.267109    117.511541 
[37m[36mINFO[0m[0m 03/22 15:51:30 | 0.524628    0.505155    0.987124    0.816346    0.932608    0.990731    0.754639    0.524628    0.505155    0.990146    0.886133    0.980493    0.808266    5000        41.194645   0.053969    0.273787    115.421476 
[37m[36mINFO[0m[0m 03/22 15:51:30 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[1]/250322_14-37-53_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/22 15:51:31 | ---
[37m[36mINFO[0m[0m 03/22 15:51:31 | test-domain validation(oracle) = 56.300%
[37m[36mINFO[0m[0m 03/22 15:51:31 | training-domain validation(iid) = 56.300%
[37m[36mINFO[0m[0m 03/22 15:51:31 | last = 52.463%
[37m[36mINFO[0m[0m 03/22 15:51:31 | last (inD) = 81.635%
[37m[36mINFO[0m[0m 03/22 15:51:31 | training-domain validation (iid, inD) = 83.241%
[37m[36mINFO[0m[0m 03/22 15:51:31 | === Summary ===
[37m[36mINFO[0m[0m 03/22 15:51:31 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 8
[37m[36mINFO[0m[0m 03/22 15:51:31 | Unique name: 250322_14-37-53_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/22 15:51:31 | Out path: train_output/OfficeHome/ERM/[1]/250322_14-37-53_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/22 15:51:31 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/22 15:51:31 | Dataset: OfficeHome

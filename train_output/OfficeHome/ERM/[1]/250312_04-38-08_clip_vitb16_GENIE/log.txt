[37m[36mINFO[0m[0m 03/12 04:38:08 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 1 --hparams_seed 17
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 17
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/OfficeHome/ERM/[1]/250312_04-38-08_clip_vitb16_GENIE
	out_root: train_output/OfficeHome/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250312_04-38-08_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.0002990700776954947
	batch_size: 8
	weight_decay: 4.0966675521600606e-05
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/12 04:38:08 | n_steps = 5001
[37m[36mINFO[0m[0m 03/12 04:38:08 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/12 04:38:08 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/12 04:38:08 | 
[37m[36mINFO[0m[0m 03/12 04:38:08 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/12 04:38:08 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/12 04:38:08 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/12 04:38:08 | Batch sizes for each domain: [8, 0, 8, 8] (total=24)
[37m[36mINFO[0m[0m 03/12 04:38:08 | steps-per-epoch for each domain: 242.75, 444.00, 435.75 -> min = 242.75
[37m[36mINFO[0m[0m 03/12 04:38:10 | # of params = 86225985
[37m[36mINFO[0m[0m 03/12 04:40:08 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/12 04:40:08 | 0.025487    0.019473    0.013000    0.014191    4.205474    0.010299    0.006186    0.025487    0.019473    0.014358    0.019166    0.014343    0.017222    0           0.000000    4.249409    1.058531    116.698777 
[37m[36mINFO[0m[0m 03/12 04:42:39 | 0.033505    0.030928    0.055354    0.062213    4.002129    0.052523    0.076289    0.033505    0.030928    0.063626    0.055242    0.049914    0.055109    200         0.823893    4.113902    0.174172    116.351297 
[37m[36mINFO[0m[0m 03/12 04:45:11 | 0.063860    0.059565    0.098708    0.104513    3.684026    0.084449    0.105155    0.063860    0.059565    0.107545    0.093574    0.104131    0.114811    400         1.647786    3.927965    0.166453    118.837071 
[37m[36mINFO[0m[0m 03/12 04:47:37 | 0.136884    0.128293    0.228177    0.205890    3.115279    0.194130    0.164948    0.136884    0.128293    0.249437    0.229989    0.240964    0.222732    600         2.471679    3.487000    0.152273    115.201951 
[37m[36mINFO[0m[0m 03/12 04:50:12 | 0.176403    0.175258    0.380708    0.343171    2.487789    0.304840    0.272165    0.176403    0.175258    0.442849    0.396843    0.394435    0.360505    800         3.295572    2.847241    0.189636    117.292951 
[37m[36mINFO[0m[0m 03/12 04:52:50 | 0.215349    0.207331    0.484287    0.430379    2.175294    0.414006    0.340206    0.215349    0.207331    0.553773    0.483653    0.485083    0.467279    1000        4.119464    2.325496    0.199525    118.468481 
[37m[36mINFO[0m[0m 03/12 04:55:35 | 0.235968    0.252005    0.547996    0.497233    1.885569    0.466014    0.385567    0.235968    0.252005    0.630068    0.597520    0.547906    0.508611    1200        4.943357    1.974837    0.237426    116.802754 
[37m[36mINFO[0m[0m 03/12 04:58:19 | 0.240263    0.238259    0.581763    0.517094    1.891753    0.496910    0.402062    0.240263    0.238259    0.668919    0.626832    0.579461    0.522388    1400        5.767250    1.734038    0.256171    112.912883 
[37m[36mINFO[0m[0m 03/12 05:00:55 | 0.248568    0.273769    0.637293    0.532457    1.747129    0.572606    0.420619    0.248568    0.273769    0.716498    0.627959    0.622777    0.548794    1600        6.591143    1.606779    0.204213    115.421432 
[37m[36mINFO[0m[0m 03/12 05:03:32 | 0.248568    0.266896    0.631061    0.541656    1.767149    0.552523    0.414433    0.248568    0.266896    0.719032    0.664036    0.621629    0.546498    1800        7.415036    1.457317    0.180911    120.564109 
[37m[36mINFO[0m[0m 03/12 05:06:00 | 0.269473    0.270332    0.687902    0.566926    1.645508    0.635427    0.428866    0.269473    0.270332    0.757883    0.697858    0.670396    0.574053    2000        8.238929    1.384077    0.160000    115.839092 
[37m[36mINFO[0m[0m 03/12 05:08:34 | 0.287801    0.255441    0.688502    0.555742    1.718039    0.613285    0.412371    0.287801    0.255441    0.781250    0.688839    0.670970    0.566016    2200        9.062822    1.249831    0.170996    120.651387 
[37m[36mINFO[0m[0m 03/12 05:11:08 | 0.295246    0.305842    0.738389    0.588408    1.540664    0.681256    0.463918    0.295246    0.305842    0.815034    0.722661    0.718876    0.578645    2400        9.886715    1.154255    0.196906    114.706500 
[37m[36mINFO[0m[0m 03/12 05:13:46 | 0.273769    0.298969    0.763308    0.613740    1.493512    0.720391    0.503093    0.273769    0.298969    0.827421    0.718151    0.742111    0.619977    2600        10.710608   1.010605    0.212922    114.690401 
[37m[36mINFO[0m[0m 03/12 05:16:32 | 0.311283    0.342497    0.779878    0.622632    1.490205    0.744593    0.496907    0.311283    0.342497    0.843750    0.741826    0.751291    0.629162    2800        11.534501   0.971686    0.240577    118.498691 
[37m[36mINFO[0m[0m 03/12 05:19:16 | 0.305556    0.336770    0.797396    0.635355    1.432453    0.772915    0.511340    0.305556    0.336770    0.851633    0.762120    0.767642    0.632606    3000        12.358393   0.799589    0.252967    112.781619 
[37m[36mINFO[0m[0m 03/12 05:21:53 | 0.321019    0.334479    0.811208    0.631278    1.438562    0.782183    0.519588    0.321019    0.334479    0.864865    0.751973    0.786575    0.622273    3200        13.182286   0.801821    0.205772    116.221524 
[37m[36mINFO[0m[0m 03/12 05:24:25 | 0.317297    0.352806    0.819266    0.629953    1.444842    0.805870    0.505155    0.317297    0.352806    0.854167    0.745209    0.797762    0.639495    3400        14.006179   0.697923    0.175236    116.328738 
[37m[36mINFO[0m[0m 03/12 05:26:55 | 0.288946    0.295533    0.810378    0.621173    1.512535    0.793512    0.503093    0.288946    0.295533    0.852196    0.754228    0.785427    0.606200    3600        14.830072   0.704219    0.159876    118.058092 
[37m[36mINFO[0m[0m 03/12 05:29:26 | 0.325888    0.345934    0.853938    0.639248    1.415272    0.846550    0.517526    0.325888    0.345934    0.887669    0.775648    0.827596    0.624569    3800        15.653965   0.635481    0.170187    117.794958 
[37m[36mINFO[0m[0m 03/12 05:32:02 | 0.314433    0.308133    0.861521    0.633921    1.439943    0.859423    0.505155    0.314433    0.308133    0.896396    0.784667    0.828744    0.611940    4000        16.477858   0.542199    0.193662    116.715584 
[37m[36mINFO[0m[0m 03/12 05:34:40 | 0.321879    0.311569    0.888247    0.653225    1.358321    0.896498    0.529897    0.321879    0.311569    0.907658    0.791432    0.860585    0.638347    4200        17.301751   0.506962    0.208643    116.522736 
[37m[36mINFO[0m[0m 03/12 05:37:29 | 0.327033    0.324170    0.893912    0.654626    1.371651    0.902163    0.501031    0.327033    0.324170    0.915259    0.803833    0.864314    0.659013    4400        18.125644   0.483384    0.252572    118.751541 
[37m[36mINFO[0m[0m 03/12 05:40:14 | 0.322738    0.311569    0.894128    0.663631    1.355544    0.904737    0.560825    0.322738    0.311569    0.911036    0.775648    0.866609    0.654420    4600        18.949537   0.430212    0.252022    114.262145 
[37m[36mINFO[0m[0m 03/12 05:42:54 | 0.306415    0.324170    0.895046    0.665221    1.377647    0.906282    0.556701    0.306415    0.324170    0.907658    0.791432    0.871199    0.647532    4800        19.773429   0.373818    0.201338    120.052469 
[37m[36mINFO[0m[0m 03/12 05:45:24 | 0.329611    0.347079    0.912617    0.665774    1.329192    0.928939    0.552577    0.329611    0.347079    0.926239    0.789177    0.882674    0.655568    5000        20.597322   0.341115    0.170623    115.830378 
[37m[36mINFO[0m[0m 03/12 05:45:25 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[1]/250312_04-38-08_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/12 05:45:27 | ---
[37m[36mINFO[0m[0m 03/12 05:45:27 | test-domain validation(oracle) = 31.730%
[37m[36mINFO[0m[0m 03/12 05:45:27 | training-domain validation(iid) = 32.961%
[37m[36mINFO[0m[0m 03/12 05:45:27 | last = 32.961%
[37m[36mINFO[0m[0m 03/12 05:45:27 | last (inD) = 66.577%
[37m[36mINFO[0m[0m 03/12 05:45:27 | training-domain validation (iid, inD) = 66.577%
[37m[36mINFO[0m[0m 03/12 05:45:27 | === Summary ===
[37m[36mINFO[0m[0m 03/12 05:45:27 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 1 --hparams_seed 17
[37m[36mINFO[0m[0m 03/12 05:45:27 | Unique name: 250312_04-38-08_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 05:45:27 | Out path: train_output/OfficeHome/ERM/[1]/250312_04-38-08_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 05:45:27 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/12 05:45:27 | Dataset: OfficeHome

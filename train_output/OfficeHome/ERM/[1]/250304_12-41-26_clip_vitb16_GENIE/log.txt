[37m[36mINFO[0m[0m 03/04 12:41:26 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/OfficeHome/ERM/[1]/250304_12-41-26_clip_vitb16_GENIE
	out_root: train_output/OfficeHome/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250304_12-41-26_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: clip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/04 12:41:26 | n_steps = 5001
[37m[36mINFO[0m[0m 03/04 12:41:26 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/04 12:41:26 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/04 12:41:26 | 
[37m[36mINFO[0m[0m 03/04 12:41:26 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/04 12:41:26 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/04 12:41:26 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/04 12:41:26 | Batch sizes for each domain: [32, 0, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/04 12:41:26 | steps-per-epoch for each domain: 60.69, 111.00, 108.94 -> min = 60.69
[37m[36mINFO[0m[0m 03/04 12:41:29 | # of params = 86225985
[37m[36mINFO[0m[0m 03/04 12:43:25 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/04 12:43:25 | 0.010882    0.006873    0.018335    0.017306    4.197326    0.021112    0.026804    0.010882    0.006873    0.012950    0.007892    0.020941    0.017222    0           0.000000    4.191761    1.116163    115.143586 
[37m[36mINFO[0m[0m 03/04 12:47:01 | 0.044960    0.049255    0.076346    0.074647    3.891619    0.071061    0.078351    0.044960    0.049255    0.080236    0.074408    0.077740    0.071183    200         3.295572    4.048382    0.512845    113.601243 
[37m[36mINFO[0m[0m 03/04 12:50:37 | 0.153207    0.178694    0.334367    0.324003    2.679975    0.297631    0.309278    0.153207    0.178694    0.359516    0.297632    0.345955    0.365098    400         6.591143    3.330095    0.514175    113.329075 
[37m[36mINFO[0m[0m 03/04 12:54:11 | 0.290378    0.298969    0.692520    0.643982    1.396905    0.644181    0.564948    0.290378    0.298969    0.746059    0.709132    0.687321    0.657865    600         9.886715    1.872982    0.499474    113.767598 
[37m[36mINFO[0m[0m 03/04 12:57:47 | 0.328179    0.340206    0.764197    0.679835    1.250515    0.730690    0.589691    0.328179    0.340206    0.806306    0.763247    0.755594    0.686567    800         13.182286   1.047874    0.503190    115.734127 
[37m[36mINFO[0m[0m 03/04 13:01:19 | 0.325601    0.371134    0.824998    0.688189    1.164847    0.805870    0.602062    0.325601    0.371134    0.855011    0.759865    0.814114    0.702641    1000        16.477858   0.738050    0.483711    114.953361 
[37m[36mINFO[0m[0m 03/04 13:04:54 | 0.331042    0.326460    0.846203    0.698496    1.137841    0.845520    0.610309    0.331042    0.326460    0.862050    0.775648    0.831038    0.709529    1200        19.773429   0.552059    0.502912    114.706600 
[37m[36mINFO[0m[0m 03/04 13:08:33 | 0.356243    0.349370    0.910610    0.744683    1.049967    0.919670    0.643299    0.356243    0.349370    0.921453    0.841037    0.890706    0.749713    1400        23.069001   0.382157    0.517945    114.557375 
[37m[36mINFO[0m[0m 03/04 13:12:07 | 0.360825    0.357388    0.923710    0.737976    1.055841    0.926365    0.641237    0.360825    0.357388    0.926520    0.824126    0.918244    0.748565    1600        26.364573   0.284489    0.493741    115.496571 
[37m[36mINFO[0m[0m 03/04 13:15:42 | 0.395762    0.392898    0.955171    0.782670    0.888909    0.969619    0.696907    0.395762    0.392898    0.953266    0.868095    0.942628    0.783008    1800        29.660144   0.221959    0.506595    114.274393 
[37m[36mINFO[0m[0m 03/04 13:19:16 | 0.390321    0.382589    0.965082    0.760100    0.929062    0.973223    0.647423    0.390321    0.382589    0.967061    0.860203    0.954963    0.772675    2000        32.955716   0.180376    0.496094    114.322949 
[37m[36mINFO[0m[0m 03/04 13:22:54 | 0.370561    0.364261    0.966394    0.771584    0.948408    0.966014    0.688660    0.370561    0.364261    0.969313    0.854566    0.963855    0.771527    2200        36.251287   0.150043    0.516262    114.582268 
[37m[36mINFO[0m[0m 03/04 13:26:31 | 0.403780    0.403207    0.970392    0.763419    0.962984    0.977858    0.674227    0.403780    0.403207    0.961430    0.839910    0.971888    0.776119    2400        39.546859   0.142226    0.513404    114.853606 
[37m[36mINFO[0m[0m 03/04 13:30:07 | 0.363688    0.352806    0.971657    0.761138    1.037106    0.975283    0.672165    0.363688    0.352806    0.973536    0.850056    0.966150    0.761194    2600        42.842430   0.088301    0.504278    115.253754 
[37m[36mINFO[0m[0m 03/04 13:33:48 | 0.379152    0.378007    0.969164    0.766964    1.010264    0.973223    0.670103    0.379152    0.378007    0.971847    0.848929    0.962421    0.781860    2800        46.138002   0.097976    0.513333    117.375881 
[37m[36mINFO[0m[0m 03/04 13:37:25 | 0.389748    0.381443    0.978253    0.772062    1.024005    0.987127    0.674227    0.389748    0.381443    0.978041    0.865840    0.969593    0.776119    3000        49.433574   0.075974    0.516479    113.944675 
[37m[36mINFO[0m[0m 03/04 13:41:00 | 0.413230    0.376861    0.986483    0.790177    0.918451    0.990731    0.698969    0.413230    0.376861    0.985642    0.879369    0.983075    0.792193    3200        52.729145   0.079358    0.506030    114.349111 
[37m[36mINFO[0m[0m 03/04 13:44:34 | 0.385739    0.376861    0.976001    0.763060    1.026264    0.978888    0.661856    0.385739    0.376861    0.975507    0.850056    0.973609    0.777268    3400        56.024717   0.061614    0.506016    112.600712 
[37m[36mINFO[0m[0m 03/04 13:48:08 | 0.371993    0.353952    0.979389    0.782033    0.987097    0.985067    0.692784    0.371993    0.353952    0.977196    0.872604    0.975904    0.780712    3600        59.320288   0.065322    0.512734    111.199588 
[37m[36mINFO[0m[0m 03/04 13:51:40 | 0.406357    0.391753    0.984571    0.787548    0.939008    0.988157    0.696907    0.406357    0.391753    0.985923    0.883878    0.979633    0.781860    3800        62.615860   0.064668    0.497968    112.617752 
[37m[36mINFO[0m[0m 03/04 13:55:16 | 0.398053    0.384880    0.988346    0.787825    0.963165    0.989186    0.680412    0.398053    0.384880    0.987613    0.878241    0.988239    0.804822    4000        65.911432   0.062782    0.508785    113.710493 
[37m[36mINFO[0m[0m 03/04 13:58:51 | 0.400057    0.396334    0.990643    0.790704    0.946567    0.993821    0.692784    0.400057    0.396334    0.989583    0.894025    0.988526    0.785304    4200        69.207003   0.039210    0.510905    113.478495 
[37m[36mINFO[0m[0m 03/04 14:02:28 | 0.375143    0.380298    0.982726    0.752883    1.162668    0.987127    0.657732    0.375143    0.380298    0.981419    0.850056    0.979633    0.750861    4400        72.502575   0.040623    0.518731    112.614806 
[37m[36mINFO[0m[0m 03/04 14:06:03 | 0.389175    0.382589    0.980393    0.778197    1.015833    0.983007    0.694845    0.389175    0.382589    0.981982    0.861330    0.976190    0.778416    4600        75.798146   0.052487    0.508153    113.684046 
[37m[36mINFO[0m[0m 03/04 14:09:37 | 0.407216    0.414662    0.985424    0.784586    0.945117    0.988157    0.694845    0.407216    0.414662    0.987050    0.880496    0.981067    0.778416    4800        79.093718   0.051979    0.506309    113.281385 
[37m[36mINFO[0m[0m 03/04 14:13:15 | 0.393471    0.367698    0.987581    0.778242    1.040281    0.989186    0.682474    0.393471    0.367698    0.987613    0.868095    0.985944    0.784156    5000        82.389289   0.042066    0.507203    115.602522 
[37m[36mINFO[0m[0m 03/04 14:13:15 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[1]/250304_12-41-26_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/04 14:13:17 | ---
[37m[36mINFO[0m[0m 03/04 14:13:17 | test-domain validation(oracle) = 40.722%
[37m[36mINFO[0m[0m 03/04 14:13:17 | training-domain validation(iid) = 40.006%
[37m[36mINFO[0m[0m 03/04 14:13:17 | last = 39.347%
[37m[36mINFO[0m[0m 03/04 14:13:17 | last (inD) = 77.824%
[37m[36mINFO[0m[0m 03/04 14:13:17 | training-domain validation (iid, inD) = 79.070%
[37m[36mINFO[0m[0m 03/04 14:13:17 | === Summary ===
[37m[36mINFO[0m[0m 03/04 14:13:17 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome
[37m[36mINFO[0m[0m 03/04 14:13:17 | Unique name: 250304_12-41-26_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/04 14:13:17 | Out path: train_output/OfficeHome/ERM/[1]/250304_12-41-26_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/04 14:13:17 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/04 14:13:17 | Dataset: OfficeHome

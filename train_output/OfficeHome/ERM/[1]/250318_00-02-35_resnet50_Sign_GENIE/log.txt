[37m[36mINFO[0m[0m 03/18 00:02:35 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --trial_seed 1 --hparams_seed 9 --algorithm ERM --test_envs 1 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 9
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/OfficeHome/ERM/[1]/250318_00-02-35_resnet50_Sign_GENIE
	out_root: train_output/OfficeHome/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250318_00-02-35_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.7532223448653515e-05
	batch_size: 36
	weight_decay: 0.007511403320794324
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/18 00:02:35 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 00:02:35 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 00:02:35 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 00:02:35 | 
[37m[36mINFO[0m[0m 03/18 00:02:35 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/18 00:02:35 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/18 00:02:35 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/18 00:02:35 | Batch sizes for each domain: [36, 0, 36, 36] (total=108)
[37m[36mINFO[0m[0m 03/18 00:02:35 | steps-per-epoch for each domain: 53.94, 98.67, 96.83 -> min = 53.94
[37m[36mINFO[0m[0m 03/18 00:02:36 | # of params = 23641217
[37m[36mINFO[0m[0m 03/18 00:04:37 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 00:04:37 | 0.014318    0.016037    0.020218    0.018448    4.188414    0.024717    0.016495    0.014318    0.016037    0.010980    0.010147    0.024957    0.028703    0           0.000000    4.376812    1.232690    119.218126 
[37m[36mINFO[0m[0m 03/18 00:08:38 | 0.489977    0.490263    0.821332    0.777646    0.759400    0.788363    0.738144    0.489977    0.490263    0.844595    0.808343    0.831038    0.786452    200         3.707518    1.768075    0.630202    115.719167 
[37m[36mINFO[0m[0m 03/18 00:12:40 | 0.505727    0.509737    0.893646    0.820656    0.612433    0.882080    0.785567    0.505727    0.509737    0.911881    0.865840    0.886976    0.810563    400         7.415036    0.590304    0.631340    115.510347 
[37m[36mINFO[0m[0m 03/18 00:16:43 | 0.524341    0.530355    0.918516    0.826210    0.625101    0.919156    0.767010    0.524341    0.530355    0.929336    0.886133    0.907057    0.825488    600         11.122554   0.419513    0.621357    118.609637 
[37m[36mINFO[0m[0m 03/18 00:20:42 | 0.535796    0.526919    0.941574    0.839694    0.609709    0.943357    0.795876    0.535796    0.526919    0.947917    0.880496    0.933448    0.842710    800         14.830072   0.318572    0.614745    115.634959 
[37m[36mINFO[0m[0m 03/18 00:24:40 | 0.516323    0.537228    0.938253    0.841532    0.614093    0.945417    0.795876    0.516323    0.537228    0.946509    0.892897    0.922834    0.835821    1000        18.537590   0.260135    0.627873    112.589996 
[37m[36mINFO[0m[0m 03/18 00:28:40 | 0.517182    0.525773    0.955901    0.836456    0.646122    0.968074    0.789691    0.517182    0.525773    0.952984    0.885006    0.946644    0.834673    1200        22.245108   0.217406    0.610425    117.905648 
[37m[36mINFO[0m[0m 03/18 00:32:44 | 0.527205    0.522337    0.966265    0.832323    0.618485    0.974768    0.789691    0.527205    0.522337    0.967342    0.872604    0.956684    0.834673    1400        25.952626   0.203462    0.633436    117.512494 
[37m[36mINFO[0m[0m 03/18 00:36:45 | 0.519759    0.505155    0.966822    0.830965    0.703097    0.970649    0.773196    0.519759    0.505155    0.964527    0.883878    0.965290    0.835821    1600        29.660144   0.160417    0.622831    116.626465 
[37m[36mINFO[0m[0m 03/18 00:40:40 | 0.491695    0.501718    0.967553    0.828265    0.683794    0.971164    0.773196    0.491695    0.501718    0.966779    0.887260    0.964716    0.824340    1800        33.367662   0.168155    0.587772    117.090733 
[37m[36mINFO[0m[0m 03/18 00:44:43 | 0.495991    0.504009    0.972524    0.823498    0.694640    0.975283    0.756701    0.495991    0.504009    0.972410    0.892897    0.969880    0.820896    2000        37.075180   0.145488    0.627771    117.404607 
[37m[36mINFO[0m[0m 03/18 00:48:44 | 0.524628    0.547537    0.972061    0.823711    0.684156    0.979918    0.760825    0.524628    0.547537    0.972410    0.895152    0.963855    0.815155    2200        40.782698   0.146591    0.617243    117.924380 
[37m[36mINFO[0m[0m 03/18 00:52:40 | 0.510882    0.528064    0.966708    0.818338    0.725940    0.973223    0.752577    0.510882    0.528064    0.967061    0.886133    0.959839    0.816303    2400        44.490216   0.147001    0.612661    113.302043 
[37m[36mINFO[0m[0m 03/18 00:56:41 | 0.474800    0.500573    0.968337    0.808700    0.773028    0.972709    0.744330    0.474800    0.500573    0.969595    0.886133    0.962708    0.795637    2600        48.197734   0.154548    0.632005    114.471106 
[37m[36mINFO[0m[0m 03/18 01:00:41 | 0.498855    0.504009    0.968086    0.808253    0.742082    0.971679    0.746392    0.498855    0.504009    0.970158    0.883878    0.962421    0.794489    2800        51.905252   0.153206    0.626362    114.637484 
[37m[36mINFO[0m[0m 03/18 01:04:44 | 0.522050    0.517755    0.968849    0.787400    0.870586    0.979403    0.725773    0.522050    0.517755    0.969313    0.854566    0.957831    0.781860    3000        55.612770   0.158209    0.627160    117.539815 
[37m[36mINFO[0m[0m 03/18 01:08:46 | 0.510596    0.526919    0.978272    0.808644    0.746619    0.984037    0.736082    0.510596    0.526919    0.978604    0.883878    0.972174    0.805970    3200        59.320288   0.162970    0.623362    117.577821 
[37m[36mINFO[0m[0m 03/18 01:12:50 | 0.514605    0.547537    0.959397    0.786446    0.784765    0.954686    0.709278    0.514605    0.547537    0.964527    0.862458    0.958979    0.787600    3400        63.027806   0.145869    0.628149    117.719557 
[37m[36mINFO[0m[0m 03/18 01:16:53 | 0.483391    0.466208    0.970122    0.799820    0.782334    0.973223    0.727835    0.483391    0.466208    0.971565    0.875986    0.965577    0.795637    3600        66.735324   0.178000    0.628708    117.840948 
[37m[36mINFO[0m[0m 03/18 01:20:54 | 0.493414    0.498282    0.954253    0.788466    0.869930    0.958805    0.715464    0.493414    0.498282    0.951858    0.869222    0.952094    0.780712    3800        70.442842   0.163607    0.619944    116.717050 
[37m[36mINFO[0m[0m 03/18 01:24:58 | 0.487973    0.482245    0.967206    0.785923    0.844290    0.972194    0.711340    0.487973    0.482245    0.970158    0.872604    0.959266    0.773823    4000        74.150360   0.184818    0.615766    121.017679 
[37m[36mINFO[0m[0m 03/18 01:29:00 | 0.465922    0.471936    0.964593    0.787666    0.836702    0.969104    0.715464    0.465922    0.471936    0.963401    0.874859    0.961274    0.772675    4200        77.857878   0.160603    0.630425    116.376668 
[37m[36mINFO[0m[0m 03/18 01:33:01 | 0.479095    0.490263    0.967213    0.790274    0.830668    0.978373    0.717526    0.479095    0.490263    0.961993    0.873732    0.961274    0.779564    4400        81.565396   0.174188    0.624354    115.586667 
[37m[36mINFO[0m[0m 03/18 01:36:54 | 0.494559    0.507446    0.972870    0.784555    0.825498    0.978888    0.707216    0.494559    0.507446    0.971565    0.871477    0.968158    0.774971    4600        85.272915   0.184835    0.592601    114.658219 
[37m[36mINFO[0m[0m 03/18 01:40:56 | 0.482818    0.494845    0.964947    0.773511    0.891544    0.969104    0.698969    0.482818    0.494845    0.967905    0.851184    0.957831    0.770379    4800        88.980433   0.172914    0.626765    116.300685 
[37m[36mINFO[0m[0m 03/18 01:44:53 | 0.481100    0.473081    0.952265    0.772081    0.885877    0.955201    0.694845    0.481100    0.473081    0.955236    0.860203    0.946357    0.761194    5000        92.687951   0.205281    0.613583    114.847531 
[37m[36mINFO[0m[0m 03/18 01:44:53 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[1]/250318_00-02-35_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 01:44:54 | ---
[37m[36mINFO[0m[0m 03/18 01:44:54 | test-domain validation(oracle) = 52.463%
[37m[36mINFO[0m[0m 03/18 01:44:54 | training-domain validation(iid) = 51.632%
[37m[36mINFO[0m[0m 03/18 01:44:54 | last = 48.110%
[37m[36mINFO[0m[0m 03/18 01:44:54 | last (inD) = 77.208%
[37m[36mINFO[0m[0m 03/18 01:44:54 | training-domain validation (iid, inD) = 84.153%
[37m[36mINFO[0m[0m 03/18 01:44:55 | === Summary ===
[37m[36mINFO[0m[0m 03/18 01:44:55 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --trial_seed 1 --hparams_seed 9 --algorithm ERM --test_envs 1 --dataset OfficeHome
[37m[36mINFO[0m[0m 03/18 01:44:55 | Unique name: 250318_00-02-35_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 01:44:55 | Out path: train_output/OfficeHome/ERM/[1]/250318_00-02-35_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 01:44:55 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 01:44:55 | Dataset: OfficeHome

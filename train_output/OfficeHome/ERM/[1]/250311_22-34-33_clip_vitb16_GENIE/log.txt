[37m[36mINFO[0m[0m 03/11 22:34:33 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 17
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 17
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/OfficeHome/ERM/[1]/250311_22-34-33_clip_vitb16_GENIE
	out_root: train_output/OfficeHome/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250311_22-34-33_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.00025159202447589334
	batch_size: 8
	weight_decay: 0.007781932002143384
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/11 22:34:33 | n_steps = 5001
[37m[36mINFO[0m[0m 03/11 22:34:33 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/11 22:34:33 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/11 22:34:33 | 
[37m[36mINFO[0m[0m 03/11 22:34:33 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/11 22:34:33 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/11 22:34:33 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/11 22:34:33 | Batch sizes for each domain: [8, 0, 8, 8] (total=24)
[37m[36mINFO[0m[0m 03/11 22:34:33 | steps-per-epoch for each domain: 242.75, 444.00, 435.75 -> min = 242.75
[37m[36mINFO[0m[0m 03/11 22:34:35 | # of params = 86225985
[37m[36mINFO[0m[0m 03/11 22:36:33 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/11 22:36:33 | 0.020619    0.019473    0.024552    0.026762    4.199744    0.031926    0.037113    0.020619    0.019473    0.023086    0.024803    0.018646    0.018370    0           0.000000    4.145094    0.991794    117.007956 
[37m[36mINFO[0m[0m 03/11 22:39:02 | 0.012887    0.016037    0.031153    0.031123    4.079961    0.026262    0.030928    0.012887    0.016037    0.041667    0.038331    0.025531    0.024110    200         0.823893    4.128963    0.163642    115.428428 
[37m[36mINFO[0m[0m 03/11 22:41:39 | 0.037228    0.036655    0.062564    0.066166    3.939774    0.062822    0.084536    0.037228    0.036655    0.056025    0.046223    0.068847    0.067738    400         1.647786    4.022268    0.191542    118.985938 
[37m[36mINFO[0m[0m 03/11 22:44:11 | 0.075029    0.077892    0.111534    0.113823    3.567981    0.082389    0.107216    0.075029    0.077892    0.133164    0.122886    0.119048    0.111366    600         2.471679    3.763202    0.166415    118.467550 
[37m[36mINFO[0m[0m 03/11 22:46:58 | 0.146621    0.144330    0.261122    0.254105    2.982222    0.221421    0.228866    0.146621    0.144330    0.288851    0.272830    0.273092    0.260620    800         3.295572    3.253383    0.238739    119.525198 
[37m[36mINFO[0m[0m 03/11 22:49:49 | 0.182990    0.197022    0.403938    0.390515    2.415942    0.334706    0.338144    0.182990    0.197022    0.475788    0.444194    0.401320    0.389208    1000        4.119464    2.682007    0.255198    119.788655 
[37m[36mINFO[0m[0m 03/11 22:52:19 | 0.225659    0.226804    0.473964    0.430689    2.188161    0.399073    0.346392    0.225659    0.226804    0.552365    0.519729    0.470453    0.425947    1200        4.943357    2.219103    0.160137    118.097615 
[37m[36mINFO[0m[0m 03/11 22:54:55 | 0.226231    0.216495    0.524187    0.463290    2.019601    0.441813    0.356701    0.226231    0.216495    0.609234    0.569335    0.521515    0.463835    1400        5.767250    2.011726    0.193004    117.819585 
[37m[36mINFO[0m[0m 03/11 22:57:48 | 0.211340    0.230241    0.552376    0.476731    2.002297    0.459835    0.352577    0.211340    0.230241    0.639921    0.587373    0.557372    0.490241    1600        6.591143    1.786875    0.257673    121.246950 
[37m[36mINFO[0m[0m 03/11 23:00:21 | 0.239118    0.238259    0.586194    0.502859    1.850121    0.509269    0.373196    0.239118    0.238259    0.680180    0.630214    0.569134    0.505166    1800        7.415036    1.687705    0.173710    117.886675 
[37m[36mINFO[0m[0m 03/11 23:02:57 | 0.221649    0.214204    0.606613    0.499869    1.889138    0.539650    0.395876    0.221649    0.214204    0.685811    0.603157    0.594378    0.500574    2000        8.238929    1.569375    0.180275    120.192390 
[37m[36mINFO[0m[0m 03/11 23:05:47 | 0.245991    0.247423    0.604898    0.514079    1.874063    0.533986    0.422680    0.245991    0.247423    0.688626    0.616685    0.592083    0.502870    2200        9.062822    1.496518    0.257972    118.671706 
[37m[36mINFO[0m[0m 03/11 23:08:36 | 0.223081    0.233677    0.603981    0.516284    1.907077    0.546859    0.432990    0.223081    0.233677    0.695664    0.630214    0.569421    0.485649    2400        9.886715    1.488005    0.244340    119.812172 
[37m[36mINFO[0m[0m 03/11 23:11:09 | 0.216781    0.209622    0.583591    0.473797    2.047754    0.517508    0.342268    0.216781    0.209622    0.679336    0.630214    0.553930    0.448909    2600        10.710608   1.560981    0.149865    122.660762 
[37m[36mINFO[0m[0m 03/11 23:13:50 | 0.228236    0.250859    0.634522    0.507834    1.923222    0.583419    0.391753    0.228236    0.250859    0.711712    0.640361    0.608434    0.491389    2800        11.534501   1.455450    0.217124    117.885748 
[37m[36mINFO[0m[0m 03/11 23:16:40 | 0.240836    0.231386    0.649744    0.516451    1.886250    0.585479    0.416495    0.240836    0.231386    0.726633    0.642616    0.637120    0.490241    3000        12.358393   1.389927    0.255690    119.112451 
[37m[36mINFO[0m[0m 03/11 23:19:18 | 0.239691    0.245132    0.634343    0.516393    1.905566    0.580844    0.418557    0.239691    0.245132    0.710023    0.639233    0.612163    0.491389    3200        13.182286   1.409415    0.172561    123.138617 
[37m[36mINFO[0m[0m 03/11 23:21:53 | 0.240550    0.223368    0.636986    0.498591    1.967733    0.583419    0.385567    0.240550    0.223368    0.730293    0.625705    0.597246    0.484501    3400        14.006179   1.402441    0.190499    116.996008 
[37m[36mINFO[0m[0m 03/11 23:24:48 | 0.226804    0.243986    0.632867    0.487782    2.008078    0.569516    0.344330    0.226804    0.243986    0.724381    0.645998    0.604705    0.473020    3600        14.830072   1.378868    0.256510    123.775188 
[37m[36mINFO[0m[0m 03/11 23:27:29 | 0.237400    0.238259    0.604190    0.460927    2.075867    0.546344    0.354639    0.237400    0.238259    0.695946    0.593010    0.570281    0.435132    3800        15.653965   1.364056    0.210666    119.005735 
[37m[36mINFO[0m[0m 03/11 23:29:59 | 0.183849    0.194731    0.621726    0.470755    2.090384    0.568486    0.334021    0.183849    0.194731    0.708052    0.615558    0.588640    0.462687    4000        16.477858   1.396636    0.171832    115.752883 
[37m[36mINFO[0m[0m 03/11 23:32:47 | 0.216495    0.214204    0.613809    0.482101    2.019620    0.553038    0.356701    0.216495    0.214204    0.707207    0.622322    0.581182    0.467279    4200        17.301751   1.481840    0.251069    117.534268 
[37m[36mINFO[0m[0m 03/11 23:35:34 | 0.237400    0.231386    0.628498    0.476346    2.044816    0.565396    0.338144    0.237400    0.231386    0.714245    0.614431    0.605852    0.476464    4400        18.125644   1.410006    0.254290    116.336513 
[37m[36mINFO[0m[0m 03/11 23:38:06 | 0.201604    0.207331    0.608975    0.461788    2.113952    0.538105    0.340206    0.201604    0.207331    0.699606    0.604284    0.589214    0.440873    4600        18.949537   1.416253    0.164480    119.044067 
[37m[36mINFO[0m[0m 03/11 23:40:51 | 0.210767    0.211913    0.663034    0.482066    1.992866    0.610711    0.356701    0.210767    0.211913    0.756475    0.627959    0.621916    0.461538    4800        19.773429   1.360051    0.210269    123.248513 
[37m[36mINFO[0m[0m 03/11 23:43:40 | 0.194158    0.186712    0.582428    0.450596    2.169783    0.541710    0.334021    0.194158    0.186712    0.657095    0.595265    0.548480    0.422503    5000        20.597322   1.369056    0.257603    116.874226 
[37m[36mINFO[0m[0m 03/11 23:43:40 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[1]/250311_22-34-33_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/11 23:43:44 | ---
[37m[36mINFO[0m[0m 03/11 23:43:44 | test-domain validation(oracle) = 22.824%
[37m[36mINFO[0m[0m 03/11 23:43:44 | training-domain validation(iid) = 24.084%
[37m[36mINFO[0m[0m 03/11 23:43:44 | last = 19.416%
[37m[36mINFO[0m[0m 03/11 23:43:44 | last (inD) = 45.060%
[37m[36mINFO[0m[0m 03/11 23:43:44 | training-domain validation (iid, inD) = 51.645%
[37m[36mINFO[0m[0m 03/11 23:43:44 | === Summary ===
[37m[36mINFO[0m[0m 03/11 23:43:44 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 17
[37m[36mINFO[0m[0m 03/11 23:43:44 | Unique name: 250311_22-34-33_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/11 23:43:44 | Out path: train_output/OfficeHome/ERM/[1]/250311_22-34-33_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/11 23:43:44 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/11 23:43:44 | Dataset: OfficeHome

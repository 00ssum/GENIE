[37m[36mINFO[0m[0m 03/12 08:37:09 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 1 --hparams_seed 3
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 3
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/OfficeHome/ERM/[1]/250312_08-37-09_clip_vitb16_GENIE
	out_root: train_output/OfficeHome/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250312_08-37-09_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.00018664964766736356
	batch_size: 13
	weight_decay: 0.0001969969539389593
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/12 08:37:09 | n_steps = 5001
[37m[36mINFO[0m[0m 03/12 08:37:09 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/12 08:37:09 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/12 08:37:09 | 
[37m[36mINFO[0m[0m 03/12 08:37:09 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/12 08:37:09 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/12 08:37:09 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/12 08:37:09 | Batch sizes for each domain: [13, 0, 13, 13] (total=39)
[37m[36mINFO[0m[0m 03/12 08:37:09 | steps-per-epoch for each domain: 149.38, 273.23, 268.15 -> min = 149.38
[37m[36mINFO[0m[0m 03/12 08:37:11 | # of params = 86225985
[37m[36mINFO[0m[0m 03/12 08:39:05 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/12 08:39:05 | 0.026632    0.021764    0.013294    0.015630    4.206656    0.009784    0.008247    0.026632    0.021764    0.016329    0.021421    0.013769    0.017222    0           0.000000    4.229934    1.052953    113.119812 
[37m[36mINFO[0m[0m 03/12 08:41:48 | 0.034937    0.021764    0.055668    0.065687    3.960491    0.053038    0.074227    0.034937    0.021764    0.056306    0.063134    0.057659    0.059701    200         1.338826    4.087238    0.240810    114.811037 
[37m[36mINFO[0m[0m 03/12 08:44:41 | 0.067297    0.060710    0.125740    0.129194    3.619846    0.116375    0.115464    0.067297    0.060710    0.131757    0.124014    0.129088    0.148106    400         2.677652    3.907519    0.272912    118.212211 
[37m[36mINFO[0m[0m 03/12 08:47:36 | 0.135739    0.130584    0.303347    0.289125    2.819589    0.255407    0.278351    0.135739    0.130584    0.347691    0.310034    0.306942    0.278990    600         4.016478    3.318164    0.298042    115.121809 
[37m[36mINFO[0m[0m 03/12 08:50:35 | 0.213345    0.232532    0.503818    0.455339    2.100810    0.421215    0.360825    0.213345    0.232532    0.582207    0.529876    0.508032    0.475316    800         5.355304    2.366523    0.315066    115.925396 
[37m[36mINFO[0m[0m 03/12 08:53:33 | 0.278351    0.280641    0.607388    0.538203    1.744404    0.525747    0.441237    0.278351    0.280641    0.692286    0.624577    0.604131    0.548794    1000        6.694130    1.742924    0.323593    113.721749 
[37m[36mINFO[0m[0m 03/12 08:56:33 | 0.269187    0.287514    0.672308    0.608532    1.503522    0.608651    0.523711    0.269187    0.287514    0.753941    0.691094    0.654332    0.610792    1200        8.032956    1.389516    0.318011    116.056083 
[37m[36mINFO[0m[0m 03/12 08:59:28 | 0.311283    0.335624    0.727437    0.640756    1.369900    0.672503    0.519588    0.311283    0.335624    0.800113    0.766629    0.709696    0.636051    1400        9.371782    1.208190    0.294686    116.679250 
[37m[36mINFO[0m[0m 03/12 09:02:18 | 0.312142    0.323024    0.761778    0.655346    1.298919    0.727600    0.548454    0.312142    0.323024    0.814189    0.767756    0.743546    0.649828    1600        10.710608   1.025684    0.270720    115.784637 
[37m[36mINFO[0m[0m 03/12 09:05:03 | 0.316151    0.339061    0.797572    0.665408    1.263002    0.772400    0.575258    0.316151    0.339061    0.842061    0.771139    0.778256    0.649828    1800        12.049434   0.831490    0.246579    115.230225 
[37m[36mINFO[0m[0m 03/12 09:07:44 | 0.315865    0.331042    0.828822    0.681826    1.218565    0.811020    0.562887    0.315865    0.331042    0.869651    0.791432    0.805795    0.691160    2000        13.388260   0.739703    0.230115    115.194506 
[37m[36mINFO[0m[0m 03/12 09:10:31 | 0.324456    0.341352    0.847190    0.685498    1.208049    0.832647    0.575258    0.324456    0.341352    0.874155    0.802706    0.834768    0.678530    2200        14.727085   0.684804    0.234828    119.560898 
[37m[36mINFO[0m[0m 03/12 09:13:18 | 0.328751    0.348225    0.851481    0.686855    1.226612    0.831617    0.567010    0.328751    0.348225    0.882320    0.819617    0.840505    0.673938    2400        16.065911   0.548635    0.239048    119.525382 
[37m[36mINFO[0m[0m 03/12 09:16:02 | 0.361970    0.392898    0.894855    0.712101    1.148957    0.899073    0.618557    0.361970    0.392898    0.920890    0.815107    0.864601    0.702641    2600        17.404737   0.478772    0.236511    116.665393 
[37m[36mINFO[0m[0m 03/12 09:18:46 | 0.342784    0.353952    0.905776    0.719797    1.122148    0.916066    0.637113    0.342784    0.353952    0.921171    0.818489    0.880092    0.703789    2800        18.743563   0.399865    0.233706    117.136659 
[37m[36mINFO[0m[0m 03/12 09:21:33 | 0.343643    0.368843    0.909551    0.691567    1.260595    0.910402    0.564948    0.343643    0.368843    0.932995    0.812852    0.885255    0.696900    3000        20.082389   0.377299    0.258744    115.846999 
[37m[36mINFO[0m[0m 03/12 09:24:16 | 0.339920    0.350515    0.932621    0.724866    1.154870    0.935633    0.589691    0.339920    0.350515    0.943412    0.846674    0.918818    0.738232    3200        21.421215   0.318912    0.229969    117.060580 
[37m[36mINFO[0m[0m 03/12 09:27:03 | 0.352234    0.368843    0.933277    0.717641    1.108032    0.941298    0.610309    0.352234    0.368843    0.941723    0.836528    0.916810    0.706085    3400        22.760041   0.282253    0.257017    115.150514 
[37m[36mINFO[0m[0m 03/12 09:29:50 | 0.324456    0.331042    0.948258    0.734769    1.053304    0.955201    0.641237    0.324456    0.331042    0.953829    0.847802    0.935743    0.715270    3600        24.098867   0.242062    0.260899    114.606427 
[37m[36mINFO[0m[0m 03/12 09:32:38 | 0.367698    0.373425    0.951375    0.728044    1.122499    0.964985    0.618557    0.367698    0.373425    0.961430    0.836528    0.927711    0.729047    3800        25.437693   0.209354    0.255468    116.694861 
[37m[36mINFO[0m[0m 03/12 09:35:28 | 0.352806    0.371134    0.956479    0.731222    1.089338    0.963440    0.612371    0.352806    0.371134    0.965090    0.855693    0.940906    0.725603    4000        26.776519   0.182086    0.259647    118.566637 
[37m[36mINFO[0m[0m 03/12 09:38:13 | 0.349370    0.342497    0.954869    0.729458    1.153598    0.955201    0.608247    0.349370    0.342497    0.966779    0.856821    0.942628    0.723307    4200        28.115345   0.171273    0.253242    113.824736 
[37m[36mINFO[0m[0m 03/12 09:41:00 | 0.363688    0.367698    0.958259    0.730867    1.131332    0.958805    0.612371    0.363688    0.367698    0.968468    0.851184    0.947504    0.729047    4400        29.454171   0.161272    0.248688    117.251932 
[37m[36mINFO[0m[0m 03/12 09:43:47 | 0.361111    0.376861    0.960162    0.745437    1.057989    0.964470    0.641237    0.361111    0.376861    0.966216    0.855693    0.949799    0.739380    4600        30.792997   0.137241    0.249151    117.803117 
[37m[36mINFO[0m[0m 03/12 09:46:28 | 0.364548    0.367698    0.971682    0.743872    1.100204    0.971679    0.630928    0.364548    0.367698    0.976070    0.862458    0.967298    0.738232    4800        32.131823   0.131824    0.230782    115.108995 
[37m[36mINFO[0m[0m 03/12 09:49:11 | 0.374857    0.375716    0.969307    0.749662    1.082345    0.974768    0.649485    0.374857    0.375716    0.970158    0.864713    0.962995    0.734788    5000        33.470649   0.141722    0.232512    116.541985 
[37m[36mINFO[0m[0m 03/12 09:49:12 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[1]/250312_08-37-09_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/12 09:49:14 | ---
[37m[36mINFO[0m[0m 03/12 09:49:14 | test-domain validation(oracle) = 36.197%
[37m[36mINFO[0m[0m 03/12 09:49:14 | training-domain validation(iid) = 37.486%
[37m[36mINFO[0m[0m 03/12 09:49:14 | last = 37.486%
[37m[36mINFO[0m[0m 03/12 09:49:14 | last (inD) = 74.966%
[37m[36mINFO[0m[0m 03/12 09:49:14 | training-domain validation (iid, inD) = 74.966%
[37m[36mINFO[0m[0m 03/12 09:49:14 | === Summary ===
[37m[36mINFO[0m[0m 03/12 09:49:14 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 1 --hparams_seed 3
[37m[36mINFO[0m[0m 03/12 09:49:14 | Unique name: 250312_08-37-09_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 09:49:14 | Out path: train_output/OfficeHome/ERM/[1]/250312_08-37-09_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 09:49:14 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/12 09:49:14 | Dataset: OfficeHome

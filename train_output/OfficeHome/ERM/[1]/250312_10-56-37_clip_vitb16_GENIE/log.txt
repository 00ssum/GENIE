[37m[36mINFO[0m[0m 03/12 10:56:37 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 1 --hparams_seed 5
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 5
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/OfficeHome/ERM/[1]/250312_10-56-37_clip_vitb16_GENIE
	out_root: train_output/OfficeHome/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250312_10-56-37_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.0002591339485391279
	batch_size: 10
	weight_decay: 0.00020150290684242954
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/12 10:56:37 | n_steps = 5001
[37m[36mINFO[0m[0m 03/12 10:56:37 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/12 10:56:37 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/12 10:56:37 | 
[37m[36mINFO[0m[0m 03/12 10:56:37 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/12 10:56:37 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/12 10:56:37 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/12 10:56:37 | Batch sizes for each domain: [10, 0, 10, 10] (total=30)
[37m[36mINFO[0m[0m 03/12 10:56:37 | steps-per-epoch for each domain: 194.20, 355.20, 348.60 -> min = 194.20
[37m[36mINFO[0m[0m 03/12 10:56:40 | # of params = 86225985
[37m[36mINFO[0m[0m 03/12 10:58:40 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/12 10:58:40 | 0.027491    0.019473    0.013834    0.014184    4.208031    0.010814    0.006186    0.027491    0.019473    0.015484    0.020293    0.015204    0.016073    0           0.000000    4.188606    2.249536    118.065506 
[37m[36mINFO[0m[0m 03/12 11:01:19 | 0.050974    0.044674    0.066057    0.084261    3.943749    0.058702    0.098969    0.050974    0.044674    0.072917    0.064262    0.066552    0.089552    200         1.029866    4.075329    0.204927    117.924701 
[37m[36mINFO[0m[0m 03/12 11:03:51 | 0.065006    0.049255    0.110533    0.113304    3.629147    0.109166    0.103093    0.065006    0.049255    0.115146    0.108230    0.107286    0.128588    400         2.059732    3.837395    0.194849    112.775442 
[37m[36mINFO[0m[0m 03/12 11:06:30 | 0.133162    0.123711    0.252312    0.220624    3.071314    0.200309    0.179381    0.133162    0.123711    0.281813    0.234498    0.274814    0.247991    600         3.089598    3.317479    0.214960    116.787606 
[37m[36mINFO[0m[0m 03/12 11:09:13 | 0.196735    0.195876    0.449182    0.424862    2.262168    0.361483    0.350515    0.196735    0.195876    0.539133    0.508455    0.446931    0.415614    800         4.119464    2.584162    0.231718    115.822076 
[37m[36mINFO[0m[0m 03/12 11:12:01 | 0.225659    0.219931    0.562047    0.493542    1.923230    0.476828    0.371134    0.225659    0.219931    0.656532    0.602029    0.552783    0.507463    1000        5.149331    1.948136    0.257097    117.372876 
[37m[36mINFO[0m[0m 03/12 11:14:51 | 0.268614    0.266896    0.619521    0.541884    1.752860    0.541710    0.397938    0.268614    0.266896    0.703829    0.666291    0.613024    0.561424    1200        6.179197    1.593706    0.285595    112.422315 
[37m[36mINFO[0m[0m 03/12 11:17:45 | 0.271478    0.286369    0.640964    0.568436    1.629814    0.565396    0.453608    0.271478    0.286369    0.723818    0.673055    0.633678    0.578645    1400        7.209063    1.346547    0.300849    113.865624 
[37m[36mINFO[0m[0m 03/12 11:20:32 | 0.256586    0.272623    0.684732    0.576050    1.589131    0.624614    0.461856    0.256586    0.272623    0.749718    0.691094    0.679862    0.575201    1600        8.238929    1.223172    0.250912    116.359811 
[37m[36mINFO[0m[0m 03/12 11:23:09 | 0.274628    0.288660    0.766543    0.646935    1.360857    0.720391    0.527835    0.274628    0.288660    0.829955    0.768884    0.749283    0.644087    1800        9.268795    0.999715    0.205864    116.154427 
[37m[36mINFO[0m[0m 03/12 11:25:40 | 0.284651    0.304696    0.751593    0.612596    1.480786    0.719361    0.515464    0.284651    0.304696    0.811092    0.703495    0.724326    0.618829    2000        10.298661   0.923992    0.188433    113.556424 
[37m[36mINFO[0m[0m 03/12 11:28:14 | 0.314147    0.328751    0.807812    0.655209    1.313832    0.771885    0.519588    0.314147    0.328751    0.858953    0.781285    0.792599    0.664753    2200        11.328527   0.798772    0.203185    113.627799 
[37m[36mINFO[0m[0m 03/12 11:30:57 | 0.308133    0.321879    0.805152    0.649454    1.352470    0.787848    0.554639    0.308133    0.321879    0.850788    0.754228    0.776822    0.639495    2400        12.358393   0.754422    0.231805    116.109989 
[37m[36mINFO[0m[0m 03/12 11:33:52 | 0.288946    0.318442    0.833586    0.652283    1.313774    0.816169    0.515464    0.288946    0.318442    0.871622    0.784667    0.812966    0.656716    2600        13.388260   0.661395    0.264180    122.105192 
[37m[36mINFO[0m[0m 03/12 11:36:45 | 0.323310    0.350515    0.851784    0.641397    1.382963    0.836251    0.519588    0.323310    0.350515    0.882038    0.786922    0.837063    0.617681    2800        14.418126   0.547195    0.293558    114.636792 
[37m[36mINFO[0m[0m 03/12 11:39:44 | 0.316724    0.342497    0.861943    0.658715    1.325221    0.852729    0.538144    0.316724    0.342497    0.885135    0.781285    0.847963    0.656716    3000        15.447992   0.458415    0.301981    118.715145 
[37m[36mINFO[0m[0m 03/12 11:42:41 | 0.313288    0.341352    0.878852    0.670961    1.271872    0.881050    0.567010    0.313288    0.341352    0.898649    0.790304    0.856856    0.655568    3200        16.477858   0.473385    0.277801    121.021997 
[37m[36mINFO[0m[0m 03/12 11:45:17 | 0.300115    0.304696    0.883147    0.670492    1.283537    0.882080    0.560825    0.300115    0.304696    0.908784    0.780158    0.858577    0.670494    3400        17.507724   0.390559    0.208795    114.597714 
[37m[36mINFO[0m[0m 03/12 11:47:52 | 0.330756    0.348225    0.901278    0.682019    1.260734    0.903708    0.575258    0.330756    0.348225    0.920608    0.808343    0.879518    0.662457    3600        18.537590   0.355124    0.191076    116.084099 
[37m[36mINFO[0m[0m 03/12 11:50:29 | 0.324456    0.325315    0.927978    0.707216    1.169280    0.937693    0.593814    0.324456    0.325315    0.939471    0.828636    0.906770    0.699196    3800        19.567456   0.289433    0.196086    118.658856 
[37m[36mINFO[0m[0m 03/12 11:53:12 | 0.308706    0.312715    0.941993    0.694637    1.209693    0.954686    0.573196    0.308706    0.312715    0.949606    0.822999    0.921687    0.687715    4000        20.597322   0.271985    0.223721    117.949790 
[37m[36mINFO[0m[0m 03/12 11:55:57 | 0.315006    0.320733    0.940394    0.705428    1.167970    0.946447    0.591753    0.315006    0.320733    0.949606    0.820744    0.925129    0.703789    4200        21.627188   0.226742    0.225093    120.310223 
[37m[36mINFO[0m[0m 03/12 11:58:31 | 0.320733    0.334479    0.956524    0.707932    1.145294    0.966014    0.604124    0.320733    0.334479    0.957489    0.835400    0.946070    0.684271    4400        22.657055   0.183673    0.189106    116.156751 
[37m[36mINFO[0m[0m 03/12 12:01:12 | 0.331615    0.328751    0.946678    0.712507    1.201143    0.956231    0.616495    0.331615    0.328751    0.955518    0.824126    0.928285    0.696900    4600        23.686921   0.165250    0.202872    120.384634 
[37m[36mINFO[0m[0m 03/12 12:03:47 | 0.301833    0.293242    0.947707    0.688812    1.213458    0.963440    0.564948    0.301833    0.293242    0.945946    0.825254    0.933735    0.676234    4800        24.716787   0.176502    0.192625    116.258247 
[37m[36mINFO[0m[0m 03/12 12:06:20 | 0.352520    0.357388    0.958846    0.708901    1.168045    0.967044    0.575258    0.352520    0.357388    0.962275    0.855693    0.947217    0.695752    5000        25.746653   0.159055    0.183105    116.477633 
[37m[36mINFO[0m[0m 03/12 12:06:21 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[1]/250312_10-56-37_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/12 12:06:23 | ---
[37m[36mINFO[0m[0m 03/12 12:06:23 | test-domain validation(oracle) = 35.252%
[37m[36mINFO[0m[0m 03/12 12:06:23 | training-domain validation(iid) = 33.162%
[37m[36mINFO[0m[0m 03/12 12:06:23 | last = 35.252%
[37m[36mINFO[0m[0m 03/12 12:06:23 | last (inD) = 70.890%
[37m[36mINFO[0m[0m 03/12 12:06:23 | training-domain validation (iid, inD) = 71.251%
[37m[36mINFO[0m[0m 03/12 12:06:23 | === Summary ===
[37m[36mINFO[0m[0m 03/12 12:06:23 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 1 --hparams_seed 5
[37m[36mINFO[0m[0m 03/12 12:06:23 | Unique name: 250312_10-56-37_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 12:06:23 | Out path: train_output/OfficeHome/ERM/[1]/250312_10-56-37_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 12:06:23 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/12 12:06:23 | Dataset: OfficeHome

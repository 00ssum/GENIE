[37m[36mINFO[0m[0m 03/12 08:14:13 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 2 --hparams_seed 13
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 13
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/OfficeHome/ERM/[1]/250312_08-14-13_clip_vitb16_GENIE
	out_root: train_output/OfficeHome/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 2
	unique_name: 250312_08-14-13_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.00010514591448387436
	batch_size: 9
	weight_decay: 2.4366015497066046e-05
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/12 08:14:13 | n_steps = 5001
[37m[36mINFO[0m[0m 03/12 08:14:13 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/12 08:14:13 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/12 08:14:13 | 
[37m[36mINFO[0m[0m 03/12 08:14:13 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/12 08:14:13 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/12 08:14:13 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/12 08:14:13 | Batch sizes for each domain: [9, 0, 9, 9] (total=27)
[37m[36mINFO[0m[0m 03/12 08:14:13 | steps-per-epoch for each domain: 215.78, 394.67, 387.33 -> min = 215.78
[37m[36mINFO[0m[0m 03/12 08:14:16 | # of params = 86225985
[37m[36mINFO[0m[0m 03/12 08:16:13 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/12 08:16:13 | 0.020619    0.010309    0.016047    0.014834    4.203969    0.012358    0.020619    0.020619    0.010309    0.019144    0.012401    0.016638    0.011481    0           0.000000    4.189667    1.775647    115.376450 
[37m[36mINFO[0m[0m 03/12 08:18:41 | 0.033792    0.029782    0.045343    0.044282    4.019080    0.050978    0.047423    0.033792    0.029782    0.038007    0.037204    0.047045    0.048220    200         0.926880    4.091059    0.174230    113.337771 
[37m[36mINFO[0m[0m 03/12 08:21:22 | 0.044101    0.034364    0.071295    0.076547    3.898220    0.071576    0.078351    0.044101    0.034364    0.074324    0.076663    0.067986    0.074627    400         1.853759    3.963172    0.196544    121.161011 
[37m[36mINFO[0m[0m 03/12 08:24:00 | 0.075601    0.066438    0.150572    0.135483    3.498082    0.133883    0.127835    0.075601    0.066438    0.167230    0.145434    0.150602    0.133180    600         2.780639    3.706309    0.222764    113.944163 
[37m[36mINFO[0m[0m 03/12 08:26:49 | 0.151203    0.137457    0.279286    0.263411    2.898830    0.208033    0.218557    0.151203    0.137457    0.355011    0.316798    0.274814    0.254879    800         3.707518    3.096580    0.272758    114.286897 
[37m[36mINFO[0m[0m 03/12 08:29:34 | 0.203322    0.193585    0.480441    0.427421    2.145978    0.407827    0.334021    0.203322    0.193585    0.548986    0.505073    0.484509    0.443169    1000        4.634398    2.432494    0.240564    116.890767 
[37m[36mINFO[0m[0m 03/12 08:32:05 | 0.251718    0.231386    0.578675    0.510788    1.838302    0.508754    0.402062    0.251718    0.231386    0.647523    0.594138    0.579748    0.536165    1200        5.561277    1.882906    0.186556    113.253298 
[37m[36mINFO[0m[0m 03/12 08:34:40 | 0.204181    0.200458    0.529709    0.482976    2.023728    0.454686    0.391753    0.204181    0.200458    0.611205    0.574972    0.523236    0.482204    1400        6.488157    1.641325    0.188192    117.324359 
[37m[36mINFO[0m[0m 03/12 08:37:17 | 0.254296    0.256586    0.652633    0.558180    1.661470    0.588568    0.443299    0.254296    0.256586    0.735079    0.661781    0.634251    0.569460    1600        7.415036    1.435441    0.226142    112.361122 
[37m[36mINFO[0m[0m 03/12 08:39:53 | 0.248568    0.255441    0.678728    0.577406    1.559133    0.627703    0.470103    0.248568    0.255441    0.742962    0.668546    0.665519    0.593571    1800        8.341916    1.261850    0.197608    116.655804 
[37m[36mINFO[0m[0m 03/12 08:42:27 | 0.255441    0.274914    0.701417    0.574636    1.592552    0.668898    0.472165    0.255441    0.274914    0.762950    0.670800    0.672404    0.580941    2000        9.268795    1.133632    0.202086    113.037091 
[37m[36mINFO[0m[0m 03/12 08:45:07 | 0.274341    0.263459    0.736903    0.612594    1.490755    0.689495    0.501031    0.274341    0.263459    0.803773    0.730552    0.717441    0.606200    2200        10.195675   0.959044    0.226486    114.844242 
[37m[36mINFO[0m[0m 03/12 08:47:50 | 0.246850    0.263459    0.771361    0.589094    1.522548    0.745108    0.457732    0.246850    0.263459    0.826577    0.711387    0.742398    0.598163    2400        11.122554   0.880139    0.234915    116.306700 
[37m[36mINFO[0m[0m 03/12 08:50:37 | 0.294101    0.285223    0.811985    0.636828    1.384042    0.788877    0.523711    0.294101    0.285223    0.867962    0.757610    0.779116    0.629162    2600        12.049434   0.789456    0.260613    114.233508 
[37m[36mINFO[0m[0m 03/12 08:53:28 | 0.301833    0.311569    0.836369    0.646021    1.334076    0.825953    0.531959    0.301833    0.311569    0.871622    0.767756    0.811532    0.638347    2800        12.976313   0.679128    0.271579    116.875613 
[37m[36mINFO[0m[0m 03/12 08:56:12 | 0.306128    0.294387    0.843623    0.638187    1.437734    0.842945    0.519588    0.306128    0.294387    0.877252    0.748591    0.810671    0.646383    3000        13.903193   0.613833    0.255375    113.331904 
[37m[36mINFO[0m[0m 03/12 08:58:53 | 0.283792    0.289805    0.860715    0.631799    1.420028    0.868177    0.503093    0.283792    0.289805    0.880349    0.768884    0.833620    0.623421    3200        14.830072   0.527201    0.230392    114.478986 
[37m[36mINFO[0m[0m 03/12 09:01:27 | 0.307560    0.316151    0.885472    0.649054    1.320675    0.900103    0.542268    0.307560    0.316151    0.901464    0.771139    0.854848    0.633754    3400        15.756952   0.447332    0.192773    115.348012 
[37m[36mINFO[0m[0m 03/12 09:03:59 | 0.280641    0.266896    0.844642    0.618988    1.534651    0.839856    0.503093    0.280641    0.266896    0.870777    0.736189    0.823293    0.617681    3600        16.683831   0.423982    0.183682    115.679725 
[37m[36mINFO[0m[0m 03/12 09:06:27 | 0.321879    0.319588    0.908280    0.659648    1.317748    0.910402    0.511340    0.321879    0.319588    0.922297    0.794814    0.892140    0.672790    3800        17.610711   0.404761    0.172509    113.068261 
[37m[36mINFO[0m[0m 03/12 09:08:56 | 0.333906    0.325315    0.918599    0.677697    1.339030    0.929454    0.558763    0.333906    0.325315    0.929899    0.803833    0.896443    0.670494    4000        18.537590   0.363927    0.174129    114.159671 
[37m[36mINFO[0m[0m 03/12 09:11:33 | 0.317297    0.323024    0.920271    0.671144    1.308020    0.925850    0.538144    0.317297    0.323024    0.944257    0.813980    0.890706    0.661309    4200        19.464470   0.301577    0.193746    118.681061 
[37m[36mINFO[0m[0m 03/12 09:14:09 | 0.314719    0.325315    0.931918    0.682191    1.313456    0.935633    0.550515    0.314719    0.325315    0.948761    0.808343    0.911360    0.687715    4400        20.391349   0.265131    0.203480    114.732360 
[37m[36mINFO[0m[0m 03/12 09:16:49 | 0.302692    0.288660    0.920751    0.663493    1.384712    0.926365    0.542268    0.302692    0.288660    0.940878    0.788050    0.895009    0.660161    4600        21.318229   0.226974    0.209207    118.626070 
[37m[36mINFO[0m[0m 03/12 09:19:27 | 0.306128    0.304696    0.940678    0.665785    1.372115    0.956746    0.529897    0.306128    0.304696    0.948480    0.802706    0.916810    0.664753    4800        22.245108   0.238340    0.212114    115.147970 
[37m[36mINFO[0m[0m 03/12 09:22:08 | 0.319301    0.310424    0.941982    0.674869    1.367345    0.946962    0.552577    0.319301    0.310424    0.952421    0.803833    0.926563    0.668197    5000        23.171988   0.212753    0.222635    116.733710 
[37m[36mINFO[0m[0m 03/12 09:22:08 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[1]/250312_08-14-13_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/12 09:22:10 | ---
[37m[36mINFO[0m[0m 03/12 09:22:10 | test-domain validation(oracle) = 33.391%
[37m[36mINFO[0m[0m 03/12 09:22:10 | training-domain validation(iid) = 31.472%
[37m[36mINFO[0m[0m 03/12 09:22:10 | last = 31.930%
[37m[36mINFO[0m[0m 03/12 09:22:10 | last (inD) = 67.487%
[37m[36mINFO[0m[0m 03/12 09:22:10 | training-domain validation (iid, inD) = 68.219%
[37m[36mINFO[0m[0m 03/12 09:22:10 | === Summary ===
[37m[36mINFO[0m[0m 03/12 09:22:10 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 2 --hparams_seed 13
[37m[36mINFO[0m[0m 03/12 09:22:10 | Unique name: 250312_08-14-13_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 09:22:10 | Out path: train_output/OfficeHome/ERM/[1]/250312_08-14-13_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 09:22:10 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/12 09:22:10 | Dataset: OfficeHome

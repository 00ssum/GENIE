[37m[36mINFO[0m[0m 03/12 03:08:52 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 7
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 7
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/OfficeHome/ERM/[1]/250312_03-08-52_clip_vitb16_GENIE
	out_root: train_output/OfficeHome/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250312_03-08-52_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.6632780446310692e-05
	batch_size: 24
	weight_decay: 5.717289389191427e-06
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/12 03:08:52 | n_steps = 5001
[37m[36mINFO[0m[0m 03/12 03:08:52 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/12 03:08:52 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/12 03:08:52 | 
[37m[36mINFO[0m[0m 03/12 03:08:52 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/12 03:08:52 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/12 03:08:52 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/12 03:08:52 | Batch sizes for each domain: [24, 0, 24, 24] (total=72)
[37m[36mINFO[0m[0m 03/12 03:08:52 | steps-per-epoch for each domain: 80.92, 148.00, 145.25 -> min = 80.92
[37m[36mINFO[0m[0m 03/12 03:08:54 | # of params = 86225985
[37m[36mINFO[0m[0m 03/12 03:10:52 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/12 03:10:52 | 0.012314    0.006873    0.018017    0.016063    4.191175    0.015963    0.006186    0.012314    0.006873    0.018581    0.025930    0.019507    0.016073    0           0.000000    4.174069    1.372852    116.830569 
[37m[36mINFO[0m[0m 03/12 03:14:15 | 0.071019    0.074456    0.140611    0.139323    3.572776    0.127188    0.138144    0.071019    0.074456    0.149493    0.142052    0.145152    0.137773    200         2.471679    3.981066    0.433264    116.427387 
[37m[36mINFO[0m[0m 03/12 03:17:56 | 0.291810    0.316151    0.594283    0.578449    1.744800    0.518023    0.496907    0.291810    0.316151    0.663851    0.644870    0.600975    0.593571    400         4.943357    2.606631    0.517348    117.938926 
[37m[36mINFO[0m[0m 03/12 03:21:40 | 0.326747    0.349370    0.752773    0.692124    1.150595    0.711637    0.597938    0.326747    0.349370    0.807151    0.767756    0.739530    0.710677    600         7.415036    1.229659    0.536600    116.657014 
[37m[36mINFO[0m[0m 03/12 03:25:06 | 0.362543    0.379152    0.813483    0.726841    1.031232    0.790937    0.643299    0.362543    0.379152    0.845439    0.817362    0.804073    0.719862    800         9.886715    0.741168    0.434045    118.414382 
[37m[36mINFO[0m[0m 03/12 03:28:27 | 0.403207    0.405498    0.883518    0.773402    0.858560    0.871782    0.678351    0.403207    0.405498    0.912162    0.871477    0.866609    0.770379    1000        12.358393   0.531666    0.405028    120.079506 
[37m[36mINFO[0m[0m 03/12 03:32:02 | 0.377721    0.355097    0.906098    0.768579    0.912224    0.901133    0.678351    0.377721    0.355097    0.929899    0.846674    0.887263    0.780712    1200        14.830072   0.379113    0.502289    114.862726 
[37m[36mINFO[0m[0m 03/12 03:35:32 | 0.392612    0.390607    0.923045    0.775507    0.894645    0.909887    0.663918    0.392612    0.390607    0.949324    0.866967    0.909925    0.795637    1400        17.301751   0.308697    0.472857    115.502327 
[37m[36mINFO[0m[0m 03/12 03:38:51 | 0.418958    0.412371    0.939703    0.788546    0.827295    0.942842    0.692784    0.418958    0.412371    0.944538    0.871477    0.931727    0.801378    1600        19.773429   0.220686    0.411206    116.311047 
[37m[36mINFO[0m[0m 03/12 03:42:22 | 0.439003    0.434135    0.959941    0.805640    0.747677    0.962410    0.723711    0.439003    0.434135    0.968187    0.888388    0.949225    0.804822    1800        22.245108   0.172513    0.474728    116.188492 
[37m[36mINFO[0m[0m 03/12 03:46:03 | 0.420962    0.413517    0.965231    0.793339    0.792549    0.966014    0.705155    0.420962    0.413517    0.971847    0.887260    0.957831    0.787600    2000        24.716787   0.147850    0.517870    117.309431 
[37m[36mINFO[0m[0m 03/12 03:49:27 | 0.411226    0.420389    0.972055    0.803452    0.748079    0.974768    0.719588    0.411226    0.420389    0.974099    0.896280    0.967298    0.794489    2200        27.188465   0.124065    0.448629    114.818999 
[37m[36mINFO[0m[0m 03/12 03:52:49 | 0.417239    0.422680    0.977993    0.802538    0.793311    0.978373    0.713402    0.417239    0.422680    0.981137    0.896280    0.974469    0.797933    2400        29.660144   0.097285    0.425189    116.506222 
[37m[36mINFO[0m[0m 03/12 03:56:30 | 0.439290    0.420389    0.979069    0.812253    0.766913    0.979918    0.729897    0.439290    0.420389    0.983108    0.895152    0.974182    0.811711    2600        32.131823   0.074202    0.507485    119.387000 
[37m[36mINFO[0m[0m 03/12 04:00:06 | 0.440722    0.438717    0.980133    0.804459    0.773505    0.981977    0.713402    0.440722    0.438717    0.983953    0.895152    0.974469    0.804822    2800        34.603502   0.063964    0.499612    116.252000 
[37m[36mINFO[0m[0m 03/12 04:03:24 | 0.432703    0.430699    0.983812    0.812128    0.771901    0.983007    0.721649    0.432703    0.430699    0.985642    0.904171    0.982788    0.810563    3000        37.075180   0.061059    0.410397    116.267708 
[37m[36mINFO[0m[0m 03/12 04:06:46 | 0.439576    0.424971    0.985966    0.809441    0.810320    0.989186    0.731959    0.439576    0.424971    0.985923    0.904171    0.982788    0.792193    3200        39.546859   0.059371    0.423323    116.663299 
[37m[36mINFO[0m[0m 03/12 04:10:21 | 0.452176    0.430699    0.987683    0.808209    0.771531    0.991246    0.723711    0.452176    0.430699    0.989302    0.906426    0.982501    0.794489    3400        42.018538   0.049946    0.502668    114.882658 
[37m[36mINFO[0m[0m 03/12 04:14:01 | 0.463058    0.451317    0.990511    0.821478    0.750147    0.989186    0.715464    0.463058    0.451317    0.992962    0.915445    0.989386    0.833525    3600        44.490216   0.041846    0.504817    118.575636 
[37m[36mINFO[0m[0m 03/12 04:17:25 | 0.428981    0.410080    0.985092    0.806002    0.801495    0.987127    0.723711    0.428981    0.410080    0.985360    0.891770    0.982788    0.802526    3800        46.961895   0.050065    0.428380    119.068006 
[37m[36mINFO[0m[0m 03/12 04:20:57 | 0.430699    0.431844    0.990545    0.813165    0.791279    0.991246    0.703093    0.430699    0.431844    0.990428    0.912063    0.989960    0.824340    4000        49.433574   0.041319    0.476990    116.033983 
[37m[36mINFO[0m[0m 03/12 04:24:41 | 0.443299    0.445590    0.988714    0.815431    0.777657    0.989186    0.734021    0.443299    0.445590    0.989865    0.913191    0.987091    0.799082    4200        51.905252   0.039117    0.523339    119.677248 
[37m[36mINFO[0m[0m 03/12 04:28:06 | 0.454181    0.434135    0.992078    0.817034    0.750312    0.993306    0.721649    0.454181    0.434135    0.992680    0.915445    0.990247    0.814007    4400        54.376931   0.034388    0.435945    117.214507 
[37m[36mINFO[0m[0m 03/12 04:31:24 | 0.443299    0.426117    0.988822    0.803078    0.858434    0.988671    0.698969    0.443299    0.426117    0.990991    0.897407    0.986804    0.812859    4600        56.848610   0.037148    0.401071    118.018069 
[37m[36mINFO[0m[0m 03/12 04:34:57 | 0.457331    0.450172    0.990520    0.815280    0.822448    0.989186    0.729897    0.457331    0.450172    0.991554    0.900789    0.990820    0.815155    4800        59.320288   0.029881    0.490846    114.905328 
[37m[36mINFO[0m[0m 03/12 04:38:34 | 0.441867    0.426117    0.990565    0.812650    0.826078    0.993306    0.729897    0.441867    0.426117    0.989865    0.892897    0.988526    0.815155    5000        61.791967   0.032338    0.515492    114.477333 
[37m[36mINFO[0m[0m 03/12 04:38:35 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[1]/250312_03-08-52_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/12 04:38:37 | ---
[37m[36mINFO[0m[0m 03/12 04:38:37 | test-domain validation(oracle) = 46.306%
[37m[36mINFO[0m[0m 03/12 04:38:37 | training-domain validation(iid) = 46.306%
[37m[36mINFO[0m[0m 03/12 04:38:37 | last = 44.187%
[37m[36mINFO[0m[0m 03/12 04:38:37 | last (inD) = 81.265%
[37m[36mINFO[0m[0m 03/12 04:38:37 | training-domain validation (iid, inD) = 82.148%
[37m[36mINFO[0m[0m 03/12 04:38:37 | === Summary ===
[37m[36mINFO[0m[0m 03/12 04:38:37 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 7
[37m[36mINFO[0m[0m 03/12 04:38:37 | Unique name: 250312_03-08-52_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 04:38:37 | Out path: train_output/OfficeHome/ERM/[1]/250312_03-08-52_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 04:38:37 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/12 04:38:37 | Dataset: OfficeHome

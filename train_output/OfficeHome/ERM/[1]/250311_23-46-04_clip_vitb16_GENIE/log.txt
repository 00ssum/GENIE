[37m[36mINFO[0m[0m 03/11 23:46:04 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 1 --hparams_seed 11
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 11
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/OfficeHome/ERM/[1]/250311_23-46-04_clip_vitb16_GENIE
	out_root: train_output/OfficeHome/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250311_23-46-04_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5.340583028754034e-05
	batch_size: 10
	weight_decay: 2.5000172438864113e-05
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/11 23:46:04 | n_steps = 5001
[37m[36mINFO[0m[0m 03/11 23:46:04 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/11 23:46:04 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/11 23:46:04 | 
[37m[36mINFO[0m[0m 03/11 23:46:04 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/11 23:46:04 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/11 23:46:04 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/11 23:46:04 | Batch sizes for each domain: [10, 0, 10, 10] (total=30)
[37m[36mINFO[0m[0m 03/11 23:46:04 | steps-per-epoch for each domain: 194.20, 355.20, 348.60 -> min = 194.20
[37m[36mINFO[0m[0m 03/11 23:46:06 | # of params = 86225985
[37m[36mINFO[0m[0m 03/11 23:48:07 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/11 23:48:07 | 0.024341    0.017182    0.012743    0.014424    4.207347    0.009784    0.010309    0.024341    0.017182    0.012669    0.018038    0.015777    0.014925    0           0.000000    4.166790    1.180624    119.977450 
[37m[36mINFO[0m[0m 03/11 23:51:05 | 0.052119    0.038946    0.061426    0.075362    3.894583    0.061277    0.080412    0.052119    0.038946    0.063908    0.069899    0.059094    0.075775    200         1.029866    4.054481    0.305442    116.314552 
[37m[36mINFO[0m[0m 03/11 23:53:42 | 0.076174    0.069874    0.139363    0.153207    3.487849    0.116890    0.144330    0.076174    0.069874    0.151745    0.148816    0.149455    0.166475    400         2.059732    3.683559    0.207657    116.058907 
[37m[36mINFO[0m[0m 03/11 23:56:33 | 0.155498    0.147766    0.319476    0.292138    2.749694    0.265705    0.259794    0.155498    0.147766    0.366273    0.307779    0.326449    0.308840    600         3.089598    3.039019    0.240385    122.107272 
[37m[36mINFO[0m[0m 03/11 23:59:37 | 0.228809    0.231386    0.507505    0.467453    2.051657    0.425335    0.371134    0.228809    0.231386    0.594313    0.550169    0.502869    0.481056    800         4.119464    2.289290    0.307437    122.930342 
[37m[36mINFO[0m[0m 03/12 00:02:33 | 0.271764    0.258877    0.599414    0.542786    1.698999    0.525232    0.437113    0.271764    0.258877    0.686092    0.651635    0.586919    0.539610    1000        5.149331    1.696768    0.291837    117.309673 
[37m[36mINFO[0m[0m 03/12 00:05:13 | 0.280355    0.276060    0.632569    0.554441    1.707355    0.564367    0.428866    0.280355    0.276060    0.711712    0.674183    0.621629    0.560276    1200        6.179197    1.430965    0.195853    121.016517 
[37m[36mINFO[0m[0m 03/12 00:07:54 | 0.270619    0.286369    0.661483    0.576376    1.592612    0.586509    0.453608    0.270619    0.286369    0.754223    0.688839    0.643718    0.586682    1400        7.209063    1.278129    0.232521    114.568821 
[37m[36mINFO[0m[0m 03/12 00:10:53 | 0.254868    0.272623    0.715827    0.608878    1.505755    0.664779    0.501031    0.254868    0.272623    0.777309    0.712514    0.705393    0.613088    1600        8.238929    1.142613    0.306577    117.360806 
[37m[36mINFO[0m[0m 03/12 00:13:45 | 0.281787    0.285223    0.774979    0.635885    1.325751    0.736869    0.527835    0.281787    0.285223    0.833333    0.760992    0.754733    0.618829    1800        9.268795    0.909671    0.247211    122.882328 
[37m[36mINFO[0m[0m 03/12 00:16:22 | 0.312142    0.327606    0.781524    0.620881    1.402494    0.756437    0.492784    0.312142    0.327606    0.829673    0.740699    0.758462    0.629162    2000        10.298661   0.849239    0.190161    118.997133 
[37m[36mINFO[0m[0m 03/12 00:19:11 | 0.325315    0.339061    0.835209    0.667074    1.240030    0.816684    0.552577    0.325315    0.339061    0.884009    0.764374    0.804934    0.684271    2200        11.328527   0.705297    0.271165    114.631836 
[37m[36mINFO[0m[0m 03/12 00:21:54 | 0.321879    0.347079    0.837694    0.676091    1.260779    0.829557    0.573196    0.321879    0.347079    0.882320    0.789177    0.801205    0.665901    2400        12.358393   0.620550    0.221241    119.242964 
[37m[36mINFO[0m[0m 03/12 00:24:47 | 0.311569    0.304696    0.856227    0.670801    1.246426    0.832647    0.558763    0.311569    0.304696    0.896678    0.804961    0.839357    0.648680    2600        13.388260   0.568102    0.259856    120.938941 
[37m[36mINFO[0m[0m 03/12 00:27:46 | 0.330756    0.358534    0.842626    0.630451    1.475212    0.820803    0.509278    0.330756    0.358534    0.880912    0.763247    0.826162    0.618829    2800        14.418126   0.463058    0.305220    117.700153 
[37m[36mINFO[0m[0m 03/12 00:30:37 | 0.318442    0.339061    0.875412    0.674767    1.253946    0.876416    0.567010    0.318442    0.339061    0.895833    0.793687    0.853987    0.663605    3000        15.447992   0.418881    0.252753    120.741717 
[37m[36mINFO[0m[0m 03/12 00:33:19 | 0.345934    0.358534    0.899701    0.677633    1.252005    0.900103    0.550515    0.345934    0.358534    0.919482    0.802706    0.879518    0.679679    3200        16.477858   0.429424    0.202471    121.456877 
[37m[36mINFO[0m[0m 03/12 00:35:53 | 0.328751    0.348225    0.919586    0.704066    1.132455    0.914006    0.573196    0.328751    0.348225    0.942286    0.845547    0.902467    0.693456    3400        17.507724   0.333479    0.197022    114.715575 
[37m[36mINFO[0m[0m 03/12 00:38:39 | 0.336770    0.350515    0.923662    0.688810    1.217316    0.931514    0.585567    0.336770    0.350515    0.933277    0.822999    0.906196    0.657865    3600        18.537590   0.304117    0.243140    116.922741 
[37m[36mINFO[0m[0m 03/12 00:41:41 | 0.341352    0.349370    0.935309    0.689589    1.153001    0.942842    0.567010    0.341352    0.349370    0.943694    0.810598    0.919392    0.691160    3800        19.567456   0.228135    0.305774    121.339629 
[37m[36mINFO[0m[0m 03/12 00:44:40 | 0.301546    0.310424    0.937042    0.698550    1.247727    0.945417    0.579381    0.301546    0.310424    0.941441    0.833145    0.924269    0.683123    4000        20.597322   0.224012    0.305997    117.223948 
[37m[36mINFO[0m[0m 03/12 00:47:24 | 0.334479    0.335624    0.939623    0.707968    1.224322    0.950051    0.602062    0.334479    0.335624    0.943975    0.842165    0.924842    0.679679    4200        21.627188   0.208511    0.211538    121.606031 
[37m[36mINFO[0m[0m 03/12 00:49:56 | 0.350802    0.348225    0.947673    0.705293    1.201937    0.946962    0.595876    0.350802    0.348225    0.959741    0.817362    0.936317    0.702641    4400        22.657055   0.196168    0.181691    115.998441 
[37m[36mINFO[0m[0m 03/12 00:52:39 | 0.326747    0.333333    0.953049    0.708321    1.207340    0.956746    0.604124    0.326747    0.333333    0.958052    0.834273    0.944349    0.686567    4600        23.686921   0.174046    0.215154    119.591606 
[37m[36mINFO[0m[0m 03/12 00:55:28 | 0.341924    0.341352    0.942558    0.687001    1.332282    0.953141    0.575258    0.341924    0.341352    0.945101    0.807215    0.929432    0.678530    4800        24.716787   0.189917    0.262596    116.944838 
[37m[36mINFO[0m[0m 03/12 00:58:26 | 0.355956    0.383734    0.962522    0.718287    1.152391    0.973223    0.602062    0.355956    0.383734    0.963682    0.844419    0.950660    0.708381    5000        25.746653   0.162455    0.304163    117.152846 
[37m[36mINFO[0m[0m 03/12 00:58:27 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[1]/250311_23-46-04_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/12 00:58:28 | ---
[37m[36mINFO[0m[0m 03/12 00:58:28 | test-domain validation(oracle) = 35.596%
[37m[36mINFO[0m[0m 03/12 00:58:28 | training-domain validation(iid) = 35.596%
[37m[36mINFO[0m[0m 03/12 00:58:28 | last = 35.596%
[37m[36mINFO[0m[0m 03/12 00:58:28 | last (inD) = 71.829%
[37m[36mINFO[0m[0m 03/12 00:58:28 | training-domain validation (iid, inD) = 71.829%
[37m[36mINFO[0m[0m 03/12 00:58:28 | === Summary ===
[37m[36mINFO[0m[0m 03/12 00:58:28 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 1 --hparams_seed 11
[37m[36mINFO[0m[0m 03/12 00:58:28 | Unique name: 250311_23-46-04_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 00:58:28 | Out path: train_output/OfficeHome/ERM/[1]/250311_23-46-04_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 00:58:28 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/12 00:58:28 | Dataset: OfficeHome

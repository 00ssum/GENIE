[37m[36mINFO[0m[0m 03/12 03:26:50 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 1 --hparams_seed 16
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 16
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/OfficeHome/ERM/[1]/250312_03-26-50_clip_vitb16_GENIE
	out_root: train_output/OfficeHome/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250312_03-26-50_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.3198033474735314e-05
	batch_size: 10
	weight_decay: 0.001844990356992375
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/12 03:26:50 | n_steps = 5001
[37m[36mINFO[0m[0m 03/12 03:26:50 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/12 03:26:50 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/12 03:26:50 | 
[37m[36mINFO[0m[0m 03/12 03:26:50 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/12 03:26:50 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/12 03:26:50 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/12 03:26:50 | Batch sizes for each domain: [10, 0, 10, 10] (total=30)
[37m[36mINFO[0m[0m 03/12 03:26:50 | steps-per-epoch for each domain: 194.20, 355.20, 348.60 -> min = 194.20
[37m[36mINFO[0m[0m 03/12 03:26:52 | # of params = 86225985
[37m[36mINFO[0m[0m 03/12 03:28:52 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/12 03:28:52 | 0.026919    0.021764    0.013377    0.014560    4.207397    0.010299    0.006186    0.026919    0.021764    0.015203    0.021421    0.014630    0.016073    0           0.000000    4.188606    0.948216    119.090879 
[37m[36mINFO[0m[0m 03/12 03:31:46 | 0.060424    0.048110    0.086412    0.098079    3.744665    0.080844    0.092784    0.060424    0.048110    0.092905    0.095829    0.085485    0.105626    200         1.029866    4.019774    0.304865    113.093309 
[37m[36mINFO[0m[0m 03/12 03:34:33 | 0.128580    0.126002    0.294657    0.270056    2.954146    0.237384    0.208247    0.128580    0.126002    0.333333    0.295378    0.313253    0.306544    400         2.059732    3.408681    0.261687    114.750827 
[37m[36mINFO[0m[0m 03/12 03:37:07 | 0.189576    0.183276    0.419391    0.395173    2.330079    0.369207    0.360825    0.189576    0.183276    0.455518    0.418264    0.433448    0.406429    600         3.089598    2.461180    0.199774    113.603839 
[37m[36mINFO[0m[0m 03/12 03:39:45 | 0.251718    0.239404    0.555584    0.497730    1.917274    0.460350    0.381443    0.251718    0.239404    0.658784    0.604284    0.547619    0.507463    800         4.119464    1.848280    0.219156    114.552519 
[37m[36mINFO[0m[0m 03/12 03:42:32 | 0.250286    0.235968    0.620919    0.546149    1.740842    0.550463    0.451546    0.250286    0.235968    0.702140    0.638106    0.610155    0.548794    1000        5.149331    1.569841    0.264601    113.657604 
[37m[36mINFO[0m[0m 03/12 03:45:31 | 0.290378    0.285223    0.674446    0.581465    1.596091    0.604531    0.459794    0.290378    0.285223    0.758164    0.694476    0.660643    0.590126    1200        6.179197    1.273991    0.303644    118.077590 
[37m[36mINFO[0m[0m 03/12 03:48:09 | 0.294101    0.295533    0.735639    0.644811    1.368553    0.690010    0.556701    0.294101    0.295533    0.804054    0.749718    0.712851    0.628014    1400        7.209063    1.137234    0.210536    116.005632 
[37m[36mINFO[0m[0m 03/12 03:50:43 | 0.269473    0.285223    0.733351    0.608082    1.450845    0.675592    0.513402    0.269473    0.285223    0.798986    0.703495    0.725473    0.607348    1600        8.238929    1.053981    0.191677    115.845079 
[37m[36mINFO[0m[0m 03/12 03:53:24 | 0.269473    0.287514    0.791695    0.659355    1.288053    0.765705    0.548454    0.269473    0.287514    0.844032    0.800451    0.765347    0.629162    1800        9.268795    0.847506    0.235700    114.256217 
[37m[36mINFO[0m[0m 03/12 03:56:24 | 0.305269    0.311569    0.788601    0.632970    1.393005    0.759011    0.536082    0.305269    0.311569    0.844313    0.748591    0.762478    0.614237    2000        10.298661   0.783858    0.306182    118.216607 
[37m[36mINFO[0m[0m 03/12 03:59:15 | 0.304124    0.305842    0.813856    0.648445    1.340015    0.794027    0.527835    0.304124    0.305842    0.858671    0.772266    0.788870    0.645235    2200        11.328527   0.687599    0.281483    114.804615 
[37m[36mINFO[0m[0m 03/12 04:01:54 | 0.337342    0.355097    0.837416    0.656308    1.277230    0.813594    0.519588    0.337342    0.355097    0.886261    0.789177    0.812392    0.660161    2400        12.358393   0.594499    0.193878    120.664505 
[37m[36mINFO[0m[0m 03/12 04:04:34 | 0.313288    0.335624    0.860404    0.679660    1.195005    0.844490    0.567010    0.313288    0.335624    0.890766    0.807215    0.845955    0.664753    2600        13.388260   0.544930    0.195794    120.998610 
[37m[36mINFO[0m[0m 03/12 04:07:18 | 0.337915    0.326460    0.866022    0.676107    1.280203    0.867147    0.571134    0.337915    0.326460    0.894144    0.799324    0.836776    0.657865    2800        14.418126   0.459368    0.240059    116.093906 
[37m[36mINFO[0m[0m 03/12 04:10:16 | 0.310710    0.328751    0.868309    0.662177    1.315550    0.855819    0.525773    0.310710    0.328751    0.903153    0.792559    0.845955    0.668197    3000        15.447992   0.410352    0.304326    116.803231 
[37m[36mINFO[0m[0m 03/12 04:13:09 | 0.325315    0.339061    0.880514    0.664889    1.292677    0.881050    0.536082    0.325315    0.339061    0.907939    0.785795    0.852553    0.672790    3200        16.477858   0.423419    0.294812    114.097260 
[37m[36mINFO[0m[0m 03/12 04:15:45 | 0.309278    0.318442    0.912185    0.695764    1.193057    0.920700    0.573196    0.309278    0.318442    0.923142    0.826381    0.892714    0.687715    3400        17.507724   0.359433    0.200941    115.647377 
[37m[36mINFO[0m[0m 03/12 04:18:19 | 0.335911    0.344788    0.922513    0.690476    1.206048    0.931514    0.562887    0.335911    0.344788    0.933559    0.816234    0.902467    0.692308    3600        18.537590   0.311585    0.203310    113.613583 
[37m[36mINFO[0m[0m 03/12 04:21:11 | 0.299542    0.312715    0.901346    0.673881    1.307730    0.893924    0.536082    0.299542    0.312715    0.923423    0.817362    0.886690    0.668197    3800        19.567456   0.270178    0.274230    116.661484 
[37m[36mINFO[0m[0m 03/12 04:24:10 | 0.316151    0.311569    0.915321    0.674638    1.313274    0.929454    0.527835    0.316151    0.311569    0.918919    0.807215    0.897590    0.688863    4000        20.597322   0.311251    0.303803    118.667507 
[37m[36mINFO[0m[0m 03/12 04:26:56 | 0.331901    0.363116    0.944248    0.694464    1.231600    0.942842    0.554639    0.331901    0.363116    0.951577    0.841037    0.938325    0.687715    4200        21.627188   0.238670    0.226364    120.569846 
[37m[36mINFO[0m[0m 03/12 04:29:26 | 0.351661    0.367698    0.952624    0.697449    1.207400    0.964985    0.589691    0.351661    0.367698    0.960586    0.824126    0.932301    0.678530    4400        22.657055   0.205023    0.182168    113.597916 
[37m[36mINFO[0m[0m 03/12 04:32:06 | 0.326747    0.336770    0.953350    0.714842    1.164962    0.955716    0.612371    0.326747    0.336770    0.961993    0.843292    0.942341    0.688863    4600        23.686921   0.187817    0.214617    117.114782 
[37m[36mINFO[0m[0m 03/12 04:35:04 | 0.340493    0.336770    0.948121    0.696898    1.243314    0.956231    0.573196    0.340493    0.336770    0.954110    0.828636    0.934022    0.688863    4800        24.716787   0.180041    0.296487    118.267972 
[37m[36mINFO[0m[0m 03/12 04:38:01 | 0.345074    0.372279    0.961444    0.705468    1.156628    0.971164    0.577320    0.345074    0.372279    0.965090    0.841037    0.948078    0.698048    5000        25.746653   0.167604    0.304044    116.154211 
[37m[36mINFO[0m[0m 03/12 04:38:01 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[1]/250312_03-26-50_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/12 04:38:03 | ---
[37m[36mINFO[0m[0m 03/12 04:38:03 | test-domain validation(oracle) = 34.507%
[37m[36mINFO[0m[0m 03/12 04:38:03 | training-domain validation(iid) = 32.675%
[37m[36mINFO[0m[0m 03/12 04:38:03 | last = 34.507%
[37m[36mINFO[0m[0m 03/12 04:38:03 | last (inD) = 70.547%
[37m[36mINFO[0m[0m 03/12 04:38:03 | training-domain validation (iid, inD) = 71.484%
[37m[36mINFO[0m[0m 03/12 04:38:03 | === Summary ===
[37m[36mINFO[0m[0m 03/12 04:38:03 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 1 --hparams_seed 16
[37m[36mINFO[0m[0m 03/12 04:38:03 | Unique name: 250312_03-26-50_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 04:38:03 | Out path: train_output/OfficeHome/ERM/[1]/250312_03-26-50_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 04:38:03 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/12 04:38:03 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 03/12 09:24:19 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 2 --hparams_seed 15
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 15
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/OfficeHome/ERM/[1]/250312_09-24-19_clip_vitb16_GENIE
	out_root: train_output/OfficeHome/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 2
	unique_name: 250312_09-24-19_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.00023237243746776078
	batch_size: 13
	weight_decay: 1.8132449266758068e-05
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/12 09:24:19 | n_steps = 5001
[37m[36mINFO[0m[0m 03/12 09:24:19 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/12 09:24:19 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/12 09:24:19 | 
[37m[36mINFO[0m[0m 03/12 09:24:19 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/12 09:24:19 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/12 09:24:19 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/12 09:24:19 | Batch sizes for each domain: [13, 0, 13, 13] (total=39)
[37m[36mINFO[0m[0m 03/12 09:24:19 | steps-per-epoch for each domain: 149.38, 273.23, 268.15 -> min = 149.38
[37m[36mINFO[0m[0m 03/12 09:24:21 | # of params = 86225985
[37m[36mINFO[0m[0m 03/12 09:26:18 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/12 09:26:18 | 0.014605    0.008018    0.017943    0.022198    4.196134    0.015448    0.026804    0.014605    0.008018    0.018300    0.021421    0.020080    0.018370    0           0.000000    4.215258    1.971216    114.276615 
[37m[36mINFO[0m[0m 03/12 09:29:05 | 0.036942    0.029782    0.071551    0.068280    3.963840    0.077755    0.068041    0.036942    0.029782    0.057151    0.052988    0.079748    0.083812    200         1.338826    4.074558    0.242992    118.711435 
[37m[36mINFO[0m[0m 03/12 09:31:49 | 0.117411    0.123711    0.245143    0.225554    3.091458    0.221936    0.191753    0.117411    0.123711    0.257038    0.227734    0.256454    0.257176    400         2.677652    3.630885    0.244377    114.759828 
[37m[36mINFO[0m[0m 03/12 09:34:32 | 0.195876    0.163803    0.427851    0.390995    2.350858    0.353244    0.303093    0.195876    0.163803    0.499155    0.457723    0.431153    0.412170    600         4.016478    2.593711    0.237348    115.542443 
[37m[36mINFO[0m[0m 03/12 09:37:15 | 0.253436    0.239404    0.596095    0.561903    1.675285    0.522657    0.459794    0.253436    0.239404    0.666948    0.639233    0.598680    0.586682    800         5.355304    1.691788    0.233608    116.440748 
[37m[36mINFO[0m[0m 03/12 09:39:58 | 0.282360    0.302405    0.690147    0.612238    1.455189    0.639032    0.492784    0.282360    0.302405    0.759291    0.714769    0.672117    0.629162    1000        6.694130    1.365051    0.242527    114.210327 
[37m[36mINFO[0m[0m 03/12 09:42:40 | 0.262600    0.266896    0.699074    0.606899    1.473761    0.654995    0.494845    0.262600    0.266896    0.763514    0.698985    0.678715    0.626866    1200        8.032956    1.128541    0.233383    115.371578 
[37m[36mINFO[0m[0m 03/12 09:45:17 | 0.325601    0.335624    0.787800    0.646781    1.313447    0.770855    0.546392    0.325601    0.335624    0.839245    0.741826    0.753299    0.652124    1400        9.371782    0.936608    0.219879    113.296114 
[37m[36mINFO[0m[0m 03/12 09:47:56 | 0.322165    0.319588    0.786655    0.658707    1.308813    0.777034    0.564948    0.322165    0.319588    0.831926    0.741826    0.751004    0.669346    1600        10.710608   0.812265    0.229651    112.955245 
[37m[36mINFO[0m[0m 03/12 09:50:40 | 0.309851    0.289805    0.797235    0.640828    1.373489    0.767250    0.507216    0.309851    0.289805    0.850788    0.768884    0.773666    0.646383    1800        12.049434   0.674110    0.234076    117.591259 
[37m[36mINFO[0m[0m 03/12 09:53:25 | 0.325888    0.331042    0.832680    0.677515    1.318745    0.818229    0.567010    0.325888    0.331042    0.866273    0.782413    0.813540    0.683123    2000        13.388260   0.587182    0.255040    114.031163 
[37m[36mINFO[0m[0m 03/12 09:56:15 | 0.323310    0.333333    0.887755    0.693502    1.209721    0.885685    0.573196    0.323310    0.333333    0.914414    0.820744    0.863167    0.686567    2200        14.727085   0.475904    0.286046    112.591193 
[37m[36mINFO[0m[0m 03/12 09:59:14 | 0.339061    0.352806    0.908777    0.697574    1.145475    0.903708    0.579381    0.339061    0.352806    0.929336    0.804961    0.893287    0.708381    2400        16.065911   0.392830    0.316488    115.919588 
[37m[36mINFO[0m[0m 03/12 10:02:12 | 0.355670    0.351661    0.924785    0.721520    1.099161    0.930999    0.587629    0.355670    0.351661    0.940315    0.843292    0.903041    0.733639    2600        17.404737   0.324080    0.313328    115.149172 
[37m[36mINFO[0m[0m 03/12 10:05:12 | 0.349943    0.337915    0.926914    0.701853    1.159887    0.929454    0.573196    0.349943    0.337915    0.945664    0.832018    0.905622    0.700344    2800        18.743563   0.297840    0.302426    119.796108 
[37m[36mINFO[0m[0m 03/12 10:08:00 | 0.342497    0.320733    0.934727    0.702638    1.156650    0.942842    0.564948    0.342497    0.320733    0.945101    0.817362    0.916236    0.725603    3000        20.082389   0.261643    0.263629    115.120751 
[37m[36mINFO[0m[0m 03/12 10:10:52 | 0.339347    0.336770    0.951626    0.733661    1.048535    0.966529    0.608247    0.339347    0.336770    0.957770    0.857948    0.930579    0.734788    3200        21.421215   0.237935    0.257667    120.228287 
[37m[36mINFO[0m[0m 03/12 10:13:30 | 0.355670    0.343643    0.955654    0.730493    1.120331    0.960865    0.602062    0.355670    0.343643    0.959741    0.851184    0.946357    0.738232    3400        22.760041   0.192350    0.227728    112.892260 
[37m[36mINFO[0m[0m 03/12 10:16:11 | 0.330470    0.327606    0.952903    0.718012    1.153736    0.959835    0.579381    0.330470    0.327606    0.962556    0.842165    0.936317    0.732491    3600        24.098867   0.168915    0.227796    115.218709 
[37m[36mINFO[0m[0m 03/12 10:18:54 | 0.341924    0.319588    0.961534    0.725404    1.148430    0.966014    0.595876    0.341924    0.319588    0.966779    0.845547    0.951807    0.734788    3800        25.437693   0.165360    0.227049    117.021120 
[37m[36mINFO[0m[0m 03/12 10:21:32 | 0.376861    0.380298    0.969931    0.746805    1.074436    0.977858    0.635052    0.376861    0.380298    0.973818    0.857948    0.958118    0.747417    4000        26.776519   0.120571    0.233345    111.327058 
[37m[36mINFO[0m[0m 03/12 10:24:14 | 0.345074    0.340206    0.965351    0.725020    1.137727    0.973738    0.606186    0.345074    0.340206    0.966779    0.844419    0.955536    0.724455    4200        28.115345   0.114816    0.239604    114.404753 
[37m[36mINFO[0m[0m 03/12 10:27:00 | 0.372852    0.357388    0.974478    0.742968    1.107515    0.978888    0.647423    0.372852    0.357388    0.974381    0.845547    0.970166    0.735936    4400        29.454171   0.100278    0.249799    116.091187 
[37m[36mINFO[0m[0m 03/12 10:29:48 | 0.360825    0.371134    0.970684    0.729967    1.138286    0.979403    0.606186    0.360825    0.371134    0.966498    0.848929    0.966150    0.734788    4600        30.792997   0.088224    0.270546    113.486614 
[37m[36mINFO[0m[0m 03/12 10:32:42 | 0.349943    0.351661    0.972497    0.735105    1.126022    0.976313    0.612371    0.349943    0.351661    0.970439    0.846674    0.970740    0.746269    4800        32.131823   0.098894    0.299752    114.538404 
[37m[36mINFO[0m[0m 03/12 10:35:41 | 0.353666    0.347079    0.970728    0.738153    1.147558    0.979918    0.630928    0.353666    0.347079    0.971565    0.859076    0.960700    0.724455    5000        33.470649   0.088522    0.317652    115.291768 
[37m[36mINFO[0m[0m 03/12 10:35:41 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[1]/250312_09-24-19_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/12 10:35:43 | ---
[37m[36mINFO[0m[0m 03/12 10:35:43 | test-domain validation(oracle) = 37.686%
[37m[36mINFO[0m[0m 03/12 10:35:43 | training-domain validation(iid) = 37.686%
[37m[36mINFO[0m[0m 03/12 10:35:43 | last = 35.367%
[37m[36mINFO[0m[0m 03/12 10:35:43 | last (inD) = 73.815%
[37m[36mINFO[0m[0m 03/12 10:35:43 | training-domain validation (iid, inD) = 74.681%
[37m[36mINFO[0m[0m 03/12 10:35:44 | === Summary ===
[37m[36mINFO[0m[0m 03/12 10:35:44 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 2 --hparams_seed 15
[37m[36mINFO[0m[0m 03/12 10:35:44 | Unique name: 250312_09-24-19_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 10:35:44 | Out path: train_output/OfficeHome/ERM/[1]/250312_09-24-19_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 10:35:44 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/12 10:35:44 | Dataset: OfficeHome

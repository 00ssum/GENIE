[37m[36mINFO[0m[0m 03/12 01:46:39 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 6
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 6
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/OfficeHome/ERM/[1]/250312_01-46-39_clip_vitb16_GENIE
	out_root: train_output/OfficeHome/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250312_01-46-39_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.5764387170443743e-05
	batch_size: 19
	weight_decay: 0.0006024239579587198
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/12 01:46:39 | n_steps = 5001
[37m[36mINFO[0m[0m 03/12 01:46:39 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/12 01:46:39 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/12 01:46:39 | 
[37m[36mINFO[0m[0m 03/12 01:46:39 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/12 01:46:39 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/12 01:46:39 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/12 01:46:39 | Batch sizes for each domain: [19, 0, 19, 19] (total=57)
[37m[36mINFO[0m[0m 03/12 01:46:39 | steps-per-epoch for each domain: 102.21, 186.95, 183.47 -> min = 102.21
[37m[36mINFO[0m[0m 03/12 01:46:41 | # of params = 86225985
[37m[36mINFO[0m[0m 03/12 01:48:37 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/12 01:48:37 | 0.012600    0.012600    0.016400    0.017330    4.196799    0.016478    0.014433    0.012600    0.012600    0.014077    0.018038    0.018646    0.019518    0           0.000000    4.151104    1.668903    114.557911 
[37m[36mINFO[0m[0m 03/12 01:51:42 | 0.129152    0.126002    0.249525    0.247462    3.082424    0.209063    0.235052    0.129152    0.126002    0.276745    0.257046    0.262765    0.250287    200         1.956746    3.760181    0.335231    117.828068 
[37m[36mINFO[0m[0m 03/12 01:54:55 | 0.242268    0.249714    0.586679    0.567610    1.712129    0.514418    0.468041    0.242268    0.249714    0.663288    0.656144    0.582329    0.578645    400         3.913491    2.335666    0.375943    117.734256 
[37m[36mINFO[0m[0m 03/12 01:58:15 | 0.295819    0.292096    0.721899    0.646065    1.335968    0.651390    0.519588    0.295819    0.292096    0.804899    0.774521    0.709409    0.644087    600         5.870237    1.270006    0.439417    111.622985 
[37m[36mINFO[0m[0m 03/12 02:01:39 | 0.318442    0.312715    0.790882    0.688983    1.147852    0.759526    0.567010    0.318442    0.312715    0.843468    0.784667    0.769650    0.715270    800         7.826982    0.902917    0.445018    115.854702 
[37m[36mINFO[0m[0m 03/12 02:05:05 | 0.340206    0.335624    0.844011    0.726395    1.028049    0.827497    0.635052    0.340206    0.335624    0.878660    0.816234    0.825875    0.727899    1000        9.783728    0.675218    0.445099    116.115413 
[37m[36mINFO[0m[0m 03/12 02:08:20 | 0.354525    0.373425    0.873042    0.735475    1.014887    0.855819    0.602062    0.354525    0.373425    0.910755    0.850056    0.852553    0.754305    1200        11.740474   0.490584    0.407840    114.101540 
[37m[36mINFO[0m[0m 03/12 02:11:29 | 0.364834    0.352806    0.905303    0.763990    0.924985    0.903193    0.665979    0.364834    0.352806    0.922297    0.860203    0.890419    0.765786    1400        13.697219   0.402487    0.367583    115.618031 
[37m[36mINFO[0m[0m 03/12 02:14:34 | 0.385739    0.367698    0.932110    0.763785    0.902919    0.939753    0.651546    0.385739    0.367698    0.938908    0.857948    0.917671    0.781860    1600        15.653965   0.291045    0.353175    113.744291 
[37m[36mINFO[0m[0m 03/12 02:17:42 | 0.397194    0.395189    0.941902    0.768384    0.925734    0.940783    0.670103    0.397194    0.395189    0.956926    0.866967    0.927998    0.768083    1800        17.610711   0.252077    0.354795    117.122382 
[37m[36mINFO[0m[0m 03/12 02:20:54 | 0.364548    0.356243    0.944589    0.775847    0.916293    0.951596    0.684536    0.364548    0.356243    0.950732    0.871477    0.931440    0.771527    2000        19.567456   0.217738    0.386883    114.469579 
[37m[36mINFO[0m[0m 03/12 02:24:20 | 0.359107    0.358534    0.954396    0.774599    0.906905    0.959320    0.678351    0.359107    0.358534    0.956363    0.863585    0.947504    0.781860    2200        21.524202   0.181693    0.441953    117.800227 
[37m[36mINFO[0m[0m 03/12 02:27:44 | 0.391180    0.380298    0.957667    0.772816    0.919117    0.957261    0.672165    0.391180    0.380298    0.965653    0.880496    0.950086    0.765786    2400        23.480947   0.132554    0.440601    116.426012 
[37m[36mINFO[0m[0m 03/12 02:31:00 | 0.391180    0.394044    0.961023    0.765040    0.950236    0.970134    0.657732    0.391180    0.394044    0.962275    0.864713    0.950660    0.772675    2600        25.437693   0.131832    0.397680    116.378667 
[37m[36mINFO[0m[0m 03/12 02:34:02 | 0.388030    0.382589    0.962766    0.775308    0.894573    0.966014    0.688660    0.388030    0.382589    0.968468    0.871477    0.953815    0.765786    2800        27.394439   0.131890    0.338051    114.208995 
[37m[36mINFO[0m[0m 03/12 02:37:03 | 0.408935    0.397480    0.972138    0.783305    0.900853    0.974768    0.668041    0.408935    0.397480    0.976070    0.880496    0.965577    0.801378    3000        29.351184   0.106664    0.332464    114.666876 
[37m[36mINFO[0m[0m 03/12 02:40:03 | 0.392612    0.402062    0.969002    0.792047    0.854859    0.969619    0.701031    0.392612    0.402062    0.973818    0.873732    0.963569    0.801378    3200        31.307930   0.107766    0.318217    115.897645 
[37m[36mINFO[0m[0m 03/12 02:43:04 | 0.396334    0.415808    0.974295    0.784238    0.905740    0.975798    0.684536    0.396334    0.415808    0.976633    0.875986    0.970453    0.792193    3400        33.264676   0.083599    0.328222    115.896403 
[37m[36mINFO[0m[0m 03/12 02:46:18 | 0.417526    0.391753    0.979062    0.794231    0.884577    0.983522    0.692784    0.417526    0.391753    0.977759    0.880496    0.975904    0.809414    3600        35.221421   0.093450    0.388898    115.991903 
[37m[36mINFO[0m[0m 03/12 02:49:44 | 0.406071    0.412371    0.986790    0.805864    0.791774    0.987127    0.705155    0.406071    0.412371    0.989020    0.904171    0.984223    0.808266    3800        37.178167   0.081090    0.436190    118.309958 
[37m[36mINFO[0m[0m 03/12 02:53:11 | 0.410653    0.388316    0.988551    0.807359    0.820945    0.991246    0.715464    0.410653    0.388316    0.988176    0.908681    0.986231    0.797933    4000        39.134912   0.060642    0.446652    117.863796 
[37m[36mINFO[0m[0m 03/12 02:56:25 | 0.393471    0.392898    0.983918    0.788799    0.912265    0.985067    0.682474    0.393471    0.392898    0.986768    0.894025    0.979920    0.789897    4200        41.091658   0.055036    0.403757    113.701232 
[37m[36mINFO[0m[0m 03/12 02:59:31 | 0.396334    0.383734    0.984655    0.781072    0.946137    0.986097    0.676289    0.396334    0.383734    0.985079    0.881623    0.982788    0.785304    4400        43.048404   0.054613    0.353524    114.671680 
[37m[36mINFO[0m[0m 03/12 03:02:34 | 0.412944    0.424971    0.986970    0.795783    0.896063    0.987642    0.711340    0.412944    0.424971    0.987613    0.887260    0.985657    0.788749    4600        45.005149   0.051435    0.325771    117.690546 
[37m[36mINFO[0m[0m 03/12 03:05:37 | 0.426690    0.420389    0.989492    0.799106    0.844866    0.988157    0.680412    0.426690    0.420389    0.994088    0.910936    0.986231    0.805970    4800        46.961895   0.047629    0.326214    118.257934 
[37m[36mINFO[0m[0m 03/12 03:08:45 | 0.436712    0.427262    0.989787    0.800954    0.880773    0.990731    0.692784    0.436712    0.427262    0.992399    0.907554    0.986231    0.802526    5000        48.918641   0.035003    0.359089    116.275194 
[37m[36mINFO[0m[0m 03/12 03:08:46 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[1]/250312_01-46-39_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/12 03:08:48 | ---
[37m[36mINFO[0m[0m 03/12 03:08:48 | test-domain validation(oracle) = 43.671%
[37m[36mINFO[0m[0m 03/12 03:08:48 | training-domain validation(iid) = 41.065%
[37m[36mINFO[0m[0m 03/12 03:08:48 | last = 43.671%
[37m[36mINFO[0m[0m 03/12 03:08:48 | last (inD) = 80.095%
[37m[36mINFO[0m[0m 03/12 03:08:48 | training-domain validation (iid, inD) = 80.736%
[37m[36mINFO[0m[0m 03/12 03:08:48 | === Summary ===
[37m[36mINFO[0m[0m 03/12 03:08:48 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 6
[37m[36mINFO[0m[0m 03/12 03:08:48 | Unique name: 250312_01-46-39_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 03:08:48 | Out path: train_output/OfficeHome/ERM/[1]/250312_01-46-39_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 03:08:48 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/12 03:08:48 | Dataset: OfficeHome

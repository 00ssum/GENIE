[37m[36mINFO[0m[0m 03/12 00:58:40 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 1 --hparams_seed 13
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 13
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/OfficeHome/ERM/[1]/250312_00-58-40_clip_vitb16_GENIE
	out_root: train_output/OfficeHome/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250312_00-58-40_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 6.984990754803203e-05
	batch_size: 13
	weight_decay: 2.888048423418205e-06
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/12 00:58:40 | n_steps = 5001
[37m[36mINFO[0m[0m 03/12 00:58:40 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/12 00:58:40 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/12 00:58:40 | 
[37m[36mINFO[0m[0m 03/12 00:58:40 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/12 00:58:40 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/12 00:58:40 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/12 00:58:40 | Batch sizes for each domain: [13, 0, 13, 13] (total=39)
[37m[36mINFO[0m[0m 03/12 00:58:40 | steps-per-epoch for each domain: 149.38, 273.23, 268.15 -> min = 149.38
[37m[36mINFO[0m[0m 03/12 00:58:42 | # of params = 86225985
[37m[36mINFO[0m[0m 03/12 01:00:40 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/12 01:00:40 | 0.016896    0.018328    0.014798    0.013148    4.204713    0.013388    0.014433    0.016896    0.018328    0.013795    0.013529    0.017212    0.011481    0           0.000000    4.196988    1.114904    116.962051 
[37m[36mINFO[0m[0m 03/12 01:03:24 | 0.097365    0.096220    0.175541    0.174143    3.376297    0.135427    0.140206    0.097365    0.096220    0.216498    0.192785    0.174699    0.189437    200         1.338826    3.849941    0.244505    115.666395 
[37m[36mINFO[0m[0m 03/12 01:06:17 | 0.187572    0.193585    0.446898    0.422875    2.238155    0.378476    0.354639    0.187572    0.193585    0.510698    0.494927    0.451520    0.419059    400         2.677652    2.740745    0.271850    118.205346 
[37m[36mINFO[0m[0m 03/12 01:09:17 | 0.243414    0.256586    0.610687    0.551738    1.733531    0.530896    0.451546    0.243414    0.256586    0.699043    0.662909    0.602123    0.540758    600         4.016478    1.799805    0.316167    116.928998 
[37m[36mINFO[0m[0m 03/12 01:12:23 | 0.270046    0.276060    0.679701    0.593853    1.510956    0.623069    0.484536    0.270046    0.276060    0.753097    0.705750    0.662937    0.591274    800         5.355304    1.310829    0.358008    114.134667 
[37m[36mINFO[0m[0m 03/12 01:15:24 | 0.286082    0.274914    0.708987    0.603651    1.477503    0.646241    0.476289    0.286082    0.274914    0.791104    0.719278    0.689616    0.615385    1000        6.694130    1.070765    0.332418    114.370327 
[37m[36mINFO[0m[0m 03/12 01:18:10 | 0.312715    0.328751    0.793226    0.677013    1.204533    0.760041    0.569072    0.312715    0.328751    0.832489    0.789177    0.787149    0.672790    1200        8.032956    0.894181    0.254816    115.012134 
[37m[36mINFO[0m[0m 03/12 01:20:59 | 0.342784    0.363116    0.804032    0.688656    1.216431    0.776004    0.593814    0.342784    0.363116    0.857264    0.797069    0.778830    0.675086    1400        9.371782    0.762696    0.233781    122.917489 
[37m[36mINFO[0m[0m 03/12 01:23:42 | 0.347938    0.360825    0.853254    0.699484    1.147948    0.836251    0.602062    0.347938    0.360825    0.891610    0.790304    0.831899    0.706085    1600        10.710608   0.659124    0.239089    114.759496 
[37m[36mINFO[0m[0m 03/12 01:26:35 | 0.331615    0.381443    0.856352    0.674820    1.207317    0.845520    0.544330    0.331615    0.381443    0.890203    0.800451    0.833333    0.679679    1800        12.049434   0.514382    0.281021    116.940231 
[37m[36mINFO[0m[0m 03/12 01:29:38 | 0.335624    0.350515    0.881184    0.709262    1.122713    0.872812    0.591753    0.335624    0.350515    0.912162    0.819617    0.858577    0.716418    2000        13.388260   0.441164    0.334193    115.494302 
[37m[36mINFO[0m[0m 03/12 01:32:44 | 0.349084    0.380298    0.917626    0.744756    0.978369    0.916066    0.639175    0.349084    0.380298    0.937500    0.854566    0.899312    0.740528    2200        14.727085   0.376096    0.357298    115.034663 
[37m[36mINFO[0m[0m 03/12 01:35:43 | 0.338202    0.364261    0.897993    0.712857    1.119758    0.897013    0.595876    0.338202    0.364261    0.920890    0.832018    0.876076    0.710677    2400        16.065911   0.302906    0.309441    117.484305 
[37m[36mINFO[0m[0m 03/12 01:38:28 | 0.354238    0.347079    0.929272    0.728886    1.054809    0.932029    0.626804    0.354238    0.347079    0.950450    0.835400    0.905336    0.724455    2600        17.404737   0.294066    0.241107    116.437729 
[37m[36mINFO[0m[0m 03/12 01:41:09 | 0.378866    0.398625    0.953583    0.739124    0.973355    0.964470    0.635052    0.378866    0.398625    0.963119    0.862458    0.933161    0.719862    2800        18.743563   0.238983    0.231478    114.489765 
[37m[36mINFO[0m[0m 03/12 01:43:58 | 0.368843    0.369989    0.954003    0.738405    1.040275    0.966014    0.637113    0.368843    0.369989    0.963119    0.842165    0.932874    0.735936    3000        20.082389   0.194664    0.259513    116.960374 
[37m[36mINFO[0m[0m 03/12 01:46:55 | 0.366552    0.365407    0.953241    0.749512    0.958155    0.961380    0.653608    0.366552    0.365407    0.960304    0.863585    0.938038    0.731343    3200        21.421215   0.160543    0.310797    114.966185 
[37m[36mINFO[0m[0m 03/12 01:49:41 | 0.394616    0.407789    0.974749    0.769690    0.889430    0.978373    0.674227    0.394616    0.407789    0.980011    0.878241    0.965863    0.756602    3400        22.760041   0.143643    0.260930    114.205412 
[37m[36mINFO[0m[0m 03/12 01:52:29 | 0.361111    0.359679    0.958165    0.748889    1.013197    0.961895    0.649485    0.361111    0.359679    0.964809    0.865840    0.947791    0.731343    3600        24.098867   0.119022    0.261877    115.360141 
[37m[36mINFO[0m[0m 03/12 01:55:21 | 0.392325    0.404353    0.974753    0.766221    0.964197    0.978373    0.643299    0.392325    0.404353    0.979448    0.886133    0.966437    0.769231    3800        25.437693   0.117205    0.298304    112.726709 
[37m[36mINFO[0m[0m 03/12 01:58:27 | 0.357961    0.371134    0.971396    0.747533    1.005685    0.977343    0.647423    0.357961    0.371134    0.972128    0.850056    0.964716    0.745121    4000        26.776519   0.098421    0.342155    117.549408 
[37m[36mINFO[0m[0m 03/12 02:01:35 | 0.357102    0.367698    0.977152    0.754503    0.980178    0.980433    0.632990    0.357102    0.367698    0.980856    0.863585    0.970166    0.766935    4200        28.115345   0.091493    0.357124    116.164300 
[37m[36mINFO[0m[0m 03/12 02:04:41 | 0.377148    0.408935    0.979439    0.771975    0.920675    0.979918    0.661856    0.377148    0.408935    0.985079    0.894025    0.973322    0.760046    4400        29.454171   0.090670    0.345809    117.191017 
[37m[36mINFO[0m[0m 03/12 02:07:43 | 0.345647    0.339061    0.976996    0.759668    0.979365    0.979918    0.657732    0.345647    0.339061    0.978322    0.866967    0.972748    0.754305    4600        30.792997   0.108437    0.306140    120.623893 
[37m[36mINFO[0m[0m 03/12 02:10:32 | 0.364548    0.361970    0.984371    0.772234    0.933916    0.986097    0.686598    0.364548    0.361970    0.984516    0.886133    0.982501    0.743972    4800        32.131823   0.074297    0.273847    114.102575 
[37m[36mINFO[0m[0m 03/12 02:13:21 | 0.377434    0.390607    0.982740    0.755873    1.001731    0.986097    0.635052    0.377434    0.390607    0.985360    0.877114    0.976764    0.755454    5000        33.470649   0.070163    0.238887    120.766472 
[37m[36mINFO[0m[0m 03/12 02:13:21 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[1]/250312_00-58-40_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/12 02:13:24 | ---
[37m[36mINFO[0m[0m 03/12 02:13:24 | test-domain validation(oracle) = 37.715%
[37m[36mINFO[0m[0m 03/12 02:13:24 | training-domain validation(iid) = 36.455%
[37m[36mINFO[0m[0m 03/12 02:13:24 | last = 37.743%
[37m[36mINFO[0m[0m 03/12 02:13:24 | last (inD) = 75.587%
[37m[36mINFO[0m[0m 03/12 02:13:24 | training-domain validation (iid, inD) = 77.223%
[37m[36mINFO[0m[0m 03/12 02:13:24 | === Summary ===
[37m[36mINFO[0m[0m 03/12 02:13:24 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 1 --hparams_seed 13
[37m[36mINFO[0m[0m 03/12 02:13:24 | Unique name: 250312_00-58-40_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 02:13:24 | Out path: train_output/OfficeHome/ERM/[1]/250312_00-58-40_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 02:13:24 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/12 02:13:24 | Dataset: OfficeHome

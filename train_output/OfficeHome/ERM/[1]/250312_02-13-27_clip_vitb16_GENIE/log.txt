[37m[36mINFO[0m[0m 03/12 02:13:27 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 1 --hparams_seed 14
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 14
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/OfficeHome/ERM/[1]/250312_02-13-27_clip_vitb16_GENIE
	out_root: train_output/OfficeHome/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250312_02-13-27_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.00011127987942826837
	batch_size: 12
	weight_decay: 3.236767350601091e-05
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/12 02:13:28 | n_steps = 5001
[37m[36mINFO[0m[0m 03/12 02:13:28 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/12 02:13:28 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/12 02:13:28 | 
[37m[36mINFO[0m[0m 03/12 02:13:28 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/12 02:13:28 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/12 02:13:28 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/12 02:13:28 | Batch sizes for each domain: [12, 0, 12, 12] (total=36)
[37m[36mINFO[0m[0m 03/12 02:13:28 | steps-per-epoch for each domain: 161.83, 296.00, 290.50 -> min = 161.83
[37m[36mINFO[0m[0m 03/12 02:13:30 | # of params = 86225985
[37m[36mINFO[0m[0m 03/12 02:15:30 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/12 02:15:30 | 0.023769    0.014891    0.013589    0.014729    4.203924    0.012873    0.012371    0.023769    0.014891    0.011543    0.018038    0.016351    0.013777    0           0.000000    4.193007    1.161489    118.723491 
[37m[36mINFO[0m[0m 03/12 02:18:18 | 0.098225    0.076747    0.154313    0.171386    3.491016    0.142636    0.167010    0.098225    0.076747    0.157939    0.164600    0.162364    0.182549    200         1.235839    3.909750    0.275677    113.164750 
[37m[36mINFO[0m[0m 03/12 02:21:15 | 0.182131    0.153494    0.389464    0.372870    2.443374    0.304840    0.325773    0.182131    0.153494    0.464527    0.402480    0.399025    0.390356    400         2.471679    2.965262    0.306565    115.747434 
[37m[36mINFO[0m[0m 03/12 02:24:20 | 0.231100    0.249714    0.561962    0.512248    1.885361    0.478373    0.422680    0.231100    0.249714    0.660755    0.603157    0.546758    0.510907    600         3.707518    2.008502    0.337753    117.545429 
[37m[36mINFO[0m[0m 03/12 02:27:22 | 0.256300    0.260023    0.610523    0.537733    1.743604    0.539650    0.445361    0.256300    0.260023    0.687500    0.613303    0.604418    0.554535    800         4.943357    1.484020    0.338722    114.648096 
[37m[36mINFO[0m[0m 03/12 02:30:16 | 0.275200    0.285223    0.692933    0.604943    1.447372    0.624614    0.470103    0.275200    0.285223    0.783502    0.733935    0.670683    0.610792    1000        6.179197    1.313074    0.280600    117.824706 
[37m[36mINFO[0m[0m 03/12 02:32:57 | 0.272623    0.287514    0.736599    0.629776    1.379866    0.701339    0.509278    0.272623    0.287514    0.795608    0.748591    0.712851    0.631458    1200        7.415036    1.117895    0.236096    113.406966 
[37m[36mINFO[0m[0m 03/12 02:35:36 | 0.329324    0.341352    0.748235    0.638853    1.378534    0.715242    0.531959    0.329324    0.341352    0.807432    0.750846    0.722031    0.633754    1400        8.650875    0.910422    0.227699    113.562521 
[37m[36mINFO[0m[0m 03/12 02:38:16 | 0.301260    0.303551    0.803218    0.658074    1.278346    0.774974    0.556701    0.301260    0.303551    0.856137    0.771139    0.778543    0.646383    1600        9.886715    0.804269    0.218792    116.112569 
[37m[36mINFO[0m[0m 03/12 02:41:01 | 0.306987    0.332188    0.828087    0.679352    1.232039    0.818744    0.602062    0.306987    0.332188    0.863739    0.765502    0.801779    0.670494    1800        11.122554   0.693229    0.247002    115.603633 
[37m[36mINFO[0m[0m 03/12 02:43:48 | 0.302119    0.344788    0.845778    0.673641    1.218018    0.824923    0.556701    0.302119    0.344788    0.886824    0.791432    0.825588    0.672790    2000        12.358393   0.567872    0.255794    116.157700 
[37m[36mINFO[0m[0m 03/12 02:46:41 | 0.312428    0.341352    0.868352    0.680587    1.260413    0.853244    0.573196    0.312428    0.341352    0.896678    0.804961    0.855135    0.663605    2200        13.594233   0.500769    0.292300    114.480744 
[37m[36mINFO[0m[0m 03/12 02:49:44 | 0.331901    0.332188    0.894119    0.704879    1.117048    0.895984    0.583505    0.331901    0.332188    0.919764    0.836528    0.866609    0.694604    2400        14.830072   0.436063    0.331517    115.887743 
[37m[36mINFO[0m[0m 03/12 02:52:47 | 0.362829    0.387171    0.903463    0.710794    1.127375    0.911432    0.600000    0.362829    0.387171    0.921734    0.830891    0.877223    0.701493    2600        16.065911   0.367665    0.336648    116.145022 
[37m[36mINFO[0m[0m 03/12 02:55:42 | 0.347079    0.371134    0.907185    0.693435    1.212111    0.904737    0.552577    0.347079    0.371134    0.932995    0.834273    0.883821    0.693456    2800        17.301751   0.285909    0.299163    115.651237 
[37m[36mINFO[0m[0m 03/12 02:58:25 | 0.322451    0.332188    0.910178    0.689085    1.274373    0.909372    0.589691    0.322451    0.332188    0.930743    0.815107    0.890419    0.662457    3000        18.537590   0.301761    0.239235    114.447503 
[37m[36mINFO[0m[0m 03/12 03:01:06 | 0.353952    0.382589    0.925119    0.699753    1.207570    0.920185    0.579381    0.353952    0.382589    0.937500    0.824126    0.917671    0.695752    3200        19.773429   0.276192    0.225589    116.463682 
[37m[36mINFO[0m[0m 03/12 03:03:48 | 0.343356    0.358534    0.935203    0.718675    1.163941    0.934089    0.604124    0.343356    0.358534    0.952703    0.830891    0.918818    0.721010    3400        21.009269   0.216658    0.225474    116.297248 
[37m[36mINFO[0m[0m 03/12 03:06:33 | 0.367411    0.381443    0.946671    0.732461    1.107699    0.954686    0.620619    0.367411    0.381443    0.950732    0.852311    0.934596    0.724455    3600        22.245108   0.198056    0.239268    117.318757 
[37m[36mINFO[0m[0m 03/12 03:09:21 | 0.360825    0.364261    0.952933    0.739967    1.087805    0.959320    0.632990    0.360825    0.364261    0.960867    0.862458    0.938612    0.724455    3800        23.480947   0.160952    0.273077    113.452505 
[37m[36mINFO[0m[0m 03/12 03:11:59 | 0.357102    0.395189    0.966469    0.756350    1.041969    0.971679    0.655670    0.357102    0.395189    0.968750    0.859076    0.958979    0.754305    4000        24.716787   0.154909    0.215675    114.739105 
[37m[36mINFO[0m[0m 03/12 03:14:51 | 0.342211    0.356243    0.963565    0.743436    1.071089    0.970134    0.620619    0.342211    0.356243    0.968468    0.872604    0.952094    0.737084    4200        25.952626   0.138708    0.273384    117.192996 
[37m[36mINFO[0m[0m 03/12 03:18:01 | 0.349370    0.378007    0.966255    0.731656    1.131922    0.972194    0.635052    0.349370    0.378007    0.969313    0.832018    0.957258    0.727899    4400        27.188465   0.123146    0.339764    121.817372 
[37m[36mINFO[0m[0m 03/12 03:21:05 | 0.361397    0.396334    0.970719    0.741150    1.087702    0.972709    0.632990    0.361397    0.396334    0.971002    0.856821    0.968445    0.733639    4600        28.424305   0.114420    0.338898    116.895413 
[37m[36mINFO[0m[0m 03/12 03:23:51 | 0.360252    0.363116    0.968883    0.746487    1.066586    0.971164    0.632990    0.360252    0.363116    0.968187    0.860203    0.967298    0.746269    4800        29.660144   0.103584    0.256659    114.350376 
[37m[36mINFO[0m[0m 03/12 03:26:35 | 0.372279    0.386025    0.977494    0.747266    1.050932    0.976313    0.632990    0.372279    0.386025    0.981700    0.857948    0.974469    0.750861    5000        30.895984   0.082645    0.223342    119.749732 
[37m[36mINFO[0m[0m 03/12 03:26:36 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[1]/250312_02-13-27_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/12 03:26:38 | ---
[37m[36mINFO[0m[0m 03/12 03:26:38 | test-domain validation(oracle) = 36.140%
[37m[36mINFO[0m[0m 03/12 03:26:38 | training-domain validation(iid) = 35.710%
[37m[36mINFO[0m[0m 03/12 03:26:38 | last = 37.228%
[37m[36mINFO[0m[0m 03/12 03:26:38 | last (inD) = 74.727%
[37m[36mINFO[0m[0m 03/12 03:26:38 | training-domain validation (iid, inD) = 75.635%
[37m[36mINFO[0m[0m 03/12 03:26:38 | === Summary ===
[37m[36mINFO[0m[0m 03/12 03:26:38 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset OfficeHome --trial_seed 1 --hparams_seed 14
[37m[36mINFO[0m[0m 03/12 03:26:38 | Unique name: 250312_02-13-27_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 03:26:38 | Out path: train_output/OfficeHome/ERM/[1]/250312_02-13-27_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 03:26:38 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/12 03:26:38 | Dataset: OfficeHome

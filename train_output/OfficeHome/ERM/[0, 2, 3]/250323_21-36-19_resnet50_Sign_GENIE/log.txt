[37m[36mINFO[0m[0m 03/23 21:36:19 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 2 3 --dataset OfficeHome --trial_seed 1 --hparams_seed 7
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 7
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/OfficeHome/ERM/[0, 2, 3]/250323_21-36-19_resnet50_Sign_GENIE
	out_root: train_output/OfficeHome/ERM/[0, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 2, 3]
	trial_seed: 1
	unique_name: 250323_21-36-19_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00025471109765784857
	batch_size: 39
	weight_decay: 9.10622179414602e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/23 21:36:19 | n_steps = 5001
[37m[36mINFO[0m[0m 03/23 21:36:19 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/23 21:36:19 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/23 21:36:19 | 
[37m[36mINFO[0m[0m 03/23 21:36:19 | Testenv name escaping te_A_P_R -> te_A_P_R
[37m[36mINFO[0m[0m 03/23 21:36:19 | Test envs = [0, 2, 3], name = te_A_P_R
[37m[36mINFO[0m[0m 03/23 21:36:19 | Train environments: [1], Test environments: [0, 2, 3]
[37m[36mINFO[0m[0m 03/23 21:36:19 | Batch sizes for each domain: [0, 39, 0, 0] (total=39)
[37m[36mINFO[0m[0m 03/23 21:36:19 | steps-per-epoch for each domain: 89.54 -> min = 89.54
[37m[36mINFO[0m[0m 03/23 21:36:20 | # of params = 23641217
[37m[36mINFO[0m[0m 03/23 21:38:03 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/23 21:38:03 | 0.013896    0.012721    0.022050    0.022910    4.203294    0.018023    0.016495    0.022050    0.022910    0.007601    0.007892    0.016064    0.013777    0           0.000000    4.331522    1.094186    101.285135 
[37m[36mINFO[0m[0m 03/23 21:40:28 | 0.441067    0.431477    0.701890    0.633448    1.406088    0.358393    0.367010    0.701890    0.633448    0.480011    0.450958    0.484796    0.476464    200         2.233677    2.434843    0.212341    102.457493 
[37m[36mINFO[0m[0m 03/23 21:42:58 | 0.532621    0.524972    0.839061    0.718213    1.136303    0.454171    0.484536    0.839061    0.718213    0.561937    0.517475    0.581756    0.572905    400         4.467354    0.906599    0.239063    102.127188 
[37m[36mINFO[0m[0m 03/23 21:45:22 | 0.518538    0.513233    0.867984    0.725086    1.190344    0.417611    0.449485    0.867984    0.725086    0.559403    0.526494    0.578600    0.563720    600         6.701031    0.589017    0.187721    106.884776 
[37m[36mINFO[0m[0m 03/23 21:47:51 | 0.530151    0.528079    0.920389    0.741123    1.097520    0.451081    0.480412    0.920389    0.741123    0.577984    0.535513    0.561388    0.568312    800         8.934708    0.399466    0.212794    106.929047 
[37m[36mINFO[0m[0m 03/23 21:50:21 | 0.546212    0.545171    0.934135    0.739977    1.147151    0.466014    0.488660    0.934135    0.739977    0.579392    0.568207    0.593230    0.578645    1000        11.168385   0.290956    0.232423    102.620983 
[37m[36mINFO[0m[0m 03/23 21:52:48 | 0.530783    0.513954    0.943585    0.752577    1.092660    0.446447    0.461856    0.943585    0.752577    0.566441    0.519729    0.579461    0.560276    1200        13.402062   0.232695    0.215096    104.446103 
[37m[36mINFO[0m[0m 03/23 21:55:10 | 0.526361    0.525386    0.959336    0.757159    1.240731    0.440268    0.480412    0.959336    0.757159    0.561937    0.537768    0.576879    0.557979    1400        15.635739   0.201875    0.192880    103.597782 
[37m[36mINFO[0m[0m 03/23 21:57:38 | 0.527361    0.524298    0.962486    0.731959    1.358174    0.440783    0.457732    0.962486    0.731959    0.567005    0.543405    0.574297    0.571757    1600        17.869416   0.162480    0.213886    104.626905 
[37m[36mINFO[0m[0m 03/23 22:00:05 | 0.524517    0.524896    0.965922    0.739977    1.394468    0.455201    0.509278    0.965922    0.739977    0.536881    0.501691    0.581469    0.563720    1800        20.103093   0.157746    0.213624    104.741819 
[37m[36mINFO[0m[0m 03/23 22:02:26 | 0.529815    0.542472    0.970218    0.757159    1.325743    0.444902    0.494845    0.970218    0.757159    0.562500    0.533258    0.582042    0.599311    2000        22.336770   0.120055    0.188875    102.643965 
[37m[36mINFO[0m[0m 03/23 22:04:54 | 0.545117    0.550096    0.976804    0.760596    1.269823    0.455201    0.515464    0.976804    0.760596    0.575732    0.535513    0.604418    0.599311    2200        24.570447   0.127089    0.231197    102.068424 
[37m[36mINFO[0m[0m 03/23 22:07:23 | 0.522476    0.530332    0.974800    0.752577    1.302031    0.428424    0.482474    0.974800    0.752577    0.552083    0.529876    0.586919    0.578645    2400        26.804124   0.115684    0.223331    104.048149 
[37m[36mINFO[0m[0m 03/23 22:09:49 | 0.528947    0.534244    0.977950    0.752577    1.392998    0.447992    0.498969    0.977950    0.752577    0.560248    0.538895    0.578600    0.564868    2600        29.037801   0.094300    0.197581    106.668643 
[37m[36mINFO[0m[0m 03/23 22:12:17 | 0.554874    0.549000    0.976804    0.765178    1.289661    0.474768    0.521649    0.976804    0.765178    0.578266    0.551297    0.611589    0.574053    2800        31.271478   0.094457    0.220048    104.443417 
[37m[36mINFO[0m[0m 03/23 22:14:44 | 0.528426    0.527131    0.979095    0.764032    1.331676    0.423790    0.474227    0.979095    0.764032    0.576577    0.541150    0.584911    0.566016    3000        33.505155   0.073439    0.216961    102.947800 
[37m[36mINFO[0m[0m 03/23 22:17:08 | 0.525752    0.540874    0.975659    0.769759    1.480350    0.442327    0.492784    0.975659    0.769759    0.555180    0.556933    0.579748    0.572905    3200        35.738832   0.074488    0.199392    104.196761 
[37m[36mINFO[0m[0m 03/23 22:19:33 | 0.532129    0.533196    0.974800    0.770905    1.186282    0.445932    0.486598    0.974800    0.770905    0.553209    0.536640    0.597246    0.576349    3400        37.972509   0.083231    0.212318    103.120073 
[37m[36mINFO[0m[0m 03/23 22:22:02 | 0.528421    0.536406    0.972222    0.765178    1.285244    0.446447    0.492784    0.972222    0.765178    0.561937    0.536640    0.576879    0.579793    3600        40.206186   0.083579    0.222545    104.512347 
[37m[36mINFO[0m[0m 03/23 22:24:26 | 0.541480    0.537925    0.981672    0.772050    1.359288    0.459835    0.490722    0.981672    0.772050    0.578547    0.551297    0.586059    0.571757    3800        42.439863   0.060686    0.200026    103.540434 
[37m[36mINFO[0m[0m 03/23 22:26:51 | 0.538786    0.540864    0.980813    0.764032    1.370845    0.458805    0.505155    0.980813    0.764032    0.572354    0.544532    0.585198    0.572905    4000        44.673540   0.054551    0.215081    102.640515 
[37m[36mINFO[0m[0m 03/23 22:29:18 | 0.550016    0.550850    0.984822    0.784651    1.402085    0.463440    0.513402    0.984822    0.784651    0.583052    0.550169    0.603557    0.588978    4200        46.907216   0.060578    0.209461    104.880534 
[37m[36mINFO[0m[0m 03/23 22:31:43 | 0.542994    0.556993    0.980527    0.760596    1.446823    0.461380    0.523711    0.980527    0.760596    0.571791    0.545660    0.595812    0.601607    4400        49.140893   0.051889    0.199775    104.428660 
[37m[36mINFO[0m[0m 03/23 22:34:09 | 0.533513    0.536708    0.984822    0.772050    1.443580    0.464470    0.515464    0.984822    0.772050    0.555462    0.534386    0.580608    0.560276    4600        51.374570   0.066752    0.202436    105.438165 
[37m[36mINFO[0m[0m 03/23 22:36:34 | 0.539172    0.531050    0.981959    0.778923    1.388970    0.451081    0.472165    0.981959    0.778923    0.572917    0.538895    0.593517    0.582090    4800        53.608247   0.052887    0.210562    103.180960 
[37m[36mINFO[0m[0m 03/23 22:38:57 | 0.518813    0.521024    0.981672    0.773196    1.294741    0.429969    0.478351    0.981672    0.773196    0.547297    0.512965    0.579174    0.571757    5000        55.841924   0.056195    0.202933    102.833580 
[37m[36mINFO[0m[0m 03/23 22:38:57 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[0, 2, 3]/250323_21-36-19_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/23 22:38:58 | ---
[37m[36mINFO[0m[0m 03/23 22:38:58 | test-domain validation(oracle) = 54.299%
[37m[36mINFO[0m[0m 03/23 22:38:58 | training-domain validation(iid) = 55.002%
[37m[36mINFO[0m[0m 03/23 22:38:58 | last = 51.881%
[37m[36mINFO[0m[0m 03/23 22:38:58 | last (inD) = 77.320%
[37m[36mINFO[0m[0m 03/23 22:38:58 | training-domain validation (iid, inD) = 78.465%
[37m[36mINFO[0m[0m 03/23 22:38:59 | === Summary ===
[37m[36mINFO[0m[0m 03/23 22:38:59 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 2 3 --dataset OfficeHome --trial_seed 1 --hparams_seed 7
[37m[36mINFO[0m[0m 03/23 22:38:59 | Unique name: 250323_21-36-19_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/23 22:38:59 | Out path: train_output/OfficeHome/ERM/[0, 2, 3]/250323_21-36-19_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/23 22:38:59 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/23 22:38:59 | Dataset: OfficeHome

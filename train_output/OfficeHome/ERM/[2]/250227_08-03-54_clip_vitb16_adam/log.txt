[37m[36mINFO[0m[0m 02/27 08:03:54 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_adam config/clip_vitb16_adam.yaml --algorithm ERM --test_envs 2 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_adam.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_adam
	out_dir: train_output/OfficeHome/ERM/[2]/250227_08-03-54_clip_vitb16_adam
	out_root: train_output/OfficeHome/ERM/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250227_08-03-54_clip_vitb16_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: clip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/27 08:03:54 | n_steps = 5001
[37m[36mINFO[0m[0m 02/27 08:03:54 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/27 08:03:54 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/27 08:03:54 | 
[37m[36mINFO[0m[0m 02/27 08:03:54 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 02/27 08:03:54 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 02/27 08:03:54 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 02/27 08:03:54 | Batch sizes for each domain: [32, 32, 0, 32] (total=96)
[37m[36mINFO[0m[0m 02/27 08:03:54 | steps-per-epoch for each domain: 60.69, 109.12, 108.94 -> min = 60.69
[37m[36mINFO[0m[0m 02/27 08:03:57 | # of params = 86225985
[37m[36mINFO[0m[0m 02/27 08:06:13 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/27 08:06:13 | 0.038570    0.041714    0.057780    0.062052    4.149326    0.074150    0.078351    0.037801    0.050401    0.038570    0.041714    0.061388    0.057405    0           0.000000    4.178164    1.230325    135.245780 
[37m[36mINFO[0m[0m 02/27 08:10:27 | 0.757038    0.757610    0.836561    0.768406    0.940269    0.857878    0.744330    0.801260    0.733104    0.757038    0.757610    0.850545    0.827784    200         3.295572    1.426678    0.595234    134.209777 
[37m[36mINFO[0m[0m 02/27 08:14:43 | 0.730293    0.730552    0.892118    0.763659    0.925766    0.924820    0.738144    0.859393    0.741123    0.730293    0.730552    0.892140    0.811711    400         6.591143    0.510702    0.595912    136.701857 
[37m[36mINFO[0m[0m 02/27 08:18:47 | 0.749718    0.729425    0.927484    0.777345    0.921865    0.962410    0.760825    0.888603    0.737686    0.749718    0.729425    0.931440    0.833525    600         9.886715    0.313163    0.559912    132.755218 
[37m[36mINFO[0m[0m 02/27 08:22:59 | 0.739865    0.742954    0.945762    0.780926    0.904021    0.971679    0.756701    0.915235    0.764032    0.739865    0.742954    0.950373    0.822044    800         13.182286   0.258698    0.587232    134.235847 
[37m[36mINFO[0m[0m 02/27 08:27:00 | 0.718187    0.674183    0.941174    0.754478    1.006557    0.966529    0.717526    0.920962    0.757159    0.718187    0.674183    0.936030    0.788749    1000        16.477858   0.228713    0.551434    131.065928 
[37m[36mINFO[0m[0m 02/27 08:31:01 | 0.733953    0.710259    0.958047    0.776337    0.985693    0.967559    0.746392    0.943013    0.769759    0.733953    0.710259    0.963569    0.812859    1200        19.773429   0.205345    0.575607    125.725044 
[37m[36mINFO[0m[0m 02/27 08:35:02 | 0.757601    0.730552    0.964307    0.785731    0.964661    0.976313    0.740206    0.950458    0.801833    0.757601    0.730552    0.966150    0.815155    1400        23.069001   0.153151    0.595581    121.677677 
[37m[36mINFO[0m[0m 02/27 08:38:55 | 0.738457    0.728298    0.960373    0.771972    1.069332    0.971679    0.760825    0.948740    0.757159    0.738457    0.728298    0.960700    0.797933    1600        26.364573   0.113084    0.561195    120.412463 
[37m[36mINFO[0m[0m 02/27 08:42:53 | 0.719032    0.693348    0.964806    0.775037    1.024247    0.975798    0.740206    0.948167    0.774341    0.719032    0.693348    0.970453    0.810563    1800        29.660144   0.155818    0.585619    120.891778 
[37m[36mINFO[0m[0m 02/27 08:46:53 | 0.741554    0.719278    0.970110    0.769982    1.080079    0.981977    0.742268    0.959622    0.776632    0.741554    0.719278    0.968732    0.791045    2000        32.955716   0.122531    0.589527    122.096751 
[37m[36mINFO[0m[0m 02/27 08:50:58 | 0.730574    0.715896    0.974813    0.773802    1.029150    0.981462    0.731959    0.964490    0.796105    0.730574    0.715896    0.978485    0.793341    2200        36.251287   0.114782    0.610886    123.443642 
[37m[36mINFO[0m[0m 02/27 08:54:58 | 0.738176    0.723788    0.961042    0.768458    1.116775    0.974253    0.742268    0.944158    0.767468    0.738176    0.723788    0.964716    0.795637    2400        39.546859   0.121857    0.562819    127.208608 
[37m[36mINFO[0m[0m 02/27 08:58:57 | 0.713964    0.704622    0.964173    0.766547    1.109127    0.969619    0.731959    0.961340    0.774341    0.713964    0.704622    0.961561    0.793341    2600        42.842430   0.111263    0.578817    123.038259 
[37m[36mINFO[0m[0m 02/27 09:03:03 | 0.730856    0.721533    0.978727    0.768075    1.086513    0.986612    0.742268    0.967640    0.767468    0.730856    0.721533    0.981928    0.794489    2800        46.138002   0.085171    0.592404    127.444118 
[37m[36mINFO[0m[0m 02/27 09:07:09 | 0.732264    0.706877    0.975324    0.786561    1.062826    0.988157    0.769072    0.963058    0.789233    0.732264    0.706877    0.974756    0.801378    3000        49.433574   0.091994    0.578370    130.635872 
[37m[36mINFO[0m[0m 02/27 09:11:21 | 0.708052    0.688839    0.968469    0.754167    1.188886    0.979918    0.715464    0.957331    0.765178    0.708052    0.688839    0.968158    0.781860    3200        52.729145   0.091270    0.590455    134.150334 
[37m[36mINFO[0m[0m 02/27 09:15:29 | 0.698198    0.675310    0.970917    0.762037    1.208950    0.973223    0.719588    0.967927    0.778923    0.698198    0.675310    0.971601    0.787600    3400        56.024717   0.092922    0.571264    133.413860 
[37m[36mINFO[0m[0m 02/27 09:19:34 | 0.689471    0.674183    0.966010    0.742416    1.213125    0.976828    0.692784    0.948167    0.741123    0.689471    0.674183    0.973035    0.793341    3600        59.320288   0.102814    0.598359    124.922931 
[37m[36mINFO[0m[0m 02/27 09:23:46 | 0.709741    0.701240    0.982145    0.777020    1.095689    0.989701    0.748454    0.971649    0.774341    0.709741    0.701240    0.985083    0.808266    3800        62.615860   0.078320    0.604787    131.552207 
[37m[36mINFO[0m[0m 02/27 09:27:56 | 0.721284    0.705750    0.980788    0.762645    1.120975    0.987642    0.723711    0.973368    0.780069    0.721284    0.705750    0.981354    0.784156    4000        65.911432   0.124677    0.587124    132.339133 
[37m[36mINFO[0m[0m 02/27 09:32:05 | 0.694820    0.680947    0.968742    0.740259    1.272483    0.972709    0.688660    0.959908    0.762887    0.694820    0.680947    0.973609    0.769231    4200        69.207003   0.078494    0.588628    131.140331 
[37m[36mINFO[0m[0m 02/27 09:36:15 | 0.657095    0.626832    0.971507    0.744305    1.260490    0.983007    0.703093    0.957904    0.762887    0.657095    0.626832    0.973609    0.766935    4400        72.502575   0.076513    0.600895    129.899815 
[37m[36mINFO[0m[0m 02/27 09:40:22 | 0.706363    0.691094    0.981991    0.766006    1.068951    0.991246    0.725773    0.971077    0.786942    0.706363    0.691094    0.983649    0.785304    4600        75.798146   0.085530    0.604062    125.786796 
[37m[36mINFO[0m[0m 02/27 09:44:27 | 0.715935    0.700113    0.985409    0.776234    1.132212    0.991761    0.758763    0.978522    0.791523    0.715935    0.700113    0.985944    0.778416    4800        79.093718   0.055487    0.584939    128.031092 
[37m[36mINFO[0m[0m 02/27 09:48:40 | 0.713401    0.695603    0.978802    0.758366    1.179527    0.987127    0.715464    0.968499    0.778923    0.713401    0.695603    0.980780    0.780712    5000        82.389289   0.083600    0.581980    137.077116 
[37m[36mINFO[0m[0m 02/27 09:48:40 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[2]/250227_08-03-54_clip_vitb16_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/27 09:48:44 | ---
[37m[36mINFO[0m[0m 02/27 09:48:44 | test-domain validation(oracle) = 75.704%
[37m[36mINFO[0m[0m 02/27 09:48:44 | training-domain validation(iid) = 73.226%
[37m[36mINFO[0m[0m 02/27 09:48:44 | last = 71.340%
[37m[36mINFO[0m[0m 02/27 09:48:44 | last (inD) = 75.837%
[37m[36mINFO[0m[0m 02/27 09:48:44 | training-domain validation (iid, inD) = 78.656%
[37m[36mINFO[0m[0m 02/27 09:48:44 | === Summary ===
[37m[36mINFO[0m[0m 02/27 09:48:44 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_adam config/clip_vitb16_adam.yaml --algorithm ERM --test_envs 2 --dataset OfficeHome
[37m[36mINFO[0m[0m 02/27 09:48:44 | Unique name: 250227_08-03-54_clip_vitb16_adam
[37m[36mINFO[0m[0m 02/27 09:48:44 | Out path: train_output/OfficeHome/ERM/[2]/250227_08-03-54_clip_vitb16_adam
[37m[36mINFO[0m[0m 02/27 09:48:44 | Algorithm: ERM
[37m[36mINFO[0m[0m 02/27 09:48:44 | Dataset: OfficeHome

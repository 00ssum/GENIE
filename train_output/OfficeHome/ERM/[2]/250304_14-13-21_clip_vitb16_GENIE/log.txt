[37m[36mINFO[0m[0m 03/04 14:13:21 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 2 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/OfficeHome/ERM/[2]/250304_14-13-21_clip_vitb16_GENIE
	out_root: train_output/OfficeHome/ERM/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250304_14-13-21_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: clip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/04 14:13:21 | n_steps = 5001
[37m[36mINFO[0m[0m 03/04 14:13:21 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/04 14:13:21 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/04 14:13:21 | 
[37m[36mINFO[0m[0m 03/04 14:13:21 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 03/04 14:13:21 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 03/04 14:13:21 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 03/04 14:13:21 | Batch sizes for each domain: [32, 32, 0, 32] (total=96)
[37m[36mINFO[0m[0m 03/04 14:13:21 | steps-per-epoch for each domain: 60.69, 109.12, 108.94 -> min = 60.69
[37m[36mINFO[0m[0m 03/04 14:13:23 | # of params = 86225985
[37m[36mINFO[0m[0m 03/04 14:15:19 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/04 14:15:19 | 0.015203    0.010147    0.017321    0.016585    4.200024    0.019567    0.026804    0.012314    0.004582    0.015203    0.010147    0.020080    0.018370    0           0.000000    4.178164    1.108070    114.804598 
[37m[36mINFO[0m[0m 03/04 14:18:55 | 0.034628    0.037204    0.049497    0.047386    4.009346    0.055613    0.061856    0.037801    0.028637    0.034628    0.037204    0.055077    0.051665    200         3.295572    4.088554    0.505239    114.761938 
[37m[36mINFO[0m[0m 03/04 14:22:34 | 0.127252    0.117249    0.169691    0.164618    3.398925    0.166838    0.187629    0.161798    0.138603    0.127252    0.117249    0.180436    0.167623    400         6.591143    3.823198    0.522860    114.666004 
[37m[36mINFO[0m[0m 03/04 14:26:09 | 0.347410    0.325817    0.442715    0.388590    2.313275    0.451596    0.393814    0.392325    0.312715    0.347410    0.325817    0.484223    0.459242    600         9.886715    2.876444    0.509112    112.994259 
[37m[36mINFO[0m[0m 03/04 14:29:44 | 0.511824    0.509583    0.645758    0.548785    1.720127    0.658599    0.546392    0.589633    0.466208    0.511824    0.509583    0.689042    0.633754    800         13.182286   1.699834    0.507313    113.791700 
[37m[36mINFO[0m[0m 03/04 14:33:15 | 0.604167    0.590755    0.736955    0.607024    1.501619    0.753347    0.562887    0.682703    0.560137    0.604167    0.590755    0.774814    0.698048    1000        16.477858   1.102886    0.490047    112.841138 
[37m[36mINFO[0m[0m 03/04 14:36:48 | 0.623874    0.607666    0.830772    0.655454    1.296890    0.869722    0.647423    0.772337    0.601375    0.623874    0.607666    0.850258    0.717566    1200        19.773429   0.811858    0.506311    112.077967 
[37m[36mINFO[0m[0m 03/04 14:40:25 | 0.620214    0.611048    0.858951    0.672184    1.316770    0.882080    0.649485    0.837915    0.642612    0.620214    0.611048    0.856856    0.724455    1400        23.069001   0.589442    0.514611    113.508549 
[37m[36mINFO[0m[0m 03/04 14:43:57 | 0.652027    0.636979    0.887238    0.678993    1.270895    0.915036    0.661856    0.847365    0.633448    0.652027    0.636979    0.899312    0.741676    1600        26.364573   0.446466    0.495938    112.639372 
[37m[36mINFO[0m[0m 03/04 14:47:35 | 0.646396    0.650507    0.914440    0.683951    1.265152    0.948507    0.651546    0.880011    0.666667    0.646396    0.650507    0.914802    0.733639    1800        29.660144   0.323942    0.507967    116.577365 
[37m[36mINFO[0m[0m 03/04 14:51:11 | 0.663288    0.633596    0.931266    0.696577    1.276300    0.958290    0.661856    0.902635    0.660939    0.663288    0.633596    0.932874    0.766935    2000        32.955716   0.275995    0.509401    114.558388 
[37m[36mINFO[0m[0m 03/04 14:54:52 | 0.663007    0.667418    0.946398    0.709717    1.253910    0.962410    0.678351    0.921821    0.675830    0.663007    0.667418    0.954963    0.774971    2200        36.251287   0.214123    0.520625    116.666252 
[37m[36mINFO[0m[0m 03/04 14:58:31 | 0.669482    0.636979    0.954334    0.706279    1.257867    0.979918    0.668041    0.927835    0.678121    0.669482    0.636979    0.955250    0.772675    2400        39.546859   0.178203    0.517265    115.691485 
[37m[36mINFO[0m[0m 03/04 15:02:10 | 0.669764    0.659526    0.951666    0.701072    1.277310    0.967044    0.663918    0.932703    0.684994    0.669764    0.659526    0.955250    0.754305    2600        42.842430   0.144188    0.505068    117.203627 
[37m[36mINFO[0m[0m 03/04 15:05:49 | 0.647241    0.636979    0.951382    0.691598    1.365115    0.961895    0.651546    0.935281    0.675830    0.647241    0.636979    0.956971    0.747417    2800        46.138002   0.133753    0.518566    115.457264 
[37m[36mINFO[0m[0m 03/04 15:09:28 | 0.670045    0.653890    0.972880    0.716282    1.272112    0.984552    0.676289    0.961340    0.701031    0.670045    0.653890    0.972748    0.771527    3000        49.433574   0.101326    0.519863    115.578783 
[37m[36mINFO[0m[0m 03/04 15:13:05 | 0.664696    0.662909    0.972557    0.716434    1.286970    0.983007    0.692784    0.960195    0.686140    0.664696    0.662909    0.974469    0.770379    3200        52.729145   0.093104    0.510853    114.754526 
[37m[36mINFO[0m[0m 03/04 15:16:44 | 0.667230    0.643743    0.975711    0.710690    1.322999    0.983007    0.672165    0.963058    0.711340    0.667230    0.643743    0.981067    0.748565    3400        56.024717   0.077776    0.516145    115.467736 
[37m[36mINFO[0m[0m 03/04 15:20:23 | 0.676239    0.676437    0.973742    0.719182    1.289696    0.981977    0.670103    0.963631    0.718213    0.676239    0.676437    0.975617    0.769231    3600        59.320288   0.080823    0.516846    115.727417 
[37m[36mINFO[0m[0m 03/04 15:24:00 | 0.690034    0.676437    0.982413    0.729880    1.231951    0.990216    0.701031    0.969359    0.710195    0.690034    0.676437    0.987665    0.778416    3800        62.615860   0.066705    0.505233    115.753973 
[37m[36mINFO[0m[0m 03/04 15:27:37 | 0.688345    0.659526    0.979088    0.722833    1.298404    0.987127    0.684536    0.969931    0.734250    0.688345    0.659526    0.980207    0.749713    4000        65.911432   0.070405    0.512668    114.960142 
[37m[36mINFO[0m[0m 03/04 15:31:18 | 0.667230    0.635851    0.980447    0.716115    1.338855    0.984037    0.690722    0.972222    0.705613    0.667230    0.635851    0.985083    0.752009    4200        69.207003   0.062632    0.516905    117.683183 
[37m[36mINFO[0m[0m 03/04 15:34:57 | 0.667793    0.651635    0.978860    0.712913    1.298525    0.988157    0.684536    0.965922    0.694158    0.667793    0.651635    0.982501    0.760046    4400        72.502575   0.058261    0.511195    116.383645 
[37m[36mINFO[0m[0m 03/04 15:38:35 | 0.682432    0.656144    0.982128    0.724990    1.263504    0.985067    0.688660    0.975372    0.711340    0.682432    0.656144    0.985944    0.774971    4600        75.798146   0.059692    0.523924    112.800086 
[37m[36mINFO[0m[0m 03/04 15:42:12 | 0.693975    0.691094    0.985316    0.733542    1.265700    0.991761    0.705155    0.974227    0.721649    0.693975    0.691094    0.989960    0.773823    4800        79.093718   0.046372    0.510264    115.687111 
[37m[36mINFO[0m[0m 03/04 15:45:52 | 0.672579    0.660654    0.981765    0.708937    1.371073    0.987127    0.668041    0.970218    0.705613    0.672579    0.660654    0.987952    0.753157    5000        82.389289   0.051786    0.522993    114.914794 
[37m[36mINFO[0m[0m 03/04 15:45:52 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[2]/250304_14-13-21_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/04 15:45:54 | ---
[37m[36mINFO[0m[0m 03/04 15:45:54 | test-domain validation(oracle) = 69.398%
[37m[36mINFO[0m[0m 03/04 15:45:54 | training-domain validation(iid) = 69.398%
[37m[36mINFO[0m[0m 03/04 15:45:54 | last = 67.258%
[37m[36mINFO[0m[0m 03/04 15:45:54 | last (inD) = 70.894%
[37m[36mINFO[0m[0m 03/04 15:45:54 | training-domain validation (iid, inD) = 73.354%
[37m[36mINFO[0m[0m 03/04 15:45:54 | === Summary ===
[37m[36mINFO[0m[0m 03/04 15:45:54 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 2 --dataset OfficeHome
[37m[36mINFO[0m[0m 03/04 15:45:54 | Unique name: 250304_14-13-21_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/04 15:45:54 | Out path: train_output/OfficeHome/ERM/[2]/250304_14-13-21_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/04 15:45:54 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/04 15:45:54 | Dataset: OfficeHome

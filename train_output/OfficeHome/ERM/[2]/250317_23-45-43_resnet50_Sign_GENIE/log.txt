[37m[36mINFO[0m[0m 03/17 23:45:43 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 2 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/OfficeHome/ERM/[2]/250317_23-45-43_resnet50_Sign_GENIE
	out_root: train_output/OfficeHome/ERM/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250317_23-45-43_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/17 23:45:43 | n_steps = 5001
[37m[36mINFO[0m[0m 03/17 23:45:43 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/17 23:45:43 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/17 23:45:43 | 
[37m[36mINFO[0m[0m 03/17 23:45:43 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 03/17 23:45:43 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 03/17 23:45:43 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 03/17 23:45:43 | Batch sizes for each domain: [32, 32, 0, 32] (total=96)
[37m[36mINFO[0m[0m 03/17 23:45:43 | steps-per-epoch for each domain: 60.69, 109.12, 108.94 -> min = 60.69
[37m[36mINFO[0m[0m 03/17 23:45:44 | # of params = 23641217
[37m[36mINFO[0m[0m 03/17 23:47:41 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/17 23:47:41 | 0.006757    0.007892    0.016784    0.014295    4.222676    0.023687    0.016495    0.008305    0.006873    0.006757    0.007892    0.018359    0.019518    0           0.000000    4.290899    1.217516    115.530294 
[37m[36mINFO[0m[0m 03/17 23:51:31 | 0.695664    0.683202    0.774534    0.713060    1.105347    0.795572    0.731959    0.714490    0.655212    0.695664    0.683202    0.813540    0.752009    200         3.295572    1.639337    0.554795    119.177095 
[37m[36mINFO[0m[0m 03/17 23:55:19 | 0.736768    0.712514    0.868103    0.751580    1.005337    0.898043    0.744330    0.826460    0.715922    0.736768    0.712514    0.879805    0.794489    400         6.591143    0.573498    0.555922    117.020744 
[37m[36mINFO[0m[0m 03/17 23:59:07 | 0.746622    0.740699    0.907266    0.757400    0.988837    0.938723    0.731959    0.866838    0.725086    0.746622    0.740699    0.916236    0.815155    600         9.886715    0.384298    0.548352    117.726104 
[37m[36mINFO[0m[0m 03/18 00:02:50 | 0.755068    0.742954    0.934704    0.754795    0.980586    0.958290    0.719588    0.910653    0.741123    0.755068    0.742954    0.935169    0.803674    800         13.182286   0.268381    0.533416    116.675740 
[37m[36mINFO[0m[0m 03/18 00:06:41 | 0.751408    0.729425    0.948556    0.757310    1.226489    0.960865    0.734021    0.928694    0.739977    0.751408    0.729425    0.956110    0.797933    1000        16.477858   0.193414    0.555113    119.563595 
[37m[36mINFO[0m[0m 03/18 00:10:25 | 0.755349    0.737317    0.967418    0.763968    1.130403    0.985067    0.740206    0.948167    0.735395    0.755349    0.737317    0.969019    0.816303    1200        19.773429   0.150684    0.539614    116.255671 
[37m[36mINFO[0m[0m 03/18 00:14:11 | 0.732545    0.712514    0.960368    0.759294    1.252283    0.976828    0.742268    0.948740    0.739977    0.732545    0.712514    0.955536    0.795637    1400        23.069001   0.115698    0.548367    116.480693 
[37m[36mINFO[0m[0m 03/18 00:17:53 | 0.744932    0.737317    0.974352    0.770526    1.200189    0.986097    0.758763    0.959908    0.749141    0.744932    0.737317    0.977051    0.803674    1600        26.364573   0.105069    0.535575    114.943563 
[37m[36mINFO[0m[0m 03/18 00:21:42 | 0.744651    0.718151    0.978322    0.771146    1.211975    0.992276    0.752577    0.963631    0.744559    0.744651    0.718151    0.979059    0.816303    1800        29.660144   0.082988    0.544911    119.767164 
[37m[36mINFO[0m[0m 03/18 00:25:31 | 0.755349    0.754228    0.979509    0.786501    1.252117    0.988671    0.771134    0.967068    0.765178    0.755349    0.754228    0.982788    0.823192    2000        32.955716   0.075193    0.552232    119.212403 
[37m[36mINFO[0m[0m 03/18 00:29:18 | 0.759009    0.740699    0.980101    0.778860    1.168322    0.988157    0.750515    0.969359    0.768614    0.759009    0.740699    0.982788    0.817451    2200        36.251287   0.081984    0.560985    113.997249 
[37m[36mINFO[0m[0m 03/18 00:33:06 | 0.750845    0.729425    0.980120    0.782061    1.211109    0.987642    0.767010    0.970790    0.770905    0.750845    0.729425    0.981928    0.808266    2400        39.546859   0.054145    0.561008    115.898769 
[37m[36mINFO[0m[0m 03/18 00:36:58 | 0.751408    0.737317    0.981688    0.776255    1.426030    0.986612    0.769072    0.973368    0.753723    0.751408    0.737317    0.985083    0.805970    2600        42.842430   0.061803    0.547208    122.334039 
[37m[36mINFO[0m[0m 03/18 00:40:42 | 0.762106    0.756483    0.984341    0.769846    1.308911    0.992276    0.746392    0.972509    0.750286    0.762106    0.756483    0.988239    0.812859    2800        46.138002   0.053182    0.533830    117.821942 
[37m[36mINFO[0m[0m 03/18 00:44:31 | 0.750563    0.744081    0.987053    0.775951    1.291969    0.993821    0.756701    0.976804    0.762887    0.750563    0.744081    0.990534    0.808266    3000        49.433574   0.051832    0.556567    117.225863 
[37m[36mINFO[0m[0m 03/18 00:48:08 | 0.746903    0.729425    0.982029    0.769525    1.361500    0.992791    0.764948    0.969072    0.750286    0.746903    0.729425    0.984223    0.793341    3200        52.729145   0.048622    0.522762    112.542260 
[37m[36mINFO[0m[0m 03/18 00:51:58 | 0.759291    0.741826    0.990014    0.783820    1.393529    0.993821    0.771134    0.981386    0.767468    0.759291    0.741826    0.994836    0.812859    3400        56.024717   0.041437    0.560758    118.342493 
[37m[36mINFO[0m[0m 03/18 00:55:40 | 0.750563    0.739572    0.988333    0.781993    1.249947    0.992791    0.769072    0.980527    0.757159    0.750563    0.739572    0.991681    0.819747    3600        59.320288   0.039599    0.535910    114.212101 
[37m[36mINFO[0m[0m 03/18 00:59:29 | 0.755631    0.749718    0.987110    0.775954    1.340309    0.992276    0.756701    0.979954    0.759450    0.755631    0.749718    0.989099    0.811711    3800        62.615860   0.038656    0.565282    116.035609 
[37m[36mINFO[0m[0m 03/18 01:03:16 | 0.761261    0.733935    0.990395    0.779318    1.233103    0.996395    0.758763    0.979954    0.761741    0.761261    0.733935    0.994836    0.817451    4000        65.911432   0.033243    0.558740    115.774448 
[37m[36mINFO[0m[0m 03/18 01:07:02 | 0.768300    0.746336    0.989440    0.779541    1.370649    0.993821    0.762887    0.982245    0.766323    0.768300    0.746336    0.992255    0.809414    4200        69.207003   0.032391    0.542562    117.476970 
[37m[36mINFO[0m[0m 03/18 01:10:44 | 0.760135    0.735062    0.990301    0.771370    1.338744    0.993821    0.746392    0.982532    0.758305    0.760135    0.735062    0.994550    0.809414    4400        72.502575   0.033337    0.536039    114.193290 
[37m[36mINFO[0m[0m 03/18 01:14:28 | 0.755349    0.737317    0.987933    0.777323    1.484890    0.990731    0.771134    0.981386    0.756014    0.755349    0.737317    0.991681    0.804822    4600        75.798146   0.030747    0.530509    118.233134 
[37m[36mINFO[0m[0m 03/18 01:18:12 | 0.747748    0.738444    0.989938    0.779851    1.421666    0.993306    0.764948    0.982818    0.759450    0.747748    0.738444    0.993689    0.815155    4800        79.093718   0.032066    0.528135    118.483030 
[37m[36mINFO[0m[0m 03/18 01:21:58 | 0.764358    0.750846    0.989556    0.790396    1.370402    0.993306    0.779381    0.981100    0.768614    0.764358    0.750846    0.994263    0.823192    5000        82.389289   0.033135    0.550689    115.820076 
[37m[36mINFO[0m[0m 03/18 01:21:58 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[2]/250317_23-45-43_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 01:22:00 | ---
[37m[36mINFO[0m[0m 03/18 01:22:00 | test-domain validation(oracle) = 76.211%
[37m[36mINFO[0m[0m 03/18 01:22:00 | training-domain validation(iid) = 76.436%
[37m[36mINFO[0m[0m 03/18 01:22:00 | last = 76.436%
[37m[36mINFO[0m[0m 03/18 01:22:00 | last (inD) = 79.040%
[37m[36mINFO[0m[0m 03/18 01:22:00 | training-domain validation (iid, inD) = 79.040%
[37m[36mINFO[0m[0m 03/18 01:22:01 | === Summary ===
[37m[36mINFO[0m[0m 03/18 01:22:01 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 2 --dataset OfficeHome
[37m[36mINFO[0m[0m 03/18 01:22:01 | Unique name: 250317_23-45-43_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 01:22:01 | Out path: train_output/OfficeHome/ERM/[2]/250317_23-45-43_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 01:22:01 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 01:22:01 | Dataset: OfficeHome

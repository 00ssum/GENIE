[37m[36mINFO[0m[0m 03/14 11:03:57 | Command :: /jsm0707/GENIE/train_all.py resnet50_signum config/resnet50_signum.yaml --algorithm ERM --test_envs 2 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_signum.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_signum
	out_dir: train_output/OfficeHome/ERM/[2]/250314_11-03-57_resnet50_signum
	out_root: train_output/OfficeHome/ERM/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250314_11-03-57_resnet50_signum
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: signum
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/14 11:03:57 | n_steps = 5001
[37m[36mINFO[0m[0m 03/14 11:03:57 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/14 11:03:57 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/14 11:03:57 | 
[37m[36mINFO[0m[0m 03/14 11:03:57 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 03/14 11:03:57 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 03/14 11:03:57 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 03/14 11:03:57 | Batch sizes for each domain: [32, 32, 0, 32] (total=96)
[37m[36mINFO[0m[0m 03/14 11:03:57 | steps-per-epoch for each domain: 60.69, 109.12, 108.94 -> min = 60.69
[37m[36mINFO[0m[0m 03/14 11:03:58 | # of params = 23641217
[37m[36mINFO[0m[0m 03/14 11:05:56 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/14 11:05:56 | 0.006194    0.011274    0.017281    0.012842    4.206536    0.023172    0.014433    0.008591    0.008018    0.006194    0.011274    0.020080    0.016073    0           0.000000    4.290899    1.053294    117.623876 
[37m[36mINFO[0m[0m 03/14 11:09:31 | 0.657939    0.658399    0.740284    0.670496    1.263133    0.758496    0.643299    0.704467    0.654066    0.657939    0.658399    0.757889    0.714122    200         3.295572    1.503684    0.512657    112.178312 
[37m[36mINFO[0m[0m 03/14 11:13:10 | 0.692286    0.685457    0.844699    0.718185    1.129585    0.865088    0.696907    0.806128    0.694158    0.692286    0.685457    0.862880    0.763490    400         6.591143    0.650427    0.519844    114.565025 
[37m[36mINFO[0m[0m 03/14 11:16:46 | 0.724944    0.717024    0.860813    0.715887    1.321335    0.870752    0.696907    0.842497    0.696449    0.724944    0.717024    0.869191    0.754305    600         9.886715    0.471561    0.508225    114.356976 
[37m[36mINFO[0m[0m 03/14 11:20:23 | 0.709741    0.694476    0.908228    0.742631    1.282941    0.943357    0.727835    0.883162    0.725086    0.709741    0.694476    0.898164    0.774971    800         13.182286   0.377077    0.493251    118.664000 
[37m[36mINFO[0m[0m 03/14 11:24:01 | 0.725788    0.685457    0.912573    0.740724    1.322966    0.942327    0.727835    0.876861    0.715922    0.725788    0.685457    0.918531    0.778416    1000        16.477858   0.363654    0.525265    113.237394 
[37m[36mINFO[0m[0m 03/14 11:27:37 | 0.712275    0.703495    0.906205    0.728727    1.306773    0.938723    0.701031    0.882875    0.717068    0.712275    0.703495    0.897017    0.768083    1200        19.773429   0.353430    0.502634    115.364961 
[37m[36mINFO[0m[0m 03/14 11:31:19 | 0.674268    0.636979    0.878904    0.705261    1.919229    0.880021    0.684536    0.863116    0.691867    0.674268    0.636979    0.893574    0.739380    1400        23.069001   0.383709    0.524998    116.322495 
[37m[36mINFO[0m[0m 03/14 11:34:54 | 0.645552    0.621195    0.903444    0.719847    2.003877    0.930999    0.734021    0.873711    0.686140    0.645552    0.621195    0.905622    0.739380    1600        26.364573   0.449953    0.511981    113.291438 
[37m[36mINFO[0m[0m 03/14 11:38:34 | 0.639640    0.603157    0.862511    0.714428    2.413698    0.876416    0.694845    0.841924    0.704467    0.639640    0.603157    0.869191    0.743972    1800        29.660144   0.500702    0.519494    115.518991 
[37m[36mINFO[0m[0m 03/14 11:42:14 | 0.632883    0.618940    0.850923    0.683567    2.425963    0.854274    0.630928    0.841638    0.688431    0.632883    0.618940    0.856856    0.731343    2000        32.955716   0.641907    0.539597    112.580728 
[37m[36mINFO[0m[0m 03/14 11:45:55 | 0.646115    0.635851    0.846218    0.687308    3.821353    0.872812    0.684536    0.811569    0.647194    0.646115    0.635851    0.854274    0.730195    2200        36.251287   0.858754    0.532403    114.127051 
[37m[36mINFO[0m[0m 03/14 11:49:37 | 0.613739    0.605411    0.804331    0.645663    1.759492    0.813079    0.622680    0.782646    0.618557    0.613739    0.605411    0.817269    0.695752    2400        39.546859   0.981290    0.548701    113.005522 
[37m[36mINFO[0m[0m 03/14 11:53:17 | 0.512387    0.498309    0.674374    0.551802    4.484510    0.649331    0.536082    0.660653    0.534937    0.512387    0.498309    0.713138    0.584386    2600        42.842430   1.049709    0.529594    113.173497 
[37m[36mINFO[0m[0m 03/14 11:56:49 | 0.503660    0.468997    0.702475    0.559307    2.211240    0.717302    0.550515    0.671821    0.514318    0.503660    0.468997    0.718302    0.613088    2800        46.138002   1.188237    0.505783    111.496951 
[37m[36mINFO[0m[0m 03/14 12:00:25 | 0.534628    0.510710    0.699819    0.569031    3.877446    0.704428    0.525773    0.654926    0.534937    0.534628    0.510710    0.740103    0.646383    3000        49.433574   1.394889    0.525904    110.594850 
[37m[36mINFO[0m[0m 03/14 12:04:01 | 0.496903    0.484780    0.659307    0.520420    2.622342    0.666323    0.496907    0.628580    0.474227    0.496903    0.484780    0.683018    0.590126    3200        52.729145   1.552593    0.511477    113.475860 
[37m[36mINFO[0m[0m 03/14 12:07:44 | 0.344032    0.346110    0.407757    0.367035    2.793031    0.392894    0.325773    0.384021    0.343643    0.344032    0.346110    0.446357    0.431688    3400        56.024717   1.870781    0.530859    117.277949 
[37m[36mINFO[0m[0m 03/14 12:11:21 | 0.335586    0.319053    0.419929    0.364282    3.613748    0.427394    0.338144    0.379152    0.327606    0.335586    0.319053    0.453242    0.427095    3600        59.320288   2.599291    0.518690    112.852064 
[37m[36mINFO[0m[0m 03/14 12:15:00 | 0.110923    0.113867    0.177780    0.159345    4.510922    0.180227    0.164948    0.174399    0.151203    0.110923    0.113867    0.178715    0.161883    3800        62.615860   3.698107    0.538539    111.452491 
[37m[36mINFO[0m[0m 03/14 12:18:39 | 0.104448    0.098083    0.112424    0.101664    4.179465    0.104531    0.082474    0.111111    0.093929    0.104448    0.098083    0.121629    0.128588    4000        65.911432   4.582642    0.531021    112.478721 
[37m[36mINFO[0m[0m 03/14 12:22:16 | 0.114583    0.108230    0.149527    0.162254    4.743977    0.166838    0.169072    0.140321    0.146621    0.114583    0.108230    0.141423    0.171068    4200        69.207003   4.499599    0.528912    111.980198 
[37m[36mINFO[0m[0m 03/14 12:25:54 | 0.070101    0.059752    0.088885    0.076281    4.019459    0.077755    0.065979    0.082188    0.073310    0.070101    0.059752    0.106713    0.089552    4400        72.502575   4.409316    0.518015    113.600125 
[37m[36mINFO[0m[0m 03/14 12:29:32 | 0.059685    0.064262    0.077835    0.081015    5.827454    0.069001    0.061856    0.089347    0.091638    0.059685    0.064262    0.075158    0.089552    4600        75.798146   4.246019    0.519109    114.001209 
[37m[36mINFO[0m[0m 03/14 12:33:11 | 0.086993    0.090192    0.091195    0.103185    4.099001    0.072091    0.082474    0.097938    0.106529    0.086993    0.090192    0.103557    0.120551    4800        79.093718   4.235618    0.523725    114.560708 
[37m[36mINFO[0m[0m 03/14 12:36:48 | 0.057995    0.065389    0.060076    0.064876    4.407392    0.056128    0.063918    0.064147    0.075601    0.057995    0.065389    0.059954    0.055109    5000        82.389289   4.226344    0.522319    113.199873 
[37m[36mINFO[0m[0m 03/14 12:36:49 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[2]/250314_11-03-57_resnet50_signum/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/14 12:36:50 | ---
[37m[36mINFO[0m[0m 03/14 12:36:50 | test-domain validation(oracle) = 72.494%
[37m[36mINFO[0m[0m 03/14 12:36:50 | training-domain validation(iid) = 70.974%
[37m[36mINFO[0m[0m 03/14 12:36:50 | last = 5.800%
[37m[36mINFO[0m[0m 03/14 12:36:50 | last (inD) = 6.488%
[37m[36mINFO[0m[0m 03/14 12:36:50 | training-domain validation (iid, inD) = 74.263%
[37m[36mINFO[0m[0m 03/14 12:36:50 | === Summary ===
[37m[36mINFO[0m[0m 03/14 12:36:50 | Command: /jsm0707/GENIE/train_all.py resnet50_signum config/resnet50_signum.yaml --algorithm ERM --test_envs 2 --dataset OfficeHome
[37m[36mINFO[0m[0m 03/14 12:36:50 | Unique name: 250314_11-03-57_resnet50_signum
[37m[36mINFO[0m[0m 03/14 12:36:50 | Out path: train_output/OfficeHome/ERM/[2]/250314_11-03-57_resnet50_signum
[37m[36mINFO[0m[0m 03/14 12:36:50 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/14 12:36:50 | Dataset: OfficeHome

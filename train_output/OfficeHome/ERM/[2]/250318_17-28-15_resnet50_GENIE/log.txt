[37m[36mINFO[0m[0m 03/18 17:28:15 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm ERM --test_envs 2 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/ERM/[2]/250318_17-28-15_resnet50_GENIE
	out_root: train_output/OfficeHome/ERM/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250318_17-28-15_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/18 17:28:15 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 17:28:15 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 17:28:15 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 17:28:15 | 
[37m[36mINFO[0m[0m 03/18 17:28:15 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 03/18 17:28:15 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 03/18 17:28:15 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 03/18 17:28:15 | Batch sizes for each domain: [32, 32, 0, 32] (total=96)
[37m[36mINFO[0m[0m 03/18 17:28:15 | steps-per-epoch for each domain: 60.69, 109.12, 108.94 -> min = 60.69
[37m[36mINFO[0m[0m 03/18 17:28:17 | # of params = 23641217
[37m[36mINFO[0m[0m 03/18 17:30:24 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 17:30:24 | 0.006194    0.007892    0.017604    0.014677    4.222713    0.024717    0.016495    0.009164    0.008018    0.006194    0.007892    0.018933    0.019518    0           0.000000    4.290899    1.387120    125.881412 
[37m[36mINFO[0m[0m 03/18 17:34:22 | 0.691160    0.685457    0.777433    0.711002    1.113043    0.799691    0.725773    0.721649    0.649485    0.691160    0.685457    0.810958    0.757750    200         3.295572    1.649749    0.558282    126.485085 
[37m[36mINFO[0m[0m 03/18 17:38:16 | 0.742399    0.720406    0.869168    0.751807    0.989588    0.900103    0.758763    0.833333    0.705613    0.742399    0.720406    0.874068    0.791045    400         6.591143    0.559123    0.568929    120.561506 
[37m[36mINFO[0m[0m 03/18 17:42:11 | 0.737331    0.717024    0.911086    0.748907    1.012518    0.933574    0.723711    0.882589    0.729668    0.737331    0.717024    0.917097    0.793341    600         9.886715    0.388981    0.562821    122.020416 
[37m[36mINFO[0m[0m 03/18 17:45:58 | 0.742680    0.738444    0.914329    0.753176    1.013892    0.933574    0.731959    0.897766    0.743414    0.742680    0.738444    0.911647    0.784156    800         13.182286   0.252531    0.537325    119.242811 
[37m[36mINFO[0m[0m 03/18 17:49:48 | 0.742399    0.721533    0.945575    0.749666    1.145215    0.961380    0.723711    0.924685    0.737686    0.742399    0.721533    0.950660    0.787600    1000        16.477858   0.201346    0.557905    118.494464 
[37m[36mINFO[0m[0m 03/18 17:53:33 | 0.745495    0.729425    0.959096    0.774732    1.039481    0.972709    0.758763    0.939576    0.753723    0.745495    0.729425    0.965003    0.811711    1200        19.773429   0.150364    0.543479    116.643417 
[37m[36mINFO[0m[0m 03/18 17:57:20 | 0.737331    0.706877    0.961405    0.766102    1.258049    0.974768    0.754639    0.945590    0.733104    0.737331    0.706877    0.963855    0.810563    1400        23.069001   0.116558    0.546434    117.978871 
[37m[36mINFO[0m[0m 03/18 18:01:07 | 0.744651    0.731680    0.973798    0.775045    1.164375    0.988157    0.760825    0.956472    0.743414    0.744651    0.731680    0.976764    0.820896    1600        26.364573   0.111285    0.545996    117.425757 
[37m[36mINFO[0m[0m 03/18 18:04:54 | 0.741554    0.726043    0.966873    0.773824    1.235761    0.974253    0.752577    0.949026    0.746850    0.741554    0.726043    0.977338    0.822044    1800        29.660144   0.088543    0.544031    117.911316 
[37m[36mINFO[0m[0m 03/18 18:08:42 | 0.743525    0.727170    0.978649    0.776642    1.225474    0.988671    0.769072    0.966495    0.747995    0.743525    0.727170    0.980780    0.812859    2000        32.955716   0.074903    0.549080    118.703363 
[37m[36mINFO[0m[0m 03/18 18:12:26 | 0.751126    0.746336    0.977888    0.775879    1.161996    0.983522    0.758763    0.967927    0.754868    0.751126    0.746336    0.982215    0.814007    2200        36.251287   0.074472    0.547147    114.742787 
[37m[36mINFO[0m[0m 03/18 18:16:19 | 0.753378    0.745209    0.981402    0.772134    1.170243    0.986612    0.756701    0.971649    0.750286    0.753378    0.745209    0.985944    0.809414    2400        39.546859   0.059236    0.556718    121.123568 
[37m[36mINFO[0m[0m 03/18 18:20:07 | 0.755912    0.741826    0.984683    0.775801    1.324070    0.995881    0.760825    0.971649    0.754868    0.755912    0.741826    0.986517    0.811711    2600        42.842430   0.060163    0.552862    117.931113 
[37m[36mINFO[0m[0m 03/18 18:23:50 | 0.746622    0.721533    0.980863    0.757543    1.293185    0.990731    0.738144    0.969931    0.731959    0.746622    0.721533    0.981928    0.802526    2800        46.138002   0.053140    0.520433    118.204190 
[37m[36mINFO[0m[0m 03/18 18:27:34 | 0.769144    0.735062    0.987225    0.786335    1.216189    0.994336    0.775258    0.976518    0.777778    0.769144    0.735062    0.990820    0.805970    3000        49.433574   0.046329    0.545683    115.361761 
[37m[36mINFO[0m[0m 03/18 18:31:14 | 0.757601    0.740699    0.983480    0.774815    1.277920    0.992276    0.746392    0.973081    0.758305    0.757601    0.740699    0.985083    0.819747    3200        52.729145   0.042395    0.526657    114.865313 
[37m[36mINFO[0m[0m 03/18 18:35:02 | 0.765203    0.746336    0.988545    0.778402    1.258190    0.992276    0.762887    0.979095    0.754868    0.765203    0.746336    0.994263    0.817451    3400        56.024717   0.042603    0.548099    117.946029 
[37m[36mINFO[0m[0m 03/18 18:38:46 | 0.755631    0.754228    0.987627    0.783206    1.237345    0.991246    0.777320    0.980527    0.764032    0.755631    0.754228    0.991107    0.808266    3600        59.320288   0.037606    0.539580    116.274687 
[37m[36mINFO[0m[0m 03/18 18:42:35 | 0.762669    0.742954    0.988943    0.781223    1.238159    0.994336    0.779381    0.981672    0.752577    0.762669    0.742954    0.990820    0.811711    3800        62.615860   0.038360    0.555432    118.069957 
[37m[36mINFO[0m[0m 03/18 18:46:23 | 0.759291    0.728298    0.990223    0.785816    1.203263    0.995881    0.769072    0.980527    0.761741    0.759291    0.728298    0.994263    0.826636    4000        65.911432   0.031877    0.556536    115.887285 
[37m[36mINFO[0m[0m 03/18 18:50:12 | 0.761824    0.736189    0.990415    0.782524    1.398288    0.995881    0.764948    0.979668    0.767468    0.761824    0.736189    0.995697    0.815155    4200        69.207003   0.033638    0.566787    116.174174 
[37m[36mINFO[0m[0m 03/18 18:54:02 | 0.749155    0.728298    0.988965    0.778104    1.326507    0.991246    0.750515    0.981672    0.756014    0.749155    0.728298    0.993976    0.827784    4400        72.502575   0.037269    0.551352    120.179676 
[37m[36mINFO[0m[0m 03/18 18:57:48 | 0.737331    0.719278    0.989421    0.772817    1.321948    0.994336    0.758763    0.981959    0.756014    0.737331    0.719278    0.991968    0.803674    4600        75.798146   0.032010    0.548080    115.906111 
[37m[36mINFO[0m[0m 03/18 19:01:39 | 0.740991    0.723788    0.988792    0.773358    1.331669    0.993306    0.764948    0.979668    0.742268    0.740991    0.723788    0.993402    0.812859    4800        79.093718   0.033132    0.544766    121.904796 
[37m[36mINFO[0m[0m 03/18 19:05:22 | 0.756475    0.727170    0.990701    0.777790    1.420535    0.995881    0.748454    0.981386    0.768614    0.756475    0.727170    0.994836    0.816303    5000        82.389289   0.028924    0.539789    114.708326 
[37m[36mINFO[0m[0m 03/18 19:05:22 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[2]/250318_17-28-15_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 19:05:23 | ---
[37m[36mINFO[0m[0m 03/18 19:05:23 | test-domain validation(oracle) = 75.563%
[37m[36mINFO[0m[0m 03/18 19:05:23 | training-domain validation(iid) = 76.914%
[37m[36mINFO[0m[0m 03/18 19:05:23 | last = 75.648%
[37m[36mINFO[0m[0m 03/18 19:05:23 | last (inD) = 77.779%
[37m[36mINFO[0m[0m 03/18 19:05:23 | training-domain validation (iid, inD) = 78.634%
[37m[36mINFO[0m[0m 03/18 19:05:23 | === Summary ===
[37m[36mINFO[0m[0m 03/18 19:05:23 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm ERM --test_envs 2 --dataset OfficeHome
[37m[36mINFO[0m[0m 03/18 19:05:23 | Unique name: 250318_17-28-15_resnet50_GENIE
[37m[36mINFO[0m[0m 03/18 19:05:23 | Out path: train_output/OfficeHome/ERM/[2]/250318_17-28-15_resnet50_GENIE
[37m[36mINFO[0m[0m 03/18 19:05:23 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 19:05:23 | Dataset: OfficeHome

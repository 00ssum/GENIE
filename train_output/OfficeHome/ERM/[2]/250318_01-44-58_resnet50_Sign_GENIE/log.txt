[37m[36mINFO[0m[0m 03/18 01:44:58 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --trial_seed 0 --hparams_seed 15 --algorithm ERM --test_envs 2 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 15
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/OfficeHome/ERM/[2]/250318_01-44-58_resnet50_Sign_GENIE
	out_root: train_output/OfficeHome/ERM/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250318_01-44-58_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00010661763546249327
	batch_size: 14
	weight_decay: 9.086452814323981e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/18 01:44:58 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 01:44:58 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 01:44:58 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 01:44:58 | 
[37m[36mINFO[0m[0m 03/18 01:44:58 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 03/18 01:44:58 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 03/18 01:44:58 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 03/18 01:44:58 | Batch sizes for each domain: [14, 14, 0, 14] (total=42)
[37m[36mINFO[0m[0m 03/18 01:44:58 | steps-per-epoch for each domain: 138.71, 249.43, 249.00 -> min = 138.71
[37m[36mINFO[0m[0m 03/18 01:45:00 | # of params = 23641217
[37m[36mINFO[0m[0m 03/18 01:46:59 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 01:46:59 | 0.022804    0.024803    0.033607    0.032102    4.212266    0.043769    0.030928    0.019187    0.027491    0.022804    0.024803    0.037866    0.037887    0           0.000000    4.396195    1.020194    118.534843 
[37m[36mINFO[0m[0m 03/18 01:49:47 | 0.641329    0.639233    0.672406    0.638656    1.338292    0.676622    0.626804    0.614261    0.569301    0.641329    0.639233    0.726334    0.719862    200         1.441813    2.750781    0.240633    119.814274 
[37m[36mINFO[0m[0m 03/18 01:52:32 | 0.681588    0.677565    0.746875    0.692283    1.167057    0.743563    0.684536    0.707045    0.648339    0.681588    0.677565    0.790017    0.743972    400         2.883625    1.235862    0.242608    116.093430 
[37m[36mINFO[0m[0m 03/18 01:55:13 | 0.667230    0.644870    0.786134    0.693511    1.122789    0.801751    0.672165    0.751718    0.656357    0.667230    0.644870    0.804934    0.752009    600         4.325438    0.932521    0.234206    114.849686 
[37m[36mINFO[0m[0m 03/18 01:57:58 | 0.702703    0.683202    0.831041    0.731486    1.038118    0.852214    0.709278    0.797824    0.704467    0.702703    0.683202    0.843087    0.780712    800         5.767250    0.723864    0.242725    116.416969 
[37m[36mINFO[0m[0m 03/18 02:00:41 | 0.702140    0.698985    0.846555    0.727586    1.164767    0.884140    0.721649    0.805842    0.687285    0.702140    0.698985    0.849684    0.773823    1000        7.209063    0.635117    0.235246    115.546556 
[37m[36mINFO[0m[0m 03/18 02:03:25 | 0.701858    0.689966    0.864972    0.738504    1.101052    0.889804    0.736082    0.829897    0.709049    0.701858    0.689966    0.875215    0.770379    1200        8.650875    0.593861    0.242829    115.838377 
[37m[36mINFO[0m[0m 03/18 02:06:11 | 0.707207    0.697858    0.895326    0.751492    0.991406    0.925850    0.746392    0.865407    0.729668    0.707207    0.697858    0.894722    0.778416    1400        10.092688   0.485400    0.248858    115.928005 
[37m[36mINFO[0m[0m 03/18 02:08:53 | 0.731137    0.723788    0.897948    0.753640    1.000558    0.922245    0.729897    0.867125    0.738832    0.731137    0.723788    0.904475    0.792193    1600        11.534501   0.440661    0.241156    113.477008 
[37m[36mINFO[0m[0m 03/18 02:11:38 | 0.732545    0.719278    0.914078    0.768078    1.001361    0.942842    0.752577    0.886312    0.753723    0.732545    0.719278    0.913081    0.797933    1800        12.976313   0.372865    0.243896    116.185496 
[37m[36mINFO[0m[0m 03/18 02:14:25 | 0.715653    0.702368    0.923131    0.754703    1.047761    0.951081    0.742268    0.894330    0.737686    0.715653    0.702368    0.923982    0.784156    2000        14.418126   0.318106    0.245136    117.642787 
[37m[36mINFO[0m[0m 03/18 02:17:10 | 0.706081    0.682074    0.915648    0.733085    1.180778    0.939238    0.717526    0.889462    0.706758    0.706081    0.682074    0.918244    0.774971    2200        15.859938   0.309682    0.244348    116.702836 
[37m[36mINFO[0m[0m 03/18 02:19:56 | 0.696791    0.688839    0.926296    0.748809    1.114043    0.960865    0.746392    0.895762    0.734250    0.696791    0.688839    0.922260    0.765786    2400        17.301751   0.286244    0.246901    116.164107 
[37m[36mINFO[0m[0m 03/18 02:22:38 | 0.711712    0.696731    0.934958    0.761667    1.142232    0.954171    0.729897    0.908935    0.752577    0.711712    0.696731    0.941767    0.802526    2600        18.743563   0.269538    0.239568    114.237420 
[37m[36mINFO[0m[0m 03/18 02:25:25 | 0.726351    0.691094    0.952388    0.763949    1.104363    0.970649    0.750515    0.934422    0.750286    0.726351    0.691094    0.952094    0.791045    2800        20.185376   0.230593    0.241108    119.030900 
[37m[36mINFO[0m[0m 03/18 02:28:09 | 0.731137    0.713641    0.952882    0.769383    1.068244    0.972709    0.748454    0.936712    0.752577    0.731137    0.713641    0.949225    0.807118    3000        21.627188   0.227264    0.244520    114.552095 
[37m[36mINFO[0m[0m 03/18 02:30:51 | 0.722691    0.700113    0.955176    0.758982    1.278513    0.975283    0.740206    0.934422    0.750286    0.722691    0.700113    0.955823    0.786452    3200        23.069001   0.183413    0.230331    116.675040 
[37m[36mINFO[0m[0m 03/18 02:33:31 | 0.719032    0.691094    0.957468    0.752496    1.171697    0.975283    0.709278    0.939576    0.754868    0.719032    0.691094    0.957544    0.793341    3400        24.510814   0.182597    0.229528    114.142527 
[37m[36mINFO[0m[0m 03/18 02:36:17 | 0.725788    0.712514    0.963807    0.750048    1.263807    0.981977    0.723711    0.946735    0.738832    0.725788    0.712514    0.962708    0.787600    3600        25.952626   0.176075    0.239594    117.934241 
[37m[36mINFO[0m[0m 03/18 02:38:58 | 0.730011    0.703495    0.951069    0.762810    1.234902    0.964985    0.729897    0.942440    0.758305    0.730011    0.703495    0.945783    0.800230    3800        27.394439   0.176015    0.231564    114.053451 
[37m[36mINFO[0m[0m 03/18 02:41:43 | 0.724662    0.711387    0.969215    0.772366    1.205444    0.980433    0.740206    0.956472    0.764032    0.724662    0.711387    0.970740    0.812859    4000        28.836251   0.166710    0.237290    117.610756 
[37m[36mINFO[0m[0m 03/18 02:44:22 | 0.720158    0.705750    0.971123    0.757837    1.071416    0.985582    0.729897    0.955326    0.756014    0.720158    0.705750    0.972461    0.787600    4200        30.278064   0.134016    0.226169    113.881004 
[37m[36mINFO[0m[0m 03/18 02:47:06 | 0.730011    0.694476    0.965947    0.755320    1.197596    0.980947    0.715464    0.951604    0.758305    0.730011    0.694476    0.965290    0.792193    4400        31.719876   0.156183    0.233004    117.458205 
[37m[36mINFO[0m[0m 03/18 02:49:47 | 0.729730    0.705750    0.969230    0.765862    1.312232    0.982492    0.729897    0.959336    0.770905    0.729730    0.705750    0.965863    0.796785    4600        33.161689   0.138169    0.233241    114.713326 
[37m[36mINFO[0m[0m 03/18 02:52:27 | 0.736205    0.717024    0.971485    0.767773    1.195002    0.986097    0.750515    0.957331    0.753723    0.736205    0.717024    0.971027    0.799082    4800        34.603502   0.130038    0.228363    114.465234 
[37m[36mINFO[0m[0m 03/18 02:55:05 | 0.733390    0.703495    0.974562    0.772893    1.113720    0.985582    0.746392    0.960767    0.768614    0.733390    0.703495    0.977338    0.803674    5000        36.045314   0.126537    0.219597    114.091299 
[37m[36mINFO[0m[0m 03/18 02:55:05 | Cumulative gradient change saved at train_output/OfficeHome/ERM/[2]/250318_01-44-58_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 02:55:07 | ---
[37m[36mINFO[0m[0m 03/18 02:55:07 | test-domain validation(oracle) = 73.114%
[37m[36mINFO[0m[0m 03/18 02:55:07 | training-domain validation(iid) = 73.339%
[37m[36mINFO[0m[0m 03/18 02:55:07 | last = 73.339%
[37m[36mINFO[0m[0m 03/18 02:55:07 | last (inD) = 77.289%
[37m[36mINFO[0m[0m 03/18 02:55:07 | training-domain validation (iid, inD) = 77.289%
[37m[36mINFO[0m[0m 03/18 02:55:07 | === Summary ===
[37m[36mINFO[0m[0m 03/18 02:55:07 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --trial_seed 0 --hparams_seed 15 --algorithm ERM --test_envs 2 --dataset OfficeHome
[37m[36mINFO[0m[0m 03/18 02:55:07 | Unique name: 250318_01-44-58_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 02:55:07 | Out path: train_output/OfficeHome/ERM/[2]/250318_01-44-58_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 02:55:07 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 02:55:07 | Dataset: OfficeHome

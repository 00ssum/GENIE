[37m[36mINFO[0m[0m 02/18 11:01:03 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset OfficeHome --trial_seed 2 --hparams_seed 0
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/RSC/[3]/250218_11-01-03_resnet50_GENIE
	out_root: train_output/OfficeHome/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250218_11-01-03_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	rsc_f_drop_factor: 0.3333333333333333
	rsc_b_drop_factor: 0.3333333333333333
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/18 11:01:03 | n_steps = 5001
[37m[36mINFO[0m[0m 02/18 11:01:03 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/18 11:01:03 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/18 11:01:03 | 
[37m[36mINFO[0m[0m 02/18 11:01:03 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 02/18 11:01:03 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 02/18 11:01:03 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/18 11:01:03 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 02/18 11:01:03 | steps-per-epoch for each domain: 60.69, 109.12, 111.00 -> min = 60.69
[37m[36mINFO[0m[0m 02/18 11:01:04 | # of params = 23641217
[37m[36mINFO[0m[0m 02/18 11:03:12 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/18 11:03:12 | 0.017212    0.027555    0.015848    0.025440    4.183112    0.018023    0.043299    0.014318    0.020619    0.015203    0.012401    0.017212    0.027555    0           0.000000    5.795656    1.198331    126.454731 
[37m[36mINFO[0m[0m 02/18 11:06:07 | 0.017499    0.021814    0.021806    0.024228    4.173017    0.021112    0.022680    0.022910    0.025200    0.021396    0.024803    0.017499    0.021814    200         3.295572    4.186916    0.261606    123.062831 
[37m[36mINFO[0m[0m 02/18 11:09:10 | 0.019220    0.012629    0.025780    0.025944    4.170631    0.041195    0.039175    0.023196    0.020619    0.012950    0.018038    0.019220    0.012629    400         6.591143    4.171231    0.302867    122.277746 
[37m[36mINFO[0m[0m 02/18 11:12:18 | 0.019220    0.012629    0.025780    0.025944    4.168468    0.041195    0.039175    0.023196    0.020619    0.012950    0.018038    0.019220    0.012629    600         9.886715    4.169007    0.341667    119.548060 
[37m[36mINFO[0m[0m 02/18 11:15:20 | 0.019220    0.012629    0.025780    0.025944    4.166486    0.041195    0.039175    0.023196    0.020619    0.012950    0.018038    0.019220    0.012629    800         13.182286   4.166721    0.255248    131.282909 
[37m[36mINFO[0m[0m 02/18 11:18:23 | 0.019220    0.012629    0.025780    0.025944    4.164630    0.041195    0.039175    0.023196    0.020619    0.012950    0.018038    0.019220    0.012629    1000        16.477858   4.164664    0.291436    124.776808 
[37m[36mINFO[0m[0m 02/18 11:21:26 | 0.019220    0.012629    0.025780    0.025944    4.163031    0.041195    0.039175    0.023196    0.020619    0.012950    0.018038    0.019220    0.012629    1200        19.773429   4.163154    0.264418    130.384215 
[37m[36mINFO[0m[0m 02/18 11:24:25 | 0.019220    0.012629    0.025780    0.025944    4.161551    0.041195    0.039175    0.023196    0.020619    0.012950    0.018038    0.019220    0.012629    1400        23.069001   4.161475    0.256138    127.053102 
[37m[36mINFO[0m[0m 02/18 11:27:19 | 0.019220    0.012629    0.025780    0.025944    4.160309    0.041195    0.039175    0.023196    0.020619    0.012950    0.018038    0.019220    0.012629    1600        26.364573   4.160427    0.262561    122.080722 
[37m[36mINFO[0m[0m 02/18 11:30:27 | 0.019220    0.012629    0.025780    0.025944    4.159020    0.041195    0.039175    0.023196    0.020619    0.012950    0.018038    0.019220    0.012629    1800        29.660144   4.157137    0.365334    114.258916 
[37m[36mINFO[0m[0m 02/18 11:33:37 | 0.019220    0.012629    0.025780    0.025944    4.157866    0.041195    0.039175    0.023196    0.020619    0.012950    0.018038    0.019220    0.012629    2000        32.955716   4.157410    0.302079    130.421420 
[37m[36mINFO[0m[0m 02/18 11:36:46 | 0.017499    0.014925    0.025750    0.030777    4.156831    0.036045    0.041237    0.022623    0.022910    0.018581    0.028185    0.017499    0.014925    2200        36.251287   4.155908    0.263907    135.861884 
[37m[36mINFO[0m[0m 02/18 11:39:43 | 0.019220    0.012629    0.025780    0.025944    4.155906    0.041195    0.039175    0.023196    0.020619    0.012950    0.018038    0.019220    0.012629    2400        39.546859   4.155494    0.268938    122.837210 
[37m[36mINFO[0m[0m 02/18 11:42:45 | 0.017785    0.014925    0.025750    0.030777    4.155113    0.036045    0.041237    0.022623    0.022910    0.018581    0.028185    0.017785    0.014925    2600        42.842430   4.154565    0.274318    127.453789 
[37m[36mINFO[0m[0m 02/18 11:45:46 | 0.017785    0.014925    0.025750    0.030777    4.154406    0.036045    0.041237    0.022623    0.022910    0.018581    0.028185    0.017785    0.014925    2800        46.138002   4.155354    0.330157    114.454821 
[37m[36mINFO[0m[0m 02/18 11:49:01 | 0.019220    0.012629    0.025780    0.025944    4.153766    0.041195    0.039175    0.023196    0.020619    0.012950    0.018038    0.019220    0.012629    3000        49.433574   4.152170    0.299370    136.035764 
[37m[36mINFO[0m[0m 02/18 11:52:09 | 0.019220    0.012629    0.025780    0.025944    4.153082    0.041195    0.039175    0.023196    0.020619    0.012950    0.018038    0.019220    0.012629    3200        52.729145   4.150232    0.270188    133.336265 
[37m[36mINFO[0m[0m 02/18 11:55:01 | 0.019220    0.012629    0.025780    0.025944    4.152459    0.041195    0.039175    0.023196    0.020619    0.012950    0.018038    0.019220    0.012629    3400        56.024717   4.149992    0.270956    117.769387 
[37m[36mINFO[0m[0m 02/18 11:58:12 | 0.019220    0.012629    0.025780    0.025944    4.151876    0.041195    0.039175    0.023196    0.020619    0.012950    0.018038    0.019220    0.012629    3600        59.320288   4.149929    0.348755    121.281555 
[37m[36mINFO[0m[0m 02/18 12:01:16 | 0.019220    0.012629    0.025780    0.025944    4.151430    0.041195    0.039175    0.023196    0.020619    0.012950    0.018038    0.019220    0.012629    3800        62.615860   4.151565    0.262628    131.181877 
[37m[36mINFO[0m[0m 02/18 12:04:25 | 0.019220    0.012629    0.025780    0.025944    4.150974    0.041195    0.039175    0.023196    0.020619    0.012950    0.018038    0.019220    0.012629    4000        65.911432   4.148303    0.288642    131.459490 
[37m[36mINFO[0m[0m 02/18 12:07:29 | 0.019220    0.012629    0.025780    0.025944    4.150596    0.041195    0.039175    0.023196    0.020619    0.012950    0.018038    0.019220    0.012629    4200        69.207003   4.148926    0.305166    122.826530 
[37m[36mINFO[0m[0m 02/18 12:10:44 | 0.017785    0.014925    0.025750    0.030777    4.150286    0.036045    0.041237    0.022623    0.022910    0.018581    0.028185    0.017785    0.014925    4400        72.502575   4.148933    0.350787    125.581742 
[37m[36mINFO[0m[0m 02/18 12:13:54 | 0.017785    0.014925    0.025750    0.030777    4.149885    0.036045    0.041237    0.022623    0.022910    0.018581    0.028185    0.017785    0.014925    4600        75.798146   4.148079    0.267980    135.779860 
[37m[36mINFO[0m[0m 02/18 12:16:58 | 0.017785    0.014925    0.025750    0.030777    4.149673    0.036045    0.041237    0.022623    0.022910    0.018581    0.028185    0.017785    0.014925    4800        79.093718   4.148911    0.258585    132.897194 
[37m[36mINFO[0m[0m 02/18 12:20:01 | 0.017785    0.014925    0.025750    0.030777    4.149416    0.036045    0.041237    0.022623    0.022910    0.018581    0.028185    0.017785    0.014925    5000        82.389289   4.147750    0.315029    119.403707 
[37m[36mINFO[0m[0m 02/18 12:20:01 | Cumulative gradient change saved at train_output/OfficeHome/RSC/[3]/250218_11-01-03_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/18 12:20:02 | ---
[37m[36mINFO[0m[0m 02/18 12:20:02 | test-domain validation(oracle) = 1.721%
[37m[36mINFO[0m[0m 02/18 12:20:02 | training-domain validation(iid) = 1.750%
[37m[36mINFO[0m[0m 02/18 12:20:02 | last = 1.779%
[37m[36mINFO[0m[0m 02/18 12:20:02 | last (inD) = 3.078%
[37m[36mINFO[0m[0m 02/18 12:20:02 | training-domain validation (iid, inD) = 3.078%
[37m[36mINFO[0m[0m 02/18 12:20:02 | === Summary ===
[37m[36mINFO[0m[0m 02/18 12:20:02 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset OfficeHome --trial_seed 2 --hparams_seed 0
[37m[36mINFO[0m[0m 02/18 12:20:02 | Unique name: 250218_11-01-03_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 12:20:02 | Out path: train_output/OfficeHome/RSC/[3]/250218_11-01-03_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 12:20:02 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/18 12:20:02 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 02/16 07:38:24 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 4
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 4
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/RSC/[3]/250216_07-38-24_resnet50_GENIE
	out_root: train_output/OfficeHome/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250216_07-38-24_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.0793009436922532e-05
	batch_size: 30
	weight_decay: 0.0007980067844361917
	rsc_f_drop_factor: 0.00568084739259922
	rsc_b_drop_factor: 0.21660562421584156
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/16 07:38:24 | n_steps = 5001
[37m[36mINFO[0m[0m 02/16 07:38:24 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/16 07:38:24 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/16 07:38:24 | 
[37m[36mINFO[0m[0m 02/16 07:38:24 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 02/16 07:38:24 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 02/16 07:38:24 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/16 07:38:24 | Batch sizes for each domain: [30, 30, 30, 0] (total=90)
[37m[36mINFO[0m[0m 02/16 07:38:24 | steps-per-epoch for each domain: 64.73, 116.40, 118.40 -> min = 64.73
[37m[36mINFO[0m[0m 02/16 07:38:25 | # of params = 23641217
[37m[36mINFO[0m[0m 02/16 07:40:55 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/16 07:40:55 | 0.020654    0.024110    0.015120    0.011929    4.218738    0.019567    0.016495    0.010309    0.008018    0.015484    0.011274    0.020654    0.024110    0           0.000000    4.354457    1.195100    148.449941 
[37m[36mINFO[0m[0m 02/16 07:44:24 | 0.719736    0.694604    0.731305    0.701243    1.113229    0.721936    0.696907    0.674399    0.632302    0.797579    0.774521    0.719736    0.694604    200         3.089598    2.618082    0.314847    146.483690 
[37m[36mINFO[0m[0m 02/16 07:47:48 | 0.766208    0.771527    0.832653    0.752042    0.962726    0.846035    0.729897    0.777205    0.697595    0.874718    0.828636    0.766208    0.771527    400         6.179197    0.937553    0.335184    136.542840 
[37m[36mINFO[0m[0m 02/16 07:51:27 | 0.787722    0.779564    0.887819    0.766437    0.857374    0.911946    0.729897    0.839347    0.719359    0.912162    0.850056    0.787722    0.779564    600         9.268795    0.643055    0.366070    145.638787 
[37m[36mINFO[0m[0m 02/16 07:55:03 | 0.767642    0.761194    0.911625    0.775535    0.936033    0.936148    0.740206    0.867984    0.723940    0.930743    0.862458    0.767642    0.761194    800         12.358393   0.472114    0.339918    148.257643 
[37m[36mINFO[0m[0m 02/16 07:58:35 | 0.767929    0.763490    0.920120    0.780535    0.959725    0.939753    0.760825    0.880011    0.725086    0.940597    0.855693    0.767929    0.763490    1000        15.447992   0.365799    0.338788    143.957231 
[37m[36mINFO[0m[0m 02/16 08:02:11 | 0.775961    0.779564    0.951225    0.789948    0.935282    0.972194    0.740206    0.916953    0.749141    0.964527    0.880496    0.775961    0.779564    1200        18.537590   0.279081    0.405708    135.585191 
[37m[36mINFO[0m[0m 02/16 08:05:47 | 0.771084    0.755454    0.950834    0.795165    0.928349    0.970649    0.754639    0.922394    0.754868    0.959459    0.875986    0.771084    0.755454    1400        21.627188   0.231632    0.373048    140.841337 
[37m[36mINFO[0m[0m 02/16 08:09:22 | 0.767929    0.764638    0.962470    0.787271    0.963528    0.981977    0.752577    0.934994    0.742268    0.970439    0.866967    0.767929    0.764638    1600        24.716787   0.206939    0.343230    146.936381 
[37m[36mINFO[0m[0m 02/16 08:12:50 | 0.782559    0.777268    0.971561    0.802978    0.993496    0.985582    0.771134    0.952749    0.766323    0.976351    0.871477    0.782559    0.777268    1800        27.806385   0.168657    0.363941    134.503615 
[37m[36mINFO[0m[0m 02/16 08:16:16 | 0.792025    0.783008    0.977026    0.806501    0.944170    0.991761    0.767010    0.957617    0.768614    0.981700    0.883878    0.792025    0.783008    2000        30.895984   0.151472    0.378269    130.963282 
[37m[36mINFO[0m[0m 02/16 08:19:23 | 0.770797    0.761194    0.973818    0.806495    1.004967    0.985582    0.756701    0.953608    0.777778    0.982264    0.885006    0.770797    0.761194    2200        33.985582   0.109627    0.291878    128.399930 
[37m[36mINFO[0m[0m 02/16 08:22:30 | 0.781698    0.768083    0.977448    0.799347    1.132509    0.988157    0.754639    0.962486    0.764032    0.981700    0.879369    0.781698    0.768083    2400        37.075180   0.107991    0.278869    131.050538 
[37m[36mINFO[0m[0m 02/16 08:25:48 | 0.780551    0.763490    0.982588    0.798923    1.105180    0.990216    0.744330    0.970218    0.765178    0.987331    0.887260    0.780551    0.763490    2600        40.164779   0.101808    0.287467    140.862154 
[37m[36mINFO[0m[0m 02/16 08:28:55 | 0.789157    0.772675    0.985762    0.802353    1.075812    0.993821    0.744330    0.970504    0.774341    0.992962    0.888388    0.789157    0.772675    2800        43.254377   0.090729    0.289395    128.978368 
[37m[36mINFO[0m[0m 02/16 08:31:58 | 0.775387    0.769231    0.984684    0.804421    1.038942    0.992791    0.760825    0.973368    0.765178    0.987894    0.887260    0.775387    0.769231    3000        46.343975   0.085738    0.311449    120.518631 
[37m[36mINFO[0m[0m 02/16 08:35:16 | 0.784854    0.768083    0.984812    0.806107    1.044730    0.991761    0.756701    0.973654    0.775487    0.989020    0.886133    0.784854    0.768083    3200        49.433574   0.080667    0.392676    119.624722 
[37m[36mINFO[0m[0m 02/16 08:38:30 | 0.784567    0.766935    0.984168    0.792486    1.120733    0.990731    0.734021    0.970218    0.766323    0.991554    0.877114    0.784567    0.766935    3400        52.523172   0.070785    0.353158    122.826434 
[37m[36mINFO[0m[0m 02/16 08:41:29 | 0.769650    0.763490    0.986909    0.803076    1.097222    0.991246    0.756701    0.976518    0.770905    0.992962    0.881623    0.769650    0.763490    3600        55.612770   0.066821    0.279706    124.038198 
[37m[36mINFO[0m[0m 02/16 08:44:34 | 0.783419    0.764638    0.987433    0.807656    1.084541    0.992791    0.754639    0.978236    0.772050    0.991273    0.896280    0.783419    0.764638    3800        58.702369   0.063449    0.285296    127.378372 
[37m[36mINFO[0m[0m 02/16 08:47:34 | 0.778830    0.766935    0.986925    0.795846    1.177954    0.990731    0.746392    0.976518    0.764032    0.993525    0.877114    0.778830    0.766935    4000        61.791967   0.062356    0.291679    121.496224 
[37m[36mINFO[0m[0m 02/16 08:50:30 | 0.786288    0.792193    0.989031    0.811169    1.074305    0.995366    0.762887    0.976231    0.774341    0.995495    0.896280    0.786288    0.792193    4200        64.881565   0.052784    0.299601    116.336857 
[37m[36mINFO[0m[0m 02/16 08:53:34 | 0.783419    0.769231    0.988575    0.807827    1.134097    0.992791    0.771134    0.981100    0.759450    0.991836    0.892897    0.783419    0.769231    4400        67.971164   0.051284    0.330946    117.631071 
[37m[36mINFO[0m[0m 02/16 08:56:43 | 0.786001    0.769231    0.989082    0.813772    1.089460    0.994336    0.764948    0.979668    0.781214    0.993243    0.895152    0.786001    0.769231    4600        71.060762   0.055037    0.314598    125.810147 
[37m[36mINFO[0m[0m 02/16 08:59:42 | 0.783706    0.769231    0.988977    0.815030    1.199048    0.994336    0.773196    0.977663    0.783505    0.994932    0.888388    0.783706    0.769231    4800        74.150360   0.045487    0.292529    121.349302 
[37m[36mINFO[0m[0m 02/16 09:02:46 | 0.763913    0.750861    0.988064    0.800362    1.187375    0.993821    0.746392    0.979381    0.765178    0.990991    0.889515    0.763913    0.750861    5000        77.239959   0.051057    0.277138    128.547522 
[37m[36mINFO[0m[0m 02/16 09:02:47 | Cumulative gradient change saved at train_output/OfficeHome/RSC/[3]/250216_07-38-24_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/16 09:02:48 | ---
[37m[36mINFO[0m[0m 02/16 09:02:48 | test-domain validation(oracle) = 78.629%
[37m[36mINFO[0m[0m 02/16 09:02:48 | training-domain validation(iid) = 78.371%
[37m[36mINFO[0m[0m 02/16 09:02:48 | last = 76.391%
[37m[36mINFO[0m[0m 02/16 09:02:48 | last (inD) = 80.036%
[37m[36mINFO[0m[0m 02/16 09:02:48 | training-domain validation (iid, inD) = 81.503%
[37m[36mINFO[0m[0m 02/16 09:02:48 | === Summary ===
[37m[36mINFO[0m[0m 02/16 09:02:48 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 4
[37m[36mINFO[0m[0m 02/16 09:02:48 | Unique name: 250216_07-38-24_resnet50_GENIE
[37m[36mINFO[0m[0m 02/16 09:02:48 | Out path: train_output/OfficeHome/RSC/[3]/250216_07-38-24_resnet50_GENIE
[37m[36mINFO[0m[0m 02/16 09:02:48 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/16 09:02:48 | Dataset: OfficeHome

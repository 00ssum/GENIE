[37m[36mINFO[0m[0m 02/18 13:31:51 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset OfficeHome --trial_seed 2 --hparams_seed 16
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 16
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/RSC/[3]/250218_13-31-51_resnet50_GENIE
	out_root: train_output/OfficeHome/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250218_13-31-51_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.15290264354828e-05
	batch_size: 18
	weight_decay: 0.008257233595621347
	rsc_f_drop_factor: 0.19909449247502037
	rsc_b_drop_factor: 0.35232951467556367
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/18 13:31:51 | n_steps = 5001
[37m[36mINFO[0m[0m 02/18 13:31:51 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/18 13:31:51 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/18 13:31:51 | 
[37m[36mINFO[0m[0m 02/18 13:31:51 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 02/18 13:31:51 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 02/18 13:31:51 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/18 13:31:51 | Batch sizes for each domain: [18, 18, 18, 0] (total=54)
[37m[36mINFO[0m[0m 02/18 13:31:51 | steps-per-epoch for each domain: 107.89, 194.00, 197.33 -> min = 107.89
[37m[36mINFO[0m[0m 02/18 13:31:53 | # of params = 23641217
[37m[36mINFO[0m[0m 02/18 13:33:58 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/18 13:33:58 | 0.026391    0.026406    0.018059    0.027059    4.179462    0.022142    0.039175    0.013173    0.018328    0.018863    0.023675    0.026391    0.026406    0           0.000000    5.400314    1.399835    124.057945 
[37m[36mINFO[0m[0m 02/18 13:37:06 | 0.019220    0.012629    0.025780    0.025944    4.165712    0.041195    0.039175    0.023196    0.020619    0.012950    0.018038    0.019220    0.012629    200         1.853759    4.185993    0.292324    129.863046 
[37m[36mINFO[0m[0m 02/18 13:40:09 | 0.019220    0.012629    0.025780    0.025944    4.160130    0.041195    0.039175    0.023196    0.020619    0.012950    0.018038    0.019220    0.012629    400         3.707518    4.168630    0.211637    139.800388 
[37m[36mINFO[0m[0m 02/18 13:43:03 | 0.019220    0.012629    0.025780    0.025944    4.157733    0.041195    0.039175    0.023196    0.020619    0.012950    0.018038    0.019220    0.012629    600         5.561277    4.166428    0.229430    128.949913 
[37m[36mINFO[0m[0m 02/18 13:46:04 | 0.019220    0.012629    0.025780    0.025944    4.152759    0.041195    0.039175    0.023196    0.020619    0.012950    0.018038    0.019220    0.012629    800         7.415036    4.163640    0.252669    129.883404 
[37m[36mINFO[0m[0m 02/18 13:49:08 | 0.019220    0.012629    0.025780    0.025944    4.147607    0.041195    0.039175    0.023196    0.020619    0.012950    0.018038    0.019220    0.012629    1000        9.268795    4.161128    0.227595    138.383313 
[37m[36mINFO[0m[0m 02/18 13:52:13 | 0.019220    0.012629    0.025780    0.025944    4.146196    0.041195    0.039175    0.023196    0.020619    0.012950    0.018038    0.019220    0.012629    1200        11.122554   4.161341    0.228186    139.695588 
[37m[36mINFO[0m[0m 02/18 13:55:08 | 0.023236    0.017222    0.030478    0.032041    4.131459    0.045314    0.049485    0.030355    0.026346    0.015766    0.020293    0.023236    0.017222    1400        12.976313   4.157864    0.242689    125.967829 
[37m[36mINFO[0m[0m 02/18 13:58:12 | 0.019507    0.018370    0.031166    0.033908    4.121163    0.044284    0.049485    0.030069    0.024055    0.019144    0.028185    0.019507    0.018370    1600        14.830072   4.154890    0.237104    136.479475 
[37m[36mINFO[0m[0m 02/18 14:01:01 | 0.018933    0.018370    0.033533    0.035353    4.095557    0.046859    0.051546    0.031501    0.025200    0.022241    0.029312    0.018933    0.018370    1800        16.683831   4.147004    0.202406    129.427615 
[37m[36mINFO[0m[0m 02/18 14:03:58 | 0.019793    0.013777    0.031820    0.036233    4.091740    0.041195    0.047423    0.029210    0.025200    0.025056    0.036077    0.019793    0.013777    2000        18.537590   4.141431    0.265342    123.594867 
[37m[36mINFO[0m[0m 02/18 14:07:05 | 0.019507    0.012629    0.025971    0.025944    4.089640    0.041195    0.039175    0.023769    0.020619    0.012950    0.018038    0.019507    0.012629    2200        20.391349   4.133812    0.248480    137.100749 
[37m[36mINFO[0m[0m 02/18 14:10:12 | 0.019220    0.012629    0.025780    0.025944    4.068862    0.041195    0.039175    0.023196    0.020619    0.012950    0.018038    0.019220    0.012629    2400        22.245108   4.134938    0.199474    147.213320 
[37m[36mINFO[0m[0m 02/18 14:12:57 | 0.025818    0.021814    0.036815    0.041814    4.011605    0.053553    0.061856    0.034651    0.028637    0.022241    0.034949    0.025818    0.021814    2600        24.098867   4.121062    0.213758    122.475187 
[37m[36mINFO[0m[0m 02/18 14:16:00 | 0.022662    0.018370    0.031990    0.033349    4.002500    0.042739    0.043299    0.034651    0.024055    0.018581    0.032694    0.022662    0.018370    2800        25.952626   4.111152    0.310973    120.214400 
[37m[36mINFO[0m[0m 02/18 14:18:56 | 0.030981    0.033295    0.034800    0.037180    3.977913    0.052008    0.053608    0.034937    0.027491    0.017455    0.030440    0.030981    0.033295    3000        27.806385   4.109304    0.245672    127.476271 
[37m[36mINFO[0m[0m 02/18 14:22:00 | 0.029547    0.025258    0.038146    0.044832    4.104818    0.053038    0.061856    0.034937    0.030928    0.026464    0.041714    0.029547    0.025258    3200        29.660144   4.150499    0.198579    144.321680 
[37m[36mINFO[0m[0m 02/18 14:24:45 | 0.028686    0.028703    0.037571    0.042437    3.979040    0.050978    0.055670    0.038087    0.038946    0.023649    0.032694    0.028686    0.028703    3400        31.513903   4.109439    0.237102    117.418519 
[37m[36mINFO[0m[0m 02/18 14:27:46 | 0.029260    0.024110    0.038658    0.043329    4.045354    0.055098    0.061856    0.037228    0.030928    0.023649    0.037204    0.029260    0.024110    3600        33.367662   4.109247    0.280809    124.138574 
[37m[36mINFO[0m[0m 02/18 14:30:55 | 0.024670    0.019518    0.035577    0.039634    4.007428    0.042225    0.047423    0.035510    0.028637    0.028998    0.042841    0.024670    0.019518    3800        35.221421   4.101919    0.212114    147.565433 
[37m[36mINFO[0m[0m 02/18 14:33:55 | 0.025244    0.026406    0.039269    0.040681    3.997670    0.051493    0.051546    0.042383    0.037801    0.023930    0.032694    0.025244    0.026406    4000        37.075180   4.102759    0.196154    140.131427 
[37m[36mINFO[0m[0m 02/18 14:36:45 | 0.030120    0.030999    0.040298    0.047200    3.978234    0.054068    0.059794    0.039519    0.040092    0.027309    0.041714    0.030120    0.030999    4200        38.928939   4.096863    0.254422    119.248192 
[37m[36mINFO[0m[0m 02/18 14:39:54 | 0.026678    0.019518    0.035267    0.040550    4.023093    0.048404    0.053608    0.031214    0.025200    0.026182    0.042841    0.026678    0.019518    4400        40.782698   4.093142    0.250621    138.402252 
[37m[36mINFO[0m[0m 02/18 14:42:46 | 0.037005    0.040184    0.047918    0.057057    3.922188    0.060247    0.082474    0.043528    0.048110    0.039977    0.040586    0.037005    0.040184    4600        42.636457   4.084528    0.214126    129.789740 
[37m[36mINFO[0m[0m 02/18 14:45:44 | 0.023523    0.029851    0.040909    0.038472    3.958348    0.049434    0.049485    0.038946    0.034364    0.034347    0.031567    0.023523    0.029851    4800        44.490216   4.085333    0.231092    131.984059 
[37m[36mINFO[0m[0m 02/18 14:48:40 | 0.033563    0.036739    0.047204    0.052943    3.923475    0.058702    0.068041    0.041523    0.037801    0.041385    0.052988    0.033563    0.036739    5000        46.343975   4.081407    0.254527    124.974217 
[37m[36mINFO[0m[0m 02/18 14:48:40 | Cumulative gradient change saved at train_output/OfficeHome/RSC/[3]/250218_13-31-51_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/18 14:48:41 | ---
[37m[36mINFO[0m[0m 02/18 14:48:41 | test-domain validation(oracle) = 3.701%
[37m[36mINFO[0m[0m 02/18 14:48:41 | training-domain validation(iid) = 3.701%
[37m[36mINFO[0m[0m 02/18 14:48:41 | last = 3.356%
[37m[36mINFO[0m[0m 02/18 14:48:41 | last (inD) = 5.294%
[37m[36mINFO[0m[0m 02/18 14:48:41 | training-domain validation (iid, inD) = 5.706%
[37m[36mINFO[0m[0m 02/18 14:48:42 | === Summary ===
[37m[36mINFO[0m[0m 02/18 14:48:42 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset OfficeHome --trial_seed 2 --hparams_seed 16
[37m[36mINFO[0m[0m 02/18 14:48:42 | Unique name: 250218_13-31-51_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 14:48:42 | Out path: train_output/OfficeHome/RSC/[3]/250218_13-31-51_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 14:48:42 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/18 14:48:42 | Dataset: OfficeHome

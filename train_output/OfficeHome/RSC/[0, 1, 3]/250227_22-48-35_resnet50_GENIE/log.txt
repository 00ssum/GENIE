[37m[36mINFO[0m[0m 02/27 22:48:35 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 3 --dataset OfficeHome --trial_seed 2 --hparams_seed 12
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 12
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/RSC/[0, 1, 3]/250227_22-48-35_resnet50_GENIE
	out_root: train_output/OfficeHome/RSC/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 2
	unique_name: 250227_22-48-35_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5.346798771850428e-05
	batch_size: 44
	weight_decay: 1.8352299015720086e-05
	rsc_f_drop_factor: 0.3799895564860098
	rsc_b_drop_factor: 0.03414045373033975
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/27 22:48:35 | n_steps = 5001
[37m[36mINFO[0m[0m 02/27 22:48:35 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/27 22:48:35 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/27 22:48:35 | 
[37m[36mINFO[0m[0m 02/27 22:48:35 | Testenv name escaping te_A_C_R -> te_A_C_R
[37m[36mINFO[0m[0m 02/27 22:48:35 | Test envs = [0, 1, 3], name = te_A_C_R
[37m[36mINFO[0m[0m 02/27 22:48:35 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 02/27 22:48:35 | Batch sizes for each domain: [0, 0, 44, 0] (total=44)
[37m[36mINFO[0m[0m 02/27 22:48:35 | steps-per-epoch for each domain: 80.73 -> min = 80.73
[37m[36mINFO[0m[0m 02/27 22:48:36 | # of params = 23641217
[37m[36mINFO[0m[0m 02/27 22:50:31 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/27 22:50:31 | 0.023223    0.020180    0.030968    0.029312    4.200611    0.022657    0.022680    0.020046    0.012600    0.030968    0.029312    0.026965    0.025258    0           0.000000    4.535181    1.315585    113.606988 
[37m[36mINFO[0m[0m 02/27 22:53:10 | 0.494692    0.501536    0.879223    0.820744    0.612047    0.427394    0.451546    0.401489    0.391753    0.879223    0.820744    0.655192    0.661309    200         2.477477    2.179704    0.251220    108.803628 
[37m[36mINFO[0m[0m 02/27 22:55:42 | 0.498820    0.495268    0.935248    0.875986    0.428888    0.439753    0.455670    0.386312    0.376861    0.935248    0.875986    0.670396    0.653272    400         4.954955    0.589157    0.225139    106.648529 
[37m[36mINFO[0m[0m 02/27 22:58:22 | 0.522439    0.527140    0.963401    0.879369    0.452315    0.469619    0.492784    0.404066    0.398625    0.963401    0.879369    0.693632    0.690011    600         7.432432    0.414342    0.206536    118.820261 
[37m[36mINFO[0m[0m 02/27 23:00:55 | 0.517701    0.529673    0.982545    0.887260    0.448952    0.476313    0.496907    0.385166    0.384880    0.982545    0.887260    0.691624    0.707233    800         9.909910    0.340820    0.235114    105.614783 
[37m[36mINFO[0m[0m 02/27 23:03:37 | 0.532304    0.539432    0.981700    0.892897    0.417500    0.486612    0.511340    0.416094    0.420389    0.981700    0.892897    0.694205    0.686567    1000        12.387387   0.302746    0.232049    115.679455 
[37m[36mINFO[0m[0m 02/27 23:06:16 | 0.517171    0.519276    0.988176    0.895152    0.437350    0.470134    0.478351    0.386025    0.387171    0.988176    0.895152    0.695353    0.692308    1200        14.864865   0.272716    0.258348    107.990289 
[37m[36mINFO[0m[0m 02/27 23:09:00 | 0.525819    0.532710    0.991273    0.898534    0.439607    0.473738    0.496907    0.406071    0.418099    0.991273    0.898534    0.697648    0.683123    1400        17.342342   0.250510    0.238494    115.538416 
[37m[36mINFO[0m[0m 02/27 23:11:37 | 0.527519    0.530199    0.993525    0.896280    0.430150    0.466529    0.482474    0.421821    0.412371    0.993525    0.896280    0.694205    0.695752    1600        19.819820   0.240862    0.211228    114.746271 
[37m[36mINFO[0m[0m 02/27 23:14:19 | 0.522670    0.531949    0.991836    0.900789    0.412050    0.466014    0.486598    0.406644    0.422680    0.991836    0.900789    0.695353    0.686567    1800        22.297297   0.228347    0.241912    113.841665 
[37m[36mINFO[0m[0m 02/27 23:16:58 | 0.504856    0.519571    0.987331    0.897407    0.470325    0.452111    0.480412    0.378580    0.399771    0.987331    0.897407    0.683878    0.678530    2000        24.774775   0.245179    0.227218    113.239849 
[37m[36mINFO[0m[0m 02/27 23:19:35 | 0.509151    0.523463    0.993806    0.898534    0.414873    0.449537    0.498969    0.397766    0.396334    0.993806    0.898534    0.680149    0.675086    2200        27.252252   0.231752    0.230553    111.358618 
[37m[36mINFO[0m[0m 02/27 23:22:18 | 0.523146    0.534994    0.996622    0.901917    0.392791    0.466014    0.507216    0.410653    0.422680    0.996622    0.901917    0.692771    0.675086    2400        29.729730   0.216399    0.216090    119.848436 
[37m[36mINFO[0m[0m 02/27 23:25:03 | 0.526204    0.528665    0.995214    0.900789    0.426915    0.466014    0.482474    0.414948    0.416953    0.995214    0.900789    0.697648    0.686567    2600        32.207207   0.212436    0.231039    118.179903 
[37m[36mINFO[0m[0m 02/27 23:27:40 | 0.511542    0.523473    0.995214    0.903044    0.423161    0.452111    0.488660    0.391466    0.394044    0.995214    0.903044    0.691050    0.687715    2800        34.684685   0.209473    0.225264    112.710230 
[37m[36mINFO[0m[0m 02/27 23:30:23 | 0.503086    0.507195    0.992399    0.882751    0.472193    0.435633    0.463918    0.390893    0.386025    0.992399    0.882751    0.682731    0.671642    3000        37.162162   0.209947    0.263388    109.690077 
[37m[36mINFO[0m[0m 02/27 23:33:01 | 0.525403    0.533778    0.995214    0.900789    0.427598    0.464470    0.509278    0.413517    0.410080    0.995214    0.900789    0.698221    0.681975    3200        39.639640   0.215883    0.226539    112.682220 
[37m[36mINFO[0m[0m 02/27 23:35:29 | 0.522995    0.540509    0.995495    0.907554    0.394962    0.470134    0.503093    0.400344    0.421535    0.995495    0.907554    0.698508    0.696900    3400        42.117117   0.208641    0.206848    106.763476 
[37m[36mINFO[0m[0m 02/27 23:38:09 | 0.516620    0.527211    0.994088    0.895152    0.472271    0.454171    0.480412    0.404926    0.418099    0.994088    0.895152    0.690763    0.683123    3600        44.594595   0.203840    0.226371    114.571322 
[37m[36mINFO[0m[0m 02/27 23:40:45 | 0.515171    0.522163    0.995777    0.908681    0.422265    0.441813    0.482474    0.416667    0.411226    0.995777    0.908681    0.687034    0.672790    3800        47.072072   0.207136    0.211810    114.081289 
[37m[36mINFO[0m[0m 02/27 23:43:27 | 0.509268    0.518735    0.996903    0.901917    0.443690    0.451596    0.482474    0.389175    0.390607    0.996903    0.901917    0.687034    0.683123    4000        49.549550   0.209062    0.277650    106.541416 
[37m[36mINFO[0m[0m 02/27 23:46:12 | 0.512025    0.528509    0.996340    0.897407    0.457129    0.436663    0.476289    0.408935    0.426117    0.996340    0.897407    0.690476    0.683123    4200        52.027027   0.203060    0.220834    120.310729 
[37m[36mINFO[0m[0m 02/27 23:48:41 | 0.511789    0.513522    0.993525    0.889515    0.502030    0.445417    0.478351    0.405212    0.405498    0.993525    0.889515    0.684739    0.656716    4400        54.504505   0.212392    0.212855    106.608727 
[37m[36mINFO[0m[0m 02/27 23:51:28 | 0.527114    0.535372    0.996622    0.898534    0.448953    0.472194    0.496907    0.418958    0.439863    0.996622    0.898534    0.690189    0.669346    4600        56.981982   0.212670    0.237023    119.435818 
[37m[36mINFO[0m[0m 02/27 23:54:09 | 0.521731    0.528280    0.997185    0.913191    0.412143    0.465499    0.492784    0.411512    0.408935    0.997185    0.913191    0.688181    0.683123    4800        59.459459   0.203981    0.221925    117.015812 
[37m[36mINFO[0m[0m 02/27 23:56:48 | 0.525614    0.524765    0.996340    0.906426    0.429637    0.461380    0.474227    0.416380    0.420389    0.996340    0.906426    0.699082    0.679679    5000        61.936937   0.197728    0.230233    113.303134 
[37m[36mINFO[0m[0m 02/27 23:56:49 | Cumulative gradient change saved at train_output/OfficeHome/RSC/[0, 1, 3]/250227_22-48-35_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/27 23:56:50 | ---
[37m[36mINFO[0m[0m 02/27 23:56:50 | test-domain validation(oracle) = 52.300%
[37m[36mINFO[0m[0m 02/27 23:56:50 | training-domain validation(iid) = 52.173%
[37m[36mINFO[0m[0m 02/27 23:56:50 | last = 52.561%
[37m[36mINFO[0m[0m 02/27 23:56:50 | last (inD) = 90.643%
[37m[36mINFO[0m[0m 02/27 23:56:50 | training-domain validation (iid, inD) = 91.319%
[37m[36mINFO[0m[0m 02/27 23:56:50 | === Summary ===
[37m[36mINFO[0m[0m 02/27 23:56:50 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 3 --dataset OfficeHome --trial_seed 2 --hparams_seed 12
[37m[36mINFO[0m[0m 02/27 23:56:50 | Unique name: 250227_22-48-35_resnet50_GENIE
[37m[36mINFO[0m[0m 02/27 23:56:50 | Out path: train_output/OfficeHome/RSC/[0, 1, 3]/250227_22-48-35_resnet50_GENIE
[37m[36mINFO[0m[0m 02/27 23:56:50 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/27 23:56:50 | Dataset: OfficeHome

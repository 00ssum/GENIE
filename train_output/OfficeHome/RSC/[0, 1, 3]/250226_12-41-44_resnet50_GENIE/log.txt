[37m[36mINFO[0m[0m 02/26 12:41:44 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 3 --dataset OfficeHome --trial_seed 1 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/RSC/[0, 1, 3]/250226_12-41-44_resnet50_GENIE
	out_root: train_output/OfficeHome/RSC/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 1
	unique_name: 250226_12-41-44_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.2332416678311953e-05
	batch_size: 13
	weight_decay: 0.0018634819595667504
	rsc_f_drop_factor: 0.157459736969642
	rsc_b_drop_factor: 0.14769128459366804
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/26 12:41:44 | n_steps = 5001
[37m[36mINFO[0m[0m 02/26 12:41:44 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/26 12:41:44 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/26 12:41:44 | 
[37m[36mINFO[0m[0m 02/26 12:41:44 | Testenv name escaping te_A_C_R -> te_A_C_R
[37m[36mINFO[0m[0m 02/26 12:41:44 | Test envs = [0, 1, 3], name = te_A_C_R
[37m[36mINFO[0m[0m 02/26 12:41:44 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 02/26 12:41:44 | Batch sizes for each domain: [0, 0, 13, 0] (total=13)
[37m[36mINFO[0m[0m 02/26 12:41:44 | steps-per-epoch for each domain: 273.23 -> min = 273.23
[37m[36mINFO[0m[0m 02/26 12:41:46 | # of params = 23641217
[37m[36mINFO[0m[0m 02/26 12:43:42 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/26 12:43:42 | 0.016885    0.015672    0.031250    0.033822    4.215131    0.013388    0.010309    0.014605    0.013746    0.031250    0.033822    0.022662    0.022962    0           0.000000    4.601154    1.738197    113.834830 
[37m[36mINFO[0m[0m 02/26 12:46:18 | 0.062794    0.069087    0.115146    0.126268    3.932265    0.057673    0.063918    0.058419    0.074456    0.115146    0.126268    0.072289    0.068886    200         0.731982    4.158381    0.140545    128.550898 
[37m[36mINFO[0m[0m 02/26 12:48:39 | 0.216700    0.204639    0.445946    0.431793    2.194575    0.177652    0.160825    0.173826    0.178694    0.445946    0.431793    0.298623    0.274397    400         1.463964    3.480582    0.137786    113.585907 
[37m[36mINFO[0m[0m 02/26 12:51:11 | 0.327013    0.335199    0.678773    0.594138    1.396442    0.259526    0.268041    0.301260    0.294387    0.678773    0.594138    0.420252    0.443169    600         2.195946    2.107039    0.149023    121.461959 
[37m[36mINFO[0m[0m 02/26 12:53:38 | 0.357851    0.340531    0.739020    0.655017    1.257433    0.288363    0.319588    0.304410    0.276060    0.739020    0.655017    0.480780    0.425947    800         2.927928    1.568227    0.128662    121.086524 
[37m[36mINFO[0m[0m 02/26 12:56:00 | 0.400151    0.423704    0.815034    0.733935    0.949596    0.329557    0.364948    0.343070    0.365407    0.815034    0.733935    0.527826    0.540758    1000        3.659910    1.372836    0.144298    113.450614 
[37m[36mINFO[0m[0m 02/26 12:58:29 | 0.338520    0.344992    0.778153    0.717024    1.131337    0.243563    0.261856    0.303837    0.305842    0.778153    0.717024    0.468158    0.467279    1200        4.391892    1.226030    0.130814    123.041533 
[37m[36mINFO[0m[0m 02/26 13:00:46 | 0.373528    0.390699    0.850507    0.764374    0.827133    0.288363    0.338144    0.312428    0.313860    0.850507    0.764374    0.519793    0.520092    1400        5.123874    1.059800    0.124986    112.084048 
[37m[36mINFO[0m[0m 02/26 13:03:13 | 0.396792    0.385575    0.842624    0.760992    0.899246    0.330072    0.331959    0.330470    0.313860    0.842624    0.760992    0.529834    0.510907    1600        5.855856    1.070566    0.132817    120.441111 
[37m[36mINFO[0m[0m 02/26 13:05:39 | 0.411735    0.425921    0.870777    0.773393    0.871203    0.349125    0.387629    0.354811    0.345934    0.870777    0.773393    0.531268    0.544202    1800        6.587838    0.927242    0.141063    117.807409 
[37m[36mINFO[0m[0m 02/26 13:08:07 | 0.378859    0.389469    0.866554    0.776776    0.897607    0.303811    0.340206    0.329611    0.318442    0.866554    0.776776    0.503155    0.509759    2000        7.319820    0.876426    0.159158    115.716056 
[37m[36mINFO[0m[0m 02/26 13:10:31 | 0.392561    0.401026    0.890766    0.793687    0.766757    0.305355    0.327835    0.343643    0.332188    0.890766    0.793687    0.528686    0.543054    2200        8.051802    0.838404    0.136443    117.465680 
[37m[36mINFO[0m[0m 02/26 13:12:50 | 0.396683    0.406685    0.901182    0.809470    0.772162    0.322863    0.329897    0.331615    0.336770    0.901182    0.809470    0.535571    0.553387    2400        8.783784    0.727736    0.167877    104.683649 
[37m[36mINFO[0m[0m 02/26 13:15:16 | 0.409459    0.395813    0.881475    0.816234    0.740421    0.325953    0.334021    0.358820    0.336770    0.881475    0.816234    0.543603    0.516648    2600        9.515766    0.658111    0.160590    113.841757 
[37m[36mINFO[0m[0m 02/26 13:17:29 | 0.380031    0.387628    0.869651    0.774521    0.992077    0.298146    0.317526    0.329324    0.345934    0.869651    0.774521    0.512622    0.499426    2800        10.247748   0.748343    0.137911    106.143888 
[37m[36mINFO[0m[0m 02/26 13:20:04 | 0.372691    0.386940    0.876408    0.773393    1.172127    0.302781    0.346392    0.315006    0.316151    0.876408    0.773393    0.500287    0.498278    3000        10.979730   0.623713    0.171608    120.081408 
[37m[36mINFO[0m[0m 02/26 13:22:25 | 0.388672    0.404749    0.916104    0.824126    0.753985    0.304840    0.340206    0.324170    0.355097    0.916104    0.824126    0.537005    0.518944    3200        11.711712   0.688369    0.130407    115.100830 
[37m[36mINFO[0m[0m 02/26 13:24:51 | 0.389529    0.390007    0.930180    0.826381    0.662993    0.299691    0.325773    0.338488    0.329897    0.930180    0.826381    0.530407    0.514351    3400        12.443694   0.582658    0.203957    105.550147 
[37m[36mINFO[0m[0m 02/26 13:27:18 | 0.375768    0.381972    0.918356    0.800451    0.946746    0.284758    0.325773    0.313860    0.327606    0.918356    0.800451    0.528686    0.492537    3600        13.175676   0.676563    0.139763    118.308116 
[37m[36mINFO[0m[0m 02/26 13:29:33 | 0.362439    0.372061    0.923142    0.788050    1.029799    0.270855    0.305155    0.301546    0.296678    0.923142    0.788050    0.514917    0.514351    3800        13.907658   0.645510    0.144259    106.433633 
[37m[36mINFO[0m[0m 02/26 13:32:06 | 0.411169    0.424420    0.957770    0.862458    0.661869    0.323893    0.346392    0.346793    0.349370    0.957770    0.862458    0.562823    0.577497    4000        14.639640   0.504605    0.213177    110.172025 
[37m[36mINFO[0m[0m 02/26 13:34:31 | 0.399911    0.398196    0.957770    0.844419    0.653484    0.298146    0.342268    0.344502    0.315006    0.957770    0.844419    0.557085    0.537313    4200        15.371622   0.478249    0.137482    117.638132 
[37m[36mINFO[0m[0m 02/26 13:36:51 | 0.339753    0.346050    0.893581    0.791432    0.956496    0.248713    0.263918    0.312715    0.321879    0.893581    0.791432    0.457831    0.452354    4400        16.103604   0.551656    0.177031    104.242244 
[37m[36mINFO[0m[0m 02/26 13:39:17 | 0.368740    0.380620    0.944257    0.809470    0.864860    0.260556    0.270103    0.335911    0.349370    0.944257    0.809470    0.509753    0.522388    4600        16.835586   0.485984    0.149516    116.987375 
[37m[36mINFO[0m[0m 02/26 13:41:31 | 0.388084    0.406538    0.948761    0.839910    0.715379    0.292482    0.323711    0.334479    0.334479    0.948761    0.839910    0.537292    0.561424    4800        17.567568   0.452800    0.141559    104.996696 
[37m[36mINFO[0m[0m 02/26 13:43:48 | 0.401290    0.408122    0.954673    0.830891    0.768193    0.309475    0.352577    0.356243    0.335624    0.954673    0.830891    0.538153    0.536165    5000        18.299550   0.444650    0.144659    108.425203 
[37m[36mINFO[0m[0m 02/26 13:43:48 | Cumulative gradient change saved at train_output/OfficeHome/RSC/[0, 1, 3]/250226_12-41-44_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/26 13:43:50 | ---
[37m[36mINFO[0m[0m 02/26 13:43:50 | test-domain validation(oracle) = 41.173%
[37m[36mINFO[0m[0m 02/26 13:43:50 | training-domain validation(iid) = 41.117%
[37m[36mINFO[0m[0m 02/26 13:43:50 | last = 40.129%
[37m[36mINFO[0m[0m 02/26 13:43:50 | last (inD) = 83.089%
[37m[36mINFO[0m[0m 02/26 13:43:50 | training-domain validation (iid, inD) = 86.246%
[37m[36mINFO[0m[0m 02/26 13:43:50 | === Summary ===
[37m[36mINFO[0m[0m 02/26 13:43:50 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 3 --dataset OfficeHome --trial_seed 1 --hparams_seed 1
[37m[36mINFO[0m[0m 02/26 13:43:50 | Unique name: 250226_12-41-44_resnet50_GENIE
[37m[36mINFO[0m[0m 02/26 13:43:50 | Out path: train_output/OfficeHome/RSC/[0, 1, 3]/250226_12-41-44_resnet50_GENIE
[37m[36mINFO[0m[0m 02/26 13:43:50 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/26 13:43:50 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 01/30 09:57:30 | Command :: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm RSC --test_envs 0 1 3 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/OfficeHome/RSC/[0, 1, 3]/250130_09-57-30_resnet50_sgd
	out_root: train_output/OfficeHome/RSC/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 0
	unique_name: 250130_09-57-30_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	rsc_f_drop_factor: 0.3333333333333333
	rsc_b_drop_factor: 0.3333333333333333
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 01/30 09:57:30 | n_steps = 5001
[37m[36mINFO[0m[0m 01/30 09:57:30 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/30 09:57:30 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/30 09:57:30 | 
[37m[36mINFO[0m[0m 01/30 09:57:30 | Testenv name escaping te_A_C_R -> te_A_C_R
[37m[36mINFO[0m[0m 01/30 09:57:30 | Test envs = [0, 1, 3], name = te_A_C_R
[37m[36mINFO[0m[0m 01/30 09:57:30 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 01/30 09:57:30 | Batch sizes for each domain: [0, 0, 32, 0] (total=32)
[37m[36mINFO[0m[0m 01/30 09:57:30 | steps-per-epoch for each domain: 111.00 -> min = 111.00
[37m[36mINFO[0m[0m 01/30 09:57:31 | # of params = 23641217
[37m[36mINFO[0m[0m 01/30 09:59:52 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/30 09:59:52 | 0.017681    0.016577    0.012950    0.015784    4.259149    0.020082    0.026804    0.016896    0.014891    0.012950    0.015784    0.016064    0.008037    0           0.000000    5.881649    1.461287    139.327689 
[37m[36mINFO[0m[0m 01/30 10:03:09 | 0.018386    0.018565    0.010135    0.015784    4.192324    0.021627    0.024742    0.018614    0.020619    0.010135    0.015784    0.014917    0.010333    200         1.801802    5.294214    0.260700    144.164644 
[37m[36mINFO[0m[0m 01/30 10:06:22 | 0.013347    0.010700    0.011261    0.005637    4.182721    0.015963    0.010309    0.011455    0.010309    0.011261    0.005637    0.012622    0.011481    400         3.603604    4.785306    0.249803    142.645625 
[37m[36mINFO[0m[0m 01/30 10:09:46 | 0.013174    0.012840    0.011261    0.006764    4.178472    0.015448    0.014433    0.012600    0.010309    0.011261    0.006764    0.011474    0.013777    600         5.405405    4.562855    0.246240    154.289418 
[37m[36mINFO[0m[0m 01/30 10:13:06 | 0.011721    0.011770    0.011261    0.007892    4.175250    0.015963    0.012371    0.011168    0.010309    0.011261    0.007892    0.008032    0.012629    800         7.207207    4.455900    0.222957    155.424365 
[37m[36mINFO[0m[0m 01/30 10:16:42 | 0.010253    0.011767    0.015484    0.004510    4.172798    0.011843    0.012371    0.010309    0.013746    0.015484    0.004510    0.008606    0.009185    1000        9.009009    4.392965    0.265942    163.134378 
[37m[36mINFO[0m[0m 01/30 10:20:33 | 0.010996    0.011079    0.014640    0.004510    4.170880    0.014933    0.010309    0.009737    0.014891    0.014640    0.004510    0.008319    0.008037    1200        10.810811   4.353779    0.303859    170.280324 
[37m[36mINFO[0m[0m 01/30 10:24:08 | 0.013115    0.009931    0.011543    0.004510    4.169539    0.016993    0.010309    0.013173    0.014891    0.011543    0.004510    0.009180    0.004592    1400        12.612613   4.325991    0.229910    168.708897 
[37m[36mINFO[0m[0m 01/30 10:28:03 | 0.014509    0.010924    0.013232    0.005637    4.168513    0.018023    0.014433    0.015750    0.013746    0.013232    0.005637    0.009753    0.004592    1600        14.414414   4.304119    0.257236    183.602690 
[37m[36mINFO[0m[0m 01/30 10:31:41 | 0.014795    0.012375    0.016610    0.006764    4.167840    0.018023    0.016495    0.016609    0.016037    0.016610    0.006764    0.009753    0.004592    1800        16.216216   4.289364    0.236971    170.395331 
[37m[36mINFO[0m[0m 01/30 10:35:20 | 0.014833    0.013445    0.014640    0.007892    4.167338    0.016993    0.018557    0.018041    0.016037    0.014640    0.007892    0.009466    0.005741    2000        18.018018   4.276660    0.268092    165.421523 
[37m[36mINFO[0m[0m 01/30 10:39:07 | 0.014757    0.015889    0.020552    0.014656    4.166949    0.016478    0.024742    0.018328    0.016037    0.020552    0.014656    0.009466    0.006889    2200        19.819820   4.267954    0.303386    166.398548 
[37m[36mINFO[0m[0m 01/30 10:42:45 | 0.016495    0.014437    0.017736    0.019166    4.166678    0.018538    0.022680    0.020046    0.014891    0.017736    0.019166    0.010901    0.005741    2400        21.621622   4.258943    0.289600    160.804295 
[37m[36mINFO[0m[0m 01/30 10:46:28 | 0.017183    0.016044    0.015484    0.021421    4.166458    0.018023    0.020619    0.020619    0.018328    0.015484    0.021421    0.012909    0.009185    2600        23.423423   4.252684    0.286998    164.927913 
[37m[36mINFO[0m[0m 01/30 10:50:00 | 0.018425    0.016044    0.020270    0.021421    4.166236    0.018023    0.020619    0.022337    0.018328    0.020270    0.021421    0.014917    0.009185    2800        25.225225   4.245615    0.217966    168.421342 
[37m[36mINFO[0m[0m 01/30 10:53:32 | 0.018464    0.016045    0.024775    0.022548    4.166108    0.016993    0.020619    0.022623    0.017182    0.024775    0.022548    0.015777    0.010333    3000        27.027027   4.241065    0.232153    165.386908 
[37m[36mINFO[0m[0m 01/30 10:57:26 | 0.019305    0.017191    0.021959    0.022548    4.166026    0.017508    0.020619    0.024055    0.019473    0.021959    0.022548    0.016351    0.011481    3200        28.828829   4.237281    0.263520    181.177477 
[37m[36mINFO[0m[0m 01/30 11:01:02 | 0.020010    0.016581    0.025901    0.023675    4.166038    0.019053    0.016495    0.024628    0.020619    0.025901    0.023675    0.016351    0.012629    3400        30.630631   4.232636    0.242505    166.814551 
[37m[36mINFO[0m[0m 01/30 11:04:22 | 0.020202    0.018109    0.020552    0.022548    4.166025    0.019053    0.016495    0.024914    0.024055    0.020552    0.022548    0.016638    0.013777    3600        32.432432   4.227716    0.250588    149.047772 
[37m[36mINFO[0m[0m 01/30 11:08:07 | 0.021194    0.018492    0.023086    0.022548    4.166017    0.020597    0.016495    0.025200    0.024055    0.023086    0.022548    0.017785    0.014925    3800        34.234234   4.225143    0.312648    161.552442 
[37m[36mINFO[0m[0m 01/30 11:11:55 | 0.021366    0.019563    0.028716    0.022548    4.166070    0.021112    0.018557    0.025487    0.022910    0.028716    0.022548    0.017499    0.017222    4000        36.036036   4.221769    0.294509    168.344454 
[37m[36mINFO[0m[0m 01/30 11:15:38 | 0.022435    0.020327    0.023086    0.020293    4.166085    0.023172    0.018557    0.025487    0.024055    0.023086    0.020293    0.018646    0.018370    4200        37.837838   4.220086    0.257308    171.393322 
[37m[36mINFO[0m[0m 01/30 11:19:20 | 0.022187    0.020708    0.023649    0.020293    4.166144    0.022142    0.018557    0.025773    0.026346    0.023649    0.020293    0.018646    0.017222    4400        39.639640   4.217349    0.274965    166.317472 
[37m[36mINFO[0m[0m 01/30 11:22:48 | 0.021939    0.019944    0.025338    0.022548    4.166186    0.021112    0.018557    0.026060    0.025200    0.025338    0.022548    0.018646    0.016073    4600        41.441441   4.214802    0.241043    158.435047 
[37m[36mINFO[0m[0m 01/30 11:26:37 | 0.021959    0.020631    0.024212    0.019166    4.166230    0.020597    0.020619    0.026060    0.025200    0.024212    0.019166    0.019220    0.016073    4800        43.243243   4.212295    0.301789    169.328955 
[37m[36mINFO[0m[0m 01/30 11:30:08 | 0.021768    0.020935    0.025619    0.019166    4.166349    0.020597    0.022680    0.026060    0.025200    0.025619    0.019166    0.018646    0.014925    5000        45.045045   4.210430    0.265464    157.367317 
[37m[36mINFO[0m[0m 01/30 11:30:08 | Cumulative gradient change saved at train_output/OfficeHome/RSC/[0, 1, 3]/250130_09-57-30_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/30 11:30:10 | ---
[37m[36mINFO[0m[0m 01/30 11:30:10 | test-domain validation(oracle) = 2.177%
[37m[36mINFO[0m[0m 01/30 11:30:10 | training-domain validation(iid) = 2.001%
[37m[36mINFO[0m[0m 01/30 11:30:10 | last = 2.177%
[37m[36mINFO[0m[0m 01/30 11:30:10 | last (inD) = 1.917%
[37m[36mINFO[0m[0m 01/30 11:30:10 | training-domain validation (iid, inD) = 2.368%
[37m[36mINFO[0m[0m 01/30 11:30:10 | === Summary ===
[37m[36mINFO[0m[0m 01/30 11:30:10 | Command: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm RSC --test_envs 0 1 3 --dataset OfficeHome
[37m[36mINFO[0m[0m 01/30 11:30:10 | Unique name: 250130_09-57-30_resnet50_sgd
[37m[36mINFO[0m[0m 01/30 11:30:10 | Out path: train_output/OfficeHome/RSC/[0, 1, 3]/250130_09-57-30_resnet50_sgd
[37m[36mINFO[0m[0m 01/30 11:30:10 | Algorithm: RSC
[37m[36mINFO[0m[0m 01/30 11:30:10 | Dataset: OfficeHome

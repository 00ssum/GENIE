[37m[36mINFO[0m[0m 02/20 05:58:29 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 3 --dataset OfficeHome --trial_seed 2 --hparams_seed 20
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 20
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/RSC/[0, 1, 3]/250220_05-58-29_resnet50_GENIE
	out_root: train_output/OfficeHome/RSC/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 2
	unique_name: 250220_05-58-29_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 3.0575564760860844e-05
	batch_size: 27
	weight_decay: 7.45235722180653e-06
	rsc_f_drop_factor: 0.29037470564885265
	rsc_b_drop_factor: 0.006830956171108737
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/20 05:58:29 | n_steps = 5001
[37m[36mINFO[0m[0m 02/20 05:58:29 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/20 05:58:29 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/20 05:58:29 | 
[37m[36mINFO[0m[0m 02/20 05:58:29 | Testenv name escaping te_A_C_R -> te_A_C_R
[37m[36mINFO[0m[0m 02/20 05:58:29 | Test envs = [0, 1, 3], name = te_A_C_R
[37m[36mINFO[0m[0m 02/20 05:58:29 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 02/20 05:58:29 | Batch sizes for each domain: [0, 0, 27, 0] (total=27)
[37m[36mINFO[0m[0m 02/20 05:58:29 | steps-per-epoch for each domain: 131.56 -> min = 131.56
[37m[36mINFO[0m[0m 02/20 05:58:31 | # of params = 23641217
[37m[36mINFO[0m[0m 02/20 06:00:43 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/20 06:00:43 | 0.024576    0.023236    0.041104    0.036077    4.199404    0.024717    0.022680    0.023769    0.019473    0.041104    0.036077    0.025244    0.027555    0           0.000000    4.490783    1.139787    130.631955 
[37m[36mINFO[0m[0m 02/20 06:03:24 | 0.473108    0.470865    0.837556    0.801578    0.736976    0.401648    0.422680    0.396334    0.391753    0.837556    0.801578    0.621343    0.598163    200         1.520270    2.003392    0.192035    122.618214 
[37m[36mINFO[0m[0m 02/20 06:05:59 | 0.467874    0.466990    0.902309    0.837655    0.583989    0.419156    0.424742    0.359107    0.352806    0.902309    0.837655    0.625359    0.623421    400         3.040541    0.723442    0.211314    113.375751 
[37m[36mINFO[0m[0m 02/20 06:08:46 | 0.492062    0.495189    0.940315    0.865840    0.496967    0.418641    0.426804    0.400057    0.408935    0.940315    0.865840    0.657487    0.649828    600         4.560811    0.454150    0.207845    125.285112 
[37m[36mINFO[0m[0m 02/20 06:11:26 | 0.507638    0.510086    0.956363    0.886133    0.428735    0.451596    0.468041    0.396907    0.404353    0.956363    0.886133    0.674412    0.657865    800         6.081081    0.389353    0.219899    115.428963 
[37m[36mINFO[0m[0m 02/20 06:14:06 | 0.502141    0.509479    0.970158    0.882751    0.438727    0.445417    0.463918    0.389462    0.402062    0.970158    0.882751    0.671543    0.662457    1000        7.601351    0.317236    0.233820    114.035702 
[37m[36mINFO[0m[0m 02/20 06:17:00 | 0.473305    0.476551    0.968468    0.870349    0.477496    0.411946    0.424742    0.369989    0.361970    0.968468    0.870349    0.637980    0.642939    1200        9.121622    0.281615    0.228522    128.013531 
[37m[36mINFO[0m[0m 02/20 06:19:37 | 0.471757    0.479153    0.976633    0.872604    0.494671    0.394954    0.416495    0.362543    0.369989    0.976633    0.872604    0.657774    0.650976    1400        10.641892   0.270097    0.177693    121.554855 
[37m[36mINFO[0m[0m 02/20 06:22:23 | 0.507608    0.518346    0.987613    0.894025    0.422180    0.447477    0.482474    0.389748    0.398625    0.987613    0.894025    0.685600    0.673938    1600        12.162162   0.235013    0.218047    122.030471 
[37m[36mINFO[0m[0m 02/20 06:25:09 | 0.497673    0.494656    0.984234    0.895152    0.415713    0.426880    0.430928    0.406357    0.400916    0.984234    0.895152    0.659782    0.652124    1800        13.682432   0.203274    0.201633    125.892046 
[37m[36mINFO[0m[0m 02/20 06:28:05 | 0.532069    0.543558    0.990991    0.910936    0.363528    0.472709    0.503093    0.414089    0.438717    0.990991    0.910936    0.709409    0.688863    2000        15.202703   0.200481    0.247782    126.053221 
[37m[36mINFO[0m[0m 02/20 06:30:53 | 0.501174    0.523543    0.989302    0.909808    0.394251    0.443357    0.496907    0.378293    0.394044    0.989302    0.909808    0.681870    0.679679    2200        16.722973   0.191002    0.240661    120.359124 
[37m[36mINFO[0m[0m 02/20 06:33:54 | 0.501798    0.519333    0.989865    0.905299    0.442035    0.449537    0.507216    0.379439    0.383734    0.989865    0.905299    0.676420    0.667049    2400        18.243243   0.195661    0.202807    140.268706 
[37m[36mINFO[0m[0m 02/20 06:36:45 | 0.509437    0.512007    0.991273    0.905299    0.409352    0.452111    0.457732    0.395189    0.405498    0.991273    0.905299    0.681010    0.672790    2600        19.763514   0.180829    0.203908    129.881574 
[37m[36mINFO[0m[0m 02/20 06:39:32 | 0.485652    0.490306    0.990991    0.901917    0.430775    0.414006    0.435052    0.380011    0.380298    0.990991    0.901917    0.662937    0.655568    2800        21.283784   0.183961    0.186242    129.594041 
[37m[36mINFO[0m[0m 02/20 06:42:34 | 0.520324    0.536760    0.994088    0.912063    0.351193    0.449537    0.490722    0.423540    0.431844    0.994088    0.912063    0.687894    0.687715    3000        22.804054   0.179997    0.187115    144.626755 
[37m[36mINFO[0m[0m 02/20 06:45:25 | 0.503197    0.528813    0.993806    0.894025    0.479307    0.445417    0.498969    0.382302    0.406644    0.993806    0.894025    0.681870    0.680827    3200        24.324324   0.166933    0.175306    136.472794 
[37m[36mINFO[0m[0m 02/20 06:48:00 | 0.494649    0.500614    0.987613    0.882751    0.553171    0.451596    0.476289    0.370561    0.371134    0.987613    0.882751    0.661790    0.654420    3400        25.844595   0.176772    0.236228    107.369413 
[37m[36mINFO[0m[0m 02/20 06:50:49 | 0.507377    0.525221    0.993243    0.901917    0.432881    0.443357    0.492784    0.398625    0.405498    0.993243    0.901917    0.680149    0.677382    3600        27.364865   0.181053    0.259923    117.426136 
[37m[36mINFO[0m[0m 02/20 06:53:42 | 0.498330    0.522932    0.987894    0.877114    0.546107    0.432544    0.472165    0.384593    0.416953    0.987894    0.877114    0.677854    0.679679    3800        28.885135   0.179157    0.227738    127.335783 
[37m[36mINFO[0m[0m 02/20 06:56:25 | 0.499282    0.514372    0.993243    0.901917    0.459069    0.424820    0.445361    0.405498    0.427262    0.993243    0.901917    0.667527    0.670494    4000        30.405405   0.170361    0.212346    120.154007 
[37m[36mINFO[0m[0m 02/20 06:59:19 | 0.522624    0.533996    0.996059    0.903044    0.486684    0.467044    0.492784    0.419244    0.441008    0.996059    0.903044    0.681583    0.668197    4200        31.925676   0.186575    0.247322    125.313340 
[37m[36mINFO[0m[0m 02/20 07:02:19 | 0.512182    0.512303    0.993243    0.892897    0.473711    0.447477    0.459794    0.416953    0.415808    0.993243    0.892897    0.672117    0.661309    4400        33.445946   0.167957    0.186550    142.367431 
[37m[36mINFO[0m[0m 02/20 07:04:56 | 0.518581    0.534153    0.995214    0.899662    0.468199    0.452626    0.488660    0.422967    0.441008    0.995214    0.899662    0.680149    0.672790    4600        34.966216   0.161583    0.177397    121.324255 
[37m[36mINFO[0m[0m 02/20 07:07:54 | 0.478377    0.484573    0.990428    0.892897    0.510099    0.417096    0.424742    0.355384    0.380298    0.990428    0.892897    0.662651    0.648680    4800        36.486486   0.154510    0.288822    120.122556 
[37m[36mINFO[0m[0m 02/20 07:11:08 | 0.511502    0.512384    0.994088    0.899662    0.521601    0.450566    0.478351    0.396907    0.391753    0.994088    0.899662    0.687034    0.667049    5000        38.006757   0.155164    0.224875    148.721780 
[37m[36mINFO[0m[0m 02/20 07:11:08 | Cumulative gradient change saved at train_output/OfficeHome/RSC/[0, 1, 3]/250220_05-58-29_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/20 07:11:09 | ---
[37m[36mINFO[0m[0m 02/20 07:11:09 | test-domain validation(oracle) = 53.207%
[37m[36mINFO[0m[0m 02/20 07:11:09 | training-domain validation(iid) = 52.032%
[37m[36mINFO[0m[0m 02/20 07:11:09 | last = 51.150%
[37m[36mINFO[0m[0m 02/20 07:11:09 | last (inD) = 89.966%
[37m[36mINFO[0m[0m 02/20 07:11:09 | training-domain validation (iid, inD) = 91.206%
[37m[36mINFO[0m[0m 02/20 07:11:10 | === Summary ===
[37m[36mINFO[0m[0m 02/20 07:11:10 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 3 --dataset OfficeHome --trial_seed 2 --hparams_seed 20
[37m[36mINFO[0m[0m 02/20 07:11:10 | Unique name: 250220_05-58-29_resnet50_GENIE
[37m[36mINFO[0m[0m 02/20 07:11:10 | Out path: train_output/OfficeHome/RSC/[0, 1, 3]/250220_05-58-29_resnet50_GENIE
[37m[36mINFO[0m[0m 02/20 07:11:10 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/20 07:11:10 | Dataset: OfficeHome

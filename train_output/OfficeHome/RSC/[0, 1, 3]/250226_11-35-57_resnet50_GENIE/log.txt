[37m[36mINFO[0m[0m 02/26 11:35:57 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 3 --dataset OfficeHome --trial_seed 1 --hparams_seed 0
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/RSC/[0, 1, 3]/250226_11-35-57_resnet50_GENIE
	out_root: train_output/OfficeHome/RSC/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 1
	unique_name: 250226_11-35-57_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	rsc_f_drop_factor: 0.3333333333333333
	rsc_b_drop_factor: 0.3333333333333333
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/26 11:35:57 | n_steps = 5001
[37m[36mINFO[0m[0m 02/26 11:35:57 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/26 11:35:57 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/26 11:35:57 | 
[37m[36mINFO[0m[0m 02/26 11:35:57 | Testenv name escaping te_A_C_R -> te_A_C_R
[37m[36mINFO[0m[0m 02/26 11:35:57 | Test envs = [0, 1, 3], name = te_A_C_R
[37m[36mINFO[0m[0m 02/26 11:35:57 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 02/26 11:35:57 | Batch sizes for each domain: [0, 0, 32, 0] (total=32)
[37m[36mINFO[0m[0m 02/26 11:35:57 | steps-per-epoch for each domain: 111.00 -> min = 111.00
[37m[36mINFO[0m[0m 02/26 11:35:58 | # of params = 23641217
[37m[36mINFO[0m[0m 02/26 11:37:48 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/26 11:37:48 | 0.016861    0.012688    0.024493    0.032694    4.185449    0.019053    0.008247    0.014318    0.014891    0.024493    0.032694    0.017212    0.014925    0           0.000000    5.704419    1.343272    108.794015 
[37m[36mINFO[0m[0m 02/26 11:40:31 | 0.024479    0.023685    0.021678    0.024803    4.171204    0.027291    0.030928    0.022337    0.025200    0.021678    0.024803    0.023810    0.014925    200         1.801802    4.188261    0.188328    125.297975 
[37m[36mINFO[0m[0m 02/26 11:42:55 | 0.024766    0.023379    0.021678    0.024803    4.168269    0.027291    0.028866    0.023196    0.026346    0.021678    0.024803    0.023810    0.014925    400         3.603604    4.169670    0.156821    112.055721 
[37m[36mINFO[0m[0m 02/26 11:45:30 | 0.024555    0.022921    0.021678    0.024803    4.165520    0.027806    0.030928    0.022050    0.022910    0.021678    0.024803    0.023810    0.014925    600         5.405405    4.166689    0.197832    116.089360 
[37m[36mINFO[0m[0m 02/26 11:47:54 | 0.015281    0.019867    0.022804    0.020293    4.163008    0.007724    0.010309    0.020046    0.033219    0.022804    0.020293    0.018072    0.016073    800         7.207207    4.164231    0.190081    105.624863 
[37m[36mINFO[0m[0m 02/26 11:50:38 | 0.015281    0.019867    0.022804    0.020293    4.160313    0.007724    0.010309    0.020046    0.033219    0.022804    0.020293    0.018072    0.016073    1000        9.009009    4.161155    0.214240    120.874279 
[37m[36mINFO[0m[0m 02/26 11:53:15 | 0.024479    0.023303    0.021678    0.024803    4.158524    0.027291    0.030928    0.022337    0.024055    0.021678    0.024803    0.023810    0.014925    1200        10.810811   4.159657    0.153296    126.070015 
[37m[36mINFO[0m[0m 02/26 11:55:35 | 0.024651    0.023303    0.021678    0.024803    4.156612    0.027806    0.030928    0.022337    0.024055    0.021678    0.024803    0.023810    0.014925    1400        12.612613   4.157016    0.178464    105.154050 
[37m[36mINFO[0m[0m 02/26 11:58:22 | 0.024479    0.023303    0.021678    0.024803    4.154733    0.027291    0.030928    0.022337    0.024055    0.021678    0.024803    0.023810    0.014925    1600        14.414414   4.155364    0.219387    122.317718 
[37m[36mINFO[0m[0m 02/26 12:00:52 | 0.024479    0.023685    0.021678    0.024803    4.153261    0.027291    0.030928    0.022337    0.025200    0.021678    0.024803    0.023810    0.014925    1800        16.216216   4.153314    0.174499    115.057903 
[37m[36mINFO[0m[0m 02/26 12:03:28 | 0.024651    0.023303    0.021678    0.024803    4.151604    0.027806    0.030928    0.022337    0.024055    0.021678    0.024803    0.023810    0.014925    2000        18.018018   4.151548    0.218530    112.502290 
[37m[36mINFO[0m[0m 02/26 12:06:03 | 0.024651    0.023303    0.021678    0.024803    4.149986    0.027806    0.030928    0.022337    0.024055    0.021678    0.024803    0.023810    0.014925    2200        19.819820   4.150125    0.167460    121.692119 
[37m[36mINFO[0m[0m 02/26 12:08:33 | 0.024651    0.023303    0.021678    0.024803    4.148551    0.027806    0.030928    0.022337    0.024055    0.021678    0.024803    0.023810    0.014925    2400        21.621622   4.149663    0.194030    110.746640 
[37m[36mINFO[0m[0m 02/26 12:11:13 | 0.024651    0.023303    0.021678    0.024803    4.147298    0.027806    0.030928    0.022337    0.024055    0.021678    0.024803    0.023810    0.014925    2600        23.423423   4.147715    0.197586    121.081670 
[37m[36mINFO[0m[0m 02/26 12:13:33 | 0.024651    0.023303    0.021678    0.024803    4.146309    0.027806    0.030928    0.022337    0.024055    0.021678    0.024803    0.023810    0.014925    2800        25.225225   4.147461    0.157056    108.411722 
[37m[36mINFO[0m[0m 02/26 12:15:55 | 0.024651    0.023303    0.021678    0.024803    4.145344    0.027806    0.030928    0.022337    0.024055    0.021678    0.024803    0.023810    0.014925    3000        27.027027   4.146525    0.193145    103.216043 
[37m[36mINFO[0m[0m 02/26 12:18:42 | 0.024651    0.023303    0.021678    0.024803    4.144389    0.027806    0.030928    0.022337    0.024055    0.021678    0.024803    0.023810    0.014925    3200        28.828829   4.144642    0.197368    127.362724 
[37m[36mINFO[0m[0m 02/26 12:21:07 | 0.015281    0.019867    0.023086    0.020293    4.143387    0.007724    0.010309    0.020046    0.033219    0.023086    0.020293    0.018072    0.016073    3400        30.630631   4.143702    0.152953    114.963471 
[37m[36mINFO[0m[0m 02/26 12:23:32 | 0.015281    0.019867    0.022804    0.020293    4.142667    0.007724    0.010309    0.020046    0.033219    0.022804    0.020293    0.018072    0.016073    3600        32.432432   4.142856    0.204352    103.560831 
[37m[36mINFO[0m[0m 02/26 12:26:06 | 0.017801    0.016205    0.023086    0.019166    4.141612    0.016993    0.016495    0.013173    0.011455    0.023086    0.019166    0.023236    0.020666    3800        34.234234   4.140839    0.192943    116.119549 
[37m[36mINFO[0m[0m 02/26 12:28:29 | 0.017801    0.016205    0.023086    0.019166    4.140749    0.016993    0.016495    0.013173    0.011455    0.023086    0.019166    0.023236    0.020666    4000        36.036036   4.140456    0.168965    108.748432 
[37m[36mINFO[0m[0m 02/26 12:31:06 | 0.017801    0.016205    0.023086    0.019166    4.140105    0.016993    0.016495    0.013173    0.011455    0.023086    0.019166    0.023236    0.020666    4200        37.837838   4.141134    0.215685    114.324357 
[37m[36mINFO[0m[0m 02/26 12:33:36 | 0.017801    0.016205    0.023086    0.019166    4.139534    0.016993    0.016495    0.013173    0.011455    0.023086    0.019166    0.023236    0.020666    4400        39.639640   4.144659    0.172351    115.052224 
[37m[36mINFO[0m[0m 02/26 12:36:00 | 0.017801    0.016205    0.023086    0.019166    4.139111    0.016993    0.016495    0.013173    0.011455    0.023086    0.019166    0.023236    0.020666    4600        41.441441   4.139882    0.195065    105.586271 
[37m[36mINFO[0m[0m 02/26 12:38:50 | 0.015281    0.019867    0.022804    0.020293    4.138544    0.007724    0.010309    0.020046    0.033219    0.022804    0.020293    0.018072    0.016073    4800        43.243243   4.138229    0.187350    131.891869 
[37m[36mINFO[0m[0m 02/26 12:41:36 | 0.015281    0.019867    0.022804    0.020293    4.137898    0.007724    0.010309    0.020046    0.033219    0.022804    0.020293    0.018072    0.016073    5000        45.045045   4.135053    0.166148    132.972984 
[37m[36mINFO[0m[0m 02/26 12:41:36 | Cumulative gradient change saved at train_output/OfficeHome/RSC/[0, 1, 3]/250226_11-35-57_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/26 12:41:38 | ---
[37m[36mINFO[0m[0m 02/26 12:41:38 | test-domain validation(oracle) = 2.448%
[37m[36mINFO[0m[0m 02/26 12:41:38 | training-domain validation(iid) = 1.686%
[37m[36mINFO[0m[0m 02/26 12:41:38 | last = 1.528%
[37m[36mINFO[0m[0m 02/26 12:41:38 | last (inD) = 2.029%
[37m[36mINFO[0m[0m 02/26 12:41:38 | training-domain validation (iid, inD) = 3.269%
[37m[36mINFO[0m[0m 02/26 12:41:38 | === Summary ===
[37m[36mINFO[0m[0m 02/26 12:41:38 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 3 --dataset OfficeHome --trial_seed 1 --hparams_seed 0
[37m[36mINFO[0m[0m 02/26 12:41:38 | Unique name: 250226_11-35-57_resnet50_GENIE
[37m[36mINFO[0m[0m 02/26 12:41:38 | Out path: train_output/OfficeHome/RSC/[0, 1, 3]/250226_11-35-57_resnet50_GENIE
[37m[36mINFO[0m[0m 02/26 12:41:38 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/26 12:41:38 | Dataset: OfficeHome

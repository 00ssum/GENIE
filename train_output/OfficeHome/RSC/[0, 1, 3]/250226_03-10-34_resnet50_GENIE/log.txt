[37m[36mINFO[0m[0m 02/26 03:10:34 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 12
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 12
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/RSC/[0, 1, 3]/250226_03-10-34_resnet50_GENIE
	out_root: train_output/OfficeHome/RSC/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 0
	unique_name: 250226_03-10-34_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.00012111338094255871
	batch_size: 9
	weight_decay: 1.821145631101786e-06
	rsc_f_drop_factor: 0.40686428928752155
	rsc_b_drop_factor: 0.1630540413892459
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/26 03:10:34 | n_steps = 5001
[37m[36mINFO[0m[0m 02/26 03:10:34 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/26 03:10:34 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/26 03:10:34 | 
[37m[36mINFO[0m[0m 02/26 03:10:34 | Testenv name escaping te_A_C_R -> te_A_C_R
[37m[36mINFO[0m[0m 02/26 03:10:34 | Test envs = [0, 1, 3], name = te_A_C_R
[37m[36mINFO[0m[0m 02/26 03:10:34 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 02/26 03:10:34 | Batch sizes for each domain: [0, 0, 9, 0] (total=9)
[37m[36mINFO[0m[0m 02/26 03:10:34 | steps-per-epoch for each domain: 394.67 -> min = 394.67
[37m[36mINFO[0m[0m 02/26 03:10:36 | # of params = 23641217
[37m[36mINFO[0m[0m 02/26 03:12:31 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/26 03:12:31 | 0.027574    0.024689    0.031532    0.029312    4.210197    0.031411    0.014433    0.022337    0.029782    0.031532    0.029312    0.028973    0.029851    0           0.000000    5.571475    1.165815    114.540099 
[37m[36mINFO[0m[0m 02/26 03:14:46 | 0.025089    0.021551    0.022241    0.022548    4.172214    0.028836    0.026804    0.024055    0.017182    0.022241    0.022548    0.022375    0.020666    200         0.506757    4.192556    0.128816    109.255591 
[37m[36mINFO[0m[0m 02/26 03:17:10 | 0.025089    0.021551    0.022241    0.022548    4.169547    0.028836    0.026804    0.024055    0.017182    0.022241    0.022548    0.022375    0.020666    400         1.013514    4.169135    0.141246    115.866785 
[37m[36mINFO[0m[0m 02/26 03:19:25 | 0.025089    0.021551    0.022241    0.022548    4.167135    0.028836    0.026804    0.024055    0.017182    0.022241    0.022548    0.022375    0.020666    600         1.520270    4.166747    0.121575    110.707291 
[37m[36mINFO[0m[0m 02/26 03:21:40 | 0.024211    0.021245    0.021678    0.022548    4.165250    0.026777    0.024742    0.023482    0.018328    0.021678    0.022548    0.022375    0.020666    800         2.027027    4.164946    0.114124    111.947714 
[37m[36mINFO[0m[0m 02/26 03:23:53 | 0.025089    0.021551    0.022241    0.022548    4.163580    0.028836    0.026804    0.024055    0.017182    0.022241    0.022548    0.022375    0.020666    1000        2.533784    4.162418    0.117028    108.881755 
[37m[36mINFO[0m[0m 02/26 03:26:13 | 0.016273    0.015898    0.023649    0.016911    4.162268    0.009269    0.004124    0.022050    0.025200    0.023649    0.016911    0.017499    0.018370    1200        3.040541    4.159791    0.115506    117.661617 
[37m[36mINFO[0m[0m 02/26 03:28:23 | 0.025089    0.021551    0.022241    0.022548    4.160459    0.028836    0.026804    0.024055    0.017182    0.022241    0.022548    0.022375    0.020666    1400        3.547297    4.158670    0.121057    105.098918 
[37m[36mINFO[0m[0m 02/26 03:30:36 | 0.025089    0.021551    0.022241    0.022548    4.158835    0.028836    0.026804    0.024055    0.017182    0.022241    0.022548    0.022375    0.020666    1600        4.054054    4.159448    0.123476    108.374166 
[37m[36mINFO[0m[0m 02/26 03:32:47 | 0.025089    0.021551    0.022241    0.022548    4.157418    0.028836    0.026804    0.024055    0.017182    0.022241    0.022548    0.022375    0.020666    1800        4.560811    4.150731    0.117481    108.044618 
[37m[36mINFO[0m[0m 02/26 03:35:00 | 0.016424    0.015973    0.022804    0.020293    4.156182    0.018023    0.022680    0.010023    0.009164    0.022804    0.020293    0.021228    0.016073    2000        5.067568    4.151419    0.122169    108.433327 
[37m[36mINFO[0m[0m 02/26 03:37:14 | 0.016273    0.015898    0.023649    0.016911    4.155211    0.009269    0.004124    0.022050    0.025200    0.023649    0.016911    0.017499    0.018370    2200        5.574324    4.149765    0.119666    109.458581 
[37m[36mINFO[0m[0m 02/26 03:39:22 | 0.016273    0.015898    0.023649    0.016911    4.153818    0.009269    0.004124    0.022050    0.025200    0.023649    0.016911    0.017499    0.018370    2400        6.081081    4.145451    0.119709    104.336687 
[37m[36mINFO[0m[0m 02/26 03:41:40 | 0.016273    0.015898    0.023649    0.016911    4.152625    0.009269    0.004124    0.022050    0.025200    0.023649    0.016911    0.017499    0.018370    2600        6.587838    4.152808    0.133416    111.085586 
[37m[36mINFO[0m[0m 02/26 03:43:50 | 0.016273    0.015898    0.023649    0.016911    4.151453    0.009269    0.004124    0.022050    0.025200    0.023649    0.016911    0.017499    0.018370    2800        7.094595    4.140981    0.117650    107.111696 
[37m[36mINFO[0m[0m 02/26 03:46:00 | 0.016273    0.015898    0.023649    0.016911    4.150560    0.009269    0.004124    0.022050    0.025200    0.023649    0.016911    0.017499    0.018370    3000        7.601351    4.140415    0.127412    104.746826 
[37m[36mINFO[0m[0m 02/26 03:48:12 | 0.016273    0.015898    0.023649    0.016911    4.149662    0.009269    0.004124    0.022050    0.025200    0.023649    0.016911    0.017499    0.018370    3200        8.108108    4.143500    0.110874    109.296772 
[37m[36mINFO[0m[0m 02/26 03:50:23 | 0.016273    0.015898    0.023649    0.016911    4.148490    0.009269    0.004124    0.022050    0.025200    0.023649    0.016911    0.017499    0.018370    3400        8.614865    4.143721    0.128499    104.850992 
[37m[36mINFO[0m[0m 02/26 03:52:32 | 0.016273    0.015898    0.023649    0.016911    4.147973    0.009269    0.004124    0.022050    0.025200    0.023649    0.016911    0.017499    0.018370    3600        9.121622    4.138412    0.121344    105.560864 
[37m[36mINFO[0m[0m 02/26 03:54:42 | 0.016273    0.015898    0.023649    0.016911    4.147576    0.009269    0.004124    0.022050    0.025200    0.023649    0.016911    0.017499    0.018370    3800        9.628378    4.141562    0.112200    107.424915 
[37m[36mINFO[0m[0m 02/26 03:56:51 | 0.016273    0.015898    0.023649    0.016911    4.147307    0.009269    0.004124    0.022050    0.025200    0.023649    0.016911    0.017499    0.018370    4000        10.135135   4.142029    0.123957    104.112825 
[37m[36mINFO[0m[0m 02/26 03:59:02 | 0.016273    0.015898    0.023649    0.016911    4.146713    0.009269    0.004124    0.022050    0.025200    0.023649    0.016911    0.017499    0.018370    4200        10.641892   4.138916    0.115987    107.303865 
[37m[36mINFO[0m[0m 02/26 04:01:12 | 0.016273    0.015898    0.023649    0.016911    4.146484    0.009269    0.004124    0.022050    0.025200    0.023649    0.016911    0.017499    0.018370    4400        11.148649   4.140840    0.129531    103.992407 
[37m[36mINFO[0m[0m 02/26 04:03:24 | 0.016273    0.015898    0.023649    0.016911    4.146094    0.009269    0.004124    0.022050    0.025200    0.023649    0.016911    0.017499    0.018370    4600        11.655405   4.134584    0.118488    108.711701 
[37m[36mINFO[0m[0m 02/26 04:05:35 | 0.015621    0.016511    0.024212    0.014656    4.145723    0.019053    0.018557    0.008591    0.010309    0.024212    0.014656    0.019220    0.020666    4800        12.162162   4.136539    0.113225    108.201329 
[37m[36mINFO[0m[0m 02/26 04:07:45 | 0.015717    0.016511    0.024212    0.014656    4.145373    0.019053    0.018557    0.008877    0.010309    0.024212    0.014656    0.019220    0.020666    5000        12.668919   4.131711    0.118691    106.435849 
[37m[36mINFO[0m[0m 02/26 04:07:45 | Cumulative gradient change saved at train_output/OfficeHome/RSC/[0, 1, 3]/250226_03-10-34_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/26 04:07:47 | ---
[37m[36mINFO[0m[0m 02/26 04:07:47 | test-domain validation(oracle) = 2.757%
[37m[36mINFO[0m[0m 02/26 04:07:47 | training-domain validation(iid) = 2.757%
[37m[36mINFO[0m[0m 02/26 04:07:47 | last = 1.572%
[37m[36mINFO[0m[0m 02/26 04:07:47 | last (inD) = 1.466%
[37m[36mINFO[0m[0m 02/26 04:07:47 | training-domain validation (iid, inD) = 2.931%
[37m[36mINFO[0m[0m 02/26 04:07:47 | === Summary ===
[37m[36mINFO[0m[0m 02/26 04:07:47 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 12
[37m[36mINFO[0m[0m 02/26 04:07:47 | Unique name: 250226_03-10-34_resnet50_GENIE
[37m[36mINFO[0m[0m 02/26 04:07:47 | Out path: train_output/OfficeHome/RSC/[0, 1, 3]/250226_03-10-34_resnet50_GENIE
[37m[36mINFO[0m[0m 02/26 04:07:47 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/26 04:07:47 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 02/26 11:07:58 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 0
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/RSC/[0, 1, 3]/250226_11-07-58_resnet50_GENIE
	out_root: train_output/OfficeHome/RSC/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 0
	unique_name: 250226_11-07-58_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	rsc_f_drop_factor: 0.3333333333333333
	rsc_b_drop_factor: 0.3333333333333333
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/26 11:07:58 | n_steps = 5001
[37m[36mINFO[0m[0m 02/26 11:07:58 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/26 11:07:58 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/26 11:07:58 | 
[37m[36mINFO[0m[0m 02/26 11:07:58 | Testenv name escaping te_A_C_R -> te_A_C_R
[37m[36mINFO[0m[0m 02/26 11:07:58 | Test envs = [0, 1, 3], name = te_A_C_R
[37m[36mINFO[0m[0m 02/26 11:07:58 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 02/26 11:07:58 | Batch sizes for each domain: [0, 0, 32, 0] (total=32)
[37m[36mINFO[0m[0m 02/26 11:07:58 | steps-per-epoch for each domain: 111.00 -> min = 111.00
[37m[36mINFO[0m[0m 02/26 11:07:59 | # of params = 23641217
[37m[36mINFO[0m[0m 02/26 11:09:53 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/26 11:09:53 | 0.023832    0.021394    0.027590    0.022548    4.182056    0.024202    0.020619    0.022623    0.027491    0.027590    0.022548    0.024670    0.016073    0           0.000000    5.881649    1.428984    112.173763 
[37m[36mINFO[0m[0m 02/26 11:12:35 | 0.025184    0.021551    0.022241    0.022548    4.171698    0.028836    0.026804    0.024341    0.017182    0.022241    0.022548    0.022375    0.020666    200         1.801802    4.186721    0.271674    108.267623 
[37m[36mINFO[0m[0m 02/26 11:15:24 | 0.025376    0.021932    0.022523    0.023675    4.169133    0.028836    0.026804    0.024341    0.019473    0.022523    0.023675    0.022949    0.019518    400         3.603604    4.169315    0.257807    117.599225 
[37m[36mINFO[0m[0m 02/26 11:18:10 | 0.025375    0.023002    0.023649    0.022548    4.166693    0.028836    0.028866    0.024628    0.019473    0.023649    0.022548    0.022662    0.020666    600         5.405405    4.165396    0.198883    125.274728 
[37m[36mINFO[0m[0m 02/26 11:20:42 | 0.016845    0.016964    0.024493    0.016911    4.164289    0.009269    0.006186    0.023482    0.029782    0.024493    0.016911    0.017785    0.014925    800         7.207207    4.162790    0.225630    106.887528 
[37m[36mINFO[0m[0m 02/26 11:23:21 | 0.018713    0.018950    0.022523    0.020293    4.162032    0.018023    0.014433    0.021478    0.027491    0.022523    0.020293    0.016638    0.014925    1000        9.009009    4.158995    0.239750    111.196912 
[37m[36mINFO[0m[0m 02/26 11:25:51 | 0.018713    0.018950    0.022523    0.020293    4.160124    0.018023    0.014433    0.021478    0.027491    0.022523    0.020293    0.016638    0.014925    1200        10.810811   4.156108    0.188174    112.492605 
[37m[36mINFO[0m[0m 02/26 11:28:34 | 0.016463    0.016966    0.023649    0.016911    4.158537    0.009269    0.006186    0.022623    0.027491    0.023649    0.016911    0.017499    0.017222    1400        12.612613   4.154239    0.223617    118.877399 
[37m[36mINFO[0m[0m 02/26 11:31:10 | 0.016273    0.015898    0.023649    0.016911    4.157092    0.009269    0.004124    0.022050    0.025200    0.023649    0.016911    0.017499    0.018370    1600        14.414414   4.152538    0.181550    118.924911 
[37m[36mINFO[0m[0m 02/26 11:33:46 | 0.016273    0.015898    0.023649    0.016911    4.155830    0.009269    0.004124    0.022050    0.025200    0.023649    0.016911    0.017499    0.018370    1800        16.216216   4.152890    0.239979    108.372974 
[37m[36mINFO[0m[0m 02/26 11:36:23 | 0.015411    0.013531    0.023649    0.014656    4.154873    0.019567    0.016495    0.007732    0.005727    0.023649    0.014656    0.018933    0.018370    2000        18.018018   4.149590    0.186453    119.551688 
[37m[36mINFO[0m[0m 02/26 11:38:54 | 0.015717    0.016511    0.024212    0.014656    4.153677    0.019053    0.018557    0.008877    0.010309    0.024212    0.014656    0.019220    0.020666    2200        19.819820   4.147772    0.188312    113.858203 
[37m[36mINFO[0m[0m 02/26 11:41:32 | 0.015717    0.016511    0.024212    0.014656    4.152778    0.019053    0.018557    0.008877    0.010309    0.024212    0.014656    0.019220    0.020666    2400        21.621622   4.145873    0.233231    110.531513 
[37m[36mINFO[0m[0m 02/26 11:44:04 | 0.015717    0.016511    0.024212    0.014656    4.151919    0.019053    0.018557    0.008877    0.010309    0.024212    0.014656    0.019220    0.020666    2600        23.423423   4.144361    0.191068    114.351224 
[37m[36mINFO[0m[0m 02/26 11:46:34 | 0.015717    0.016511    0.024212    0.014656    4.150890    0.019053    0.018557    0.008877    0.010309    0.024212    0.014656    0.019220    0.020666    2800        25.225225   4.144022    0.203450    109.014039 
[37m[36mINFO[0m[0m 02/26 11:49:08 | 0.015717    0.016511    0.024212    0.014656    4.150126    0.019053    0.018557    0.008877    0.010309    0.024212    0.014656    0.019220    0.020666    3000        27.027027   4.141526    0.155580    122.924733 
[37m[36mINFO[0m[0m 02/26 11:51:33 | 0.015717    0.016511    0.024212    0.014656    4.149278    0.019053    0.018557    0.008877    0.010309    0.024212    0.014656    0.019220    0.020666    3200        28.828829   4.140901    0.189590    107.276449 
[37m[36mINFO[0m[0m 02/26 11:54:15 | 0.015717    0.016511    0.024212    0.014656    4.148630    0.019053    0.018557    0.008877    0.010309    0.024212    0.014656    0.019220    0.020666    3400        30.630631   4.140109    0.213451    119.502189 
[37m[36mINFO[0m[0m 02/26 11:56:52 | 0.015717    0.016511    0.024212    0.014656    4.147906    0.019053    0.018557    0.008877    0.010309    0.024212    0.014656    0.019220    0.020666    3600        32.432432   4.140785    0.168214    122.527102 
[37m[36mINFO[0m[0m 02/26 11:59:23 | 0.015717    0.016511    0.024212    0.014656    4.147277    0.019053    0.018557    0.008877    0.010309    0.024212    0.014656    0.019220    0.020666    3800        34.234234   4.138510    0.217342    107.731481 
[37m[36mINFO[0m[0m 02/26 12:02:04 | 0.015717    0.016511    0.024212    0.014656    4.146843    0.019053    0.018557    0.008877    0.010309    0.024212    0.014656    0.019220    0.020666    4000        36.036036   4.137940    0.204646    119.967211 
[37m[36mINFO[0m[0m 02/26 12:04:31 | 0.015717    0.016511    0.024212    0.014656    4.146408    0.019053    0.018557    0.008877    0.010309    0.024212    0.014656    0.019220    0.020666    4200        37.837838   4.136596    0.173810    112.640715 
[37m[36mINFO[0m[0m 02/26 12:07:07 | 0.015717    0.016511    0.024212    0.014656    4.146001    0.019053    0.018557    0.008877    0.010309    0.024212    0.014656    0.019220    0.020666    4400        39.639640   4.137500    0.199988    116.070121 
[37m[36mINFO[0m[0m 02/26 12:09:39 | 0.015717    0.016511    0.024212    0.014656    4.145579    0.019053    0.018557    0.008877    0.010309    0.024212    0.014656    0.019220    0.020666    4600        41.441441   4.133736    0.176590    116.655070 
[37m[36mINFO[0m[0m 02/26 12:12:13 | 0.015717    0.016511    0.024212    0.014656    4.145016    0.019053    0.018557    0.008877    0.010309    0.024212    0.014656    0.019220    0.020666    4800        43.243243   4.133783    0.236804    106.550189 
[37m[36mINFO[0m[0m 02/26 12:14:38 | 0.015717    0.016511    0.024212    0.014656    4.144804    0.019053    0.018557    0.008877    0.010309    0.024212    0.014656    0.019220    0.020666    5000        45.045045   4.133425    0.176100    109.780862 
[37m[36mINFO[0m[0m 02/26 12:14:38 | Cumulative gradient change saved at train_output/OfficeHome/RSC/[0, 1, 3]/250226_11-07-58_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/26 12:14:39 | ---
[37m[36mINFO[0m[0m 02/26 12:14:39 | test-domain validation(oracle) = 2.538%
[37m[36mINFO[0m[0m 02/26 12:14:39 | training-domain validation(iid) = 2.538%
[37m[36mINFO[0m[0m 02/26 12:14:39 | last = 1.572%
[37m[36mINFO[0m[0m 02/26 12:14:39 | last (inD) = 1.466%
[37m[36mINFO[0m[0m 02/26 12:14:39 | training-domain validation (iid, inD) = 2.368%
[37m[36mINFO[0m[0m 02/26 12:14:40 | === Summary ===
[37m[36mINFO[0m[0m 02/26 12:14:40 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 0
[37m[36mINFO[0m[0m 02/26 12:14:40 | Unique name: 250226_11-07-58_resnet50_GENIE
[37m[36mINFO[0m[0m 02/26 12:14:40 | Out path: train_output/OfficeHome/RSC/[0, 1, 3]/250226_11-07-58_resnet50_GENIE
[37m[36mINFO[0m[0m 02/26 12:14:40 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/26 12:14:40 | Dataset: OfficeHome

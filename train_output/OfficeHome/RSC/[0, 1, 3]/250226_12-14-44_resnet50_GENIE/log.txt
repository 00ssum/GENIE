[37m[36mINFO[0m[0m 02/26 12:14:44 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/RSC/[0, 1, 3]/250226_12-14-44_resnet50_GENIE
	out_root: train_output/OfficeHome/RSC/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 0
	unique_name: 250226_12-14-44_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5.0781288859686544e-05
	batch_size: 44
	weight_decay: 0.00046410133598234803
	rsc_f_drop_factor: 0.2665134852412123
	rsc_b_drop_factor: 0.28056710878365126
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/26 12:14:44 | n_steps = 5001
[37m[36mINFO[0m[0m 02/26 12:14:44 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/26 12:14:44 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/26 12:14:44 | 
[37m[36mINFO[0m[0m 02/26 12:14:44 | Testenv name escaping te_A_C_R -> te_A_C_R
[37m[36mINFO[0m[0m 02/26 12:14:44 | Test envs = [0, 1, 3], name = te_A_C_R
[37m[36mINFO[0m[0m 02/26 12:14:44 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 02/26 12:14:44 | Batch sizes for each domain: [0, 0, 44, 0] (total=44)
[37m[36mINFO[0m[0m 02/26 12:14:44 | steps-per-epoch for each domain: 80.73 -> min = 80.73
[37m[36mINFO[0m[0m 02/26 12:14:45 | # of params = 23641217
[37m[36mINFO[0m[0m 02/26 12:16:41 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/26 12:16:41 | 0.024938    0.020178    0.025338    0.019166    4.181822    0.027806    0.012371    0.022623    0.025200    0.025338    0.019166    0.024383    0.022962    0           0.000000    5.482560    1.054667    115.009680 
[37m[36mINFO[0m[0m 02/26 12:19:27 | 0.024917    0.021168    0.022241    0.022548    4.163118    0.028321    0.026804    0.024055    0.017182    0.022241    0.022548    0.022375    0.019518    200         2.477477    4.185197    0.298797    105.373803 
[37m[36mINFO[0m[0m 02/26 12:22:11 | 0.024917    0.021551    0.022241    0.022548    4.159303    0.028321    0.026804    0.024055    0.017182    0.022241    0.022548    0.022375    0.020666    400         4.954955    4.167807    0.205514    123.699796 
[37m[36mINFO[0m[0m 02/26 12:24:40 | 0.025184    0.021933    0.022241    0.022548    4.157638    0.028836    0.026804    0.024341    0.018328    0.022241    0.022548    0.022375    0.020666    600         7.432432    4.164775    0.195137    109.211015 
[37m[36mINFO[0m[0m 02/26 12:27:22 | 0.024650    0.022009    0.023086    0.021421    4.150046    0.027806    0.024742    0.023482    0.020619    0.023086    0.021421    0.022662    0.020666    800         9.909910    4.161858    0.264893    109.630037 
[37m[36mINFO[0m[0m 02/26 12:30:05 | 0.024121    0.023924    0.048705    0.032694    4.115351    0.021627    0.014433    0.022050    0.028637    0.048705    0.032694    0.028686    0.028703    1000        12.387387   4.156966    0.211431    120.900986 
[37m[36mINFO[0m[0m 02/26 12:32:42 | 0.040176    0.041666    0.065034    0.050733    3.912082    0.021627    0.020619    0.039233    0.042383    0.065034    0.050733    0.059667    0.061998    1200        14.864865   4.119695    0.232587    109.577478 
[37m[36mINFO[0m[0m 02/26 12:35:25 | 0.033125    0.038300    0.073761    0.076663    3.570941    0.015963    0.018557    0.038373    0.042383    0.073761    0.076663    0.045037    0.053961    1400        17.342342   3.970106    0.258643    111.747676 
[37m[36mINFO[0m[0m 02/26 12:38:12 | 0.063242    0.075128    0.132601    0.131905    3.145189    0.043254    0.065979    0.067297    0.079038    0.132601    0.131905    0.079174    0.080367    1600        19.819820   3.708841    0.210620    124.710162 
[37m[36mINFO[0m[0m 02/26 12:40:50 | 0.086547    0.082260    0.218468    0.199549    2.826795    0.058702    0.049485    0.088488    0.077892    0.218468    0.199549    0.112450    0.119403    1800        22.297297   3.504624    0.222393    114.031929 
[37m[36mINFO[0m[0m 02/26 12:43:43 | 0.138084    0.141047    0.385980    0.338219    2.242245    0.103502    0.103093    0.119989    0.119129    0.385980    0.338219    0.190763    0.200918    2000        24.774775   3.263901    0.311267    110.665533 
[37m[36mINFO[0m[0m 02/26 12:46:28 | 0.214508    0.220328    0.582770    0.535513    1.568500    0.142122    0.150515    0.185281    0.191294    0.582770    0.535513    0.316122    0.319173    2200        27.252252   2.739134    0.202247    123.810146 
[37m[36mINFO[0m[0m 02/26 12:49:00 | 0.284399    0.301880    0.749718    0.624577    1.266547    0.229660    0.259794    0.225372    0.233677    0.749718    0.624577    0.398164    0.412170    2400        29.729730   2.228771    0.198772    112.648577 
[37m[36mINFO[0m[0m 02/26 12:51:38 | 0.307586    0.307776    0.817005    0.722661    1.044438    0.217817    0.235052    0.262027    0.255441    0.817005    0.722661    0.442915    0.432836    2600        32.207207   1.873277    0.258078    106.248759 
[37m[36mINFO[0m[0m 02/26 12:54:26 | 0.372948    0.371605    0.905405    0.777903    0.861275    0.296087    0.286598    0.310710    0.311569    0.905405    0.777903    0.512048    0.516648    2800        34.684685   1.674717    0.241102    119.892000 
[37m[36mINFO[0m[0m 02/26 12:56:58 | 0.392369    0.394153    0.941723    0.827508    0.775857    0.318229    0.307216    0.324456    0.332188    0.941723    0.827508    0.534423    0.543054    3000        37.162162   1.510416    0.200262    111.748271 
[37m[36mINFO[0m[0m 02/26 12:59:39 | 0.402701    0.390938    0.955236    0.829763    0.677523    0.322863    0.311340    0.343070    0.327606    0.955236    0.829763    0.542169    0.533869    3200        39.639640   1.396949    0.247352    112.013618 
[37m[36mINFO[0m[0m 02/26 13:02:20 | 0.393835    0.391242    0.958615    0.826381    0.760903    0.330072    0.323711    0.317869    0.318442    0.958615    0.826381    0.533563    0.531573    3400        42.117117   1.367087    0.227810    115.002517 
[37m[36mINFO[0m[0m 02/26 13:04:52 | 0.392411    0.386502    0.969595    0.828636    0.855239    0.304325    0.317526    0.339920    0.317297    0.969595    0.828636    0.532989    0.524684    3600        44.594595   1.319095    0.223491    107.370941 
[37m[36mINFO[0m[0m 02/26 13:07:37 | 0.407644    0.403625    0.978041    0.848929    0.835910    0.331102    0.319588    0.347079    0.344788    0.978041    0.848929    0.544750    0.546498    3800        47.072072   1.288992    0.269986    110.883730 
[37m[36mINFO[0m[0m 02/26 13:10:12 | 0.406530    0.394308    0.960867    0.852311    0.750895    0.328012    0.313402    0.325888    0.323024    0.960867    0.852311    0.565691    0.546498    4000        49.549550   1.270497    0.231391    109.380093 
[37m[36mINFO[0m[0m 02/26 13:12:52 | 0.408444    0.408830    0.979167    0.852311    0.681756    0.315139    0.334021    0.345074    0.329897    0.979167    0.852311    0.565118    0.562572    4200        52.027027   1.266936    0.265435    106.750448 
[37m[36mINFO[0m[0m 02/26 13:15:37 | 0.400065    0.395979    0.963964    0.825254    0.867285    0.324408    0.329897    0.333906    0.323024    0.963964    0.825254    0.541882    0.535017    4400        54.504505   1.213008    0.223266    120.144942 
[37m[36mINFO[0m[0m 02/26 13:18:14 | 0.408843    0.403404    0.982545    0.850056    0.762631    0.314624    0.315464    0.349656    0.336770    0.982545    0.850056    0.562249    0.557979    4600        56.981982   1.187122    0.199116    116.790448 
[37m[36mINFO[0m[0m 02/26 13:20:49 | 0.396033    0.398730    0.955236    0.827508    1.040665    0.319773    0.327835    0.335338    0.331042    0.955236    0.827508    0.532989    0.537313    4800        59.459459   1.166770    0.251842    104.973666 
[37m[36mINFO[0m[0m 02/26 13:23:34 | 0.394280    0.384978    0.966498    0.830891    0.798324    0.315654    0.307216    0.331901    0.318442    0.966498    0.830891    0.535284    0.529277    5000        61.936937   1.179838    0.199379    125.176309 
[37m[36mINFO[0m[0m 02/26 13:23:34 | Cumulative gradient change saved at train_output/OfficeHome/RSC/[0, 1, 3]/250226_12-14-44_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/26 13:23:36 | ---
[37m[36mINFO[0m[0m 02/26 13:23:36 | test-domain validation(oracle) = 40.844%
[37m[36mINFO[0m[0m 02/26 13:23:36 | training-domain validation(iid) = 40.653%
[37m[36mINFO[0m[0m 02/26 13:23:36 | last = 39.428%
[37m[36mINFO[0m[0m 02/26 13:23:36 | last (inD) = 83.089%
[37m[36mINFO[0m[0m 02/26 13:23:36 | training-domain validation (iid, inD) = 85.231%
[37m[36mINFO[0m[0m 02/26 13:23:36 | === Summary ===
[37m[36mINFO[0m[0m 02/26 13:23:36 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 1
[37m[36mINFO[0m[0m 02/26 13:23:36 | Unique name: 250226_12-14-44_resnet50_GENIE
[37m[36mINFO[0m[0m 02/26 13:23:36 | Out path: train_output/OfficeHome/RSC/[0, 1, 3]/250226_12-14-44_resnet50_GENIE
[37m[36mINFO[0m[0m 02/26 13:23:36 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/26 13:23:36 | Dataset: OfficeHome

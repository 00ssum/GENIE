[37m[36mINFO[0m[0m 02/26 02:05:44 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 6
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 6
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/RSC/[0, 1, 3]/250226_02-05-44_resnet50_GENIE
	out_root: train_output/OfficeHome/RSC/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 0
	unique_name: 250226_02-05-44_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.5764387170443743e-05
	batch_size: 19
	weight_decay: 0.0006024239579587198
	rsc_f_drop_factor: 0.19876770246536363
	rsc_b_drop_factor: 0.08199629172100226
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/26 02:05:44 | n_steps = 5001
[37m[36mINFO[0m[0m 02/26 02:05:44 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/26 02:05:44 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/26 02:05:44 | 
[37m[36mINFO[0m[0m 02/26 02:05:44 | Testenv name escaping te_A_C_R -> te_A_C_R
[37m[36mINFO[0m[0m 02/26 02:05:44 | Test envs = [0, 1, 3], name = te_A_C_R
[37m[36mINFO[0m[0m 02/26 02:05:44 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 02/26 02:05:44 | Batch sizes for each domain: [0, 0, 19, 0] (total=19)
[37m[36mINFO[0m[0m 02/26 02:05:44 | steps-per-epoch for each domain: 186.95 -> min = 186.95
[37m[36mINFO[0m[0m 02/26 02:05:45 | # of params = 23641217
[37m[36mINFO[0m[0m 02/26 02:07:41 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/26 02:07:41 | 0.019858    0.019714    0.024493    0.022548    4.198723    0.020597    0.014433    0.021478    0.028637    0.024493    0.022548    0.017499    0.016073    0           0.000000    4.699673    1.548792    114.269344 
[37m[36mINFO[0m[0m 02/26 02:10:09 | 0.097436    0.093425    0.208896    0.197294    3.440931    0.071576    0.057732    0.087342    0.082474    0.208896    0.197294    0.133391    0.140069    200         1.069820    4.088743    0.172651    113.093691 
[37m[36mINFO[0m[0m 02/26 02:12:39 | 0.340302    0.335995    0.690034    0.655017    1.298605    0.260041    0.237113    0.270905    0.285223    0.690034    0.655017    0.489960    0.485649    400         2.139640    2.416406    0.162926    117.699235 
[37m[36mINFO[0m[0m 02/26 02:15:03 | 0.416085    0.395243    0.829392    0.767756    0.822945    0.317714    0.288660    0.355097    0.326460    0.829392    0.767756    0.575445    0.570608    600         3.209459    1.256800    0.153596    112.584743 
[37m[36mINFO[0m[0m 02/26 02:17:30 | 0.438648    0.452461    0.862331    0.793687    0.719140    0.383110    0.414433    0.357102    0.344788    0.862331    0.793687    0.575731    0.598163    800         4.279279    1.036113    0.161206    115.235189 
[37m[36mINFO[0m[0m 02/26 02:19:57 | 0.419862    0.414238    0.854448    0.801578    0.752909    0.349125    0.362887    0.355956    0.335624    0.854448    0.801578    0.554504    0.544202    1000        5.349099    0.887281    0.150914    117.231886 
[37m[36mINFO[0m[0m 02/26 02:22:20 | 0.434839    0.431314    0.899775    0.819617    0.608240    0.383110    0.387629    0.329038    0.300115    0.899775    0.819617    0.592369    0.606200    1200        6.418919    0.825393    0.164053    109.594774 
[37m[36mINFO[0m[0m 02/26 02:24:50 | 0.447724    0.456001    0.926520    0.836528    0.585019    0.363028    0.371134    0.368843    0.363116    0.926520    0.836528    0.611302    0.633754    1400        7.488739    0.701609    0.147317    120.928167 
[37m[36mINFO[0m[0m 02/26 02:27:15 | 0.438469    0.452607    0.942005    0.866967    0.562784    0.359938    0.389691    0.371993    0.379152    0.942005    0.866967    0.583477    0.588978    1600        8.558559    0.674605    0.142907    116.621419 
[37m[36mINFO[0m[0m 02/26 02:29:48 | 0.417971    0.423814    0.928773    0.856821    0.554306    0.341401    0.362887    0.329611    0.324170    0.928773    0.856821    0.582903    0.584386    1800        9.628378    0.619341    0.162159    120.277173 
[37m[36mINFO[0m[0m 02/26 02:32:24 | 0.416138    0.411136    0.917793    0.824126    0.757782    0.329042    0.334021    0.345074    0.317297    0.917793    0.824126    0.574297    0.582090    2000        10.698198   0.595599    0.157324    124.211995 
[37m[36mINFO[0m[0m 02/26 02:34:57 | 0.433720    0.437415    0.954673    0.852311    0.642308    0.356849    0.387629    0.354811    0.329897    0.954673    0.852311    0.589501    0.594719    2200        11.768018   0.506722    0.165947    120.204996 
[37m[36mINFO[0m[0m 02/26 02:37:32 | 0.389793    0.394702    0.901745    0.806088    0.756247    0.328527    0.334021    0.298396    0.287514    0.901745    0.806088    0.542456    0.562572    2400        12.837838   0.532516    0.147151    124.839424 
[37m[36mINFO[0m[0m 02/26 02:40:00 | 0.406411    0.399124    0.938345    0.835400    0.735578    0.320803    0.327835    0.345074    0.316151    0.938345    0.835400    0.553356    0.553387    2600        13.907658   0.513049    0.167349    115.203029 
[37m[36mINFO[0m[0m 02/26 02:42:27 | 0.439028    0.452246    0.942005    0.832018    0.701279    0.368177    0.400000    0.352234    0.340206    0.942005    0.832018    0.596672    0.616533    2800        14.977477   0.489757    0.156337    115.155080 
[37m[36mINFO[0m[0m 02/26 02:44:52 | 0.461259    0.475303    0.948761    0.850056    0.592951    0.409372    0.447423    0.371420    0.368843    0.948761    0.850056    0.602983    0.609644    3000        16.047297   0.505021    0.177048    109.933837 
[37m[36mINFO[0m[0m 02/26 02:47:29 | 0.414829    0.416630    0.930743    0.835400    0.802951    0.333162    0.340206    0.353666    0.333333    0.930743    0.835400    0.557659    0.576349    3200        17.117117   0.428402    0.199876    116.891288 
[37m[36mINFO[0m[0m 02/26 02:50:01 | 0.417808    0.437640    0.957489    0.827508    0.753099    0.348095    0.391753    0.337629    0.331042    0.957489    0.827508    0.567699    0.590126    3400        18.186937   0.475749    0.189446    114.520478 
[37m[36mINFO[0m[0m 02/26 02:52:35 | 0.448439    0.450033    0.965372    0.839910    0.664352    0.384655    0.387629    0.355956    0.344788    0.965372    0.839910    0.604705    0.617681    3600        19.256757   0.434129    0.207812    112.083215 
[37m[36mINFO[0m[0m 02/26 02:55:14 | 0.397284    0.417225    0.941441    0.803833    1.008869    0.332132    0.354639    0.335052    0.341352    0.941441    0.803833    0.524670    0.555683    3800        20.326577   0.428576    0.186154    122.279164 
[37m[36mINFO[0m[0m 02/26 02:57:45 | 0.450984    0.446435    0.977477    0.855693    0.753222    0.375386    0.371134    0.367125    0.361970    0.977477    0.855693    0.610442    0.606200    4000        21.396396   0.375962    0.192360    111.667183 
[37m[36mINFO[0m[0m 02/26 03:00:19 | 0.433994    0.439395    0.966779    0.859076    0.681090    0.364573    0.385567    0.364548    0.344788    0.966779    0.859076    0.572863    0.587830    4200        22.466216   0.369818    0.197475    115.197338 
[37m[36mINFO[0m[0m 02/26 03:02:50 | 0.440515    0.452087    0.977196    0.866967    0.643597    0.353759    0.373196    0.382589    0.374570    0.977196    0.866967    0.585198    0.608496    4400        23.536036   0.419570    0.184821    114.075873 
[37m[36mINFO[0m[0m 02/26 03:05:29 | 0.427152    0.417548    0.972410    0.855693    0.731487    0.346035    0.346392    0.353952    0.327606    0.972410    0.855693    0.581469    0.578645    4600        24.605856   0.348757    0.196691    118.890615 
[37m[36mINFO[0m[0m 02/26 03:08:02 | 0.436884    0.432146    0.957770    0.845547    0.836301    0.364058    0.364948    0.362543    0.336770    0.957770    0.845547    0.584050    0.594719    4800        25.675676   0.332973    0.175264    118.254179 
[37m[36mINFO[0m[0m 02/26 03:10:27 | 0.413930    0.414648    0.969032    0.863585    0.690573    0.323893    0.311340    0.367698    0.350515    0.969032    0.863585    0.550201    0.582090    5000        26.745495   0.302118    0.192645    106.718195 
[37m[36mINFO[0m[0m 02/26 03:10:27 | Cumulative gradient change saved at train_output/OfficeHome/RSC/[0, 1, 3]/250226_02-05-44_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/26 03:10:29 | ---
[37m[36mINFO[0m[0m 02/26 03:10:29 | test-domain validation(oracle) = 46.126%
[37m[36mINFO[0m[0m 02/26 03:10:29 | training-domain validation(iid) = 43.847%
[37m[36mINFO[0m[0m 02/26 03:10:29 | last = 41.393%
[37m[36mINFO[0m[0m 02/26 03:10:29 | last (inD) = 86.359%
[37m[36mINFO[0m[0m 02/26 03:10:29 | training-domain validation (iid, inD) = 86.697%
[37m[36mINFO[0m[0m 02/26 03:10:29 | === Summary ===
[37m[36mINFO[0m[0m 02/26 03:10:29 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 6
[37m[36mINFO[0m[0m 02/26 03:10:29 | Unique name: 250226_02-05-44_resnet50_GENIE
[37m[36mINFO[0m[0m 02/26 03:10:29 | Out path: train_output/OfficeHome/RSC/[0, 1, 3]/250226_02-05-44_resnet50_GENIE
[37m[36mINFO[0m[0m 02/26 03:10:29 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/26 03:10:29 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 01/29 11:58:31 | Command :: /jsm0707/Large-scale/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm RSC --test_envs 0 1 3 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_adam.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_adam
	out_dir: train_output/OfficeHome/RSC/[0, 1, 3]/250129_11-58-31_resnet50_adam
	out_root: train_output/OfficeHome/RSC/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 0
	unique_name: 250129_11-58-31_resnet50_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	rsc_f_drop_factor: 0.3333333333333333
	rsc_b_drop_factor: 0.3333333333333333
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 01/29 11:58:31 | n_steps = 5001
[37m[36mINFO[0m[0m 01/29 11:58:31 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/29 11:58:31 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/29 11:58:31 | 
[37m[36mINFO[0m[0m 01/29 11:58:31 | Testenv name escaping te_A_C_R -> te_A_C_R
[37m[36mINFO[0m[0m 01/29 11:58:31 | Test envs = [0, 1, 3], name = te_A_C_R
[37m[36mINFO[0m[0m 01/29 11:58:31 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 01/29 11:58:31 | Batch sizes for each domain: [0, 0, 32, 0] (total=32)
[37m[36mINFO[0m[0m 01/29 11:58:31 | steps-per-epoch for each domain: 111.00 -> min = 111.00
[37m[36mINFO[0m[0m 01/29 11:58:33 | # of params = 23641217
[37m[36mINFO[0m[0m 01/29 12:00:45 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/29 12:00:45 | 0.020143    0.019939    0.011824    0.018038    4.200978    0.023172    0.028866    0.020905    0.020619    0.011824    0.018038    0.016351    0.010333    0           0.000000    5.881649    1.421339    130.985199 
[37m[36mINFO[0m[0m 01/29 12:03:41 | 0.025184    0.021551    0.022241    0.022548    4.174067    0.028836    0.026804    0.024341    0.017182    0.022241    0.022548    0.022375    0.020666    200         1.801802    4.196326    0.202875    134.805663 
[37m[36mINFO[0m[0m 01/29 12:06:43 | 0.025280    0.021551    0.022241    0.021421    4.173516    0.028836    0.026804    0.024628    0.017182    0.022241    0.021421    0.022375    0.020666    400         3.603604    4.173352    0.198801    142.466988 
[37m[36mINFO[0m[0m 01/29 12:09:34 | 0.024993    0.021551    0.022241    0.023675    4.172919    0.028836    0.026804    0.023769    0.017182    0.022241    0.023675    0.022375    0.020666    600         5.405405    4.172625    0.221301    126.853680 
[37m[36mINFO[0m[0m 01/29 12:12:27 | 0.025452    0.024223    0.021115    0.023675    4.172336    0.026777    0.026804    0.027205    0.026346    0.021115    0.023675    0.022375    0.019518    800         7.207207    4.171826    0.217169    128.415157 
[37m[36mINFO[0m[0m 01/29 12:15:17 | 0.013598    0.009938    0.022523    0.020293    4.171748    0.009269    0.000000    0.017755    0.016037    0.022523    0.020293    0.013769    0.013777    1000        9.009009    4.170977    0.213506    126.784304 
[37m[36mINFO[0m[0m 01/29 12:18:08 | 0.013598    0.009938    0.022523    0.020293    4.171171    0.009269    0.000000    0.017755    0.016037    0.022523    0.020293    0.013769    0.013777    1200        10.810811   4.170522    0.229449    125.495907 
[37m[36mINFO[0m[0m 01/29 12:21:06 | 0.013598    0.009938    0.022523    0.020293    4.170569    0.009269    0.000000    0.017755    0.016037    0.022523    0.020293    0.013769    0.013777    1400        12.612613   4.169523    0.231130    132.216261 
[37m[36mINFO[0m[0m 01/29 12:24:02 | 0.013598    0.009938    0.022523    0.020293    4.170085    0.009269    0.000000    0.017755    0.016037    0.022523    0.020293    0.013769    0.013777    1600        14.414414   4.168776    0.225494    130.754214 
[37m[36mINFO[0m[0m 01/29 12:27:03 | 0.013598    0.009938    0.022523    0.020293    4.169627    0.009269    0.000000    0.017755    0.016037    0.022523    0.020293    0.013769    0.013777    1800        16.216216   4.169212    0.239376    132.654219 
[37m[36mINFO[0m[0m 01/29 12:29:58 | 0.013789    0.009938    0.022523    0.020293    4.168949    0.009269    0.000000    0.018041    0.016037    0.022523    0.020293    0.014056    0.013777    2000        18.018018   4.168025    0.213956    132.320352 
[37m[36mINFO[0m[0m 01/29 12:32:50 | 0.013598    0.009938    0.022523    0.020293    4.168455    0.009269    0.000000    0.017755    0.016037    0.022523    0.020293    0.013769    0.013777    2200        19.819820   4.167527    0.216076    128.988751 
[37m[36mINFO[0m[0m 01/29 12:35:50 | 0.013598    0.009938    0.022523    0.019166    4.168330    0.009269    0.000000    0.017755    0.016037    0.022523    0.019166    0.013769    0.013777    2400        21.621622   4.166911    0.239646    132.061594 
[37m[36mINFO[0m[0m 01/29 12:38:51 | 0.013598    0.009938    0.022241    0.019166    4.167891    0.009269    0.000000    0.017755    0.016037    0.022241    0.019166    0.013769    0.013777    2600        23.423423   4.166028    0.238078    133.321220 
[37m[36mINFO[0m[0m 01/29 12:41:45 | 0.013598    0.009938    0.022241    0.019166    4.167390    0.009269    0.000000    0.017755    0.016037    0.022241    0.019166    0.013769    0.013777    2800        25.225225   4.165989    0.181350    138.089106 
[37m[36mINFO[0m[0m 01/29 12:44:32 | 0.013598    0.009938    0.022241    0.019166    4.166941    0.009269    0.000000    0.017755    0.016037    0.022241    0.019166    0.013769    0.013777    3000        27.027027   4.164875    0.216503    122.955678 
[37m[36mINFO[0m[0m 01/29 12:47:34 | 0.013598    0.009938    0.022241    0.019166    4.166469    0.009269    0.000000    0.017755    0.016037    0.022241    0.019166    0.013769    0.013777    3200        28.828829   4.164328    0.273200    127.861946 
[37m[36mINFO[0m[0m 01/29 12:50:28 | 0.013598    0.009938    0.022241    0.019166    4.166045    0.009269    0.000000    0.017755    0.016037    0.022241    0.019166    0.013769    0.013777    3400        30.630631   4.163593    0.180945    137.411191 
[37m[36mINFO[0m[0m 01/29 12:53:24 | 0.013598    0.009938    0.022241    0.019166    4.165610    0.009269    0.000000    0.017755    0.016037    0.022241    0.019166    0.013769    0.013777    3600        32.432432   4.163683    0.210941    134.282450 
[37m[36mINFO[0m[0m 01/29 12:56:25 | 0.013598    0.009938    0.022241    0.019166    4.165170    0.009269    0.000000    0.017755    0.016037    0.022241    0.019166    0.013769    0.013777    3800        34.234234   4.162600    0.222966    136.150994 
[37m[36mINFO[0m[0m 01/29 12:59:18 | 0.013598    0.009938    0.022241    0.019166    4.164784    0.009269    0.000000    0.017755    0.016037    0.022241    0.019166    0.013769    0.013777    4000        36.036036   4.162260    0.212061    130.732854 
[37m[36mINFO[0m[0m 01/29 13:02:06 | 0.013598    0.009938    0.022523    0.020293    4.162741    0.009269    0.000000    0.017755    0.016037    0.022523    0.020293    0.013769    0.013777    4200        37.837838   4.161827    0.223775    122.860711 
[37m[36mINFO[0m[0m 01/29 13:05:04 | 0.013598    0.009938    0.022241    0.019166    4.163990    0.009269    0.000000    0.017755    0.016037    0.022241    0.019166    0.013769    0.013777    4400        39.639640   4.161460    0.228634    132.364207 
[37m[36mINFO[0m[0m 01/29 13:07:51 | 0.013598    0.009938    0.022241    0.019166    4.163575    0.009269    0.000000    0.017755    0.016037    0.022241    0.019166    0.013769    0.013777    4600        41.441441   4.160499    0.206283    126.022579 
[37m[36mINFO[0m[0m 01/29 13:10:43 | 0.013598    0.009938    0.022241    0.019166    4.163139    0.009269    0.000000    0.017755    0.016037    0.022241    0.019166    0.013769    0.013777    4800        43.243243   4.160099    0.225308    127.010915 
[37m[36mINFO[0m[0m 01/29 13:13:40 | 0.013598    0.009938    0.022241    0.019166    4.162786    0.009269    0.000000    0.017755    0.016037    0.022241    0.019166    0.013769    0.013777    5000        45.045045   4.159452    0.237583    129.439704 
[37m[36mINFO[0m[0m 01/29 13:13:40 | Cumulative gradient change saved at train_output/OfficeHome/RSC/[0, 1, 3]/250129_11-58-31_resnet50_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/29 13:13:42 | ---
[37m[36mINFO[0m[0m 01/29 13:13:42 | test-domain validation(oracle) = 2.545%
[37m[36mINFO[0m[0m 01/29 13:13:42 | training-domain validation(iid) = 2.499%
[37m[36mINFO[0m[0m 01/29 13:13:42 | last = 1.360%
[37m[36mINFO[0m[0m 01/29 13:13:42 | last (inD) = 1.917%
[37m[36mINFO[0m[0m 01/29 13:13:42 | training-domain validation (iid, inD) = 2.368%
[37m[36mINFO[0m[0m 01/29 13:13:42 | === Summary ===
[37m[36mINFO[0m[0m 01/29 13:13:42 | Command: /jsm0707/Large-scale/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm RSC --test_envs 0 1 3 --dataset OfficeHome
[37m[36mINFO[0m[0m 01/29 13:13:42 | Unique name: 250129_11-58-31_resnet50_adam
[37m[36mINFO[0m[0m 01/29 13:13:42 | Out path: train_output/OfficeHome/RSC/[0, 1, 3]/250129_11-58-31_resnet50_adam
[37m[36mINFO[0m[0m 01/29 13:13:42 | Algorithm: RSC
[37m[36mINFO[0m[0m 01/29 13:13:42 | Dataset: OfficeHome

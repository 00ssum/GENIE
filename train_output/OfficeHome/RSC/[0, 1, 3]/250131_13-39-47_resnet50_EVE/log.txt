[37m[36mINFO[0m[0m 01/31 13:39:47 | Command :: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm RSC --test_envs 0 1 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 4
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 4
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/OfficeHome/RSC/[0, 1, 3]/250131_13-39-47_resnet50_EVE
	out_root: train_output/OfficeHome/RSC/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 0
	unique_name: 250131_13-39-47_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: GENIE
	freeze_bn: False
	pretrained: True
	lr: 2.0793009436922532e-05
	batch_size: 30
	weight_decay: 0.0007980067844361917
	rsc_f_drop_factor: 0.00568084739259922
	rsc_b_drop_factor: 0.21660562421584156
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 01/31 13:39:47 | n_steps = 5001
[37m[36mINFO[0m[0m 01/31 13:39:47 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/31 13:39:47 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/31 13:39:47 | 
[37m[36mINFO[0m[0m 01/31 13:39:47 | Testenv name escaping te_A_C_R -> te_A_C_R
[37m[36mINFO[0m[0m 01/31 13:39:47 | Test envs = [0, 1, 3], name = te_A_C_R
[37m[36mINFO[0m[0m 01/31 13:39:47 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 01/31 13:39:47 | Batch sizes for each domain: [0, 0, 30, 0] (total=30)
[37m[36mINFO[0m[0m 01/31 13:39:47 | steps-per-epoch for each domain: 118.40 -> min = 118.40
[37m[36mINFO[0m[0m 01/31 13:39:49 | # of params = 23641217
[37m[36mINFO[0m[0m 01/31 13:42:07 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/31 13:42:07 | 0.023945    0.025062    0.030405    0.024803    4.189232    0.023687    0.024742    0.025773    0.032073    0.030405    0.024803    0.022375    0.018370    0           0.000000    4.426953    1.855861    135.668915 
[37m[36mINFO[0m[0m 01/31 13:45:14 | 0.418511    0.412418    0.777309    0.714769    0.933058    0.347065    0.340206    0.346220    0.335624    0.777309    0.714769    0.562249    0.561424    200         1.689189    2.321404    0.235510    139.276856 
[37m[36mINFO[0m[0m 01/31 13:48:28 | 0.463695    0.481893    0.889921    0.818489    0.689720    0.385170    0.414433    0.396907    0.391753    0.889921    0.818489    0.609007    0.639495    400         3.378378    0.751961    0.260744    141.363163 
[37m[36mINFO[0m[0m 01/31 13:51:33 | 0.470016    0.477317    0.922579    0.837655    0.568029    0.415551    0.414433    0.364548    0.371134    0.922579    0.837655    0.629948    0.646383    600         5.067568    0.440449    0.251808    134.687319 
[37m[36mINFO[0m[0m 01/31 13:54:25 | 0.496006    0.512623    0.939752    0.856821    0.517265    0.430484    0.461856    0.405498    0.396334    0.939752    0.856821    0.652037    0.679679    800         6.756757    0.362909    0.212872    128.996458 
[37m[36mINFO[0m[0m 01/31 13:57:19 | 0.501643    0.507790    0.965653    0.875986    0.512660    0.440783    0.457732    0.397766    0.414662    0.965653    0.875986    0.666380    0.650976    1000        8.445946    0.225400    0.245910    124.234160 
[37m[36mINFO[0m[0m 01/31 14:00:04 | 0.470917    0.462403    0.952421    0.846674    0.607668    0.396498    0.362887    0.390607    0.407789    0.952421    0.846674    0.625645    0.616533    1200        10.135135   0.200838    0.224663    120.004326 
[37m[36mINFO[0m[0m 01/31 14:03:00 | 0.448645    0.445909    0.968187    0.859076    0.653488    0.358908    0.364948    0.369989    0.355097    0.968187    0.859076    0.617040    0.617681    1400        11.824324   0.162195    0.237169    128.329366 
[37m[36mINFO[0m[0m 01/31 14:05:54 | 0.483329    0.496559    0.981982    0.894025    0.514750    0.411946    0.441237    0.398912    0.404353    0.981982    0.894025    0.639128    0.644087    1600        13.513514   0.128324    0.243533    124.674069 
[37m[36mINFO[0m[0m 01/31 14:08:49 | 0.447928    0.461569    0.977477    0.877114    0.536394    0.372812    0.385567    0.364261    0.374570    0.977477    0.877114    0.606713    0.624569    1800        15.202703   0.115721    0.239320    127.493809 
[37m[36mINFO[0m[0m 01/31 14:11:51 | 0.496848    0.515913    0.986486    0.896280    0.424550    0.428424    0.445361    0.408648    0.414662    0.986486    0.896280    0.653471    0.687715    2000        16.891892   0.092608    0.233353    134.878399 
[37m[36mINFO[0m[0m 01/31 14:14:51 | 0.465450    0.467750    0.972410    0.860203    0.623862    0.381565    0.393814    0.409507    0.390607    0.972410    0.860203    0.605278    0.618829    2200        18.581081   0.077944    0.238380    131.843296 
[37m[36mINFO[0m[0m 01/31 14:17:49 | 0.481035    0.502142    0.982545    0.887260    0.586542    0.401648    0.435052    0.412944    0.415808    0.982545    0.887260    0.628514    0.655568    2400        20.270270   0.066135    0.204953    137.198673 
[37m[36mINFO[0m[0m 01/31 14:20:42 | 0.487630    0.494895    0.992680    0.904171    0.521657    0.406797    0.414433    0.409221    0.405498    0.992680    0.904171    0.646873    0.664753    2600        21.959459   0.051329    0.214917    129.886813 
[37m[36mINFO[0m[0m 01/31 14:23:31 | 0.487355    0.502216    0.990428    0.903044    0.457999    0.408857    0.432990    0.418958    0.421535    0.990428    0.903044    0.634251    0.652124    2800        23.648649   0.064641    0.237616    121.372098 
[37m[36mINFO[0m[0m 01/31 14:26:36 | 0.492264    0.508948    0.991273    0.897407    0.512952    0.420700    0.426804    0.410939    0.432990    0.991273    0.897407    0.645152    0.667049    3000        25.337838   0.055726    0.234538    138.073538 
[37m[36mINFO[0m[0m 01/31 14:30:01 | 0.497411    0.505276    0.993243    0.896280    0.481308    0.421215    0.443299    0.405785    0.413517    0.993243    0.896280    0.665232    0.659013    3200        27.027027   0.052159    0.217302    161.706476 
[37m[36mINFO[0m[0m 01/31 14:33:33 | 0.475887    0.492360    0.994369    0.894025    0.479645    0.393924    0.430928    0.398339    0.400916    0.994369    0.894025    0.635399    0.645235    3400        28.716216   0.044294    0.263058    159.516800 
[37m[36mINFO[0m[0m 01/31 14:36:53 | 0.474481    0.490287    0.985642    0.870349    0.642083    0.416066    0.445361    0.380871    0.394044    0.985642    0.870349    0.626506    0.631458    3600        30.405405   0.057455    0.227516    154.178459 
[37m[36mINFO[0m[0m 01/31 14:40:20 | 0.472452    0.485723    0.991554    0.894025    0.511850    0.383625    0.404124    0.401775    0.398625    0.991554    0.894025    0.631956    0.654420    3800        32.094595   0.054218    0.291083    149.614664 
[37m[36mINFO[0m[0m 01/31 14:43:43 | 0.468236    0.479143    0.991554    0.894025    0.503576    0.371267    0.406186    0.404353    0.392898    0.991554    0.894025    0.629088    0.638347    4000        33.783784   0.034047    0.249847    152.140985 
[37m[36mINFO[0m[0m 01/31 14:47:09 | 0.483768    0.492901    0.995777    0.894025    0.525379    0.410402    0.416495    0.403207    0.408935    0.995777    0.894025    0.637694    0.653272    4200        35.472973   0.035692    0.276572    150.747681 
[37m[36mINFO[0m[0m 01/31 14:50:33 | 0.471778    0.493727    0.985642    0.879369    0.547113    0.404222    0.455670    0.378007    0.389462    0.985642    0.879369    0.633104    0.636051    4400        37.162162   0.035359    0.284510    147.495923 
[37m[36mINFO[0m[0m 01/31 14:53:50 | 0.493626    0.505741    0.996059    0.907554    0.455506    0.427909    0.451546    0.392039    0.397480    0.996059    0.907554    0.660929    0.668197    4600        38.851351   0.033426    0.288839    138.809380 
[37m[36mINFO[0m[0m 01/31 14:57:25 | 0.475352    0.481366    0.992680    0.888388    0.553567    0.390319    0.408247    0.404066    0.387171    0.992680    0.888388    0.631670    0.648680    4800        40.540541   0.020595    0.330293    149.402153 
[37m[36mINFO[0m[0m 01/31 15:00:53 | 0.488026    0.499854    0.994932    0.885006    0.558806    0.416581    0.424742    0.404639    0.415808    0.994932    0.885006    0.642857    0.659013    5000        42.229730   0.031229    0.244764    158.464388 
[37m[36mINFO[0m[0m 01/31 15:00:53 | Cumulative gradient change saved at train_output/OfficeHome/RSC/[0, 1, 3]/250131_13-39-47_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/31 15:00:54 | ---
[37m[36mINFO[0m[0m 01/31 15:00:54 | test-domain validation(oracle) = 49.685%
[37m[36mINFO[0m[0m 01/31 15:00:54 | training-domain validation(iid) = 49.363%
[37m[36mINFO[0m[0m 01/31 15:00:54 | last = 48.803%
[37m[36mINFO[0m[0m 01/31 15:00:54 | last (inD) = 88.501%
[37m[36mINFO[0m[0m 01/31 15:00:54 | training-domain validation (iid, inD) = 90.755%
[37m[36mINFO[0m[0m 01/31 15:00:54 | === Summary ===
[37m[36mINFO[0m[0m 01/31 15:00:54 | Command: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm RSC --test_envs 0 1 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 4
[37m[36mINFO[0m[0m 01/31 15:00:54 | Unique name: 250131_13-39-47_resnet50_EVE
[37m[36mINFO[0m[0m 01/31 15:00:54 | Out path: train_output/OfficeHome/RSC/[0, 1, 3]/250131_13-39-47_resnet50_EVE
[37m[36mINFO[0m[0m 01/31 15:00:54 | Algorithm: RSC
[37m[36mINFO[0m[0m 01/31 15:00:54 | Dataset: OfficeHome

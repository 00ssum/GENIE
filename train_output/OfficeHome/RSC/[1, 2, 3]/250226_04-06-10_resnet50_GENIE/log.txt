[37m[36mINFO[0m[0m 02/26 04:06:10 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 1 2 3 --dataset OfficeHome --trial_seed 2 --hparams_seed 12
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 12
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/RSC/[1, 2, 3]/250226_04-06-10_resnet50_GENIE
	out_root: train_output/OfficeHome/RSC/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 2
	unique_name: 250226_04-06-10_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5.346798771850428e-05
	batch_size: 44
	weight_decay: 1.8352299015720086e-05
	rsc_f_drop_factor: 0.3799895564860098
	rsc_b_drop_factor: 0.03414045373033975
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/26 04:06:10 | n_steps = 5001
[37m[36mINFO[0m[0m 02/26 04:06:10 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/26 04:06:10 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/26 04:06:10 | 
[37m[36mINFO[0m[0m 02/26 04:06:10 | Testenv name escaping te_C_P_R -> te_C_P_R
[37m[36mINFO[0m[0m 02/26 04:06:10 | Test envs = [1, 2, 3], name = te_C_P_R
[37m[36mINFO[0m[0m 02/26 04:06:10 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 02/26 04:06:10 | Batch sizes for each domain: [44, 0, 0, 0] (total=44)
[37m[36mINFO[0m[0m 02/26 04:06:10 | steps-per-epoch for each domain: 44.14 -> min = 44.14
[37m[36mINFO[0m[0m 02/26 04:06:12 | # of params = 23641217
[37m[36mINFO[0m[0m 02/26 04:07:58 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/26 04:07:58 | 0.021649    0.017496    0.030381    0.032990    4.174607    0.030381    0.032990    0.020619    0.014891    0.022241    0.015784    0.022088    0.021814    0           0.000000    4.483046    1.139851    105.097517 
[37m[36mINFO[0m[0m 02/26 04:10:48 | 0.529166    0.526009    0.796087    0.647423    1.218771    0.796087    0.647423    0.423826    0.413517    0.552083    0.544532    0.611589    0.619977    200         4.531411    2.562791    0.329012    104.620940 
[37m[36mINFO[0m[0m 02/26 04:13:38 | 0.577131    0.569979    0.956231    0.734021    0.964947    0.956231    0.734021    0.458763    0.484536    0.585023    0.542277    0.687608    0.683123    400         9.062822    0.712654    0.333540    102.699894 
[37m[36mINFO[0m[0m 02/26 04:16:28 | 0.560684    0.559965    0.978373    0.715464    0.976446    0.978373    0.715464    0.440149    0.450172    0.586712    0.556933    0.655192    0.672790    600         13.594233   0.425025    0.334452    103.596577 
[37m[36mINFO[0m[0m 02/26 04:19:21 | 0.578380    0.583167    0.988671    0.734021    1.022093    0.988671    0.734021    0.463918    0.483391    0.598818    0.576099    0.672404    0.690011    800         18.125644   0.333612    0.337831    105.141350 
[37m[36mINFO[0m[0m 02/26 04:22:14 | 0.579783    0.574008    0.988157    0.742268    1.007022    0.988157    0.742268    0.453608    0.458190    0.604730    0.574972    0.681010    0.688863    1000        22.657055   0.288096    0.335759    106.371907 
[37m[36mINFO[0m[0m 02/26 04:25:05 | 0.572285    0.576716    0.994336    0.762887    0.933728    0.994336    0.762887    0.454181    0.483391    0.595721    0.567080    0.666954    0.679679    1200        27.188465   0.279328    0.328236    104.752522 
[37m[36mINFO[0m[0m 02/26 04:27:59 | 0.590841    0.590032    0.995881    0.748454    0.948447    0.995881    0.748454    0.474227    0.505155    0.608108    0.577227    0.690189    0.687715    1400        31.719876   0.240636    0.344535    105.508846 
[37m[36mINFO[0m[0m 02/26 04:30:50 | 0.581285    0.592236    0.994851    0.748454    1.063103    0.994851    0.748454    0.458763    0.481100    0.608671    0.595265    0.676420    0.700344    1600        36.251287   0.233826    0.346117    101.693610 
[37m[36mINFO[0m[0m 02/26 04:33:43 | 0.586104    0.588915    0.995366    0.754639    1.012634    0.995366    0.754639    0.466781    0.500573    0.601914    0.572717    0.689616    0.693456    1800        40.782698   0.226130    0.323564    108.596353 
[37m[36mINFO[0m[0m 02/26 04:36:37 | 0.577597    0.580075    0.995366    0.752577    0.939132    0.995366    0.752577    0.445017    0.469645    0.603322    0.582864    0.684452    0.687715    2000        45.314109   0.218779    0.331451    106.979172 
[37m[36mINFO[0m[0m 02/26 04:39:31 | 0.582132    0.592967    0.994851    0.758763    1.017115    0.994851    0.758763    0.453895    0.471936    0.611205    0.602029    0.681297    0.704937    2200        49.845520   0.217661    0.330090    108.463190 
[37m[36mINFO[0m[0m 02/26 04:42:21 | 0.571593    0.572480    0.995881    0.769072    0.952263    0.995881    0.769072    0.438144    0.454754    0.600788    0.574972    0.675846    0.687715    2400        54.376931   0.210723    0.335040    102.685872 
[37m[36mINFO[0m[0m 02/26 04:45:13 | 0.569302    0.564018    0.993306    0.734021    1.031606    0.993306    0.734021    0.428121    0.429553    0.601070    0.585118    0.678715    0.677382    2600        58.908342   0.214393    0.341885    103.817840 
[37m[36mINFO[0m[0m 02/26 04:48:07 | 0.584520    0.593809    0.995881    0.731959    1.053460    0.995881    0.731959    0.460767    0.489118    0.610923    0.587373    0.681870    0.704937    2800        63.439753   0.206442    0.341474    105.539374 
[37m[36mINFO[0m[0m 02/26 04:51:01 | 0.577965    0.579307    0.995881    0.746392    1.056384    0.995881    0.746392    0.452749    0.463918    0.605011    0.583991    0.676133    0.690011    3000        67.971164   0.206377    0.337512    106.928013 
[37m[36mINFO[0m[0m 02/26 04:53:56 | 0.578792    0.581218    0.995881    0.738144    1.070575    0.995881    0.738144    0.442726    0.458190    0.611205    0.585118    0.682444    0.700344    3200        72.502575   0.204509    0.333367    107.746322 
[37m[36mINFO[0m[0m 02/26 04:56:48 | 0.573330    0.578942    0.995366    0.744330    1.042338    0.995366    0.744330    0.447881    0.467354    0.597410    0.580609    0.674699    0.688863    3400        77.033986   0.202915    0.344528    103.286910 
[37m[36mINFO[0m[0m 02/26 04:59:41 | 0.586996    0.587336    0.994851    0.754639    1.039620    0.994851    0.754639    0.460195    0.482245    0.612613    0.582864    0.688181    0.696900    3600        81.565396   0.200842    0.334944    105.639184 
[37m[36mINFO[0m[0m 02/26 05:02:31 | 0.588473    0.583541    0.996395    0.750515    1.057452    0.996395    0.750515    0.460767    0.485682    0.605856    0.577227    0.698795    0.687715    3800        86.096807   0.203660    0.332585    103.970424 
[37m[36mINFO[0m[0m 02/26 05:05:28 | 0.576672    0.590012    0.995366    0.771134    1.150818    0.995366    0.771134    0.452749    0.486827    0.597691    0.582864    0.679575    0.700344    4000        90.628218   0.199921    0.351162    106.805172 
[37m[36mINFO[0m[0m 02/26 05:08:22 | 0.575574    0.578522    0.995881    0.754639    1.104328    0.995881    0.754639    0.449885    0.461627    0.605293    0.587373    0.671543    0.686567    4200        95.159629   0.202016    0.347308    103.994637 
[37m[36mINFO[0m[0m 02/26 05:11:14 | 0.576092    0.580511    0.996395    0.758763    1.114622    0.996395    0.758763    0.449026    0.471936    0.599099    0.573844    0.680149    0.695752    4400        99.691040   0.198462    0.321560    108.339390 
[37m[36mINFO[0m[0m 02/26 05:14:04 | 0.579471    0.589945    0.995366    0.750515    1.082507    0.995366    0.750515    0.447881    0.474227    0.609234    0.595265    0.681297    0.700344    4600        104.222451  0.200308    0.333249    103.491413 
[37m[36mINFO[0m[0m 02/26 05:16:57 | 0.562336    0.561839    0.994336    0.729897    1.229958    0.994336    0.729897    0.440722    0.457045    0.582489    0.562570    0.663798    0.665901    4800        108.753862  0.199735    0.342766    104.237541 
[37m[36mINFO[0m[0m 02/26 05:19:51 | 0.559212    0.561904    0.996395    0.748454    1.136445    0.996395    0.748454    0.435567    0.452463    0.577984    0.552424    0.664085    0.680827    5000        113.285273  0.200667    0.348072    104.093837 
[37m[36mINFO[0m[0m 02/26 05:19:51 | Cumulative gradient change saved at train_output/OfficeHome/RSC/[1, 2, 3]/250226_04-06-10_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/26 05:19:52 | ---
[37m[36mINFO[0m[0m 02/26 05:19:52 | test-domain validation(oracle) = 58.452%
[37m[36mINFO[0m[0m 02/26 05:19:52 | training-domain validation(iid) = 57.667%
[37m[36mINFO[0m[0m 02/26 05:19:52 | last = 55.921%
[37m[36mINFO[0m[0m 02/26 05:19:52 | last (inD) = 74.845%
[37m[36mINFO[0m[0m 02/26 05:19:52 | training-domain validation (iid, inD) = 77.113%
[37m[36mINFO[0m[0m 02/26 05:19:53 | === Summary ===
[37m[36mINFO[0m[0m 02/26 05:19:53 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 1 2 3 --dataset OfficeHome --trial_seed 2 --hparams_seed 12
[37m[36mINFO[0m[0m 02/26 05:19:53 | Unique name: 250226_04-06-10_resnet50_GENIE
[37m[36mINFO[0m[0m 02/26 05:19:53 | Out path: train_output/OfficeHome/RSC/[1, 2, 3]/250226_04-06-10_resnet50_GENIE
[37m[36mINFO[0m[0m 02/26 05:19:53 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/26 05:19:53 | Dataset: OfficeHome

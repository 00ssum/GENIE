[37m[36mINFO[0m[0m 01/31 13:57:27 | Command :: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm RSC --test_envs 1 2 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 4
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 4
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/OfficeHome/RSC/[1, 2, 3]/250131_13-57-27_resnet50_EVE
	out_root: train_output/OfficeHome/RSC/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 0
	unique_name: 250131_13-57-27_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: GENIE
	freeze_bn: False
	pretrained: True
	lr: 2.0793009436922532e-05
	batch_size: 30
	weight_decay: 0.0007980067844361917
	rsc_f_drop_factor: 0.00568084739259922
	rsc_b_drop_factor: 0.21660562421584156
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 01/31 13:57:27 | n_steps = 5001
[37m[36mINFO[0m[0m 01/31 13:57:27 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/31 13:57:27 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/31 13:57:27 | 
[37m[36mINFO[0m[0m 01/31 13:57:27 | Testenv name escaping te_C_P_R -> te_C_P_R
[37m[36mINFO[0m[0m 01/31 13:57:27 | Test envs = [1, 2, 3], name = te_C_P_R
[37m[36mINFO[0m[0m 01/31 13:57:27 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 01/31 13:57:27 | Batch sizes for each domain: [30, 0, 0, 0] (total=30)
[37m[36mINFO[0m[0m 01/31 13:57:27 | steps-per-epoch for each domain: 64.73 -> min = 64.73
[37m[36mINFO[0m[0m 01/31 13:57:29 | # of params = 23641217
[37m[36mINFO[0m[0m 01/31 13:59:28 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/31 13:59:28 | 0.024619    0.022432    0.041195    0.032990    4.188317    0.041195    0.032990    0.023769    0.020619    0.021115    0.021421    0.028973    0.025258    0           0.000000    4.383433    1.358547    117.406404 
[37m[36mINFO[0m[0m 01/31 14:02:42 | 0.453686    0.442859    0.712152    0.616495    1.416744    0.712152    0.616495    0.334192    0.342497    0.459741    0.445321    0.567126    0.540758    200         3.089598    2.777168    0.293066    135.380743 
[37m[36mINFO[0m[0m 01/31 14:05:57 | 0.524085    0.512852    0.853244    0.690722    1.293588    0.853244    0.690722    0.426403    0.408935    0.523649    0.506201    0.622203    0.623421    400         6.179197    1.037233    0.316687    131.440067 
[37m[36mINFO[0m[0m 01/31 14:09:19 | 0.550438    0.544021    0.904222    0.674227    1.351929    0.904222    0.674227    0.455899    0.434135    0.542230    0.537768    0.653184    0.660161    600         9.268795    0.632879    0.345409    132.314924 
[37m[36mINFO[0m[0m 01/31 14:12:31 | 0.543079    0.537134    0.955201    0.709278    1.362228    0.955201    0.709278    0.433849    0.441008    0.543637    0.536640    0.651750    0.633754    800         12.358393   0.384159    0.307372    129.588992 
[37m[36mINFO[0m[0m 01/31 14:15:43 | 0.538730    0.514261    0.967044    0.727835    1.484994    0.967044    0.727835    0.414662    0.406644    0.552646    0.526494    0.648881    0.609644    1000        15.447992   0.265985    0.288768    133.668575 
[37m[36mINFO[0m[0m 01/31 14:18:51 | 0.547704    0.535629    0.982492    0.738144    1.532670    0.982492    0.738144    0.440149    0.434135    0.552646    0.533258    0.650316    0.639495    1200        18.537590   0.173624    0.282828    131.470631 
[37m[36mINFO[0m[0m 01/31 14:22:05 | 0.537826    0.520143    0.990216    0.711340    1.543624    0.990216    0.711340    0.430126    0.419244    0.527872    0.501691    0.655479    0.639495    1400        21.627188   0.160226    0.294361    135.159333 
[37m[36mINFO[0m[0m 01/31 14:25:09 | 0.499079    0.482946    0.968074    0.709278    1.494934    0.968074    0.709278    0.405498    0.405498    0.487894    0.453213    0.603844    0.590126    1600        24.716787   0.097429    0.265406    130.707366 
[37m[36mINFO[0m[0m 01/31 14:28:44 | 0.552490    0.545952    0.985067    0.692784    1.708527    0.985067    0.692784    0.430699    0.457045    0.567849    0.532131    0.658921    0.648680    1800        27.806385   0.108477    0.295500    155.635592 
[37m[36mINFO[0m[0m 01/31 14:32:26 | 0.527645    0.529152    0.986612    0.711340    1.491890    0.986612    0.711340    0.418958    0.432990    0.536036    0.528749    0.627940    0.625718    2000        30.895984   0.092360    0.328166    156.860244 
[37m[36mINFO[0m[0m 01/31 14:35:53 | 0.525853    0.526938    0.989186    0.723711    1.741091    0.989186    0.723711    0.393471    0.415808    0.534347    0.517475    0.649742    0.647532    2200        33.985582   0.072308    0.327874    141.605557 
[37m[36mINFO[0m[0m 01/31 14:39:34 | 0.548997    0.530732    0.994851    0.719588    1.623680    0.994851    0.719588    0.431844    0.422680    0.560529    0.521984    0.654618    0.647532    2400        37.075180   0.060553    0.331342    154.297570 
[37m[36mINFO[0m[0m 01/31 14:43:27 | 0.566909    0.556256    0.995881    0.750515    1.283392    0.995881    0.750515    0.444731    0.449026    0.584741    0.537768    0.671256    0.681975    2600        40.164779   0.055804    0.357626    161.498661 
[37m[36mINFO[0m[0m 01/31 14:47:09 | 0.549606    0.543703    0.992791    0.731959    1.585443    0.992791    0.731959    0.444444    0.439863    0.553773    0.526494    0.650602    0.664753    2800        43.254377   0.022232    0.356559    150.830066 
[37m[36mINFO[0m[0m 01/31 14:50:58 | 0.564258    0.549443    0.995881    0.762887    1.419402    0.995881    0.762887    0.458190    0.459336    0.564189    0.524239    0.670396    0.664753    3000        46.343975   0.030688    0.354689    157.540381 
[37m[36mINFO[0m[0m 01/31 14:54:45 | 0.521883    0.506010    0.993821    0.723711    1.516391    0.993821    0.723711    0.410080    0.394044    0.525619    0.500564    0.629948    0.623421    3200        49.433574   0.039988    0.359153    155.609320 
[37m[36mINFO[0m[0m 01/31 14:58:24 | 0.560206    0.544380    0.995881    0.740206    1.539570    0.995881    0.740206    0.447022    0.438717    0.570946    0.541150    0.662651    0.653272    3400        52.523172   0.045550    0.357486    146.676769 
[37m[36mINFO[0m[0m 01/31 15:01:46 | 0.545799    0.528748    0.988671    0.688660    1.666976    0.988671    0.688660    0.436426    0.424971    0.551802    0.533258    0.649168    0.628014    3600        55.612770   0.025442    0.383826    125.207804 
[37m[36mINFO[0m[0m 01/31 15:04:58 | 0.503574    0.482861    0.984037    0.723711    1.603654    0.984037    0.723711    0.384021    0.372279    0.504786    0.471251    0.621916    0.605052    3800        58.702369   0.038552    0.322379    128.360059 
[37m[36mINFO[0m[0m 01/31 15:08:15 | 0.551504    0.533442    0.995881    0.744330    1.726731    0.995881    0.744330    0.432990    0.427262    0.557151    0.516347    0.664372    0.656716    4000        61.791967   0.020145    0.326323    131.526579 
[37m[36mINFO[0m[0m 01/31 15:11:35 | 0.550221    0.536383    0.995366    0.762887    1.498366    0.995366    0.762887    0.430985    0.422680    0.563626    0.536640    0.656053    0.649828    4200        64.881565   0.028255    0.316185    136.529253 
[37m[36mINFO[0m[0m 01/31 15:14:51 | 0.553499    0.542523    0.996395    0.734021    1.436783    0.996395    0.734021    0.444158    0.436426    0.558277    0.532131    0.658061    0.659013    4400        67.971164   0.022922    0.298831    136.411995 
[37m[36mINFO[0m[0m 01/31 15:18:00 | 0.548948    0.542169    0.995881    0.731959    1.633898    0.995881    0.731959    0.425830    0.426117    0.553773    0.528749    0.667240    0.671642    4600        71.060762   0.018977    0.317535    125.748605 
[37m[36mINFO[0m[0m 01/31 15:21:27 | 0.547433    0.533010    0.995366    0.746392    1.560607    0.995366    0.746392    0.433276    0.437572    0.550676    0.523112    0.658348    0.638347    4800        74.150360   0.017294    0.362324    134.460878 
[37m[36mINFO[0m[0m 01/31 15:24:48 | 0.533407    0.515898    0.995881    0.746392    1.570587    0.995881    0.746392    0.412085    0.402062    0.532658    0.509583    0.655479    0.636051    5000        77.239959   0.020146    0.398614    120.859267 
[37m[36mINFO[0m[0m 01/31 15:24:48 | Cumulative gradient change saved at train_output/OfficeHome/RSC/[1, 2, 3]/250131_13-57-27_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/31 15:24:49 | ---
[37m[36mINFO[0m[0m 01/31 15:24:49 | test-domain validation(oracle) = 56.691%
[37m[36mINFO[0m[0m 01/31 15:24:49 | training-domain validation(iid) = 56.426%
[37m[36mINFO[0m[0m 01/31 15:24:49 | last = 53.341%
[37m[36mINFO[0m[0m 01/31 15:24:49 | last (inD) = 74.639%
[37m[36mINFO[0m[0m 01/31 15:24:49 | training-domain validation (iid, inD) = 76.289%
[37m[36mINFO[0m[0m 01/31 15:24:49 | === Summary ===
[37m[36mINFO[0m[0m 01/31 15:24:49 | Command: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm RSC --test_envs 1 2 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 4
[37m[36mINFO[0m[0m 01/31 15:24:49 | Unique name: 250131_13-57-27_resnet50_EVE
[37m[36mINFO[0m[0m 01/31 15:24:49 | Out path: train_output/OfficeHome/RSC/[1, 2, 3]/250131_13-57-27_resnet50_EVE
[37m[36mINFO[0m[0m 01/31 15:24:49 | Algorithm: RSC
[37m[36mINFO[0m[0m 01/31 15:24:49 | Dataset: OfficeHome

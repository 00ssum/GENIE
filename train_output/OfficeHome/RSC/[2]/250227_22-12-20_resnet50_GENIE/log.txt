[37m[36mINFO[0m[0m 02/27 22:12:20 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 2 --dataset OfficeHome --trial_seed 0 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/RSC/[2]/250227_22-12-20_resnet50_GENIE
	out_root: train_output/OfficeHome/RSC/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250227_22-12-20_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5.0781288859686544e-05
	batch_size: 44
	weight_decay: 0.00046410133598234803
	rsc_f_drop_factor: 0.2665134852412123
	rsc_b_drop_factor: 0.28056710878365126
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/27 22:12:20 | n_steps = 5001
[37m[36mINFO[0m[0m 02/27 22:12:20 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/27 22:12:20 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/27 22:12:20 | 
[37m[36mINFO[0m[0m 02/27 22:12:20 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 02/27 22:12:20 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 02/27 22:12:20 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 02/27 22:12:20 | Batch sizes for each domain: [44, 44, 0, 44] (total=132)
[37m[36mINFO[0m[0m 02/27 22:12:20 | steps-per-epoch for each domain: 44.14, 79.36, 79.23 -> min = 44.14
[37m[36mINFO[0m[0m 02/27 22:12:22 | # of params = 23641217
[37m[36mINFO[0m[0m 02/27 22:14:25 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/27 22:14:25 | 0.010980    0.010147    0.015525    0.013147    4.197565    0.019053    0.016495    0.009737    0.006873    0.010980    0.010147    0.017785    0.016073    0           0.000000    5.491783    1.127278    122.116471 
[37m[36mINFO[0m[0m 02/27 22:19:07 | 0.014077    0.013529    0.026419    0.029951    4.170434    0.039135    0.047423    0.022910    0.021764    0.014077    0.013529    0.017212    0.020666    200         4.531411    4.187269    0.778673    125.860115 
[37m[36mINFO[0m[0m 02/27 22:23:43 | 0.014077    0.013529    0.026419    0.029951    4.161427    0.039135    0.047423    0.022910    0.021764    0.014077    0.013529    0.017212    0.020666    400         9.062822    4.170164    0.762999    123.309696 
[37m[36mINFO[0m[0m 02/27 22:28:21 | 0.014077    0.013529    0.026419    0.029951    4.151862    0.039135    0.047423    0.022910    0.021764    0.014077    0.013529    0.017212    0.020666    600         13.594233   4.166674    0.775149    123.518362 
[37m[36mINFO[0m[0m 02/27 22:32:52 | 0.014077    0.013529    0.026419    0.029951    4.147308    0.039135    0.047423    0.022910    0.021764    0.014077    0.013529    0.017212    0.020666    800         18.125644   4.162571    0.751571    119.982045 
[37m[36mINFO[0m[0m 02/27 22:37:24 | 0.014077    0.013529    0.026419    0.029951    4.130333    0.039135    0.047423    0.022910    0.021764    0.014077    0.013529    0.017212    0.020666    1000        22.657055   4.160514    0.777894    117.259748 
[37m[36mINFO[0m[0m 02/27 22:42:11 | 0.043074    0.036077    0.040923    0.037295    4.013953    0.034501    0.035052    0.048683    0.038946    0.043074    0.036077    0.039587    0.037887    1200        27.188465   4.142282    0.792370    127.764970 
[37m[36mINFO[0m[0m 02/27 22:46:48 | 0.033502    0.028185    0.039184    0.042571    3.857066    0.045314    0.047423    0.030069    0.033219    0.033502    0.028185    0.042169    0.047072    1400        31.719876   4.068042    0.773325    122.610971 
[37m[36mINFO[0m[0m 02/27 22:51:30 | 0.034910    0.046223    0.050502    0.045692    3.792816    0.054068    0.055670    0.055556    0.048110    0.034910    0.046223    0.041882    0.033295    1600        36.251287   4.005326    0.756771    130.378557 
[37m[36mINFO[0m[0m 02/27 22:56:08 | 0.030124    0.021421    0.038493    0.042338    3.790885    0.045829    0.043299    0.032646    0.042383    0.030124    0.021421    0.037005    0.041332    1800        40.782698   3.979632    0.796196    119.276759 
[37m[36mINFO[0m[0m 02/27 23:00:51 | 0.036599    0.037204    0.055369    0.049215    3.705631    0.061792    0.053608    0.059565    0.046964    0.036599    0.037204    0.044750    0.047072    2000        45.314109   3.953841    0.786309    125.851577 
[37m[36mINFO[0m[0m 02/27 23:05:37 | 0.057432    0.051860    0.078008    0.081313    3.609866    0.077240    0.074227    0.075601    0.090493    0.057432    0.051860    0.081182    0.079219    2200        49.845520   3.895941    0.777192    130.189775 
[37m[36mINFO[0m[0m 02/27 23:10:20 | 0.064471    0.045096    0.088160    0.091706    3.492851    0.104531    0.103093    0.070447    0.083620    0.064471    0.045096    0.089501    0.088404    2400        54.376931   3.826694    0.809327    120.813659 
[37m[36mINFO[0m[0m 02/27 23:15:13 | 0.103322    0.091319    0.134554    0.112126    3.352941    0.135942    0.109278    0.121707    0.098511    0.103322    0.091319    0.146013    0.128588    2600        58.908342   3.724756    0.832766    126.657960 
[37m[36mINFO[0m[0m 02/27 23:20:00 | 0.137669    0.139797    0.161341    0.135972    3.117280    0.137487    0.125773    0.162658    0.127148    0.137669    0.139797    0.183878    0.154994    2800        63.439753   3.586861    0.795251    128.357407 
[37m[36mINFO[0m[0m 02/27 23:24:51 | 0.161881    0.164600    0.210773    0.162741    2.939048    0.202369    0.136082    0.198740    0.143184    0.161881    0.164600    0.231211    0.208955    3000        67.971164   3.422907    0.797036    131.062273 
[37m[36mINFO[0m[0m 02/27 23:29:39 | 0.212838    0.214205    0.268463    0.214323    2.767433    0.255922    0.177320    0.260023    0.209622    0.212838    0.214205    0.289443    0.256028    3200        72.502575   3.273538    0.790160    130.047231 
[37m[36mINFO[0m[0m 02/27 23:34:31 | 0.251689    0.249154    0.328375    0.262469    2.529703    0.331617    0.228866    0.311569    0.255441    0.251689    0.249154    0.341939    0.303100    3400        77.033986   3.111449    0.843007    123.797114 
[37m[36mINFO[0m[0m 02/27 23:39:10 | 0.310811    0.308906    0.422691    0.341250    2.384895    0.427394    0.340206    0.398625    0.317297    0.310811    0.308906    0.442054    0.366246    3600        81.565396   2.886584    0.787974    121.105988 
[37m[36mINFO[0m[0m 02/27 23:43:58 | 0.380912    0.384442    0.546468    0.451759    2.124439    0.539650    0.441237    0.543242    0.435281    0.380912    0.384442    0.556512    0.478760    3800        86.096807   2.632034    0.830797    121.610117 
[37m[36mINFO[0m[0m 02/27 23:48:43 | 0.479730    0.458850    0.630053    0.517104    1.970689    0.631308    0.492784    0.607961    0.510882    0.479730    0.458850    0.650889    0.547646    4000        90.628218   2.415201    0.811427    123.208636 
[37m[36mINFO[0m[0m 02/27 23:53:31 | 0.525619    0.508455    0.721146    0.567933    1.804654    0.741504    0.544330    0.689576    0.550974    0.525619    0.508455    0.732358    0.608496    4200        95.159629   2.220391    0.789202    130.412612 
[37m[36mINFO[0m[0m 02/27 23:58:18 | 0.561092    0.553551    0.790131    0.607428    1.774359    0.809475    0.591753    0.772623    0.603666    0.561092    0.553551    0.788296    0.626866    4400        99.691040   1.932863    0.795026    127.480727 
[37m[36mINFO[0m[0m 02/28 00:02:57 | 0.584178    0.579481    0.827558    0.637618    1.681285    0.848095    0.612371    0.808706    0.640321    0.584178    0.579481    0.825875    0.660161    4600        104.222451  1.827325    0.769300    124.826141 
[37m[36mINFO[0m[0m 02/28 00:07:43 | 0.617399    0.607666    0.861222    0.658717    1.911280    0.885170    0.630928    0.840779    0.655212    0.617399    0.607666    0.857717    0.690011    4800        108.753862  1.677914    0.791378    128.491552 
[37m[36mINFO[0m[0m 02/28 00:12:27 | 0.615709    0.591883    0.876330    0.668264    1.610615    0.902678    0.641237    0.845647    0.671249    0.615709    0.591883    0.880666    0.692308    5000        113.285273  1.618097    0.805648    122.405658 
[37m[36mINFO[0m[0m 02/28 00:12:27 | Cumulative gradient change saved at train_output/OfficeHome/RSC/[2]/250227_22-12-20_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/28 00:12:29 | ---
[37m[36mINFO[0m[0m 02/28 00:12:29 | test-domain validation(oracle) = 61.740%
[37m[36mINFO[0m[0m 02/28 00:12:29 | training-domain validation(iid) = 61.571%
[37m[36mINFO[0m[0m 02/28 00:12:29 | last = 61.571%
[37m[36mINFO[0m[0m 02/28 00:12:29 | last (inD) = 66.826%
[37m[36mINFO[0m[0m 02/28 00:12:29 | training-domain validation (iid, inD) = 66.826%
[37m[36mINFO[0m[0m 02/28 00:12:29 | === Summary ===
[37m[36mINFO[0m[0m 02/28 00:12:29 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 2 --dataset OfficeHome --trial_seed 0 --hparams_seed 1
[37m[36mINFO[0m[0m 02/28 00:12:29 | Unique name: 250227_22-12-20_resnet50_GENIE
[37m[36mINFO[0m[0m 02/28 00:12:29 | Out path: train_output/OfficeHome/RSC/[2]/250227_22-12-20_resnet50_GENIE
[37m[36mINFO[0m[0m 02/28 00:12:29 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/28 00:12:29 | Dataset: OfficeHome

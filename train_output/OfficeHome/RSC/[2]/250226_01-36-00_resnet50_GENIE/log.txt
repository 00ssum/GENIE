[37m[36mINFO[0m[0m 02/26 01:36:00 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 2 --dataset OfficeHome --trial_seed 0 --hparams_seed 20
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 20
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/RSC/[2]/250226_01-36-00_resnet50_GENIE
	out_root: train_output/OfficeHome/RSC/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250226_01-36-00_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.6157673767852512e-05
	batch_size: 32
	weight_decay: 1.110622050999988e-05
	rsc_f_drop_factor: 0.011558843074644498
	rsc_b_drop_factor: 0.009443205254898168
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/26 01:36:00 | n_steps = 5001
[37m[36mINFO[0m[0m 02/26 01:36:00 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/26 01:36:00 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/26 01:36:00 | 
[37m[36mINFO[0m[0m 02/26 01:36:00 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 02/26 01:36:00 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 02/26 01:36:00 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 02/26 01:36:00 | Batch sizes for each domain: [32, 32, 0, 32] (total=96)
[37m[36mINFO[0m[0m 02/26 01:36:00 | steps-per-epoch for each domain: 60.69, 109.12, 108.94 -> min = 60.69
[37m[36mINFO[0m[0m 02/26 01:36:02 | # of params = 23641217
[37m[36mINFO[0m[0m 02/26 01:38:05 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/26 01:38:05 | 0.005068    0.005637    0.016094    0.014601    4.217913    0.024202    0.018557    0.008591    0.005727    0.005068    0.005637    0.015491    0.019518    0           0.000000    4.445470    1.455157    121.882780 
[37m[36mINFO[0m[0m 02/26 01:42:14 | 0.697635    0.686584    0.747461    0.712921    1.099292    0.763646    0.725773    0.686140    0.642612    0.697635    0.686584    0.792599    0.770379    200         3.295572    2.373539    0.603543    127.597266 
[37m[36mINFO[0m[0m 02/26 01:46:16 | 0.734516    0.719278    0.834582    0.749669    0.956070    0.849640    0.744330    0.797824    0.712486    0.734516    0.719278    0.856282    0.792193    400         6.591143    0.840074    0.589175    124.224700 
[37m[36mINFO[0m[0m 02/26 01:50:16 | 0.757320    0.726043    0.889433    0.770234    0.917456    0.917611    0.767010    0.849656    0.722795    0.757320    0.726043    0.901033    0.820896    600         9.886715    0.581296    0.575519    124.860981 
[37m[36mINFO[0m[0m 02/26 01:54:12 | 0.748592    0.729425    0.908694    0.759608    0.915777    0.938723    0.734021    0.877721    0.737686    0.748592    0.729425    0.909639    0.807118    800         13.182286   0.424850    0.559395    124.743594 
[37m[36mINFO[0m[0m 02/26 01:58:13 | 0.749155    0.718151    0.930390    0.763496    1.019329    0.951081    0.762887    0.909221    0.729668    0.749155    0.718151    0.930866    0.797933    1000        16.477858   0.343427    0.583610    123.772421 
[37m[36mINFO[0m[0m 02/26 02:02:09 | 0.746059    0.733935    0.947367    0.767712    0.936920    0.967044    0.742268    0.925258    0.742268    0.746059    0.733935    0.949799    0.818599    1200        19.773429   0.274615    0.574399    120.791682 
[37m[36mINFO[0m[0m 02/26 02:06:08 | 0.738739    0.710259    0.952330    0.772519    1.056342    0.974768    0.756701    0.928694    0.746850    0.738739    0.710259    0.953528    0.814007    1400        23.069001   0.214494    0.582527    122.925867 
[37m[36mINFO[0m[0m 02/26 02:10:12 | 0.760135    0.728298    0.967112    0.782833    0.936208    0.988157    0.767010    0.943585    0.761741    0.760135    0.728298    0.969593    0.819747    1600        26.364573   0.198363    0.591268    126.186515 
[37m[36mINFO[0m[0m 02/26 02:14:26 | 0.746059    0.733935    0.963717    0.766559    1.039180    0.974253    0.742268    0.948740    0.747995    0.746059    0.733935    0.968158    0.809414    1800        29.660144   0.157286    0.610841    130.968666 
[37m[36mINFO[0m[0m 02/26 02:18:33 | 0.745777    0.727170    0.973035    0.780392    1.083290    0.985582    0.760825    0.956758    0.757159    0.745777    0.727170    0.976764    0.823192    2000        32.955716   0.140757    0.611367    124.842026 
[37m[36mINFO[0m[0m 02/26 02:22:50 | 0.754223    0.733935    0.974107    0.781229    1.037875    0.982492    0.769072    0.959908    0.754868    0.754223    0.733935    0.979920    0.819747    2200        36.251287   0.130604    0.625094    131.798995 
[37m[36mINFO[0m[0m 02/26 02:27:23 | 0.758164    0.740699    0.979087    0.780228    1.095499    0.992276    0.775258    0.963345    0.757159    0.758164    0.740699    0.981641    0.808266    2400        39.546859   0.110587    0.685284    136.791400 
[37m[36mINFO[0m[0m 02/26 02:31:44 | 0.759009    0.739572    0.980502    0.783363    1.080138    0.987642    0.773196    0.971077    0.762887    0.759009    0.739572    0.982788    0.814007    2600        42.842430   0.097199    0.651261    130.312415 
[37m[36mINFO[0m[0m 02/26 02:35:54 | 0.750282    0.733935    0.981590    0.777482    1.200745    0.991761    0.767010    0.967640    0.752577    0.750282    0.733935    0.985370    0.812859    2800        46.138002   0.087369    0.588734    131.968404 
[37m[36mINFO[0m[0m 02/26 02:40:12 | 0.759854    0.754228    0.985180    0.779003    1.113505    0.992791    0.756701    0.975945    0.775487    0.759854    0.754228    0.986804    0.804822    3000        49.433574   0.090937    0.623526    133.199055 
[37m[36mINFO[0m[0m 02/26 02:44:27 | 0.757320    0.764374    0.981838    0.781001    1.091545    0.992791    0.754639    0.967927    0.767468    0.757320    0.764374    0.984796    0.820896    3200        52.729145   0.079293    0.585966    138.517114 
[37m[36mINFO[0m[0m 02/26 02:48:53 | 0.750000    0.730552    0.984587    0.787482    1.194349    0.993306    0.785567    0.974800    0.768614    0.750000    0.730552    0.985657    0.808266    3400        56.024717   0.071444    0.639565    137.909162 
[37m[36mINFO[0m[0m 02/26 02:53:22 | 0.764358    0.749718    0.983175    0.788785    1.115764    0.990216    0.781443    0.974513    0.770905    0.764358    0.749718    0.984796    0.814007    3600        59.320288   0.069826    0.668558    135.120284 
[37m[36mINFO[0m[0m 02/26 02:57:35 | 0.750000    0.724915    0.984130    0.776338    1.200304    0.992791    0.756701    0.972222    0.758305    0.750000    0.724915    0.987378    0.814007    3800        62.615860   0.070380    0.609128    131.472120 
[37m[36mINFO[0m[0m 02/26 03:02:04 | 0.752815    0.747463    0.987875    0.786190    1.153231    0.994851    0.769072    0.976231    0.774341    0.752815    0.747463    0.992542    0.815155    4000        65.911432   0.064532    0.650450    138.650444 
[37m[36mINFO[0m[0m 02/26 03:06:30 | 0.746622    0.722661    0.987854    0.784426    1.170071    0.995366    0.775258    0.977090    0.772050    0.746622    0.722661    0.991107    0.805970    4200        69.207003   0.056334    0.653595    135.350977 
[37m[36mINFO[0m[0m 02/26 03:10:37 | 0.765203    0.738444    0.989613    0.795355    1.020840    0.994336    0.800000    0.981100    0.768614    0.765203    0.738444    0.993402    0.817451    4400        72.502575   0.062382    0.613719    124.128568 
[37m[36mINFO[0m[0m 02/26 03:14:31 | 0.754223    0.739572    0.986117    0.785888    1.263094    0.990731    0.767010    0.978809    0.769759    0.754223    0.739572    0.988812    0.820896    4600        75.798146   0.054200    0.551624    124.173567 
[37m[36mINFO[0m[0m 02/26 03:18:33 | 0.755631    0.737317    0.988926    0.791769    1.107773    0.992276    0.773196    0.980813    0.780069    0.755631    0.737317    0.993689    0.822044    4800        79.093718   0.054846    0.574072    126.626201 
[37m[36mINFO[0m[0m 02/26 03:22:30 | 0.753660    0.739572    0.988849    0.783289    1.153773    0.994336    0.764948    0.979381    0.768614    0.753660    0.739572    0.992828    0.816303    5000        82.389289   0.061177    0.584866    120.433593 
[37m[36mINFO[0m[0m 02/26 03:22:30 | Cumulative gradient change saved at train_output/OfficeHome/RSC/[2]/250226_01-36-00_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/26 03:22:32 | ---
[37m[36mINFO[0m[0m 02/26 03:22:32 | test-domain validation(oracle) = 75.732%
[37m[36mINFO[0m[0m 02/26 03:22:32 | training-domain validation(iid) = 76.520%
[37m[36mINFO[0m[0m 02/26 03:22:32 | last = 75.366%
[37m[36mINFO[0m[0m 02/26 03:22:32 | last (inD) = 78.329%
[37m[36mINFO[0m[0m 02/26 03:22:32 | training-domain validation (iid, inD) = 79.536%
[37m[36mINFO[0m[0m 02/26 03:22:32 | === Summary ===
[37m[36mINFO[0m[0m 02/26 03:22:32 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 2 --dataset OfficeHome --trial_seed 0 --hparams_seed 20
[37m[36mINFO[0m[0m 02/26 03:22:32 | Unique name: 250226_01-36-00_resnet50_GENIE
[37m[36mINFO[0m[0m 02/26 03:22:32 | Out path: train_output/OfficeHome/RSC/[2]/250226_01-36-00_resnet50_GENIE
[37m[36mINFO[0m[0m 02/26 03:22:32 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/26 03:22:32 | Dataset: OfficeHome

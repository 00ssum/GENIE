[37m[36mINFO[0m[0m 02/15 14:39:44 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 2 --dataset OfficeHome --trial_seed 2 --hparams_seed 12
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 12
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/RSC/[2]/250215_14-39-44_resnet50_GENIE
	out_root: train_output/OfficeHome/RSC/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 2
	unique_name: 250215_14-39-44_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5.346798771850428e-05
	batch_size: 44
	weight_decay: 1.8352299015720086e-05
	rsc_f_drop_factor: 0.3799895564860098
	rsc_b_drop_factor: 0.03414045373033975
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/15 14:39:44 | n_steps = 5001
[37m[36mINFO[0m[0m 02/15 14:39:44 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/15 14:39:44 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/15 14:39:44 | 
[37m[36mINFO[0m[0m 02/15 14:39:44 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 02/15 14:39:44 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 02/15 14:39:44 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 02/15 14:39:44 | Batch sizes for each domain: [44, 44, 0, 44] (total=132)
[37m[36mINFO[0m[0m 02/15 14:39:44 | steps-per-epoch for each domain: 44.14, 79.36, 79.23 -> min = 44.14
[37m[36mINFO[0m[0m 02/15 14:39:47 | # of params = 23641217
[37m[36mINFO[0m[0m 02/15 14:42:29 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/15 14:42:29 | 0.009572    0.012401    0.017718    0.024001    4.205908    0.024202    0.022680    0.011741    0.019473    0.009572    0.012401    0.017212    0.029851    0           0.000000    4.441978    2.759235    158.838685 
[37m[36mINFO[0m[0m 02/15 14:48:12 | 0.716216    0.696731    0.767774    0.730956    0.982235    0.792482    0.723711    0.702176    0.682703    0.716216    0.696731    0.808663    0.786452    200         4.531411    2.585041    1.028253    137.260759 
[37m[36mINFO[0m[0m 02/15 14:53:44 | 0.731137    0.730552    0.860813    0.754174    0.882609    0.881050    0.736082    0.826174    0.735395    0.731137    0.730552    0.875215    0.791045    400         9.062822    0.877080    0.961706    139.782996 
[37m[36mINFO[0m[0m 02/15 14:58:51 | 0.745214    0.739572    0.917329    0.773056    0.829883    0.945417    0.752577    0.882875    0.749141    0.745214    0.739572    0.923695    0.817451    600         13.594233   0.608164    0.861798    134.865837 
[37m[36mINFO[0m[0m 02/15 15:04:05 | 0.752534    0.735062    0.944937    0.765724    0.909839    0.973223    0.734021    0.918099    0.747995    0.752534    0.735062    0.943488    0.815155    800         18.125644   0.471592    0.912965    130.745666 
[37m[36mINFO[0m[0m 02/15 15:09:25 | 0.761824    0.750846    0.951436    0.765723    0.904994    0.970649    0.734021    0.927262    0.749141    0.761824    0.750846    0.956397    0.814007    1000        22.657055   0.405591    0.914936    136.986574 
[37m[36mINFO[0m[0m 02/15 15:14:26 | 0.763795    0.768884    0.965222    0.783527    0.842210    0.982492    0.758763    0.946735    0.762887    0.763795    0.768884    0.966437    0.828932    1200        27.188465   0.360759    0.844180    132.348232 
[37m[36mINFO[0m[0m 02/15 15:19:33 | 0.765203    0.758737    0.975575    0.784288    0.836075    0.986612    0.748454    0.960481    0.778923    0.765203    0.758737    0.979633    0.825488    1400        31.719876   0.312954    0.845349    137.880757 
[37m[36mINFO[0m[0m 02/15 15:24:53 | 0.756475    0.751973    0.979432    0.794828    0.895893    0.990731    0.773196    0.964204    0.784651    0.756475    0.751973    0.983362    0.826636    1600        36.251287   0.289823    0.891887    142.324273 
[37m[36mINFO[0m[0m 02/15 15:30:15 | 0.765203    0.750846    0.981134    0.797887    0.864570    0.988671    0.783505    0.967640    0.777778    0.765203    0.750846    0.987091    0.832377    1800        40.782698   0.274965    0.915307    138.886840 
[37m[36mINFO[0m[0m 02/15 15:35:28 | 0.764640    0.762120    0.983465    0.789716    0.908919    0.990216    0.767010    0.970218    0.768614    0.764640    0.762120    0.989960    0.833525    2000        45.314109   0.262051    0.868942    138.635410 
[37m[36mINFO[0m[0m 02/15 15:40:47 | 0.766047    0.755355    0.983713    0.799947    0.863081    0.991246    0.789691    0.969645    0.780069    0.766047    0.755355    0.990247    0.830080    2200        49.845520   0.254281    0.895647    140.556760 
[37m[36mINFO[0m[0m 02/15 15:46:33 | 0.766047    0.750846    0.986576    0.795442    0.925701    0.993821    0.777320    0.974800    0.777778    0.766047    0.750846    0.991107    0.831228    2400        54.376931   0.241584    0.910380    163.196703 
[37m[36mINFO[0m[0m 02/15 15:52:20 | 0.766329    0.759865    0.988562    0.789328    0.936180    0.994336    0.777320    0.978522    0.765178    0.766329    0.759865    0.992828    0.825488    2600        58.908342   0.230053    0.933699    160.403792 
[37m[36mINFO[0m[0m 02/15 15:57:54 | 0.759572    0.750846    0.987092    0.795139    0.946440    0.992791    0.775258    0.977377    0.775487    0.759572    0.750846    0.991107    0.834673    2800        63.439753   0.224777    0.953270    143.808379 
[37m[36mINFO[0m[0m 02/15 16:04:10 | 0.767173    0.760992    0.987856    0.797964    0.945993    0.992791    0.791753    0.978522    0.768614    0.767173    0.760992    0.992255    0.833525    3000        67.971164   0.223136    1.047173    165.707934 
[37m[36mINFO[0m[0m 02/15 16:09:47 | 0.758727    0.742954    0.989326    0.788645    0.947662    0.994336    0.764948    0.980813    0.770905    0.758727    0.742954    0.992828    0.830080    3200        72.502575   0.213254    0.932093    151.323193 
[37m[36mINFO[0m[0m 02/15 16:14:52 | 0.761824    0.755355    0.989576    0.788640    0.970508    0.992791    0.764948    0.980527    0.776632    0.761824    0.755355    0.995410    0.824340    3400        77.033986   0.210045    0.853335    133.544826 
[37m[36mINFO[0m[0m 02/15 16:19:52 | 0.763232    0.764374    0.990071    0.798188    0.970519    0.994851    0.785567    0.981959    0.781214    0.763232    0.764374    0.993402    0.827784    3600        81.565396   0.208120    0.877913    125.205378 
[37m[36mINFO[0m[0m 02/15 16:24:58 | 0.766329    0.757610    0.991255    0.788870    0.990956    0.996395    0.769072    0.982245    0.772050    0.766329    0.757610    0.995123    0.825488    3800        86.096807   0.204714    0.902536    125.442222 
[37m[36mINFO[0m[0m 02/15 16:29:59 | 0.760698    0.745209    0.990414    0.796131    0.994761    0.995881    0.779381    0.981959    0.775487    0.760698    0.745209    0.993402    0.833525    4000        90.628218   0.201440    0.863102    128.251793 
[37m[36mINFO[0m[0m 02/15 16:35:08 | 0.759854    0.765502    0.990835    0.797423    1.011002    0.994851    0.785567    0.983391    0.781214    0.759854    0.765502    0.994263    0.825488    4200        95.159629   0.196760    0.822435    144.534885 
[37m[36mINFO[0m[0m 02/15 16:40:39 | 0.766610    0.760992    0.990167    0.787255    1.038770    0.994851    0.771134    0.980527    0.780069    0.766610    0.760992    0.995123    0.810563    4400        99.691040   0.197104    0.906566    149.524576 
[37m[36mINFO[0m[0m 02/15 16:46:29 | 0.762106    0.766629    0.991676    0.800412    1.010724    0.995366    0.787629    0.983391    0.774341    0.762106    0.766629    0.996271    0.839265    4600        104.222451  0.196992    1.006423    148.580978 
[37m[36mINFO[0m[0m 02/15 16:52:16 | 0.765484    0.756483    0.991484    0.799182    0.973813    0.995366    0.779381    0.983391    0.789233    0.765484    0.756483    0.995697    0.828932    4800        108.753862  0.192775    0.960418    155.302128 
[37m[36mINFO[0m[0m 02/15 16:57:47 | 0.760698    0.739572    0.992229    0.800939    1.013645    0.995881    0.793814    0.984822    0.778923    0.760698    0.739572    0.995984    0.830080    5000        113.285273  0.190253    1.000534    130.206916 
[37m[36mINFO[0m[0m 02/15 16:57:47 | Cumulative gradient change saved at train_output/OfficeHome/RSC/[2]/250215_14-39-44_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/15 16:57:54 | ---
[37m[36mINFO[0m[0m 02/15 16:57:54 | test-domain validation(oracle) = 76.380%
[37m[36mINFO[0m[0m 02/15 16:57:54 | training-domain validation(iid) = 76.070%
[37m[36mINFO[0m[0m 02/15 16:57:54 | last = 76.070%
[37m[36mINFO[0m[0m 02/15 16:57:54 | last (inD) = 80.094%
[37m[36mINFO[0m[0m 02/15 16:57:54 | training-domain validation (iid, inD) = 80.094%
[37m[36mINFO[0m[0m 02/15 16:57:54 | === Summary ===
[37m[36mINFO[0m[0m 02/15 16:57:54 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 2 --dataset OfficeHome --trial_seed 2 --hparams_seed 12
[37m[36mINFO[0m[0m 02/15 16:57:54 | Unique name: 250215_14-39-44_resnet50_GENIE
[37m[36mINFO[0m[0m 02/15 16:57:54 | Out path: train_output/OfficeHome/RSC/[2]/250215_14-39-44_resnet50_GENIE
[37m[36mINFO[0m[0m 02/15 16:57:54 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/15 16:57:54 | Dataset: OfficeHome

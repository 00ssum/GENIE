[37m[36mINFO[0m[0m 01/31 12:47:54 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm RSC --test_envs 2 --dataset OfficeHome --trial_seed 0 --hparams_seed 4
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 4
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/OfficeHome/RSC/[2]/250131_12-47-54_resnet50_EVE
	out_root: train_output/OfficeHome/RSC/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250131_12-47-54_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: EVE
	freeze_bn: False
	pretrained: True
	lr: 2.0793009436922532e-05
	batch_size: 30
	weight_decay: 0.0007980067844361917
	rsc_f_drop_factor: 0.00568084739259922
	rsc_b_drop_factor: 0.21660562421584156
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 01/31 12:47:54 | n_steps = 5001
[37m[36mINFO[0m[0m 01/31 12:47:54 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/31 12:47:54 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/31 12:47:54 | Target test envs = [[2]]
[37m[36mINFO[0m[0m 01/31 12:47:54 | 
[37m[36mINFO[0m[0m 01/31 12:47:54 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 01/31 12:47:54 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 01/31 12:47:54 | Batch sizes for each domain: [30, 30, 0, 30] (total=90)
[37m[36mINFO[0m[0m 01/31 12:47:54 | steps-per-epoch for each domain: 64.73, 116.40, 116.20 -> min = 64.73
[37m[36mINFO[0m[0m 01/31 12:47:55 | # of params = 23641217
[37m[36mINFO[0m[0m 01/31 12:50:05 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/31 12:50:05 | 0.010417    0.007892    0.015982    0.014522    4.219989    0.022142    0.020619    0.008018    0.006873    0.010417    0.007892    0.017785    0.016073    0           0.000000    4.331095    1.036191    128.690992 
[37m[36mINFO[0m[0m 01/31 12:54:13 | 0.687218    0.689966    0.739137    0.698314    1.132691    0.743563    0.707216    0.695304    0.644903    0.687218    0.689966    0.778543    0.742824    200         3.089598    2.510888    0.556007    136.785514 
[37m[36mINFO[0m[0m 01/31 12:58:18 | 0.727196    0.723788    0.833730    0.738984    0.985651    0.847065    0.723711    0.787228    0.694158    0.727196    0.723788    0.866896    0.799082    400         6.179197    0.945602    0.545591    134.879450 
[37m[36mINFO[0m[0m 01/31 13:02:19 | 0.732545    0.709132    0.870470    0.751433    0.961078    0.901133    0.727835    0.828465    0.725086    0.732545    0.709132    0.881813    0.801378    600         9.268795    0.652228    0.559374    128.673634 
[37m[36mINFO[0m[0m 01/31 13:06:17 | 0.746340    0.728298    0.911007    0.765874    0.928790    0.938208    0.760825    0.881157    0.725086    0.746340    0.728298    0.913655    0.811711    800         12.358393   0.481127    0.581296    121.534498 
[37m[36mINFO[0m[0m 01/31 13:10:11 | 0.755068    0.739572    0.933596    0.775885    0.939514    0.962410    0.758763    0.902921    0.746850    0.755068    0.739572    0.935456    0.822044    1000        15.447992   0.374630    0.579142    118.655110 
[37m[36mINFO[0m[0m 01/31 13:14:20 | 0.755349    0.708005    0.945646    0.765336    0.991733    0.969619    0.744330    0.921821    0.744559    0.755349    0.708005    0.945496    0.807118    1200        18.537590   0.299246    0.620259    123.879707 
[37m[36mINFO[0m[0m 01/31 13:18:22 | 0.758164    0.727170    0.956978    0.789103    0.951051    0.973223    0.762887    0.930126    0.774341    0.758164    0.727170    0.967585    0.830080    1400        21.627188   0.235936    0.585967    124.683752 
[37m[36mINFO[0m[0m 01/31 13:22:29 | 0.758164    0.733935    0.960106    0.779088    1.005137    0.976313    0.754639    0.940435    0.767468    0.758164    0.733935    0.963569    0.815155    1600        24.716787   0.196605    0.596722    127.814232 
[37m[36mINFO[0m[0m 01/31 13:26:40 | 0.764921    0.720406    0.973168    0.787808    1.084293    0.987127    0.767010    0.955040    0.761741    0.764921    0.720406    0.977338    0.834673    1800        27.806385   0.174862    0.587644    133.487979 
[37m[36mINFO[0m[0m 01/31 13:30:36 | 0.755912    0.729425    0.972939    0.779014    1.099731    0.988157    0.756701    0.953036    0.761741    0.755912    0.729425    0.977625    0.818599    2000        30.895984   0.148000    0.534991    128.515396 
[37m[36mINFO[0m[0m 01/31 13:34:50 | 0.755631    0.718151    0.974295    0.775652    1.133411    0.985067    0.754639    0.960767    0.756014    0.755631    0.718151    0.977051    0.816303    2200        33.985582   0.129414    0.583230    138.102585 
[37m[36mINFO[0m[0m 01/31 13:38:51 | 0.764921    0.714769    0.978305    0.779694    1.161288    0.992791    0.769072    0.959336    0.760596    0.764921    0.714769    0.982788    0.809414    2400        37.075180   0.122320    0.543346    132.094998 
[37m[36mINFO[0m[0m 01/31 13:43:02 | 0.766610    0.747463    0.981839    0.789176    1.080670    0.990216    0.760825    0.970790    0.781214    0.766610    0.747463    0.984509    0.825488    2600        40.164779   0.104951    0.575026    135.825119 
[37m[36mINFO[0m[0m 01/31 13:46:54 | 0.755631    0.741826    0.984913    0.784513    1.137505    0.994851    0.773196    0.970790    0.760596    0.755631    0.741826    0.989099    0.819747    2800        43.254377   0.108426    0.538179    124.063698 
[37m[36mINFO[0m[0m 01/31 13:51:00 | 0.760135    0.737317    0.986116    0.786572    1.164651    0.993306    0.769072    0.976518    0.774341    0.760135    0.737317    0.988526    0.816303    3000        46.343975   0.084493    0.592444    127.689853 
[37m[36mINFO[0m[0m 01/31 13:55:19 | 0.765484    0.730552    0.985812    0.787051    1.185503    0.993821    0.746392    0.973081    0.772050    0.765484    0.730552    0.990534    0.842710    3200        49.433574   0.082762    0.632620    132.953089 
[37m[36mINFO[0m[0m 01/31 13:59:30 | 0.764077    0.740699    0.987054    0.788951    1.109301    0.993821    0.756701    0.974800    0.778923    0.764077    0.740699    0.992542    0.831228    3400        52.523172   0.072385    0.568892    136.606037 
[37m[36mINFO[0m[0m 01/31 14:03:37 | 0.748029    0.736189    0.985430    0.780467    1.207319    0.991246    0.758763    0.976804    0.761741    0.748029    0.736189    0.988239    0.820896    3600        55.612770   0.077297    0.557422    135.820794 
[37m[36mINFO[0m[0m 01/31 14:07:45 | 0.747748    0.728298    0.985008    0.797578    1.147320    0.994851    0.771134    0.973081    0.792669    0.747748    0.728298    0.987091    0.828932    3800        58.702369   0.065338    0.558493    136.603788 
[37m[36mINFO[0m[0m 01/31 14:11:51 | 0.753660    0.738444    0.990108    0.787726    1.150185    0.996395    0.769072    0.980813    0.767468    0.753660    0.738444    0.993115    0.826636    4000        61.791967   0.061471    0.554685    133.828649 
[37m[36mINFO[0m[0m 01/31 14:16:06 | 0.755068    0.728298    0.983654    0.778237    1.279159    0.992791    0.756701    0.969931    0.776632    0.755068    0.728298    0.988239    0.801378    4200        64.881565   0.059898    0.616405    132.262452 
[37m[36mINFO[0m[0m 01/31 14:20:03 | 0.764640    0.740699    0.989651    0.791851    1.163080    0.995881    0.771134    0.978809    0.775487    0.764640    0.740699    0.994263    0.828932    4400        67.971164   0.053399    0.586528    119.747977 
[37m[36mINFO[0m[0m 01/31 14:24:07 | 0.764358    0.750846    0.986673    0.791699    1.209612    0.991246    0.785567    0.976518    0.759450    0.764358    0.750846    0.992255    0.830080    4600        71.060762   0.053645    0.574455    129.394926 
[37m[36mINFO[0m[0m 01/31 14:28:09 | 0.751408    0.723788    0.988487    0.786348    1.305190    0.993821    0.775258    0.977090    0.760596    0.751408    0.723788    0.994550    0.823192    4800        74.150360   0.047720    0.570412    127.945137 
[37m[36mINFO[0m[0m 01/31 14:32:21 | 0.772523    0.751973    0.989556    0.793904    1.266713    0.993306    0.787629    0.981386    0.776632    0.772523    0.751973    0.993976    0.817451    5000        77.239959   0.048740    0.565759    137.887172 
[37m[36mINFO[0m[0m 01/31 14:32:21 | Cumulative gradient change saved at train_output/OfficeHome/RSC/[2]/250131_12-47-54_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/31 14:32:22 | ---
[37m[36mINFO[0m[0m 01/31 14:32:22 | test-domain validation(oracle) = 77.252%
[37m[36mINFO[0m[0m 01/31 14:32:22 | training-domain validation(iid) = 74.775%
[37m[36mINFO[0m[0m 01/31 14:32:22 | last = 77.252%
[37m[36mINFO[0m[0m 01/31 14:32:22 | last (inD) = 79.390%
[37m[36mINFO[0m[0m 01/31 14:32:22 | training-domain validation (iid, inD) = 79.758%
[37m[36mINFO[0m[0m 01/31 14:32:22 | === Summary ===
[37m[36mINFO[0m[0m 01/31 14:32:22 | Command: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm RSC --test_envs 2 --dataset OfficeHome --trial_seed 0 --hparams_seed 4
[37m[36mINFO[0m[0m 01/31 14:32:22 | Unique name: 250131_12-47-54_resnet50_EVE
[37m[36mINFO[0m[0m 01/31 14:32:22 | Out path: train_output/OfficeHome/RSC/[2]/250131_12-47-54_resnet50_EVE
[37m[36mINFO[0m[0m 01/31 14:32:22 | Algorithm: RSC
[37m[36mINFO[0m[0m 01/31 14:32:22 | Dataset: OfficeHome
[37m[36mINFO[0m[0m 01/31 14:32:22 | Max test_in: 0.7725

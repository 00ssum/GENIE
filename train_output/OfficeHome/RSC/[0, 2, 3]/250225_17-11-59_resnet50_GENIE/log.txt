[37m[36mINFO[0m[0m 02/25 17:11:59 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 2 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 4
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 4
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/RSC/[0, 2, 3]/250225_17-11-59_resnet50_GENIE
	out_root: train_output/OfficeHome/RSC/[0, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 2, 3]
	trial_seed: 0
	unique_name: 250225_17-11-59_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.0793009436922532e-05
	batch_size: 30
	weight_decay: 0.0007980067844361917
	rsc_f_drop_factor: 0.00568084739259922
	rsc_b_drop_factor: 0.21660562421584156
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/25 17:11:59 | n_steps = 5001
[37m[36mINFO[0m[0m 02/25 17:11:59 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/25 17:11:59 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/25 17:11:59 | 
[37m[36mINFO[0m[0m 02/25 17:11:59 | Testenv name escaping te_A_P_R -> te_A_P_R
[37m[36mINFO[0m[0m 02/25 17:11:59 | Test envs = [0, 2, 3], name = te_A_P_R
[37m[36mINFO[0m[0m 02/25 17:11:59 | Train environments: [1], Test environments: [0, 2, 3]
[37m[36mINFO[0m[0m 02/25 17:11:59 | Batch sizes for each domain: [0, 30, 0, 0] (total=30)
[37m[36mINFO[0m[0m 02/25 17:11:59 | steps-per-epoch for each domain: 116.40 -> min = 116.40
[37m[36mINFO[0m[0m 02/25 17:12:00 | # of params = 23641217
[37m[36mINFO[0m[0m 02/25 17:14:05 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/25 17:14:05 | 0.015004    0.014458    0.023769    0.021764    4.194156    0.021627    0.020619    0.023769    0.021764    0.007320    0.011274    0.016064    0.011481    0           0.000000    4.380805    1.373064    123.394702 
[37m[36mINFO[0m[0m 02/25 17:16:39 | 0.416011    0.408698    0.625143    0.525773    1.809806    0.355304    0.360825    0.625143    0.525773    0.423423    0.396843    0.469306    0.468427    200         1.718213    3.049965    0.248126    104.607191 
[37m[36mINFO[0m[0m 02/25 17:19:33 | 0.471372    0.475127    0.802119    0.666667    1.248597    0.387230    0.422680    0.802119    0.666667    0.504223    0.478016    0.522662    0.524684    400         3.436426    1.268633    0.236823    125.763528 
[37m[36mINFO[0m[0m 02/25 17:22:12 | 0.515396    0.522653    0.863975    0.701031    1.323534    0.446447    0.486598    0.863975    0.701031    0.519707    0.508455    0.580034    0.572905    600         5.154639    0.782415    0.181972    123.372168 
[37m[36mINFO[0m[0m 02/25 17:24:42 | 0.492793    0.507263    0.885739    0.721649    1.295929    0.414521    0.457732    0.885739    0.721649    0.521115    0.512965    0.542742    0.551091    800         6.872852    0.587498    0.203985    109.142513 
[37m[36mINFO[0m[0m 02/25 17:27:22 | 0.513643    0.510136    0.915235    0.735395    1.310894    0.445417    0.484536    0.915235    0.735395    0.530968    0.502818    0.564544    0.543054    1000        8.591065    0.442151    0.225529    114.752802 
[37m[36mINFO[0m[0m 02/25 17:29:58 | 0.511236    0.508925    0.932703    0.745704    1.296976    0.430999    0.441237    0.932703    0.745704    0.544764    0.531003    0.557946    0.554535    1200        10.309278   0.373792    0.191333    117.247317 
[37m[36mINFO[0m[0m 02/25 17:32:36 | 0.530070    0.530707    0.946449    0.764032    1.331464    0.451081    0.492784    0.946449    0.764032    0.560529    0.529876    0.578600    0.569460    1400        12.027491   0.296114    0.205748    117.492575 
[37m[36mINFO[0m[0m 02/25 17:35:04 | 0.511112    0.508884    0.945017    0.743414    1.213350    0.416066    0.441237    0.945017    0.743414    0.548423    0.537768    0.568847    0.547646    1600        13.745704   0.267407    0.165889    114.748402 
[37m[36mINFO[0m[0m 02/25 17:37:36 | 0.513442    0.527640    0.958190    0.764032    1.324337    0.440268    0.490722    0.958190    0.764032    0.533221    0.543405    0.566839    0.548794    1800        15.463918   0.197415    0.226314    106.738769 
[37m[36mINFO[0m[0m 02/25 17:40:19 | 0.530083    0.540003    0.961340    0.768614    1.271416    0.450566    0.494845    0.961340    0.768614    0.561655    0.561443    0.578026    0.563720    2000        17.182131   0.197412    0.195792    123.217139 
[37m[36mINFO[0m[0m 02/25 17:42:58 | 0.522778    0.530380    0.965349    0.751432    1.326987    0.445417    0.482474    0.965349    0.751432    0.553209    0.521984    0.569707    0.586682    2200        18.900344   0.187863    0.183896    122.785063 
[37m[36mINFO[0m[0m 02/25 17:45:26 | 0.530649    0.541605    0.965063    0.762887    1.446533    0.437178    0.474227    0.965063    0.762887    0.567849    0.552424    0.586919    0.598163    2400        20.618557   0.160329    0.202569    107.648454 
[37m[36mINFO[0m[0m 02/25 17:48:09 | 0.518394    0.526186    0.974800    0.762887    1.274160    0.453656    0.480412    0.974800    0.762887    0.531532    0.532131    0.569994    0.566016    2600        22.336770   0.144917    0.203511    122.291992 
[37m[36mINFO[0m[0m 02/25 17:50:47 | 0.527399    0.531060    0.972222    0.747995    1.433515    0.454686    0.494845    0.972222    0.747995    0.552928    0.521984    0.574584    0.576349    2800        24.054983   0.129448    0.192993    119.337069 
[37m[36mINFO[0m[0m 02/25 17:53:28 | 0.508177    0.525408    0.969931    0.745704    1.725950    0.427394    0.470103    0.969931    0.745704    0.536036    0.535513    0.561102    0.570608    3000        25.773196   0.111500    0.203324    120.269756 
[37m[36mINFO[0m[0m 02/25 17:56:13 | 0.525734    0.538821    0.970504    0.759450    1.458358    0.440783    0.465979    0.970504    0.759450    0.567286    0.558061    0.569134    0.592423    3200        27.491409   0.130096    0.198424    125.421178 
[37m[36mINFO[0m[0m 02/25 17:59:00 | 0.504912    0.496174    0.968213    0.753723    1.469788    0.427909    0.426804    0.968213    0.753723    0.535191    0.515220    0.551635    0.546498    3400        29.209622   0.121938    0.239463    119.083377 
[37m[36mINFO[0m[0m 02/25 18:01:34 | 0.524555    0.533409    0.977663    0.743414    1.654327    0.434604    0.480412    0.977663    0.743414    0.564189    0.540023    0.574871    0.579793    3600        30.927835   0.128779    0.201799    113.224821 
[37m[36mINFO[0m[0m 02/25 18:04:18 | 0.505091    0.505553    0.976518    0.773196    1.367720    0.417096    0.428866    0.976518    0.773196    0.541667    0.533258    0.556512    0.554535    3800        32.646048   0.096425    0.205739    122.584233 
[37m[36mINFO[0m[0m 02/25 18:06:55 | 0.516989    0.521706    0.979095    0.767468    1.278791    0.424305    0.453608    0.979095    0.767468    0.552365    0.554679    0.574297    0.556831    4000        34.364261   0.082758    0.203617    116.804598 
[37m[36mINFO[0m[0m 02/25 18:09:39 | 0.528398    0.537796    0.979668    0.756014    1.762318    0.432029    0.494845    0.979668    0.756014    0.561655    0.546787    0.591509    0.571757    4200        36.082474   0.075556    0.220704    119.522983 
[37m[36mINFO[0m[0m 02/25 18:12:24 | 0.513203    0.512348    0.979381    0.775487    1.534251    0.426365    0.451546    0.979381    0.775487    0.548986    0.533258    0.564257    0.552239    4400        37.800687   0.089020    0.227716    119.426305 
[37m[36mINFO[0m[0m 02/25 18:15:13 | 0.493736    0.494433    0.973940    0.749141    1.522137    0.425335    0.445361    0.973940    0.749141    0.518581    0.497182    0.537292    0.540758    4600        39.518900   0.066843    0.206989    127.572109 
[37m[36mINFO[0m[0m 02/25 18:17:50 | 0.537367    0.544644    0.977663    0.776632    1.513932    0.453656    0.494845    0.977663    0.776632    0.570664    0.553551    0.587780    0.585534    4800        41.237113   0.077987    0.182849    120.336773 
[37m[36mINFO[0m[0m 02/25 18:20:38 | 0.511627    0.517721    0.974513    0.736541    1.425219    0.432544    0.459794    0.974513    0.736541    0.549268    0.542277    0.553069    0.551091    5000        42.955326   0.117715    0.265299    114.964273 
[37m[36mINFO[0m[0m 02/25 18:20:38 | Cumulative gradient change saved at train_output/OfficeHome/RSC/[0, 2, 3]/250225_17-11-59_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/25 18:20:39 | ---
[37m[36mINFO[0m[0m 02/25 18:20:39 | test-domain validation(oracle) = 53.737%
[37m[36mINFO[0m[0m 02/25 18:20:39 | training-domain validation(iid) = 53.737%
[37m[36mINFO[0m[0m 02/25 18:20:39 | last = 51.163%
[37m[36mINFO[0m[0m 02/25 18:20:39 | last (inD) = 73.654%
[37m[36mINFO[0m[0m 02/25 18:20:39 | training-domain validation (iid, inD) = 77.663%
[37m[36mINFO[0m[0m 02/25 18:20:39 | === Summary ===
[37m[36mINFO[0m[0m 02/25 18:20:39 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 2 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 4
[37m[36mINFO[0m[0m 02/25 18:20:39 | Unique name: 250225_17-11-59_resnet50_GENIE
[37m[36mINFO[0m[0m 02/25 18:20:39 | Out path: train_output/OfficeHome/RSC/[0, 2, 3]/250225_17-11-59_resnet50_GENIE
[37m[36mINFO[0m[0m 02/25 18:20:39 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/25 18:20:39 | Dataset: OfficeHome

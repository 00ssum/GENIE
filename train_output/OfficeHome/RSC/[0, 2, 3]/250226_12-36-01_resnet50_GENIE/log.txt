[37m[36mINFO[0m[0m 02/26 12:36:01 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 2 3 --dataset OfficeHome --trial_seed 2 --hparams_seed 0
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/RSC/[0, 2, 3]/250226_12-36-01_resnet50_GENIE
	out_root: train_output/OfficeHome/RSC/[0, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 2, 3]
	trial_seed: 2
	unique_name: 250226_12-36-01_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	rsc_f_drop_factor: 0.3333333333333333
	rsc_b_drop_factor: 0.3333333333333333
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/26 12:36:01 | n_steps = 5001
[37m[36mINFO[0m[0m 02/26 12:36:01 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/26 12:36:01 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/26 12:36:01 | 
[37m[36mINFO[0m[0m 02/26 12:36:01 | Testenv name escaping te_A_P_R -> te_A_P_R
[37m[36mINFO[0m[0m 02/26 12:36:01 | Test envs = [0, 2, 3], name = te_A_P_R
[37m[36mINFO[0m[0m 02/26 12:36:01 | Train environments: [1], Test environments: [0, 2, 3]
[37m[36mINFO[0m[0m 02/26 12:36:01 | Batch sizes for each domain: [0, 32, 0, 0] (total=32)
[37m[36mINFO[0m[0m 02/26 12:36:01 | steps-per-epoch for each domain: 109.12 -> min = 109.12
[37m[36mINFO[0m[0m 02/26 12:36:03 | # of params = 23641217
[37m[36mINFO[0m[0m 02/26 12:38:06 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/26 12:38:06 | 0.020886    0.023034    0.016037    0.017182    4.173006    0.019567    0.035052    0.016037    0.017182    0.027027    0.021421    0.016064    0.012629    0           0.000000    5.744336    1.123519    121.854304 
[37m[36mINFO[0m[0m 02/26 12:40:28 | 0.015782    0.015092    0.023482    0.019473    4.169954    0.008754    0.002062    0.023482    0.019473    0.022241    0.022548    0.016351    0.020666    200         1.832761    4.184723    0.171920    107.578894 
[37m[36mINFO[0m[0m 02/26 12:43:12 | 0.015782    0.015092    0.023482    0.019473    4.166552    0.008754    0.002062    0.023482    0.019473    0.022241    0.022548    0.016351    0.020666    400         3.665521    4.167794    0.215295    121.286015 
[37m[36mINFO[0m[0m 02/26 12:45:34 | 0.015782    0.015092    0.024055    0.019473    4.163094    0.008754    0.002062    0.024055    0.019473    0.022241    0.022548    0.016351    0.020666    600         5.498282    4.162963    0.146678    112.415453 
[37m[36mINFO[0m[0m 02/26 12:48:00 | 0.022152    0.022480    0.025773    0.010309    4.159860    0.031411    0.030928    0.025773    0.010309    0.012669    0.012401    0.022375    0.024110    800         7.331042    4.158875    0.189574    107.787563 
[37m[36mINFO[0m[0m 02/26 12:50:34 | 0.022152    0.022480    0.025773    0.010309    4.156751    0.031411    0.030928    0.025773    0.010309    0.012669    0.012401    0.022375    0.024110    1000        9.163803    4.155516    0.164864    121.580235 
[37m[36mINFO[0m[0m 02/26 12:52:56 | 0.022152    0.022480    0.025773    0.010309    4.154532    0.031411    0.030928    0.025773    0.010309    0.012669    0.012401    0.022375    0.024110    1200        10.996564   4.153859    0.156103    111.191330 
[37m[36mINFO[0m[0m 02/26 12:55:25 | 0.022152    0.022480    0.025773    0.010309    4.152033    0.031411    0.030928    0.025773    0.010309    0.012669    0.012401    0.022375    0.024110    1400        12.829324   4.147982    0.185325    111.069207 
[37m[36mINFO[0m[0m 02/26 12:57:54 | 0.022152    0.022480    0.025773    0.010309    4.149917    0.031411    0.030928    0.025773    0.010309    0.012669    0.012401    0.022375    0.024110    1600        14.662085   4.146094    0.164983    116.756445 
[37m[36mINFO[0m[0m 02/26 13:00:20 | 0.022152    0.022480    0.025773    0.010309    4.148279    0.031411    0.030928    0.025773    0.010309    0.012669    0.012401    0.022375    0.024110    1800        16.494845   4.145258    0.176179    110.121142 
[37m[36mINFO[0m[0m 02/26 13:02:39 | 0.022152    0.022480    0.025773    0.010309    4.146190    0.031411    0.030928    0.025773    0.010309    0.012669    0.012401    0.022375    0.024110    2000        18.327606   4.140271    0.155008    108.642400 
[37m[36mINFO[0m[0m 02/26 13:05:00 | 0.022152    0.022480    0.025773    0.010309    4.144494    0.031411    0.030928    0.025773    0.010309    0.012669    0.012401    0.022375    0.024110    2200        20.160367   4.137749    0.189132    102.447753 
[37m[36mINFO[0m[0m 02/26 13:07:34 | 0.022152    0.022480    0.025773    0.010309    4.143022    0.031411    0.030928    0.025773    0.010309    0.012669    0.012401    0.022375    0.024110    2400        21.993127   4.136511    0.217661    110.541889 
[37m[36mINFO[0m[0m 02/26 13:09:59 | 0.022152    0.022480    0.025773    0.010309    4.141505    0.031411    0.030928    0.025773    0.010309    0.012669    0.012401    0.022375    0.024110    2600        23.825888   4.134515    0.180404    108.681406 
[37m[36mINFO[0m[0m 02/26 13:12:33 | 0.022152    0.022480    0.025773    0.010309    4.139913    0.031411    0.030928    0.025773    0.010309    0.012669    0.012401    0.022375    0.024110    2800        25.658648   4.132009    0.216330    110.808559 
[37m[36mINFO[0m[0m 02/26 13:14:57 | 0.022152    0.022480    0.025773    0.010309    4.138745    0.031411    0.030928    0.025773    0.010309    0.012669    0.012401    0.022375    0.024110    3000        27.491409   4.133329    0.153591    114.143755 
[37m[36mINFO[0m[0m 02/26 13:17:15 | 0.022152    0.022480    0.025773    0.010309    4.137529    0.031411    0.030928    0.025773    0.010309    0.012669    0.012401    0.022375    0.024110    3200        29.324170   4.130594    0.164472    105.055953 
[37m[36mINFO[0m[0m 02/26 13:19:54 | 0.022152    0.022480    0.025773    0.010309    4.136706    0.031411    0.030928    0.025773    0.010309    0.012669    0.012401    0.022375    0.024110    3400        31.156930   4.129559    0.184922    121.387444 
[37m[36mINFO[0m[0m 02/26 13:22:18 | 0.022152    0.022480    0.025773    0.010309    4.135594    0.031411    0.030928    0.025773    0.010309    0.012669    0.012401    0.022375    0.024110    3600        32.989691   4.126602    0.144480    115.542889 
[37m[36mINFO[0m[0m 02/26 13:24:50 | 0.022152    0.022480    0.025773    0.010309    4.134858    0.031411    0.030928    0.025773    0.010309    0.012669    0.012401    0.022375    0.024110    3800        34.822451   4.125850    0.228860    106.045382 
[37m[36mINFO[0m[0m 02/26 13:27:18 | 0.022152    0.022480    0.025773    0.010309    4.133994    0.031411    0.030928    0.025773    0.010309    0.012669    0.012401    0.022375    0.024110    4000        36.655212   4.127033    0.145697    118.948842 
[37m[36mINFO[0m[0m 02/26 13:29:28 | 0.022152    0.022480    0.025773    0.010309    4.133079    0.031411    0.030928    0.025773    0.010309    0.012669    0.012401    0.022375    0.024110    4200        38.487973   4.124268    0.152550    99.299241  
[37m[36mINFO[0m[0m 02/26 13:32:03 | 0.022152    0.022480    0.025773    0.010309    4.132354    0.031411    0.030928    0.025773    0.010309    0.012669    0.012401    0.022375    0.024110    4400        40.320733   4.126912    0.216682    111.657759 
[37m[36mINFO[0m[0m 02/26 13:34:29 | 0.022152    0.022480    0.025773    0.010309    4.131621    0.031411    0.030928    0.025773    0.010309    0.012669    0.012401    0.022375    0.024110    4600        42.153494   4.120192    0.149953    115.594128 
[37m[36mINFO[0m[0m 02/26 13:36:47 | 0.022152    0.022480    0.025773    0.010309    4.130838    0.031411    0.030928    0.025773    0.010309    0.012669    0.012401    0.022375    0.024110    4800        43.986254   4.119196    0.185415    101.742245 
[37m[36mINFO[0m[0m 02/26 13:39:15 | 0.022152    0.022480    0.025773    0.010309    4.130048    0.031411    0.030928    0.025773    0.010309    0.012669    0.012401    0.022375    0.024110    5000        45.819015   4.120401    0.166291    113.879242 
[37m[36mINFO[0m[0m 02/26 13:39:15 | Cumulative gradient change saved at train_output/OfficeHome/RSC/[0, 2, 3]/250226_12-36-01_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/26 13:39:16 | ---
[37m[36mINFO[0m[0m 02/26 13:39:16 | test-domain validation(oracle) = 2.089%
[37m[36mINFO[0m[0m 02/26 13:39:16 | training-domain validation(iid) = 1.578%
[37m[36mINFO[0m[0m 02/26 13:39:16 | last = 2.215%
[37m[36mINFO[0m[0m 02/26 13:39:16 | last (inD) = 1.031%
[37m[36mINFO[0m[0m 02/26 13:39:16 | training-domain validation (iid, inD) = 1.947%
[37m[36mINFO[0m[0m 02/26 13:39:17 | === Summary ===
[37m[36mINFO[0m[0m 02/26 13:39:17 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 2 3 --dataset OfficeHome --trial_seed 2 --hparams_seed 0
[37m[36mINFO[0m[0m 02/26 13:39:17 | Unique name: 250226_12-36-01_resnet50_GENIE
[37m[36mINFO[0m[0m 02/26 13:39:17 | Out path: train_output/OfficeHome/RSC/[0, 2, 3]/250226_12-36-01_resnet50_GENIE
[37m[36mINFO[0m[0m 02/26 13:39:17 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/26 13:39:17 | Dataset: OfficeHome

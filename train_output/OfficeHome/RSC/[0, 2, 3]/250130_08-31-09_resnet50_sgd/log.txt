[37m[36mINFO[0m[0m 01/30 08:31:09 | Command :: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm RSC --test_envs 0 2 3 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/OfficeHome/RSC/[0, 2, 3]/250130_08-31-09_resnet50_sgd
	out_root: train_output/OfficeHome/RSC/[0, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 2, 3]
	trial_seed: 0
	unique_name: 250130_08-31-09_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	rsc_f_drop_factor: 0.3333333333333333
	rsc_b_drop_factor: 0.3333333333333333
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 01/30 08:31:09 | n_steps = 5001
[37m[36mINFO[0m[0m 01/30 08:31:09 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/30 08:31:09 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/30 08:31:09 | 
[37m[36mINFO[0m[0m 01/30 08:31:09 | Testenv name escaping te_A_P_R -> te_A_P_R
[37m[36mINFO[0m[0m 01/30 08:31:09 | Test envs = [0, 2, 3], name = te_A_P_R
[37m[36mINFO[0m[0m 01/30 08:31:09 | Train environments: [1], Test environments: [0, 2, 3]
[37m[36mINFO[0m[0m 01/30 08:31:09 | Batch sizes for each domain: [0, 32, 0, 0] (total=32)
[37m[36mINFO[0m[0m 01/30 08:31:09 | steps-per-epoch for each domain: 109.12 -> min = 109.12
[37m[36mINFO[0m[0m 01/30 08:31:11 | # of params = 23641217
[37m[36mINFO[0m[0m 01/30 08:33:26 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/30 08:33:26 | 0.016178    0.017562    0.016896    0.014891    4.232910    0.020082    0.028866    0.016896    0.014891    0.012387    0.015784    0.016064    0.008037    0           0.000000    5.729281    1.263374    134.160472 
[37m[36mINFO[0m[0m 01/30 08:37:06 | 0.014790    0.019170    0.019759    0.017182    4.177629    0.019053    0.037113    0.019759    0.017182    0.011261    0.014656    0.014056    0.005741    200         1.832761    5.192919    0.253254    168.657693 
[37m[36mINFO[0m[0m 01/30 08:40:43 | 0.011691    0.013188    0.022910    0.016037    4.173537    0.018538    0.024742    0.022910    0.016037    0.005349    0.005637    0.011188    0.009185    400         3.665521    4.642788    0.241748    168.078556 
[37m[36mINFO[0m[0m 01/30 08:44:32 | 0.012973    0.013195    0.022337    0.018328    4.171471    0.022657    0.024742    0.022337    0.018328    0.004786    0.004510    0.011474    0.010333    600         5.498282    4.463398    0.286317    172.636476 
[37m[36mINFO[0m[0m 01/30 08:47:53 | 0.014498    0.011509    0.017755    0.019473    4.169308    0.024717    0.018557    0.017755    0.019473    0.008164    0.005637    0.010614    0.010333    800         7.331042    4.388338    0.215291    157.603802 
[37m[36mINFO[0m[0m 01/30 08:51:31 | 0.014577    0.015697    0.019187    0.020619    4.167834    0.022142    0.028866    0.019187    0.020619    0.011261    0.007892    0.010327    0.010333    1000        9.163803    4.349537    0.276093    162.588287 
[37m[36mINFO[0m[0m 01/30 08:55:25 | 0.015733    0.016066    0.018900    0.024055    4.166712    0.024202    0.028866    0.018900    0.024055    0.012669    0.010147    0.010327    0.009185    1200        10.996564   4.323440    0.246213    184.572271 
[37m[36mINFO[0m[0m 01/30 08:58:45 | 0.015993    0.016810    0.023482    0.022910    4.165922    0.024717    0.028866    0.023482    0.022910    0.013795    0.013529    0.009466    0.008037    1400        12.829324   4.301215    0.249750    149.656804 
[37m[36mINFO[0m[0m 01/30 09:02:33 | 0.015986    0.016123    0.024055    0.027491    4.165275    0.024717    0.026804    0.024055    0.027491    0.014921    0.013529    0.008319    0.008037    1600        14.662085   4.288376    0.280500    171.049906 
[37m[36mINFO[0m[0m 01/30 09:06:06 | 0.016913    0.019008    0.024341    0.026346    4.164798    0.025232    0.030928    0.024341    0.026346    0.016329    0.016911    0.009180    0.009185    1800        16.494845   4.274703    0.272028    159.000595 
[37m[36mINFO[0m[0m 01/30 09:09:37 | 0.016075    0.017640    0.026060    0.025200    4.164474    0.022142    0.026804    0.026060    0.025200    0.016329    0.015784    0.009753    0.010333    2000        18.327606   4.267153    0.265909    156.696882 
[37m[36mINFO[0m[0m 01/30 09:12:49 | 0.016091    0.017003    0.026346    0.026346    4.164244    0.021627    0.022680    0.026346    0.026346    0.016892    0.020293    0.009753    0.008037    2200        20.160367   4.259732    0.248457    142.705719 
[37m[36mINFO[0m[0m 01/30 09:15:53 | 0.016504    0.017301    0.022050    0.024055    4.164058    0.020597    0.024742    0.022050    0.024055    0.018300    0.021421    0.010614    0.005741    2400        21.993127   4.253044    0.264172    130.118886 
[37m[36mINFO[0m[0m 01/30 09:19:18 | 0.016946    0.016556    0.026060    0.025200    4.163783    0.021627    0.024742    0.026060    0.025200    0.017736    0.018038    0.011474    0.006889    2600        23.825888   4.245988    0.256349    153.947056 
[37m[36mINFO[0m[0m 01/30 09:22:17 | 0.017197    0.016174    0.021478    0.022910    4.163606    0.022657    0.024742    0.021478    0.022910    0.017173    0.018038    0.011761    0.005741    2800        25.658648   4.241579    0.265977    125.822526 
[37m[36mINFO[0m[0m 01/30 09:25:42 | 0.017199    0.017853    0.023769    0.024055    4.163462    0.022657    0.030928    0.023769    0.024055    0.016892    0.018038    0.012048    0.004592    3000        27.491409   4.236627    0.271861    150.858347 
[37m[36mINFO[0m[0m 01/30 09:28:47 | 0.016703    0.017860    0.024341    0.022910    4.163312    0.023172    0.030928    0.024341    0.022910    0.016610    0.016911    0.010327    0.005741    3200        29.324170   4.232951    0.242200    136.531573 
[37m[36mINFO[0m[0m 01/30 09:32:04 | 0.017032    0.017555    0.025487    0.025200    4.163211    0.024717    0.028866    0.025487    0.025200    0.015766    0.016911    0.010614    0.006889    3400        31.156930   4.228758    0.294055    138.314221 
[37m[36mINFO[0m[0m 01/30 09:35:13 | 0.017170    0.016875    0.024055    0.025200    4.163179    0.026262    0.026804    0.024055    0.025200    0.014921    0.015784    0.010327    0.008037    3600        32.989691   4.226235    0.231825    142.873748 
[37m[36mINFO[0m[0m 01/30 09:38:20 | 0.016890    0.018321    0.022337    0.025200    4.163108    0.026262    0.028866    0.022337    0.025200    0.013795    0.016911    0.010614    0.009185    3800        34.822451   4.221958    0.246336    137.231629 
[37m[36mINFO[0m[0m 01/30 09:41:38 | 0.017005    0.019695    0.027778    0.024055    4.163036    0.025747    0.032990    0.027778    0.024055    0.013795    0.016911    0.011474    0.009185    4000        36.655212   4.220247    0.205287    157.340241 
[37m[36mINFO[0m[0m 01/30 09:44:32 | 0.017271    0.019391    0.024914    0.022910    4.163028    0.026262    0.030928    0.024914    0.022910    0.014077    0.016911    0.011474    0.010333    4200        38.487973   4.217630    0.234276    126.249362 
[37m[36mINFO[0m[0m 01/30 09:47:50 | 0.018602    0.021537    0.024628    0.022910    4.162951    0.028836    0.035052    0.024628    0.022910    0.014921    0.015784    0.012048    0.013777    4400        40.320733   4.214151    0.261222    146.199927 
[37m[36mINFO[0m[0m 01/30 09:50:55 | 0.017821    0.021537    0.025487    0.028637    4.162856    0.026777    0.035052    0.025487    0.028637    0.014640    0.015784    0.012048    0.013777    4600        42.153494   4.213106    0.199826    145.389481 
[37m[36mINFO[0m[0m 01/30 09:54:04 | 0.018149    0.021537    0.026919    0.028637    4.162846    0.028321    0.035052    0.026919    0.028637    0.014077    0.015784    0.012048    0.013777    4800        43.986254   4.210873    0.258883    136.643134 
[37m[36mINFO[0m[0m 01/30 09:57:22 | 0.018342    0.020163    0.024628    0.028637    4.162869    0.028321    0.030928    0.024628    0.028637    0.013795    0.015784    0.012909    0.013777    5000        45.819015   4.210285    0.245145    149.193726 
[37m[36mINFO[0m[0m 01/30 09:57:23 | Cumulative gradient change saved at train_output/OfficeHome/RSC/[0, 2, 3]/250130_08-31-09_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/30 09:57:24 | ---
[37m[36mINFO[0m[0m 01/30 09:57:24 | test-domain validation(oracle) = 1.860%
[37m[36mINFO[0m[0m 01/30 09:57:24 | training-domain validation(iid) = 1.782%
[37m[36mINFO[0m[0m 01/30 09:57:24 | last = 1.834%
[37m[36mINFO[0m[0m 01/30 09:57:24 | last (inD) = 2.864%
[37m[36mINFO[0m[0m 01/30 09:57:24 | training-domain validation (iid, inD) = 2.864%
[37m[36mINFO[0m[0m 01/30 09:57:24 | === Summary ===
[37m[36mINFO[0m[0m 01/30 09:57:24 | Command: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm RSC --test_envs 0 2 3 --dataset OfficeHome
[37m[36mINFO[0m[0m 01/30 09:57:24 | Unique name: 250130_08-31-09_resnet50_sgd
[37m[36mINFO[0m[0m 01/30 09:57:24 | Out path: train_output/OfficeHome/RSC/[0, 2, 3]/250130_08-31-09_resnet50_sgd
[37m[36mINFO[0m[0m 01/30 09:57:24 | Algorithm: RSC
[37m[36mINFO[0m[0m 01/30 09:57:24 | Dataset: OfficeHome

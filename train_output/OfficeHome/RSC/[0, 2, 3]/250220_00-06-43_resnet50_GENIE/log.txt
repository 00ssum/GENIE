[37m[36mINFO[0m[0m 02/20 00:06:43 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 2 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 20
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 20
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/RSC/[0, 2, 3]/250220_00-06-43_resnet50_GENIE
	out_root: train_output/OfficeHome/RSC/[0, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 2, 3]
	trial_seed: 0
	unique_name: 250220_00-06-43_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.6157673767852512e-05
	batch_size: 32
	weight_decay: 1.110622050999988e-05
	rsc_f_drop_factor: 0.011558843074644498
	rsc_b_drop_factor: 0.009443205254898168
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/20 00:06:43 | n_steps = 5001
[37m[36mINFO[0m[0m 02/20 00:06:43 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/20 00:06:43 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/20 00:06:43 | 
[37m[36mINFO[0m[0m 02/20 00:06:43 | Testenv name escaping te_A_P_R -> te_A_P_R
[37m[36mINFO[0m[0m 02/20 00:06:43 | Test envs = [0, 2, 3], name = te_A_P_R
[37m[36mINFO[0m[0m 02/20 00:06:43 | Train environments: [1], Test environments: [0, 2, 3]
[37m[36mINFO[0m[0m 02/20 00:06:43 | Batch sizes for each domain: [0, 32, 0, 0] (total=32)
[37m[36mINFO[0m[0m 02/20 00:06:43 | steps-per-epoch for each domain: 109.12 -> min = 109.12
[37m[36mINFO[0m[0m 02/20 00:06:45 | # of params = 23641217
[37m[36mINFO[0m[0m 02/20 00:08:44 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/20 00:08:44 | 0.014222    0.014465    0.020619    0.022910    4.194953    0.019567    0.020619    0.020619    0.022910    0.007320    0.010147    0.015777    0.012629    0           0.000000    4.323289    1.013945    118.414768 
[37m[36mINFO[0m[0m 02/20 00:11:44 | 0.429503    0.430792    0.664662    0.585338    1.706645    0.373326    0.397938    0.664662    0.585338    0.449606    0.434047    0.465577    0.460390    200         1.832761    2.658800    0.293305    120.652085 
[37m[36mINFO[0m[0m 02/20 00:14:30 | 0.498528    0.491810    0.817297    0.652921    1.395272    0.430999    0.445361    0.817297    0.652921    0.512950    0.488162    0.551635    0.541906    400         3.665521    1.096056    0.231574    120.182878 
[37m[36mINFO[0m[0m 02/20 00:17:26 | 0.517485    0.527936    0.866552    0.694158    1.338115    0.448507    0.494845    0.866552    0.694158    0.539977    0.532131    0.563970    0.556831    600         5.498282    0.710957    0.264747    122.747771 
[37m[36mINFO[0m[0m 02/20 00:20:19 | 0.520061    0.531174    0.888030    0.714777    1.293257    0.456231    0.490722    0.888030    0.714777    0.539696    0.528749    0.564257    0.574053    800         7.331042    0.528369    0.218017    129.672658 
[37m[36mINFO[0m[0m 02/20 00:23:12 | 0.519770    0.528423    0.918099    0.714777    1.360269    0.450051    0.478351    0.918099    0.714777    0.547297    0.554679    0.561962    0.552239    1000        9.163803    0.391285    0.178032    137.502540 
[37m[36mINFO[0m[0m 02/20 00:26:05 | 0.523908    0.526098    0.927549    0.735395    1.345621    0.427909    0.470103    0.927549    0.735395    0.570664    0.547914    0.573150    0.560276    1200        10.996564   0.318090    0.225450    127.299502 
[37m[36mINFO[0m[0m 02/20 00:28:54 | 0.477731    0.483661    0.914948    0.712486    1.334940    0.409372    0.437113    0.914948    0.712486    0.499437    0.494927    0.524383    0.518944    1400        12.829324   0.292627    0.202956    129.332581 
[37m[36mINFO[0m[0m 02/20 00:31:45 | 0.512656    0.516217    0.945304    0.728522    1.452799    0.434604    0.459794    0.945304    0.728522    0.540541    0.537768    0.562823    0.551091    1600        14.662085   0.237422    0.183373    134.375446 
[37m[36mINFO[0m[0m 02/20 00:34:39 | 0.507452    0.523471    0.952176    0.744559    1.383225    0.423790    0.482474    0.952176    0.744559    0.536318    0.525366    0.562249    0.562572    1800        16.494845   0.212087    0.216617    130.303478 
[37m[36mINFO[0m[0m 02/20 00:37:28 | 0.522866    0.530911    0.960195    0.725086    1.358955    0.440268    0.463918    0.960195    0.725086    0.555180    0.550169    0.573150    0.578645    2000        18.327606   0.186689    0.237834    121.754247 
[37m[36mINFO[0m[0m 02/20 00:40:15 | 0.517375    0.522637    0.958477    0.753723    1.344410    0.431514    0.472165    0.958477    0.753723    0.553773    0.537768    0.566839    0.557979    2200        20.160367   0.170788    0.213315    124.285590 
[37m[36mINFO[0m[0m 02/20 00:42:59 | 0.494719    0.476965    0.952176    0.725086    1.514673    0.414006    0.412371    0.952176    0.725086    0.521959    0.491545    0.548193    0.526980    2400        21.993127   0.156535    0.218766    119.548218 
[37m[36mINFO[0m[0m 02/20 00:45:57 | 0.511353    0.522863    0.970504    0.760596    1.386607    0.425335    0.468041    0.970504    0.760596    0.545327    0.526494    0.563396    0.574053    2600        23.825888   0.139901    0.229339    132.443086 
[37m[36mINFO[0m[0m 02/20 00:48:52 | 0.533807    0.550672    0.972795    0.751432    1.286483    0.459320    0.509278    0.972795    0.751432    0.555180    0.542277    0.586919    0.600459    2800        25.658648   0.130156    0.192817    136.582748 
[37m[36mINFO[0m[0m 02/20 00:51:37 | 0.532643    0.529973    0.971649    0.747995    1.354646    0.460865    0.488660    0.971649    0.747995    0.563626    0.550169    0.573437    0.551091    3000        27.491409   0.119609    0.193726    125.815457 
[37m[36mINFO[0m[0m 02/20 00:54:24 | 0.525127    0.527178    0.974513    0.776632    1.364247    0.457261    0.484536    0.974513    0.776632    0.548986    0.532131    0.569134    0.564868    3200        29.324170   0.135915    0.198377    127.161124 
[37m[36mINFO[0m[0m 02/20 00:57:23 | 0.511144    0.515012    0.974800    0.768614    1.367719    0.439753    0.461856    0.974800    0.768614    0.536881    0.534386    0.556799    0.548794    3400        31.156930   0.107087    0.187670    141.612013 
[37m[36mINFO[0m[0m 02/20 01:00:00 | 0.514810    0.525442    0.976231    0.777778    1.418069    0.434604    0.480412    0.976231    0.777778    0.547579    0.528749    0.562249    0.567164    3600        32.989691   0.094693    0.176074    122.176902 
[37m[36mINFO[0m[0m 02/20 01:02:38 | 0.515621    0.528873    0.973654    0.757159    1.394218    0.428939    0.488660    0.973654    0.757159    0.559403    0.542277    0.558520    0.555683    3800        34.822451   0.084035    0.219196    114.205291 
[37m[36mINFO[0m[0m 02/20 01:05:33 | 0.533390    0.530633    0.977377    0.782360    1.403868    0.453656    0.472165    0.977377    0.782360    0.564471    0.544532    0.582042    0.575201    4000        36.655212   0.089008    0.236972    127.490145 
[37m[36mINFO[0m[0m 02/20 01:08:11 | 0.509883    0.515660    0.976518    0.769759    1.520508    0.423275    0.443299    0.976518    0.769759    0.548142    0.543405    0.558233    0.560276    4200        38.487973   0.090426    0.205560    116.619069 
[37m[36mINFO[0m[0m 02/20 01:10:56 | 0.530739    0.539103    0.981386    0.752577    1.501807    0.453656    0.488660    0.981386    0.752577    0.560248    0.559188    0.578313    0.569460    4400        40.320733   0.086951    0.206935    123.898145 
[37m[36mINFO[0m[0m 02/20 01:13:54 | 0.510459    0.510072    0.977950    0.778923    1.549401    0.420700    0.451546    0.977950    0.778923    0.563345    0.529876    0.547332    0.548794    4600        42.153494   0.073537    0.211177    135.489669 
[37m[36mINFO[0m[0m 02/20 01:16:35 | 0.517312    0.516280    0.978809    0.765178    1.626567    0.435118    0.459794    0.978809    0.765178    0.557151    0.527621    0.559667    0.561424    4800        43.986254   0.067452    0.183709    124.429846 
[37m[36mINFO[0m[0m 02/20 01:19:13 | 0.525624    0.543355    0.979095    0.773196    1.447157    0.452111    0.478351    0.979095    0.773196    0.546734    0.553551    0.578026    0.598163    5000        45.819015   0.074376    0.201234    117.633476 
[37m[36mINFO[0m[0m 02/20 01:19:13 | Cumulative gradient change saved at train_output/OfficeHome/RSC/[0, 2, 3]/250220_00-06-43_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/20 01:19:14 | ---
[37m[36mINFO[0m[0m 02/20 01:19:14 | test-domain validation(oracle) = 53.381%
[37m[36mINFO[0m[0m 02/20 01:19:14 | training-domain validation(iid) = 53.339%
[37m[36mINFO[0m[0m 02/20 01:19:14 | last = 52.562%
[37m[36mINFO[0m[0m 02/20 01:19:14 | last (inD) = 77.320%
[37m[36mINFO[0m[0m 02/20 01:19:14 | training-domain validation (iid, inD) = 78.236%
[37m[36mINFO[0m[0m 02/20 01:19:14 | === Summary ===
[37m[36mINFO[0m[0m 02/20 01:19:14 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 2 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 20
[37m[36mINFO[0m[0m 02/20 01:19:14 | Unique name: 250220_00-06-43_resnet50_GENIE
[37m[36mINFO[0m[0m 02/20 01:19:14 | Out path: train_output/OfficeHome/RSC/[0, 2, 3]/250220_00-06-43_resnet50_GENIE
[37m[36mINFO[0m[0m 02/20 01:19:14 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/20 01:19:14 | Dataset: OfficeHome

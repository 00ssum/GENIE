[37m[36mINFO[0m[0m 03/14 17:46:40 | Command :: /jsm0707/GENIE/train_all.py B_OfficeHome0_signum config/resnet50_signum.yaml --trial_seed 0 --hparams_seed 20 --algorithm GENIE --test_envs 1 2 3 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_signum.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 20
	in_domain: False
	model_save: None
	mpa: False
	name: B_OfficeHome0_signum
	out_dir: train_output/OfficeHome/GENIE/[1, 2, 3]/250314_17-46-40_B_OfficeHome0_signum
	out_root: train_output/OfficeHome/GENIE/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 0
	unique_name: 250314_17-46-40_B_OfficeHome0_signum
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: signum
	freeze_bn: False
	pretrained: True
	lr: 2.6157673767852512e-05
	batch_size: 32
	weight_decay: 1.110622050999988e-05
	momentum: 0.8046004195437085
	convergence_rate: 0.0010908695544732698
	moving_avg: 0.9447089904071476
	p: 0.5550574176650049
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/14 17:46:40 | n_steps = 5001
[37m[36mINFO[0m[0m 03/14 17:46:40 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/14 17:46:40 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/14 17:46:40 | 
[37m[36mINFO[0m[0m 03/14 17:46:40 | Testenv name escaping te_C_P_R -> te_C_P_R
[37m[36mINFO[0m[0m 03/14 17:46:40 | Test envs = [1, 2, 3], name = te_C_P_R
[37m[36mINFO[0m[0m 03/14 17:46:40 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 03/14 17:46:40 | Batch sizes for each domain: [32, 0, 0, 0] (total=32)
[37m[36mINFO[0m[0m 03/14 17:46:40 | steps-per-epoch for each domain: 60.69 -> min = 60.69
[37m[36mINFO[0m[0m 03/14 17:46:41 | # of params = 23641217
[37m[36mINFO[0m[0m 03/14 17:48:26 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/14 17:48:26 | 0.015974    0.014052    0.017508    0.028866    4.251460    0.017508    0.028866    0.018614    0.014891    0.012669    0.015784    0.016638    0.011481    0           0.000000    4.341772    0.890407    103.985056 
[37m[36mINFO[0m[0m 03/14 17:50:59 | 0.115026    0.117136    0.225026    0.239175    3.609677    0.225026    0.239175    0.102234    0.096220    0.097691    0.108230    0.145152    0.146958    200         3.295572    3.991494    0.235222    105.965135 
[37m[36mINFO[0m[0m 03/14 17:53:25 | 0.331052    0.332274    0.556128    0.517526    2.079072    0.556128    0.517526    0.253723    0.250859    0.323198    0.329200    0.416236    0.416762    400         6.591143    3.045666    0.224099    101.428574 
[37m[36mINFO[0m[0m 03/14 17:55:56 | 0.471270    0.461962    0.744593    0.645361    1.334393    0.744593    0.645361    0.380011    0.366552    0.457207    0.447576    0.576592    0.571757    600         9.886715    1.787231    0.229840    104.935682 
[37m[36mINFO[0m[0m 03/14 17:58:18 | 0.514303    0.507477    0.812049    0.678351    1.162284    0.812049    0.678351    0.403207    0.395189    0.515203    0.510710    0.624498    0.616533    800         13.182286   1.196381    0.218204    98.454607  
[37m[36mINFO[0m[0m 03/14 18:00:49 | 0.571172    0.539699    0.887745    0.705155    1.070427    0.887745    0.705155    0.447595    0.410080    0.590935    0.559188    0.674986    0.649828    1000        16.477858   0.848888    0.221939    106.215223 
[37m[36mINFO[0m[0m 03/14 18:03:16 | 0.576062    0.560629    0.917096    0.705155    1.063303    0.917096    0.705155    0.441294    0.438717    0.604448    0.574972    0.682444    0.668197    1200        19.773429   0.647704    0.221365    102.654130 
[37m[36mINFO[0m[0m 03/14 18:05:43 | 0.584920    0.565548    0.939753    0.738144    1.046300    0.939753    0.738144    0.449026    0.430699    0.609234    0.585118    0.696500    0.680827    1400        23.069001   0.485263    0.227289    102.083190 
[37m[36mINFO[0m[0m 03/14 18:08:11 | 0.594515    0.575042    0.954686    0.752577    1.038067    0.954686    0.752577    0.453036    0.445590    0.618806    0.595265    0.711704    0.684271    1600        26.364573   0.389621    0.229692    101.989399 
[37m[36mINFO[0m[0m 03/14 18:10:37 | 0.598042    0.578097    0.970649    0.752577    1.019611    0.970649    0.752577    0.465636    0.454754    0.619369    0.595265    0.709122    0.684271    1800        29.660144   0.308968    0.223121    101.660155 
[37m[36mINFO[0m[0m 03/14 18:13:04 | 0.595932    0.587988    0.979403    0.738144    1.089135    0.979403    0.738144    0.455326    0.459336    0.621340    0.604284    0.711130    0.700344    2000        32.955716   0.247687    0.218401    102.954332 
[37m[36mINFO[0m[0m 03/14 18:15:26 | 0.593889    0.590658    0.980433    0.756701    1.121460    0.980433    0.756701    0.451031    0.461627    0.627252    0.605411    0.703385    0.704937    2200        36.251287   0.202786    0.221143    97.674259  
[37m[36mINFO[0m[0m 03/14 18:17:52 | 0.598694    0.587235    0.985582    0.746392    1.174531    0.985582    0.746392    0.458763    0.461627    0.622748    0.602029    0.714573    0.698048    2400        39.546859   0.175787    0.224209    101.312685 
[37m[36mINFO[0m[0m 03/14 18:20:19 | 0.600894    0.587240    0.989186    0.767010    1.180596    0.989186    0.767010    0.467927    0.473081    0.621903    0.599775    0.712851    0.688863    2600        42.842430   0.160700    0.227938    101.018282 
[37m[36mINFO[0m[0m 03/14 18:22:45 | 0.599707    0.584920    0.990731    0.760825    1.135435    0.990731    0.760825    0.453608    0.459336    0.629505    0.605411    0.716007    0.690011    2800        46.138002   0.124143    0.229629    100.334964 
[37m[36mINFO[0m[0m 03/14 18:25:15 | 0.597314    0.583399    0.992276    0.764948    1.185904    0.992276    0.764948    0.451604    0.454754    0.630068    0.604284    0.710270    0.691160    3000        49.433574   0.116867    0.231623    103.451459 
[37m[36mINFO[0m[0m 03/14 18:27:45 | 0.600945    0.581879    0.991246    0.758763    1.210490    0.991246    0.758763    0.462486    0.459336    0.629505    0.602029    0.710843    0.684271    3200        52.729145   0.108739    0.228100    104.662363 
[37m[36mINFO[0m[0m 03/14 18:30:16 | 0.597198    0.585377    0.991761    0.746392    1.257912    0.991761    0.746392    0.459908    0.469645    0.617399    0.591883    0.714286    0.694604    3400        56.024717   0.084510    0.227530    105.426694 
[37m[36mINFO[0m[0m 03/14 18:32:50 | 0.591476    0.587638    0.992791    0.762887    1.245404    0.992791    0.762887    0.451031    0.470790    0.615709    0.597520    0.707688    0.694604    3600        59.320288   0.078431    0.243357    105.232966 
[37m[36mINFO[0m[0m 03/14 18:35:18 | 0.594379    0.584168    0.993306    0.752577    1.421588    0.993306    0.752577    0.455899    0.459336    0.625000    0.603157    0.702238    0.690011    3800        62.615860   0.065107    0.231208    101.954572 
[37m[36mINFO[0m[0m 03/14 18:37:50 | 0.588894    0.576188    0.992791    0.738144    1.344490    0.992791    0.738144    0.445304    0.447881    0.616273    0.595265    0.705106    0.685419    4000        65.911432   0.065281    0.251439    101.328873 
[37m[36mINFO[0m[0m 03/14 18:40:19 | 0.597741    0.577344    0.992791    0.742268    1.365741    0.992791    0.742268    0.462486    0.446735    0.621903    0.594138    0.708835    0.691160    4200        69.207003   0.053309    0.232562    102.840194 
[37m[36mINFO[0m[0m 03/14 18:42:51 | 0.593944    0.576869    0.993821    0.750515    1.285475    0.993821    0.750515    0.451031    0.441008    0.618525    0.609921    0.712278    0.679679    4400        72.502575   0.051892    0.235353    104.430800 
[37m[36mINFO[0m[0m 03/14 18:45:21 | 0.581229    0.566294    0.994336    0.748454    1.331343    0.994336    0.748454    0.448454    0.437572    0.603322    0.587373    0.691910    0.673938    4600        75.798146   0.055297    0.228087    104.766595 
[37m[36mINFO[0m[0m 03/14 18:47:50 | 0.584106    0.573141    0.995366    0.752577    1.390011    0.995366    0.752577    0.449313    0.437572    0.601914    0.594138    0.701090    0.687715    4800        79.093718   0.050205    0.232438    102.794740 
[37m[36mINFO[0m[0m 03/14 18:50:19 | 0.594285    0.587960    0.996395    0.746392    1.373763    0.996395    0.746392    0.443585    0.451317    0.625845    0.609921    0.713425    0.702641    5000        82.389289   0.055403    0.231692    102.362344 
[37m[36mINFO[0m[0m 03/14 18:50:19 | Cumulative gradient change saved at train_output/OfficeHome/GENIE/[1, 2, 3]/250314_17-46-40_B_OfficeHome0_signum/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/14 18:50:20 | ---
[37m[36mINFO[0m[0m 03/14 18:50:20 | test-domain validation(oracle) = 59.389%
[37m[36mINFO[0m[0m 03/14 18:50:20 | training-domain validation(iid) = 60.089%
[37m[36mINFO[0m[0m 03/14 18:50:20 | last = 59.429%
[37m[36mINFO[0m[0m 03/14 18:50:20 | last (inD) = 74.639%
[37m[36mINFO[0m[0m 03/14 18:50:20 | training-domain validation (iid, inD) = 76.701%
[37m[36mINFO[0m[0m 03/14 18:50:20 | === Summary ===
[37m[36mINFO[0m[0m 03/14 18:50:20 | Command: /jsm0707/GENIE/train_all.py B_OfficeHome0_signum config/resnet50_signum.yaml --trial_seed 0 --hparams_seed 20 --algorithm GENIE --test_envs 1 2 3 --dataset OfficeHome
[37m[36mINFO[0m[0m 03/14 18:50:20 | Unique name: 250314_17-46-40_B_OfficeHome0_signum
[37m[36mINFO[0m[0m 03/14 18:50:20 | Out path: train_output/OfficeHome/GENIE/[1, 2, 3]/250314_17-46-40_B_OfficeHome0_signum
[37m[36mINFO[0m[0m 03/14 18:50:20 | Algorithm: GENIE
[37m[36mINFO[0m[0m 03/14 18:50:20 | Dataset: OfficeHome

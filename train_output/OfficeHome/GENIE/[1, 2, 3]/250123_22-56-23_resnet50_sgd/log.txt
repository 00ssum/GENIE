[37m[36mINFO[0m[0m 01/23 22:56:23 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 1 2 3 --dataset OfficeHome --trial_seed 1 --hparams_seed 2
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 2
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/OfficeHome/GENIE/[1, 2, 3]/250123_22-56-23_resnet50_sgd
	out_root: train_output/OfficeHome/GENIE/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 1
	unique_name: 250123_22-56-23_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 0.0001126313085293539
	batch_size: 38
	weight_decay: 0.006639128805224463
	momentum: 0.844808580961198
	convergence_rate: 0.0072584840023010066
	moving_avg: 0.9222220369334958
	p: 0.1472838851744452
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 01/23 22:56:23 | n_steps = 5001
[37m[36mINFO[0m[0m 01/23 22:56:23 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/23 22:56:23 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/23 22:56:23 | 
[37m[36mINFO[0m[0m 01/23 22:56:23 | Testenv name escaping te_C_P_R -> te_C_P_R
[37m[36mINFO[0m[0m 01/23 22:56:23 | Test envs = [1, 2, 3], name = te_C_P_R
[37m[36mINFO[0m[0m 01/23 22:56:23 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 01/23 22:56:23 | Batch sizes for each domain: [38, 0, 0, 0] (total=38)
[37m[36mINFO[0m[0m 01/23 22:56:23 | steps-per-epoch for each domain: 51.11 -> min = 51.11
[37m[36mINFO[0m[0m 01/23 22:56:24 | # of params = 23641217
[37m[36mINFO[0m[0m 01/23 22:58:25 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/23 22:58:25 | 0.017499    0.011046    0.032956    0.035052    4.195333    0.032956    0.035052    0.020905    0.014891    0.013232    0.006764    0.018359    0.011481    0           0.000000    4.253931    1.387226    119.668764 
[37m[36mINFO[0m[0m 01/23 23:01:27 | 0.482414    0.460008    0.767250    0.690722    1.222308    0.767250    0.690722    0.355670    0.356243    0.496622    0.455468    0.594951    0.568312    200         3.913491    2.335444    0.289710    123.133648 
[37m[36mINFO[0m[0m 01/23 23:04:34 | 0.573765    0.550782    0.902163    0.719588    1.007416    0.902163    0.719588    0.461054    0.447881    0.587838    0.556933    0.672404    0.647532    400         7.826982    0.681429    0.304416    126.315472 
[37m[36mINFO[0m[0m 01/23 23:07:24 | 0.552476    0.541247    0.951081    0.727835    1.084458    0.951081    0.727835    0.424399    0.431844    0.570664    0.553551    0.662364    0.638347    600         11.740474   0.372598    0.284884    112.394136 
[37m[36mINFO[0m[0m 01/23 23:10:13 | 0.572531    0.558783    0.966014    0.738144    1.108000    0.966014    0.738144    0.436426    0.441008    0.603885    0.563698    0.677281    0.671642    800         15.653965   0.199177    0.279369    113.265353 
[37m[36mINFO[0m[0m 01/23 23:13:13 | 0.571505    0.561306    0.975283    0.742268    1.179163    0.975283    0.742268    0.430126    0.419244    0.600225    0.591883    0.684165    0.672790    1000        19.567456   0.145886    0.286890    122.723642 
[37m[36mINFO[0m[0m 01/23 23:16:09 | 0.590782    0.571330    0.978888    0.746392    1.254028    0.978888    0.746392    0.475372    0.466208    0.602196    0.573844    0.694779    0.673938    1200        23.480947   0.108715    0.291183    116.724897 
[37m[36mINFO[0m[0m 01/23 23:19:04 | 0.576189    0.557571    0.992276    0.758763    1.168279    0.992276    0.758763    0.448740    0.443299    0.598818    0.573844    0.681010    0.655568    1400        27.394439   0.076851    0.290743    117.544361 
[37m[36mINFO[0m[0m 01/23 23:22:06 | 0.585514    0.569752    0.991761    0.760825    1.211689    0.991761    0.760825    0.459908    0.455899    0.605011    0.582864    0.691624    0.670494    1600        31.307930   0.073683    0.317587    117.763173 
[37m[36mINFO[0m[0m 01/23 23:25:04 | 0.568014    0.557622    0.991761    0.769072    1.157801    0.991761    0.769072    0.432990    0.438717    0.592624    0.565953    0.678428    0.668197    1800        35.221421   0.057707    0.291698    120.089419 
[37m[36mINFO[0m[0m 01/23 23:28:01 | 0.581242    0.570563    0.996395    0.781443    1.236820    0.996395    0.781443    0.453322    0.468499    0.600788    0.573844    0.689616    0.669346    2000        39.134912   0.040319    0.300097    116.443068 
[37m[36mINFO[0m[0m 01/23 23:31:00 | 0.588203    0.563653    0.994851    0.762887    1.293238    0.994851    0.762887    0.470504    0.451317    0.602196    0.579481    0.691910    0.660161    2200        43.048404   0.043971    0.294232    119.820804 
[37m[36mINFO[0m[0m 01/23 23:34:00 | 0.583631    0.565558    0.993306    0.754639    1.226324    0.993306    0.754639    0.454467    0.453608    0.615991    0.580609    0.680436    0.662457    2400        46.961895   0.048909    0.295842    120.949562 
[37m[36mINFO[0m[0m 01/23 23:36:59 | 0.578389    0.563229    0.993306    0.779381    1.201059    0.993306    0.779381    0.453036    0.442153    0.598255    0.587373    0.683878    0.660161    2600        50.875386   0.024477    0.301766    118.845407 
[37m[36mINFO[0m[0m 01/23 23:39:53 | 0.583661    0.568588    0.995366    0.748454    1.426400    0.995366    0.748454    0.472509    0.467354    0.594595    0.583991    0.683878    0.654420    2800        54.788877   0.024147    0.303120    113.182917 
[37m[36mINFO[0m[0m 01/23 23:42:48 | 0.583748    0.577358    0.992791    0.748454    1.382078    0.992791    0.748454    0.462199    0.474227    0.612050    0.588501    0.676994    0.669346    3000        58.702369   0.023443    0.304203    113.963823 
[37m[36mINFO[0m[0m 01/23 23:45:41 | 0.574282    0.569667    0.994851    0.781443    1.372463    0.994851    0.781443    0.436426    0.441008    0.599099    0.598647    0.687321    0.669346    3200        62.615860   0.024449    0.299065    113.479645 
[37m[36mINFO[0m[0m 01/23 23:48:28 | 0.582237    0.569681    0.995366    0.779381    1.225804    0.995366    0.779381    0.459049    0.450172    0.609234    0.595265    0.678428    0.663605    3400        66.529351   0.019733    0.291319    107.603185 
[37m[36mINFO[0m[0m 01/23 23:51:18 | 0.589991    0.586487    0.996395    0.769072    1.230644    0.996395    0.769072    0.469645    0.474227    0.606982    0.597520    0.693345    0.687715    3600        70.442842   0.021066    0.289139    112.740935 
[37m[36mINFO[0m[0m 01/23 23:54:04 | 0.576383    0.562885    0.995881    0.754639    1.443850    0.995881    0.754639    0.446735    0.445590    0.598536    0.580609    0.683878    0.662457    3800        74.356334   0.016040    0.274354    111.104472 
[37m[36mINFO[0m[0m 01/23 23:56:51 | 0.591791    0.585687    0.996395    0.785567    1.240534    0.996395    0.785567    0.469645    0.465063    0.609516    0.604284    0.696213    0.687715    4000        78.269825   0.017942    0.282933    110.093697 
[37m[36mINFO[0m[0m 01/23 23:59:36 | 0.584347    0.573109    0.996395    0.785567    1.332313    0.996395    0.785567    0.463058    0.452463    0.607827    0.597520    0.682157    0.669346    4200        82.183316   0.011713    0.275353    109.054996 
[37m[36mINFO[0m[0m 01/24 00:02:23 | 0.590801    0.575751    0.996395    0.771134    1.333058    0.996395    0.771134    0.463345    0.455899    0.615428    0.603157    0.693632    0.668197    4400        86.096807   0.012803    0.282383    111.458488 
[37m[36mINFO[0m[0m 01/24 00:05:09 | 0.591014    0.580681    0.996395    0.783505    1.373752    0.996395    0.783505    0.469931    0.460481    0.611486    0.609921    0.691624    0.671642    4600        90.010299   0.012708    0.280668    109.075917 
[37m[36mINFO[0m[0m 01/24 00:08:01 | 0.579297    0.575023    0.996395    0.771134    1.439040    0.996395    0.771134    0.453608    0.461627    0.605856    0.596392    0.678428    0.667049    4800        93.923790   0.009814    0.296403    112.754843 
[37m[36mINFO[0m[0m 01/24 00:10:53 | 0.571905    0.563589    0.995881    0.773196    1.282695    0.995881    0.773196    0.431271    0.436426    0.597410    0.591883    0.687034    0.662457    5000        97.837281   0.021394    0.292184    114.084227 
[37m[36mINFO[0m[0m 01/24 00:10:53 | Cumulative gradient change saved at train_output/OfficeHome/GENIE/[1, 2, 3]/250123_22-56-23_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/24 00:10:55 | ---
[37m[36mINFO[0m[0m 01/24 00:10:55 | test-domain validation(oracle) = 58.999%
[37m[36mINFO[0m[0m 01/24 00:10:55 | training-domain validation(iid) = 59.179%
[37m[36mINFO[0m[0m 01/24 00:10:55 | last = 57.191%
[37m[36mINFO[0m[0m 01/24 00:10:55 | last (inD) = 77.320%
[37m[36mINFO[0m[0m 01/24 00:10:55 | training-domain validation (iid, inD) = 78.557%
[37m[36mINFO[0m[0m 01/24 00:10:55 | === Summary ===
[37m[36mINFO[0m[0m 01/24 00:10:55 | Command: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 1 2 3 --dataset OfficeHome --trial_seed 1 --hparams_seed 2
[37m[36mINFO[0m[0m 01/24 00:10:55 | Unique name: 250123_22-56-23_resnet50_sgd
[37m[36mINFO[0m[0m 01/24 00:10:55 | Out path: train_output/OfficeHome/GENIE/[1, 2, 3]/250123_22-56-23_resnet50_sgd
[37m[36mINFO[0m[0m 01/24 00:10:55 | Algorithm: GENIE
[37m[36mINFO[0m[0m 01/24 00:10:55 | Dataset: OfficeHome

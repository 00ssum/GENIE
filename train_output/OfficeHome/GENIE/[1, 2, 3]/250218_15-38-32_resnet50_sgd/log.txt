[37m[36mINFO[0m[0m 02/18 15:38:32 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 1 2 3 --dataset OfficeHome --trial_seed 1 --hparams_seed 20
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 20
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/OfficeHome/GENIE/[1, 2, 3]/250218_15-38-32_resnet50_sgd
	out_root: train_output/OfficeHome/GENIE/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 1
	unique_name: 250218_15-38-32_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 1.6701621650738547e-05
	batch_size: 28
	weight_decay: 2.09977539257237e-05
	momentum: 0.9323995445065565
	convergence_rate: 0.06623723551352119
	moving_avg: 0.9862532627566535
	p: 0.6377062156336589
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/18 15:38:32 | n_steps = 5001
[37m[36mINFO[0m[0m 02/18 15:38:32 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/18 15:38:32 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/18 15:38:32 | 
[37m[36mINFO[0m[0m 02/18 15:38:32 | Testenv name escaping te_C_P_R -> te_C_P_R
[37m[36mINFO[0m[0m 02/18 15:38:32 | Test envs = [1, 2, 3], name = te_C_P_R
[37m[36mINFO[0m[0m 02/18 15:38:32 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 02/18 15:38:32 | Batch sizes for each domain: [28, 0, 0, 0] (total=28)
[37m[36mINFO[0m[0m 02/18 15:38:32 | steps-per-epoch for each domain: 69.36 -> min = 69.36
[37m[36mINFO[0m[0m 02/18 15:38:33 | # of params = 23641217
[37m[36mINFO[0m[0m 02/18 15:40:27 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/18 15:40:27 | 0.040489    0.046813    0.074665    0.101031    4.195724    0.074665    0.101031    0.030641    0.050401    0.036036    0.036077    0.054791    0.053961    0           0.000000    4.091127    1.121586    112.822308 
[37m[36mINFO[0m[0m 02/18 15:43:21 | 0.219834    0.219125    0.414006    0.367010    2.566762    0.414006    0.367010    0.170103    0.189003    0.196227    0.190530    0.293173    0.277842    200         2.883625    3.346670    0.228562    128.729315 
[37m[36mINFO[0m[0m 02/18 15:46:10 | 0.253512    0.248712    0.466014    0.422680    2.340302    0.466014    0.422680    0.200745    0.199313    0.235923    0.232244    0.323867    0.314581    400         5.767250    2.123694    0.214435    126.178414 
[37m[36mINFO[0m[0m 02/18 15:48:43 | 0.336650    0.350716    0.648816    0.509278    2.008512    0.648816    0.509278    0.256873    0.300115    0.314752    0.311161    0.438325    0.440873    600         8.650875    1.693385    0.205270    111.396858 
[37m[36mINFO[0m[0m 02/18 15:51:41 | 0.327508    0.324686    0.670958    0.482474    2.263055    0.670958    0.482474    0.275487    0.289805    0.291948    0.313416    0.415089    0.370838    800         11.534501   1.282274    0.275664    123.057479 
[37m[36mINFO[0m[0m 02/18 15:54:22 | 0.322799    0.330470    0.731720    0.484536    2.395958    0.731720    0.484536    0.263746    0.269187    0.296734    0.308906    0.407917    0.413318    1000        14.418126   1.084989    0.197227    121.556643 
[37m[36mINFO[0m[0m 02/18 15:56:59 | 0.335136    0.326203    0.805355    0.486598    2.191459    0.805355    0.486598    0.257159    0.254296    0.312218    0.320180    0.436030    0.404133    1200        17.301751   0.889092    0.227341    111.275247 
[37m[36mINFO[0m[0m 02/18 15:59:42 | 0.371997    0.367704    0.858393    0.573196    2.110953    0.858393    0.573196    0.303265    0.308133    0.346002    0.348365    0.466724    0.446613    1400        20.185376   0.690075    0.241119    114.704121 
[37m[36mINFO[0m[0m 02/18 16:02:27 | 0.350012    0.340714    0.868177    0.536082    2.444598    0.868177    0.536082    0.278351    0.277205    0.331926    0.322435    0.439759    0.422503    1600        23.069001   0.528750    0.209664    123.594006 
[37m[36mINFO[0m[0m 02/18 16:04:59 | 0.366613    0.358180    0.908342    0.571134    2.248720    0.908342    0.571134    0.268328    0.278351    0.353885    0.344983    0.477625    0.451206    1800        25.952626   0.408991    0.224264    106.720927 
[37m[36mINFO[0m[0m 02/18 16:07:35 | 0.382897    0.371493    0.900618    0.569072    2.158041    0.900618    0.569072    0.284937    0.294387    0.378097    0.356257    0.485657    0.463835    2000        28.836251   0.385933    0.201081    116.224581 
[37m[36mINFO[0m[0m 02/18 16:10:42 | 0.383849    0.391995    0.922760    0.575258    2.185012    0.922760    0.575258    0.312142    0.318442    0.361205    0.379932    0.478199    0.477612    2200        31.719876   0.359489    0.368209    113.406899 
[37m[36mINFO[0m[0m 02/18 16:13:22 | 0.378836    0.381339    0.933574    0.579381    2.209301    0.933574    0.579381    0.286655    0.304696    0.369932    0.372041    0.479920    0.467279    2400        34.603502   0.260783    0.196810    120.347450 
[37m[36mINFO[0m[0m 02/18 16:16:00 | 0.385881    0.386165    0.936148    0.534021    2.977615    0.936148    0.534021    0.315006    0.318442    0.372185    0.394589    0.470453    0.445465    2600        37.487127   0.276593    0.224416    112.873194 
[37m[36mINFO[0m[0m 02/18 16:19:07 | 0.382548    0.389053    0.942842    0.548454    2.551610    0.942842    0.548454    0.326460    0.325315    0.353885    0.359639    0.467298    0.482204    2800        40.370752   0.195768    0.349140    116.959471 
[37m[36mINFO[0m[0m 02/18 16:21:56 | 0.378636    0.356311    0.952111    0.591753    2.258610    0.952111    0.591753    0.301833    0.264605    0.354730    0.339346    0.479346    0.464983    3000        43.254377   0.195911    0.224899    124.051888 
[37m[36mINFO[0m[0m 02/18 16:24:26 | 0.393251    0.389385    0.959835    0.546392    2.697588    0.959835    0.546392    0.326747    0.319588    0.369932    0.368658    0.483075    0.479908    3200        46.138002   0.216783    0.201698    110.061862 
[37m[36mINFO[0m[0m 02/18 16:27:30 | 0.387762    0.389702    0.952111    0.593814    2.132814    0.952111    0.593814    0.319874    0.333333    0.376689    0.377678    0.466724    0.458094    3400        49.021627   0.221897    0.292218    125.402576 
[37m[36mINFO[0m[0m 02/18 16:30:03 | 0.391674    0.388090    0.969619    0.587629    2.117406    0.969619    0.587629    0.314433    0.312715    0.378660    0.393461    0.481928    0.458094    3600        51.905252   0.214331    0.201371    113.202711 
[37m[36mINFO[0m[0m 02/18 16:32:57 | 0.405018    0.402222    0.968074    0.604124    2.733846    0.968074    0.604124    0.329611    0.331042    0.399212    0.395716    0.486231    0.479908    3800        54.788877   0.109176    0.295053    115.021852 
[37m[36mINFO[0m[0m 02/18 16:35:44 | 0.395562    0.388674    0.962925    0.546392    2.467184    0.962925    0.546392    0.308706    0.320733    0.384291    0.359639    0.493689    0.485649    4000        57.672503   0.116719    0.221456    122.659585 
[37m[36mINFO[0m[0m 02/18 16:38:26 | 0.388147    0.382544    0.974253    0.587629    2.544406    0.974253    0.587629    0.317297    0.319588    0.361486    0.360767    0.485657    0.467279    4200        60.556128   0.098781    0.207969    119.695039 
[37m[36mINFO[0m[0m 02/18 16:41:40 | 0.392800    0.407269    0.973223    0.554639    2.714772    0.973223    0.554639    0.320160    0.345934    0.381475    0.382187    0.476764    0.493685    4400        63.439753   0.111254    0.366456    120.903010 
[37m[36mINFO[0m[0m 02/18 16:44:11 | 0.391749    0.403324    0.973738    0.583505    2.336634    0.973738    0.583505    0.306701    0.319588    0.382601    0.404735    0.485944    0.485649    4600        66.323378   0.105616    0.201618    111.231215 
[37m[36mINFO[0m[0m 02/18 16:46:55 | 0.403122    0.404968    0.976828    0.604124    2.436913    0.976828    0.604124    0.329324    0.324170    0.381475    0.385569    0.498566    0.505166    4800        69.207003   0.098887    0.261976    111.711621 
[37m[36mINFO[0m[0m 02/18 16:49:53 | 0.355355    0.360017    0.973223    0.527835    2.740629    0.973223    0.527835    0.267182    0.278351    0.349944    0.357384    0.448939    0.444317    5000        72.090628   0.074863    0.260566    125.456746 
[37m[36mINFO[0m[0m 02/18 16:49:53 | Cumulative gradient change saved at train_output/OfficeHome/GENIE/[1, 2, 3]/250218_15-38-32_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/18 16:49:55 | ---
[37m[36mINFO[0m[0m 02/18 16:49:55 | test-domain validation(oracle) = 39.280%
[37m[36mINFO[0m[0m 02/18 16:49:55 | training-domain validation(iid) = 40.502%
[37m[36mINFO[0m[0m 02/18 16:49:55 | last = 35.535%
[37m[36mINFO[0m[0m 02/18 16:49:55 | last (inD) = 52.784%
[37m[36mINFO[0m[0m 02/18 16:49:55 | training-domain validation (iid, inD) = 60.412%
[37m[36mINFO[0m[0m 02/18 16:49:55 | === Summary ===
[37m[36mINFO[0m[0m 02/18 16:49:55 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 1 2 3 --dataset OfficeHome --trial_seed 1 --hparams_seed 20
[37m[36mINFO[0m[0m 02/18 16:49:55 | Unique name: 250218_15-38-32_resnet50_sgd
[37m[36mINFO[0m[0m 02/18 16:49:55 | Out path: train_output/OfficeHome/GENIE/[1, 2, 3]/250218_15-38-32_resnet50_sgd
[37m[36mINFO[0m[0m 02/18 16:49:55 | Algorithm: GENIE
[37m[36mINFO[0m[0m 02/18 16:49:55 | Dataset: OfficeHome

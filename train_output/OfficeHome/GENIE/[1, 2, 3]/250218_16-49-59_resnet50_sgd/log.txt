[37m[36mINFO[0m[0m 02/18 16:49:59 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 1 2 3 --dataset OfficeHome --trial_seed 2 --hparams_seed 20
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 20
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/OfficeHome/GENIE/[1, 2, 3]/250218_16-49-59_resnet50_sgd
	out_root: train_output/OfficeHome/GENIE/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 2
	unique_name: 250218_16-49-59_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 3.0575564760860844e-05
	batch_size: 27
	weight_decay: 7.45235722180653e-06
	momentum: 0.9155691328482434
	convergence_rate: 0.0010649367752129872
	moving_avg: 0.9675776324769427
	p: 0.6098595903853413
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/18 16:49:59 | n_steps = 5001
[37m[36mINFO[0m[0m 02/18 16:49:59 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/18 16:49:59 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/18 16:49:59 | 
[37m[36mINFO[0m[0m 02/18 16:49:59 | Testenv name escaping te_C_P_R -> te_C_P_R
[37m[36mINFO[0m[0m 02/18 16:49:59 | Test envs = [1, 2, 3], name = te_C_P_R
[37m[36mINFO[0m[0m 02/18 16:49:59 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 02/18 16:49:59 | Batch sizes for each domain: [27, 0, 0, 0] (total=27)
[37m[36mINFO[0m[0m 02/18 16:49:59 | steps-per-epoch for each domain: 71.93 -> min = 71.93
[37m[36mINFO[0m[0m 02/18 16:50:00 | # of params = 23641217
[37m[36mINFO[0m[0m 02/18 16:51:53 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/18 16:51:53 | 0.015577    0.012588    0.020082    0.024742    4.223620    0.020082    0.024742    0.017755    0.017182    0.014921    0.004510    0.014056    0.016073    0           0.000000    4.326030    1.366016    111.851038 
[37m[36mINFO[0m[0m 02/18 16:54:58 | 0.175190    0.175002    0.348095    0.303093    3.142901    0.348095    0.303093    0.146907    0.151203    0.151182    0.151071    0.227481    0.222732    200         2.780639    3.794342    0.381985    108.840929 
[37m[36mINFO[0m[0m 02/18 16:57:46 | 0.474640    0.473710    0.739959    0.591753    1.462989    0.739959    0.591753    0.356816    0.381443    0.485923    0.464487    0.581182    0.575201    400         5.561277    1.714960    0.220729    123.390482 
[37m[36mINFO[0m[0m 02/18 17:00:13 | 0.528646    0.532162    0.865602    0.647423    1.222034    0.865602    0.647423    0.392612    0.428408    0.561655    0.537768    0.631670    0.630310    600         8.341916    0.711281    0.197127    107.934600 
[37m[36mINFO[0m[0m 02/18 17:03:07 | 0.536629    0.523774    0.918641    0.674227    1.231085    0.918641    0.674227    0.397480    0.387171    0.568975    0.537768    0.643431    0.646383    800         11.122554   0.418485    0.274435    118.598127 
[37m[36mINFO[0m[0m 02/18 17:05:47 | 0.536506    0.532451    0.948507    0.696907    1.287528    0.948507    0.696907    0.373425    0.388316    0.575450    0.558061    0.660643    0.650976    1000        13.903193   0.244695    0.194396    121.066556 
[37m[36mINFO[0m[0m 02/18 17:08:28 | 0.548674    0.543065    0.962410    0.723711    1.306781    0.962410    0.723711    0.389462    0.395189    0.600507    0.573844    0.656053    0.660161    1200        16.683831   0.150568    0.299903    100.751249 
[37m[36mINFO[0m[0m 02/18 17:11:09 | 0.553351    0.552952    0.969619    0.727835    1.224834    0.969619    0.727835    0.394044    0.405498    0.601351    0.582864    0.664659    0.670494    1400        19.464470   0.115500    0.224080    117.085815 
[37m[36mINFO[0m[0m 02/18 17:13:47 | 0.551791    0.540093    0.972194    0.701031    1.353646    0.972194    0.701031    0.401203    0.395189    0.590372    0.559188    0.663798    0.665901    1600        22.245108   0.077610    0.199932    117.797105 
[37m[36mINFO[0m[0m 02/18 17:17:03 | 0.550477    0.552303    0.984037    0.709278    1.309166    0.984037    0.709278    0.403494    0.415808    0.586149    0.562570    0.661790    0.678530    1800        25.025747   0.082257    0.406196    114.691115 
[37m[36mINFO[0m[0m 02/18 17:19:43 | 0.554962    0.556049    0.966529    0.717526    1.455695    0.966529    0.717526    0.411798    0.413517    0.586993    0.576099    0.666093    0.678530    2000        27.806385   0.053823    0.216375    116.825630 
[37m[36mINFO[0m[0m 02/18 17:22:18 | 0.556613    0.549262    0.990731    0.736082    1.326346    0.990731    0.736082    0.406071    0.406644    0.598536    0.560316    0.665232    0.680827    2200        30.587024   0.051005    0.219402    111.315813 
[37m[36mINFO[0m[0m 02/18 17:25:18 | 0.560803    0.550757    0.992276    0.742268    1.305701    0.992276    0.742268    0.411512    0.408935    0.600788    0.565953    0.670109    0.677382    2400        33.367662   0.040249    0.256769    127.780653 
[37m[36mINFO[0m[0m 02/18 17:27:56 | 0.551949    0.548765    0.990216    0.723711    1.428432    0.990216    0.723711    0.390893    0.402062    0.596565    0.579481    0.668388    0.664753    2600        36.148301   0.036532    0.216650    115.227936 
[37m[36mINFO[0m[0m 02/18 17:30:46 | 0.561742    0.563661    0.991246    0.725773    1.370184    0.991246    0.725773    0.407503    0.404353    0.603885    0.583991    0.673838    0.702641    2800        38.928939   0.039640    0.257015    118.653728 
[37m[36mINFO[0m[0m 02/18 17:33:27 | 0.562258    0.561776    0.989701    0.727835    1.388337    0.989701    0.727835    0.419817    0.412371    0.596847    0.578354    0.670109    0.694604    3000        41.709578   0.037101    0.214126    117.995008 
[37m[36mINFO[0m[0m 02/18 17:35:57 | 0.567730    0.566356    0.992276    0.727835    1.271770    0.992276    0.727835    0.417812    0.428408    0.608671    0.578354    0.676707    0.692308    3200        44.490216   0.040202    0.216648    106.920483 
[37m[36mINFO[0m[0m 02/18 17:39:04 | 0.566974    0.559880    0.994336    0.744330    1.347432    0.994336    0.744330    0.423540    0.407789    0.606700    0.576099    0.670683    0.695752    3400        47.270855   0.022419    0.390389    108.380373 
[37m[36mINFO[0m[0m 02/18 17:42:01 | 0.566956    0.562163    0.993306    0.727835    1.377009    0.993306    0.727835    0.420676    0.398625    0.609797    0.579481    0.670396    0.708381    3600        50.051493   0.030490    0.197739    138.009562 
[37m[36mINFO[0m[0m 02/18 17:44:38 | 0.559533    0.558316    0.993821    0.719588    1.374543    0.993821    0.719588    0.402635    0.406644    0.605856    0.581736    0.670109    0.686567    3800        52.832132   0.028389    0.215390    113.364125 
[37m[36mINFO[0m[0m 02/18 17:47:47 | 0.555277    0.555310    0.992276    0.719588    1.252523    0.992276    0.719588    0.400916    0.405498    0.598536    0.572717    0.666380    0.687715    4000        55.612770   0.028547    0.415912    106.194817 
[37m[36mINFO[0m[0m 02/18 17:50:36 | 0.557970    0.548461    0.985582    0.694845    1.483523    0.985582    0.694845    0.414948    0.398625    0.594876    0.567080    0.664085    0.679679    4200        58.393409   0.030242    0.220730    125.054286 
[37m[36mINFO[0m[0m 02/18 17:53:19 | 0.563998    0.558774    0.992276    0.750515    1.309928    0.992276    0.750515    0.419530    0.415808    0.593750    0.568207    0.678715    0.692308    4400        61.174047   0.031543    0.225583    117.640392 
[37m[36mINFO[0m[0m 02/18 17:56:14 | 0.553096    0.557205    0.993306    0.744330    1.371379    0.993306    0.744330    0.403207    0.412371    0.595439    0.574972    0.660643    0.684271    4600        63.954686   0.022173    0.280360    118.790703 
[37m[36mINFO[0m[0m 02/18 17:58:50 | 0.570956    0.565610    0.995881    0.742268    1.350896    0.995881    0.742268    0.426976    0.412371    0.611768    0.577227    0.674125    0.707233    4800        66.735324   0.020177    0.195105    117.376590 
[37m[36mINFO[0m[0m 02/18 18:01:18 | 0.563742    0.558775    0.996910    0.740206    1.381899    0.996910    0.740206    0.415235    0.405498    0.604448    0.569335    0.671543    0.701493    5000        69.515963   0.021340    0.203605    107.136090 
[37m[36mINFO[0m[0m 02/18 18:01:18 | Cumulative gradient change saved at train_output/OfficeHome/GENIE/[1, 2, 3]/250218_16-49-59_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/18 18:01:20 | ---
[37m[36mINFO[0m[0m 02/18 18:01:20 | test-domain validation(oracle) = 56.773%
[37m[36mINFO[0m[0m 02/18 18:01:20 | training-domain validation(iid) = 56.400%
[37m[36mINFO[0m[0m 02/18 18:01:20 | last = 56.374%
[37m[36mINFO[0m[0m 02/18 18:01:20 | last (inD) = 74.021%
[37m[36mINFO[0m[0m 02/18 18:01:20 | training-domain validation (iid, inD) = 75.052%
[37m[36mINFO[0m[0m 02/18 18:01:20 | === Summary ===
[37m[36mINFO[0m[0m 02/18 18:01:20 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 1 2 3 --dataset OfficeHome --trial_seed 2 --hparams_seed 20
[37m[36mINFO[0m[0m 02/18 18:01:20 | Unique name: 250218_16-49-59_resnet50_sgd
[37m[36mINFO[0m[0m 02/18 18:01:20 | Out path: train_output/OfficeHome/GENIE/[1, 2, 3]/250218_16-49-59_resnet50_sgd
[37m[36mINFO[0m[0m 02/18 18:01:20 | Algorithm: GENIE
[37m[36mINFO[0m[0m 02/18 18:01:20 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 02/18 13:14:46 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 1 2 3 --dataset OfficeHome --trial_seed 2 --hparams_seed 6
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 6
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/OfficeHome/GENIE/[1, 2, 3]/250218_13-14-46_resnet50_sgd
	out_root: train_output/OfficeHome/GENIE/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 2
	unique_name: 250218_13-14-46_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 0.00020671063342821416
	batch_size: 9
	weight_decay: 0.00021810605040355685
	momentum: 0.983248094981694
	convergence_rate: 0.09526529734855639
	moving_avg: 0.9670582205613204
	p: 0.5926314552294079
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/18 13:14:46 | n_steps = 5001
[37m[36mINFO[0m[0m 02/18 13:14:46 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/18 13:14:46 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/18 13:14:46 | 
[37m[36mINFO[0m[0m 02/18 13:14:46 | Testenv name escaping te_C_P_R -> te_C_P_R
[37m[36mINFO[0m[0m 02/18 13:14:46 | Test envs = [1, 2, 3], name = te_C_P_R
[37m[36mINFO[0m[0m 02/18 13:14:46 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 02/18 13:14:46 | Batch sizes for each domain: [9, 0, 0, 0] (total=9)
[37m[36mINFO[0m[0m 02/18 13:14:46 | steps-per-epoch for each domain: 215.78 -> min = 215.78
[37m[36mINFO[0m[0m 02/18 13:14:49 | # of params = 23641217
[37m[36mINFO[0m[0m 02/18 13:16:50 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/18 13:16:50 | 0.018606    0.023906    0.016478    0.024742    9.472307    0.016478    0.024742    0.020332    0.032073    0.019707    0.029312    0.015777    0.010333    0           0.000000    4.329090    3.348034    117.810661 
[37m[36mINFO[0m[0m 02/18 13:19:35 | 0.016143    0.020897    0.030896    0.028866    nan         0.030896    0.028866    0.012600    0.018328    0.016610    0.022548    0.019220    0.021814    200         0.926880    nan         0.147220    135.887776 
[37m[36mINFO[0m[0m 02/18 13:22:10 | 0.016143    0.020897    0.030896    0.028866    nan         0.030896    0.028866    0.012600    0.018328    0.016610    0.022548    0.019220    0.021814    400         1.853759    nan         0.177130    119.760470 
[37m[36mINFO[0m[0m 02/18 13:24:54 | 0.016143    0.020897    0.030896    0.028866    nan         0.030896    0.028866    0.012600    0.018328    0.016610    0.022548    0.019220    0.021814    600         2.780639    nan         0.186507    125.831208 
[37m[36mINFO[0m[0m 02/18 13:27:49 | 0.016143    0.020897    0.030896    0.028866    nan         0.030896    0.028866    0.012600    0.018328    0.016610    0.022548    0.019220    0.021814    800         3.707518    nan         0.139986    147.312075 
[37m[36mINFO[0m[0m 02/18 13:30:41 | 0.016143    0.020897    0.030896    0.028866    nan         0.030896    0.028866    0.012600    0.018328    0.016610    0.022548    0.019220    0.021814    1000        4.634398    nan         0.235717    124.660619 
[37m[36mINFO[0m[0m 02/18 13:33:16 | 0.016143    0.020897    0.030896    0.028866    nan         0.030896    0.028866    0.012600    0.018328    0.016610    0.022548    0.019220    0.021814    1200        5.561277    nan         0.201243    115.153467 
[37m[36mINFO[0m[0m 02/18 13:36:15 | 0.016143    0.020897    0.030896    0.028866    nan         0.030896    0.028866    0.012600    0.018328    0.016610    0.022548    0.019220    0.021814    1400        6.488157    nan         0.177153    143.372850 
[37m[36mINFO[0m[0m 02/18 13:38:59 | 0.016143    0.020897    0.030896    0.028866    nan         0.030896    0.028866    0.012600    0.018328    0.016610    0.022548    0.019220    0.021814    1600        7.415036    nan         0.210038    122.120719 
[37m[36mINFO[0m[0m 02/18 13:41:34 | 0.016143    0.020897    0.030896    0.028866    nan         0.030896    0.028866    0.012600    0.018328    0.016610    0.022548    0.019220    0.021814    1800        8.341916    nan         0.178946    119.251391 
[37m[36mINFO[0m[0m 02/18 13:44:12 | 0.016143    0.020897    0.030896    0.028866    nan         0.030896    0.028866    0.012600    0.018328    0.016610    0.022548    0.019220    0.021814    2000        9.268795    nan         0.142837    129.017244 
[37m[36mINFO[0m[0m 02/18 13:47:01 | 0.016143    0.020897    0.030896    0.028866    nan         0.030896    0.028866    0.012600    0.018328    0.016610    0.022548    0.019220    0.021814    2200        10.195675   nan         0.236461    121.827913 
[37m[36mINFO[0m[0m 02/18 13:49:36 | 0.016143    0.020897    0.030896    0.028866    nan         0.030896    0.028866    0.012600    0.018328    0.016610    0.022548    0.019220    0.021814    2400        11.122554   nan         0.155125    124.179166 
[37m[36mINFO[0m[0m 02/18 13:52:07 | 0.016143    0.020897    0.030896    0.028866    nan         0.030896    0.028866    0.012600    0.018328    0.016610    0.022548    0.019220    0.021814    2600        12.049434   nan         0.170996    116.906690 
[37m[36mINFO[0m[0m 02/18 13:54:57 | 0.016143    0.020897    0.030896    0.028866    nan         0.030896    0.028866    0.012600    0.018328    0.016610    0.022548    0.019220    0.021814    2800        12.976313   nan         0.249472    119.959041 
[37m[36mINFO[0m[0m 02/18 13:57:38 | 0.016143    0.020897    0.030896    0.028866    nan         0.030896    0.028866    0.012600    0.018328    0.016610    0.022548    0.019220    0.021814    3000        13.903193   nan         0.162089    128.905195 
[37m[36mINFO[0m[0m 02/18 14:00:13 | 0.016143    0.020897    0.030896    0.028866    nan         0.030896    0.028866    0.012600    0.018328    0.016610    0.022548    0.019220    0.021814    3200        14.830072   nan         0.190378    116.189913 
[37m[36mINFO[0m[0m 02/18 14:03:19 | 0.016143    0.020897    0.030896    0.028866    nan         0.030896    0.028866    0.012600    0.018328    0.016610    0.022548    0.019220    0.021814    3400        15.756952   nan         0.281067    129.816493 
[37m[36mINFO[0m[0m 02/18 14:06:05 | 0.016143    0.020897    0.030896    0.028866    nan         0.030896    0.028866    0.012600    0.018328    0.016610    0.022548    0.019220    0.021814    3600        16.683831   nan         0.156295    134.936955 
[37m[36mINFO[0m[0m 02/18 14:08:34 | 0.016143    0.020897    0.030896    0.028866    nan         0.030896    0.028866    0.012600    0.018328    0.016610    0.022548    0.019220    0.021814    3800        17.610711   nan         0.140034    120.700680 
[37m[36mINFO[0m[0m 02/18 14:11:18 | 0.016143    0.020897    0.030896    0.028866    nan         0.030896    0.028866    0.012600    0.018328    0.016610    0.022548    0.019220    0.021814    4000        18.537590   nan         0.174472    129.929432 
[37m[36mINFO[0m[0m 02/18 14:14:14 | 0.016143    0.020897    0.030896    0.028866    nan         0.030896    0.028866    0.012600    0.018328    0.016610    0.022548    0.019220    0.021814    4200        19.464470   nan         0.139720    147.618871 
[37m[36mINFO[0m[0m 02/18 14:16:32 | 0.016143    0.020897    0.030896    0.028866    nan         0.030896    0.028866    0.012600    0.018328    0.016610    0.022548    0.019220    0.021814    4400        20.391349   nan         0.134726    110.828092 
[37m[36mINFO[0m[0m 02/18 14:19:01 | 0.016143    0.020897    0.030896    0.028866    nan         0.030896    0.028866    0.012600    0.018328    0.016610    0.022548    0.019220    0.021814    4600        21.318229   nan         0.180857    112.872719 
[37m[36mINFO[0m[0m 02/18 14:21:39 | 0.016143    0.020897    0.030896    0.028866    nan         0.030896    0.028866    0.012600    0.018328    0.016610    0.022548    0.019220    0.021814    4800        22.245108   nan         0.140929    129.659503 
[37m[36mINFO[0m[0m 02/18 14:24:18 | 0.016143    0.020897    0.030896    0.028866    nan         0.030896    0.028866    0.012600    0.018328    0.016610    0.022548    0.019220    0.021814    5000        23.171988   nan         0.275800    104.158449 
[37m[36mINFO[0m[0m 02/18 14:24:18 | Cumulative gradient change saved at train_output/OfficeHome/GENIE/[1, 2, 3]/250218_13-14-46_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/18 14:24:20 | ---
[37m[36mINFO[0m[0m 02/18 14:24:20 | test-domain validation(oracle) = 1.861%
[37m[36mINFO[0m[0m 02/18 14:24:20 | training-domain validation(iid) = 1.614%
[37m[36mINFO[0m[0m 02/18 14:24:20 | last = 1.614%
[37m[36mINFO[0m[0m 02/18 14:24:20 | last (inD) = 2.887%
[37m[36mINFO[0m[0m 02/18 14:24:20 | training-domain validation (iid, inD) = 2.887%
[37m[36mINFO[0m[0m 02/18 14:24:20 | === Summary ===
[37m[36mINFO[0m[0m 02/18 14:24:20 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 1 2 3 --dataset OfficeHome --trial_seed 2 --hparams_seed 6
[37m[36mINFO[0m[0m 02/18 14:24:20 | Unique name: 250218_13-14-46_resnet50_sgd
[37m[36mINFO[0m[0m 02/18 14:24:20 | Out path: train_output/OfficeHome/GENIE/[1, 2, 3]/250218_13-14-46_resnet50_sgd
[37m[36mINFO[0m[0m 02/18 14:24:20 | Algorithm: GENIE
[37m[36mINFO[0m[0m 02/18 14:24:20 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 03/15 02:53:01 | Command :: /jsm0707/GENIE/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm GENIE --test_envs 3 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_adam.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_adam
	out_dir: train_output/OfficeHome/GENIE/[3]/250315_02-53-01_resnet50_adam
	out_root: train_output/OfficeHome/GENIE/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250315_02-53-01_resnet50_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	momentum: 0.9
	convergence_rate: 0.015
	moving_avg: 0.95
	p: 0.4
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/15 02:53:01 | n_steps = 5001
[37m[36mINFO[0m[0m 03/15 02:53:01 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/15 02:53:01 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/15 02:53:01 | 
[37m[36mINFO[0m[0m 03/15 02:53:01 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 03/15 02:53:01 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 03/15 02:53:01 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/15 02:53:01 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 03/15 02:53:01 | steps-per-epoch for each domain: 60.69, 109.12, 111.00 -> min = 60.69
[37m[36mINFO[0m[0m 03/15 02:53:02 | # of params = 23641217
[37m[36mINFO[0m[0m 03/15 02:55:01 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/15 02:55:01 | 0.018933    0.022962    0.014632    0.012305    4.223736    0.020082    0.016495    0.009737    0.008018    0.014077    0.012401    0.018933    0.022962    0           0.000000    4.305778    1.235347    117.618399 
[37m[36mINFO[0m[0m 03/15 02:57:54 | 0.735513    0.731343    0.789424    0.717467    1.064438    0.790422    0.711340    0.741982    0.658648    0.835867    0.782413    0.735513    0.731343    200         3.295572    1.636499    0.283842    115.690589 
[37m[36mINFO[0m[0m 03/15 03:00:37 | 0.763339    0.758898    0.874541    0.763551    0.949717    0.880021    0.734021    0.837915    0.695304    0.905687    0.861330    0.763339    0.758898    400         6.591143    0.538147    0.249066    113.511717 
[37m[36mINFO[0m[0m 03/15 03:03:33 | 0.756168    0.752009    0.916453    0.769026    0.951723    0.937178    0.709278    0.881157    0.731959    0.931025    0.865840    0.756168    0.752009    600         9.886715    0.368478    0.286324    118.852108 
[37m[36mINFO[0m[0m 03/15 03:06:21 | 0.753586    0.735936    0.931405    0.780850    0.975818    0.949022    0.740206    0.902062    0.734250    0.943131    0.868095    0.753586    0.735936    800         13.182286   0.257925    0.266792    114.054588 
[37m[36mINFO[0m[0m 03/15 03:09:12 | 0.751578    0.749713    0.946477    0.775669    1.058076    0.959835    0.736082    0.922108    0.725086    0.957489    0.865840    0.751578    0.749713    1000        16.477858   0.188739    0.282579    115.242938 
[37m[36mINFO[0m[0m 03/15 03:12:04 | 0.758462    0.758898    0.962151    0.781636    1.068865    0.975283    0.738144    0.941294    0.728522    0.969876    0.878241    0.758462    0.758898    1200        19.773429   0.145719    0.281087    115.045604 
[37m[36mINFO[0m[0m 03/15 03:14:51 | 0.772806    0.762342    0.970891    0.799288    0.999261    0.985582    0.767010    0.950458    0.754868    0.976633    0.875986    0.772806    0.762342    1400        23.069001   0.114224    0.250241    117.234180 
[37m[36mINFO[0m[0m 03/15 03:18:18 | 0.775100    0.765786    0.976068    0.796360    1.036832    0.989186    0.750515    0.956472    0.743414    0.982545    0.895152    0.775100    0.765786    1600        26.364573   0.101473    0.442387    118.509780 
[37m[36mINFO[0m[0m 03/15 03:21:31 | 0.777969    0.762342    0.978749    0.790922    1.124167    0.988671    0.744330    0.963058    0.744559    0.984516    0.883878    0.777969    0.762342    1800        29.660144   0.086153    0.371448    118.629194 
[37m[36mINFO[0m[0m 03/15 03:24:29 | 0.765921    0.764638    0.974601    0.785995    1.147748    0.985582    0.734021    0.959336    0.746850    0.978885    0.877114    0.765921    0.764638    2000        32.955716   0.075601    0.303866    116.948824 
[37m[36mINFO[0m[0m 03/15 03:27:16 | 0.772806    0.750861    0.979969    0.795263    1.082431    0.988671    0.750515    0.963058    0.749141    0.988176    0.886133    0.772806    0.750861    2200        36.251287   0.069755    0.250774    116.962504 
[37m[36mINFO[0m[0m 03/15 03:30:02 | 0.777108    0.761194    0.982959    0.794441    1.155067    0.990731    0.742268    0.972222    0.758305    0.985923    0.882751    0.777108    0.761194    2400        39.546859   0.050608    0.256012    115.131118 
[37m[36mINFO[0m[0m 03/15 03:32:51 | 0.769076    0.757750    0.981744    0.801678    1.149387    0.991761    0.762887    0.962199    0.756014    0.991273    0.886133    0.769076    0.757750    2600        42.842430   0.064604    0.244837    120.300539 
[37m[36mINFO[0m[0m 03/15 03:35:38 | 0.776822    0.753157    0.980069    0.796069    1.218138    0.984037    0.750515    0.971936    0.759450    0.984234    0.878241    0.776822    0.753157    2800        46.138002   0.054068    0.241719    118.077314 
[37m[36mINFO[0m[0m 03/15 03:38:28 | 0.758462    0.750861    0.984355    0.789459    1.283172    0.989186    0.731959    0.978236    0.750286    0.985642    0.886133    0.758462    0.750861    3000        49.433574   0.051330    0.262658    117.849276 
[37m[36mINFO[0m[0m 03/15 03:41:33 | 0.785141    0.770379    0.986593    0.802751    1.153052    0.992276    0.752577    0.976231    0.756014    0.991273    0.899662    0.785141    0.770379    3200        52.729145   0.045834    0.348875    115.431188 
[37m[36mINFO[0m[0m 03/15 03:44:56 | 0.777682    0.784156    0.986046    0.812644    1.171858    0.989186    0.775258    0.978522    0.770905    0.990428    0.891770    0.777682    0.784156    3400        56.024717   0.041772    0.429822    116.692958 
[37m[36mINFO[0m[0m 03/15 03:48:05 | 0.781698    0.773823    0.987438    0.802341    1.170652    0.992276    0.754639    0.976231    0.761741    0.993806    0.890643    0.781698    0.773823    3600        59.320288   0.038638    0.373193    114.167986 
[37m[36mINFO[0m[0m 03/15 03:50:59 | 0.785141    0.768083    0.987993    0.792178    1.303103    0.992791    0.729897    0.977663    0.754868    0.993525    0.891770    0.785141    0.768083    3800        62.615860   0.036841    0.287190    116.301535 
[37m[36mINFO[0m[0m 03/15 03:53:47 | 0.777395    0.766935    0.990807    0.793758    1.303086    0.993821    0.727835    0.983104    0.757159    0.995495    0.896280    0.777395    0.766935    4000        65.911432   0.030442    0.258174    116.941979 
[37m[36mINFO[0m[0m 03/15 03:56:36 | 0.769363    0.765786    0.990945    0.805090    1.275140    0.995366    0.752577    0.982818    0.772050    0.994651    0.890643    0.769363    0.765786    4200        69.207003   0.032110    0.245706    119.825305 
[37m[36mINFO[0m[0m 03/15 03:59:23 | 0.781698    0.758898    0.990362    0.803557    1.263511    0.995881    0.752577    0.982245    0.766323    0.992962    0.891770    0.781698    0.758898    4400        72.502575   0.031857    0.244426    118.481448 
[37m[36mINFO[0m[0m 03/15 04:02:08 | 0.782846    0.772675    0.989762    0.803774    1.231927    0.993821    0.746392    0.980813    0.770905    0.994651    0.894025    0.782846    0.772675    4600        75.798146   0.033971    0.247692    114.968688 
[37m[36mINFO[0m[0m 03/15 04:05:09 | 0.784280    0.769231    0.990485    0.799596    1.233977    0.994851    0.734021    0.981672    0.760596    0.994932    0.904171    0.784280    0.769231    4800        79.093718   0.029882    0.313114    118.517200 
[37m[36mINFO[0m[0m 03/15 04:08:29 | 0.775674    0.771527    0.990987    0.796473    1.161240    0.996910    0.738144    0.982245    0.762887    0.993806    0.888388    0.775674    0.771527    5000        82.389289   0.028406    0.406584    118.389342 
[37m[36mINFO[0m[0m 03/15 04:08:29 | Cumulative gradient change saved at train_output/OfficeHome/GENIE/[3]/250315_02-53-01_resnet50_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/15 04:08:30 | ---
[37m[36mINFO[0m[0m 03/15 04:08:30 | test-domain validation(oracle) = 77.768%
[37m[36mINFO[0m[0m 03/15 04:08:30 | training-domain validation(iid) = 77.768%
[37m[36mINFO[0m[0m 03/15 04:08:30 | last = 77.567%
[37m[36mINFO[0m[0m 03/15 04:08:30 | last (inD) = 79.647%
[37m[36mINFO[0m[0m 03/15 04:08:30 | training-domain validation (iid, inD) = 81.264%
[37m[36mINFO[0m[0m 03/15 04:08:31 | === Summary ===
[37m[36mINFO[0m[0m 03/15 04:08:31 | Command: /jsm0707/GENIE/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm GENIE --test_envs 3 --dataset OfficeHome
[37m[36mINFO[0m[0m 03/15 04:08:31 | Unique name: 250315_02-53-01_resnet50_adam
[37m[36mINFO[0m[0m 03/15 04:08:31 | Out path: train_output/OfficeHome/GENIE/[3]/250315_02-53-01_resnet50_adam
[37m[36mINFO[0m[0m 03/15 04:08:31 | Algorithm: GENIE
[37m[36mINFO[0m[0m 03/15 04:08:31 | Dataset: OfficeHome

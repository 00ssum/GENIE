[37m[36mINFO[0m[0m 03/14 00:18:18 | Command :: /jsm0707/GENIE/train_all.py resnet50_signum config/resnet50_signum.yaml --algorithm GENIE --test_envs 3 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_signum.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_signum
	out_dir: train_output/OfficeHome/GENIE/[3]/250314_00-18-18_resnet50_signum
	out_root: train_output/OfficeHome/GENIE/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250314_00-18-18_resnet50_signum
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: signum
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	momentum: 0.9
	convergence_rate: 0.015
	moving_avg: 0.95
	p: 0.4
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/14 00:18:18 | n_steps = 5001
[37m[36mINFO[0m[0m 03/14 00:18:18 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/14 00:18:18 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/14 00:18:18 | 
[37m[36mINFO[0m[0m 03/14 00:18:18 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 03/14 00:18:18 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 03/14 00:18:18 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/14 00:18:18 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 03/14 00:18:18 | steps-per-epoch for each domain: 60.69, 109.12, 111.00 -> min = 60.69
[37m[36mINFO[0m[0m 03/14 00:18:19 | # of params = 23641217
[37m[36mINFO[0m[0m 03/14 00:20:17 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/14 00:20:17 | 0.018933    0.022962    0.014632    0.012305    4.223736    0.020082    0.016495    0.009737    0.008018    0.014077    0.012401    0.018933    0.022962    0           0.000000    4.305778    1.084220    116.665918 
[37m[36mINFO[0m[0m 03/14 00:23:08 | 0.735513    0.731343    0.789424    0.717467    1.064438    0.790422    0.711340    0.741982    0.658648    0.835867    0.782413    0.735513    0.731343    200         3.295572    1.636499    0.275339    115.439435 
[37m[36mINFO[0m[0m 03/14 00:25:59 | 0.763339    0.758898    0.874541    0.763551    0.949717    0.880021    0.734021    0.837915    0.695304    0.905687    0.861330    0.763339    0.758898    400         6.591143    0.538147    0.286816    113.832592 
[37m[36mINFO[0m[0m 03/14 00:28:46 | 0.756168    0.752009    0.916453    0.769026    0.951723    0.937178    0.709278    0.881157    0.731959    0.931025    0.865840    0.756168    0.752009    600         9.886715    0.368478    0.261667    114.854520 
[37m[36mINFO[0m[0m 03/14 00:31:37 | 0.753586    0.735936    0.931405    0.780850    0.975818    0.949022    0.740206    0.902062    0.734250    0.943131    0.868095    0.753586    0.735936    800         13.182286   0.257925    0.284778    114.322228 
[37m[36mINFO[0m[0m 03/14 00:34:27 | 0.751578    0.749713    0.946477    0.775669    1.058076    0.959835    0.736082    0.922108    0.725086    0.957489    0.865840    0.751578    0.749713    1000        16.477858   0.188739    0.264279    117.001740 
[37m[36mINFO[0m[0m 03/14 00:37:20 | 0.758462    0.758898    0.962151    0.781636    1.068865    0.975283    0.738144    0.941294    0.728522    0.969876    0.878241    0.758462    0.758898    1200        19.773429   0.145719    0.286250    115.170084 
[37m[36mINFO[0m[0m 03/14 00:40:03 | 0.772806    0.762342    0.970891    0.799288    0.999261    0.985582    0.767010    0.950458    0.754868    0.976633    0.875986    0.772806    0.762342    1400        23.069001   0.114224    0.249783    113.231633 
[37m[36mINFO[0m[0m 03/14 00:43:06 | 0.775100    0.765786    0.976068    0.796360    1.036832    0.989186    0.750515    0.956472    0.743414    0.982545    0.895152    0.775100    0.765786    1600        26.364573   0.101473    0.352118    112.496004 
[37m[36mINFO[0m[0m 03/14 00:45:55 | 0.777969    0.762342    0.978749    0.790922    1.124167    0.988671    0.744330    0.963058    0.744559    0.984516    0.883878    0.777969    0.762342    1800        29.660144   0.086153    0.274902    114.045459 
[37m[36mINFO[0m[0m 03/14 00:48:40 | 0.765921    0.764638    0.974601    0.785995    1.147748    0.985582    0.734021    0.959336    0.746850    0.978885    0.877114    0.765921    0.764638    2000        32.955716   0.075601    0.252206    115.114439 
[37m[36mINFO[0m[0m 03/14 00:51:28 | 0.772806    0.750861    0.979969    0.795263    1.082431    0.988671    0.750515    0.963058    0.749141    0.988176    0.886133    0.772806    0.750861    2200        36.251287   0.069755    0.247687    117.777455 
[37m[36mINFO[0m[0m 03/14 00:54:12 | 0.777108    0.761194    0.982959    0.794441    1.155067    0.990731    0.742268    0.972222    0.758305    0.985923    0.882751    0.777108    0.761194    2400        39.546859   0.050608    0.242400    116.332129 
[37m[36mINFO[0m[0m 03/14 00:56:52 | 0.769076    0.757750    0.981744    0.801678    1.149387    0.991761    0.762887    0.962199    0.756014    0.991273    0.886133    0.769076    0.757750    2600        42.842430   0.064604    0.233524    113.000808 
[37m[36mINFO[0m[0m 03/14 00:59:35 | 0.776822    0.753157    0.980069    0.796069    1.218138    0.984037    0.750515    0.971936    0.759450    0.984234    0.878241    0.776822    0.753157    2800        46.138002   0.054068    0.233383    116.025913 
[37m[36mINFO[0m[0m 03/14 01:02:30 | 0.758462    0.750861    0.984355    0.789459    1.283172    0.989186    0.731959    0.978236    0.750286    0.985642    0.886133    0.758462    0.750861    3000        49.433574   0.051330    0.304885    114.023705 
[37m[36mINFO[0m[0m 03/14 01:05:43 | 0.785141    0.770379    0.986593    0.802751    1.153052    0.992276    0.752577    0.976231    0.756014    0.991273    0.899662    0.785141    0.770379    3200        52.729145   0.045834    0.399018    113.318300 
[37m[36mINFO[0m[0m 03/14 01:09:06 | 0.777682    0.784156    0.986046    0.812644    1.171858    0.989186    0.775258    0.978522    0.770905    0.990428    0.891770    0.777682    0.784156    3400        56.024717   0.041772    0.423898    118.102167 
[37m[36mINFO[0m[0m 03/14 01:12:16 | 0.781698    0.773823    0.987438    0.802341    1.170652    0.992276    0.754639    0.976231    0.761741    0.993806    0.890643    0.781698    0.773823    3600        59.320288   0.038638    0.373644    115.877887 
[37m[36mINFO[0m[0m 03/14 01:15:13 | 0.785141    0.768083    0.987993    0.792178    1.303103    0.992791    0.729897    0.977663    0.754868    0.993525    0.891770    0.785141    0.768083    3800        62.615860   0.036841    0.309560    114.671014 
[37m[36mINFO[0m[0m 03/14 01:17:56 | 0.777395    0.766935    0.990807    0.793758    1.303086    0.993821    0.727835    0.983104    0.757159    0.995495    0.896280    0.777395    0.766935    4000        65.911432   0.030442    0.244733    113.703688 
[37m[36mINFO[0m[0m 03/14 01:20:37 | 0.769363    0.765786    0.990945    0.805090    1.275140    0.995366    0.752577    0.982818    0.772050    0.994651    0.890643    0.769363    0.765786    4200        69.207003   0.032110    0.241347    112.874229 
[37m[36mINFO[0m[0m 03/14 01:23:19 | 0.781698    0.758898    0.990362    0.803557    1.263511    0.995881    0.752577    0.982245    0.766323    0.992962    0.891770    0.781698    0.758898    4400        72.502575   0.031857    0.241313    113.917744 
[37m[36mINFO[0m[0m 03/14 01:26:01 | 0.782846    0.772675    0.989762    0.803774    1.231927    0.993821    0.746392    0.980813    0.770905    0.994651    0.894025    0.782846    0.772675    4600        75.798146   0.033971    0.234664    115.199910 
[37m[36mINFO[0m[0m 03/14 01:28:41 | 0.784280    0.769231    0.990485    0.799596    1.233977    0.994851    0.734021    0.981672    0.760596    0.994932    0.904171    0.784280    0.769231    4800        79.093718   0.029882    0.235312    112.655805 
[37m[36mINFO[0m[0m 03/14 01:31:33 | 0.775674    0.771527    0.990987    0.796473    1.161240    0.996910    0.738144    0.982245    0.762887    0.993806    0.888388    0.775674    0.771527    5000        82.389289   0.028406    0.291946    114.144363 
[37m[36mINFO[0m[0m 03/14 01:31:34 | Cumulative gradient change saved at train_output/OfficeHome/GENIE/[3]/250314_00-18-18_resnet50_signum/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/14 01:31:35 | ---
[37m[36mINFO[0m[0m 03/14 01:31:35 | test-domain validation(oracle) = 77.768%
[37m[36mINFO[0m[0m 03/14 01:31:35 | training-domain validation(iid) = 77.768%
[37m[36mINFO[0m[0m 03/14 01:31:35 | last = 77.567%
[37m[36mINFO[0m[0m 03/14 01:31:35 | last (inD) = 79.647%
[37m[36mINFO[0m[0m 03/14 01:31:35 | training-domain validation (iid, inD) = 81.264%
[37m[36mINFO[0m[0m 03/14 01:31:35 | === Summary ===
[37m[36mINFO[0m[0m 03/14 01:31:35 | Command: /jsm0707/GENIE/train_all.py resnet50_signum config/resnet50_signum.yaml --algorithm GENIE --test_envs 3 --dataset OfficeHome
[37m[36mINFO[0m[0m 03/14 01:31:35 | Unique name: 250314_00-18-18_resnet50_signum
[37m[36mINFO[0m[0m 03/14 01:31:35 | Out path: train_output/OfficeHome/GENIE/[3]/250314_00-18-18_resnet50_signum
[37m[36mINFO[0m[0m 03/14 01:31:35 | Algorithm: GENIE
[37m[36mINFO[0m[0m 03/14 01:31:35 | Dataset: OfficeHome

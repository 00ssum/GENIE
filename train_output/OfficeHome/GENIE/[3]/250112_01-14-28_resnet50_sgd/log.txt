[37m[36mINFO[0m[0m 01/12 01:14:28 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm gsnr1224 --test_envs 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 20
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: gsnr1224
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 20
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/OfficeHome/gsnr1224/[3]/250112_01-14-28_resnet50_sgd
	out_root: train_output/OfficeHome/gsnr1224/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250112_01-14-28_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 2.6157673767852512e-05
	batch_size: 32
	weight_decay: 1.110622050999988e-05
	momentum: 0.8046004195437085
	convergence_rate: 0.0010908695544732698
	moving_avg: 0.9447089904071476
	p: 0.5550574176650049
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 01/12 01:14:28 | n_steps = 5001
[37m[36mINFO[0m[0m 01/12 01:14:28 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/12 01:14:28 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/12 01:14:28 | Target test envs = [[3]]
[37m[36mINFO[0m[0m 01/12 01:14:28 | 
[37m[36mINFO[0m[0m 01/12 01:14:28 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 01/12 01:14:28 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 01/12 01:14:28 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 01/12 01:14:28 | steps-per-epoch for each domain: 60.69, 109.12, 111.00 -> min = 60.69
[37m[36mINFO[0m[0m 01/12 01:14:29 | # of params = 23641217
[37m[36mINFO[0m[0m 01/12 01:16:28 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/12 01:16:28 | 0.014917    0.018370    0.011588    0.007912    4.268957    0.018538    0.012371    0.010596    0.005727    0.005631    0.005637    0.014917    0.018370    0           0.000000    4.414792    1.740633    116.788090 
[37m[36mINFO[0m[0m 01/12 01:19:24 | 0.121916    0.110218    0.128091    0.132743    3.958970    0.142636    0.136082    0.104811    0.108820    0.136824    0.153326    0.121916    0.110218    200         3.295572    4.120684    0.251772    125.624511 
[37m[36mINFO[0m[0m 01/12 01:22:19 | 0.447217    0.450057    0.443488    0.433401    2.555663    0.429969    0.397938    0.392612    0.379152    0.507883    0.523112    0.447217    0.450057    400         6.591143    3.595601    0.254054    123.808135 
[37m[36mINFO[0m[0m 01/12 01:25:23 | 0.702524    0.688863    0.657019    0.642925    1.405075    0.631308    0.639175    0.596506    0.562428    0.743243    0.727170    0.702524    0.688863    600         9.886715    2.214952    0.329047    118.227740 
[37m[36mINFO[0m[0m 01/12 01:28:39 | 0.744119    0.727899    0.731527    0.697936    1.158605    0.723481    0.692784    0.672394    0.621993    0.798705    0.779030    0.744119    0.727899    800         13.182286   1.591373    0.403166    115.137750 
[37m[36mINFO[0m[0m 01/12 01:31:56 | 0.768789    0.753157    0.764306    0.726852    1.026818    0.755922    0.723711    0.706758    0.658648    0.830236    0.798196    0.768789    0.753157    1000        16.477858   1.280724    0.404158    115.276283 
[37m[36mINFO[0m[0m 01/12 01:35:20 | 0.775674    0.766935    0.790043    0.736896    0.955033    0.787333    0.740206    0.734822    0.665521    0.847973    0.804961    0.775674    0.766935    1200        19.773429   1.115551    0.410389    121.901018 
[37m[36mINFO[0m[0m 01/12 01:38:37 | 0.786575    0.773823    0.811132    0.759367    0.898283    0.815654    0.758763    0.753723    0.689576    0.864020    0.829763    0.786575    0.773823    1400        23.069001   0.986644    0.405329    115.217857 
[37m[36mINFO[0m[0m 01/12 01:41:56 | 0.788009    0.779564    0.829682    0.763931    0.870140    0.838826    0.758763    0.776346    0.699885    0.873874    0.833145    0.788009    0.779564    1600        26.364573   0.873289    0.397988    118.885808 
[37m[36mINFO[0m[0m 01/12 01:45:14 | 0.793460    0.791045    0.841867    0.765139    0.851952    0.850669    0.744330    0.789233    0.701031    0.885698    0.850056    0.793460    0.791045    1800        29.660144   0.789239    0.395422    119.173405 
[37m[36mINFO[0m[0m 01/12 01:48:26 | 0.795754    0.779564    0.855579    0.771067    0.840147    0.868177    0.760825    0.804696    0.711340    0.893863    0.841037    0.795754    0.779564    2000        32.955716   0.724746    0.375062    116.146356 
[37m[36mINFO[0m[0m 01/12 01:51:35 | 0.795468    0.777268    0.867335    0.774849    0.819642    0.881050    0.750515    0.813860    0.726231    0.907095    0.847802    0.795468    0.777268    2200        36.251287   0.669389    0.364470    116.099733 
[37m[36mINFO[0m[0m 01/12 01:54:50 | 0.801779    0.792193    0.880487    0.782496    0.809812    0.893409    0.758763    0.834765    0.728522    0.913288    0.860203    0.801779    0.792193    2400        39.546859   0.597035    0.374186    119.148329 
[37m[36mINFO[0m[0m 01/12 01:58:01 | 0.801492    0.780712    0.886610    0.786067    0.806509    0.899588    0.764948    0.839633    0.729668    0.920608    0.863585    0.801492    0.780712    2600        42.842430   0.587912    0.370547    117.033467 
[37m[36mINFO[0m[0m 01/12 02:01:00 | 0.804934    0.780712    0.899333    0.787184    0.803195    0.916581    0.767010    0.859966    0.739977    0.921453    0.854566    0.804934    0.780712    2800        46.138002   0.538272    0.319865    115.282228 
[37m[36mINFO[0m[0m 01/12 02:03:47 | 0.805508    0.797933    0.907085    0.796181    0.789261    0.924305    0.769072    0.862829    0.747995    0.934122    0.871477    0.805508    0.797933    3000        49.433574   0.500223    0.250162    116.531199 
[37m[36mINFO[0m[0m 01/12 02:06:37 | 0.806081    0.793341    0.912648    0.795317    0.799332    0.936663    0.771134    0.869129    0.738832    0.932151    0.875986    0.806081    0.793341    3200        52.729145   0.457338    0.254053    118.722827 
[37m[36mINFO[0m[0m 01/12 02:09:45 | 0.806942    0.797933    0.917840    0.792434    0.805809    0.937178    0.767010    0.877434    0.737686    0.938908    0.872604    0.806942    0.797933    3400        56.024717   0.442674    0.334050    120.949300 
[37m[36mINFO[0m[0m 01/12 02:13:06 | 0.804647    0.787600    0.928170    0.794495    0.800941    0.948507    0.773196    0.891466    0.737686    0.944538    0.872604    0.804647    0.787600    3600        59.320288   0.422358    0.400966    121.420681 
[37m[36mINFO[0m[0m 01/12 02:16:34 | 0.802639    0.794489    0.934265    0.801861    0.802029    0.958805    0.779381    0.897480    0.745704    0.946509    0.880496    0.802639    0.794489    3800        62.615860   0.383624    0.433494    120.735031 
[37m[36mINFO[0m[0m 01/12 02:19:53 | 0.802352    0.789897    0.935892    0.804732    0.774863    0.958290    0.783505    0.900344    0.744559    0.949043    0.886133    0.802352    0.789897    4000        65.911432   0.359011    0.429507    112.903869 
[37m[36mINFO[0m[0m 01/12 02:23:18 | 0.805795    0.787600    0.945337    0.804598    0.799247    0.972709    0.777320    0.907503    0.753723    0.955800    0.882751    0.805795    0.787600    4200        69.207003   0.346595    0.433176    117.991388 
[37m[36mINFO[0m[0m 01/12 02:26:40 | 0.798049    0.791045    0.945919    0.802793    0.808505    0.972194    0.773196    0.908076    0.743414    0.957489    0.891770    0.798049    0.791045    4400        72.502575   0.313736    0.425865    117.054467 
[37m[36mINFO[0m[0m 01/12 02:30:02 | 0.803213    0.801378    0.949456    0.799933    0.819861    0.972194    0.769072    0.919530    0.746850    0.956644    0.883878    0.803213    0.801378    4600        75.798146   0.302092    0.411726    119.200883 
[37m[36mINFO[0m[0m 01/12 02:33:19 | 0.803213    0.796785    0.955308    0.809413    0.806165    0.977858    0.779381    0.923540    0.752577    0.964527    0.896280    0.803213    0.796785    4800        79.093718   0.270712    0.403196    116.583635 
[37m[36mINFO[0m[0m 01/12 02:36:44 | 0.798623    0.795637    0.955267    0.802218    0.821114    0.976313    0.769072    0.924399    0.752577    0.965090    0.885006    0.798623    0.795637    5000        82.389289   0.264319    0.403970    123.444481 
[37m[36mINFO[0m[0m 01/12 02:36:44 | ---
[37m[36mINFO[0m[0m 01/12 02:36:44 | test-domain validation(oracle) = 80.321%
[37m[36mINFO[0m[0m 01/12 02:36:44 | training-domain validation(iid) = 80.321%
[37m[36mINFO[0m[0m 01/12 02:36:44 | last = 79.862%
[37m[36mINFO[0m[0m 01/12 02:36:44 | last (inD) = 80.222%
[37m[36mINFO[0m[0m 01/12 02:36:44 | training-domain validation (iid, inD) = 80.941%
[37m[36mINFO[0m[0m 01/12 02:36:44 | === Summary ===
[37m[36mINFO[0m[0m 01/12 02:36:44 | Command: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm gsnr1224 --test_envs 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 20
[37m[36mINFO[0m[0m 01/12 02:36:44 | Unique name: 250112_01-14-28_resnet50_sgd
[37m[36mINFO[0m[0m 01/12 02:36:44 | Out path: train_output/OfficeHome/gsnr1224/[3]/250112_01-14-28_resnet50_sgd
[37m[36mINFO[0m[0m 01/12 02:36:44 | Algorithm: gsnr1224
[37m[36mINFO[0m[0m 01/12 02:36:44 | Dataset: OfficeHome
[37m[36mINFO[0m[0m 01/12 02:36:44 | Max test_in: 0.8069

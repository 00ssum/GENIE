[37m[36mINFO[0m[0m 01/27 07:39:37 | Command :: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 0 2 3 --dataset OfficeHome --trial_seed 2 --hparams_seed 17
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 17
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/OfficeHome/GENIE/[0, 2, 3]/250127_07-39-37_resnet50_sgd
	out_root: train_output/OfficeHome/GENIE/[0, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 2, 3]
	trial_seed: 2
	unique_name: 250127_07-39-37_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 4.54558611872744e-05
	batch_size: 30
	weight_decay: 2.0881632317009623e-05
	momentum: 0.9078724336497048
	convergence_rate: 0.002681417777326872
	moving_avg: 0.9441514335937876
	p: 0.45912025296589154
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 01/27 07:39:37 | n_steps = 5001
[37m[36mINFO[0m[0m 01/27 07:39:37 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/27 07:39:37 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/27 07:39:37 | 
[37m[36mINFO[0m[0m 01/27 07:39:37 | Testenv name escaping te_A_P_R -> te_A_P_R
[37m[36mINFO[0m[0m 01/27 07:39:37 | Test envs = [0, 2, 3], name = te_A_P_R
[37m[36mINFO[0m[0m 01/27 07:39:37 | Train environments: [1], Test environments: [0, 2, 3]
[37m[36mINFO[0m[0m 01/27 07:39:37 | Batch sizes for each domain: [0, 30, 0, 0] (total=30)
[37m[36mINFO[0m[0m 01/27 07:39:37 | steps-per-epoch for each domain: 116.40 -> min = 116.40
[37m[36mINFO[0m[0m 01/27 07:39:38 | # of params = 23641217
[37m[36mINFO[0m[0m 01/27 07:41:24 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/27 07:41:24 | 0.017323    0.015115    0.018041    0.017182    4.222169    0.022142    0.024742    0.018041    0.017182    0.015484    0.003382    0.014343    0.017222    0           0.000000    4.232385    0.967608    105.219258 
[37m[36mINFO[0m[0m 01/27 07:43:43 | 0.286995    0.283112    0.402348    0.367698    2.627457    0.273944    0.259794    0.402348    0.367698    0.281532    0.281849    0.305508    0.307692    200         1.718213    3.773884    0.153366    108.504405 
[37m[36mINFO[0m[0m 01/27 07:46:09 | 0.487375    0.481292    0.712199    0.607102    1.386267    0.430999    0.406186    0.712199    0.607102    0.492399    0.510710    0.538726    0.526980    400         3.436426    1.919787    0.171375    111.546923 
[37m[36mINFO[0m[0m 01/27 07:48:26 | 0.546964    0.548608    0.802692    0.706758    1.163171    0.471164    0.488660    0.802692    0.706758    0.565597    0.569335    0.604131    0.587830    600         5.154639    1.108863    0.133768    109.354515 
[37m[36mINFO[0m[0m 01/27 07:50:44 | 0.570044    0.563466    0.863402    0.719359    1.098767    0.497425    0.496907    0.863402    0.719359    0.598536    0.591883    0.614171    0.601607    800         6.872852    0.824664    0.151437    107.687455 
[37m[36mINFO[0m[0m 01/27 07:52:58 | 0.582463    0.572387    0.888603    0.744559    1.049651    0.526262    0.523711    0.888603    0.744559    0.593187    0.594138    0.627940    0.599311    1000        8.591065    0.595569    0.144619    104.633721 
[37m[36mINFO[0m[0m 01/27 07:55:14 | 0.590052    0.585866    0.920962    0.767468    1.007640    0.528321    0.496907    0.920962    0.767468    0.605574    0.621195    0.636259    0.639495    1200        10.309278   0.522865    0.161742    102.985657 
[37m[36mINFO[0m[0m 01/27 07:57:37 | 0.591091    0.578330    0.932417    0.760596    1.036492    0.536560    0.505155    0.932417    0.760596    0.603322    0.613303    0.633391    0.616533    1400        12.027491   0.400337    0.187879    105.242248 
[37m[36mINFO[0m[0m 01/27 07:59:56 | 0.565848    0.552851    0.937572    0.746850    1.126941    0.488157    0.474227    0.937572    0.746850    0.592061    0.590755    0.617326    0.593571    1600        13.745704   0.331542    0.169423    105.396980 
[37m[36mINFO[0m[0m 01/27 08:02:19 | 0.580260    0.575910    0.944731    0.754868    1.149923    0.509269    0.486598    0.944731    0.754868    0.605293    0.623450    0.626219    0.617681    1800        15.463918   0.290393    0.165858    109.361311 
[37m[36mINFO[0m[0m 01/27 08:04:42 | 0.581812    0.568152    0.952463    0.761741    1.022585    0.500000    0.492784    0.952463    0.761741    0.612331    0.602029    0.633104    0.609644    2000        17.182131   0.272222    0.174508    108.887767 
[37m[36mINFO[0m[0m 01/27 08:07:06 | 0.588643    0.585049    0.960481    0.767468    1.109150    0.507724    0.509278    0.960481    0.767468    0.619651    0.615558    0.638554    0.630310    2200        18.900344   0.216814    0.184357    106.621508 
[37m[36mINFO[0m[0m 01/27 08:09:31 | 0.571789    0.564201    0.965636    0.764032    1.154763    0.485067    0.474227    0.965636    0.764032    0.608671    0.612176    0.621629    0.606200    2400        20.618557   0.187242    0.208166    103.959019 
[37m[36mINFO[0m[0m 01/27 08:11:50 | 0.594234    0.586143    0.966208    0.769759    1.216935    0.521627    0.517526    0.966208    0.769759    0.619651    0.635851    0.641423    0.605052    2600        22.336770   0.169490    0.171151    104.440094 
[37m[36mINFO[0m[0m 01/27 08:14:12 | 0.588310    0.585490    0.966781    0.774341    1.273351    0.523172    0.515464    0.966781    0.774341    0.609516    0.630214    0.632243    0.610792    2800        24.054983   0.157902    0.173360    107.286967 
[37m[36mINFO[0m[0m 01/27 08:16:28 | 0.582066    0.569602    0.968499    0.768614    1.171906    0.509269    0.472165    0.968499    0.768614    0.606982    0.617813    0.629948    0.618829    3000        25.773196   0.154025    0.140539    107.482913 
[37m[36mINFO[0m[0m 01/27 08:18:43 | 0.573095    0.565155    0.967354    0.768614    1.261964    0.499485    0.490722    0.967354    0.768614    0.602759    0.604284    0.617040    0.600459    3200        27.491409   0.130424    0.164109    102.967143 
[37m[36mINFO[0m[0m 01/27 08:21:03 | 0.589190    0.604311    0.969359    0.776632    1.234599    0.517508    0.544330    0.969359    0.776632    0.610360    0.627959    0.639702    0.640643    3400        29.209622   0.134383    0.190605    101.563767 
[37m[36mINFO[0m[0m 01/27 08:23:18 | 0.574714    0.575865    0.975372    0.772050    1.274058    0.496395    0.498969    0.975372    0.772050    0.607264    0.616685    0.620482    0.611940    3600        30.927835   0.127007    0.143445    105.819401 
[37m[36mINFO[0m[0m 01/27 08:25:36 | 0.580635    0.567682    0.978809    0.764032    1.215412    0.497940    0.472165    0.978809    0.764032    0.614302    0.618940    0.629662    0.611940    3800        32.646048   0.113297    0.145740    109.169600 
[37m[36mINFO[0m[0m 01/27 08:27:50 | 0.584437    0.574589    0.979381    0.778923    1.269811    0.512358    0.492784    0.979381    0.778923    0.606700    0.613303    0.634251    0.617681    4000        34.364261   0.103840    0.146757    104.135946 
[37m[36mINFO[0m[0m 01/27 08:30:06 | 0.579571    0.566056    0.981100    0.770905    1.261387    0.508754    0.486598    0.981100    0.770905    0.611486    0.607666    0.618474    0.603904    4200        36.082474   0.099928    0.169385    102.472044 
[37m[36mINFO[0m[0m 01/27 08:32:27 | 0.578931    0.573096    0.979095    0.769759    1.202888    0.506179    0.480412    0.979095    0.769759    0.607264    0.621195    0.623351    0.617681    4400        37.800687   0.097061    0.167919    107.317686 
[37m[36mINFO[0m[0m 01/27 08:34:44 | 0.584917    0.574088    0.978809    0.766323    1.170783    0.508754    0.484536    0.978809    0.766323    0.612894    0.621195    0.633104    0.616533    4600        39.518900   0.104486    0.154142    106.191038 
[37m[36mINFO[0m[0m 01/27 08:36:56 | 0.579893    0.566906    0.979954    0.772050    1.255604    0.503090    0.484536    0.979954    0.772050    0.609797    0.606539    0.626793    0.609644    4800        41.237113   0.093561    0.137632    104.870173 
[37m[36mINFO[0m[0m 01/27 08:39:10 | 0.577862    0.570491    0.979381    0.770905    1.296432    0.504634    0.501031    0.979381    0.770905    0.604167    0.606539    0.624785    0.603904    5000        42.955326   0.090693    0.141648    104.980666 
[37m[36mINFO[0m[0m 01/27 08:39:10 | Cumulative gradient change saved at train_output/OfficeHome/GENIE/[0, 2, 3]/250127_07-39-37_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/27 08:39:11 | ---
[37m[36mINFO[0m[0m 01/27 08:39:11 | test-domain validation(oracle) = 58.919%
[37m[36mINFO[0m[0m 01/27 08:39:11 | training-domain validation(iid) = 58.444%
[37m[36mINFO[0m[0m 01/27 08:39:11 | last = 57.786%
[37m[36mINFO[0m[0m 01/27 08:39:11 | last (inD) = 77.090%
[37m[36mINFO[0m[0m 01/27 08:39:11 | training-domain validation (iid, inD) = 77.892%
[37m[36mINFO[0m[0m 01/27 08:39:11 | === Summary ===
[37m[36mINFO[0m[0m 01/27 08:39:11 | Command: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 0 2 3 --dataset OfficeHome --trial_seed 2 --hparams_seed 17
[37m[36mINFO[0m[0m 01/27 08:39:11 | Unique name: 250127_07-39-37_resnet50_sgd
[37m[36mINFO[0m[0m 01/27 08:39:11 | Out path: train_output/OfficeHome/GENIE/[0, 2, 3]/250127_07-39-37_resnet50_sgd
[37m[36mINFO[0m[0m 01/27 08:39:11 | Algorithm: GENIE
[37m[36mINFO[0m[0m 01/27 08:39:11 | Dataset: OfficeHome

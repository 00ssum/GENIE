[37m[36mINFO[0m[0m 03/13 21:06:16 | Command :: /jsm0707/GENIE/train_all.py resnet50_signum config/resnet50_signum.yaml --algorithm GENIE --test_envs 1 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_signum.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_signum
	out_dir: train_output/OfficeHome/GENIE/[1]/250313_21-06-16_resnet50_signum
	out_root: train_output/OfficeHome/GENIE/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250313_21-06-16_resnet50_signum
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: signum
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	momentum: 0.9
	convergence_rate: 0.015
	moving_avg: 0.95
	p: 0.4
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/13 21:06:17 | n_steps = 5001
[37m[36mINFO[0m[0m 03/13 21:06:17 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/13 21:06:17 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/13 21:06:17 | 
[37m[36mINFO[0m[0m 03/13 21:06:17 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/13 21:06:17 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/13 21:06:17 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/13 21:06:17 | Batch sizes for each domain: [32, 0, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/13 21:06:17 | steps-per-epoch for each domain: 60.69, 111.00, 108.94 -> min = 60.69
[37m[36mINFO[0m[0m 03/13 21:06:18 | # of params = 23641217
[37m[36mINFO[0m[0m 03/13 21:08:23 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/13 21:08:23 | 0.013173    0.011455    0.016502    0.019419    4.218612    0.021627    0.020619    0.013173    0.011455    0.012387    0.013529    0.015491    0.024110    0           0.000000    4.262303    1.587239    122.855417 
[37m[36mINFO[0m[0m 03/13 21:12:10 | 0.491123    0.492554    0.837711    0.788614    0.782408    0.820803    0.738144    0.491123    0.492554    0.856700    0.829763    0.835628    0.797933    200         3.295572    1.356180    0.539087    119.095308 
[37m[36mINFO[0m[0m 03/13 21:15:53 | 0.499141    0.494845    0.896754    0.804619    0.778812    0.895469    0.746392    0.499141    0.494845    0.914414    0.852311    0.880379    0.815155    400         6.591143    0.413776    0.526780    117.493415 
[37m[36mINFO[0m[0m 03/13 21:19:37 | 0.494845    0.486827    0.935813    0.814148    0.790137    0.940783    0.744330    0.494845    0.486827    0.936937    0.871477    0.929719    0.826636    600         9.886715    0.270960    0.529479    118.446562 
[37m[36mINFO[0m[0m 03/13 21:23:18 | 0.525773    0.512027    0.956220    0.812335    0.802903    0.966529    0.740206    0.525773    0.512027    0.957207    0.880496    0.944923    0.816303    800         13.182286   0.174961    0.505015    120.144142 
[37m[36mINFO[0m[0m 03/13 21:27:05 | 0.497136    0.476518    0.959380    0.813548    0.829839    0.960350    0.738144    0.497136    0.476518    0.963401    0.882751    0.954389    0.819747    1000        16.477858   0.149025    0.542198    118.258723 
[37m[36mINFO[0m[0m 03/13 21:30:47 | 0.492554    0.462772    0.967089    0.811046    0.882147    0.970134    0.734021    0.492554    0.462772    0.970721    0.879369    0.960413    0.819747    1200        19.773429   0.107607    0.523529    117.622011 
[37m[36mINFO[0m[0m 03/13 21:34:31 | 0.518614    0.501718    0.978783    0.815886    0.858768    0.985582    0.746392    0.518614    0.501718    0.979167    0.887260    0.971601    0.814007    1400        23.069001   0.092260    0.537870    116.801065 
[37m[36mINFO[0m[0m 03/13 21:38:15 | 0.507159    0.477663    0.980090    0.827765    0.918061    0.984037    0.754639    0.507159    0.477663    0.978322    0.896280    0.977912    0.832377    1600        26.364573   0.066102    0.532542    117.248555 
[37m[36mINFO[0m[0m 03/13 21:41:58 | 0.524628    0.505155    0.980084    0.823391    0.860455    0.981462    0.750515    0.524628    0.505155    0.979730    0.886133    0.979059    0.833525    1800        29.660144   0.068571    0.531597    116.823866 
[37m[36mINFO[0m[0m 03/13 21:45:45 | 0.497995    0.485682    0.979971    0.820140    0.943169    0.987127    0.744330    0.497995    0.485682    0.978604    0.892897    0.974182    0.823192    2000        32.955716   0.058055    0.531129    120.217187 
[37m[36mINFO[0m[0m 03/13 21:49:32 | 0.505155    0.477663    0.981654    0.824795    0.944662    0.985067    0.752577    0.505155    0.477663    0.981982    0.894025    0.977912    0.827784    2200        36.251287   0.052542    0.537927    119.680603 
[37m[36mINFO[0m[0m 03/13 21:53:26 | 0.522050    0.513173    0.990252    0.832604    0.887732    0.991246    0.769072    0.522050    0.513173    0.991273    0.891770    0.988239    0.836969    2400        39.546859   0.045603    0.561223    121.189833 
[37m[36mINFO[0m[0m 03/13 21:57:13 | 0.530355    0.512027    0.990343    0.823838    1.080673    0.991246    0.748454    0.530355    0.512027    0.992117    0.888388    0.987665    0.834673    2600        42.842430   0.038710    0.537745    120.082733 
[37m[36mINFO[0m[0m 03/13 22:00:56 | 0.528637    0.501718    0.986472    0.825412    0.958733    0.985067    0.746392    0.528637    0.501718    0.991273    0.894025    0.983075    0.835821    2800        46.138002   0.032516    0.514736    119.528959 
[37m[36mINFO[0m[0m 03/13 22:04:43 | 0.541810    0.529210    0.991697    0.831293    0.945131    0.993306    0.762887    0.541810    0.529210    0.992399    0.894025    0.989386    0.836969    3000        49.433574   0.024106    0.544747    118.094130 
[37m[36mINFO[0m[0m 03/13 22:08:26 | 0.530355    0.502864    0.991348    0.831520    1.015911    0.992276    0.767010    0.530355    0.502864    0.993243    0.894025    0.988526    0.833525    3200        52.729145   0.029280    0.517270    120.054389 
[37m[36mINFO[0m[0m 03/13 22:12:14 | 0.541523    0.506300    0.993450    0.825439    1.070581    0.994851    0.756701    0.541523    0.506300    0.993243    0.888388    0.992255    0.831228    3400        56.024717   0.022179    0.546862    118.637580 
[37m[36mINFO[0m[0m 03/13 22:15:59 | 0.541237    0.516609    0.992173    0.834519    0.960189    0.993306    0.767010    0.541237    0.516609    0.992680    0.904171    0.990534    0.832377    3600        59.320288   0.030762    0.529708    118.419999 
[37m[36mINFO[0m[0m 03/13 22:19:48 | 0.536082    0.507446    0.993044    0.825378    1.045743    0.995366    0.746392    0.536082    0.507446    0.993806    0.899662    0.989960    0.830080    3800        62.615860   0.021923    0.550557    119.559707 
[37m[36mINFO[0m[0m 03/13 22:23:37 | 0.516896    0.504009    0.991471    0.825533    1.057167    0.991761    0.752577    0.516896    0.504009    0.992117    0.898534    0.990534    0.825488    4000        65.911432   0.020851    0.551183    118.791103 
[37m[36mINFO[0m[0m 03/13 22:27:24 | 0.526632    0.491409    0.990304    0.820195    1.045071    0.992276    0.744330    0.526632    0.491409    0.992117    0.883878    0.986517    0.832377    4200        69.207003   0.023885    0.542647    117.658516 
[37m[36mINFO[0m[0m 03/13 22:31:14 | 0.522910    0.525773    0.992543    0.828467    1.103665    0.993306    0.746392    0.522910    0.525773    0.994651    0.895152    0.989673    0.843858    4400        72.502575   0.023888    0.537694    122.666566 
[37m[36mINFO[0m[0m 03/13 22:35:00 | 0.533792    0.513173    0.990523    0.817799    0.991818    0.991761    0.756701    0.533792    0.513173    0.990709    0.886133    0.989099    0.810563    4600        75.798146   0.020699    0.535905    118.871116 
[37m[36mINFO[0m[0m 03/13 22:38:42 | 0.521764    0.501718    0.993204    0.821870    1.074263    0.993821    0.738144    0.521764    0.501718    0.992962    0.898534    0.992828    0.828932    4800        79.093718   0.019190    0.527778    117.005804 
[37m[36mINFO[0m[0m 03/13 22:42:27 | 0.538660    0.522337    0.991329    0.826965    0.995496    0.990216    0.754639    0.538660    0.522337    0.993525    0.901917    0.990247    0.824340    5000        82.389289   0.018569    0.530504    118.767687 
[37m[36mINFO[0m[0m 03/13 22:42:27 | Cumulative gradient change saved at train_output/OfficeHome/GENIE/[1]/250313_21-06-16_resnet50_signum/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/13 22:42:29 | ---
[37m[36mINFO[0m[0m 03/13 22:42:29 | test-domain validation(oracle) = 54.181%
[37m[36mINFO[0m[0m 03/13 22:42:29 | training-domain validation(iid) = 54.124%
[37m[36mINFO[0m[0m 03/13 22:42:29 | last = 53.866%
[37m[36mINFO[0m[0m 03/13 22:42:29 | last (inD) = 82.697%
[37m[36mINFO[0m[0m 03/13 22:42:29 | training-domain validation (iid, inD) = 83.452%
[37m[36mINFO[0m[0m 03/13 22:42:29 | === Summary ===
[37m[36mINFO[0m[0m 03/13 22:42:29 | Command: /jsm0707/GENIE/train_all.py resnet50_signum config/resnet50_signum.yaml --algorithm GENIE --test_envs 1 --dataset OfficeHome
[37m[36mINFO[0m[0m 03/13 22:42:29 | Unique name: 250313_21-06-16_resnet50_signum
[37m[36mINFO[0m[0m 03/13 22:42:29 | Out path: train_output/OfficeHome/GENIE/[1]/250313_21-06-16_resnet50_signum
[37m[36mINFO[0m[0m 03/13 22:42:29 | Algorithm: GENIE
[37m[36mINFO[0m[0m 03/13 22:42:29 | Dataset: OfficeHome

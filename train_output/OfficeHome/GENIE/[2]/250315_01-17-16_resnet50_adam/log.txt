[37m[36mINFO[0m[0m 03/15 01:17:16 | Command :: /jsm0707/GENIE/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm GENIE --test_envs 2 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_adam.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_adam
	out_dir: train_output/OfficeHome/GENIE/[2]/250315_01-17-16_resnet50_adam
	out_root: train_output/OfficeHome/GENIE/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250315_01-17-16_resnet50_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	momentum: 0.9
	convergence_rate: 0.015
	moving_avg: 0.95
	p: 0.4
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/15 01:17:16 | n_steps = 5001
[37m[36mINFO[0m[0m 03/15 01:17:16 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/15 01:17:16 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/15 01:17:16 | 
[37m[36mINFO[0m[0m 03/15 01:17:16 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 03/15 01:17:16 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 03/15 01:17:16 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 03/15 01:17:16 | Batch sizes for each domain: [32, 32, 0, 32] (total=96)
[37m[36mINFO[0m[0m 03/15 01:17:16 | steps-per-epoch for each domain: 60.69, 109.12, 108.94 -> min = 60.69
[37m[36mINFO[0m[0m 03/15 01:17:18 | # of params = 23641217
[37m[36mINFO[0m[0m 03/15 01:19:19 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/15 01:19:19 | 0.007601    0.009019    0.017222    0.014295    4.222817    0.024717    0.016495    0.008591    0.006873    0.007601    0.009019    0.018359    0.019518    0           0.000000    4.290899    1.071587    119.730210 
[37m[36mINFO[0m[0m 03/15 01:23:03 | 0.686655    0.665163    0.776918    0.715670    1.105611    0.798146    0.723711    0.720790    0.654066    0.686655    0.665163    0.811819    0.769231    200         3.295572    1.643877    0.533960    117.752870 
[37m[36mINFO[0m[0m 03/15 01:26:50 | 0.723536    0.702368    0.864342    0.746165    0.995272    0.891349    0.736082    0.825315    0.699885    0.723536    0.702368    0.876363    0.802526    400         6.591143    0.565267    0.540039    118.641874 
[37m[36mINFO[0m[0m 03/15 01:30:37 | 0.731419    0.712514    0.902363    0.756402    1.014722    0.924305    0.738144    0.869129    0.722795    0.731419    0.712514    0.913655    0.808266    600         9.886715    0.396560    0.539197    119.000652 
[37m[36mINFO[0m[0m 03/15 01:34:21 | 0.753378    0.747463    0.924101    0.758458    0.987204    0.953141    0.734021    0.899771    0.741123    0.753378    0.747463    0.919392    0.800230    800         13.182286   0.258029    0.526490    118.918964 
[37m[36mINFO[0m[0m 03/15 01:38:05 | 0.755349    0.717024    0.952678    0.763967    1.179704    0.965499    0.740206    0.936999    0.736541    0.755349    0.717024    0.955536    0.815155    1000        16.477858   0.195343    0.544280    115.679766 
[37m[36mINFO[0m[0m 03/15 01:41:48 | 0.758164    0.726043    0.961802    0.761668    1.114378    0.981977    0.740206    0.941581    0.741123    0.758164    0.726043    0.961847    0.803674    1200        19.773429   0.144507    0.532968    116.160788 
[37m[36mINFO[0m[0m 03/15 01:45:32 | 0.736768    0.705750    0.966178    0.766325    1.131654    0.979918    0.758763    0.950745    0.737686    0.736768    0.705750    0.967871    0.802526    1400        23.069001   0.120601    0.535373    116.974779 
[37m[36mINFO[0m[0m 03/15 01:49:18 | 0.741836    0.722661    0.976779    0.774807    1.175912    0.987642    0.767010    0.959908    0.747995    0.741836    0.722661    0.982788    0.809414    1600        26.364573   0.105242    0.537341    118.678513 
[37m[36mINFO[0m[0m 03/15 01:52:59 | 0.750845    0.718151    0.974047    0.765573    1.257430    0.986612    0.738144    0.957331    0.741123    0.750845    0.718151    0.978199    0.817451    1800        29.660144   0.080044    0.531392    114.441183 
[37m[36mINFO[0m[0m 03/15 01:56:47 | 0.746903    0.732807    0.977104    0.765562    1.299153    0.986612    0.748454    0.962772    0.744559    0.746903    0.732807    0.981928    0.803674    2000        32.955716   0.079861    0.544401    118.817523 
[37m[36mINFO[0m[0m 03/15 02:00:32 | 0.745495    0.721533    0.978115    0.778016    1.208216    0.985067    0.762887    0.969359    0.759450    0.745495    0.721533    0.979920    0.811711    2200        36.251287   0.071252    0.544309    116.642594 
[37m[36mINFO[0m[0m 03/15 02:04:20 | 0.758164    0.751973    0.978688    0.767851    1.303245    0.987642    0.758763    0.967354    0.743414    0.758164    0.751973    0.981067    0.801378    2400        39.546859   0.057876    0.551394    117.754986 
[37m[36mINFO[0m[0m 03/15 02:08:06 | 0.755349    0.726043    0.985926    0.781301    1.285091    0.993306    0.767010    0.975372    0.762887    0.755349    0.726043    0.989099    0.814007    2600        42.842430   0.054714    0.541411    117.501871 
[37m[36mINFO[0m[0m 03/15 02:11:48 | 0.758164    0.729425    0.983598    0.771140    1.320124    0.986612    0.742268    0.976804    0.762887    0.758164    0.729425    0.987378    0.808266    2800        46.138002   0.054227    0.520752    117.424997 
[37m[36mINFO[0m[0m 03/15 02:15:30 | 0.748029    0.732807    0.986612    0.779849    1.273849    0.995366    0.764948    0.975945    0.761741    0.748029    0.732807    0.988526    0.812859    3000        49.433574   0.045479    0.534392    115.686995 
[37m[36mINFO[0m[0m 03/15 02:19:09 | 0.746059    0.738444    0.980671    0.762650    1.403854    0.990731    0.744330    0.971649    0.753723    0.746059    0.738444    0.979633    0.789897    3200        52.729145   0.042501    0.500473    118.406520 
[37m[36mINFO[0m[0m 03/15 02:22:55 | 0.760980    0.755355    0.990778    0.775426    1.315292    0.993821    0.750515    0.984250    0.756014    0.760980    0.755355    0.994263    0.819747    3400        56.024717   0.044462    0.538164    118.487494 
[37m[36mINFO[0m[0m 03/15 02:26:40 | 0.766047    0.749718    0.985946    0.780843    1.285925    0.992791    0.769072    0.974800    0.759450    0.766047    0.749718    0.990247    0.814007    3600        59.320288   0.040265    0.519874    120.830040 
[37m[36mINFO[0m[0m 03/15 02:30:27 | 0.764640    0.744081    0.988313    0.785132    1.335389    0.993306    0.767010    0.981100    0.758305    0.764640    0.744081    0.990534    0.830080    3800        62.615860   0.036971    0.546242    117.773756 
[37m[36mINFO[0m[0m 03/15 02:34:11 | 0.767173    0.732807    0.989804    0.788173    1.300363    0.994336    0.787629    0.980241    0.764032    0.767173    0.732807    0.994836    0.812859    4000        65.911432   0.033025    0.542963    115.788847 
[37m[36mINFO[0m[0m 03/15 02:37:58 | 0.762106    0.730552    0.989669    0.765182    1.412762    0.992791    0.748454    0.984822    0.741123    0.762106    0.730552    0.991394    0.805970    4200        69.207003   0.033295    0.551354    117.113647 
[37m[36mINFO[0m[0m 03/15 02:41:41 | 0.748592    0.733935    0.987989    0.776410    1.303227    0.991761    0.754639    0.981959    0.765178    0.748592    0.733935    0.990247    0.809414    4400        72.502575   0.034512    0.529810    116.748387 
[37m[36mINFO[0m[0m 03/15 02:45:25 | 0.762950    0.744081    0.988944    0.783744    1.301307    0.994336    0.773196    0.979954    0.765178    0.762950    0.744081    0.992542    0.812859    4600        75.798146   0.033989    0.533595    116.825259 
[37m[36mINFO[0m[0m 03/15 02:49:10 | 0.755912    0.729425    0.989593    0.778554    1.381704    0.994851    0.758763    0.980527    0.760596    0.755912    0.729425    0.993402    0.816303    4800        79.093718   0.031837    0.537262    117.407208 
[37m[36mINFO[0m[0m 03/15 02:52:56 | 0.758446    0.741826    0.987684    0.779623    1.555963    0.992276    0.760825    0.979381    0.761741    0.758446    0.741826    0.991394    0.816303    5000        82.389289   0.030485    0.543897    117.260358 
[37m[36mINFO[0m[0m 03/15 02:52:56 | Cumulative gradient change saved at train_output/OfficeHome/GENIE/[2]/250315_01-17-16_resnet50_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/15 02:52:57 | ---
[37m[36mINFO[0m[0m 03/15 02:52:57 | test-domain validation(oracle) = 76.098%
[37m[36mINFO[0m[0m 03/15 02:52:57 | training-domain validation(iid) = 76.717%
[37m[36mINFO[0m[0m 03/15 02:52:57 | last = 75.845%
[37m[36mINFO[0m[0m 03/15 02:52:57 | last (inD) = 77.962%
[37m[36mINFO[0m[0m 03/15 02:52:57 | training-domain validation (iid, inD) = 78.817%
[37m[36mINFO[0m[0m 03/15 02:52:57 | === Summary ===
[37m[36mINFO[0m[0m 03/15 02:52:57 | Command: /jsm0707/GENIE/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm GENIE --test_envs 2 --dataset OfficeHome
[37m[36mINFO[0m[0m 03/15 02:52:57 | Unique name: 250315_01-17-16_resnet50_adam
[37m[36mINFO[0m[0m 03/15 02:52:57 | Out path: train_output/OfficeHome/GENIE/[2]/250315_01-17-16_resnet50_adam
[37m[36mINFO[0m[0m 03/15 02:52:57 | Algorithm: GENIE
[37m[36mINFO[0m[0m 03/15 02:52:57 | Dataset: OfficeHome

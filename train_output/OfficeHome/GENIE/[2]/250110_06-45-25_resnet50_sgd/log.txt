[37m[36mINFO[0m[0m 01/10 06:45:25 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 2 --dataset OfficeHome --trial_seed 0 --hparams_seed 15
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 15
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/OfficeHome/GENIE/[2]/250110_06-45-25_resnet50_sgd
	out_root: train_output/OfficeHome/GENIE/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250110_06-45-25_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 0.00010661763546249327
	batch_size: 14
	weight_decay: 9.086452814323981e-06
	momentum: 0.846320346520143
	convergence_rate: 0.001625681705546367
	moving_avg: 0.9229441284737897
	p: 0.5950371143099659
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 01/10 06:45:25 | n_steps = 5001
[37m[36mINFO[0m[0m 01/10 06:45:25 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/10 06:45:25 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/10 06:45:25 | Target test envs = [[2]]
[37m[36mINFO[0m[0m 01/10 06:45:25 | 
[37m[36mINFO[0m[0m 01/10 06:45:25 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 01/10 06:45:25 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 01/10 06:45:25 | Batch sizes for each domain: [14, 14, 0, 14] (total=42)
[37m[36mINFO[0m[0m 01/10 06:45:25 | steps-per-epoch for each domain: 138.71, 249.43, 249.00 -> min = 138.71
[37m[36mINFO[0m[0m 01/10 06:45:26 | # of params = 23641217
[37m[36mINFO[0m[0m 01/10 06:47:28 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/10 06:47:28 | 0.003378    0.004510    0.015257    0.013912    4.263314    0.018538    0.016495    0.011168    0.006873    0.003378    0.004510    0.016064    0.018370    0           0.000000    4.396195    1.023595    120.859481 
[37m[36mINFO[0m[0m 01/10 06:50:19 | 0.146959    0.151071    0.186036    0.181731    3.750423    0.227600    0.220619    0.141753    0.147766    0.146959    0.151071    0.188755    0.176808    200         1.441813    4.069183    0.233884    124.304271 
[37m[36mINFO[0m[0m 01/10 06:53:12 | 0.562218    0.568207    0.585886    0.576340    1.730078    0.587024    0.595876    0.527491    0.515464    0.562218    0.568207    0.643144    0.617681    400         2.883625    2.958248    0.238724    124.767585 
[37m[36mINFO[0m[0m 01/10 06:55:57 | 0.673423    0.662909    0.708828    0.677832    1.230038    0.701339    0.692784    0.657216    0.619702    0.673423    0.662909    0.767929    0.721010    600         4.325438    1.742904    0.247317    114.887763 
[37m[36mINFO[0m[0m 01/10 06:58:46 | 0.701014    0.698985    0.756346    0.714219    1.070872    0.761071    0.721649    0.705326    0.651775    0.701014    0.698985    0.802639    0.769231    800         5.767250    1.272081    0.249735    118.440638 
[37m[36mINFO[0m[0m 01/10 07:01:37 | 0.733390    0.715896    0.781128    0.728443    0.994287    0.795572    0.740206    0.721649    0.649485    0.733390    0.715896    0.826162    0.795637    1000        7.209063    1.104263    0.258875    119.074075 
[37m[36mINFO[0m[0m 01/10 07:04:25 | 0.744088    0.745209    0.807624    0.741279    0.929736    0.827497    0.734021    0.753723    0.684994    0.744088    0.745209    0.841652    0.804822    1200        8.650875    0.993207    0.249021    117.537140 
[37m[36mINFO[0m[0m 01/10 07:07:09 | 0.733390    0.719278    0.824753    0.742263    0.918580    0.844490    0.738144    0.770332    0.695304    0.733390    0.719278    0.859438    0.793341    1400        10.092688   0.819880    0.238564    116.724145 
[37m[36mINFO[0m[0m 01/10 07:09:54 | 0.750845    0.740699    0.843344    0.761299    0.888686    0.865602    0.740206    0.798969    0.722795    0.750845    0.740699    0.865462    0.820896    1600        11.534501   0.779154    0.239049    116.246214 
[37m[36mINFO[0m[0m 01/10 07:12:46 | 0.751126    0.723788    0.850376    0.756101    0.882522    0.866632    0.746392    0.808133    0.707904    0.751126    0.723788    0.876363    0.814007    1800        12.976313   0.705809    0.247871    122.629712 
[37m[36mINFO[0m[0m 01/10 07:15:34 | 0.747748    0.724915    0.867557    0.766878    0.837334    0.892379    0.764948    0.821019    0.709049    0.747748    0.724915    0.889271    0.826636    2000        14.418126   0.651628    0.232528    121.021030 
[37m[36mINFO[0m[0m 01/10 07:18:18 | 0.759572    0.742954    0.878857    0.773294    0.835111    0.901648    0.767010    0.842497    0.723940    0.759572    0.742954    0.892427    0.828932    2200        15.859938   0.575873    0.241410    115.895114 
[37m[36mINFO[0m[0m 01/10 07:21:10 | 0.756194    0.742954    0.886321    0.765115    0.866512    0.914006    0.750515    0.846220    0.727377    0.756194    0.742954    0.898738    0.817451    2400        17.301751   0.561511    0.257377    120.187570 
[37m[36mINFO[0m[0m 01/10 07:24:02 | 0.759291    0.754228    0.894264    0.781321    0.838692    0.921215    0.756701    0.857675    0.746850    0.759291    0.754228    0.903901    0.840413    2600        18.743563   0.521524    0.254859    120.596388 
[37m[36mINFO[0m[0m 01/10 07:26:56 | 0.757320    0.758737    0.905625    0.763353    0.854315    0.934089    0.746392    0.867698    0.733104    0.757320    0.758737    0.915089    0.810563    2800        20.185376   0.481997    0.256733    122.745311 
[37m[36mINFO[0m[0m 01/10 07:29:50 | 0.766610    0.753100    0.910512    0.780699    0.843796    0.941298    0.773196    0.871134    0.743414    0.766610    0.753100    0.919105    0.825488    3000        21.627188   0.432387    0.245551    124.524071 
[37m[36mINFO[0m[0m 01/10 07:32:42 | 0.763232    0.740699    0.914872    0.777112    0.875752    0.937178    0.756701    0.878580    0.746850    0.763232    0.740699    0.928858    0.827784    3200        23.069001   0.422594    0.242973    123.977968 
[37m[36mINFO[0m[0m 01/10 07:35:35 | 0.768863    0.747463    0.919049    0.773826    0.882407    0.942842    0.752577    0.889462    0.743414    0.768863    0.747463    0.924842    0.825488    3400        24.510814   0.400254    0.234150    125.725608 
[37m[36mINFO[0m[0m 01/10 07:38:30 | 0.770833    0.748591    0.932049    0.786664    0.832475    0.960350    0.767010    0.902635    0.756014    0.770833    0.748591    0.933161    0.836969    3600        25.952626   0.373191    0.248513    125.647532 
[37m[36mINFO[0m[0m 01/10 07:41:16 | 0.766329    0.751973    0.935868    0.784827    0.846803    0.965499    0.764948    0.904066    0.758305    0.766329    0.751973    0.938038    0.831228    3800        27.394439   0.327185    0.231074    119.104347 
[37m[36mINFO[0m[0m 01/10 07:44:00 | 0.760417    0.737317    0.934624    0.784149    0.902162    0.968074    0.762887    0.901775    0.746850    0.760417    0.737317    0.934022    0.842710    4000        28.836251   0.324841    0.237656    116.267446 
[37m[36mINFO[0m[0m 01/10 07:46:47 | 0.766610    0.747463    0.941942    0.787502    0.900476    0.963955    0.764948    0.919817    0.764032    0.766610    0.747463    0.942054    0.833525    4200        30.278064   0.301952    0.244580    118.227193 
[37m[36mINFO[0m[0m 01/10 07:49:37 | 0.775338    0.744081    0.941025    0.786349    0.904809    0.965499    0.775258    0.914662    0.759450    0.775338    0.744081    0.942915    0.824340    4400        31.719876   0.283589    0.248864    120.611215 
[37m[36mINFO[0m[0m 01/10 07:52:27 | 0.773367    0.756483    0.944847    0.787730    0.852966    0.965499    0.769072    0.919817    0.761741    0.773367    0.756483    0.949225    0.832377    4600        33.161689   0.271758    0.250073    119.867640 
[37m[36mINFO[0m[0m 01/10 07:55:20 | 0.778435    0.744081    0.952636    0.789108    0.921828    0.976828    0.773196    0.926403    0.757159    0.778435    0.744081    0.954676    0.836969    4800        34.603502   0.247610    0.250023    122.810199 
[37m[36mINFO[0m[0m 01/10 07:58:01 | 0.778435    0.746336    0.956244    0.793462    0.862712    0.982492    0.769072    0.927835    0.773196    0.778435    0.746336    0.958405    0.838117    5000        36.045314   0.259467    0.234527    113.827232 
[37m[36mINFO[0m[0m 01/10 07:58:02 | ---
[37m[36mINFO[0m[0m 01/10 07:58:02 | test-domain validation(oracle) = 75.732%
[37m[36mINFO[0m[0m 01/10 07:58:02 | training-domain validation(iid) = 77.843%
[37m[36mINFO[0m[0m 01/10 07:58:02 | last = 77.843%
[37m[36mINFO[0m[0m 01/10 07:58:02 | last (inD) = 79.346%
[37m[36mINFO[0m[0m 01/10 07:58:02 | training-domain validation (iid, inD) = 79.346%
[37m[36mINFO[0m[0m 01/10 07:58:02 | === Summary ===
[37m[36mINFO[0m[0m 01/10 07:58:02 | Command: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 2 --dataset OfficeHome --trial_seed 0 --hparams_seed 15
[37m[36mINFO[0m[0m 01/10 07:58:02 | Unique name: 250110_06-45-25_resnet50_sgd
[37m[36mINFO[0m[0m 01/10 07:58:02 | Out path: train_output/OfficeHome/GENIE/[2]/250110_06-45-25_resnet50_sgd
[37m[36mINFO[0m[0m 01/10 07:58:02 | Algorithm: GENIE
[37m[36mINFO[0m[0m 01/10 07:58:02 | Dataset: OfficeHome
[37m[36mINFO[0m[0m 01/10 07:58:02 | Max test_in: 0.7784

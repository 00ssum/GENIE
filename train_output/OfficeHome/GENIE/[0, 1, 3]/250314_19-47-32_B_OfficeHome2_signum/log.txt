[37m[36mINFO[0m[0m 03/14 19:47:32 | Command :: /jsm0707/GENIE/train_all.py B_OfficeHome2_signum config/resnet50_signum.yaml --trial_seed 0 --hparams_seed 20 --algorithm GENIE --test_envs 0 1 3 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_signum.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 20
	in_domain: False
	model_save: None
	mpa: False
	name: B_OfficeHome2_signum
	out_dir: train_output/OfficeHome/GENIE/[0, 1, 3]/250314_19-47-32_B_OfficeHome2_signum
	out_root: train_output/OfficeHome/GENIE/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 0
	unique_name: 250314_19-47-32_B_OfficeHome2_signum
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: signum
	freeze_bn: False
	pretrained: True
	lr: 2.6157673767852512e-05
	batch_size: 32
	weight_decay: 1.110622050999988e-05
	momentum: 0.8046004195437085
	convergence_rate: 0.0010908695544732698
	moving_avg: 0.9447089904071476
	p: 0.5550574176650049
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/14 19:47:32 | n_steps = 5001
[37m[36mINFO[0m[0m 03/14 19:47:32 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/14 19:47:32 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/14 19:47:32 | 
[37m[36mINFO[0m[0m 03/14 19:47:32 | Testenv name escaping te_A_C_R -> te_A_C_R
[37m[36mINFO[0m[0m 03/14 19:47:32 | Test envs = [0, 1, 3], name = te_A_C_R
[37m[36mINFO[0m[0m 03/14 19:47:32 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 03/14 19:47:32 | Batch sizes for each domain: [0, 0, 32, 0] (total=32)
[37m[36mINFO[0m[0m 03/14 19:47:32 | steps-per-epoch for each domain: 111.00 -> min = 111.00
[37m[36mINFO[0m[0m 03/14 19:47:33 | # of params = 23641217
[37m[36mINFO[0m[0m 03/14 19:49:18 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/14 19:49:18 | 0.017776    0.016577    0.012669    0.015784    4.255764    0.020082    0.026804    0.017182    0.014891    0.012669    0.015784    0.016064    0.008037    0           0.000000    4.398559    1.217617    103.051938 
[37m[36mINFO[0m[0m 03/14 19:51:33 | 0.121345    0.112607    0.268581    0.259301    3.569063    0.085994    0.055670    0.124570    0.123711    0.268581    0.259301    0.153471    0.158439    200         1.801802    4.015915    0.143188    107.121523 
[37m[36mINFO[0m[0m 03/14 19:53:47 | 0.422258    0.417665    0.750282    0.736189    1.046780    0.374356    0.383505    0.338488    0.336770    0.750282    0.736189    0.553930    0.532721    400         3.603604    2.502835    0.144071    104.756399 
[37m[36mINFO[0m[0m 03/14 19:56:02 | 0.493688    0.490463    0.851351    0.828636    0.599558    0.451596    0.451546    0.379152    0.358534    0.851351    0.828636    0.650316    0.661309    600         5.405405    1.094207    0.153312    104.544890 
[37m[36mINFO[0m[0m 03/14 19:58:15 | 0.523007    0.523016    0.903716    0.874859    0.468342    0.472194    0.490722    0.410653    0.388316    0.903716    0.874859    0.686173    0.690011    800         7.207207    0.725242    0.155151    101.473255 
[37m[36mINFO[0m[0m 03/14 20:00:30 | 0.539198    0.538384    0.918919    0.882751    0.411430    0.501545    0.519588    0.408076    0.381443    0.918919    0.882751    0.707975    0.714122    1000        9.009009    0.543789    0.152142    105.278103 
[37m[36mINFO[0m[0m 03/14 20:02:45 | 0.541223    0.537075    0.933277    0.882751    0.414120    0.501030    0.523711    0.412944    0.388316    0.933277    0.882751    0.709696    0.699196    1200        10.810811   0.454174    0.147654    105.514098 
[37m[36mINFO[0m[0m 03/14 20:05:00 | 0.532733    0.540748    0.951858    0.888388    0.374457    0.483007    0.527835    0.406357    0.384880    0.951858    0.888388    0.708835    0.709529    1400        12.612613   0.380531    0.155707    103.560521 
[37m[36mINFO[0m[0m 03/14 20:07:13 | 0.545163    0.545108    0.959459    0.895152    0.358656    0.500515    0.523711    0.412658    0.392898    0.959459    0.895152    0.722318    0.718714    1600        14.414414   0.323309    0.145360    104.216210 
[37m[36mINFO[0m[0m 03/14 20:09:33 | 0.537219    0.546098    0.965935    0.898534    0.353728    0.493306    0.527835    0.405498    0.395189    0.965935    0.898534    0.712851    0.715270    1800        16.216216   0.253567    0.152710    108.531267 
[37m[36mINFO[0m[0m 03/14 20:11:47 | 0.545084    0.544105    0.971284    0.898534    0.341626    0.507724    0.550515    0.405498    0.375716    0.971284    0.898534    0.722031    0.706085    2000        18.018018   0.234792    0.141131    106.606544 
[37m[36mINFO[0m[0m 03/14 20:14:00 | 0.546349    0.552368    0.977196    0.905299    0.330642    0.499485    0.544330    0.414948    0.387171    0.977196    0.905299    0.724613    0.725603    2200        19.819820   0.193144    0.139409    104.743362 
[37m[36mINFO[0m[0m 03/14 20:16:12 | 0.549040    0.549842    0.976633    0.909808    0.335815    0.504119    0.529897    0.417239    0.402062    0.976633    0.909808    0.725760    0.717566    2400        21.621622   0.184769    0.138438    104.696382 
[37m[36mINFO[0m[0m 03/14 20:18:21 | 0.542812    0.549602    0.977759    0.903044    0.360941    0.491761    0.536082    0.424685    0.408935    0.977759    0.903044    0.711991    0.703789    2600        23.423423   0.161119    0.136169    101.626108 
[37m[36mINFO[0m[0m 03/14 20:20:32 | 0.545755    0.543494    0.988176    0.912063    0.340699    0.500000    0.536082    0.415521    0.389462    0.988176    0.912063    0.721744    0.704937    2800        25.225225   0.152602    0.141038    102.432537 
[37m[36mINFO[0m[0m 03/14 20:22:43 | 0.539250    0.547551    0.988457    0.907554    0.337384    0.485067    0.529897    0.411226    0.395189    0.988457    0.907554    0.721457    0.717566    3000        27.027027   0.134931    0.142357    102.728522 
[37m[36mINFO[0m[0m 03/14 20:24:54 | 0.539016    0.539370    0.986768    0.900789    0.360714    0.491246    0.523711    0.408362    0.389462    0.986768    0.900789    0.717441    0.704937    3200        28.828829   0.102226    0.145108    101.906578 
[37m[36mINFO[0m[0m 03/14 20:27:04 | 0.548067    0.546248    0.988739    0.908681    0.359396    0.504634    0.534021    0.410939    0.392898    0.988739    0.908681    0.728629    0.711825    3400        30.630631   0.098598    0.144854    101.060997 
[37m[36mINFO[0m[0m 03/14 20:29:15 | 0.547434    0.547854    0.991554    0.907554    0.363034    0.498455    0.531959    0.424971    0.396334    0.991554    0.907554    0.718876    0.715270    3600        32.432432   0.092257    0.143481    102.704494 
[37m[36mINFO[0m[0m 03/14 20:31:24 | 0.541759    0.555873    0.990991    0.913191    0.357806    0.504634    0.552577    0.407216    0.399771    0.990991    0.913191    0.713425    0.715270    3800        34.234234   0.093355    0.142356    100.259605 
[37m[36mINFO[0m[0m 03/14 20:33:32 | 0.533929    0.536465    0.987050    0.914318    0.384983    0.502060    0.529897    0.392612    0.378007    0.987050    0.914318    0.707114    0.701493    4000        36.036036   0.077356    0.141577    99.936412  
[37m[36mINFO[0m[0m 03/14 20:35:45 | 0.538114    0.537008    0.992680    0.914318    0.351958    0.497425    0.515464    0.404353    0.383734    0.992680    0.914318    0.712565    0.711825    4200        37.837838   0.080717    0.142008    103.644228 
[37m[36mINFO[0m[0m 03/14 20:37:56 | 0.546495    0.547699    0.991836    0.908681    0.381579    0.505664    0.525773    0.417526    0.405498    0.991836    0.908681    0.716294    0.711825    4400        39.639640   0.068041    0.140482    103.523683 
[37m[36mINFO[0m[0m 03/14 20:40:09 | 0.545888    0.538385    0.995777    0.917700    0.367336    0.504119    0.509278    0.409794    0.390607    0.995777    0.917700    0.723752    0.715270    4600        41.441441   0.061739    0.144241    103.714021 
[37m[36mINFO[0m[0m 03/14 20:42:19 | 0.543364    0.531958    0.992399    0.908681    0.376715    0.500000    0.507216    0.416380    0.389462    0.992399    0.908681    0.713712    0.699196    4800        43.243243   0.050635    0.143641    101.682229 
[37m[36mINFO[0m[0m 03/14 20:44:33 | 0.550851    0.557931    0.993243    0.907554    0.386115    0.506694    0.548454    0.423253    0.414662    0.993243    0.907554    0.722605    0.710677    5000        45.045045   0.053472    0.141880    105.241076 
[37m[36mINFO[0m[0m 03/14 20:44:33 | Cumulative gradient change saved at train_output/OfficeHome/GENIE/[0, 1, 3]/250314_19-47-32_B_OfficeHome2_signum/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/14 20:44:34 | ---
[37m[36mINFO[0m[0m 03/14 20:44:34 | test-domain validation(oracle) = 55.085%
[37m[36mINFO[0m[0m 03/14 20:44:34 | training-domain validation(iid) = 54.589%
[37m[36mINFO[0m[0m 03/14 20:44:34 | last = 55.085%
[37m[36mINFO[0m[0m 03/14 20:44:34 | last (inD) = 90.755%
[37m[36mINFO[0m[0m 03/14 20:44:34 | training-domain validation (iid, inD) = 91.770%
[37m[36mINFO[0m[0m 03/14 20:44:34 | === Summary ===
[37m[36mINFO[0m[0m 03/14 20:44:34 | Command: /jsm0707/GENIE/train_all.py B_OfficeHome2_signum config/resnet50_signum.yaml --trial_seed 0 --hparams_seed 20 --algorithm GENIE --test_envs 0 1 3 --dataset OfficeHome
[37m[36mINFO[0m[0m 03/14 20:44:34 | Unique name: 250314_19-47-32_B_OfficeHome2_signum
[37m[36mINFO[0m[0m 03/14 20:44:34 | Out path: train_output/OfficeHome/GENIE/[0, 1, 3]/250314_19-47-32_B_OfficeHome2_signum
[37m[36mINFO[0m[0m 03/14 20:44:34 | Algorithm: GENIE
[37m[36mINFO[0m[0m 03/14 20:44:34 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 03/15 08:05:54 | Command :: /jsm0707/GENIE/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm GENIE --test_envs 0 1 3 --dataset OfficeHome
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_adam.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_adam
	out_dir: train_output/OfficeHome/GENIE/[0, 1, 3]/250315_08-05-54_resnet50_adam
	out_root: train_output/OfficeHome/GENIE/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 0
	unique_name: 250315_08-05-54_resnet50_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	momentum: 0.9
	convergence_rate: 0.015
	moving_avg: 0.95
	p: 0.4
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/15 08:05:54 | n_steps = 5001
[37m[36mINFO[0m[0m 03/15 08:05:54 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/15 08:05:54 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/15 08:05:54 | 
[37m[36mINFO[0m[0m 03/15 08:05:54 | Testenv name escaping te_A_C_R -> te_A_C_R
[37m[36mINFO[0m[0m 03/15 08:05:54 | Test envs = [0, 1, 3], name = te_A_C_R
[37m[36mINFO[0m[0m 03/15 08:05:54 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 03/15 08:05:54 | Batch sizes for each domain: [0, 0, 32, 0] (total=32)
[37m[36mINFO[0m[0m 03/15 08:05:54 | steps-per-epoch for each domain: 111.00 -> min = 111.00
[37m[36mINFO[0m[0m 03/15 08:05:56 | # of params = 23641217
[37m[36mINFO[0m[0m 03/15 08:07:40 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/15 08:07:40 | 0.020336    0.019714    0.027872    0.024803    4.185874    0.020597    0.014433    0.021764    0.028637    0.027872    0.024803    0.018646    0.016073    0           0.000000    4.328662    0.988467    103.627982 
[37m[36mINFO[0m[0m 03/15 08:09:58 | 0.468706    0.466765    0.878378    0.824126    0.569845    0.384140    0.400000    0.396621    0.371134    0.878378    0.824126    0.625359    0.629162    200         1.801802    1.395724    0.161249    105.777063 
[37m[36mINFO[0m[0m 03/15 08:12:15 | 0.479544    0.486644    0.914414    0.850056    0.590926    0.428939    0.420619    0.368843    0.379152    0.914414    0.850056    0.640849    0.660161    400         3.603604    0.374223    0.157912    105.134309 
[37m[36mINFO[0m[0m 03/15 08:14:29 | 0.476248    0.476313    0.955518    0.865840    0.488276    0.389289    0.400000    0.410367    0.397480    0.955518    0.865840    0.629088    0.631458    600         5.405405    0.258963    0.151623    103.684532 
[37m[36mINFO[0m[0m 03/15 08:16:42 | 0.475295    0.476307    0.964809    0.863585    0.546349    0.411946    0.430928    0.401203    0.373425    0.964809    0.863585    0.612737    0.624569    800         7.207207    0.155047    0.156885    101.953197 
[37m[36mINFO[0m[0m 03/15 08:18:57 | 0.474774    0.487846    0.956363    0.857948    0.570336    0.410917    0.449485    0.378580    0.379152    0.956363    0.857948    0.634825    0.634902    1000        9.009009    0.118406    0.160890    102.724152 
[37m[36mINFO[0m[0m 03/15 08:21:16 | 0.463273    0.482500    0.967905    0.845547    0.681412    0.396498    0.428866    0.380011    0.384880    0.967905    0.845547    0.613310    0.633754    1200        10.810811   0.100177    0.168083    105.407446 
[37m[36mINFO[0m[0m 03/15 08:23:34 | 0.478350    0.483279    0.980856    0.891770    0.462246    0.402163    0.418557    0.392612    0.378007    0.980856    0.891770    0.640275    0.653272    1400        12.612613   0.078298    0.163958    105.328369 
[37m[36mINFO[0m[0m 03/15 08:25:49 | 0.497699    0.504046    0.983108    0.883878    0.504939    0.446447    0.476289    0.397194    0.387171    0.983108    0.883878    0.649455    0.648680    1600        14.414414   0.054811    0.152323    104.217931 
[37m[36mINFO[0m[0m 03/15 08:28:11 | 0.441067    0.458655    0.966779    0.853439    0.622748    0.385170    0.402062    0.337915    0.365407    0.966779    0.853439    0.600115    0.608496    1800        16.216216   0.062447    0.172269    107.529553 
[37m[36mINFO[0m[0m 03/15 08:30:28 | 0.488981    0.495886    0.984516    0.886133    0.547095    0.419156    0.428866    0.402921    0.396334    0.984516    0.886133    0.644865    0.662457    2000        18.018018   0.055554    0.158775    105.664011 
[37m[36mINFO[0m[0m 03/15 08:32:44 | 0.482414    0.493047    0.992399    0.890643    0.473728    0.410917    0.443299    0.394330    0.390607    0.992399    0.890643    0.641997    0.645235    2200        19.819820   0.047990    0.150852    105.407497 
[37m[36mINFO[0m[0m 03/15 08:34:59 | 0.494575    0.502689    0.992117    0.899662    0.480960    0.425335    0.420619    0.408648    0.415808    0.992117    0.899662    0.649742    0.671642    2400        21.621622   0.038956    0.158041    103.445374 
[37m[36mINFO[0m[0m 03/15 08:37:11 | 0.499350    0.509244    0.992680    0.895152    0.485381    0.425335    0.449485    0.418385    0.423826    0.992680    0.895152    0.654332    0.654420    2600        23.423423   0.033775    0.142443    103.327358 
[37m[36mINFO[0m[0m 03/15 08:39:30 | 0.486321    0.492672    0.994369    0.895152    0.539503    0.403708    0.432990    0.396334    0.390607    0.994369    0.895152    0.658921    0.654420    2800        25.225225   0.026447    0.177329    103.269172 
[37m[36mINFO[0m[0m 03/15 08:42:22 | 0.500113    0.498789    0.991836    0.905299    0.466974    0.422760    0.412371    0.426976    0.420389    0.991836    0.905299    0.650602    0.663605    3000        27.027027   0.026489    0.335849    104.872807 
[37m[36mINFO[0m[0m 03/15 08:44:34 | 0.510061    0.518190    0.993806    0.888388    0.496458    0.447992    0.486598    0.413230    0.398625    0.993806    0.888388    0.668962    0.669346    3200        28.828829   0.023031    0.146954    102.646787 
[37m[36mINFO[0m[0m 03/15 08:46:47 | 0.493491    0.505669    0.991273    0.889515    0.527104    0.421215    0.432990    0.404639    0.410080    0.991273    0.889515    0.654618    0.673938    3400        30.630631   0.023192    0.156281    102.479702 
[37m[36mINFO[0m[0m 03/15 08:49:10 | 0.481751    0.485799    0.994932    0.891770    0.499512    0.405767    0.422680    0.391753    0.380298    0.994932    0.891770    0.647734    0.654420    3600        32.432432   0.014852    0.188723    104.442885 
[37m[36mINFO[0m[0m 03/15 08:51:53 | 0.514705    0.522551    0.996340    0.908681    0.466787    0.443872    0.461856    0.424971    0.424971    0.996340    0.908681    0.675273    0.680827    3800        34.234234   0.019691    0.306089    101.878925 
[37m[36mINFO[0m[0m 03/15 08:54:04 | 0.486420    0.501142    0.987050    0.899662    0.479964    0.410917    0.441237    0.412658    0.416953    0.987050    0.899662    0.635686    0.645235    4000        36.036036   0.017190    0.150395    101.038818 
[37m[36mINFO[0m[0m 03/15 08:56:16 | 0.470146    0.492133    0.989583    0.881623    0.562614    0.368692    0.406186    0.412944    0.422680    0.989583    0.881623    0.628801    0.647532    4200        37.837838   0.039760    0.142726    103.712039 
[37m[36mINFO[0m[0m 03/15 08:58:51 | 0.497601    0.505673    0.993525    0.894025    0.523586    0.413491    0.412371    0.419530    0.426117    0.993525    0.894025    0.659782    0.678530    4400        39.639640   0.024124    0.263894    102.006971 
[37m[36mINFO[0m[0m 03/15 09:01:14 | 0.486033    0.494060    0.992399    0.897407    0.515856    0.401133    0.416495    0.402635    0.394044    0.992399    0.897407    0.654332    0.671642    4600        41.441441   0.021559    0.197491    103.959502 
[37m[36mINFO[0m[0m 03/15 09:03:26 | 0.481634    0.495669    0.995777    0.898534    0.467905    0.403708    0.424742    0.398625    0.383734    0.995777    0.898534    0.642570    0.678530    4800        43.243243   0.019887    0.141396    103.377160 
[37m[36mINFO[0m[0m 03/15 09:05:37 | 0.510166    0.514460    0.997185    0.900789    0.516255    0.435118    0.453608    0.417239    0.404353    0.997185    0.900789    0.678141    0.685419    5000        45.045045   0.008449    0.137450    103.802492 
[37m[36mINFO[0m[0m 03/15 09:05:37 | Cumulative gradient change saved at train_output/OfficeHome/GENIE/[0, 1, 3]/250315_08-05-54_resnet50_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/15 09:05:38 | ---
[37m[36mINFO[0m[0m 03/15 09:05:38 | test-domain validation(oracle) = 51.471%
[37m[36mINFO[0m[0m 03/15 09:05:38 | training-domain validation(iid) = 51.471%
[37m[36mINFO[0m[0m 03/15 09:05:38 | last = 51.017%
[37m[36mINFO[0m[0m 03/15 09:05:38 | last (inD) = 90.079%
[37m[36mINFO[0m[0m 03/15 09:05:38 | training-domain validation (iid, inD) = 90.868%
[37m[36mINFO[0m[0m 03/15 09:05:39 | === Summary ===
[37m[36mINFO[0m[0m 03/15 09:05:39 | Command: /jsm0707/GENIE/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm GENIE --test_envs 0 1 3 --dataset OfficeHome
[37m[36mINFO[0m[0m 03/15 09:05:39 | Unique name: 250315_08-05-54_resnet50_adam
[37m[36mINFO[0m[0m 03/15 09:05:39 | Out path: train_output/OfficeHome/GENIE/[0, 1, 3]/250315_08-05-54_resnet50_adam
[37m[36mINFO[0m[0m 03/15 09:05:39 | Algorithm: GENIE
[37m[36mINFO[0m[0m 03/15 09:05:39 | Dataset: OfficeHome

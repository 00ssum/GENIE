[37m[36mINFO[0m[0m 01/25 03:33:07 | Command :: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm gsnr1224 --test_envs 0 1 2 --dataset OfficeHome --trial_seed 2 --hparams_seed 14
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: gsnr1224
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 14
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/OfficeHome/gsnr1224/[0, 1, 2]/250125_03-33-07_resnet50_sgd
	out_root: train_output/OfficeHome/gsnr1224/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 2
	unique_name: 250125_03-33-07_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 4.223376545632674e-05
	batch_size: 27
	weight_decay: 1.4009530778122364e-05
	momentum: 0.97624308836667
	convergence_rate: 0.007433824219408728
	moving_avg: 0.9835243535862955
	p: 0.4547494637981545
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 01/25 03:33:07 | n_steps = 5001
[37m[36mINFO[0m[0m 01/25 03:33:07 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/25 03:33:07 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/25 03:33:07 | 
[37m[36mINFO[0m[0m 01/25 03:33:07 | Testenv name escaping te_A_C_P -> te_A_C_P
[37m[36mINFO[0m[0m 01/25 03:33:07 | Test envs = [0, 1, 2], name = te_A_C_P
[37m[36mINFO[0m[0m 01/25 03:33:07 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 01/25 03:33:07 | Batch sizes for each domain: [0, 0, 0, 27] (total=27)
[37m[36mINFO[0m[0m 01/25 03:33:07 | steps-per-epoch for each domain: 129.11 -> min = 129.11
[37m[36mINFO[0m[0m 01/25 03:33:09 | # of params = 23641217
[37m[36mINFO[0m[0m 01/25 03:35:04 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/25 03:35:04 | 0.018365    0.017867    0.023810    0.020666    4.217229    0.022142    0.020619    0.017468    0.018328    0.015484    0.014656    0.023810    0.020666    0           0.000000    4.398547    4.105165    110.392396 
[37m[36mINFO[0m[0m 01/25 03:38:46 | 0.514755    0.505893    0.749857    0.719862    0.988735    0.499485    0.488660    0.400916    0.410080    0.643863    0.618940    0.749857    0.719862    200         1.549053    2.669661    0.524871    116.389277 
[37m[36mINFO[0m[0m 01/25 03:42:27 | 0.560226    0.559652    0.849684    0.774971    0.777987    0.547374    0.564948    0.424971    0.437572    0.708333    0.676437    0.849684    0.774971    400         3.098107    0.839015    0.518104    116.767773 
[37m[36mINFO[0m[0m 01/25 03:46:07 | 0.579408    0.582922    0.888985    0.768083    0.785266    0.574665    0.581443    0.449313    0.458190    0.714245    0.709132    0.888985    0.768083    600         4.647160    0.554554    0.523737    114.823326 
[37m[36mINFO[0m[0m 01/25 03:49:40 | 0.589171    0.596444    0.917097    0.799082    0.686715    0.569516    0.597938    0.471363    0.483391    0.726633    0.708005    0.917097    0.799082    800         6.196213    0.395027    0.494234    113.447153 
[37m[36mINFO[0m[0m 01/25 03:53:12 | 0.594472    0.594565    0.940906    0.816303    0.742510    0.601957    0.608247    0.459049    0.473081    0.722410    0.702368    0.940906    0.816303    1000        7.745267    0.285991    0.523768    107.052953 
[37m[36mINFO[0m[0m 01/25 03:56:50 | 0.608697    0.606486    0.952668    0.816303    0.721363    0.600927    0.591753    0.479668    0.498282    0.745495    0.729425    0.952668    0.816303    1200        9.294320    0.228730    0.522226    113.092073 
[37m[36mINFO[0m[0m 01/25 04:00:28 | 0.586318    0.593707    0.962421    0.805970    0.784846    0.589598    0.620619    0.442440    0.454754    0.726914    0.705750    0.962421    0.805970    1400        10.843373   0.174650    0.508192    115.389754 
[37m[36mINFO[0m[0m 01/25 04:04:10 | 0.610769    0.620260    0.967585    0.816303    0.761033    0.598352    0.620619    0.483391    0.501718    0.750563    0.738444    0.967585    0.816303    1600        12.392427   0.164517    0.531913    115.735358 
[37m[36mINFO[0m[0m 01/25 04:07:45 | 0.602125    0.607698    0.974756    0.810563    0.781053    0.597837    0.622680    0.478809    0.483391    0.729730    0.717024    0.974756    0.810563    1800        13.941480   0.143472    0.496225    115.130174 
[37m[36mINFO[0m[0m 01/25 04:11:15 | 0.594664    0.594312    0.981641    0.818599    0.809710    0.594233    0.604124    0.467068    0.471936    0.722691    0.706877    0.981641    0.818599    2000        15.490534   0.117369    0.495678    110.749397 
[37m[36mINFO[0m[0m 01/25 04:14:46 | 0.603256    0.617977    0.981928    0.819747    0.769262    0.597837    0.643299    0.479668    0.487973    0.732264    0.722661    0.981928    0.819747    2200        17.039587   0.097192    0.497207    111.932739 
[37m[36mINFO[0m[0m 01/25 04:18:21 | 0.591262    0.611482    0.979920    0.823192    0.780213    0.550463    0.587629    0.487400    0.494845    0.735923    0.751973    0.979920    0.823192    2400        18.588640   0.095394    0.526722    109.368266 
[37m[36mINFO[0m[0m 01/25 04:21:59 | 0.618336    0.613353    0.986517    0.823192    0.741941    0.599382    0.591753    0.516323    0.517755    0.739302    0.730552    0.986517    0.823192    2600        20.137694   0.095414    0.549853    107.250281 
[37m[36mINFO[0m[0m 01/25 04:25:36 | 0.598499    0.594485    0.979633    0.820896    0.860207    0.609166    0.632990    0.464204    0.461627    0.722128    0.688839    0.979633    0.820896    2800        21.686747   0.075874    0.524094    112.614111 
[37m[36mINFO[0m[0m 01/25 04:29:15 | 0.599822    0.603233    0.987091    0.834673    0.711374    0.583934    0.597938    0.476231    0.487973    0.739302    0.723788    0.987091    0.834673    3000        23.235800   0.073740    0.532923    111.827993 
[37m[36mINFO[0m[0m 01/25 04:32:58 | 0.566817    0.564421    0.971601    0.800230    1.065812    0.556643    0.579381    0.430126    0.429553    0.713682    0.684329    0.971601    0.800230    3200        24.784854   0.061717    0.541873    115.014351 
[37m[36mINFO[0m[0m 01/25 04:36:33 | 0.601682    0.606569    0.994263    0.828932    0.877531    0.584964    0.600000    0.478809    0.491409    0.741273    0.728298    0.994263    0.828932    3400        26.333907   0.062678    0.516445    111.835056 
[37m[36mINFO[0m[0m 01/25 04:40:09 | 0.604458    0.609127    0.987091    0.819747    0.833006    0.600927    0.626804    0.476804    0.493700    0.735642    0.706877    0.987091    0.819747    3600        27.882960   0.066719    0.493332    116.942594 
[37m[36mINFO[0m[0m 01/25 04:43:45 | 0.623229    0.623874    0.994550    0.843858    0.851472    0.608136    0.626804    0.500573    0.510882    0.760980    0.733935    0.994550    0.843858    3800        29.432014   0.051719    0.513375    113.120805 
[37m[36mINFO[0m[0m 01/25 04:47:20 | 0.596072    0.593858    0.993976    0.831228    0.805114    0.572091    0.573196    0.477950    0.487973    0.738176    0.720406    0.993976    0.831228    4000        30.981067   0.049388    0.534102    107.849370 
[37m[36mINFO[0m[0m 01/25 04:50:52 | 0.608080    0.604933    0.991681    0.825488    0.867618    0.601957    0.595876    0.492554    0.513173    0.729730    0.705750    0.991681    0.825488    4200        32.530120   0.048944    0.507863    110.275313 
[37m[36mINFO[0m[0m 01/25 04:54:25 | 0.611146    0.604732    0.995410    0.816303    0.897766    0.605046    0.610309    0.487400    0.489118    0.740991    0.714769    0.995410    0.816303    4400        34.079174   0.044266    0.524112    108.732077 
[37m[36mINFO[0m[0m 01/25 04:57:58 | 0.620797    0.614706    0.994263    0.834673    0.856351    0.617920    0.628866    0.506014    0.494845    0.738457    0.720406    0.994263    0.834673    4600        35.628227   0.046326    0.516441    109.927196 
[37m[36mINFO[0m[0m 01/25 05:01:35 | 0.619192    0.623785    0.995123    0.818599    0.970751    0.599382    0.628866    0.501718    0.506300    0.756475    0.736189    0.995123    0.818599    4800        37.177281   0.035421    0.531854    109.737774 
[37m[36mINFO[0m[0m 01/25 05:05:06 | 0.615984    0.614891    0.993689    0.823192    0.970601    0.613800    0.630928    0.478522    0.470790    0.755631    0.742954    0.993689    0.823192    5000        38.726334   0.028932    0.516392    108.347619 
[37m[36mINFO[0m[0m 01/25 05:05:06 | Cumulative gradient change saved at train_output/OfficeHome/gsnr1224/[0, 1, 2]/250125_03-33-07_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/25 05:05:07 | ---
[37m[36mINFO[0m[0m 01/25 05:05:07 | test-domain validation(oracle) = 62.323%
[37m[36mINFO[0m[0m 01/25 05:05:07 | training-domain validation(iid) = 62.323%
[37m[36mINFO[0m[0m 01/25 05:05:07 | last = 61.598%
[37m[36mINFO[0m[0m 01/25 05:05:07 | last (inD) = 82.319%
[37m[36mINFO[0m[0m 01/25 05:05:07 | training-domain validation (iid, inD) = 84.386%
[37m[36mINFO[0m[0m 01/25 05:05:07 | === Summary ===
[37m[36mINFO[0m[0m 01/25 05:05:07 | Command: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm gsnr1224 --test_envs 0 1 2 --dataset OfficeHome --trial_seed 2 --hparams_seed 14
[37m[36mINFO[0m[0m 01/25 05:05:07 | Unique name: 250125_03-33-07_resnet50_sgd
[37m[36mINFO[0m[0m 01/25 05:05:07 | Out path: train_output/OfficeHome/gsnr1224/[0, 1, 2]/250125_03-33-07_resnet50_sgd
[37m[36mINFO[0m[0m 01/25 05:05:07 | Algorithm: gsnr1224
[37m[36mINFO[0m[0m 01/25 05:05:07 | Dataset: OfficeHome

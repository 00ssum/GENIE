[37m[36mINFO[0m[0m 01/31 17:52:47 | Command :: /jsm0707/Large-scale/train_all.py vit_MIRO_EVE config/vit_MIRO_EVE.yaml --algorithm MIRO --test_envs 0 --dataset OfficeHome --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: MIRO
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/vit_MIRO_EVE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: vit_MIRO_EVE
	out_dir: train_output/OfficeHome/MIRO/[0]/250131_17-52-47_vit_MIRO_EVE
	out_root: train_output/OfficeHome/MIRO/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250131_17-52-47_vit_MIRO_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: GENIE
	freeze_bn: False
	pretrained: True
	lr: 5.0781288859686544e-05
	batch_size: 44
	weight_decay: 0.00046410133598234803
	swad: False
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 01/31 17:52:47 | n_steps = 5001
[37m[36mINFO[0m[0m 01/31 17:52:47 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/31 17:52:47 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/31 17:52:47 | 
[37m[36mINFO[0m[0m 01/31 17:52:47 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 01/31 17:52:47 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 01/31 17:52:47 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 01/31 17:52:47 | Batch sizes for each domain: [0, 44, 44, 44] (total=132)
[37m[36mINFO[0m[0m 01/31 17:52:47 | steps-per-epoch for each domain: 79.36, 80.73, 79.23 -> min = 79.23
[37m[36mINFO[0m[0m 01/31 17:52:51 | # of params = 172422465
[37m[36mINFO[0m[0m 01/31 17:54:51 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        reg_loss    step_time   eval_time  
[37m[36mINFO[0m[0m 01/31 17:54:51 | 0.018023    0.039175    0.019187    0.017850    4.214979    0.018023    0.039175    0.020046    0.016037    0.018581    0.020293    0.018933    0.017222    0           0.000000    3.661222    -5.756464   1.378036    118.134426 
[37m[36mINFO[0m[0m 01/31 17:59:15 | 0.117405    0.125773    0.217373    0.192225    3.278761    0.117405    0.125773    0.196449    0.179840    0.250563    0.209696    0.205106    0.187141    200         2.524383    4.809550    8.990740    0.699398    122.887922 
[37m[36mINFO[0m[0m 01/31 18:03:35 | 0.403708    0.435052    0.695737    0.634201    1.438495    0.403708    0.435052    0.591638    0.491409    0.779279    0.740699    0.716294    0.670494    400         5.048766    1.828993    -3.383410   0.702415    117.104612 
[37m[36mINFO[0m[0m 01/31 18:08:04 | 0.488671    0.538144    0.866585    0.778750    0.864072    0.488671    0.538144    0.802119    0.646048    0.915822    0.864713    0.881813    0.825488    600         7.573150    0.481303    -3.778759   0.710740    125.905053 
[37m[36mINFO[0m[0m 01/31 18:12:45 | 0.589083    0.618557    0.932340    0.824439    0.657033    0.589083    0.618557    0.896048    0.745704    0.957770    0.890643    0.943201    0.836969    800         10.097533   -0.007026   -4.051160   0.790584    120.855812 
[37m[36mINFO[0m[0m 01/31 18:17:31 | 0.628218    0.663918    0.958492    0.844524    0.583732    0.628218    0.663918    0.931844    0.751432    0.977196    0.922210    0.966437    0.859931    1000        12.621916   -0.196447   -4.186883   0.784002    127.168980 
[37m[36mINFO[0m[0m 01/31 18:22:12 | 0.627188    0.655670    0.976870    0.848339    0.581055    0.627188    0.655670    0.963631    0.767468    0.986486    0.922210    0.980493    0.855339    1200        15.146299   -0.274577   -4.292032   0.758076    126.834531 
[37m[36mINFO[0m[0m 01/31 18:26:55 | 0.607106    0.630928    0.976895    0.851051    0.571096    0.607106    0.630928    0.963345    0.778923    0.982545    0.915445    0.984796    0.858783    1400        17.670683   -0.342672   -4.417504   0.733961    134.192761 
[37m[36mINFO[0m[0m 01/31 18:31:36 | 0.598352    0.600000    0.978669    0.841067    0.617511    0.598352    0.600000    0.961054    0.741123    0.989583    0.925592    0.985370    0.856487    1600        20.195066   -0.359890   -4.436651   0.792568    120.808677 
[37m[36mINFO[0m[0m 01/31 18:36:14 | 0.663749    0.703093    0.985902    0.870047    0.518688    0.663749    0.703093    0.973940    0.797251    0.993806    0.935738    0.989960    0.877153    1800        22.719449   -0.377368   -4.458481   0.803249    117.141110 
[37m[36mINFO[0m[0m 01/31 18:40:56 | 0.687951    0.711340    0.989054    0.879162    0.491141    0.687951    0.711340    0.977950    0.807560    0.994088    0.945885    0.995123    0.884041    2000        25.243832   -0.411796   -4.578389   0.770794    126.869223 
[37m[36mINFO[0m[0m 01/31 18:45:42 | 0.681771    0.690722    0.988471    0.875332    0.503366    0.681771    0.690722    0.978236    0.793814    0.995495    0.948140    0.991681    0.884041    2200        27.768216   -0.425256   -4.646403   0.768858    129.578503 
[37m[36mINFO[0m[0m 01/31 18:50:21 | 0.714727    0.740206    0.991056    0.883369    0.502649    0.714727    0.740206    0.984250    0.810997    0.994369    0.945885    0.994550    0.893226    2400        30.292599   -0.434306   -4.698367   0.775862    124.264014 
[37m[36mINFO[0m[0m 01/31 18:55:07 | 0.704943    0.731959    0.992288    0.886794    0.478454    0.704943    0.731959    0.984536    0.819015    0.996059    0.948140    0.996271    0.893226    2600        32.816982   -0.444941   -4.764380   0.800781    123.574322 
[37m[36mINFO[0m[0m 01/31 18:59:46 | 0.725026    0.752577    0.992192    0.886024    0.444262    0.725026    0.752577    0.983104    0.815578    0.996340    0.949267    0.997131    0.893226    2800        35.341365   -0.453501   -4.826920   0.763184    125.181767 
[37m[36mINFO[0m[0m 01/31 19:04:32 | 0.700309    0.740206    0.992280    0.887164    0.467771    0.700309    0.740206    0.983677    0.808706    0.997466    0.951522    0.995697    0.901263    3000        37.865749   -0.455262   -4.840799   0.766175    132.397478 
[37m[36mINFO[0m[0m 01/31 19:09:10 | 0.752832    0.777320    0.992952    0.897084    0.416055    0.752832    0.777320    0.985395    0.838488    0.996903    0.952649    0.996558    0.900115    3200        40.390132   -0.458284   -4.846910   0.758883    125.233357 
[37m[36mINFO[0m[0m 01/31 19:13:53 | 0.760556    0.775258    0.992949    0.900134    0.407007    0.760556    0.775258    0.985109    0.836197    0.997466    0.954904    0.996271    0.909300    3400        42.914515   -0.468222   -4.934974   0.817498    118.005604 
[37m[36mINFO[0m[0m 01/31 19:18:33 | 0.730690    0.746392    0.992190    0.891732    0.439114    0.730690    0.746392    0.983104    0.821306    0.996622    0.953777    0.996845    0.900115    3600        45.438898   -0.474818   -4.963114   0.775064    123.093126 
[37m[36mINFO[0m[0m 01/31 19:23:14 | 0.759526    0.762887    0.992765    0.898978    0.426720    0.759526    0.762887    0.984822    0.837342    0.996340    0.956032    0.997131    0.903559    3800        47.963282   -0.470250   -4.944569   0.767418    127.774377 
[37m[36mINFO[0m[0m 01/31 19:27:50 | 0.767765    0.793814    0.993143    0.902013    0.386422    0.767765    0.793814    0.985968    0.836197    0.996903    0.960541    0.996558    0.909300    4000        50.487665   -0.474120   -4.984002   0.735201    129.197716 
[37m[36mINFO[0m[0m 01/31 19:32:31 | 0.765191    0.783505    0.992948    0.900492    0.407933    0.765191    0.783505    0.985682    0.831615    0.997466    0.959414    0.995697    0.910448    4200        53.012048   -0.477336   -4.994524   0.771014    124.211924 
[37m[36mINFO[0m[0m 01/31 19:37:18 | 0.761586    0.785567    0.994093    0.895171    0.414038    0.761586    0.785567    0.987400    0.829324    0.997748    0.953777    0.997131    0.902411    4400        55.536431   -0.484187   -5.042541   0.770708    133.229598 

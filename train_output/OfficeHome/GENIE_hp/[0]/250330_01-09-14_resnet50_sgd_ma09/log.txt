[37m[36mINFO[0m[0m 03/30 01:09:14 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd_ma09 config/resnet50_sgd.yaml --algorithm GENIE_hp --test_envs 0 --dataset OfficeHome --trial_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE_hp
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd_ma09
	out_dir: train_output/OfficeHome/GENIE_hp/[0]/250330_01-09-14_resnet50_sgd_ma09
	out_root: train_output/OfficeHome/GENIE_hp/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 1
	unique_name: 250330_01-09-14_resnet50_sgd_ma09
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	momentum: 0.9
	convergence_rate: 0.015
	p: 0.4
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/30 01:09:14 | n_steps = 5001
[37m[36mINFO[0m[0m 03/30 01:09:14 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/30 01:09:14 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/30 01:09:14 | 
[37m[36mINFO[0m[0m 03/30 01:09:14 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/30 01:09:14 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/30 01:09:14 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/30 01:09:14 | Batch sizes for each domain: [0, 32, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/30 01:09:14 | steps-per-epoch for each domain: 109.12, 111.00, 108.94 -> min = 108.94
[37m[36mINFO[0m[0m 03/30 01:09:15 | # of params = 23641217
[37m[36mINFO[0m[0m 03/30 01:11:13 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/30 01:11:13 | 0.025747    0.030928    0.018272    0.021359    4.209212    0.025747    0.030928    0.014891    0.022910    0.012387    0.009019    0.027539    0.032147    0           0.000000    4.283313    1.052755    117.131819 
[37m[36mINFO[0m[0m 03/30 01:15:01 | 0.582389    0.630928    0.821768    0.765975    0.854584    0.582389    0.630928    0.748855    0.687285    0.870495    0.820744    0.845955    0.789897    200         1.835915    1.403190    0.544116    119.108409 
[37m[36mINFO[0m[0m 03/30 01:18:47 | 0.594233    0.624742    0.871175    0.791846    0.822435    0.594233    0.624742    0.826747    0.725086    0.898367    0.841037    0.888411    0.809414    400         3.671830    0.518995    0.542992    117.683070 
[37m[36mINFO[0m[0m 03/30 01:22:34 | 0.613800    0.639175    0.911268    0.796437    0.818967    0.613800    0.639175    0.881157    0.726231    0.934403    0.841037    0.918244    0.822044    600         5.507745    0.343811    0.525949    121.423943 
[37m[36mINFO[0m[0m 03/30 01:26:22 | 0.609166    0.632990    0.934278    0.817633    0.800464    0.609166    0.632990    0.904639    0.745704    0.952984    0.877114    0.945209    0.830080    800         7.343660    0.255922    0.539340    120.456972 
[37m[36mINFO[0m[0m 03/30 01:30:08 | 0.594748    0.616495    0.938940    0.813084    0.856209    0.594748    0.616495    0.916953    0.752577    0.955518    0.869222    0.944349    0.817451    1000        9.179575    0.200842    0.531419    119.660293 
[37m[36mINFO[0m[0m 03/30 01:33:56 | 0.602987    0.626804    0.953565    0.814190    0.853610    0.602987    0.626804    0.930985    0.735395    0.970158    0.878241    0.959552    0.828932    1200        11.015491   0.149658    0.544608    119.178942 
[37m[36mINFO[0m[0m 03/30 01:37:41 | 0.615860    0.632990    0.964794    0.823403    0.831885    0.615860    0.632990    0.945017    0.761741    0.977477    0.870349    0.971888    0.838117    1400        12.851406   0.120318    0.530991    118.431262 
[37m[36mINFO[0m[0m 03/30 01:41:28 | 0.600927    0.626804    0.966112    0.815709    0.843468    0.600927    0.626804    0.946735    0.741123    0.980574    0.879369    0.971027    0.826636    1600        14.687321   0.118004    0.554577    116.340187 
[37m[36mINFO[0m[0m 03/30 01:45:13 | 0.611226    0.651546    0.974147    0.825979    0.850232    0.611226    0.651546    0.964490    0.769759    0.978604    0.886133    0.979346    0.822044    1800        16.523236   0.085626    0.537322    117.569807 
[37m[36mINFO[0m[0m 03/30 01:49:00 | 0.610711    0.628866    0.971727    0.824462    0.842421    0.610711    0.628866    0.959049    0.760596    0.983671    0.885006    0.972461    0.827784    2000        18.359151   0.080340    0.531328    120.553076 
[37m[36mINFO[0m[0m 03/30 01:52:44 | 0.599382    0.614433    0.973249    0.827126    0.925615    0.599382    0.614433    0.963345    0.770905    0.984516    0.886133    0.971888    0.824340    2200        20.195066   0.070627    0.535231    116.734486 
[37m[36mINFO[0m[0m 03/30 01:56:26 | 0.584964    0.600000    0.974117    0.824475    0.940909    0.584964    0.600000    0.963345    0.780069    0.983390    0.880496    0.975617    0.812859    2400        22.030981   0.066578    0.538322    114.944157 
[37m[36mINFO[0m[0m 03/30 02:00:09 | 0.615860    0.655670    0.974519    0.825230    0.885970    0.615860    0.655670    0.966208    0.766323    0.980011    0.883878    0.977338    0.825488    2600        23.866896   0.061969    0.531061    116.159922 
[37m[36mINFO[0m[0m 03/30 02:03:47 | 0.641092    0.657732    0.984305    0.834739    0.860760    0.641092    0.657732    0.974513    0.778923    0.989302    0.891770    0.989099    0.833525    2800        25.702811   0.053177    0.514986    115.669858 
[37m[36mINFO[0m[0m 03/30 02:07:32 | 0.628733    0.647423    0.985921    0.847275    0.823610    0.628733    0.647423    0.978236    0.792669    0.990428    0.905299    0.989099    0.843858    3000        27.538726   0.050264    0.538760    116.710794 
[37m[36mINFO[0m[0m 03/30 02:11:10 | 0.622039    0.643299    0.987153    0.834330    0.906231    0.622039    0.643299    0.978809    0.768614    0.992117    0.897407    0.990534    0.836969    3200        29.374641   0.047905    0.527087    113.354251 
[37m[36mINFO[0m[0m 03/30 02:14:48 | 0.622039    0.635052    0.988385    0.829789    0.945358    0.622039    0.635052    0.979095    0.773196    0.993806    0.888388    0.992255    0.827784    3400        31.210557   0.043180    0.509198    115.816739 
[37m[36mINFO[0m[0m 03/30 02:18:26 | 0.627703    0.653608    0.986775    0.833596    0.862335    0.627703    0.653608    0.977663    0.781214    0.991554    0.890643    0.991107    0.828932    3600        33.046472   0.044105    0.503501    117.439868 
[37m[36mINFO[0m[0m 03/30 02:22:10 | 0.611740    0.612371    0.989240    0.831311    0.923477    0.611740    0.612371    0.980527    0.775487    0.994651    0.889515    0.992542    0.828932    3800        34.882387   0.041161    0.529069    118.345920 
[37m[36mINFO[0m[0m 03/30 02:25:51 | 0.615345    0.632990    0.988859    0.837024    0.976525    0.615345    0.632990    0.977950    0.775487    0.994651    0.894025    0.993976    0.841561    4000        36.718302   0.037790    0.499806    120.321814 
[37m[36mINFO[0m[0m 03/30 02:29:31 | 0.602987    0.616495    0.988099    0.831306    0.938159    0.602987    0.616495    0.978236    0.773196    0.993806    0.890643    0.992255    0.830080    4200        38.554217   0.036828    0.523465    115.698676 
[37m[36mINFO[0m[0m 03/30 02:33:15 | 0.605046    0.620619    0.988673    0.840438    0.909534    0.605046    0.620619    0.978522    0.770905    0.993806    0.899662    0.993689    0.850746    4400        40.390132   0.038621    0.528940    118.539491 
[37m[36mINFO[0m[0m 03/30 02:36:55 | 0.611740    0.663918    0.986960    0.833586    0.893454    0.611740    0.663918    0.978522    0.776632    0.992399    0.892897    0.989960    0.831228    4600        42.226047   0.038164    0.516489    116.662001 
[37m[36mINFO[0m[0m 03/30 02:40:33 | 0.625644    0.639175    0.989056    0.830545    0.989925    0.625644    0.639175    0.980527    0.776632    0.993525    0.889515    0.993115    0.825488    4800        44.061962   0.031338    0.520315    113.086494 
[37m[36mINFO[0m[0m 03/30 02:44:17 | 0.610196    0.649485    0.990102    0.828638    0.953308    0.610196    0.649485    0.981672    0.768614    0.994369    0.889515    0.994263    0.827784    5000        45.897877   0.036168    0.530763    118.386047 
[37m[36mINFO[0m[0m 03/30 02:44:17 | Cumulative gradient change saved at train_output/OfficeHome/GENIE_hp/[0]/250330_01-09-14_resnet50_sgd_ma09/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/30 02:44:19 | ---
[37m[36mINFO[0m[0m 03/30 02:44:19 | test-domain validation(oracle) = 61.174%
[37m[36mINFO[0m[0m 03/30 02:44:19 | training-domain validation(iid) = 62.873%
[37m[36mINFO[0m[0m 03/30 02:44:19 | last = 61.020%
[37m[36mINFO[0m[0m 03/30 02:44:19 | last (inD) = 82.864%
[37m[36mINFO[0m[0m 03/30 02:44:19 | training-domain validation (iid, inD) = 84.728%
[37m[36mINFO[0m[0m 03/30 02:44:19 | === Summary ===
[37m[36mINFO[0m[0m 03/30 02:44:19 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd_ma09 config/resnet50_sgd.yaml --algorithm GENIE_hp --test_envs 0 --dataset OfficeHome --trial_seed 1
[37m[36mINFO[0m[0m 03/30 02:44:19 | Unique name: 250330_01-09-14_resnet50_sgd_ma09
[37m[36mINFO[0m[0m 03/30 02:44:19 | Out path: train_output/OfficeHome/GENIE_hp/[0]/250330_01-09-14_resnet50_sgd_ma09
[37m[36mINFO[0m[0m 03/30 02:44:19 | Algorithm: GENIE_hp
[37m[36mINFO[0m[0m 03/30 02:44:19 | Dataset: OfficeHome

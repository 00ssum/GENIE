[37m[36mINFO[0m[0m 03/29 13:55:18 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd_ma0999 config/resnet50_sgd.yaml --algorithm GENIE_hp --test_envs 0 --dataset OfficeHome --trial_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE_hp
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd_ma0999
	out_dir: train_output/OfficeHome/GENIE_hp/[0]/250329_13-55-18_resnet50_sgd_ma0999
	out_root: train_output/OfficeHome/GENIE_hp/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 1
	unique_name: 250329_13-55-18_resnet50_sgd_ma0999
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	momentum: 0.9
	convergence_rate: 0.015
	p: 0.4
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/29 13:55:18 | n_steps = 5001
[37m[36mINFO[0m[0m 03/29 13:55:18 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/29 13:55:18 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/29 13:55:18 | 
[37m[36mINFO[0m[0m 03/29 13:55:18 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/29 13:55:18 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/29 13:55:18 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/29 13:55:18 | Batch sizes for each domain: [0, 32, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/29 13:55:18 | steps-per-epoch for each domain: 109.12, 111.00, 108.94 -> min = 108.94
[37m[36mINFO[0m[0m 03/29 13:55:19 | # of params = 23641217
[37m[36mINFO[0m[0m 03/29 13:57:22 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/29 13:57:22 | 0.025747    0.026804    0.018368    0.021359    4.209997    0.025747    0.026804    0.014891    0.022910    0.012387    0.009019    0.027826    0.032147    0           0.000000    4.283313    1.152613    121.255631 
[37m[36mINFO[0m[0m 03/29 14:01:12 | 0.529351    0.577320    0.729243    0.699177    1.079571    0.529351    0.577320    0.638603    0.608247    0.784065    0.739572    0.765060    0.749713    200         1.835915    1.725650    0.568642    116.800680 
[37m[36mINFO[0m[0m 03/29 14:05:00 | 0.559217    0.573196    0.800857    0.748992    0.919889    0.559217    0.573196    0.748282    0.682703    0.835586    0.782413    0.818703    0.781860    400         3.671830    0.818429    0.562907    114.845547 
[37m[36mINFO[0m[0m 03/29 14:08:52 | 0.537075    0.569072    0.839192    0.781910    0.874895    0.537075    0.569072    0.793528    0.723940    0.878378    0.838782    0.845668    0.783008    600         5.507745    0.601944    0.556863    120.723683 
[37m[36mINFO[0m[0m 03/29 14:12:40 | 0.558702    0.602062    0.872958    0.779665    0.867380    0.558702    0.602062    0.836483    0.729668    0.902872    0.829763    0.879518    0.779564    800         7.343660    0.489203    0.561045    116.315898 
[37m[36mINFO[0m[0m 03/29 14:16:24 | 0.553553    0.587629    0.893658    0.794848    0.835552    0.553553    0.587629    0.857675    0.739977    0.923986    0.848929    0.899312    0.795637    1000        9.179575    0.401409    0.528345    118.165375 
[37m[36mINFO[0m[0m 03/29 14:20:11 | 0.569001    0.585567    0.909125    0.807372    0.843668    0.569001    0.585567    0.875716    0.733104    0.941160    0.866967    0.910499    0.822044    1200        11.015491   0.318489    0.556178    115.572462 
[37m[36mINFO[0m[0m 03/29 14:23:57 | 0.566941    0.587629    0.924566    0.803894    0.875946    0.566941    0.587629    0.894616    0.731959    0.947354    0.872604    0.931727    0.807118    1400        12.851406   0.276630    0.549208    116.551521 
[37m[36mINFO[0m[0m 03/29 14:27:45 | 0.587539    0.606186    0.941994    0.814213    0.864004    0.587539    0.606186    0.924685    0.750286    0.955800    0.872604    0.945496    0.819747    1600        14.687321   0.224991    0.554052    116.947294 
[37m[36mINFO[0m[0m 03/29 14:31:32 | 0.561277    0.602062    0.951284    0.822150    0.871746    0.561277    0.602062    0.929267    0.753723    0.968187    0.888388    0.956397    0.824340    1800        16.523236   0.180187    0.552133    116.653802 
[37m[36mINFO[0m[0m 03/29 14:35:17 | 0.575180    0.612371    0.954737    0.810386    0.974228    0.575180    0.612371    0.937285    0.750286    0.965653    0.872604    0.961274    0.808266    2000        18.359151   0.156796    0.541428    116.688349 
[37m[36mINFO[0m[0m 03/29 14:39:06 | 0.561277    0.583505    0.959183    0.810384    0.976644    0.561277    0.583505    0.943872    0.752577    0.972691    0.872604    0.960987    0.805970    2200        20.195066   0.136378    0.544700    119.974488 
[37m[36mINFO[0m[0m 03/29 14:42:55 | 0.576725    0.608247    0.968407    0.818692    0.943190    0.576725    0.608247    0.950458    0.753723    0.980293    0.890643    0.974469    0.811711    2400        22.030981   0.118128    0.553349    118.519288 
[37m[36mINFO[0m[0m 03/29 14:46:47 | 0.576725    0.602062    0.965816    0.821773    0.968642    0.576725    0.602062    0.946735    0.754868    0.981982    0.887260    0.968732    0.823192    2600        23.866896   0.102202    0.574376    117.228586 
[37m[36mINFO[0m[0m 03/29 14:50:32 | 0.572606    0.602062    0.970128    0.823295    1.000724    0.572606    0.602062    0.953895    0.767468    0.980011    0.887260    0.976477    0.815155    2800        25.702811   0.088938    0.548455    114.457176 
[37m[36mINFO[0m[0m 03/29 14:54:23 | 0.581874    0.606186    0.976977    0.817939    1.000563    0.581874    0.606186    0.962486    0.756014    0.984797    0.888388    0.983649    0.809414    3000        27.538726   0.078974    0.564109    118.583168 
[37m[36mINFO[0m[0m 03/29 14:58:15 | 0.558187    0.595876    0.979936    0.826355    1.050259    0.558187    0.595876    0.968213    0.768614    0.985079    0.887260    0.986517    0.823192    3200        29.374641   0.070116    0.559376    120.318723 
[37m[36mINFO[0m[0m 03/29 15:02:01 | 0.583934    0.602062    0.980890    0.821806    1.043820    0.583934    0.602062    0.969645    0.775487    0.985360    0.879369    0.987665    0.810563    3400        31.210557   0.070408    0.545660    116.216817 
[37m[36mINFO[0m[0m 03/29 15:05:45 | 0.589598    0.618557    0.982967    0.826704    0.995072    0.589598    0.618557    0.970504    0.767468    0.989583    0.892897    0.988812    0.819747    3600        33.046472   0.060391    0.535035    117.364834 
[37m[36mINFO[0m[0m 03/29 15:09:33 | 0.563337    0.610309    0.982212    0.825173    1.018552    0.563337    0.610309    0.971649    0.759450    0.987894    0.894025    0.987091    0.822044    3800        34.882387   0.059952    0.561784    115.789556 
[37m[36mINFO[0m[0m 03/29 15:13:20 | 0.593203    0.620619    0.986206    0.817207    1.032676    0.593203    0.620619    0.978522    0.766323    0.990709    0.881623    0.989386    0.803674    4000        36.718302   0.052723    0.533890    120.516076 
[37m[36mINFO[0m[0m 03/29 15:17:14 | 0.573120    0.593814    0.983717    0.825972    1.053506    0.573120    0.593814    0.971649    0.769759    0.991836    0.887260    0.987665    0.820896    4200        38.554217   0.047309    0.562897    120.953389 
[37m[36mINFO[0m[0m 03/29 15:21:07 | 0.574665    0.608247    0.984770    0.827513    1.045064    0.574665    0.608247    0.975372    0.765178    0.991273    0.886133    0.987665    0.831228    4400        40.390132   0.050004    0.558022    121.401193 
[37m[36mINFO[0m[0m 03/29 15:24:52 | 0.581874    0.606186    0.986204    0.833975    0.985298    0.581874    0.606186    0.978522    0.777778    0.990991    0.891770    0.989099    0.832377    4600        42.226047   0.046685    0.549376    114.820570 
[37m[36mINFO[0m[0m 03/29 15:28:35 | 0.573120    0.600000    0.987825    0.832844    0.943651    0.573120    0.600000    0.980241    0.782360    0.991554    0.888388    0.991681    0.827784    4800        44.061962   0.042710    0.538863    115.880086 
[37m[36mINFO[0m[0m 03/29 15:32:26 | 0.584964    0.614433    0.986012    0.829344    0.929879    0.584964    0.614433    0.976804    0.782360    0.991273    0.897407    0.989960    0.808266    5000        45.897877   0.040159    0.563766    117.861118 
[37m[36mINFO[0m[0m 03/29 15:32:26 | Cumulative gradient change saved at train_output/OfficeHome/GENIE_hp/[0]/250329_13-55-18_resnet50_sgd_ma0999/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/29 15:32:27 | ---
[37m[36mINFO[0m[0m 03/29 15:32:27 | test-domain validation(oracle) = 59.320%
[37m[36mINFO[0m[0m 03/29 15:32:27 | training-domain validation(iid) = 58.187%
[37m[36mINFO[0m[0m 03/29 15:32:27 | last = 58.496%
[37m[36mINFO[0m[0m 03/29 15:32:27 | last (inD) = 82.934%
[37m[36mINFO[0m[0m 03/29 15:32:27 | training-domain validation (iid, inD) = 83.397%
[37m[36mINFO[0m[0m 03/29 15:32:28 | === Summary ===
[37m[36mINFO[0m[0m 03/29 15:32:28 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd_ma0999 config/resnet50_sgd.yaml --algorithm GENIE_hp --test_envs 0 --dataset OfficeHome --trial_seed 1
[37m[36mINFO[0m[0m 03/29 15:32:28 | Unique name: 250329_13-55-18_resnet50_sgd_ma0999
[37m[36mINFO[0m[0m 03/29 15:32:28 | Out path: train_output/OfficeHome/GENIE_hp/[0]/250329_13-55-18_resnet50_sgd_ma0999
[37m[36mINFO[0m[0m 03/29 15:32:28 | Algorithm: GENIE_hp
[37m[36mINFO[0m[0m 03/29 15:32:28 | Dataset: OfficeHome

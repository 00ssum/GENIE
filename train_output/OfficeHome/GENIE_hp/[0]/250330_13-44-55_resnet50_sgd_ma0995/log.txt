[37m[36mINFO[0m[0m 03/30 13:44:55 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd_ma0995 config/resnet50_sgd.yaml --algorithm GENIE_hp --test_envs 0 --dataset OfficeHome --trial_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE_hp
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd_ma0995
	out_dir: train_output/OfficeHome/GENIE_hp/[0]/250330_13-44-55_resnet50_sgd_ma0995
	out_root: train_output/OfficeHome/GENIE_hp/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 1
	unique_name: 250330_13-44-55_resnet50_sgd_ma0995
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	momentum: 0.9
	convergence_rate: 0.015
	p: 0.4
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/30 13:44:55 | n_steps = 5001
[37m[36mINFO[0m[0m 03/30 13:44:55 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/30 13:44:55 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/30 13:44:55 | 
[37m[36mINFO[0m[0m 03/30 13:44:55 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/30 13:44:55 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/30 13:44:55 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/30 13:44:55 | Batch sizes for each domain: [0, 32, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/30 13:44:55 | steps-per-epoch for each domain: 109.12, 111.00, 108.94 -> min = 108.94
[37m[36mINFO[0m[0m 03/30 13:44:56 | # of params = 23641217
[37m[36mINFO[0m[0m 03/30 13:46:52 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/30 13:46:52 | 0.026262    0.026804    0.017230    0.019473    4.213806    0.026262    0.026804    0.014318    0.022910    0.010980    0.004510    0.026391    0.030999    0           0.000000    4.283313    1.068829    114.759300 
[37m[36mINFO[0m[0m 03/30 13:50:39 | 0.574150    0.614433    0.755639    0.719247    1.012718    0.574150    0.614433    0.672394    0.634593    0.810529    0.771139    0.783993    0.752009    200         1.835915    1.702695    0.532949    120.849219 
[37m[36mINFO[0m[0m 03/30 13:54:35 | 0.572606    0.604124    0.839141    0.782293    0.790057    0.572606    0.604124    0.788946    0.696449    0.871622    0.842165    0.856856    0.808266    400         3.671830    0.710175    0.557546    124.353377 
[37m[36mINFO[0m[0m 03/30 13:58:25 | 0.571576    0.589691    0.881136    0.802396    0.774957    0.571576    0.589691    0.840493    0.742268    0.909628    0.865840    0.893287    0.799082    600         5.507745    0.470887    0.537163    122.685491 
[37m[36mINFO[0m[0m 03/30 14:02:15 | 0.597322    0.620619    0.911747    0.805859    0.757925    0.597322    0.620619    0.874284    0.736541    0.934966    0.863585    0.925990    0.817451    800         7.343660    0.346838    0.541835    121.486562 
[37m[36mINFO[0m[0m 03/30 14:05:57 | 0.611226    0.647423    0.938744    0.830563    0.758114    0.611226    0.647423    0.915808    0.762887    0.956363    0.888388    0.944062    0.840413    1000        9.179575    0.259236    0.522188    117.943203 
[37m[36mINFO[0m[0m 03/30 14:09:50 | 0.611740    0.641237    0.949883    0.816133    0.814197    0.611740    0.641237    0.932990    0.750286    0.962556    0.871477    0.954102    0.826636    1200        11.015491   0.187441    0.545782    123.574089 
[37m[36mINFO[0m[0m 03/30 14:13:39 | 0.579815    0.612371    0.948923    0.810008    0.862434    0.579815    0.612371    0.926117    0.726231    0.963682    0.874859    0.956971    0.828932    1400        12.851406   0.153653    0.534337    122.499900 
[37m[36mINFO[0m[0m 03/30 14:17:28 | 0.608136    0.645361    0.967934    0.819884    0.855110    0.608136    0.645361    0.953036    0.768614    0.979167    0.881623    0.971601    0.809414    1600        14.687321   0.132386    0.549077    119.124691 
[37m[36mINFO[0m[0m 03/30 14:21:15 | 0.584449    0.618557    0.969857    0.812284    0.865151    0.584449    0.618557    0.955899    0.743414    0.977196    0.875986    0.976477    0.817451    1800        16.523236   0.108715    0.541577    118.563171 
[37m[36mINFO[0m[0m 03/30 14:24:59 | 0.612255    0.663918    0.972974    0.826328    0.872206    0.612255    0.663918    0.962486    0.768614    0.982827    0.891770    0.973609    0.818599    2000        18.359151   0.101436    0.522820    118.961724 
[37m[36mINFO[0m[0m 03/30 14:28:44 | 0.594748    0.624742    0.968416    0.824870    0.840344    0.594748    0.624742    0.955326    0.772050    0.978322    0.879369    0.971601    0.823192    2200        20.195066   0.093732    0.533399    118.546924 
[37m[36mINFO[0m[0m 03/30 14:32:30 | 0.588568    0.618557    0.976601    0.825566    0.872806    0.588568    0.618557    0.963918    0.764032    0.983671    0.891770    0.982215    0.820896    2400        22.030981   0.088554    0.540345    118.029171 
[37m[36mINFO[0m[0m 03/30 14:36:15 | 0.605561    0.649485    0.980016    0.830564    0.820809    0.605561    0.649485    0.965922    0.778923    0.987894    0.886133    0.986231    0.826636    2600        23.866896   0.069337    0.543670    116.472727 
[37m[36mINFO[0m[0m 03/30 14:40:02 | 0.609681    0.643299    0.979536    0.822515    0.862908    0.609681    0.643299    0.965349    0.767468    0.988176    0.889515    0.985083    0.810563    2800        25.702811   0.058848    0.540109    118.511991 
[37m[36mINFO[0m[0m 03/30 14:43:51 | 0.598867    0.626804    0.983252    0.836184    0.901593    0.598867    0.626804    0.975372    0.774341    0.989302    0.906426    0.985083    0.827784    3000        27.538726   0.053153    0.549445    118.979115 
[37m[36mINFO[0m[0m 03/30 14:47:38 | 0.617920    0.655670    0.984592    0.836595    0.831709    0.617920    0.655670    0.973654    0.782360    0.989302    0.900789    0.990820    0.826636    3200        29.374641   0.054397    0.537412    119.511877 
[37m[36mINFO[0m[0m 03/30 14:51:19 | 0.600927    0.622680    0.984210    0.830885    0.888323    0.600927    0.622680    0.975945    0.769759    0.989020    0.897407    0.987665    0.825488    3400        31.210557   0.052742    0.524622    116.615101 
[37m[36mINFO[0m[0m 03/30 14:55:02 | 0.593718    0.641237    0.982401    0.827566    0.876734    0.593718    0.641237    0.974227    0.768614    0.987894    0.877114    0.985083    0.836969    3600        33.046472   0.052834    0.518396    118.994214 
[37m[36mINFO[0m[0m 03/30 14:58:48 | 0.607621    0.628866    0.983357    0.823298    0.947371    0.607621    0.628866    0.974800    0.772050    0.987894    0.886133    0.987378    0.811711    3800        34.882387   0.051501    0.546281    116.390639 
[37m[36mINFO[0m[0m 03/30 15:02:29 | 0.584964    0.618557    0.986577    0.824044    0.951419    0.584964    0.618557    0.975945    0.769759    0.992680    0.889515    0.991107    0.812859    4000        36.718302   0.044432    0.523752    116.977850 
[37m[36mINFO[0m[0m 03/30 15:06:17 | 0.606076    0.632990    0.984380    0.829836    0.973915    0.606076    0.632990    0.969645    0.766323    0.992962    0.881623    0.990534    0.841561    4200        38.554217   0.041957    0.544978    118.911906 
[37m[36mINFO[0m[0m 03/30 15:10:10 | 0.581359    0.600000    0.987812    0.829029    0.910999    0.581359    0.600000    0.977950    0.775487    0.993806    0.887260    0.991681    0.824340    4400        40.390132   0.042211    0.550712    122.693259 
[37m[36mINFO[0m[0m 03/30 15:13:54 | 0.567971    0.597938    0.987536    0.829786    0.886584    0.567971    0.597938    0.978236    0.777778    0.992117    0.888388    0.992255    0.823192    4600        42.226047   0.038597    0.537293    116.257868 
[37m[36mINFO[0m[0m 03/30 15:17:40 | 0.596807    0.635052    0.987720    0.830174    0.922001    0.596807    0.635052    0.978236    0.770905    0.993243    0.888388    0.991681    0.831228    4800        44.061962   0.033752    0.537509    118.371943 
[37m[36mINFO[0m[0m 03/30 15:21:39 | 0.582389    0.618557    0.988107    0.824027    0.947537    0.582389    0.618557    0.979668    0.765178    0.992399    0.892897    0.992255    0.814007    5000        45.897877   0.037178    0.568120    125.452558 
[37m[36mINFO[0m[0m 03/30 15:21:39 | Cumulative gradient change saved at train_output/OfficeHome/GENIE_hp/[0]/250330_13-44-55_resnet50_sgd_ma0995/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/30 15:21:40 | ---
[37m[36mINFO[0m[0m 03/30 15:21:40 | test-domain validation(oracle) = 61.226%
[37m[36mINFO[0m[0m 03/30 15:21:40 | training-domain validation(iid) = 61.792%
[37m[36mINFO[0m[0m 03/30 15:21:40 | last = 58.239%
[37m[36mINFO[0m[0m 03/30 15:21:40 | last (inD) = 82.403%
[37m[36mINFO[0m[0m 03/30 15:21:40 | training-domain validation (iid, inD) = 83.659%
[37m[36mINFO[0m[0m 03/30 15:21:40 | === Summary ===
[37m[36mINFO[0m[0m 03/30 15:21:40 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd_ma0995 config/resnet50_sgd.yaml --algorithm GENIE_hp --test_envs 0 --dataset OfficeHome --trial_seed 1
[37m[36mINFO[0m[0m 03/30 15:21:40 | Unique name: 250330_13-44-55_resnet50_sgd_ma0995
[37m[36mINFO[0m[0m 03/30 15:21:40 | Out path: train_output/OfficeHome/GENIE_hp/[0]/250330_13-44-55_resnet50_sgd_ma0995
[37m[36mINFO[0m[0m 03/30 15:21:40 | Algorithm: GENIE_hp
[37m[36mINFO[0m[0m 03/30 15:21:40 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 03/30 02:44:23 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd_ma09 config/resnet50_sgd.yaml --algorithm GENIE_hp --test_envs 2 --dataset OfficeHome --trial_seed 0
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE_hp
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd_ma09
	out_dir: train_output/OfficeHome/GENIE_hp/[2]/250330_02-44-23_resnet50_sgd_ma09
	out_root: train_output/OfficeHome/GENIE_hp/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250330_02-44-23_resnet50_sgd_ma09
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	momentum: 0.9
	convergence_rate: 0.015
	p: 0.4
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/30 02:44:23 | n_steps = 5001
[37m[36mINFO[0m[0m 03/30 02:44:23 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/30 02:44:23 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/30 02:44:23 | 
[37m[36mINFO[0m[0m 03/30 02:44:23 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 03/30 02:44:23 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 03/30 02:44:23 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 03/30 02:44:23 | Batch sizes for each domain: [32, 32, 0, 32] (total=96)
[37m[36mINFO[0m[0m 03/30 02:44:23 | steps-per-epoch for each domain: 60.69, 109.12, 108.94 -> min = 60.69
[37m[36mINFO[0m[0m 03/30 02:44:24 | # of params = 23641217
[37m[36mINFO[0m[0m 03/30 02:46:20 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/30 02:46:20 | 0.007601    0.009019    0.017222    0.014295    4.222817    0.024717    0.016495    0.008591    0.006873    0.007601    0.009019    0.018359    0.019518    0           0.000000    4.290899    0.987116    115.114632 
[37m[36mINFO[0m[0m 03/30 02:49:58 | 0.702984    0.684329    0.800080    0.725756    1.096399    0.822348    0.729897    0.745132    0.670103    0.702984    0.684329    0.832760    0.777268    200         3.295572    1.542325    0.508094    116.616078 
[37m[36mINFO[0m[0m 03/30 02:53:38 | 0.726633    0.702368    0.868446    0.738214    1.059394    0.896498    0.723711    0.831615    0.699885    0.726633    0.702368    0.877223    0.791045    400         6.591143    0.544242    0.517520    116.251394 
[37m[36mINFO[0m[0m 03/30 02:57:14 | 0.740709    0.735062    0.921625    0.772149    0.941337    0.950566    0.756701    0.886598    0.730813    0.740709    0.735062    0.927711    0.828932    600         9.886715    0.363125    0.511683    113.577087 
[37m[36mINFO[0m[0m 03/30 03:00:48 | 0.750845    0.723788    0.920782    0.743322    1.089420    0.942327    0.729897    0.903207    0.719359    0.750845    0.723788    0.916810    0.780712    800         13.182286   0.254180    0.492374    115.658890 
[37m[36mINFO[0m[0m 03/30 03:04:27 | 0.742117    0.718151    0.950212    0.756248    1.160165    0.967559    0.731959    0.932990    0.729668    0.742117    0.718151    0.950086    0.807118    1000        16.477858   0.192197    0.532935    112.557848 
[37m[36mINFO[0m[0m 03/30 03:08:04 | 0.744651    0.730552    0.964840    0.772595    1.063367    0.982492    0.754639    0.945876    0.750286    0.744651    0.730552    0.966150    0.812859    1200        19.773429   0.146865    0.511967    114.076488 
[37m[36mINFO[0m[0m 03/30 03:11:39 | 0.748874    0.717024    0.962512    0.764734    1.188307    0.978373    0.740206    0.943013    0.735395    0.748874    0.717024    0.966150    0.818599    1400        23.069001   0.123888    0.519839    111.598201 
[37m[36mINFO[0m[0m 03/30 03:15:17 | 0.754223    0.729425    0.974084    0.766637    1.227695    0.988157    0.740206    0.957331    0.749141    0.754223    0.729425    0.976764    0.810563    1600        26.364573   0.110830    0.517504    114.129938 
[37m[36mINFO[0m[0m 03/30 03:18:55 | 0.744651    0.713641    0.974197    0.771305    1.251525    0.985067    0.748454    0.965349    0.741123    0.744651    0.713641    0.972174    0.824340    1800        29.660144   0.082387    0.512848    115.329240 
[37m[36mINFO[0m[0m 03/30 03:22:31 | 0.753378    0.744081    0.976454    0.778479    1.317039    0.983522    0.750515    0.967640    0.766323    0.753378    0.744081    0.978199    0.818599    2000        32.955716   0.070905    0.521183    111.654346 
[37m[36mINFO[0m[0m 03/30 03:26:04 | 0.746059    0.730552    0.984457    0.788564    1.196004    0.989186    0.767010    0.976231    0.774341    0.746059    0.730552    0.987952    0.824340    2200        36.251287   0.073094    0.516283    110.327199 
[37m[36mINFO[0m[0m 03/30 03:29:44 | 0.755912    0.736189    0.980216    0.787188    1.255093    0.990216    0.773196    0.965349    0.766323    0.755912    0.736189    0.985083    0.822044    2400        39.546859   0.054080    0.529706    113.636303 
[37m[36mINFO[0m[0m 03/30 03:33:21 | 0.748029    0.736189    0.983174    0.769543    1.344748    0.992791    0.744330    0.973081    0.747995    0.748029    0.736189    0.983649    0.816303    2600        42.842430   0.055928    0.518164    113.899729 
[37m[36mINFO[0m[0m 03/30 03:36:58 | 0.762106    0.735062    0.985469    0.776493    1.280124    0.992791    0.762887    0.972795    0.749141    0.762106    0.735062    0.990820    0.817451    2800        46.138002   0.055291    0.508624    114.567839 
[37m[36mINFO[0m[0m 03/30 03:40:35 | 0.765766    0.748591    0.987014    0.781456    1.363841    0.992276    0.762887    0.980813    0.765178    0.765766    0.748591    0.987952    0.816303    3000        49.433574   0.044212    0.517874    113.617493 
[37m[36mINFO[0m[0m 03/30 03:44:07 | 0.765766    0.766629    0.986308    0.790469    1.266891    0.993306    0.777320    0.975945    0.774341    0.765766    0.766629    0.989673    0.819747    3200        52.729145   0.042252    0.493857    113.021990 
[37m[36mINFO[0m[0m 03/30 03:47:47 | 0.761261    0.746336    0.990777    0.778409    1.340318    0.993821    0.752577    0.984822    0.756014    0.761261    0.746336    0.993689    0.826636    3400        56.024717   0.039186    0.523856    115.871584 
[37m[36mINFO[0m[0m 03/30 03:51:23 | 0.758446    0.736189    0.989708    0.787567    1.275381    0.994336    0.773196    0.981386    0.770905    0.758446    0.736189    0.993402    0.818599    3600        59.320288   0.039392    0.504119    114.477607 
[37m[36mINFO[0m[0m 03/30 03:55:02 | 0.757320    0.736189    0.990548    0.774737    1.371101    0.994851    0.758763    0.982532    0.747995    0.757320    0.736189    0.994263    0.817451    3800        62.615860   0.038573    0.531867    112.525701 
[37m[36mINFO[0m[0m 03/30 03:58:42 | 0.750282    0.724915    0.988104    0.778709    1.242530    0.993821    0.764948    0.978522    0.751432    0.750282    0.724915    0.991968    0.819747    4000        65.911432   0.035709    0.516654    117.001987 
[37m[36mINFO[0m[0m 03/30 04:02:23 | 0.764640    0.748591    0.990453    0.773288    1.350444    0.994851    0.746392    0.982818    0.752577    0.764640    0.748591    0.993689    0.820896    4200        69.207003   0.032331    0.522115    116.390635 
[37m[36mINFO[0m[0m 03/30 04:05:59 | 0.762669    0.735062    0.989230    0.787799    1.327628    0.994336    0.787629    0.981672    0.752577    0.762669    0.735062    0.991681    0.823192    4400        72.502575   0.031836    0.501015    116.586867 
[37m[36mINFO[0m[0m 03/30 04:09:36 | 0.759291    0.732807    0.991102    0.788107    1.340445    0.995366    0.769072    0.983391    0.769759    0.759291    0.732807    0.994550    0.825488    4600        75.798146   0.030945    0.505305    115.370581 
[37m[36mINFO[0m[0m 03/30 04:13:12 | 0.759291    0.758737    0.989001    0.788555    1.272135    0.995366    0.787629    0.978522    0.765178    0.759291    0.758737    0.993115    0.812859    4800        79.093718   0.031666    0.505291    115.024968 
[37m[36mINFO[0m[0m 03/30 04:16:51 | 0.767736    0.732807    0.990146    0.780159    1.511373    0.995366    0.767010    0.983677    0.754868    0.767736    0.732807    0.991394    0.818599    5000        82.389289   0.029674    0.514039    115.979988 
[37m[36mINFO[0m[0m 03/30 04:16:51 | Cumulative gradient change saved at train_output/OfficeHome/GENIE_hp/[2]/250330_02-44-23_resnet50_sgd_ma09/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/30 04:16:52 | ---
[37m[36mINFO[0m[0m 03/30 04:16:52 | test-domain validation(oracle) = 76.577%
[37m[36mINFO[0m[0m 03/30 04:16:52 | training-domain validation(iid) = 76.577%
[37m[36mINFO[0m[0m 03/30 04:16:52 | last = 76.774%
[37m[36mINFO[0m[0m 03/30 04:16:52 | last (inD) = 78.016%
[37m[36mINFO[0m[0m 03/30 04:16:52 | training-domain validation (iid, inD) = 79.047%
[37m[36mINFO[0m[0m 03/30 04:16:52 | === Summary ===
[37m[36mINFO[0m[0m 03/30 04:16:52 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd_ma09 config/resnet50_sgd.yaml --algorithm GENIE_hp --test_envs 2 --dataset OfficeHome --trial_seed 0
[37m[36mINFO[0m[0m 03/30 04:16:52 | Unique name: 250330_02-44-23_resnet50_sgd_ma09
[37m[36mINFO[0m[0m 03/30 04:16:52 | Out path: train_output/OfficeHome/GENIE_hp/[2]/250330_02-44-23_resnet50_sgd_ma09
[37m[36mINFO[0m[0m 03/30 04:16:52 | Algorithm: GENIE_hp
[37m[36mINFO[0m[0m 03/30 04:16:52 | Dataset: OfficeHome

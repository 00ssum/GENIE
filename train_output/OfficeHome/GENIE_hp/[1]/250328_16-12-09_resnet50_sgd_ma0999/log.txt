[37m[36mINFO[0m[0m 03/28 16:12:09 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd_ma0999 config/resnet50_sgd.yaml --algorithm GENIE_hp --test_envs 1 --dataset OfficeHome --trial_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE_hp
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd_ma0999
	out_dir: train_output/OfficeHome/GENIE_hp/[1]/250328_16-12-09_resnet50_sgd_ma0999
	out_root: train_output/OfficeHome/GENIE_hp/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250328_16-12-09_resnet50_sgd_ma0999
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	momentum: 0.9
	convergence_rate: 0.015
	p: 0.4
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/28 16:12:09 | n_steps = 5001
[37m[36mINFO[0m[0m 03/28 16:12:09 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/28 16:12:09 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/28 16:12:09 | 
[37m[36mINFO[0m[0m 03/28 16:12:09 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/28 16:12:09 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/28 16:12:09 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/28 16:12:09 | Batch sizes for each domain: [32, 0, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/28 16:12:09 | steps-per-epoch for each domain: 60.69, 111.00, 108.94 -> min = 60.69
[37m[36mINFO[0m[0m 03/28 16:12:10 | # of params = 23641217
[37m[36mINFO[0m[0m 03/28 16:14:12 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/28 16:14:12 | 0.014605    0.022910    0.019115    0.019758    4.186729    0.023687    0.022680    0.014605    0.022910    0.010135    0.007892    0.023523    0.028703    0           0.000000    4.317343    1.428592    120.786629 
[37m[36mINFO[0m[0m 03/28 16:18:04 | 0.454181    0.463918    0.774696    0.733998    0.926134    0.726571    0.672165    0.454181    0.463918    0.803773    0.782413    0.793746    0.747417    200         3.295572    1.572983    0.564866    118.187511 
[37m[36mINFO[0m[0m 03/28 16:21:51 | 0.499141    0.499427    0.843842    0.783842    0.767028    0.823378    0.744330    0.499141    0.499427    0.869651    0.820744    0.838497    0.786452    400         6.591143    0.665621    0.541154    119.615036 
[37m[36mINFO[0m[0m 03/28 16:25:37 | 0.511168    0.498282    0.876947    0.795041    0.757323    0.863028    0.769072    0.511168    0.498282    0.900056    0.838782    0.867757    0.777268    600         9.886715    0.480224    0.548826    116.120303 
[37m[36mINFO[0m[0m 03/28 16:29:21 | 0.490550    0.501718    0.903953    0.807629    0.757660    0.897013    0.758763    0.490550    0.501718    0.915822    0.846674    0.899025    0.817451    800         13.182286   0.383639    0.543733    114.660602 
[37m[36mINFO[0m[0m 03/28 16:33:00 | 0.507732    0.500573    0.920377    0.792189    0.818686    0.925335    0.731959    0.507732    0.500573    0.930462    0.846674    0.905336    0.797933    1000        16.477858   0.277964    0.524319    114.120374 
[37m[36mINFO[0m[0m 03/28 16:36:42 | 0.499141    0.516609    0.936675    0.811887    0.824208    0.939753    0.752577    0.499141    0.516609    0.942849    0.877114    0.927424    0.805970    1200        19.773429   0.227512    0.529543    116.010130 
[37m[36mINFO[0m[0m 03/28 16:40:32 | 0.495132    0.489118    0.948635    0.810648    0.873559    0.956231    0.744330    0.495132    0.489118    0.948480    0.880496    0.941193    0.807118    1400        23.069001   0.166217    0.549382    120.115336 
[37m[36mINFO[0m[0m 03/28 16:44:21 | 0.497423    0.505155    0.958368    0.823907    0.858218    0.964470    0.767010    0.497423    0.505155    0.962556    0.887260    0.948078    0.817451    1600        26.364573   0.145279    0.545653    120.362647 
[37m[36mINFO[0m[0m 03/28 16:48:06 | 0.506873    0.497136    0.965330    0.814318    0.899981    0.974768    0.758763    0.506873    0.497136    0.963964    0.879369    0.957258    0.804822    1800        29.660144   0.116514    0.530850    118.849646 
[37m[36mINFO[0m[0m 03/28 16:51:46 | 0.513459    0.508591    0.971321    0.816757    0.918531    0.985582    0.754639    0.513459    0.508591    0.964527    0.881623    0.963855    0.814007    2000        32.955716   0.096956    0.529841    113.565834 
[37m[36mINFO[0m[0m 03/28 16:55:29 | 0.520905    0.516609    0.973343    0.811873    0.992172    0.979403    0.752577    0.520905    0.516609    0.969313    0.879369    0.971314    0.803674    2200        36.251287   0.091481    0.521198    118.777329 
[37m[36mINFO[0m[0m 03/28 16:59:19 | 0.504582    0.495991    0.978190    0.818402    0.951114    0.983522    0.750515    0.504582    0.495991    0.979448    0.888388    0.971601    0.816303    2400        39.546859   0.079978    0.533967    123.541543 
[37m[36mINFO[0m[0m 03/28 17:03:16 | 0.495991    0.491409    0.980931    0.818449    0.910690    0.986612    0.760825    0.495991    0.491409    0.981137    0.879369    0.975043    0.815155    2600        42.842430   0.072408    0.563322    124.447113 
[37m[36mINFO[0m[0m 03/28 17:07:03 | 0.501718    0.530355    0.978683    0.807219    1.021416    0.983522    0.734021    0.501718    0.530355    0.977196    0.879369    0.975330    0.808266    2800        46.138002   0.060701    0.552369    116.383294 
[37m[36mINFO[0m[0m 03/28 17:10:59 | 0.522910    0.501718    0.981754    0.813066    1.110899    0.985067    0.740206    0.522910    0.501718    0.981137    0.886133    0.979059    0.812859    3000        49.433574   0.058260    0.553997    125.443461 
[37m[36mINFO[0m[0m 03/28 17:14:46 | 0.490836    0.486827    0.985648    0.819197    1.012309    0.987642    0.748454    0.490836    0.486827    0.985079    0.896280    0.984223    0.812859    3200        52.729145   0.057847    0.552041    116.203881 
[37m[36mINFO[0m[0m 03/28 17:18:24 | 0.524628    0.528064    0.983024    0.828072    0.931466    0.986612    0.779381    0.524628    0.528064    0.982827    0.880496    0.979633    0.824340    3400        56.024717   0.049563    0.527300    112.584852 
[37m[36mINFO[0m[0m 03/28 17:22:13 | 0.475086    0.452463    0.985290    0.815639    0.945487    0.987127    0.742268    0.475086    0.452463    0.984234    0.890643    0.984509    0.814007    3600        59.320288   0.047162    0.552374    118.222739 
[37m[36mINFO[0m[0m 03/28 17:26:08 | 0.519759    0.520046    0.982732    0.820827    1.053218    0.984037    0.746392    0.519759    0.520046    0.983953    0.892897    0.980207    0.823192    3800        62.615860   0.048496    0.560194    122.893674 
[37m[36mINFO[0m[0m 03/28 17:30:02 | 0.501145    0.498282    0.989666    0.831912    0.945742    0.991761    0.764948    0.501145    0.498282    0.990146    0.905299    0.987091    0.825488    4000        65.911432   0.042449    0.555118    123.082782 
[37m[36mINFO[0m[0m 03/28 17:33:52 | 0.518614    0.504009    0.986340    0.821012    1.010703    0.989186    0.750515    0.518614    0.504009    0.987331    0.899662    0.982501    0.812859    4200        69.207003   0.036511    0.551913    120.153790 
[37m[36mINFO[0m[0m 03/28 17:37:50 | 0.506300    0.500573    0.990675    0.829942    0.974829    0.992791    0.756701    0.506300    0.500573    0.990709    0.903044    0.988526    0.830080    4400        72.502575   0.032490    0.558503    125.777959 
[37m[36mINFO[0m[0m 03/28 17:41:44 | 0.542955    0.529210    0.990593    0.821486    1.134600    0.989701    0.758763    0.542955    0.529210    0.992117    0.896280    0.989960    0.809414    4600        75.798146   0.029568    0.561389    121.811293 
[37m[36mINFO[0m[0m 03/28 17:45:36 | 0.509164    0.524628    0.990847    0.815320    1.099714    0.993306    0.750515    0.509164    0.524628    0.990709    0.891770    0.988526    0.803674    4800        79.093718   0.028547    0.552007    121.787167 
[37m[36mINFO[0m[0m 03/28 17:49:22 | 0.503723    0.514318    0.989998    0.820131    1.112838    0.990216    0.764948    0.503723    0.514318    0.992399    0.891770    0.987378    0.803674    5000        82.389289   0.029313    0.538313    118.653645 
[37m[36mINFO[0m[0m 03/28 17:49:22 | Cumulative gradient change saved at train_output/OfficeHome/GENIE_hp/[1]/250328_16-12-09_resnet50_sgd_ma0999/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/28 17:49:25 | ---
[37m[36mINFO[0m[0m 03/28 17:49:25 | test-domain validation(oracle) = 50.172%
[37m[36mINFO[0m[0m 03/28 17:49:25 | training-domain validation(iid) = 50.115%
[37m[36mINFO[0m[0m 03/28 17:49:25 | last = 50.372%
[37m[36mINFO[0m[0m 03/28 17:49:25 | last (inD) = 82.013%
[37m[36mINFO[0m[0m 03/28 17:49:25 | training-domain validation (iid, inD) = 83.191%
[37m[36mINFO[0m[0m 03/28 17:49:25 | === Summary ===
[37m[36mINFO[0m[0m 03/28 17:49:25 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd_ma0999 config/resnet50_sgd.yaml --algorithm GENIE_hp --test_envs 1 --dataset OfficeHome --trial_seed 1
[37m[36mINFO[0m[0m 03/28 17:49:25 | Unique name: 250328_16-12-09_resnet50_sgd_ma0999
[37m[36mINFO[0m[0m 03/28 17:49:25 | Out path: train_output/OfficeHome/GENIE_hp/[1]/250328_16-12-09_resnet50_sgd_ma0999
[37m[36mINFO[0m[0m 03/28 17:49:25 | Algorithm: GENIE_hp
[37m[36mINFO[0m[0m 03/28 17:49:25 | Dataset: OfficeHome

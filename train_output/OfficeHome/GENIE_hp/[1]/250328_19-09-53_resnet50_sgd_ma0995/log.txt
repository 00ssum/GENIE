[37m[36mINFO[0m[0m 03/28 19:09:53 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd_ma0995 config/resnet50_sgd.yaml --algorithm GENIE_hp --test_envs 1 --dataset OfficeHome --trial_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE_hp
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd_ma0995
	out_dir: train_output/OfficeHome/GENIE_hp/[1]/250328_19-09-53_resnet50_sgd_ma0995
	out_root: train_output/OfficeHome/GENIE_hp/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250328_19-09-53_resnet50_sgd_ma0995
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	momentum: 0.9
	convergence_rate: 0.015
	p: 0.4
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/28 19:09:53 | n_steps = 5001
[37m[36mINFO[0m[0m 03/28 19:09:53 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/28 19:09:53 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/28 19:09:53 | 
[37m[36mINFO[0m[0m 03/28 19:09:53 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/28 19:09:53 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/28 19:09:53 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/28 19:09:53 | Batch sizes for each domain: [32, 0, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/28 19:09:53 | steps-per-epoch for each domain: 60.69, 111.00, 108.94 -> min = 60.69
[37m[36mINFO[0m[0m 03/28 19:09:54 | # of params = 23641217
[37m[36mINFO[0m[0m 03/28 19:11:49 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/28 19:11:49 | 0.013173    0.021764    0.018102    0.020743    4.191322    0.022657    0.026804    0.013173    0.021764    0.010135    0.009019    0.021515    0.026406    0           0.000000    4.317343    1.014621    113.709820 
[37m[36mINFO[0m[0m 03/28 19:15:33 | 0.459336    0.459336    0.781968    0.749263    0.877768    0.737899    0.692784    0.459336    0.459336    0.810529    0.786922    0.797476    0.768083    200         3.295572    1.533008    0.548504    115.022110 
[37m[36mINFO[0m[0m 03/28 19:19:17 | 0.489977    0.491409    0.859394    0.788898    0.742989    0.847580    0.740206    0.489977    0.491409    0.880631    0.833145    0.849971    0.793341    400         6.591143    0.591761    0.544103    114.710716 
[37m[36mINFO[0m[0m 03/28 19:23:03 | 0.485395    0.513173    0.907242    0.805150    0.743139    0.902678    0.752577    0.485395    0.513173    0.921171    0.852311    0.897877    0.810563    600         9.886715    0.372122    0.549919    116.084769 
[37m[36mINFO[0m[0m 03/28 19:26:45 | 0.515178    0.520046    0.939005    0.806954    0.787674    0.949022    0.742268    0.515178    0.520046    0.942005    0.871477    0.925990    0.807118    800         13.182286   0.266537    0.537948    114.052128 
[37m[36mINFO[0m[0m 03/28 19:30:24 | 0.507732    0.515464    0.954700    0.820831    0.779450    0.961380    0.758763    0.507732    0.515464    0.956363    0.878241    0.946357    0.825488    1000        16.477858   0.171029    0.519139    115.825985 
[37m[36mINFO[0m[0m 03/28 19:34:05 | 0.517182    0.525773    0.966501    0.828186    0.778766    0.973738    0.785567    0.517182    0.525773    0.966498    0.886133    0.959266    0.812859    1200        19.773429   0.136762    0.536646    113.764970 
[37m[36mINFO[0m[0m 03/28 19:37:52 | 0.493127    0.509737    0.970255    0.826125    0.807070    0.977343    0.769072    0.493127    0.509737    0.971002    0.887260    0.962421    0.822044    1400        23.069001   0.095529    0.546099    117.515017 
[37m[36mINFO[0m[0m 03/28 19:41:32 | 0.506014    0.523482    0.973713    0.831390    0.791247    0.978373    0.781443    0.506014    0.523482    0.977477    0.888388    0.965290    0.824340    1600        26.364573   0.084312    0.530525    114.151403 
[37m[36mINFO[0m[0m 03/28 19:45:13 | 0.516896    0.522337    0.976595    0.833064    0.865857    0.983007    0.777320    0.516896    0.522337    0.977759    0.890643    0.969019    0.831228    1800        29.660144   0.072845    0.523605    115.915417 
[37m[36mINFO[0m[0m 03/28 19:48:53 | 0.512600    0.528064    0.983303    0.831827    0.830867    0.989186    0.791753    0.512600    0.528064    0.983671    0.878241    0.977051    0.825488    2000        32.955716   0.064615    0.525406    114.601944 
[37m[36mINFO[0m[0m 03/28 19:52:32 | 0.520046    0.531501    0.980290    0.828464    0.879831    0.983522    0.777320    0.520046    0.531501    0.980011    0.891770    0.977338    0.816303    2200        36.251287   0.060004    0.533270    112.366333 
[37m[36mINFO[0m[0m 03/28 19:56:16 | 0.522623    0.520046    0.984470    0.830724    0.870199    0.988671    0.779381    0.522623    0.520046    0.983671    0.885006    0.981067    0.827784    2400        39.546859   0.051646    0.538969    116.069363 
[37m[36mINFO[0m[0m 03/28 19:59:59 | 0.509164    0.506300    0.987161    0.831419    0.825366    0.990216    0.771134    0.509164    0.506300    0.987331    0.885006    0.983936    0.838117    2600        42.842430   0.047739    0.544634    114.234009 
[37m[36mINFO[0m[0m 03/28 20:03:41 | 0.521478    0.517755    0.984881    0.830734    0.859874    0.988157    0.767010    0.521478    0.517755    0.982264    0.897407    0.984223    0.827784    2800        46.138002   0.045713    0.532363    115.510018 
[37m[36mINFO[0m[0m 03/28 20:07:24 | 0.509737    0.508591    0.990357    0.833761    0.825639    0.991246    0.767010    0.509737    0.508591    0.989865    0.903044    0.989960    0.831228    3000        49.433574   0.042468    0.541542    114.886878 
[37m[36mINFO[0m[0m 03/28 20:11:02 | 0.538946    0.547537    0.986170    0.838549    0.944175    0.989186    0.783505    0.538946    0.547537    0.983953    0.894025    0.985370    0.838117    3200        52.729145   0.032147    0.533933    110.805401 
[37m[36mINFO[0m[0m 03/28 20:14:44 | 0.519187    0.512027    0.989890    0.839961    0.859514    0.991246    0.775258    0.519187    0.512027    0.988176    0.901917    0.990247    0.842710    3400        56.024717   0.037605    0.525870    117.509690 
[37m[36mINFO[0m[0m 03/28 20:18:28 | 0.525487    0.530355    0.989855    0.844701    0.924170    0.989186    0.791753    0.525487    0.530355    0.990991    0.900789    0.989386    0.841561    3600        59.320288   0.028484    0.549108    113.746443 
[37m[36mINFO[0m[0m 03/28 20:22:10 | 0.499141    0.507446    0.989086    0.832186    0.973923    0.989701    0.779381    0.499141    0.507446    0.988457    0.896280    0.989099    0.820896    3800        62.615860   0.029884    0.535303    115.279841 
[37m[36mINFO[0m[0m 03/28 20:25:54 | 0.527491    0.534937    0.992719    0.843454    0.898514    0.991246    0.793814    0.527491    0.534937    0.994369    0.904171    0.992542    0.832377    4000        65.911432   0.028104    0.540904    115.593484 
[37m[36mINFO[0m[0m 03/28 20:29:38 | 0.524914    0.531501    0.993265    0.837771    0.812871    0.994851    0.773196    0.524914    0.531501    0.992117    0.897407    0.992828    0.842710    4200        69.207003   0.028185    0.530531    118.252882 
[37m[36mINFO[0m[0m 03/28 20:33:21 | 0.520905    0.512027    0.993257    0.836672    0.865537    0.994851    0.781443    0.520905    0.512027    0.993525    0.900789    0.991394    0.827784    4400        72.502575   0.025373    0.538657    114.743839 
[37m[36mINFO[0m[0m 03/28 20:37:12 | 0.528351    0.533792    0.989564    0.823556    1.013943    0.989186    0.744330    0.528351    0.533792    0.991554    0.897407    0.987952    0.828932    4600        75.798146   0.024442    0.558319    119.609544 
[37m[36mINFO[0m[0m 03/28 20:40:55 | 0.522623    0.516609    0.993184    0.835744    0.970600    0.994336    0.785567    0.522623    0.516609    0.992962    0.901917    0.992255    0.819747    4800        79.093718   0.019965    0.540358    115.257790 
[37m[36mINFO[0m[0m 03/28 20:44:35 | 0.536942    0.550974    0.993584    0.842875    0.936119    0.993821    0.787629    0.536942    0.550974    0.993243    0.912063    0.993689    0.828932    5000        82.389289   0.021568    0.532306    113.428380 
[37m[36mINFO[0m[0m 03/28 20:44:35 | Cumulative gradient change saved at train_output/OfficeHome/GENIE_hp/[1]/250328_19-09-53_resnet50_sgd_ma0995/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/28 20:45:00 | ---
[37m[36mINFO[0m[0m 03/28 20:45:00 | test-domain validation(oracle) = 53.694%
[37m[36mINFO[0m[0m 03/28 20:45:00 | training-domain validation(iid) = 52.549%
[37m[36mINFO[0m[0m 03/28 20:45:00 | last = 53.694%
[37m[36mINFO[0m[0m 03/28 20:45:00 | last (inD) = 84.287%
[37m[36mINFO[0m[0m 03/28 20:45:00 | training-domain validation (iid, inD) = 84.470%
[37m[36mINFO[0m[0m 03/28 20:45:00 | === Summary ===
[37m[36mINFO[0m[0m 03/28 20:45:00 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd_ma0995 config/resnet50_sgd.yaml --algorithm GENIE_hp --test_envs 1 --dataset OfficeHome --trial_seed 1
[37m[36mINFO[0m[0m 03/28 20:45:00 | Unique name: 250328_19-09-53_resnet50_sgd_ma0995
[37m[36mINFO[0m[0m 03/28 20:45:00 | Out path: train_output/OfficeHome/GENIE_hp/[1]/250328_19-09-53_resnet50_sgd_ma0995
[37m[36mINFO[0m[0m 03/28 20:45:00 | Algorithm: GENIE_hp
[37m[36mINFO[0m[0m 03/28 20:45:00 | Dataset: OfficeHome

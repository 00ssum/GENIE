[37m[36mINFO[0m[0m 03/28 13:52:37 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd_ma09 config/resnet50_sgd.yaml --algorithm GENIE_hp --test_envs 1 --dataset OfficeHome --trial_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE_hp
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd_ma09
	out_dir: train_output/OfficeHome/GENIE_hp/[1]/250328_13-52-37_resnet50_sgd_ma09
	out_root: train_output/OfficeHome/GENIE_hp/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250328_13-52-37_resnet50_sgd_ma09
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	momentum: 0.9
	convergence_rate: 0.015
	p: 0.4
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/28 13:52:37 | n_steps = 5001
[37m[36mINFO[0m[0m 03/28 13:52:37 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/28 13:52:37 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/28 13:52:37 | 
[37m[36mINFO[0m[0m 03/28 13:52:37 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 03/28 13:52:37 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 03/28 13:52:37 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/28 13:52:37 | Batch sizes for each domain: [32, 0, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/28 13:52:37 | steps-per-epoch for each domain: 60.69, 111.00, 108.94 -> min = 60.69
[37m[36mINFO[0m[0m 03/28 13:52:38 | # of params = 23641217
[37m[36mINFO[0m[0m 03/28 13:54:39 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/28 13:54:39 | 0.014032    0.022910    0.019055    0.019758    4.186557    0.022657    0.022680    0.014032    0.022910    0.010698    0.007892    0.023810    0.028703    0           0.000000    4.317343    1.290707    119.172585 
[37m[36mINFO[0m[0m 03/28 13:58:38 | 0.495132    0.510882    0.861628    0.798773    0.680656    0.843460    0.729897    0.495132    0.510882    0.884854    0.846674    0.856569    0.819747    200         3.295572    1.253995    0.558230    127.821598 
[37m[36mINFO[0m[0m 03/28 14:02:26 | 0.500286    0.507446    0.907039    0.806791    0.690166    0.905767    0.746392    0.500286    0.507446    0.919482    0.872604    0.895869    0.801378    400         6.591143    0.413774    0.545559    118.660794 
[37m[36mINFO[0m[0m 03/28 14:06:17 | 0.515750    0.533792    0.937617    0.814261    0.740196    0.947992    0.750515    0.515750    0.533792    0.940878    0.877114    0.923982    0.815155    600         9.886715    0.268304    0.548193    121.044125 
[37m[36mINFO[0m[0m 03/28 14:10:07 | 0.512600    0.507446    0.948167    0.811051    0.738548    0.958805    0.744330    0.512600    0.507446    0.946509    0.877114    0.939185    0.811711    800         13.182286   0.197652    0.560625    117.885745 
[37m[36mINFO[0m[0m 03/28 14:13:52 | 0.517755    0.521191    0.969546    0.834091    0.723341    0.976313    0.771134    0.517755    0.521191    0.968468    0.886133    0.963855    0.845006    1000        16.477858   0.135089    0.534494    118.715947 
[37m[36mINFO[0m[0m 03/28 14:17:41 | 0.518900    0.530355    0.969019    0.828919    0.724586    0.972194    0.764948    0.518900    0.530355    0.970721    0.894025    0.964142    0.827784    1200        19.773429   0.102492    0.556429    117.469969 
[37m[36mINFO[0m[0m 03/28 14:21:32 | 0.496564    0.506300    0.974003    0.840560    0.795033    0.984037    0.791753    0.496564    0.506300    0.973255    0.889515    0.964716    0.840413    1400        23.069001   0.089239    0.557862    119.836055 
[37m[36mINFO[0m[0m 03/28 14:25:21 | 0.511741    0.516609    0.982349    0.831257    0.777737    0.986612    0.764948    0.511741    0.516609    0.983671    0.887260    0.976764    0.841561    1600        26.364573   0.068287    0.548085    119.273980 
[37m[36mINFO[0m[0m 03/28 14:29:12 | 0.524055    0.523482    0.984728    0.834275    0.815766    0.992276    0.785567    0.524055    0.523482    0.981700    0.891770    0.980207    0.825488    1800        29.660144   0.064505    0.536577    123.711136 
[37m[36mINFO[0m[0m 03/28 14:32:58 | 0.517182    0.525773    0.981300    0.826925    0.958097    0.984552    0.769072    0.517182    0.525773    0.980574    0.881623    0.978772    0.830080    2000        32.955716   0.054064    0.547417    116.373066 
[37m[36mINFO[0m[0m 03/28 14:36:41 | 0.496850    0.502864    0.986443    0.836704    0.804408    0.986097    0.758763    0.496850    0.502864    0.989583    0.910936    0.983649    0.840413    2200        36.251287   0.050256    0.536506    115.535868 
[37m[36mINFO[0m[0m 03/28 14:40:38 | 0.523482    0.524628    0.983697    0.827287    0.840059    0.986097    0.769072    0.523482    0.524628    0.985360    0.885006    0.979633    0.827784    2400        39.546859   0.041988    0.566313    124.033502 
[37m[36mINFO[0m[0m 03/28 14:44:40 | 0.519473    0.525773    0.985918    0.841329    0.768278    0.988157    0.779381    0.519473    0.525773    0.984516    0.903044    0.985083    0.841561    2600        42.842430   0.041744    0.586614    124.809849 
[37m[36mINFO[0m[0m 03/28 14:48:38 | 0.532360    0.532646    0.992251    0.850918    0.790054    0.993821    0.787629    0.532360    0.532646    0.992399    0.910936    0.990534    0.854191    2800        46.138002   0.032027    0.576787    122.527609 
[37m[36mINFO[0m[0m 03/28 14:52:39 | 0.525200    0.523482    0.990851    0.839627    0.866990    0.993306    0.775258    0.525200    0.523482    0.990146    0.894025    0.989099    0.849598    3000        49.433574   0.035874    0.596274    121.201861 
[37m[36mINFO[0m[0m 03/28 14:56:43 | 0.536082    0.528064    0.991893    0.838770    0.912171    0.993306    0.777320    0.536082    0.528064    0.991554    0.896280    0.990820    0.842710    3200        52.729145   0.025363    0.606398    123.005272 
[37m[36mINFO[0m[0m 03/28 15:00:39 | 0.529210    0.536082    0.991630    0.848266    0.895510    0.992791    0.797938    0.529210    0.536082    0.990991    0.905299    0.991107    0.841561    3400        56.024717   0.023772    0.569292    122.503863 
[37m[36mINFO[0m[0m 03/28 15:04:37 | 0.524055    0.514318    0.990343    0.832075    0.916407    0.988671    0.760825    0.524055    0.514318    0.992399    0.904171    0.989960    0.831228    3600        59.320288   0.025383    0.587122    119.814690 
[37m[36mINFO[0m[0m 03/28 15:08:34 | 0.535223    0.534937    0.991722    0.837983    0.861380    0.992791    0.777320    0.535223    0.534937    0.991554    0.899662    0.990820    0.836969    3800        62.615860   0.024916    0.584058    120.036465 
[37m[36mINFO[0m[0m 03/28 15:12:36 | 0.536655    0.542955    0.989755    0.831591    0.936094    0.989186    0.764948    0.536655    0.542955    0.991554    0.895152    0.988526    0.834673    4000        65.911432   0.022607    0.582703    125.768945 
[37m[36mINFO[0m[0m 03/28 15:16:33 | 0.532932    0.539519    0.991702    0.843539    0.807386    0.993306    0.791753    0.532932    0.539519    0.991554    0.903044    0.990247    0.835821    4200        69.207003   0.023695    0.581174    121.017596 
[37m[36mINFO[0m[0m 03/28 15:20:31 | 0.542096    0.556701    0.994250    0.840641    0.888602    0.993821    0.787629    0.542096    0.556701    0.993806    0.901917    0.995123    0.832377    4400        72.502575   0.022893    0.585516    120.700506 
[37m[36mINFO[0m[0m 03/28 15:24:31 | 0.524055    0.518900    0.994841    0.851815    0.860227    0.995881    0.806186    0.524055    0.518900    0.993806    0.899662    0.994836    0.849598    4600        75.798146   0.017916    0.591587    121.364448 
[37m[36mINFO[0m[0m 03/28 15:28:26 | 0.525200    0.530355    0.994059    0.846063    0.931322    0.993821    0.785567    0.525200    0.530355    0.993806    0.904171    0.994550    0.848450    4800        79.093718   0.016127    0.581907    118.862469 
[37m[36mINFO[0m[0m 03/28 15:32:27 | 0.549828    0.546392    0.994151    0.843463    0.872320    0.993821    0.773196    0.549828    0.546392    0.994369    0.905299    0.994263    0.851894    5000        82.389289   0.015021    0.583952    124.116040 
[37m[36mINFO[0m[0m 03/28 15:32:27 | Cumulative gradient change saved at train_output/OfficeHome/GENIE_hp/[1]/250328_13-52-37_resnet50_sgd_ma09/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/28 15:32:28 | ---
[37m[36mINFO[0m[0m 03/28 15:32:28 | test-domain validation(oracle) = 54.210%
[37m[36mINFO[0m[0m 03/28 15:32:28 | training-domain validation(iid) = 52.405%
[37m[36mINFO[0m[0m 03/28 15:32:28 | last = 54.983%
[37m[36mINFO[0m[0m 03/28 15:32:28 | last (inD) = 84.346%
[37m[36mINFO[0m[0m 03/28 15:32:28 | training-domain validation (iid, inD) = 85.182%
[37m[36mINFO[0m[0m 03/28 15:32:28 | === Summary ===
[37m[36mINFO[0m[0m 03/28 15:32:28 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd_ma09 config/resnet50_sgd.yaml --algorithm GENIE_hp --test_envs 1 --dataset OfficeHome --trial_seed 1
[37m[36mINFO[0m[0m 03/28 15:32:28 | Unique name: 250328_13-52-37_resnet50_sgd_ma09
[37m[36mINFO[0m[0m 03/28 15:32:28 | Out path: train_output/OfficeHome/GENIE_hp/[1]/250328_13-52-37_resnet50_sgd_ma09
[37m[36mINFO[0m[0m 03/28 15:32:28 | Algorithm: GENIE_hp
[37m[36mINFO[0m[0m 03/28 15:32:28 | Dataset: OfficeHome

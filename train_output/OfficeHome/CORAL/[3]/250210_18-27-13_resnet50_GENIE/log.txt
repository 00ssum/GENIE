[37m[36mINFO[0m[0m 02/10 18:27:13 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 5
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 5
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[3]/250210_18-27-13_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250210_18-27-13_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.6343540304927548e-05
	batch_size: 23
	weight_decay: 3.844578840738432e-05
	mmd_gamma: 0.6855754528884209
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/10 18:27:13 | n_steps = 5001
[37m[36mINFO[0m[0m 02/10 18:27:13 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/10 18:27:13 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/10 18:27:13 | 
[37m[36mINFO[0m[0m 02/10 18:27:13 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 02/10 18:27:13 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 02/10 18:27:13 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/10 18:27:13 | Batch sizes for each domain: [23, 23, 23, 0] (total=69)
[37m[36mINFO[0m[0m 02/10 18:27:13 | steps-per-epoch for each domain: 84.43, 151.83, 154.43 -> min = 84.43
[37m[36mINFO[0m[0m 02/10 18:27:14 | # of params = 23641217
[37m[36mINFO[0m[0m 02/10 18:29:22 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/10 18:29:22 | 0.023523    0.032147    0.018861    0.015958    4.225659    0.026777    0.020619    0.014605    0.012600    0.015203    0.014656    0.023523    0.032147    0           0.000000    4.284098    0.032665    1.208762    127.081607 
[37m[36mINFO[0m[0m 02/10 18:32:15 | 0.743832    0.721010    0.769933    0.727393    1.021080    0.769310    0.729897    0.713631    0.655212    0.826858    0.797069    0.743832    0.721010    200         2.368692    1.911733    0.179057    0.214631    129.660988 
[37m[36mINFO[0m[0m 02/10 18:35:02 | 0.776535    0.776119    0.855523    0.759225    0.895308    0.875901    0.740206    0.804124    0.695304    0.886543    0.842165    0.776535    0.776119    400         4.737384    0.699635    0.166273    0.230358    121.431812 
[37m[36mINFO[0m[0m 02/10 18:37:55 | 0.789730    0.764638    0.893485    0.782337    0.796941    0.913491    0.752577    0.854238    0.733104    0.912725    0.861330    0.789730    0.764638    600         7.106076    0.469456    0.143877    0.231135    126.077664 
[37m[36mINFO[0m[0m 02/10 18:40:44 | 0.794033    0.773823    0.920402    0.798484    0.772244    0.940268    0.789691    0.882875    0.736541    0.938063    0.869222    0.794033    0.773823    800         9.474768    0.362373    0.132414    0.201722    128.833512 
[37m[36mINFO[0m[0m 02/10 18:43:32 | 0.778256    0.779564    0.941853    0.803953    0.732954    0.969619    0.775258    0.904926    0.761741    0.951014    0.874859    0.778256    0.779564    1000        11.843460   0.270591    0.119101    0.239615    119.942214 
[37m[36mINFO[0m[0m 02/10 18:46:21 | 0.784854    0.781860    0.956783    0.804170    0.735335    0.976828    0.779381    0.929840    0.756014    0.963682    0.877114    0.784854    0.781860    1200        14.212152   0.215320    0.111033    0.214460    125.842307 
[37m[36mINFO[0m[0m 02/10 18:49:15 | 0.795468    0.781860    0.963234    0.808187    0.721940    0.976828    0.773196    0.942153    0.768614    0.970721    0.882751    0.795468    0.781860    1400        16.580844   0.164202    0.102307    0.224841    129.381654 
[37m[36mINFO[0m[0m 02/10 18:51:59 | 0.790017    0.770379    0.968796    0.808985    0.755733    0.985067    0.781443    0.942153    0.754868    0.979167    0.890643    0.790017    0.770379    1600        18.949537   0.135422    0.095872    0.210096    121.596242 
[37m[36mINFO[0m[0m 02/10 18:54:51 | 0.789443    0.781860    0.977930    0.812861    0.716583    0.990216    0.779381    0.959622    0.765178    0.983953    0.894025    0.789443    0.781860    1800        21.318229   0.112345    0.088219    0.238294    124.534462 
[37m[36mINFO[0m[0m 02/10 18:57:49 | 0.798623    0.792193    0.979701    0.812568    0.729769    0.993306    0.777320    0.957904    0.768614    0.987894    0.891770    0.798623    0.792193    2000        23.686921   0.103208    0.080851    0.223341    134.043221 
[37m[36mINFO[0m[0m 02/10 19:00:33 | 0.792025    0.785304    0.981971    0.810594    0.735333    0.991246    0.769072    0.966208    0.773196    0.988457    0.889515    0.792025    0.785304    2200        26.055613   0.088500    0.075949    0.183401    126.391055 
[37m[36mINFO[0m[0m 02/10 19:03:23 | 0.797762    0.785304    0.985280    0.803663    0.739697    0.994336    0.760825    0.971077    0.764032    0.990428    0.886133    0.797762    0.785304    2400        28.424305   0.079581    0.073446    0.231827    123.947239 
[37m[36mINFO[0m[0m 02/10 19:06:16 | 0.795181    0.795637    0.984353    0.820699    0.710376    0.993821    0.806186    0.970218    0.770905    0.989020    0.885006    0.795181    0.795637    2600        30.792997   0.067173    0.069534    0.222335    128.912769 
[37m[36mINFO[0m[0m 02/10 19:09:03 | 0.807803    0.783008    0.987550    0.828822    0.712886    0.994851    0.812371    0.977090    0.780069    0.990709    0.894025    0.807803    0.783008    2800        33.161689   0.065712    0.065231    0.213512    123.805619 
[37m[36mINFO[0m[0m 02/10 19:11:53 | 0.796328    0.791045    0.987286    0.818207    0.736535    0.993821    0.779381    0.974513    0.781214    0.993525    0.894025    0.796328    0.791045    3000        35.530381   0.056971    0.060921    0.240738    121.570934 
[37m[36mINFO[0m[0m 02/10 19:14:40 | 0.794894    0.793341    0.988568    0.817403    0.721328    0.995366    0.781443    0.977377    0.783505    0.992962    0.887260    0.794894    0.793341    3200        37.899073   0.053532    0.058996    0.203258    126.635473 
[37m[36mINFO[0m[0m 02/10 19:17:24 | 0.800631    0.801378    0.988683    0.813020    0.701992    0.994851    0.764948    0.978236    0.781214    0.992962    0.892897    0.800631    0.801378    3400        40.267765   0.049913    0.056573    0.218494    120.647514 
[37m[36mINFO[0m[0m 02/10 19:20:09 | 0.792886    0.793341    0.988935    0.819276    0.717476    0.993306    0.781443    0.981100    0.782360    0.992399    0.894025    0.792886    0.793341    3600        42.636457   0.043294    0.054357    0.214930    122.278958 
[37m[36mINFO[0m[0m 02/10 19:22:56 | 0.778830    0.788749    0.987788    0.809073    0.762681    0.993306    0.758763    0.977377    0.780069    0.992680    0.888388    0.778830    0.788749    3800        45.005149   0.046129    0.052265    0.212025    123.710829 
[37m[36mINFO[0m[0m 02/10 19:25:44 | 0.795754    0.784156    0.990197    0.818500    0.727438    0.994851    0.781443    0.980527    0.777778    0.995214    0.896280    0.795754    0.784156    4000        47.373841   0.042818    0.050605    0.218347    124.946552 
[37m[36mINFO[0m[0m 02/10 19:28:33 | 0.794033    0.781860    0.991474    0.820733    0.716276    0.996395    0.783505    0.982532    0.785796    0.995495    0.892897    0.794033    0.781860    4200        49.742533   0.039199    0.048813    0.222346    124.328790 
[37m[36mINFO[0m[0m 02/10 19:31:28 | 0.788296    0.791045    0.991010    0.822636    0.725758    0.995881    0.783505    0.980527    0.790378    0.996622    0.894025    0.788296    0.791045    4400        52.111226   0.042772    0.046514    0.224531    130.399146 
[37m[36mINFO[0m[0m 02/10 19:34:13 | 0.790017    0.785304    0.991533    0.819728    0.725697    0.997425    0.779381    0.981959    0.784651    0.995214    0.895152    0.790017    0.785304    4600        54.479918   0.036913    0.046008    0.207294    122.998796 
[37m[36mINFO[0m[0m 02/10 19:37:01 | 0.789730    0.786452    0.990351    0.819682    0.705666    0.995881    0.791753    0.980241    0.777778    0.994932    0.889515    0.789730    0.786452    4800        56.848610   0.035819    0.044745    0.226400    122.656640 
[37m[36mINFO[0m[0m 02/10 19:39:56 | 0.793173    0.788749    0.991867    0.824350    0.719891    0.995881    0.797938    0.982818    0.773196    0.996903    0.901917    0.793173    0.788749    5000        59.217302   0.035056    0.042962    0.203478    134.415297 
[37m[36mINFO[0m[0m 02/10 19:39:56 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[3]/250210_18-27-13_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/10 19:39:57 | ---
[37m[36mINFO[0m[0m 02/10 19:39:57 | test-domain validation(oracle) = 80.063%
[37m[36mINFO[0m[0m 02/10 19:39:57 | training-domain validation(iid) = 80.780%
[37m[36mINFO[0m[0m 02/10 19:39:57 | last = 79.317%
[37m[36mINFO[0m[0m 02/10 19:39:57 | last (inD) = 82.435%
[37m[36mINFO[0m[0m 02/10 19:39:57 | training-domain validation (iid, inD) = 82.882%
[37m[36mINFO[0m[0m 02/10 19:39:58 | === Summary ===
[37m[36mINFO[0m[0m 02/10 19:39:58 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 5
[37m[36mINFO[0m[0m 02/10 19:39:58 | Unique name: 250210_18-27-13_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 19:39:58 | Out path: train_output/OfficeHome/CORAL/[3]/250210_18-27-13_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 19:39:58 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/10 19:39:58 | Dataset: OfficeHome

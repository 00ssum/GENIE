[37m[36mINFO[0m[0m 01/18 13:30:02 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 20
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 20
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/OfficeHome/CORAL/[3]/250118_13-30-02_resnet50_EVE
	out_root: train_output/OfficeHome/CORAL/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250118_13-30-02_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: GENIE
	freeze_bn: False
	pretrained: True
	lr: 2.6157673767852512e-05
	batch_size: 32
	weight_decay: 1.110622050999988e-05
	mmd_gamma: 0.11123344099864356
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 01/18 13:30:02 | n_steps = 5001
[37m[36mINFO[0m[0m 01/18 13:30:02 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/18 13:30:02 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/18 13:30:02 | Target test envs = [[3]]
[37m[36mINFO[0m[0m 01/18 13:30:02 | 
[37m[36mINFO[0m[0m 01/18 13:30:02 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 01/18 13:30:02 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 01/18 13:30:02 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 01/18 13:30:02 | steps-per-epoch for each domain: 60.69, 109.12, 111.00 -> min = 60.69
[37m[36mINFO[0m[0m 01/18 13:30:04 | # of params = 23641217
[37m[36mINFO[0m[0m 01/18 13:31:56 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 01/18 13:31:56 | 0.018933    0.027555    0.015451    0.012305    4.219833    0.021112    0.016495    0.010882    0.008018    0.014358    0.012401    0.018933    0.027555    0           0.000000    4.362146    0.075403    1.107925    111.416512 
[37m[36mINFO[0m[0m 01/18 13:34:42 | 0.736661    0.724455    0.752263    0.719539    1.065450    0.748713    0.725773    0.694731    0.638030    0.813345    0.794814    0.736661    0.724455    200         3.295572    2.240135    0.539167    0.239789    117.439425 
[37m[36mINFO[0m[0m 01/18 13:37:31 | 0.769076    0.763490    0.841478    0.757621    0.885562    0.843975    0.742268    0.799828    0.688431    0.880631    0.842165    0.769076    0.763490    400         6.591143    0.787310    0.596610    0.251536    118.286037 
[37m[36mINFO[0m[0m 01/18 13:40:14 | 0.780838    0.770379    0.899144    0.783431    0.791860    0.923790    0.754639    0.849656    0.738832    0.923986    0.856821    0.780838    0.770379    600         9.886715    0.536470    0.539080    0.231213    116.869901 
[37m[36mINFO[0m[0m 01/18 13:42:53 | 0.782559    0.776119    0.924882    0.787763    0.787128    0.947477    0.748454    0.885166    0.739977    0.942005    0.874859    0.782559    0.776119    800         13.182286   0.387826    0.511004    0.249380    109.407097 
[37m[36mINFO[0m[0m 01/18 13:45:34 | 0.796328    0.796785    0.947160    0.800416    0.750046    0.964470    0.756701    0.918958    0.765178    0.958052    0.879369    0.796328    0.796785    1000        16.477858   0.284550    0.468968    0.223672    115.672853 
[37m[36mINFO[0m[0m 01/18 13:48:19 | 0.787722    0.765786    0.956716    0.793362    0.768360    0.978888    0.762887    0.929267    0.746850    0.961993    0.870349    0.787722    0.765786    1200        19.773429   0.224488    0.438724    0.260891    112.100654 
[37m[36mINFO[0m[0m 01/18 13:51:03 | 0.791738    0.785304    0.967674    0.805279    0.748882    0.987642    0.758763    0.940435    0.773196    0.974944    0.883878    0.791738    0.785304    1400        23.069001   0.180819    0.395834    0.228821    118.395873 
[37m[36mINFO[0m[0m 01/18 13:53:48 | 0.802926    0.793341    0.974958    0.813173    0.732139    0.991246    0.771134    0.954181    0.775487    0.979448    0.892897    0.802926    0.793341    1600        26.364573   0.140915    0.379057    0.249482    115.156257 
[37m[36mINFO[0m[0m 01/18 13:56:36 | 0.802639    0.791045    0.979040    0.806589    0.740206    0.993306    0.764948    0.957045    0.773196    0.986768    0.881623    0.802639    0.791045    1800        29.660144   0.123977    0.343931    0.246701    118.383123 
[37m[36mINFO[0m[0m 01/18 13:59:23 | 0.800057    0.792193    0.980576    0.812357    0.773200    0.990731    0.773196    0.965636    0.775487    0.985360    0.888388    0.800057    0.792193    2000        32.955716   0.108268    0.320713    0.240771    117.980351 
[37m[36mINFO[0m[0m 01/18 14:02:32 | 0.799197    0.780712    0.981338    0.814782    0.743325    0.990216    0.779381    0.964777    0.773196    0.989020    0.891770    0.799197    0.780712    2200        36.251287   0.090109    0.304309    0.359355    117.627471 
[37m[36mINFO[0m[0m 01/18 14:05:32 | 0.801492    0.794489    0.986268    0.816949    0.764363    0.995881    0.781443    0.971649    0.768614    0.991273    0.900789    0.801492    0.794489    2400        39.546859   0.075317    0.285055    0.302709    119.601781 
[37m[36mINFO[0m[0m 01/18 14:08:12 | 0.803213    0.799082    0.986434    0.815904    0.724195    0.993821    0.779381    0.973081    0.772050    0.992399    0.896280    0.803213    0.799082    2600        42.842430   0.076276    0.266278    0.237580    112.032260 
[37m[36mINFO[0m[0m 01/18 14:10:52 | 0.799484    0.781860    0.988331    0.821637    0.720421    0.993821    0.789691    0.976804    0.780069    0.994369    0.895152    0.799484    0.781860    2800        46.138002   0.065795    0.252635    0.237265    112.372398 
[37m[36mINFO[0m[0m 01/18 14:13:32 | 0.796041    0.797933    0.988924    0.820950    0.749226    0.995881    0.787629    0.976804    0.780069    0.994088    0.895152    0.796041    0.797933    3000        49.433574   0.054878    0.243863    0.231467    113.735304 
[37m[36mINFO[0m[0m 01/18 14:16:12 | 0.800344    0.788749    0.989524    0.818329    0.733174    0.995366    0.775258    0.980527    0.780069    0.992680    0.899662    0.800344    0.788749    3200        52.729145   0.051164    0.226868    0.229890    113.574562 
[37m[36mINFO[0m[0m 01/18 14:19:11 | 0.801779    0.791045    0.989954    0.826647    0.731909    0.993821    0.797938    0.981672    0.781214    0.994369    0.900789    0.801779    0.791045    3400        56.024717   0.054133    0.218464    0.314059    116.091439 
[37m[36mINFO[0m[0m 01/18 14:22:21 | 0.800057    0.771527    0.989738    0.818964    0.731268    0.994336    0.789691    0.979381    0.772050    0.995495    0.895152    0.800057    0.771527    3600        59.320288   0.046819    0.208683    0.371238    115.791524 
[37m[36mINFO[0m[0m 01/18 14:25:21 | 0.799197    0.786452    0.988551    0.816191    0.763996    0.993306    0.781443    0.979668    0.767468    0.992680    0.899662    0.799197    0.786452    3800        62.615860   0.046803    0.200612    0.309695    117.260776 
[37m[36mINFO[0m[0m 01/18 14:28:05 | 0.793746    0.781860    0.990964    0.821137    0.742243    0.994851    0.781443    0.983391    0.778923    0.994651    0.903044    0.793746    0.781860    4000        65.911432   0.042108    0.199285    0.246781    114.914989 
[37m[36mINFO[0m[0m 01/18 14:30:48 | 0.804073    0.801378    0.992332    0.821396    0.740908    0.996395    0.785567    0.984822    0.781214    0.995777    0.897407    0.804073    0.801378    4200        69.207003   0.037146    0.187504    0.234075    116.375133 
[37m[36mINFO[0m[0m 01/18 14:33:27 | 0.795468    0.784156    0.990828    0.823251    0.738252    0.995881    0.775258    0.981672    0.786942    0.994932    0.907554    0.795468    0.784156    4400        72.502575   0.035158    0.181897    0.224767    113.763381 
[37m[36mINFO[0m[0m 01/18 14:36:04 | 0.806942    0.789897    0.991511    0.828162    0.725345    0.995366    0.787629    0.983391    0.793814    0.995777    0.903044    0.806942    0.789897    4600        75.798146   0.037894    0.174130    0.223666    112.825509 
[37m[36mINFO[0m[0m 01/18 14:38:51 | 0.801205    0.794489    0.989854    0.822899    0.741191    0.993821    0.785567    0.980527    0.781214    0.995214    0.901917    0.801205    0.794489    4800        79.093718   0.035462    0.165012    0.276389    111.293217 
[37m[36mINFO[0m[0m 01/18 14:41:57 | 0.794894    0.791045    0.991477    0.822071    0.751826    0.996395    0.787629    0.983104    0.778923    0.994932    0.899662    0.794894    0.791045    5000        82.389289   0.033480    0.160071    0.368541    112.089970 
[37m[36mINFO[0m[0m 01/18 14:41:57 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[3]/250118_13-30-02_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/18 14:41:59 | ---
[37m[36mINFO[0m[0m 01/18 14:41:59 | test-domain validation(oracle) = 80.407%
[37m[36mINFO[0m[0m 01/18 14:41:59 | training-domain validation(iid) = 80.694%
[37m[36mINFO[0m[0m 01/18 14:41:59 | last = 79.489%
[37m[36mINFO[0m[0m 01/18 14:41:59 | last (inD) = 82.207%
[37m[36mINFO[0m[0m 01/18 14:41:59 | training-domain validation (iid, inD) = 82.816%
[37m[36mINFO[0m[0m 01/18 14:41:59 | === Summary ===
[37m[36mINFO[0m[0m 01/18 14:41:59 | Command: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 20
[37m[36mINFO[0m[0m 01/18 14:41:59 | Unique name: 250118_13-30-02_resnet50_EVE
[37m[36mINFO[0m[0m 01/18 14:41:59 | Out path: train_output/OfficeHome/CORAL/[3]/250118_13-30-02_resnet50_EVE
[37m[36mINFO[0m[0m 01/18 14:41:59 | Algorithm: CORAL
[37m[36mINFO[0m[0m 01/18 14:41:59 | Dataset: OfficeHome
[37m[36mINFO[0m[0m 01/18 14:41:59 | Max test_in: 0.8069

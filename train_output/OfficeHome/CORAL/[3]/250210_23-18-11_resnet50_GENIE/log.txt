[37m[36mINFO[0m[0m 02/10 23:18:11 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 9
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 9
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[3]/250210_23-18-11_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250210_23-18-11_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5.5014200978340895e-05
	batch_size: 15
	weight_decay: 3.288190104805334e-05
	mmd_gamma: 0.11332382437966244
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/10 23:18:11 | n_steps = 5001
[37m[36mINFO[0m[0m 02/10 23:18:11 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/10 23:18:11 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/10 23:18:11 | 
[37m[36mINFO[0m[0m 02/10 23:18:11 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 02/10 23:18:11 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 02/10 23:18:11 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/10 23:18:11 | Batch sizes for each domain: [15, 15, 15, 0] (total=45)
[37m[36mINFO[0m[0m 02/10 23:18:11 | steps-per-epoch for each domain: 129.47, 232.80, 236.80 -> min = 129.47
[37m[36mINFO[0m[0m 02/10 23:18:13 | # of params = 23641217
[37m[36mINFO[0m[0m 02/10 23:20:14 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/10 23:20:14 | 0.026391    0.035591    0.019546    0.017250    4.223250    0.023172    0.016495    0.016323    0.019473    0.019144    0.015784    0.026391    0.035591    0           0.000000    4.334664    0.040777    0.996613    120.141390 
[37m[36mINFO[0m[0m 02/10 23:23:03 | 0.700229    0.692308    0.719149    0.671829    1.210251    0.711637    0.659794    0.675258    0.607102    0.770552    0.748591    0.700229    0.692308    200         1.544799    2.052702    0.435881    0.216626    125.677046 
[37m[36mINFO[0m[0m 02/10 23:25:46 | 0.750430    0.733639    0.790486    0.725389    1.015741    0.794542    0.711340    0.736827    0.664376    0.840090    0.800451    0.750430    0.733639    400         3.089598    0.856920    0.447427    0.187118    125.495977 
[37m[36mINFO[0m[0m 02/10 23:28:24 | 0.745267    0.741676    0.841585    0.733347    0.978314    0.861483    0.711340    0.782360    0.676976    0.880912    0.811725    0.745267    0.741676    600         4.634398    0.626628    0.416463    0.215255    115.383621 
[37m[36mINFO[0m[0m 02/10 23:31:08 | 0.763913    0.743972    0.891610    0.767056    0.876657    0.912976    0.736082    0.851661    0.730813    0.910191    0.834273    0.763913    0.743972    800         6.179197    0.467338    0.417826    0.197532    123.715828 
[37m[36mINFO[0m[0m 02/10 23:33:46 | 0.761331    0.746269    0.905954    0.762484    0.897784    0.925335    0.713402    0.867698    0.727377    0.924831    0.846674    0.761331    0.746269    1000        7.723996    0.389308    0.393276    0.185103    121.322217 
[37m[36mINFO[0m[0m 02/10 23:36:23 | 0.763626    0.762342    0.924390    0.783690    0.852160    0.945932    0.748454    0.889175    0.751432    0.938063    0.851184    0.763626    0.762342    1200        9.268795    0.302334    0.371700    0.187625    119.787967 
[37m[36mINFO[0m[0m 02/10 23:39:06 | 0.773666    0.762342    0.946461    0.787319    0.816335    0.970649    0.731959    0.912371    0.772050    0.956363    0.857948    0.773666    0.762342    1400        10.813594   0.232901    0.357229    0.212298    120.349846 
[37m[36mINFO[0m[0m 02/10 23:41:45 | 0.791165    0.780712    0.958266    0.791236    0.825700    0.983522    0.748454    0.930126    0.757159    0.961149    0.868095    0.791165    0.780712    1600        12.358393   0.193204    0.346047    0.177425    123.905744 
[37m[36mINFO[0m[0m 02/10 23:44:28 | 0.769650    0.776119    0.953760    0.774713    0.864978    0.974253    0.731959    0.928694    0.733104    0.958333    0.859076    0.769650    0.776119    1800        13.903193   0.157426    0.333073    0.213806    119.440463 
[37m[36mINFO[0m[0m 02/10 23:47:08 | 0.786288    0.764638    0.966054    0.795852    0.822696    0.983007    0.746392    0.943872    0.765178    0.971284    0.875986    0.786288    0.764638    2000        15.447992   0.151004    0.312817    0.177373    124.769071 
[37m[36mINFO[0m[0m 02/10 23:49:44 | 0.790591    0.762342    0.971347    0.802429    0.819985    0.985582    0.762887    0.948167    0.756014    0.980293    0.888388    0.790591    0.762342    2200        16.992791   0.127613    0.296328    0.202187    115.905864 
[37m[36mINFO[0m[0m 02/10 23:52:27 | 0.794033    0.788749    0.975518    0.806700    0.797604    0.988671    0.771134    0.955899    0.759450    0.981982    0.889515    0.794033    0.788749    2400        18.537590   0.114635    0.290843    0.191733    124.773699 
[37m[36mINFO[0m[0m 02/10 23:55:01 | 0.778830    0.774971    0.976424    0.803856    0.772777    0.989701    0.754639    0.955899    0.764032    0.983671    0.892897    0.778830    0.774971    2600        20.082389   0.097240    0.270831    0.186154    116.832393 
[37m[36mINFO[0m[0m 02/10 23:57:45 | 0.782272    0.779564    0.979272    0.801033    0.819478    0.990216    0.760825    0.964490    0.764032    0.983108    0.878241    0.782272    0.779564    2800        21.627188   0.081780    0.259150    0.196308    123.862063 
[37m[36mINFO[0m[0m 02/11 00:00:26 | 0.786575    0.780712    0.982640    0.806471    0.803025    0.993821    0.756701    0.965922    0.773196    0.988176    0.889515    0.786575    0.780712    3000        23.171988   0.061541    0.247845    0.189928    123.726992 
[37m[36mINFO[0m[0m 02/11 00:03:12 | 0.784280    0.780712    0.985216    0.815281    0.813866    0.996395    0.764948    0.971077    0.782360    0.988176    0.898534    0.784280    0.780712    3200        24.716787   0.062906    0.236085    0.209585    123.925781 
[37m[36mINFO[0m[0m 02/11 00:05:54 | 0.795468    0.793341    0.985818    0.808303    0.801383    0.992791    0.758763    0.974800    0.776632    0.989865    0.889515    0.795468    0.793341    3400        26.261586   0.059254    0.226535    0.206558    120.753538 
[37m[36mINFO[0m[0m 02/11 00:08:37 | 0.787435    0.778416    0.984819    0.807381    0.821827    0.993821    0.762887    0.969645    0.768614    0.990991    0.890643    0.787435    0.778416    3600        27.806385   0.062244    0.220957    0.192331    124.237483 
[37m[36mINFO[0m[0m 02/11 00:11:13 | 0.789443    0.771527    0.989325    0.814358    0.816255    0.995881    0.758763    0.981386    0.784651    0.990709    0.899662    0.789443    0.771527    3800        29.351184   0.054619    0.205581    0.202716    115.669120 
[37m[36mINFO[0m[0m 02/11 00:13:59 | 0.798623    0.786452    0.988287    0.822793    0.767675    0.995366    0.777320    0.977377    0.783505    0.992117    0.907554    0.798623    0.786452    4000        30.895984   0.047954    0.202244    0.228080    120.048598 
[37m[36mINFO[0m[0m 02/11 00:16:38 | 0.779116    0.783008    0.981233    0.805625    0.840020    0.990731    0.748454    0.965636    0.777778    0.987331    0.890643    0.779116    0.783008    4200        32.440783   0.058507    0.192424    0.182620    122.812522 
[37m[36mINFO[0m[0m 02/11 00:19:21 | 0.792886    0.793341    0.989534    0.819533    0.797118    0.994851    0.773196    0.979381    0.782360    0.994369    0.903044    0.792886    0.793341    4400        33.985582   0.046908    0.190336    0.223249    118.102227 
[37m[36mINFO[0m[0m 02/11 00:21:56 | 0.785427    0.783008    0.989268    0.814242    0.790839    0.994336    0.762887    0.979381    0.786942    0.994088    0.892897    0.785427    0.783008    4600        35.530381   0.046725    0.175446    0.188918    117.759924 
[37m[36mINFO[0m[0m 02/11 00:24:38 | 0.796041    0.794489    0.989840    0.810112    0.783376    0.996910    0.760825    0.978522    0.775487    0.994088    0.894025    0.796041    0.794489    4800        37.075180   0.036409    0.176275    0.195454    122.873165 
[37m[36mINFO[0m[0m 02/11 00:27:14 | 0.797476    0.783008    0.989689    0.819851    0.755179    0.995881    0.775258    0.979381    0.783505    0.993806    0.900789    0.797476    0.783008    5000        38.619979   0.038134    0.164433    0.175542    120.996798 
[37m[36mINFO[0m[0m 02/11 00:27:15 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[3]/250210_23-18-11_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/11 00:27:16 | ---
[37m[36mINFO[0m[0m 02/11 00:27:16 | test-domain validation(oracle) = 79.604%
[37m[36mINFO[0m[0m 02/11 00:27:16 | training-domain validation(iid) = 79.862%
[37m[36mINFO[0m[0m 02/11 00:27:16 | last = 79.748%
[37m[36mINFO[0m[0m 02/11 00:27:16 | last (inD) = 81.985%
[37m[36mINFO[0m[0m 02/11 00:27:16 | training-domain validation (iid, inD) = 82.279%
[37m[36mINFO[0m[0m 02/11 00:27:16 | === Summary ===
[37m[36mINFO[0m[0m 02/11 00:27:16 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 9
[37m[36mINFO[0m[0m 02/11 00:27:16 | Unique name: 250210_23-18-11_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 00:27:16 | Out path: train_output/OfficeHome/CORAL/[3]/250210_23-18-11_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 00:27:16 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/11 00:27:16 | Dataset: OfficeHome

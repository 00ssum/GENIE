[37m[36mINFO[0m[0m 02/11 01:45:29 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 3 --dataset OfficeHome --trial_seed 1 --hparams_seed 15
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 15
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[3]/250211_01-45-29_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250211_01-45-29_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.7812453400894684e-05
	batch_size: 36
	weight_decay: 3.1651536009272826e-06
	mmd_gamma: 3.440541362473826
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/11 01:45:29 | n_steps = 5001
[37m[36mINFO[0m[0m 02/11 01:45:29 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/11 01:45:29 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/11 01:45:29 | 
[37m[36mINFO[0m[0m 02/11 01:45:29 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 02/11 01:45:29 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 02/11 01:45:29 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/11 01:45:29 | Batch sizes for each domain: [36, 36, 36, 0] (total=108)
[37m[36mINFO[0m[0m 02/11 01:45:29 | steps-per-epoch for each domain: 53.94, 97.00, 98.67 -> min = 53.94
[37m[36mINFO[0m[0m 02/11 01:45:31 | # of params = 23641217
[37m[36mINFO[0m[0m 02/11 01:47:39 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/11 01:47:39 | 0.020367    0.022962    0.014746    0.014596    4.193867    0.022657    0.016495    0.010882    0.014891    0.010698    0.012401    0.020367    0.022962    0           0.000000    4.340389    0.031279    1.256849    127.244947 
[37m[36mINFO[0m[0m 02/11 01:50:32 | 0.744406    0.734788    0.764250    0.728480    1.063668    0.772915    0.731959    0.707617    0.659794    0.812218    0.793687    0.744406    0.734788    200         3.707518    1.990917    0.058711    0.269896    119.146053 
[37m[36mINFO[0m[0m 02/11 01:53:31 | 0.765921    0.774971    0.861024    0.779514    0.832267    0.872297    0.769072    0.811283    0.722795    0.899493    0.846674    0.765921    0.774971    400         7.415036    0.709686    0.052950    0.309496    116.572846 
[37m[36mINFO[0m[0m 02/11 01:56:32 | 0.776535    0.769231    0.905828    0.801720    0.740318    0.923275    0.773196    0.867125    0.753723    0.927083    0.878241    0.776535    0.769231    600         11.122554   0.472983    0.045255    0.261442    129.267489 
[37m[36mINFO[0m[0m 02/11 01:59:21 | 0.781411    0.774971    0.930651    0.806131    0.715006    0.948507    0.787629    0.898625    0.749141    0.944820    0.881623    0.781411    0.774971    800         14.830072   0.339332    0.039839    0.259915    116.546472 
[37m[36mINFO[0m[0m 02/11 02:02:17 | 0.794894    0.779564    0.957726    0.819429    0.680086    0.979918    0.787629    0.930985    0.776632    0.962275    0.894025    0.794894    0.779564    1000        18.537590   0.244403    0.035981    0.281324    119.753663 
[37m[36mINFO[0m[0m 02/11 02:05:15 | 0.781698    0.781860    0.963747    0.819593    0.693217    0.984037    0.793814    0.939863    0.773196    0.967342    0.891770    0.781698    0.781860    1200        22.245108   0.199453    0.032611    0.256152    127.097463 
[37m[36mINFO[0m[0m 02/11 02:08:12 | 0.783133    0.779564    0.972012    0.814465    0.707057    0.986097    0.787629    0.952463    0.761741    0.977477    0.894025    0.783133    0.779564    1400        25.952626   0.157095    0.030018    0.302588    116.475165 
[37m[36mINFO[0m[0m 02/11 02:11:07 | 0.790017    0.780712    0.978305    0.825789    0.664483    0.988157    0.800000    0.964777    0.773196    0.981982    0.904171    0.790017    0.780712    1600        29.660144   0.127675    0.027499    0.275324    120.288024 
[37m[36mINFO[0m[0m 02/11 02:14:11 | 0.786288    0.778416    0.984117    0.823850    0.664557    0.995366    0.789691    0.970218    0.772050    0.986768    0.909808    0.786288    0.778416    1800        33.367662   0.102766    0.025439    0.297314    123.604024 
[37m[36mINFO[0m[0m 02/11 02:17:09 | 0.792025    0.788749    0.985784    0.826675    0.649172    0.996395    0.795876    0.971936    0.774341    0.989020    0.909808    0.792025    0.788749    2000        37.075180   0.090902    0.023807    0.291795    120.346097 
[37m[36mINFO[0m[0m 02/11 02:20:03 | 0.794320    0.793341    0.987859    0.825960    0.669291    0.993821    0.806186    0.976231    0.770905    0.993525    0.900789    0.794320    0.793341    2200        40.782698   0.083018    0.022241    0.277998    118.474394 
[37m[36mINFO[0m[0m 02/11 02:23:01 | 0.792599    0.792193    0.988493    0.827222    0.651240    0.994851    0.791753    0.977950    0.782360    0.992680    0.907554    0.792599    0.792193    2400        44.490216   0.073963    0.020592    0.277692    121.899190 
[37m[36mINFO[0m[0m 02/11 02:25:56 | 0.795181    0.796785    0.987997    0.832983    0.638957    0.995366    0.800000    0.975945    0.783505    0.992680    0.915445    0.795181    0.796785    2600        48.197734   0.068864    0.019832    0.268976    121.071622 
[37m[36mINFO[0m[0m 02/11 02:28:55 | 0.792312    0.802526    0.988804    0.832708    0.641480    0.994336    0.808247    0.980241    0.780069    0.991836    0.909808    0.792312    0.802526    2800        51.905252   0.061593    0.018922    0.274463    124.364561 
[37m[36mINFO[0m[0m 02/11 02:31:49 | 0.793173    0.787600    0.989065    0.833301    0.649621    0.994851    0.802062    0.979381    0.784651    0.992962    0.913191    0.793173    0.787600    3000        55.612770   0.057063    0.017833    0.263133    121.923513 
[37m[36mINFO[0m[0m 02/11 02:34:44 | 0.793173    0.791045    0.990503    0.831163    0.674310    0.994336    0.797938    0.981959    0.782360    0.995214    0.913191    0.793173    0.791045    3200        59.320288   0.053880    0.017196    0.282922    118.082166 
[37m[36mINFO[0m[0m 02/11 02:37:42 | 0.791165    0.795637    0.991108    0.825636    0.663735    0.995881    0.793814    0.981386    0.778923    0.996059    0.904171    0.791165    0.795637    3400        63.027806   0.050573    0.016315    0.265875    125.004571 
[37m[36mINFO[0m[0m 02/11 02:40:40 | 0.785427    0.787600    0.990775    0.822558    0.664892    0.994851    0.783505    0.983104    0.775487    0.994369    0.908681    0.785427    0.787600    3600        66.735324   0.050285    0.016045    0.292152    119.098829 
[37m[36mINFO[0m[0m 02/11 02:43:33 | 0.789730    0.786452    0.990694    0.832592    0.666020    0.994336    0.812371    0.982532    0.782360    0.995214    0.903044    0.789730    0.786452    3800        70.442842   0.045073    0.015335    0.271243    119.130343 
[37m[36mINFO[0m[0m 02/11 02:46:31 | 0.791738    0.794489    0.991874    0.827268    0.668938    0.995881    0.779381    0.983963    0.789233    0.995777    0.913191    0.791738    0.794489    4000        74.150360   0.042455    0.014674    0.274654    122.498346 
[37m[36mINFO[0m[0m 02/11 02:49:29 | 0.794607    0.787600    0.990369    0.829583    0.663190    0.995366    0.800000    0.980527    0.780069    0.995214    0.908681    0.794607    0.787600    4200        77.857878   0.042171    0.014206    0.267298    124.666921 
[37m[36mINFO[0m[0m 02/11 02:52:33 | 0.798336    0.794489    0.992384    0.833512    0.664288    0.997425    0.806186    0.983104    0.777778    0.996622    0.916573    0.798336    0.794489    4400        81.565396   0.038598    0.013703    0.281069    127.943830 
[37m[36mINFO[0m[0m 02/11 02:55:25 | 0.788296    0.791045    0.991414    0.834887    0.655753    0.995366    0.800000    0.982818    0.788087    0.996059    0.916573    0.788296    0.791045    4600        85.272915   0.039867    0.013482    0.268784    117.921060 
[37m[36mINFO[0m[0m 02/11 02:58:30 | 0.786001    0.792193    0.991490    0.832678    0.680142    0.995881    0.797938    0.982532    0.784651    0.996059    0.915445    0.786001    0.792193    4800        88.980433   0.041260    0.013199    0.300881    124.913534 
[37m[36mINFO[0m[0m 02/11 03:01:27 | 0.787722    0.788749    0.991888    0.826394    0.675112    0.995366    0.804124    0.983677    0.769759    0.996622    0.905299    0.787722    0.788749    5000        92.687951   0.039896    0.012913    0.269122    123.660115 
[37m[36mINFO[0m[0m 02/11 03:01:27 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[3]/250211_01-45-29_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/11 03:01:28 | ---
[37m[36mINFO[0m[0m 02/11 03:01:28 | test-domain validation(oracle) = 79.231%
[37m[36mINFO[0m[0m 02/11 03:01:28 | training-domain validation(iid) = 78.830%
[37m[36mINFO[0m[0m 02/11 03:01:28 | last = 78.772%
[37m[36mINFO[0m[0m 02/11 03:01:28 | last (inD) = 82.639%
[37m[36mINFO[0m[0m 02/11 03:01:28 | training-domain validation (iid, inD) = 83.489%
[37m[36mINFO[0m[0m 02/11 03:01:29 | === Summary ===
[37m[36mINFO[0m[0m 02/11 03:01:29 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 3 --dataset OfficeHome --trial_seed 1 --hparams_seed 15
[37m[36mINFO[0m[0m 02/11 03:01:29 | Unique name: 250211_01-45-29_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 03:01:29 | Out path: train_output/OfficeHome/CORAL/[3]/250211_01-45-29_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 03:01:29 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/11 03:01:29 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 02/10 19:40:02 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 6
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 6
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[3]/250210_19-40-02_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250210_19-40-02_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.5764387170443743e-05
	batch_size: 19
	weight_decay: 0.0006024239579587198
	mmd_gamma: 0.6238365410759901
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/10 19:40:02 | n_steps = 5001
[37m[36mINFO[0m[0m 02/10 19:40:02 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/10 19:40:02 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/10 19:40:02 | 
[37m[36mINFO[0m[0m 02/10 19:40:02 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 02/10 19:40:02 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 02/10 19:40:02 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/10 19:40:02 | Batch sizes for each domain: [19, 19, 19, 0] (total=57)
[37m[36mINFO[0m[0m 02/10 19:40:02 | steps-per-epoch for each domain: 102.21, 183.79, 186.95 -> min = 102.21
[37m[36mINFO[0m[0m 02/10 19:40:03 | # of params = 23641217
[37m[36mINFO[0m[0m 02/10 19:42:11 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/10 19:42:11 | 0.022662    0.034443    0.020770    0.016404    4.224750    0.026262    0.018557    0.017468    0.013746    0.018581    0.016911    0.022662    0.034443    0           0.000000    4.295380    0.041390    1.279848    126.242806 
[37m[36mINFO[0m[0m 02/10 19:44:53 | 0.717441    0.698048    0.730533    0.694728    1.140572    0.728115    0.686598    0.671535    0.618557    0.791948    0.779030    0.717441    0.698048    200         1.956746    2.108086    0.204242    0.183954    126.157088 
[37m[36mINFO[0m[0m 02/10 19:47:34 | 0.746988    0.743972    0.826981    0.759956    0.922895    0.830072    0.744330    0.781501    0.715922    0.869369    0.819617    0.746988    0.743972    400         3.913491    0.808990    0.201903    0.193241    122.185275 
[37m[36mINFO[0m[0m 02/10 19:50:30 | 0.769937    0.756602    0.869577    0.778561    0.826313    0.886715    0.752577    0.826747    0.729668    0.895270    0.853439    0.769937    0.756602    600         5.870237    0.557640    0.173374    0.232688    128.977239 
[37m[36mINFO[0m[0m 02/10 19:53:21 | 0.782846    0.774971    0.904101    0.783804    0.826479    0.932029    0.742268    0.858820    0.736541    0.921453    0.872604    0.782846    0.774971    800         7.826982    0.432156    0.154486    0.203040    130.336532 
[37m[36mINFO[0m[0m 02/10 19:56:08 | 0.770224    0.764638    0.923264    0.785591    0.790509    0.939753    0.746392    0.888316    0.743414    0.941723    0.866967    0.770224    0.764638    1000        9.783728    0.357876    0.143791    0.209592    125.068058 
[37m[36mINFO[0m[0m 02/10 19:58:52 | 0.790878    0.779564    0.944510    0.809204    0.729898    0.966529    0.787629    0.909794    0.761741    0.957207    0.878241    0.790878    0.779564    1200        11.740474   0.271224    0.132425    0.201682    123.820803 
[37m[36mINFO[0m[0m 02/10 20:01:43 | 0.776535    0.777268    0.949656    0.804304    0.754811    0.968589    0.764948    0.918385    0.767468    0.961993    0.880496    0.776535    0.777268    1400        13.697219   0.215953    0.122567    0.233435    124.399663 
[37m[36mINFO[0m[0m 02/10 20:04:26 | 0.791738    0.789897    0.960880    0.814336    0.720864    0.976313    0.781443    0.937858    0.772050    0.968468    0.889515    0.791738    0.789897    1600        15.653965   0.190723    0.114414    0.213460    120.278651 
[37m[36mINFO[0m[0m 02/10 20:07:15 | 0.800918    0.791045    0.969781    0.809473    0.741915    0.984552    0.769072    0.947595    0.774341    0.977196    0.885006    0.800918    0.791045    1800        17.610711   0.158723    0.107827    0.230753    123.016936 
[37m[36mINFO[0m[0m 02/10 20:10:06 | 0.794033    0.799082    0.968585    0.807765    0.759448    0.983522    0.775258    0.946163    0.772050    0.976070    0.875986    0.794033    0.799082    2000        19.567456   0.129974    0.101387    0.240613    122.886092 
[37m[36mINFO[0m[0m 02/10 20:12:53 | 0.804934    0.797933    0.979300    0.815299    0.702920    0.991761    0.775258    0.961340    0.775487    0.984797    0.895152    0.804934    0.797933    2200        21.524202   0.116320    0.094999    0.228967    120.519545 
[37m[36mINFO[0m[0m 02/10 20:15:38 | 0.792599    0.797933    0.979758    0.806865    0.720457    0.989701    0.756701    0.964777    0.776632    0.984797    0.887260    0.792599    0.797933    2400        23.480947   0.098877    0.089152    0.221281    120.768478 
[37m[36mINFO[0m[0m 02/10 20:18:29 | 0.793173    0.784156    0.978926    0.811987    0.742419    0.994336    0.783505    0.959336    0.766323    0.983108    0.886133    0.793173    0.784156    2600        25.437693   0.083607    0.085396    0.226886    126.020961 
[37m[36mINFO[0m[0m 02/10 20:21:13 | 0.800344    0.793341    0.984851    0.822166    0.691530    0.993306    0.785567    0.972509    0.784651    0.988739    0.896280    0.800344    0.793341    2800        27.394439   0.082346    0.082956    0.218464    120.465702 
[37m[36mINFO[0m[0m 02/10 20:24:00 | 0.796328    0.781860    0.986629    0.826876    0.697015    0.993821    0.791753    0.974513    0.788087    0.991554    0.900789    0.796328    0.781860    3000        29.351184   0.078943    0.077678    0.219360    123.317345 
[37m[36mINFO[0m[0m 02/10 20:26:52 | 0.794607    0.788749    0.986359    0.824157    0.700623    0.993306    0.793814    0.973654    0.783505    0.992117    0.895152    0.794607    0.788749    3200        31.307930   0.071924    0.074210    0.235115    124.789236 
[37m[36mINFO[0m[0m 02/10 20:29:39 | 0.795754    0.788749    0.988406    0.824802    0.714201    0.994851    0.785567    0.979095    0.785796    0.991273    0.903044    0.795754    0.788749    3400        33.264676   0.063549    0.070707    0.232926    120.252556 
[37m[36mINFO[0m[0m 02/10 20:32:29 | 0.791452    0.786452    0.988322    0.825502    0.700894    0.994336    0.787629    0.977950    0.788087    0.992680    0.900789    0.791452    0.786452    3600        35.221421   0.059860    0.068104    0.227744    124.469259 
[37m[36mINFO[0m[0m 02/10 20:35:20 | 0.798336    0.802526    0.989118    0.817690    0.722601    0.995881    0.783505    0.977950    0.778923    0.993525    0.890643    0.798336    0.802526    3800        37.178167   0.053895    0.067770    0.230803    124.629987 
[37m[36mINFO[0m[0m 02/10 20:38:11 | 0.786575    0.776119    0.989670    0.813090    0.741879    0.996395    0.773196    0.978809    0.772050    0.993806    0.894025    0.786575    0.776119    4000        39.134912   0.054185    0.062914    0.207923    129.201033 
[37m[36mINFO[0m[0m 02/10 20:40:59 | 0.794607    0.787600    0.989615    0.818870    0.711320    0.995366    0.771134    0.979954    0.786942    0.993525    0.898534    0.794607    0.787600    4200        41.091658   0.046909    0.060101    0.232344    121.960437 
[37m[36mINFO[0m[0m 02/10 20:43:47 | 0.775961    0.774971    0.988850    0.819628    0.732931    0.995366    0.781443    0.977377    0.777778    0.993806    0.899662    0.775961    0.774971    4400        43.048404   0.047331    0.058269    0.213548    125.197423 
[37m[36mINFO[0m[0m 02/10 20:46:34 | 0.783706    0.789897    0.989749    0.820562    0.739431    0.994336    0.777320    0.981386    0.788087    0.993525    0.896280    0.783706    0.789897    4600        45.005149   0.047806    0.057135    0.238286    119.295407 
[37m[36mINFO[0m[0m 02/10 20:49:25 | 0.802926    0.803674    0.990615    0.817743    0.712693    0.996395    0.781443    0.979954    0.776632    0.995495    0.895152    0.802926    0.803674    4800        46.961895   0.044110    0.056256    0.217678    127.176730 
[37m[36mINFO[0m[0m 02/10 20:52:09 | 0.794894    0.789897    0.989519    0.817055    0.728932    0.995366    0.779381    0.979668    0.776632    0.993525    0.895152    0.794894    0.789897    5000        48.918641   0.043674    0.054879    0.244783    115.202893 
[37m[36mINFO[0m[0m 02/10 20:52:09 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[3]/250210_19-40-02_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/10 20:52:10 | ---
[37m[36mINFO[0m[0m 02/10 20:52:10 | test-domain validation(oracle) = 80.293%
[37m[36mINFO[0m[0m 02/10 20:52:10 | training-domain validation(iid) = 79.633%
[37m[36mINFO[0m[0m 02/10 20:52:10 | last = 79.489%
[37m[36mINFO[0m[0m 02/10 20:52:10 | last (inD) = 81.706%
[37m[36mINFO[0m[0m 02/10 20:52:10 | training-domain validation (iid, inD) = 82.688%
[37m[36mINFO[0m[0m 02/10 20:52:10 | === Summary ===
[37m[36mINFO[0m[0m 02/10 20:52:10 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 6
[37m[36mINFO[0m[0m 02/10 20:52:10 | Unique name: 250210_19-40-02_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 20:52:10 | Out path: train_output/OfficeHome/CORAL/[3]/250210_19-40-02_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 20:52:10 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/10 20:52:10 | Dataset: OfficeHome

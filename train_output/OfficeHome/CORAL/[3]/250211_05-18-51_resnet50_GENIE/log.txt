[37m[36mINFO[0m[0m 02/11 05:18:51 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 3 --dataset OfficeHome --trial_seed 1 --hparams_seed 18
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 18
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[3]/250211_05-18-51_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250211_05-18-51_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.0002805925701721472
	batch_size: 39
	weight_decay: 1.5909976529017505e-06
	mmd_gamma: 0.7378941383723668
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/11 05:18:51 | n_steps = 5001
[37m[36mINFO[0m[0m 02/11 05:18:51 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/11 05:18:51 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/11 05:18:51 | 
[37m[36mINFO[0m[0m 02/11 05:18:51 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 02/11 05:18:51 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 02/11 05:18:51 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/11 05:18:51 | Batch sizes for each domain: [39, 39, 39, 0] (total=117)
[37m[36mINFO[0m[0m 02/11 05:18:51 | steps-per-epoch for each domain: 49.79, 89.54, 91.08 -> min = 49.79
[37m[36mINFO[0m[0m 02/11 05:18:52 | # of params = 23641217
[37m[36mINFO[0m[0m 02/11 05:20:59 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/11 05:20:59 | 0.017785    0.017222    0.012279    0.013615    4.196687    0.020082    0.012371    0.008591    0.018328    0.008164    0.010147    0.017785    0.017222    0           0.000000    4.351030    0.033140    1.142226    126.494764 
[37m[36mINFO[0m[0m 02/11 05:23:56 | 0.766208    0.776119    0.808397    0.752738    0.892828    0.811020    0.764948    0.758877    0.680412    0.855293    0.812852    0.766208    0.776119    200         4.016478    1.681141    0.164035    0.275782    121.623386 
[37m[36mINFO[0m[0m 02/11 05:27:01 | 0.786001    0.783008    0.876761    0.794304    0.747374    0.898043    0.791753    0.831901    0.739977    0.900338    0.851184    0.786001    0.783008    400         8.032956    0.599785    0.144364    0.292709    126.167835 
[37m[36mINFO[0m[0m 02/11 05:30:03 | 0.780264    0.776119    0.926500    0.806149    0.720969    0.953141    0.787629    0.887171    0.752577    0.939189    0.878241    0.780264    0.776119    600         12.049434   0.387530    0.127034    0.280971    126.293218 
[37m[36mINFO[0m[0m 02/11 05:33:04 | 0.776248    0.786452    0.946355    0.805532    0.725614    0.968589    0.793814    0.915521    0.743414    0.954955    0.879369    0.776248    0.786452    800         16.065911   0.260371    0.113738    0.308490    118.402388 
[37m[36mINFO[0m[0m 02/11 05:36:05 | 0.797476    0.799082    0.964885    0.811101    0.690908    0.983522    0.797938    0.939003    0.754868    0.972128    0.880496    0.797476    0.799082    1000        20.082389   0.183355    0.103718    0.312012    119.063458 
[37m[36mINFO[0m[0m 02/11 05:39:07 | 0.798336    0.792193    0.972917    0.823064    0.655748    0.987127    0.802062    0.952176    0.767468    0.979448    0.899662    0.798336    0.792193    1200        24.098867   0.150681    0.092602    0.291868    124.025308 
[37m[36mINFO[0m[0m 02/11 05:42:13 | 0.798910    0.796785    0.979837    0.822759    0.651140    0.992791    0.800000    0.962486    0.768614    0.984234    0.899662    0.798910    0.796785    1400        28.115345   0.114695    0.083980    0.298187    125.873792 
[37m[36mINFO[0m[0m 02/11 05:45:18 | 0.790878    0.794489    0.982583    0.820731    0.665297    0.992791    0.791753    0.966781    0.762887    0.988176    0.907554    0.790878    0.794489    1600        32.131823   0.096848    0.075599    0.319342    120.906397 
[37m[36mINFO[0m[0m 02/11 05:48:27 | 0.791738    0.786452    0.984736    0.824332    0.653783    0.993821    0.787629    0.971649    0.780069    0.988739    0.905299    0.791738    0.786452    1800        36.148301   0.081880    0.070838    0.356894    118.204263 
[37m[36mINFO[0m[0m 02/11 05:51:37 | 0.794320    0.781860    0.986664    0.827469    0.668989    0.995881    0.806186    0.975372    0.772050    0.988739    0.904171    0.794320    0.781860    2000        40.164779   0.072575    0.065430    0.335800    122.484139 
[37m[36mINFO[0m[0m 02/11 05:54:41 | 0.795754    0.788749    0.987611    0.827158    0.666541    0.992791    0.804124    0.976518    0.772050    0.993525    0.905299    0.795754    0.788749    2200        44.181256   0.063491    0.060651    0.319233    120.284137 
[37m[36mINFO[0m[0m 02/11 05:57:48 | 0.796328    0.796785    0.989282    0.831951    0.651918    0.996910    0.808247    0.979381    0.778923    0.991554    0.908681    0.796328    0.796785    2400        48.197734   0.056643    0.058183    0.354277    116.074013 
[37m[36mINFO[0m[0m 02/11 06:00:57 | 0.794607    0.789897    0.989876    0.835293    0.646302    0.995881    0.810309    0.979095    0.783505    0.994651    0.912063    0.794607    0.789897    2600        52.214212   0.053136    0.053800    0.335678    121.976094 
[37m[36mINFO[0m[0m 02/11 06:04:03 | 0.791165    0.793341    0.990539    0.834079    0.660845    0.996395    0.814433    0.983104    0.791523    0.992117    0.896280    0.791165    0.793341    2800        56.230690   0.048309    0.051197    0.317420    122.859763 
[37m[36mINFO[0m[0m 02/11 06:07:04 | 0.792599    0.787600    0.990561    0.834483    0.656636    0.995366    0.802062    0.981386    0.794960    0.994932    0.906426    0.792599    0.787600    3000        60.247168   0.048871    0.049231    0.301188    120.773198 
[37m[36mINFO[0m[0m 02/11 06:10:13 | 0.793173    0.792193    0.991008    0.829925    0.640457    0.996395    0.802062    0.983104    0.785796    0.993525    0.901917    0.793173    0.792193    3200        64.263646   0.042565    0.046959    0.302992    127.613147 
[37m[36mINFO[0m[0m 02/11 06:13:25 | 0.797476    0.799082    0.990395    0.823034    0.669596    0.994851    0.791753    0.982245    0.772050    0.994088    0.905299    0.797476    0.799082    3400        68.280124   0.041602    0.045002    0.289708    134.600521 
[37m[36mINFO[0m[0m 02/11 06:16:29 | 0.792312    0.794489    0.991508    0.828090    0.663312    0.995366    0.797938    0.982818    0.769759    0.996340    0.916573    0.792312    0.794489    3600        72.296601   0.037595    0.043198    0.288258    125.940774 
[37m[36mINFO[0m[0m 02/11 06:19:32 | 0.793460    0.799082    0.992071    0.825671    0.675492    0.995881    0.791753    0.985682    0.773196    0.994651    0.912063    0.793460    0.799082    3800        76.313079   0.040332    0.041753    0.313100    120.338424 
[37m[36mINFO[0m[0m 02/11 06:22:36 | 0.799484    0.803674    0.992523    0.832403    0.650594    0.996395    0.806186    0.985395    0.781214    0.995777    0.909808    0.799484    0.803674    4000        80.329557   0.037088    0.039591    0.293357    125.334683 
[37m[36mINFO[0m[0m 02/11 06:25:37 | 0.791165    0.785304    0.991883    0.829008    0.671771    0.995366    0.806186    0.982818    0.778923    0.997466    0.901917    0.791165    0.785304    4200        84.346035   0.035553    0.038878    0.289215    122.966019 
[37m[36mINFO[0m[0m 02/11 06:28:45 | 0.794320    0.791045    0.991469    0.830829    0.650828    0.993821    0.808247    0.983963    0.780069    0.996622    0.904171    0.794320    0.791045    4400        88.362513   0.034695    0.038273    0.353743    117.445587 
[37m[36mINFO[0m[0m 02/11 06:31:52 | 0.797476    0.792193    0.991810    0.828261    0.672729    0.994851    0.793814    0.983677    0.777778    0.996903    0.913191    0.797476    0.792193    4600        92.378991   0.032567    0.036290    0.314599    124.656977 
[37m[36mINFO[0m[0m 02/11 06:35:02 | 0.792886    0.797933    0.991280    0.831181    0.678732    0.996395    0.797938    0.981386    0.785796    0.996059    0.909808    0.792886    0.797933    4800        96.395469   0.032680    0.035086    0.307073    128.433630 
[37m[36mINFO[0m[0m 02/11 06:38:01 | 0.795468    0.797933    0.992174    0.833349    0.671193    0.995366    0.812371    0.984536    0.783505    0.996622    0.904171    0.795468    0.797933    5000        100.411946  0.030490    0.034336    0.293947    119.994092 
[37m[36mINFO[0m[0m 02/11 06:38:01 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[3]/250211_05-18-51_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/11 06:38:03 | ---
[37m[36mINFO[0m[0m 02/11 06:38:03 | test-domain validation(oracle) = 79.948%
[37m[36mINFO[0m[0m 02/11 06:38:03 | training-domain validation(iid) = 79.461%
[37m[36mINFO[0m[0m 02/11 06:38:03 | last = 79.547%
[37m[36mINFO[0m[0m 02/11 06:38:03 | last (inD) = 83.335%
[37m[36mINFO[0m[0m 02/11 06:38:03 | training-domain validation (iid, inD) = 83.529%
[37m[36mINFO[0m[0m 02/11 06:38:03 | === Summary ===
[37m[36mINFO[0m[0m 02/11 06:38:03 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 3 --dataset OfficeHome --trial_seed 1 --hparams_seed 18
[37m[36mINFO[0m[0m 02/11 06:38:03 | Unique name: 250211_05-18-51_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 06:38:03 | Out path: train_output/OfficeHome/CORAL/[3]/250211_05-18-51_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 06:38:03 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/11 06:38:03 | Dataset: OfficeHome

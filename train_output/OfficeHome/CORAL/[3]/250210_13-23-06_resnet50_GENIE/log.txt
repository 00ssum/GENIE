[37m[36mINFO[0m[0m 02/10 13:23:06 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[3]/250210_13-23-06_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250210_13-23-06_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5.0781288859686544e-05
	batch_size: 44
	weight_decay: 0.00046410133598234803
	mmd_gamma: 1.1642706271054615
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/10 13:23:06 | n_steps = 5001
[37m[36mINFO[0m[0m 02/10 13:23:06 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/10 13:23:06 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/10 13:23:06 | 
[37m[36mINFO[0m[0m 02/10 13:23:06 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 02/10 13:23:06 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 02/10 13:23:06 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/10 13:23:06 | Batch sizes for each domain: [44, 44, 44, 0] (total=132)
[37m[36mINFO[0m[0m 02/10 13:23:06 | steps-per-epoch for each domain: 44.14, 79.36, 80.73 -> min = 44.14
[37m[36mINFO[0m[0m 02/10 13:23:07 | # of params = 23641217
[37m[36mINFO[0m[0m 02/10 13:25:06 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/10 13:25:06 | 0.019793    0.022962    0.015711    0.011865    4.223090    0.021627    0.018557    0.010023    0.008018    0.015484    0.009019    0.019793    0.022962    0           0.000000    4.280630    0.028306    1.017280    117.383450 
[37m[36mINFO[0m[0m 02/10 13:28:09 | 0.767929    0.753157    0.807261    0.747038    0.941451    0.804325    0.742268    0.753436    0.676976    0.864020    0.821871    0.767929    0.753157    200         4.531411    1.762442    0.121567    0.320578    118.925255 
[37m[36mINFO[0m[0m 02/10 13:31:03 | 0.795181    0.773823    0.887649    0.789598    0.785776    0.908342    0.762887    0.839347    0.745704    0.915259    0.860203    0.795181    0.773823    400         9.062822    0.593459    0.106562    0.309065    113.080814 
[37m[36mINFO[0m[0m 02/10 13:34:02 | 0.787435    0.768083    0.928105    0.798460    0.745497    0.950566    0.758763    0.891180    0.762887    0.942568    0.873732    0.787435    0.768083    600         13.594233   0.377369    0.092281    0.311202    116.444511 
[37m[36mINFO[0m[0m 02/10 13:36:58 | 0.790878    0.777268    0.955664    0.808080    0.729380    0.971164    0.775258    0.932990    0.760596    0.962838    0.888388    0.790878    0.777268    800         18.125644   0.257889    0.080599    0.312178    113.803258 
[37m[36mINFO[0m[0m 02/10 13:39:56 | 0.800344    0.801378    0.964597    0.814642    0.707879    0.986612    0.783505    0.938431    0.770905    0.968750    0.889515    0.800344    0.801378    1000        22.657055   0.195164    0.072182    0.312404    115.191442 
[37m[36mINFO[0m[0m 02/10 13:42:54 | 0.798049    0.789897    0.972226    0.815476    0.705297    0.987642    0.781443    0.949026    0.774341    0.980011    0.890643    0.798049    0.789897    1200        27.188465   0.151094    0.065554    0.310649    115.595280 
[37m[36mINFO[0m[0m 02/10 13:45:54 | 0.794033    0.787600    0.980394    0.819059    0.701686    0.990216    0.787629    0.963918    0.777778    0.987050    0.891770    0.794033    0.787600    1400        31.719876   0.119940    0.059010    0.320221    116.189180 
[37m[36mINFO[0m[0m 02/10 13:48:50 | 0.803500    0.796785    0.983728    0.822337    0.702388    0.992791    0.791753    0.970218    0.782360    0.988176    0.892897    0.803500    0.796785    1600        36.251287   0.097336    0.054422    0.307094    114.645703 
[37m[36mINFO[0m[0m 02/10 13:51:50 | 0.798910    0.800230    0.987221    0.816016    0.701420    0.993306    0.777320    0.976804    0.781214    0.991554    0.889515    0.798910    0.800230    1800        40.782698   0.078254    0.049524    0.319254    115.646442 
[37m[36mINFO[0m[0m 02/10 13:54:48 | 0.798910    0.787600    0.988217    0.820015    0.718017    0.994851    0.791753    0.978809    0.769759    0.990991    0.898534    0.798910    0.787600    2000        45.314109   0.072546    0.046302    0.314850    115.626744 
[37m[36mINFO[0m[0m 02/10 13:57:48 | 0.797762    0.801378    0.987905    0.824686    0.717816    0.995366    0.789691    0.976231    0.788087    0.992117    0.896280    0.797762    0.801378    2200        49.845520   0.063194    0.043484    0.312748    117.399219 
[37m[36mINFO[0m[0m 02/10 14:00:47 | 0.804647    0.788749    0.988514    0.813683    0.728112    0.994336    0.777320    0.978809    0.766323    0.992399    0.897407    0.804647    0.788749    2400        54.376931   0.055973    0.040410    0.310976    116.334606 
[37m[36mINFO[0m[0m 02/10 14:03:46 | 0.793746    0.786452    0.989459    0.820245    0.712267    0.994336    0.795876    0.979954    0.766323    0.994088    0.898534    0.793746    0.786452    2600        58.908342   0.051594    0.037746    0.314022    116.578798 
[37m[36mINFO[0m[0m 02/10 14:06:46 | 0.803787    0.789897    0.991535    0.813784    0.709113    0.994851    0.775258    0.984822    0.773196    0.994932    0.892897    0.803787    0.789897    2800        63.439753   0.050347    0.036392    0.316183    117.151594 
[37m[36mINFO[0m[0m 02/10 14:09:46 | 0.800631    0.786452    0.990280    0.822306    0.707445    0.995366    0.791753    0.981386    0.776632    0.994088    0.898534    0.800631    0.786452    3000        67.971164   0.045839    0.034663    0.318489    115.921010 
[37m[36mINFO[0m[0m 02/10 14:12:45 | 0.805508    0.789897    0.992296    0.814182    0.720605    0.997425    0.773196    0.984250    0.765178    0.995214    0.904171    0.805508    0.789897    3200        72.502575   0.040756    0.032644    0.312353    116.006434 
[37m[36mINFO[0m[0m 02/10 14:15:47 | 0.802639    0.788749    0.991859    0.817437    0.721314    0.996395    0.789691    0.984250    0.767468    0.994932    0.895152    0.802639    0.788749    3400        77.033986   0.039331    0.031915    0.314930    119.287829 
[37m[36mINFO[0m[0m 02/10 14:18:45 | 0.800057    0.791045    0.991358    0.818335    0.723697    0.996910    0.785567    0.981386    0.770905    0.995777    0.898534    0.800057    0.791045    3600        81.565396   0.038311    0.030094    0.308293    116.412497 
[37m[36mINFO[0m[0m 02/10 14:21:46 | 0.798049    0.795637    0.991623    0.817548    0.703808    0.994851    0.785567    0.983677    0.764032    0.996340    0.903044    0.798049    0.795637    3800        86.096807   0.034486    0.028976    0.312972    118.176270 
[37m[36mINFO[0m[0m 02/10 14:24:43 | 0.795468    0.791045    0.992467    0.809015    0.735504    0.995366    0.781443    0.986541    0.760596    0.995495    0.885006    0.795468    0.791045    4000        90.628218   0.036182    0.028090    0.309232    115.625880 
[37m[36mINFO[0m[0m 02/10 14:27:47 | 0.798910    0.786452    0.991242    0.819786    0.696628    0.994851    0.787629    0.982818    0.773196    0.996059    0.898534    0.798910    0.786452    4200        95.159629   0.033903    0.027377    0.318053    120.040670 
[37m[36mINFO[0m[0m 02/10 14:30:45 | 0.794894    0.779564    0.991039    0.815604    0.716130    0.995366    0.777320    0.982818    0.774341    0.994932    0.895152    0.794894    0.779564    4400        99.691040   0.034833    0.026877    0.317373    114.331622 
[37m[36mINFO[0m[0m 02/10 14:33:46 | 0.806942    0.797933    0.991911    0.820584    0.715119    0.994851    0.785567    0.984822    0.769759    0.996059    0.906426    0.806942    0.797933    4600        104.222451  0.034043    0.025886    0.318740    117.616954 
[37m[36mINFO[0m[0m 02/10 14:36:46 | 0.800918    0.787600    0.991967    0.815544    0.714272    0.995881    0.767010    0.983963    0.773196    0.996059    0.906426    0.800918    0.787600    4800        108.753862  0.031215    0.025004    0.313806    117.017451 
[37m[36mINFO[0m[0m 02/10 14:39:51 | 0.799197    0.789897    0.993051    0.826452    0.711568    0.994851    0.791753    0.987400    0.778923    0.996903    0.908681    0.799197    0.789897    5000        113.285273  0.030937    0.024258    0.314731    121.957239 
[37m[36mINFO[0m[0m 02/10 14:39:51 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[3]/250210_13-23-06_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/10 14:39:52 | ---
[37m[36mINFO[0m[0m 02/10 14:39:52 | test-domain validation(oracle) = 80.034%
[37m[36mINFO[0m[0m 02/10 14:39:52 | training-domain validation(iid) = 79.920%
[37m[36mINFO[0m[0m 02/10 14:39:52 | last = 79.920%
[37m[36mINFO[0m[0m 02/10 14:39:52 | last (inD) = 82.645%
[37m[36mINFO[0m[0m 02/10 14:39:52 | training-domain validation (iid, inD) = 82.645%
[37m[36mINFO[0m[0m 02/10 14:39:52 | === Summary ===
[37m[36mINFO[0m[0m 02/10 14:39:52 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 1
[37m[36mINFO[0m[0m 02/10 14:39:52 | Unique name: 250210_13-23-06_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 14:39:52 | Out path: train_output/OfficeHome/CORAL/[3]/250210_13-23-06_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 14:39:52 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/10 14:39:52 | Dataset: OfficeHome

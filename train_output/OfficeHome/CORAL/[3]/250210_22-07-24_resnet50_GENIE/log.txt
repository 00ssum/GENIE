[37m[36mINFO[0m[0m 02/10 22:07:24 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 8
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 8
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[3]/250210_22-07-24_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250210_22-07-24_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.9932388835350315e-05
	batch_size: 16
	weight_decay: 0.0025315391809104006
	mmd_gamma: 0.16699877508053515
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/10 22:07:24 | n_steps = 5001
[37m[36mINFO[0m[0m 02/10 22:07:24 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/10 22:07:24 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/10 22:07:24 | 
[37m[36mINFO[0m[0m 02/10 22:07:24 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 02/10 22:07:24 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 02/10 22:07:24 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/10 22:07:24 | Batch sizes for each domain: [16, 16, 16, 0] (total=48)
[37m[36mINFO[0m[0m 02/10 22:07:24 | steps-per-epoch for each domain: 121.38, 218.25, 222.00 -> min = 121.38
[37m[36mINFO[0m[0m 02/10 22:07:26 | # of params = 23641217
[37m[36mINFO[0m[0m 02/10 22:09:32 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/10 22:09:32 | 0.023810    0.035591    0.019664    0.016563    4.224300    0.022657    0.014433    0.017755    0.019473    0.018581    0.015784    0.023810    0.035591    0           0.000000    4.333510    0.048556    1.429177    125.347792 
[37m[36mINFO[0m[0m 02/10 22:12:19 | 0.730924    0.712974    0.737031    0.707194    1.132381    0.735839    0.701031    0.684994    0.644903    0.790259    0.775648    0.730924    0.712974    200         1.647786    2.089098    0.406443    0.230578    120.082929 
[37m[36mINFO[0m[0m 02/10 22:15:08 | 0.741538    0.727899    0.804943    0.719885    1.023600    0.813594    0.684536    0.759737    0.673540    0.841498    0.801578    0.741538    0.727899    400         3.295572    0.873071    0.401152    0.192523    131.180877 
[37m[36mINFO[0m[0m 02/10 22:17:55 | 0.755020    0.734788    0.857156    0.736934    0.960831    0.881050    0.694845    0.806128    0.689576    0.884291    0.826381    0.755020    0.734788    600         4.943357    0.603200    0.373450    0.239179    119.219174 
[37m[36mINFO[0m[0m 02/10 22:20:37 | 0.764773    0.764638    0.893421    0.778551    0.817582    0.915551    0.754639    0.854238    0.739977    0.910473    0.841037    0.764773    0.764638    800         6.591143    0.490382    0.340331    0.181675    125.084995 
[37m[36mINFO[0m[0m 02/10 22:23:18 | 0.770224    0.763490    0.910093    0.775394    0.847833    0.937693    0.734021    0.871134    0.731959    0.921453    0.860203    0.770224    0.763490    1000        8.238929    0.394437    0.328814    0.207009    120.092843 
[37m[36mINFO[0m[0m 02/10 22:26:00 | 0.777682    0.753157    0.923499    0.783376    0.841302    0.952111    0.744330    0.881730    0.738832    0.936655    0.866967    0.777682    0.753157    1200        9.886715    0.309235    0.312383    0.194931    122.879885 
[37m[36mINFO[0m[0m 02/10 22:28:43 | 0.753299    0.745121    0.922065    0.774996    0.849869    0.939753    0.736082    0.892039    0.739977    0.934403    0.848929    0.753299    0.745121    1400        11.534501   0.254553    0.292979    0.201824    122.425426 
[37m[36mINFO[0m[0m 02/10 22:31:22 | 0.781698    0.787600    0.955039    0.806079    0.752831    0.975283    0.779381    0.928121    0.761741    0.961712    0.877114    0.781698    0.787600    1600        13.182286   0.205455    0.278768    0.192827    120.017988 
[37m[36mINFO[0m[0m 02/10 22:34:07 | 0.773666    0.757750    0.948353    0.779934    0.862741    0.974253    0.744330    0.918385    0.727377    0.952421    0.868095    0.773666    0.757750    1800        14.830072   0.178066    0.269753    0.202565    124.641400 
[37m[36mINFO[0m[0m 02/10 22:36:50 | 0.796615    0.778416    0.964587    0.796073    0.785714    0.978888    0.738144    0.943872    0.758305    0.971002    0.891770    0.796615    0.778416    2000        16.477858   0.161052    0.250893    0.204930    122.001891 
[37m[36mINFO[0m[0m 02/10 22:39:41 | 0.786288    0.774971    0.967337    0.797484    0.804606    0.981462    0.752577    0.946449    0.754868    0.974099    0.885006    0.786288    0.774971    2200        18.125644   0.139254    0.239933    0.227881    125.240283 
[37m[36mINFO[0m[0m 02/10 22:42:25 | 0.776248    0.763490    0.971846    0.798882    0.777255    0.985582    0.756701    0.953322    0.759450    0.976633    0.880496    0.776248    0.763490    2400        19.773429   0.115420    0.229166    0.207872    122.837373 
[37m[36mINFO[0m[0m 02/10 22:45:10 | 0.785141    0.776119    0.978619    0.803816    0.766051    0.992276    0.767010    0.959908    0.758305    0.983671    0.886133    0.785141    0.776119    2600        21.421215   0.109519    0.216261    0.189866    126.796736 
[37m[36mINFO[0m[0m 02/10 22:47:59 | 0.789443    0.768083    0.980311    0.808631    0.757888    0.992276    0.748454    0.960481    0.777778    0.988176    0.899662    0.789443    0.768083    2800        23.069001   0.087881    0.213887    0.215743    125.948467 
[37m[36mINFO[0m[0m 02/10 22:50:43 | 0.783419    0.781860    0.976022    0.809348    0.785635    0.988157    0.750515    0.959336    0.783505    0.980574    0.894025    0.783419    0.781860    3000        24.716787   0.085449    0.198462    0.176021    129.122839 
[37m[36mINFO[0m[0m 02/10 22:53:28 | 0.781411    0.781860    0.979055    0.813549    0.771432    0.990216    0.760825    0.959336    0.785796    0.987613    0.894025    0.781411    0.781860    3200        26.364573   0.087659    0.191041    0.227422    119.550086 
[37m[36mINFO[0m[0m 02/10 22:56:22 | 0.791165    0.791045    0.984396    0.810659    0.750474    0.992791    0.767010    0.972222    0.773196    0.988176    0.891770    0.791165    0.791045    3400        28.012358   0.084383    0.188618    0.211816    130.945047 
[37m[36mINFO[0m[0m 02/10 22:59:05 | 0.783419    0.776119    0.981741    0.806700    0.802980    0.992791    0.771134    0.967354    0.759450    0.985079    0.889515    0.783419    0.776119    3600        29.660144   0.076463    0.181758    0.203637    122.723082 
[37m[36mINFO[0m[0m 02/10 23:01:56 | 0.775674    0.771527    0.983860    0.798382    0.808783    0.991761    0.738144    0.971363    0.768614    0.988457    0.888388    0.775674    0.771527    3800        31.307930   0.076849    0.176222    0.245337    121.831982 
[37m[36mINFO[0m[0m 02/10 23:04:39 | 0.781985    0.777268    0.981910    0.805597    0.796605    0.990216    0.771134    0.966495    0.764032    0.989020    0.881623    0.781985    0.777268    4000        32.955716   0.074745    0.171555    0.199307    123.017076 
[37m[36mINFO[0m[0m 02/10 23:07:19 | 0.773092    0.757750    0.980853    0.800944    0.798066    0.988671    0.762887    0.970218    0.759450    0.983671    0.880496    0.773092    0.757750    4200        34.603502   0.074976    0.165927    0.188885    122.153072 
[37m[36mINFO[0m[0m 02/10 23:10:00 | 0.793746    0.770379    0.985534    0.807076    0.758614    0.992791    0.760825    0.974227    0.769759    0.989583    0.890643    0.793746    0.770379    4400        36.251287   0.069895    0.169478    0.205132    120.488024 
[37m[36mINFO[0m[0m 02/10 23:12:44 | 0.777108    0.779564    0.985193    0.806025    0.820541    0.994336    0.758763    0.972222    0.772050    0.989020    0.887260    0.777108    0.779564    4600        37.899073   0.078476    0.161394    0.197121    124.554508 
[37m[36mINFO[0m[0m 02/10 23:15:22 | 0.777395    0.791045    0.985181    0.799851    0.792542    0.994336    0.750515    0.970218    0.764032    0.990991    0.885006    0.777395    0.791045    4800        39.546859   0.063557    0.158251    0.201933    117.044935 
[37m[36mINFO[0m[0m 02/10 23:18:05 | 0.788870    0.784156    0.983283    0.800643    0.805504    0.991761    0.748454    0.968786    0.759450    0.989302    0.894025    0.788870    0.784156    5000        41.194645   0.061128    0.155020    0.198039    124.116640 
[37m[36mINFO[0m[0m 02/10 23:18:06 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[3]/250210_22-07-24_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/10 23:18:07 | ---
[37m[36mINFO[0m[0m 02/10 23:18:07 | test-domain validation(oracle) = 79.116%
[37m[36mINFO[0m[0m 02/10 23:18:07 | training-domain validation(iid) = 78.141%
[37m[36mINFO[0m[0m 02/10 23:18:07 | last = 78.887%
[37m[36mINFO[0m[0m 02/10 23:18:07 | last (inD) = 80.064%
[37m[36mINFO[0m[0m 02/10 23:18:07 | training-domain validation (iid, inD) = 81.355%
[37m[36mINFO[0m[0m 02/10 23:18:07 | === Summary ===
[37m[36mINFO[0m[0m 02/10 23:18:07 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 8
[37m[36mINFO[0m[0m 02/10 23:18:07 | Unique name: 250210_22-07-24_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 23:18:07 | Out path: train_output/OfficeHome/CORAL/[3]/250210_22-07-24_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 23:18:07 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/10 23:18:07 | Dataset: OfficeHome

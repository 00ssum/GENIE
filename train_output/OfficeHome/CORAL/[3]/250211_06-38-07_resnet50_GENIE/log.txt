[37m[36mINFO[0m[0m 02/11 06:38:07 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 3 --dataset OfficeHome --trial_seed 1 --hparams_seed 19
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 19
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[3]/250211_06-38-07_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250211_06-38-07_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 3.7692486045276154e-05
	batch_size: 10
	weight_decay: 0.0003178970604685295
	mmd_gamma: 1.483929697730203
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/11 06:38:07 | n_steps = 5001
[37m[36mINFO[0m[0m 02/11 06:38:07 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/11 06:38:07 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/11 06:38:07 | 
[37m[36mINFO[0m[0m 02/11 06:38:07 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 02/11 06:38:07 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 02/11 06:38:07 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/11 06:38:07 | Batch sizes for each domain: [10, 10, 10, 0] (total=30)
[37m[36mINFO[0m[0m 02/11 06:38:07 | steps-per-epoch for each domain: 194.20, 349.20, 355.20 -> min = 194.20
[37m[36mINFO[0m[0m 02/11 06:38:09 | # of params = 23641217
[37m[36mINFO[0m[0m 02/11 06:40:14 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/11 06:40:14 | 0.025244    0.036739    0.021813    0.024218    4.188360    0.035015    0.035052    0.017755    0.025200    0.012669    0.012401    0.025244    0.036739    0           0.000000    4.238238    0.210435    0.989922    123.789902 
[37m[36mINFO[0m[0m 02/11 06:42:53 | 0.289730    0.280138    0.286720    0.283892    3.188859    0.290422    0.292784    0.261741    0.266896    0.307995    0.291995    0.289730    0.280138    200         1.029866    3.905174    0.032317    0.204039    118.236463 
[37m[36mINFO[0m[0m 02/11 06:45:43 | 0.608721    0.606200    0.591962    0.575156    1.717936    0.563337    0.577320    0.549542    0.529210    0.663007    0.618940    0.608721    0.606200    400         2.059732    2.400415    0.162004    0.233807    123.544062 
[37m[36mINFO[0m[0m 02/11 06:48:21 | 0.681870    0.678530    0.701422    0.687164    1.354532    0.692585    0.692784    0.654926    0.646048    0.756757    0.722661    0.681870    0.678530    600         3.089598    1.511036    0.175571    0.168508    123.775046 
[37m[36mINFO[0m[0m 02/11 06:50:59 | 0.712565    0.690011    0.743566    0.701053    1.184792    0.730175    0.705155    0.697595    0.644903    0.802928    0.753100    0.712565    0.690011    800         4.119464    1.190852    0.153214    0.171433    124.325904 
[37m[36mINFO[0m[0m 02/11 06:53:34 | 0.714859    0.712974    0.780030    0.725809    1.072705    0.786303    0.734021    0.734250    0.664376    0.819538    0.779030    0.714859    0.712974    1000        5.149331    1.015419    0.137664    0.186458    117.967558 
[37m[36mINFO[0m[0m 02/11 06:56:23 | 0.750717    0.750861    0.814826    0.747762    1.002967    0.834706    0.744330    0.765178    0.683849    0.844595    0.815107    0.750717    0.750861    1200        6.179197    0.843493    0.131176    0.241220    120.103777 
[37m[36mINFO[0m[0m 02/11 06:59:07 | 0.738956    0.747417    0.836825    0.753419    0.948961    0.838826    0.746392    0.794960    0.699885    0.876689    0.813980    0.738956    0.747417    1400        7.209063    0.744067    0.122241    0.164621    130.854126 
[37m[36mINFO[0m[0m 02/11 07:01:41 | 0.754733    0.746269    0.865472    0.764444    0.892980    0.879506    0.746392    0.824456    0.723940    0.892455    0.822999    0.754733    0.746269    1600        8.238929    0.649791    0.111737    0.177923    118.840616 
[37m[36mINFO[0m[0m 02/11 07:04:23 | 0.736374    0.737084    0.869973    0.761534    0.894332    0.894954    0.709278    0.825888    0.736541    0.889077    0.838782    0.736374    0.737084    1800        9.268795    0.579471    0.108023    0.209740    119.702207 
[37m[36mINFO[0m[0m 02/11 07:07:08 | 0.758462    0.750861    0.885248    0.777376    0.869581    0.897013    0.744330    0.850229    0.741123    0.908502    0.846674    0.758462    0.750861    2000        10.298661   0.547530    0.105236    0.204295    124.298083 
[37m[36mINFO[0m[0m 02/11 07:09:50 | 0.746127    0.750861    0.892724    0.777247    0.874553    0.915551    0.748454    0.847079    0.741123    0.915541    0.842165    0.746127    0.750861    2200        11.328527   0.474394    0.098814    0.197273    123.122010 
[37m[36mINFO[0m[0m 02/11 07:12:39 | 0.748996    0.745121    0.904642    0.786192    0.808363    0.925850    0.742268    0.870848    0.761741    0.917230    0.854566    0.748996    0.745121    2400        12.358393   0.430704    0.095253    0.183065    131.750218 
[37m[36mINFO[0m[0m 02/11 07:15:16 | 0.749283    0.746269    0.916323    0.778161    0.826281    0.933574    0.721649    0.888030    0.756014    0.927365    0.856821    0.749283    0.746269    2600        13.388260   0.395457    0.090435    0.159769    125.093638 
[37m[36mINFO[0m[0m 02/11 07:18:00 | 0.744980    0.730195    0.918289    0.779425    0.841882    0.939753    0.740206    0.888030    0.749141    0.927083    0.848929    0.744980    0.730195    2800        14.418126   0.343055    0.087692    0.237084    116.352418 
[37m[36mINFO[0m[0m 02/11 07:20:41 | 0.768503    0.757750    0.940143    0.791429    0.765516    0.953656    0.752577    0.912944    0.746850    0.953829    0.874859    0.768503    0.757750    3000        15.447992   0.298141    0.083494    0.206547    120.282306 
[37m[36mINFO[0m[0m 02/11 07:23:13 | 0.755594    0.735936    0.936898    0.793503    0.776084    0.952111    0.758763    0.911512    0.749141    0.947072    0.872604    0.755594    0.735936    3200        16.477858   0.280537    0.081687    0.163749    118.682357 
[37m[36mINFO[0m[0m 02/11 07:25:52 | 0.774240    0.750861    0.949851    0.807170    0.748895    0.971164    0.758763    0.917239    0.775487    0.961149    0.887260    0.774240    0.750861    3400        17.507724   0.240119    0.078195    0.181357    123.441990 
[37m[36mINFO[0m[0m 02/11 07:28:31 | 0.747562    0.741676    0.945728    0.795812    0.798721    0.959835    0.748454    0.922394    0.769759    0.954955    0.869222    0.747562    0.741676    3600        18.537590   0.223104    0.075806    0.180462    122.660170 
[37m[36mINFO[0m[0m 02/11 07:31:08 | 0.751865    0.737084    0.952203    0.790912    0.807922    0.972709    0.746392    0.926976    0.754868    0.956926    0.871477    0.751865    0.737084    3800        19.567456   0.232477    0.073796    0.194173    118.530349 
[37m[36mINFO[0m[0m 02/11 07:33:56 | 0.749570    0.749713    0.956437    0.793075    0.795993    0.976828    0.740206    0.934994    0.772050    0.957489    0.866967    0.749570    0.749713    4000        20.597322   0.205796    0.071839    0.233702    120.802582 
[37m[36mINFO[0m[0m 02/11 07:36:42 | 0.759323    0.743972    0.959030    0.798374    0.794052    0.975283    0.752577    0.936999    0.781214    0.964809    0.861330    0.759323    0.743972    4200        21.627188   0.206721    0.071242    0.175267    130.774608 
[37m[36mINFO[0m[0m 02/11 07:39:19 | 0.769076    0.764638    0.964138    0.801238    0.777584    0.980947    0.754639    0.942153    0.766323    0.969313    0.882751    0.769076    0.764638    4400        22.657055   0.190051    0.068007    0.179711    121.000057 
[37m[36mINFO[0m[0m 02/11 07:42:00 | 0.759323    0.746269    0.962210    0.801113    0.766307    0.976313    0.746392    0.940722    0.765178    0.969595    0.891770    0.759323    0.746269    4600        23.686921   0.185792    0.067564    0.184194    124.227860 
[37m[36mINFO[0m[0m 02/11 07:44:40 | 0.777108    0.755454    0.972456    0.812775    0.707187    0.981977    0.773196    0.958477    0.783505    0.976914    0.881623    0.777108    0.755454    4800        24.716787   0.159548    0.064386    0.192467    121.530642 
[37m[36mINFO[0m[0m 02/11 07:47:21 | 0.769937    0.758898    0.971671    0.814447    0.714881    0.985067    0.777320    0.952749    0.768614    0.977196    0.897407    0.769937    0.758898    5000        25.746653   0.145846    0.061422    0.194740    121.623522 
[37m[36mINFO[0m[0m 02/11 07:47:21 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[3]/250211_06-38-07_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/11 07:47:22 | ---
[37m[36mINFO[0m[0m 02/11 07:47:22 | test-domain validation(oracle) = 76.908%
[37m[36mINFO[0m[0m 02/11 07:47:22 | training-domain validation(iid) = 76.994%
[37m[36mINFO[0m[0m 02/11 07:47:22 | last = 76.994%
[37m[36mINFO[0m[0m 02/11 07:47:22 | last (inD) = 81.445%
[37m[36mINFO[0m[0m 02/11 07:47:22 | training-domain validation (iid, inD) = 81.445%
[37m[36mINFO[0m[0m 02/11 07:47:22 | === Summary ===
[37m[36mINFO[0m[0m 02/11 07:47:22 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 3 --dataset OfficeHome --trial_seed 1 --hparams_seed 19
[37m[36mINFO[0m[0m 02/11 07:47:22 | Unique name: 250211_06-38-07_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 07:47:22 | Out path: train_output/OfficeHome/CORAL/[3]/250211_06-38-07_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 07:47:22 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/11 07:47:22 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 02/11 00:27:21 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 3 --dataset OfficeHome --trial_seed 1 --hparams_seed 7
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 7
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[3]/250211_00-27-21_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250211_00-27-21_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.00025471109765784857
	batch_size: 39
	weight_decay: 9.10622179414602e-05
	mmd_gamma: 8.495822994867268
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/11 00:27:21 | n_steps = 5001
[37m[36mINFO[0m[0m 02/11 00:27:21 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/11 00:27:21 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/11 00:27:21 | 
[37m[36mINFO[0m[0m 02/11 00:27:21 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 02/11 00:27:21 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 02/11 00:27:21 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/11 00:27:21 | Batch sizes for each domain: [39, 39, 39, 0] (total=117)
[37m[36mINFO[0m[0m 02/11 00:27:21 | steps-per-epoch for each domain: 49.79, 89.54, 91.08 -> min = 49.79
[37m[36mINFO[0m[0m 02/11 00:27:22 | # of params = 23641217
[37m[36mINFO[0m[0m 02/11 00:29:27 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/11 00:29:27 | 0.022662    0.027555    0.016783    0.019025    4.178046    0.023687    0.020619    0.011741    0.024055    0.014921    0.012401    0.022662    0.027555    0           0.000000    4.383640    0.068793    1.252949    123.580650 
[37m[36mINFO[0m[0m 02/11 00:32:29 | 0.311819    0.287026    0.330108    0.318099    3.030154    0.312049    0.323711    0.320447    0.309278    0.357827    0.321308    0.311819    0.287026    200         4.016478    3.828113    0.008397    0.294758    123.334274 
[37m[36mINFO[0m[0m 02/11 00:35:31 | 0.654045    0.636051    0.661476    0.627049    1.591757    0.642636    0.632990    0.617411    0.579611    0.724381    0.668546    0.654045    0.636051    400         8.032956    2.150448    0.035395    0.307552    120.010120 
[37m[36mINFO[0m[0m 02/11 00:38:37 | 0.719736    0.701493    0.770876    0.720881    1.205064    0.773429    0.723711    0.720504    0.666667    0.818694    0.772266    0.719736    0.701493    600         12.049434   1.290823    0.035402    0.322487    122.069041 
[37m[36mINFO[0m[0m 02/11 00:41:36 | 0.739530    0.749713    0.833383    0.763469    1.017023    0.835221    0.752577    0.796964    0.718213    0.867962    0.819617    0.739530    0.749713    800         16.065911   0.918090    0.031334    0.294594    119.182454 
[37m[36mINFO[0m[0m 02/11 00:44:36 | 0.759897    0.762342    0.870543    0.777165    0.900580    0.885685    0.771134    0.825888    0.717068    0.900056    0.843292    0.759897    0.762342    1000        20.082389   0.699331    0.028172    0.281831    123.847386 
[37m[36mINFO[0m[0m 02/11 00:47:34 | 0.763626    0.770379    0.897544    0.789381    0.824574    0.910917    0.769072    0.860825    0.741123    0.920890    0.857948    0.763626    0.770379    1200        24.098867   0.565043    0.025776    0.286253    120.924733 
[37m[36mINFO[0m[0m 02/11 00:50:42 | 0.764773    0.748565    0.918312    0.794532    0.801764    0.940783    0.762887    0.881157    0.754868    0.932995    0.865840    0.764773    0.748565    1400        28.115345   0.449309    0.023660    0.319615    123.647902 
[37m[36mINFO[0m[0m 02/11 00:53:41 | 0.762192    0.758898    0.937024    0.787164    0.809333    0.955716    0.754639    0.903780    0.734250    0.951577    0.872604    0.762192    0.758898    1600        32.131823   0.360773    0.021956    0.290560    121.639678 
[37m[36mINFO[0m[0m 02/11 00:56:47 | 0.772806    0.760046    0.953297    0.804164    0.756543    0.970649    0.769072    0.926403    0.765178    0.962838    0.878241    0.772806    0.760046    1800        36.148301   0.305394    0.020580    0.305148    124.527691 
[37m[36mINFO[0m[0m 02/11 00:59:44 | 0.769650    0.741676    0.961597    0.800018    0.762757    0.977858    0.779381    0.940435    0.752577    0.966498    0.868095    0.769650    0.741676    2000        40.164779   0.261256    0.019227    0.297823    118.001742 
[37m[36mINFO[0m[0m 02/11 01:02:50 | 0.765921    0.758898    0.967861    0.808428    0.745051    0.983007    0.777320    0.948167    0.767468    0.972410    0.880496    0.765921    0.758898    2200        44.181256   0.221134    0.017976    0.319711    121.832387 
[37m[36mINFO[0m[0m 02/11 01:05:57 | 0.772519    0.760046    0.973984    0.809055    0.760082    0.989701    0.769072    0.955899    0.766323    0.976351    0.891770    0.772519    0.760046    2400        48.197734   0.186624    0.017101    0.301584    126.518761 
[37m[36mINFO[0m[0m 02/11 01:08:56 | 0.774240    0.768083    0.973828    0.800862    0.735998    0.985582    0.754639    0.955326    0.766323    0.980574    0.881623    0.774240    0.768083    2600        52.214212   0.165177    0.016050    0.282076    122.094097 
[37m[36mINFO[0m[0m 02/11 01:12:01 | 0.775674    0.764638    0.977683    0.808239    0.747358    0.992276    0.771134    0.960481    0.766323    0.980293    0.887260    0.775674    0.764638    2800        56.230690   0.148686    0.015484    0.348090    115.419877 
[37m[36mINFO[0m[0m 02/11 01:15:08 | 0.762192    0.754305    0.978565    0.802829    0.747238    0.991246    0.762887    0.961340    0.760596    0.983108    0.885006    0.762192    0.754305    3000        60.247168   0.140387    0.014640    0.313049    124.877170 
[37m[36mINFO[0m[0m 02/11 01:18:12 | 0.769650    0.771527    0.981880    0.812262    0.738013    0.991761    0.775258    0.969645    0.769759    0.984234    0.891770    0.769650    0.771527    3200        64.263646   0.120502    0.014074    0.287070    126.353080 
[37m[36mINFO[0m[0m 02/11 01:21:06 | 0.770224    0.763490    0.982174    0.813112    0.737589    0.991246    0.771134    0.969072    0.764032    0.986205    0.904171    0.770224    0.763490    3400        68.280124   0.111509    0.013439    0.299459    114.241498 
[37m[36mINFO[0m[0m 02/11 01:24:10 | 0.772806    0.766935    0.985909    0.813066    0.741256    0.992791    0.773196    0.974227    0.767468    0.990709    0.898534    0.772806    0.766935    3600        72.296601   0.103257    0.012939    0.316345    120.201152 
[37m[36mINFO[0m[0m 02/11 01:27:15 | 0.759897    0.758898    0.985569    0.798923    0.790573    0.991761    0.754639    0.974800    0.754868    0.990146    0.887260    0.759897    0.758898    3800        76.313079   0.097003    0.012408    0.279238    129.411162 
[37m[36mINFO[0m[0m 02/11 01:30:12 | 0.769363    0.769231    0.986883    0.805836    0.752654    0.992276    0.752577    0.977663    0.770905    0.990709    0.894025    0.769363    0.769231    4000        80.329557   0.092811    0.012006    0.296081    117.698323 
[37m[36mINFO[0m[0m 02/11 01:33:17 | 0.774527    0.764638    0.989066    0.813149    0.737943    0.994851    0.771134    0.979668    0.770905    0.992680    0.897407    0.774527    0.764638    4200        84.346035   0.086279    0.011740    0.314321    122.571093 
[37m[36mINFO[0m[0m 02/11 01:36:19 | 0.770224    0.765786    0.989270    0.810482    0.751480    0.994336    0.760825    0.979668    0.774341    0.993806    0.896280    0.770224    0.765786    4400        88.362513   0.084245    0.011345    0.293346    122.932633 
[37m[36mINFO[0m[0m 02/11 01:39:21 | 0.766495    0.765786    0.989717    0.816274    0.747231    0.995366    0.779381    0.981386    0.770905    0.992399    0.898534    0.766495    0.765786    4600        92.378991   0.076529    0.010924    0.290794    124.305808 
[37m[36mINFO[0m[0m 02/11 01:42:22 | 0.761618    0.765786    0.988882    0.820150    0.739416    0.994851    0.777320    0.980241    0.781214    0.991554    0.901917    0.761618    0.765786    4800        96.395469   0.075150    0.010554    0.297001    121.651542 
[37m[36mINFO[0m[0m 02/11 01:45:23 | 0.758749    0.777268    0.990674    0.813605    0.752472    0.994851    0.767010    0.981959    0.761741    0.995214    0.912063    0.758749    0.777268    5000        100.411946  0.067102    0.010414    0.299869    120.600663 
[37m[36mINFO[0m[0m 02/11 01:45:23 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[3]/250211_00-27-21_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/11 01:45:24 | ---
[37m[36mINFO[0m[0m 02/11 01:45:24 | test-domain validation(oracle) = 75.875%
[37m[36mINFO[0m[0m 02/11 01:45:24 | training-domain validation(iid) = 76.162%
[37m[36mINFO[0m[0m 02/11 01:45:24 | last = 75.875%
[37m[36mINFO[0m[0m 02/11 01:45:24 | last (inD) = 81.360%
[37m[36mINFO[0m[0m 02/11 01:45:24 | training-domain validation (iid, inD) = 82.015%
[37m[36mINFO[0m[0m 02/11 01:45:24 | === Summary ===
[37m[36mINFO[0m[0m 02/11 01:45:24 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 3 --dataset OfficeHome --trial_seed 1 --hparams_seed 7
[37m[36mINFO[0m[0m 02/11 01:45:24 | Unique name: 250211_00-27-21_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 01:45:24 | Out path: train_output/OfficeHome/CORAL/[3]/250211_00-27-21_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 01:45:24 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/11 01:45:24 | Dataset: OfficeHome

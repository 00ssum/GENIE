[37m[36mINFO[0m[0m 02/11 03:01:33 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 3 --dataset OfficeHome --trial_seed 1 --hparams_seed 16
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 16
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[3]/250211_03-01-33_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250211_03-01-33_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.3198033474735314e-05
	batch_size: 10
	weight_decay: 0.001844990356992375
	mmd_gamma: 1.2838669915289476
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/11 03:01:34 | n_steps = 5001
[37m[36mINFO[0m[0m 02/11 03:01:34 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/11 03:01:34 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/11 03:01:34 | 
[37m[36mINFO[0m[0m 02/11 03:01:34 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 02/11 03:01:34 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 02/11 03:01:34 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/11 03:01:34 | Batch sizes for each domain: [10, 10, 10, 0] (total=30)
[37m[36mINFO[0m[0m 02/11 03:01:34 | steps-per-epoch for each domain: 194.20, 349.20, 355.20 -> min = 194.20
[37m[36mINFO[0m[0m 02/11 03:01:35 | # of params = 23641217
[37m[36mINFO[0m[0m 02/11 03:03:41 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/11 03:03:41 | 0.022949    0.033295    0.022229    0.022767    4.203592    0.033986    0.032990    0.019187    0.022910    0.013514    0.012401    0.022949    0.033295    0           0.000000    4.297332    0.063754    1.381011    124.505006 
[37m[36mINFO[0m[0m 02/11 03:06:18 | 0.641710    0.623421    0.612222    0.594682    1.559198    0.611226    0.626804    0.562715    0.533792    0.662725    0.623450    0.641710    0.623421    200         1.029866    2.795970    0.121255    0.171812    123.102650 
[37m[36mINFO[0m[0m 02/11 03:08:59 | 0.690476    0.708381    0.710655    0.675949    1.235909    0.698764    0.674227    0.662085    0.618557    0.771115    0.735062    0.690476    0.708381    400         2.059732    1.251069    0.155730    0.195253    121.178348 
[37m[36mINFO[0m[0m 02/11 03:11:34 | 0.724900    0.725603    0.779040    0.726317    1.051926    0.784243    0.686598    0.730241    0.694158    0.822635    0.798196    0.724900    0.725603    600         3.089598    0.938321    0.133080    0.173858    120.217098 
[37m[36mINFO[0m[0m 02/11 03:14:16 | 0.731211    0.733639    0.802108    0.732296    1.016042    0.807415    0.709278    0.755441    0.679267    0.843468    0.808343    0.731211    0.733639    800         4.119464    0.793594    0.119818    0.208166    121.175415 
[37m[36mINFO[0m[0m 02/11 03:16:53 | 0.756741    0.749713    0.853210    0.769944    0.877533    0.856334    0.738144    0.818442    0.720504    0.884854    0.851184    0.756741    0.749713    1000        5.149331    0.639848    0.111743    0.159319    124.993120 
[37m[36mINFO[0m[0m 02/11 03:19:36 | 0.766208    0.750861    0.866449    0.767004    0.855074    0.889289    0.758763    0.818729    0.712486    0.891329    0.829763    0.766208    0.750861    1200        6.179197    0.535094    0.105501    0.210392    120.648769 
[37m[36mINFO[0m[0m 02/11 03:22:15 | 0.766495    0.770379    0.891227    0.781921    0.781324    0.909372    0.734021    0.847079    0.758305    0.917230    0.853439    0.766495    0.770379    1400        7.209063    0.482254    0.098892    0.179466    123.215991 
[37m[36mINFO[0m[0m 02/11 03:24:57 | 0.778543    0.766935    0.913731    0.791360    0.770427    0.938208    0.767010    0.869989    0.747995    0.932995    0.859076    0.778543    0.766935    1600        8.238929    0.421630    0.093139    0.217605    118.065564 
[37m[36mINFO[0m[0m 02/11 03:27:36 | 0.745841    0.739380    0.910617    0.788346    0.803628    0.930484    0.754639    0.874284    0.744559    0.927083    0.865840    0.745841    0.739380    1800        9.268795    0.351106    0.088330    0.168862    125.501288 
[37m[36mINFO[0m[0m 02/11 03:30:16 | 0.778256    0.774971    0.930062    0.802295    0.763611    0.949022    0.756701    0.896907    0.765178    0.944257    0.885006    0.778256    0.774971    2000        10.298661   0.319868    0.088449    0.209047    118.042276 
[37m[36mINFO[0m[0m 02/11 03:32:56 | 0.753873    0.747417    0.922720    0.783288    0.815050    0.945932    0.736082    0.892612    0.744559    0.929617    0.869222    0.753873    0.747417    2200        11.328527   0.292687    0.081008    0.184131    123.254478 
[37m[36mINFO[0m[0m 02/11 03:35:41 | 0.774527    0.770379    0.944826    0.803175    0.718442    0.960350    0.752577    0.914948    0.765178    0.959178    0.891770    0.774527    0.770379    2400        12.358393   0.253840    0.078923    0.233630    117.970706 
[37m[36mINFO[0m[0m 02/11 03:38:26 | 0.777969    0.755454    0.949787    0.805972    0.711583    0.971679    0.760825    0.925544    0.774341    0.952140    0.882751    0.777969    0.755454    2600        13.388260   0.243170    0.077341    0.185575    128.083405 
[37m[36mINFO[0m[0m 02/11 03:41:07 | 0.767929    0.760046    0.955164    0.797239    0.765747    0.976828    0.760825    0.925544    0.757159    0.963119    0.873732    0.767929    0.760046    2800        14.418126   0.196518    0.072939    0.211871    118.385593 
[37m[36mINFO[0m[0m 02/11 03:43:52 | 0.782272    0.772675    0.963705    0.813679    0.711296    0.982492    0.779381    0.940435    0.777778    0.968187    0.883878    0.782272    0.772675    3000        15.447992   0.179916    0.068243    0.210249    123.242738 
[37m[36mINFO[0m[0m 02/11 03:46:28 | 0.777969    0.772675    0.969734    0.804421    0.695130    0.986097    0.750515    0.947881    0.775487    0.975225    0.887260    0.777969    0.772675    3200        16.477858   0.165018    0.067360    0.188577    118.480009 
[37m[36mINFO[0m[0m 02/11 03:49:18 | 0.775100    0.757750    0.969569    0.808404    0.712014    0.985582    0.746392    0.949026    0.793814    0.974099    0.885006    0.775100    0.757750    3400        17.507724   0.144705    0.063923    0.230153    124.257480 
[37m[36mINFO[0m[0m 02/11 03:51:54 | 0.772232    0.755454    0.969101    0.807011    0.712991    0.985067    0.762887    0.946449    0.769759    0.975788    0.888388    0.772232    0.755454    3600        18.537590   0.130795    0.062193    0.183142    118.847917 
[37m[36mINFO[0m[0m 02/11 03:54:44 | 0.779977    0.771527    0.972709    0.800478    0.734745    0.987642    0.742268    0.951317    0.762887    0.979167    0.896280    0.779977    0.771527    3800        19.567456   0.133632    0.060761    0.230041    123.622945 
[37m[36mINFO[0m[0m 02/11 03:57:18 | 0.778830    0.774971    0.974886    0.817865    0.684323    0.988157    0.767010    0.957617    0.785796    0.978885    0.900789    0.778830    0.774971    4000        20.597322   0.119782    0.058712    0.186543    116.982243 
[37m[36mINFO[0m[0m 02/11 04:00:10 | 0.776822    0.780712    0.972686    0.807313    0.706982    0.988157    0.767010    0.950172    0.780069    0.979730    0.874859    0.776822    0.780712    4200        21.627188   0.117890    0.057755    0.230215    126.279697 
[37m[36mINFO[0m[0m 02/11 04:02:50 | 0.780551    0.766935    0.981078    0.818546    0.667032    0.992791    0.779381    0.966208    0.774341    0.984234    0.901917    0.780551    0.766935    4400        22.657055   0.114023    0.056480    0.185288    122.819936 
[37m[36mINFO[0m[0m 02/11 04:05:39 | 0.763913    0.743972    0.970011    0.792757    0.750075    0.978888    0.738144    0.957045    0.770905    0.974099    0.869222    0.763913    0.743972    4600        23.686921   0.107433    0.054451    0.227026    123.360575 
[37m[36mINFO[0m[0m 02/11 04:08:14 | 0.777969    0.773823    0.980552    0.818470    0.678407    0.991761    0.771134    0.967068    0.782360    0.982827    0.901917    0.777969    0.773823    4800        24.716787   0.106493    0.054541    0.175041    120.459968 
[37m[36mINFO[0m[0m 02/11 04:11:01 | 0.788296    0.772675    0.981970    0.809531    0.684142    0.994336    0.767010    0.966495    0.773196    0.985079    0.888388    0.788296    0.772675    5000        25.746653   0.105671    0.053019    0.228235    121.300163 
[37m[36mINFO[0m[0m 02/11 04:11:01 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[3]/250211_03-01-33_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/11 04:11:03 | ---
[37m[36mINFO[0m[0m 02/11 04:11:03 | test-domain validation(oracle) = 77.682%
[37m[36mINFO[0m[0m 02/11 04:11:03 | training-domain validation(iid) = 78.055%
[37m[36mINFO[0m[0m 02/11 04:11:03 | last = 78.830%
[37m[36mINFO[0m[0m 02/11 04:11:03 | last (inD) = 80.953%
[37m[36mINFO[0m[0m 02/11 04:11:03 | training-domain validation (iid, inD) = 81.855%
[37m[36mINFO[0m[0m 02/11 04:11:03 | === Summary ===
[37m[36mINFO[0m[0m 02/11 04:11:03 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 3 --dataset OfficeHome --trial_seed 1 --hparams_seed 16
[37m[36mINFO[0m[0m 02/11 04:11:03 | Unique name: 250211_03-01-33_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 04:11:03 | Out path: train_output/OfficeHome/CORAL/[3]/250211_03-01-33_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 04:11:03 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/11 04:11:03 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 01/28 12:12:44 | Command :: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 1 2 3 --dataset OfficeHome --trial_seed 2 --hparams_seed 12
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 12
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/OfficeHome/CORAL/[1, 2, 3]/250128_12-12-44_resnet50_EVE
	out_root: train_output/OfficeHome/CORAL/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 2
	unique_name: 250128_12-12-44_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: GENIE
	freeze_bn: False
	pretrained: True
	lr: 5.346798771850428e-05
	batch_size: 44
	weight_decay: 1.8352299015720086e-05
	mmd_gamma: 3.310992720685983
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 01/28 12:12:44 | n_steps = 5001
[37m[36mINFO[0m[0m 01/28 12:12:44 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/28 12:12:44 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/28 12:12:44 | 
[37m[36mINFO[0m[0m 01/28 12:12:44 | Testenv name escaping te_C_P_R -> te_C_P_R
[37m[36mINFO[0m[0m 01/28 12:12:44 | Test envs = [1, 2, 3], name = te_C_P_R
[37m[36mINFO[0m[0m 01/28 12:12:44 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 01/28 12:12:44 | Batch sizes for each domain: [44, 0, 0, 0] (total=44)
[37m[36mINFO[0m[0m 01/28 12:12:44 | steps-per-epoch for each domain: 44.14 -> min = 44.14
[37m[36mINFO[0m[0m 01/28 12:12:46 | # of params = 23641217
[37m[36mINFO[0m[0m 01/28 12:14:41 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 01/28 12:14:41 | 0.023850    0.020179    0.030896    0.041237    4.185824    0.030896    0.041237    0.023482    0.018328    0.021678    0.014656    0.026391    0.027555    0           0.000000    4.255290    0.000000    1.126104    114.723397 
[37m[36mINFO[0m[0m 01/28 12:17:57 | 0.513613    0.513876    0.856849    0.663918    1.305890    0.856849    0.663918    0.404639    0.408935    0.533502    0.526494    0.602697    0.606200    200         4.531411    1.511022    0.000000    0.385444    118.299744 
[37m[36mINFO[0m[0m 01/28 12:21:15 | 0.542034    0.539378    0.940783    0.682474    1.304037    0.940783    0.682474    0.426403    0.428408    0.558277    0.546787    0.641423    0.642939    400         9.062822    0.308720    0.000000    0.358990    125.880426 
[37m[36mINFO[0m[0m 01/28 12:24:17 | 0.556389    0.552628    0.974253    0.705155    1.225146    0.974253    0.705155    0.424112    0.427262    0.586993    0.570462    0.658061    0.660161    600         13.594233   0.146755    0.000000    0.357220    110.273249 
[37m[36mINFO[0m[0m 01/28 12:27:32 | 0.547498    0.542056    0.971679    0.709278    1.300109    0.971679    0.709278    0.420962    0.420389    0.571791    0.547914    0.649742    0.657865    800         18.125644   0.081483    0.000000    0.342193    126.044567 
[37m[36mINFO[0m[0m 01/28 12:30:58 | 0.560600    0.556925    0.990216    0.719588    1.239285    0.990216    0.719588    0.445876    0.449026    0.569257    0.553551    0.666667    0.668197    1000        22.657055   0.056303    0.000000    0.362783    133.707298 
[37m[36mINFO[0m[0m 01/28 12:34:23 | 0.570718    0.570954    0.990731    0.736082    1.327728    0.990731    0.736082    0.459908    0.476518    0.585867    0.571590    0.666380    0.664753    1200        27.188465   0.037392    0.000000    0.356945    133.453307 
[37m[36mINFO[0m[0m 01/28 12:37:46 | 0.581074    0.569785    0.993821    0.746392    1.392403    0.993821    0.746392    0.471363    0.467354    0.595439    0.576099    0.676420    0.665901    1400        31.719876   0.026930    0.000000    0.355518    131.104167 
[37m[36mINFO[0m[0m 01/28 12:41:09 | 0.571859    0.571722    0.993306    0.740206    1.384457    0.993306    0.740206    0.454181    0.454754    0.587556    0.573844    0.673838    0.686567    1600        36.251287   0.019880    0.000000    0.346188    133.335860 
[37m[36mINFO[0m[0m 01/28 12:44:27 | 0.560604    0.568283    0.992791    0.725773    1.457150    0.992791    0.725773    0.434994    0.447881    0.584741    0.573844    0.662077    0.683123    1800        40.782698   0.026966    0.000000    0.354942    127.025106 
[37m[36mINFO[0m[0m 01/28 12:47:32 | 0.577874    0.573999    0.994336    0.750515    1.360876    0.994336    0.750515    0.465636    0.479954    0.603041    0.573844    0.664945    0.668197    2000        45.314109   0.024769    0.000000    0.355596    113.532012 
[37m[36mINFO[0m[0m 01/28 12:50:47 | 0.557128    0.556869    0.981462    0.707216    1.512979    0.981462    0.707216    0.422967    0.441008    0.576014    0.563698    0.672404    0.665901    2200        49.845520   0.024981    0.000000    0.378233    118.933789 
[37m[36mINFO[0m[0m 01/28 12:54:02 | 0.570857    0.567503    0.994336    0.750515    1.389898    0.994336    0.750515    0.436999    0.449026    0.596284    0.576099    0.679289    0.677382    2400        54.376931   0.023521    0.000000    0.394121    116.622035 
[37m[36mINFO[0m[0m 01/28 12:57:19 | 0.581513    0.576287    0.995366    0.758763    1.383488    0.995366    0.758763    0.459908    0.471936    0.602759    0.576099    0.681870    0.680827    2600        58.908342   0.018209    0.000000    0.389514    118.198175 
[37m[36mINFO[0m[0m 01/28 13:00:30 | 0.586331    0.579254    0.995366    0.764948    1.347222    0.995366    0.764948    0.455899    0.451317    0.612331    0.594138    0.690763    0.692308    2800        63.439753   0.010422    0.000000    0.344407    122.033138 
[37m[36mINFO[0m[0m 01/28 13:03:43 | 0.588787    0.587253    0.995881    0.775258    1.295611    0.995881    0.775258    0.459622    0.465063    0.616836    0.598647    0.689902    0.698048    3000        67.971164   0.009619    0.000000    0.352858    122.438139 
[37m[36mINFO[0m[0m 01/28 13:06:59 | 0.572882    0.579359    0.994851    0.748454    1.549574    0.994851    0.748454    0.451604    0.467354    0.592342    0.574972    0.674699    0.695752    3200        72.502575   0.014161    0.000000    0.351388    124.571661 
[37m[36mINFO[0m[0m 01/28 13:10:13 | 0.584880    0.576543    0.994851    0.727835    1.467738    0.994851    0.727835    0.448167    0.439863    0.615709    0.600902    0.690763    0.688863    3400        77.033986   0.013157    0.000000    0.337032    126.534151 
[37m[36mINFO[0m[0m 01/28 13:13:29 | 0.573891    0.571669    0.994336    0.742268    1.451756    0.994336    0.742268    0.438431    0.434135    0.600225    0.585118    0.683018    0.695752    3600        81.565396   0.012507    0.000000    0.327817    131.017196 
[37m[36mINFO[0m[0m 01/28 13:16:41 | 0.576548    0.580731    0.995881    0.762887    1.463572    0.995881    0.762887    0.443299    0.459336    0.603041    0.602029    0.683305    0.680827    3800        86.096807   0.010361    0.000000    0.325996    126.346626 
[37m[36mINFO[0m[0m 01/28 13:19:53 | 0.577729    0.582706    0.995881    0.750515    1.448820    0.995881    0.750515    0.447595    0.468499    0.597410    0.590755    0.688181    0.688863    4000        90.628218   0.007795    0.000000    0.339817    123.835212 
[37m[36mINFO[0m[0m 01/28 13:23:05 | 0.571632    0.578958    0.996395    0.746392    1.553040    0.996395    0.746392    0.439003    0.465063    0.594595    0.578354    0.681297    0.693456    4200        95.159629   0.008798    0.000000    0.376821    117.514357 
[37m[36mINFO[0m[0m 01/28 13:26:21 | 0.582576    0.575133    0.995881    0.754639    1.554020    0.995881    0.754639    0.454467    0.461627    0.601351    0.578354    0.691910    0.685419    4400        99.691040   0.008137    0.000000    0.388385    118.153137 
[37m[36mINFO[0m[0m 01/28 13:29:34 | 0.562254    0.554913    0.994336    0.717526    1.879598    0.994336    0.717526    0.417239    0.415808    0.597691    0.573844    0.671830    0.675086    4600        104.222451  0.010666    0.000000    0.383988    116.123854 
[37m[36mINFO[0m[0m 01/28 13:32:49 | 0.569762    0.567832    0.994851    0.748454    1.580560    0.994851    0.748454    0.441581    0.446735    0.587556    0.585118    0.680149    0.671642    4800        108.753862  0.013402    0.000000    0.387554    117.631518 
[37m[36mINFO[0m[0m 01/28 13:36:08 | 0.577442    0.567213    0.994336    0.758763    1.576269    0.994336    0.758763    0.461913    0.471936    0.596002    0.558061    0.674412    0.671642    5000        113.285273  0.014282    0.000000    0.391287    119.925499 
[37m[36mINFO[0m[0m 01/28 13:36:08 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[1, 2, 3]/250128_12-12-44_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/28 13:36:09 | ---
[37m[36mINFO[0m[0m 01/28 13:36:09 | test-domain validation(oracle) = 58.879%
[37m[36mINFO[0m[0m 01/28 13:36:09 | training-domain validation(iid) = 58.879%
[37m[36mINFO[0m[0m 01/28 13:36:09 | last = 57.744%
[37m[36mINFO[0m[0m 01/28 13:36:09 | last (inD) = 75.876%
[37m[36mINFO[0m[0m 01/28 13:36:09 | training-domain validation (iid, inD) = 77.526%
[37m[36mINFO[0m[0m 01/28 13:36:09 | === Summary ===
[37m[36mINFO[0m[0m 01/28 13:36:09 | Command: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 1 2 3 --dataset OfficeHome --trial_seed 2 --hparams_seed 12
[37m[36mINFO[0m[0m 01/28 13:36:09 | Unique name: 250128_12-12-44_resnet50_EVE
[37m[36mINFO[0m[0m 01/28 13:36:09 | Out path: train_output/OfficeHome/CORAL/[1, 2, 3]/250128_12-12-44_resnet50_EVE
[37m[36mINFO[0m[0m 01/28 13:36:09 | Algorithm: CORAL
[37m[36mINFO[0m[0m 01/28 13:36:09 | Dataset: OfficeHome

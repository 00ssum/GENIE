[37m[36mINFO[0m[0m 02/10 18:59:26 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 --dataset OfficeHome --trial_seed 1 --hparams_seed 18
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 18
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[0]/250210_18-59-26_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 1
	unique_name: 250210_18-59-26_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.0002805925701721472
	batch_size: 39
	weight_decay: 1.5909976529017505e-06
	mmd_gamma: 0.7378941383723668
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/10 18:59:26 | n_steps = 5001
[37m[36mINFO[0m[0m 02/10 18:59:26 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/10 18:59:26 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/10 18:59:26 | 
[37m[36mINFO[0m[0m 02/10 18:59:26 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 02/10 18:59:26 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 02/10 18:59:26 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 02/10 18:59:26 | Batch sizes for each domain: [0, 39, 39, 39] (total=117)
[37m[36mINFO[0m[0m 02/10 18:59:26 | steps-per-epoch for each domain: 89.54, 91.08, 89.38 -> min = 89.38
[37m[36mINFO[0m[0m 02/10 18:59:28 | # of params = 23641217
[37m[36mINFO[0m[0m 02/10 19:01:42 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/10 19:01:42 | 0.024717    0.022680    0.021966    0.023625    4.210367    0.024717    0.022680    0.020905    0.026346    0.017455    0.013529    0.027539    0.030999    0           0.000000    4.262915    0.026790    1.664886    132.253473 
[37m[36mINFO[0m[0m 02/10 19:06:17 | 0.623584    0.639175    0.817925    0.783857    0.799783    0.623584    0.639175    0.750573    0.698740    0.858108    0.836528    0.845095    0.816303    200         2.237522    1.554027    0.162159    0.697451    135.679451 
[37m[36mINFO[0m[0m 02/10 19:10:53 | 0.639547    0.647423    0.886617    0.814590    0.679928    0.639547    0.647423    0.839633    0.738832    0.920045    0.874859    0.900172    0.830080    400         4.475043    0.557871    0.135313    0.670734    141.540281 
[37m[36mINFO[0m[0m 02/10 19:15:25 | 0.658599    0.696907    0.922197    0.833253    0.598720    0.658599    0.696907    0.893757    0.775487    0.943975    0.885006    0.928858    0.839265    600         6.712565    0.381364    0.118869    0.690210    134.151320 
[37m[36mINFO[0m[0m 02/10 19:19:56 | 0.655510    0.668041    0.939691    0.831643    0.592593    0.655510    0.668041    0.913517    0.760596    0.958052    0.899662    0.947504    0.834673    800         8.950086    0.277116    0.107946    0.709672    129.336374 
[37m[36mINFO[0m[0m 02/10 19:24:25 | 0.664779    0.694845    0.955012    0.837360    0.583951    0.664779    0.694845    0.933562    0.773196    0.967905    0.901917    0.963569    0.836969    1000        11.187608   0.207430    0.098893    0.714771    125.499774 
[37m[36mINFO[0m[0m 02/10 19:28:58 | 0.662719    0.688660    0.969936    0.853740    0.555424    0.662719    0.688660    0.955326    0.801833    0.980011    0.910936    0.974469    0.848450    1200        13.425129   0.163278    0.091406    0.732569    126.660010 
[37m[36mINFO[0m[0m 02/10 19:33:36 | 0.650360    0.684536    0.974122    0.845383    0.577572    0.650360    0.684536    0.960481    0.791523    0.982827    0.901917    0.979059    0.842710    1400        15.662651   0.128547    0.083611    0.754213    127.793427 
[37m[36mINFO[0m[0m 02/10 19:38:11 | 0.668383    0.701031    0.981914    0.845747    0.558628    0.668383    0.701031    0.971649    0.789233    0.989583    0.905299    0.984509    0.842710    1600        17.900172   0.105270    0.076685    0.747287    125.073126 
[37m[36mINFO[0m[0m 02/10 19:42:46 | 0.666838    0.690722    0.982857    0.846870    0.551540    0.666838    0.690722    0.967640    0.794960    0.992117    0.908681    0.988812    0.836969    1800        20.137694   0.088388    0.071214    0.739920    127.493901 
[37m[36mINFO[0m[0m 02/10 19:47:20 | 0.675592    0.717526    0.983622    0.851871    0.559776    0.675592    0.717526    0.973081    0.788087    0.991554    0.905299    0.986231    0.862227    2000        22.375215   0.079473    0.066795    0.713822    131.128403 
[37m[36mINFO[0m[0m 02/10 19:52:06 | 0.641092    0.674227    0.988109    0.851090    0.561746    0.641092    0.674227    0.979954    0.790378    0.992117    0.907554    0.992255    0.855339    2200        24.612737   0.069421    0.061313    0.765092    132.603100 
[37m[36mINFO[0m[0m 02/10 19:56:43 | 0.655510    0.690722    0.987528    0.846911    0.555067    0.655510    0.690722    0.976231    0.785796    0.993525    0.903044    0.992828    0.851894    2400        26.850258   0.061190    0.058623    0.705427    136.338068 
[37m[36mINFO[0m[0m 02/10 20:01:28 | 0.661689    0.686598    0.988202    0.850312    0.557054    0.661689    0.686598    0.977950    0.789233    0.992680    0.909808    0.993976    0.851894    2600        29.087780   0.060142    0.055065    0.729041    138.812462 
[37m[36mINFO[0m[0m 02/10 20:06:06 | 0.661174    0.701031    0.990296    0.851461    0.565208    0.661174    0.701031    0.982818    0.797251    0.993806    0.908681    0.994263    0.848450    2800        31.325301   0.052864    0.052610    0.728649    132.076924 
[37m[36mINFO[0m[0m 02/10 20:10:39 | 0.653450    0.686598    0.989625    0.851410    0.569597    0.653450    0.686598    0.981672    0.791523    0.994088    0.917700    0.993115    0.845006    3000        33.562823   0.050047    0.049424    0.728892    127.814763 
[37m[36mINFO[0m[0m 02/10 20:15:12 | 0.652420    0.688660    0.988869    0.853732    0.560772    0.652420    0.688660    0.979095    0.802978    0.992962    0.912063    0.994550    0.846154    3200        35.800344   0.048903    0.047860    0.707783    130.650235 
[37m[36mINFO[0m[0m 02/10 20:19:45 | 0.651905    0.688660    0.989816    0.857186    0.560728    0.651905    0.688660    0.979095    0.807560    0.994369    0.909808    0.995984    0.854191    3400        38.037866   0.044104    0.045940    0.697095    133.938176 
[37m[36mINFO[0m[0m 02/10 20:24:17 | 0.654480    0.684536    0.991432    0.851449    0.575733    0.654480    0.684536    0.983677    0.794960    0.995495    0.910936    0.995123    0.848450    3600        40.275387   0.040137    0.043498    0.699977    132.062381 
[37m[36mINFO[0m[0m 02/10 20:28:43 | 0.650875    0.672165    0.991060    0.855641    0.565939    0.650875    0.672165    0.983677    0.808706    0.993806    0.912063    0.995697    0.846154    3800        42.512909   0.040015    0.042381    0.695140    126.891970 
[37m[36mINFO[0m[0m 02/10 20:33:12 | 0.653965    0.674227    0.993434    0.856043    0.564967    0.653965    0.674227    0.988259    0.801833    0.996059    0.909808    0.995984    0.856487    4000        44.750430   0.038557    0.041285    0.687505    131.610259 
[37m[36mINFO[0m[0m 02/10 20:37:46 | 0.656025    0.682474    0.991143    0.848778    0.573065    0.656025    0.682474    0.981386    0.792669    0.996059    0.909808    0.995984    0.843858    4200        46.987952   0.037330    0.039202    0.700724    133.514318 
[37m[36mINFO[0m[0m 02/10 20:42:18 | 0.653450    0.674227    0.992196    0.854864    0.562222    0.653450    0.674227    0.984536    0.797251    0.995495    0.915445    0.996558    0.851894    4400        49.225473   0.035291    0.038298    0.700765    132.073797 
[37m[36mINFO[0m[0m 02/10 20:46:53 | 0.662204    0.686598    0.991429    0.853721    0.571296    0.662204    0.686598    0.981959    0.798396    0.996059    0.914318    0.996271    0.848450    4600        51.462995   0.035769    0.036705    0.752833    124.139577 
[37m[36mINFO[0m[0m 02/10 20:51:20 | 0.663234    0.694845    0.992094    0.851481    0.582611    0.663234    0.694845    0.983391    0.797251    0.996622    0.905299    0.996271    0.851894    4800        53.700516   0.031738    0.036465    0.732426    121.259400 
[37m[36mINFO[0m[0m 02/10 20:55:52 | 0.653450    0.649485    0.991712    0.847291    0.576266    0.653450    0.649485    0.982818    0.798396    0.996622    0.901917    0.995697    0.841561    5000        55.938038   0.035772    0.035259    0.695288    132.253211 
[37m[36mINFO[0m[0m 02/10 20:55:52 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[0]/250210_18-59-26_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/10 20:55:53 | ---
[37m[36mINFO[0m[0m 02/10 20:55:53 | test-domain validation(oracle) = 67.559%
[37m[36mINFO[0m[0m 02/10 20:55:53 | training-domain validation(iid) = 65.191%
[37m[36mINFO[0m[0m 02/10 20:55:53 | last = 65.345%
[37m[36mINFO[0m[0m 02/10 20:55:53 | last (inD) = 84.729%
[37m[36mINFO[0m[0m 02/10 20:55:53 | training-domain validation (iid, inD) = 85.719%
[37m[36mINFO[0m[0m 02/10 20:55:53 | === Summary ===
[37m[36mINFO[0m[0m 02/10 20:55:53 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 --dataset OfficeHome --trial_seed 1 --hparams_seed 18
[37m[36mINFO[0m[0m 02/10 20:55:53 | Unique name: 250210_18-59-26_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 20:55:53 | Out path: train_output/OfficeHome/CORAL/[0]/250210_18-59-26_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 20:55:53 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/10 20:55:53 | Dataset: OfficeHome

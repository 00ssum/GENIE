[37m[36mINFO[0m[0m 02/10 17:08:37 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 --dataset OfficeHome --trial_seed 1 --hparams_seed 9
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 9
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[0]/250210_17-08-37_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 1
	unique_name: 250210_17-08-37_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.7532223448653515e-05
	batch_size: 36
	weight_decay: 0.007511403320794324
	mmd_gamma: 7.620358209128009
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/10 17:08:37 | n_steps = 5001
[37m[36mINFO[0m[0m 02/10 17:08:37 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/10 17:08:37 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/10 17:08:37 | 
[37m[36mINFO[0m[0m 02/10 17:08:37 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 02/10 17:08:37 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 02/10 17:08:37 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 02/10 17:08:37 | Batch sizes for each domain: [0, 36, 36, 36] (total=108)
[37m[36mINFO[0m[0m 02/10 17:08:37 | steps-per-epoch for each domain: 97.00, 98.67, 96.83 -> min = 96.83
[37m[36mINFO[0m[0m 02/10 17:08:38 | # of params = 23641217
[37m[36mINFO[0m[0m 02/10 17:10:49 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/10 17:10:49 | 0.025232    0.024742    0.022996    0.028569    4.179423    0.025232    0.024742    0.018900    0.029782    0.021115    0.018038    0.028973    0.037887    0           0.000000    4.363775    0.060585    1.489325    129.065983 
[37m[36mINFO[0m[0m 02/10 17:15:04 | 0.311535    0.344330    0.456056    0.450202    2.561803    0.311535    0.344330    0.386598    0.388316    0.503660    0.490417    0.477912    0.471871    200         2.065404    3.681277    0.012607    0.654400    124.335814 
[37m[36mINFO[0m[0m 02/10 17:19:26 | 0.496395    0.538144    0.706071    0.664830    1.442822    0.496395    0.538144    0.635739    0.581901    0.759009    0.727170    0.723465    0.685419    400         4.130809    1.842607    0.041517    0.662863    129.899355 
[37m[36mINFO[0m[0m 02/10 17:23:48 | 0.562822    0.595876    0.787619    0.735904    1.076003    0.562822    0.595876    0.729668    0.664376    0.828829    0.797069    0.804360    0.746269    600         6.196213    1.171421    0.037633    0.661950    129.381041 
[37m[36mINFO[0m[0m 02/10 17:28:06 | 0.578785    0.616495    0.835891    0.776253    0.919307    0.578785    0.616495    0.784364    0.714777    0.871903    0.826381    0.851406    0.787600    800         8.261618    0.898311    0.033354    0.640300    129.634477 
[37m[36mINFO[0m[0m 02/10 17:32:28 | 0.597837    0.643299    0.856524    0.796748    0.842566    0.597837    0.643299    0.811856    0.729668    0.887950    0.852311    0.869765    0.808266    1000        10.327022   0.711337    0.030289    0.662288    129.491897 
[37m[36mINFO[0m[0m 02/10 17:36:47 | 0.603502    0.649485    0.880943    0.802118    0.802686    0.603502    0.649485    0.846220    0.741123    0.909347    0.848929    0.887263    0.816303    1200        12.392427   0.606001    0.027861    0.663222    126.962261 
[37m[36mINFO[0m[0m 02/10 17:41:14 | 0.614315    0.626804    0.891020    0.795204    0.791050    0.614315    0.626804    0.852806    0.720504    0.918074    0.855693    0.902180    0.809414    1400        14.457831   0.535172    0.025954    0.697203    126.882253 
[37m[36mINFO[0m[0m 02/10 17:45:37 | 0.589083    0.639175    0.908995    0.805465    0.713506    0.589083    0.639175    0.880298    0.751432    0.931025    0.863585    0.915663    0.801378    1600        16.523236   0.483549    0.024658    0.681452    126.550115 
[37m[36mINFO[0m[0m 02/10 17:50:00 | 0.587024    0.618557    0.911961    0.803594    0.732797    0.587024    0.618557    0.883448    0.741123    0.930462    0.857948    0.921974    0.811711    1800        18.588640   0.437207    0.023142    0.677145    128.181266 
[37m[36mINFO[0m[0m 02/10 17:54:16 | 0.594748    0.637113    0.928768    0.818430    0.704798    0.594748    0.637113    0.906644    0.749141    0.947072    0.871477    0.932587    0.834673    2000        20.654045   0.388532    0.022306    0.610761    133.520148 
[37m[36mINFO[0m[0m 02/10 17:58:35 | 0.588054    0.612371    0.933350    0.819520    0.707021    0.588054    0.612371    0.906930    0.761741    0.948198    0.879369    0.944923    0.817451    2200        22.719449   0.367156    0.021581    0.639994    131.377592 
[37m[36mINFO[0m[0m 02/10 18:03:00 | 0.589598    0.622680    0.937337    0.811526    0.708198    0.589598    0.622680    0.917239    0.751432    0.951858    0.873732    0.942915    0.809414    2400        24.784854   0.337316    0.020821    0.679887    128.905508 
[37m[36mINFO[0m[0m 02/10 18:07:25 | 0.557158    0.589691    0.931126    0.794058    0.770813    0.557158    0.589691    0.909507    0.753723    0.951858    0.851184    0.932014    0.777268    2600        26.850258   0.337403    0.020098    0.696117    125.398801 
[37m[36mINFO[0m[0m 02/10 18:11:45 | 0.541195    0.583505    0.944465    0.816107    0.702807    0.541195    0.583505    0.925544    0.766323    0.958052    0.873732    0.949799    0.808266    2800        28.915663   0.313458    0.019696    0.641461    132.272407 
[37m[36mINFO[0m[0m 02/10 18:16:06 | 0.561277    0.560825    0.947047    0.813036    0.723505    0.561277    0.560825    0.931558    0.760596    0.957489    0.875986    0.952094    0.802526    3000        30.981067   0.307663    0.019067    0.653454    130.098916 
[37m[36mINFO[0m[0m 02/10 18:20:20 | 0.556128    0.591753    0.953707    0.821395    0.686139    0.556128    0.591753    0.939576    0.776632    0.961993    0.883878    0.959552    0.803674    3200        33.046472   0.312026    0.018826    0.642141    125.628404 
[37m[36mINFO[0m[0m 02/10 18:24:42 | 0.549434    0.579381    0.942351    0.797838    0.749350    0.549434    0.579381    0.922680    0.743414    0.960023    0.860203    0.944349    0.789897    3400        35.111876   0.293255    0.018424    0.655779    130.354664 
[37m[36mINFO[0m[0m 02/10 18:28:54 | 0.551493    0.573196    0.944757    0.804688    0.735063    0.551493    0.573196    0.919244    0.766323    0.957770    0.863585    0.957258    0.784156    3600        37.177281   0.285079    0.017989    0.633121    126.002255 
[37m[36mINFO[0m[0m 02/10 18:33:18 | 0.546859    0.585567    0.949209    0.800886    0.743404    0.546859    0.585567    0.932131    0.760596    0.963401    0.860203    0.952094    0.781860    3800        39.242685   0.294481    0.017714    0.637857    136.231634 
[37m[36mINFO[0m[0m 02/10 18:37:44 | 0.548919    0.585567    0.948002    0.795907    0.786519    0.548919    0.585567    0.929840    0.729668    0.957770    0.864713    0.956397    0.793341    4000        41.308090   0.285488    0.017433    0.651809    135.377277 
[37m[36mINFO[0m[0m 02/10 18:42:03 | 0.505664    0.540206    0.940630    0.786802    0.803166    0.505664    0.540206    0.922394    0.742268    0.960023    0.850056    0.939472    0.768083    4200        43.373494   0.280555    0.017299    0.632290    132.153001 
[37m[36mINFO[0m[0m 02/10 18:46:24 | 0.538620    0.552577    0.943879    0.785228    0.800177    0.538620    0.552577    0.924971    0.745704    0.960023    0.856821    0.946644    0.753157    4400        45.438898   0.320490    0.016971    0.637053    134.076950 
[37m[36mINFO[0m[0m 02/10 18:50:40 | 0.551493    0.560825    0.954089    0.792518    0.778446    0.551493    0.560825    0.940435    0.747995    0.961993    0.853439    0.959839    0.776119    4600        47.504303   0.284984    0.016735    0.606796    134.280035 
[37m[36mINFO[0m[0m 02/10 18:54:59 | 0.509784    0.531959    0.949595    0.795923    0.788710    0.509784    0.531959    0.937285    0.753723    0.962275    0.859076    0.949225    0.774971    4800        49.569707   0.295937    0.016578    0.647111    129.605063 
[37m[36mINFO[0m[0m 02/10 18:59:20 | 0.521627    0.540206    0.951294    0.794436    0.799587    0.521627    0.540206    0.936140    0.768614    0.965935    0.850056    0.951807    0.764638    5000        51.635112   0.297754    0.016493    0.663259    128.383965 
[37m[36mINFO[0m[0m 02/10 18:59:20 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[0]/250210_17-08-37_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/10 18:59:21 | ---
[37m[36mINFO[0m[0m 02/10 18:59:21 | test-domain validation(oracle) = 60.350%
[37m[36mINFO[0m[0m 02/10 18:59:21 | training-domain validation(iid) = 55.613%
[37m[36mINFO[0m[0m 02/10 18:59:21 | last = 52.163%
[37m[36mINFO[0m[0m 02/10 18:59:21 | last (inD) = 79.444%
[37m[36mINFO[0m[0m 02/10 18:59:21 | training-domain validation (iid, inD) = 82.139%
[37m[36mINFO[0m[0m 02/10 18:59:21 | === Summary ===
[37m[36mINFO[0m[0m 02/10 18:59:21 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 --dataset OfficeHome --trial_seed 1 --hparams_seed 9
[37m[36mINFO[0m[0m 02/10 18:59:21 | Unique name: 250210_17-08-37_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 18:59:21 | Out path: train_output/OfficeHome/CORAL/[0]/250210_17-08-37_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 18:59:21 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/10 18:59:21 | Dataset: OfficeHome

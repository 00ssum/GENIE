[37m[36mINFO[0m[0m 02/11 00:31:46 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 2 --dataset OfficeHome --trial_seed 1 --hparams_seed 9
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 9
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[2]/250211_00-31-46_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 1
	unique_name: 250211_00-31-46_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.7532223448653515e-05
	batch_size: 36
	weight_decay: 0.007511403320794324
	mmd_gamma: 7.620358209128009
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/11 00:31:46 | n_steps = 5001
[37m[36mINFO[0m[0m 02/11 00:31:46 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/11 00:31:46 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/11 00:31:46 | 
[37m[36mINFO[0m[0m 02/11 00:31:46 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 02/11 00:31:46 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 02/11 00:31:46 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 02/11 00:31:46 | Batch sizes for each domain: [36, 36, 0, 36] (total=108)
[37m[36mINFO[0m[0m 02/11 00:31:46 | steps-per-epoch for each domain: 53.94, 97.00, 96.83 -> min = 53.94
[37m[36mINFO[0m[0m 02/11 00:31:47 | # of params = 23641217
[37m[36mINFO[0m[0m 02/11 00:33:54 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/11 00:33:54 | 0.017455    0.016911    0.018981    0.021629    4.174541    0.023687    0.024742    0.010882    0.017182    0.017455    0.016911    0.022375    0.022962    0           0.000000    4.367585    0.069787    1.230752    125.739344 
[37m[36mINFO[0m[0m 02/11 00:38:09 | 0.290541    0.273957    0.340740    0.337093    2.886095    0.360968    0.389691    0.312142    0.297824    0.290541    0.273957    0.349111    0.323766    200         3.707518    3.804906    0.009614    0.641817    126.266064 
[37m[36mINFO[0m[0m 02/11 00:42:21 | 0.607545    0.590755    0.666154    0.632649    1.647860    0.669928    0.653608    0.621993    0.591065    0.607545    0.590755    0.706540    0.653272    400         7.415036    2.124287    0.038399    0.654650    121.312028 
[37m[36mINFO[0m[0m 02/11 00:46:41 | 0.682995    0.656144    0.765744    0.714125    1.178730    0.780124    0.734021    0.726231    0.662085    0.682995    0.656144    0.790878    0.746269    600         11.122554   1.299257    0.038418    0.658810    128.455066 
[37m[36mINFO[0m[0m 02/11 00:50:54 | 0.699887    0.685457    0.809302    0.738961    1.048027    0.815654    0.744330    0.781214    0.703322    0.699887    0.685457    0.831038    0.769231    800         14.830072   0.966138    0.033960    0.648111    123.004770 
[37m[36mINFO[0m[0m 02/11 00:55:09 | 0.719876    0.694476    0.853687    0.762029    0.939591    0.874871    0.771134    0.823310    0.737686    0.719876    0.694476    0.862880    0.777268    1000        18.537590   0.772521    0.030790    0.655110    124.291655 
[37m[36mINFO[0m[0m 02/11 00:59:22 | 0.719032    0.705750    0.873142    0.760972    0.915883    0.898558    0.758763    0.841638    0.731959    0.719032    0.705750    0.879231    0.792193    1200        22.245108   0.623530    0.028721    0.635757    125.181960 
[37m[36mINFO[0m[0m 02/11 01:03:34 | 0.723818    0.710259    0.892821    0.776099    0.868142    0.926365    0.773196    0.863688    0.753723    0.723818    0.710259    0.888411    0.801378    1400        25.952626   0.542823    0.026578    0.670664    118.224900 
[37m[36mINFO[0m[0m 02/11 01:07:47 | 0.733108    0.718151    0.911051    0.779001    0.846602    0.932029    0.777320    0.880298    0.758305    0.733108    0.718151    0.920826    0.801378    1600        29.660144   0.474888    0.025008    0.658671    120.764513 
[37m[36mINFO[0m[0m 02/11 01:11:54 | 0.723818    0.704622    0.920842    0.777015    0.851769    0.945932    0.758763    0.892612    0.770905    0.723818    0.704622    0.923982    0.801378    1800        33.367662   0.425314    0.023632    0.653397    116.986048 
[37m[36mINFO[0m[0m 02/11 01:16:14 | 0.728604    0.698985    0.929248    0.779909    0.833753    0.948507    0.783505    0.903207    0.765178    0.728604    0.698985    0.936030    0.791045    2000        37.075180   0.382403    0.022791    0.674690    124.569705 
[37m[36mINFO[0m[0m 02/11 01:20:26 | 0.717905    0.713641    0.934011    0.767762    0.869093    0.963955    0.760825    0.910653    0.758305    0.717905    0.713641    0.927424    0.784156    2200        40.782698   0.346245    0.021806    0.656523    120.809207 
[37m[36mINFO[0m[0m 02/11 01:24:39 | 0.703266    0.688839    0.938198    0.760735    0.875977    0.961895    0.754639    0.914376    0.744559    0.703266    0.688839    0.938325    0.783008    2400        44.490216   0.319148    0.021122    0.654325    122.308321 
[37m[36mINFO[0m[0m 02/11 01:28:53 | 0.706363    0.692221    0.941215    0.777310    0.846307    0.962925    0.760825    0.921249    0.783505    0.706363    0.692221    0.939472    0.787600    2600        48.197734   0.318207    0.020387    0.645531    124.768479 
[37m[36mINFO[0m[0m 02/11 01:33:13 | 0.706644    0.698985    0.950094    0.766462    0.854324    0.970649    0.744330    0.933276    0.773196    0.706644    0.698985    0.946357    0.781860    2800        51.905252   0.294678    0.019737    0.671223    125.781122 
[37m[36mINFO[0m[0m 02/11 01:37:25 | 0.716216    0.717024    0.952580    0.767843    0.840762    0.970649    0.748454    0.933276    0.765178    0.716216    0.717024    0.953815    0.789897    3000        55.612770   0.276525    0.019455    0.649018    122.289978 
[37m[36mINFO[0m[0m 02/11 01:41:34 | 0.716216    0.689966    0.952923    0.769753    0.849589    0.971679    0.748454    0.932990    0.769759    0.716216    0.689966    0.954102    0.791045    3200        59.320288   0.297317    0.019018    0.645977    119.372375 
[37m[36mINFO[0m[0m 02/11 01:45:49 | 0.690315    0.674183    0.946829    0.754621    0.927076    0.971164    0.734021    0.923540    0.753723    0.690315    0.674183    0.945783    0.776119    3400        63.027806   0.273640    0.018517    0.678872    119.632879 
[37m[36mINFO[0m[0m 02/11 01:50:04 | 0.693975    0.665163    0.953287    0.748650    0.909475    0.969619    0.729897    0.936140    0.758305    0.693975    0.665163    0.954102    0.757750    3600        66.735324   0.276783    0.018435    0.671062    121.142673 
[37m[36mINFO[0m[0m 02/11 01:54:19 | 0.700169    0.675310    0.948017    0.747750    0.935289    0.967559    0.713402    0.924112    0.751432    0.700169    0.675310    0.952381    0.778416    3800        70.442842   0.252519    0.017869    0.662141    122.024290 
[37m[36mINFO[0m[0m 02/11 01:58:28 | 0.693412    0.664036    0.952616    0.742693    0.940785    0.974768    0.715464    0.931271    0.756014    0.693412    0.664036    0.951807    0.756602    4000        74.150360   0.260117    0.017648    0.659765    116.888576 
[37m[36mINFO[0m[0m 02/11 02:02:45 | 0.682995    0.659526    0.957831    0.763170    0.907011    0.973223    0.760825    0.943585    0.757159    0.682995    0.659526    0.956684    0.771527    4200        77.857878   0.257770    0.017276    0.678361    121.576540 
[37m[36mINFO[0m[0m 02/11 02:06:58 | 0.693694    0.678692    0.957336    0.741548    0.927819    0.976313    0.705155    0.933849    0.762887    0.693694    0.678692    0.961847    0.756602    4400        81.565396   0.244879    0.017187    0.658049    121.239078 
[37m[36mINFO[0m[0m 02/11 02:11:05 | 0.688345    0.678692    0.960733    0.759583    0.914046    0.982492    0.734021    0.937572    0.770905    0.688345    0.678692    0.962134    0.773823    4600        85.272915   0.263629    0.016962    0.616396    123.694113 
[37m[36mINFO[0m[0m 02/11 02:15:21 | 0.688908    0.675310    0.957125    0.737649    0.966697    0.974253    0.707216    0.938144    0.754868    0.688908    0.675310    0.958979    0.750861    4800        88.980433   0.256134    0.016871    0.656881    125.149683 
[37m[36mINFO[0m[0m 02/11 02:19:29 | 0.680743    0.669673    0.958615    0.739869    0.939961    0.975283    0.698969    0.940435    0.761741    0.680743    0.669673    0.960126    0.758898    5000        92.687951   0.254640    0.016725    0.618207    123.672037 
[37m[36mINFO[0m[0m 02/11 02:19:29 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[2]/250211_00-31-46_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/11 02:19:30 | ---
[37m[36mINFO[0m[0m 02/11 02:19:30 | test-domain validation(oracle) = 73.311%
[37m[36mINFO[0m[0m 02/11 02:19:30 | training-domain validation(iid) = 72.860%
[37m[36mINFO[0m[0m 02/11 02:19:30 | last = 68.074%
[37m[36mINFO[0m[0m 02/11 02:19:30 | last (inD) = 73.987%
[37m[36mINFO[0m[0m 02/11 02:19:30 | training-domain validation (iid, inD) = 77.991%
[37m[36mINFO[0m[0m 02/11 02:19:30 | === Summary ===
[37m[36mINFO[0m[0m 02/11 02:19:30 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 2 --dataset OfficeHome --trial_seed 1 --hparams_seed 9
[37m[36mINFO[0m[0m 02/11 02:19:30 | Unique name: 250211_00-31-46_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 02:19:30 | Out path: train_output/OfficeHome/CORAL/[2]/250211_00-31-46_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 02:19:30 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/11 02:19:30 | Dataset: OfficeHome

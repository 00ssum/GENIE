[37m[36mINFO[0m[0m 02/11 04:06:26 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 2 --dataset OfficeHome --trial_seed 1 --hparams_seed 18
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 18
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[2]/250211_04-06-26_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 1
	unique_name: 250211_04-06-26_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.0002805925701721472
	batch_size: 39
	weight_decay: 1.5909976529017505e-06
	mmd_gamma: 0.7378941383723668
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/11 04:06:26 | n_steps = 5001
[37m[36mINFO[0m[0m 02/11 04:06:26 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/11 04:06:26 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/11 04:06:26 | 
[37m[36mINFO[0m[0m 02/11 04:06:26 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 02/11 04:06:26 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 02/11 04:06:26 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 02/11 04:06:26 | Batch sizes for each domain: [39, 39, 0, 39] (total=117)
[37m[36mINFO[0m[0m 02/11 04:06:26 | steps-per-epoch for each domain: 49.79, 89.54, 89.38 -> min = 49.79
[37m[36mINFO[0m[0m 02/11 04:06:27 | # of params = 23641217
[37m[36mINFO[0m[0m 02/11 04:08:32 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/11 04:08:32 | 0.009854    0.013529    0.018617    0.017730    4.191931    0.025747    0.016495    0.009737    0.019473    0.009854    0.013529    0.020367    0.017222    0           0.000000    4.311277    0.030218    1.524334    123.728169 
[37m[36mINFO[0m[0m 02/11 04:12:52 | 0.734234    0.712514    0.799887    0.756175    0.910628    0.819773    0.775258    0.751145    0.682703    0.734234    0.712514    0.828744    0.810563    200         4.016478    1.665245    0.161305    0.714520    117.233397 
[37m[36mINFO[0m[0m 02/11 04:17:11 | 0.758164    0.724915    0.873337    0.775968    0.789340    0.898558    0.767010    0.835338    0.730813    0.758164    0.724915    0.886116    0.830080    400         8.032956    0.605990    0.139821    0.704772    118.070250 
[37m[36mINFO[0m[0m 02/11 04:21:32 | 0.771115    0.738444    0.918967    0.797583    0.738677    0.952626    0.802062    0.882875    0.756014    0.771115    0.738444    0.921400    0.834673    600         12.049434   0.395894    0.125501    0.672649    126.090513 
[37m[36mINFO[0m[0m 02/11 04:25:54 | 0.762106    0.749718    0.942702    0.801863    0.722069    0.969104    0.810309    0.919244    0.756014    0.762106    0.749718    0.939759    0.839265    800         16.065911   0.274833    0.111996    0.702930    121.686467 
[37m[36mINFO[0m[0m 02/11 04:30:19 | 0.769144    0.750846    0.962357    0.815529    0.684498    0.985067    0.832990    0.935281    0.777778    0.769144    0.750846    0.966724    0.835821    1000        20.082389   0.202880    0.101638    0.714831    122.129047 
[37m[36mINFO[0m[0m 02/11 04:34:40 | 0.779842    0.762120    0.970858    0.810192    0.691436    0.982492    0.812371    0.955040    0.772050    0.779842    0.762120    0.975043    0.846154    1200        24.098867   0.155085    0.093498    0.712294    117.624834 
[37m[36mINFO[0m[0m 02/11 04:39:01 | 0.775619    0.759865    0.976432    0.811407    0.674579    0.989186    0.810309    0.962199    0.785796    0.775619    0.759865    0.977912    0.838117    1400        28.115345   0.116425    0.084163    0.686825    124.130133 
[37m[36mINFO[0m[0m 02/11 04:43:26 | 0.781813    0.759865    0.982201    0.810962    0.710192    0.993306    0.802062    0.967640    0.776632    0.781813    0.759865    0.985657    0.854191    1600        32.131823   0.104615    0.077339    0.685838    128.165198 
[37m[36mINFO[0m[0m 02/11 04:47:45 | 0.786599    0.767756    0.983881    0.817604    0.673120    0.994336    0.818557    0.971363    0.782360    0.786599    0.767756    0.985944    0.851894    1800        36.148301   0.086590    0.071203    0.683414    121.569972 
[37m[36mINFO[0m[0m 02/11 04:52:07 | 0.778716    0.772266    0.986784    0.812018    0.695929    0.995881    0.824742    0.975086    0.774341    0.778716    0.772266    0.989386    0.836969    2000        40.164779   0.076285    0.066765    0.698514    122.862524 
[37m[36mINFO[0m[0m 02/11 04:56:26 | 0.774212    0.764374    0.986289    0.806287    0.709773    0.993821    0.804124    0.974227    0.782360    0.774212    0.764374    0.990820    0.832377    2200        44.181256   0.067543    0.062156    0.698912    119.026253 
[37m[36mINFO[0m[0m 02/11 05:00:49 | 0.785755    0.765502    0.990203    0.807976    0.678781    0.996395    0.810309    0.981100    0.768614    0.785755    0.765502    0.993115    0.845006    2400        48.197734   0.055874    0.058108    0.701574    122.797473 
[37m[36mINFO[0m[0m 02/11 05:05:13 | 0.777590    0.766629    0.989287    0.809886    0.697334    0.995366    0.810309    0.980527    0.773196    0.777590    0.766629    0.991968    0.846154    2600        52.214212   0.053582    0.054324    0.686014    127.088325 
[37m[36mINFO[0m[0m 02/11 05:09:34 | 0.773930    0.767756    0.990414    0.796666    0.720758    0.995881    0.795876    0.980813    0.760596    0.773930    0.767756    0.994550    0.833525    2800        56.230690   0.050405    0.051700    0.686969    123.508045 
[37m[36mINFO[0m[0m 02/11 05:13:54 | 0.776745    0.766629    0.990910    0.809500    0.706238    0.997940    0.810309    0.981100    0.777778    0.776745    0.766629    0.993689    0.840413    3000        60.247168   0.047125    0.049840    0.685066    122.593050 
[37m[36mINFO[0m[0m 02/11 05:18:18 | 0.780124    0.777903    0.990854    0.808970    0.688614    0.994336    0.804124    0.983104    0.776632    0.780124    0.777903    0.995123    0.846154    3200        64.263646   0.042811    0.047171    0.718766    120.022531 
[37m[36mINFO[0m[0m 02/11 05:22:37 | 0.777309    0.767756    0.991465    0.808961    0.705426    0.995881    0.814433    0.983963    0.777778    0.777309    0.767756    0.994550    0.834673    3400        68.280124   0.046012    0.045236    0.680982    123.328786 
[37m[36mINFO[0m[0m 02/11 05:27:03 | 0.777590    0.763247    0.991027    0.807207    0.708142    0.994851    0.800000    0.981959    0.783505    0.777590    0.763247    0.996271    0.838117    3600        72.296601   0.039112    0.043431    0.710759    123.709985 
[37m[36mINFO[0m[0m 02/11 05:31:26 | 0.774775    0.770011    0.991197    0.813480    0.726816    0.995366    0.806186    0.983963    0.782360    0.774775    0.770011    0.994263    0.851894    3800        76.313079   0.038369    0.041366    0.687070    125.137370 
[37m[36mINFO[0m[0m 02/11 05:35:50 | 0.780687    0.760992    0.990759    0.811109    0.703630    0.994336    0.797938    0.983104    0.788087    0.780687    0.760992    0.994836    0.847302    4000        80.329557   0.038937    0.040125    0.701766    123.576070 
[37m[36mINFO[0m[0m 02/11 05:40:15 | 0.785755    0.768884    0.992515    0.809352    0.707686    0.995881    0.804124    0.985968    0.777778    0.785755    0.768884    0.995697    0.846154    4200        84.346035   0.035811    0.039629    0.698762    126.077941 
[37m[36mINFO[0m[0m 02/11 05:44:32 | 0.776464    0.762120    0.992305    0.811259    0.713523    0.996395    0.814433    0.984536    0.775487    0.776464    0.762120    0.995984    0.843858    4400        88.362513   0.035421    0.038238    0.689444    118.978948 
[37m[36mINFO[0m[0m 02/11 05:49:03 | 0.780124    0.751973    0.992591    0.810950    0.699727    0.996395    0.812371    0.985968    0.781214    0.780124    0.751973    0.995410    0.839265    4600        92.378991   0.032145    0.036986    0.720879    126.461385 
[37m[36mINFO[0m[0m 02/11 05:53:18 | 0.778435    0.766629    0.991046    0.812947    0.698974    0.994336    0.810309    0.983391    0.774341    0.778435    0.766629    0.995410    0.854191    4800        96.395469   0.031510    0.035103    0.672027    121.041471 
[37m[36mINFO[0m[0m 02/11 05:57:41 | 0.772523    0.757610    0.992077    0.803088    0.717281    0.994851    0.787629    0.984250    0.777778    0.772523    0.757610    0.997131    0.843858    5000        100.411946  0.030146    0.034132    0.701995    122.209044 
[37m[36mINFO[0m[0m 02/11 05:57:41 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[2]/250211_04-06-26_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/11 05:57:43 | ---
[37m[36mINFO[0m[0m 02/11 05:57:43 | test-domain validation(oracle) = 78.012%
[37m[36mINFO[0m[0m 02/11 05:57:43 | training-domain validation(iid) = 78.660%
[37m[36mINFO[0m[0m 02/11 05:57:43 | last = 77.252%
[37m[36mINFO[0m[0m 02/11 05:57:43 | last (inD) = 80.309%
[37m[36mINFO[0m[0m 02/11 05:57:43 | training-domain validation (iid, inD) = 81.760%
[37m[36mINFO[0m[0m 02/11 05:57:43 | === Summary ===
[37m[36mINFO[0m[0m 02/11 05:57:43 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 2 --dataset OfficeHome --trial_seed 1 --hparams_seed 18
[37m[36mINFO[0m[0m 02/11 05:57:43 | Unique name: 250211_04-06-26_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 05:57:43 | Out path: train_output/OfficeHome/CORAL/[2]/250211_04-06-26_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 05:57:43 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/11 05:57:43 | Dataset: OfficeHome

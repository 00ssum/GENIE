[37m[36mINFO[0m[0m 02/10 15:48:42 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 2 --dataset OfficeHome --trial_seed 0 --hparams_seed 4
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 4
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[2]/250210_15-48-42_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250210_15-48-42_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.0793009436922532e-05
	batch_size: 30
	weight_decay: 0.0007980067844361917
	mmd_gamma: 0.10537155511080055
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/10 15:48:42 | n_steps = 5001
[37m[36mINFO[0m[0m 02/10 15:48:42 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/10 15:48:42 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/10 15:48:42 | 
[37m[36mINFO[0m[0m 02/10 15:48:42 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 02/10 15:48:42 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 02/10 15:48:42 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 02/10 15:48:42 | Batch sizes for each domain: [30, 30, 0, 30] (total=90)
[37m[36mINFO[0m[0m 02/10 15:48:42 | steps-per-epoch for each domain: 64.73, 116.40, 116.20 -> min = 64.73
[37m[36mINFO[0m[0m 02/10 15:48:44 | # of params = 23641217
[37m[36mINFO[0m[0m 02/10 15:51:05 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/10 15:51:05 | 0.009572    0.009019    0.015945    0.014600    4.217416    0.020597    0.018557    0.008877    0.006873    0.009572    0.009019    0.018359    0.018370    0           0.000000    4.353065    0.082641    1.577388    139.574225 
[37m[36mINFO[0m[0m 02/10 15:55:16 | 0.686937    0.680947    0.752001    0.698703    1.080893    0.762101    0.717526    0.709049    0.626575    0.686937    0.680947    0.784854    0.752009    200         3.089598    2.248327    0.552955    0.545821    141.837027 
[37m[36mINFO[0m[0m 02/10 15:59:29 | 0.736768    0.711387    0.841785    0.759081    0.927955    0.856334    0.748454    0.799255    0.712486    0.736768    0.711387    0.869765    0.816303    400         6.179197    0.838531    0.598401    0.592452    134.711066 
[37m[36mINFO[0m[0m 02/10 16:03:32 | 0.747185    0.735062    0.881755    0.770532    0.830799    0.910917    0.758763    0.842784    0.741123    0.747185    0.735062    0.891566    0.811711    600         9.268795    0.577505    0.554330    0.560410    130.586755 
[37m[36mINFO[0m[0m 02/10 16:07:45 | 0.755349    0.726043    0.919086    0.779397    0.815241    0.944387    0.756701    0.888030    0.760596    0.755349    0.726043    0.924842    0.820896    800         12.358393   0.418707    0.506626    0.574313    138.475137 
[37m[36mINFO[0m[0m 02/10 16:11:46 | 0.761543    0.744081    0.938490    0.792387    0.798585    0.961895    0.787629    0.905785    0.758305    0.761543    0.744081    0.947791    0.831228    1000        15.447992   0.313482    0.480622    0.537548    133.582129 
[37m[36mINFO[0m[0m 02/10 16:15:56 | 0.770270    0.740699    0.952117    0.788260    0.798560    0.977858    0.764948    0.928694    0.773196    0.770270    0.740699    0.949799    0.826636    1200        18.537590   0.249929    0.446763    0.584478    133.497675 
[37m[36mINFO[0m[0m 02/10 16:20:09 | 0.770552    0.749718    0.964287    0.794678    0.788903    0.984552    0.777320    0.939576    0.775487    0.770552    0.749718    0.968732    0.831228    1400        21.627188   0.198080    0.417789    0.580208    136.535516 
[37m[36mINFO[0m[0m 02/10 16:24:31 | 0.777309    0.735062    0.966768    0.798649    0.801943    0.984552    0.783505    0.947595    0.781214    0.777309    0.735062    0.968158    0.831228    1600        24.716787   0.160997    0.393295    0.579302    145.668080 
[37m[36mINFO[0m[0m 02/10 16:28:40 | 0.769426    0.742954    0.973664    0.795447    0.820327    0.986612    0.767010    0.957904    0.781214    0.769426    0.742954    0.976477    0.838117    1800        27.806385   0.142330    0.369180    0.548738    139.187249 
[37m[36mINFO[0m[0m 02/10 16:32:46 | 0.769989    0.751973    0.981209    0.797124    0.812656    0.991761    0.773196    0.965636    0.784651    0.769989    0.751973    0.986231    0.833525    2000        30.895984   0.117541    0.337432    0.577230    130.783181 
[37m[36mINFO[0m[0m 02/10 16:36:47 | 0.762669    0.741826    0.977464    0.794055    0.838837    0.989701    0.783505    0.963631    0.783505    0.762669    0.741826    0.979059    0.815155    2200        33.985582   0.100820    0.322864    0.579351    125.280941 
[37m[36mINFO[0m[0m 02/10 16:40:57 | 0.761543    0.728298    0.981991    0.790703    0.849363    0.991246    0.760825    0.970218    0.785796    0.761543    0.728298    0.984509    0.825488    2400        37.075180   0.091096    0.312767    0.577907    134.685177 
[37m[36mINFO[0m[0m 02/10 16:45:01 | 0.785191    0.760992    0.985831    0.797729    0.803789    0.993306    0.787629    0.974800    0.778923    0.785191    0.760992    0.989386    0.826636    2600        40.164779   0.083259    0.293129    0.584783    126.460037 
[37m[36mINFO[0m[0m 02/10 16:48:51 | 0.777872    0.762120    0.987473    0.802543    0.788753    0.995366    0.791753    0.975659    0.785796    0.777872    0.762120    0.991394    0.830080    2800        43.254377   0.072470    0.279144    0.545330    120.850660 
[37m[36mINFO[0m[0m 02/10 16:52:44 | 0.777590    0.756483    0.988465    0.803006    0.821151    0.994336    0.789691    0.980527    0.783505    0.777590    0.756483    0.990534    0.835821    3000        46.343975   0.064256    0.255198    0.540053    125.432877 
[37m[36mINFO[0m[0m 02/10 16:56:48 | 0.773649    0.750846    0.987474    0.792537    0.822684    0.992791    0.762887    0.977377    0.786942    0.773649    0.750846    0.992255    0.827784    3200        49.433574   0.059137    0.250112    0.554469    133.078958 
[37m[36mINFO[0m[0m 02/10 17:00:44 | 0.775056    0.754228    0.988791    0.800474    0.807805    0.995881    0.785567    0.976804    0.794960    0.775056    0.754228    0.993689    0.820896    3400        52.523172   0.051997    0.237156    0.521260    132.080576 
[37m[36mINFO[0m[0m 02/10 17:04:37 | 0.771115    0.745209    0.989879    0.793450    0.826564    0.994851    0.779381    0.981672    0.777778    0.771115    0.745209    0.993115    0.823192    3600        55.612770   0.053512    0.228174    0.525572    127.124976 
[37m[36mINFO[0m[0m 02/10 17:08:28 | 0.768863    0.736189    0.989651    0.796656    0.840129    0.993306    0.785567    0.982245    0.783505    0.768863    0.736189    0.993402    0.820896    3800        58.702369   0.050545    0.221021    0.535623    124.034165 
[37m[36mINFO[0m[0m 02/10 17:12:21 | 0.768863    0.757610    0.990625    0.803158    0.822435    0.995366    0.775258    0.981959    0.798396    0.768863    0.757610    0.994550    0.835821    4000        61.791967   0.049475    0.211790    0.498914    133.657834 
[37m[36mINFO[0m[0m 02/10 17:16:12 | 0.772804    0.757610    0.990013    0.795059    0.824920    0.996395    0.777320    0.979668    0.777778    0.772804    0.757610    0.993976    0.830080    4200        64.881565   0.043234    0.205562    0.525446    126.157403 
[37m[36mINFO[0m[0m 02/10 17:20:09 | 0.774212    0.747463    0.990779    0.805454    0.832566    0.993821    0.785567    0.982532    0.789233    0.774212    0.747463    0.995984    0.841561    4400        67.971164   0.041895    0.198013    0.552017    125.985076 
[37m[36mINFO[0m[0m 02/10 17:24:05 | 0.763514    0.753100    0.989976    0.797427    0.831941    0.994851    0.775258    0.980527    0.786942    0.763514    0.753100    0.994550    0.830080    4600        71.060762   0.039304    0.191786    0.565202    123.081320 
[37m[36mINFO[0m[0m 02/10 17:28:00 | 0.776745    0.741826    0.990816    0.808501    0.841148    0.995366    0.795876    0.981100    0.797251    0.776745    0.741826    0.995984    0.832377    4800        74.150360   0.038449    0.187636    0.542489    126.307118 
[37m[36mINFO[0m[0m 02/10 17:31:50 | 0.775619    0.764374    0.992305    0.809421    0.817833    0.996395    0.802062    0.983963    0.789233    0.775619    0.764374    0.996558    0.836969    5000        77.239959   0.034642    0.180057    0.532974    123.721559 
[37m[36mINFO[0m[0m 02/10 17:31:50 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[2]/250210_15-48-42_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/10 17:31:52 | ---
[37m[36mINFO[0m[0m 02/10 17:31:52 | test-domain validation(oracle) = 77.562%
[37m[36mINFO[0m[0m 02/10 17:31:52 | training-domain validation(iid) = 77.562%
[37m[36mINFO[0m[0m 02/10 17:31:52 | last = 77.562%
[37m[36mINFO[0m[0m 02/10 17:31:52 | last (inD) = 80.942%
[37m[36mINFO[0m[0m 02/10 17:31:52 | training-domain validation (iid, inD) = 80.942%
[37m[36mINFO[0m[0m 02/10 17:31:52 | === Summary ===
[37m[36mINFO[0m[0m 02/10 17:31:52 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 2 --dataset OfficeHome --trial_seed 0 --hparams_seed 4
[37m[36mINFO[0m[0m 02/10 17:31:52 | Unique name: 250210_15-48-42_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 17:31:52 | Out path: train_output/OfficeHome/CORAL/[2]/250210_15-48-42_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 17:31:52 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/10 17:31:52 | Dataset: OfficeHome

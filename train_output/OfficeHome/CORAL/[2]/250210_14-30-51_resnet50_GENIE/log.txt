[37m[36mINFO[0m[0m 02/10 14:30:51 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 2 --dataset OfficeHome --trial_seed 0 --hparams_seed 3
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 3
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[2]/250210_14-30-51_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250210_14-30-51_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 6.166705009429313e-05
	batch_size: 14
	weight_decay: 3.4412812120883604e-06
	mmd_gamma: 0.7404937726102715
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/10 14:30:51 | n_steps = 5001
[37m[36mINFO[0m[0m 02/10 14:30:51 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/10 14:30:51 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/10 14:30:51 | 
[37m[36mINFO[0m[0m 02/10 14:30:51 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 02/10 14:30:51 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 02/10 14:30:51 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 02/10 14:30:51 | Batch sizes for each domain: [14, 14, 0, 14] (total=42)
[37m[36mINFO[0m[0m 02/10 14:30:51 | steps-per-epoch for each domain: 138.71, 249.43, 249.00 -> min = 138.71
[37m[36mINFO[0m[0m 02/10 14:30:53 | # of params = 23641217
[37m[36mINFO[0m[0m 02/10 14:32:57 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/10 14:32:57 | 0.025056    0.022548    0.031167    0.030650    4.197333    0.035015    0.028866    0.019187    0.026346    0.025056    0.022548    0.039300    0.036739    0           0.000000    4.484426    0.157287    1.309997    123.415348 
[37m[36mINFO[0m[0m 02/10 14:35:50 | 0.613457    0.593010    0.627629    0.615408    1.601455    0.625129    0.614433    0.575315    0.555556    0.613457    0.593010    0.682444    0.676234    200         1.441813    3.091691    0.167096    0.256569    121.468220 
[37m[36mINFO[0m[0m 02/10 14:38:52 | 0.686374    0.684329    0.742976    0.697478    1.174623    0.753347    0.698969    0.687285    0.646048    0.686374    0.684329    0.788296    0.747417    400         2.883625    1.335672    0.267135    0.272706    126.908856 
[37m[36mINFO[0m[0m 02/10 14:41:46 | 0.705236    0.702368    0.801066    0.723159    1.042023    0.829042    0.727835    0.748855    0.665521    0.705236    0.702368    0.825301    0.776119    600         4.325438    0.960252    0.224553    0.261104    122.478734 
[37m[36mINFO[0m[0m 02/10 14:44:42 | 0.716498    0.697858    0.825966    0.734775    0.981849    0.842430    0.734021    0.793242    0.682703    0.716498    0.697858    0.842226    0.787600    800         5.767250    0.753628    0.198600    0.264531    123.091341 
[37m[36mINFO[0m[0m 02/10 14:47:35 | 0.718468    0.697858    0.862201    0.751198    0.936101    0.892379    0.754639    0.822738    0.705613    0.718468    0.697858    0.871486    0.793341    1000        7.209063    0.640749    0.182027    0.271320    118.049104 
[37m[36mINFO[0m[0m 02/10 14:50:33 | 0.738176    0.722661    0.895824    0.768005    0.884729    0.925335    0.764948    0.865407    0.736541    0.738176    0.722661    0.896730    0.802526    1200        8.650875    0.562531    0.168265    0.266004    124.870899 
[37m[36mINFO[0m[0m 02/10 14:53:25 | 0.739020    0.726043    0.889910    0.759989    0.892648    0.915036    0.744330    0.856529    0.729668    0.739020    0.726043    0.898164    0.805970    1400        10.092688   0.468127    0.157056    0.261752    120.018771 
[37m[36mINFO[0m[0m 02/10 14:56:22 | 0.735079    0.724915    0.915489    0.776640    0.861589    0.948507    0.769072    0.885739    0.750286    0.735079    0.724915    0.912220    0.810563    1600        11.534501   0.410708    0.148359    0.266912    123.427870 
[37m[36mINFO[0m[0m 02/10 14:59:17 | 0.738739    0.717024    0.922673    0.768164    0.873199    0.942842    0.729897    0.904926    0.764032    0.738739    0.717024    0.920252    0.810563    1800        12.976313   0.346655    0.139291    0.268746    121.125040 
[37m[36mINFO[0m[0m 02/10 15:02:11 | 0.738176    0.713641    0.932470    0.777724    0.832613    0.956746    0.750515    0.906644    0.753723    0.738176    0.713641    0.934022    0.828932    2000        14.418126   0.313349    0.134907    0.253066    123.887569 
[37m[36mINFO[0m[0m 02/10 15:05:01 | 0.748874    0.724915    0.944974    0.782069    0.812340    0.974768    0.767010    0.917239    0.759450    0.748874    0.724915    0.942915    0.819747    2200        15.859938   0.271154    0.128221    0.258500    118.173955 
[37m[36mINFO[0m[0m 02/10 15:07:58 | 0.738457    0.713641    0.949484    0.782748    0.839253    0.974253    0.769072    0.924685    0.770905    0.738457    0.713641    0.949512    0.808266    2400        17.301751   0.243213    0.124564    0.255729    125.344453 
[37m[36mINFO[0m[0m 02/10 15:10:54 | 0.751689    0.729425    0.951969    0.789021    0.800259    0.974253    0.775258    0.926403    0.768614    0.751689    0.729425    0.955250    0.823192    2600        18.743563   0.213811    0.118583    0.270640    122.537584 
[37m[36mINFO[0m[0m 02/10 15:13:47 | 0.734516    0.712514    0.956973    0.780693    0.877004    0.975798    0.762887    0.934135    0.761741    0.734516    0.712514    0.960987    0.817451    2800        20.185376   0.190590    0.112252    0.251662    122.516141 
[37m[36mINFO[0m[0m 02/10 15:16:38 | 0.757038    0.730552    0.963026    0.788870    0.807557    0.985067    0.758763    0.936712    0.782360    0.757038    0.730552    0.967298    0.825488    3000        21.627188   0.184930    0.107749    0.262554    118.015686 
[37m[36mINFO[0m[0m 02/10 15:19:34 | 0.750282    0.727170    0.969842    0.786951    0.799249    0.989186    0.769072    0.948740    0.780069    0.750282    0.727170    0.971601    0.811711    3200        23.069001   0.162044    0.105194    0.259597    124.226178 
[37m[36mINFO[0m[0m 02/10 15:22:40 | 0.742962    0.722661    0.975936    0.790471    0.792396    0.989701    0.777320    0.960481    0.772050    0.742962    0.722661    0.977625    0.822044    3400        24.510814   0.141918    0.099423    0.274856    130.843581 
[37m[36mINFO[0m[0m 02/10 15:25:48 | 0.751689    0.729425    0.975745    0.795889    0.789232    0.992276    0.785567    0.955899    0.785796    0.751689    0.729425    0.979059    0.816303    3600        25.952626   0.128814    0.095490    0.284326    131.004363 
[37m[36mINFO[0m[0m 02/10 15:29:02 | 0.773367    0.750846    0.978494    0.805679    0.761846    0.992791    0.789691    0.963631    0.790378    0.773367    0.750846    0.979059    0.836969    3800        27.394439   0.120619    0.091488    0.287173    137.085285 
[37m[36mINFO[0m[0m 02/10 15:32:22 | 0.743806    0.722661    0.974960    0.794826    0.820492    0.990216    0.783505    0.960195    0.776632    0.743806    0.722661    0.974469    0.824340    4000        28.836251   0.112400    0.088015    0.296907    140.303254 
[37m[36mINFO[0m[0m 02/10 15:35:39 | 0.760698    0.733935    0.981589    0.794826    0.794571    0.994336    0.773196    0.965349    0.786942    0.760698    0.733935    0.985083    0.824340    4200        30.278064   0.105145    0.087073    0.300949    136.875450 
[37m[36mINFO[0m[0m 02/10 15:38:58 | 0.760980    0.738444    0.982984    0.792300    0.827691    0.992791    0.779381    0.969931    0.781214    0.760980    0.738444    0.986231    0.816303    4400        31.719876   0.098456    0.082057    0.268321    145.103968 
[37m[36mINFO[0m[0m 02/10 15:42:13 | 0.770833    0.745209    0.985698    0.809267    0.760234    0.991761    0.795876    0.975086    0.797251    0.770833    0.745209    0.990247    0.834673    4600        33.161689   0.088153    0.080174    0.298791    135.464272 
[37m[36mINFO[0m[0m 02/10 15:45:21 | 0.765203    0.747463    0.986728    0.810334    0.766976    0.994851    0.808247    0.975086    0.790378    0.765203    0.747463    0.990247    0.832377    4800        34.603502   0.077606    0.077931    0.274056    133.085278 
[37m[36mINFO[0m[0m 02/10 15:48:36 | 0.752252    0.738444    0.984721    0.797953    0.794573    0.994851    0.791753    0.973081    0.782360    0.752252    0.738444    0.986231    0.819747    5000        36.045314   0.080450    0.075074    0.330667    128.783652 
[37m[36mINFO[0m[0m 02/10 15:48:36 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[2]/250210_14-30-51_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/10 15:48:37 | ---
[37m[36mINFO[0m[0m 02/10 15:48:37 | test-domain validation(oracle) = 77.337%
[37m[36mINFO[0m[0m 02/10 15:48:37 | training-domain validation(iid) = 76.520%
[37m[36mINFO[0m[0m 02/10 15:48:37 | last = 75.225%
[37m[36mINFO[0m[0m 02/10 15:48:37 | last (inD) = 79.795%
[37m[36mINFO[0m[0m 02/10 15:48:37 | training-domain validation (iid, inD) = 81.033%
[37m[36mINFO[0m[0m 02/10 15:48:37 | === Summary ===
[37m[36mINFO[0m[0m 02/10 15:48:37 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 2 --dataset OfficeHome --trial_seed 0 --hparams_seed 3
[37m[36mINFO[0m[0m 02/10 15:48:37 | Unique name: 250210_14-30-51_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 15:48:37 | Out path: train_output/OfficeHome/CORAL/[2]/250210_14-30-51_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 15:48:37 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/10 15:48:37 | Dataset: OfficeHome

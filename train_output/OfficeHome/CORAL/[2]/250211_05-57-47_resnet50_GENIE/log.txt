[37m[36mINFO[0m[0m 02/11 05:57:47 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 2 --dataset OfficeHome --trial_seed 2 --hparams_seed 12
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 12
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[2]/250211_05-57-47_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 2
	unique_name: 250211_05-57-47_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5.346798771850428e-05
	batch_size: 44
	weight_decay: 1.8352299015720086e-05
	mmd_gamma: 3.310992720685983
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/11 05:57:47 | n_steps = 5001
[37m[36mINFO[0m[0m 02/11 05:57:47 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/11 05:57:47 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/11 05:57:47 | 
[37m[36mINFO[0m[0m 02/11 05:57:47 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 02/11 05:57:47 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 02/11 05:57:47 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 02/11 05:57:47 | Batch sizes for each domain: [44, 44, 0, 44] (total=132)
[37m[36mINFO[0m[0m 02/11 05:57:47 | steps-per-epoch for each domain: 44.14, 79.36, 79.23 -> min = 44.14
[37m[36mINFO[0m[0m 02/11 05:57:48 | # of params = 23641217
[37m[36mINFO[0m[0m 02/11 05:59:59 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/11 05:59:59 | 0.012106    0.014656    0.019113    0.024382    4.205893    0.025232    0.022680    0.013173    0.021764    0.012106    0.014656    0.018933    0.028703    0           0.000000    4.245813    0.024829    1.351109    129.049243 
[37m[36mINFO[0m[0m 02/11 06:04:35 | 0.736205    0.720406    0.795707    0.746693    0.956952    0.816684    0.752577    0.743414    0.693013    0.736205    0.720406    0.827022    0.794489    200         4.531411    1.841395    0.057786    0.781036    120.424884 
[37m[36mINFO[0m[0m 02/11 06:09:19 | 0.745495    0.742954    0.871871    0.767340    0.816906    0.891864    0.742268    0.835624    0.728522    0.745495    0.742954    0.888124    0.831228    400         9.062822    0.645599    0.050278    0.776192    128.849151 
[37m[36mINFO[0m[0m 02/11 06:14:07 | 0.753941    0.750846    0.913473    0.780001    0.768347    0.938723    0.771134    0.881730    0.757159    0.753941    0.750846    0.919966    0.811711    600         13.594233   0.419258    0.043246    0.772227    132.781165 
[37m[36mINFO[0m[0m 02/11 06:18:52 | 0.769707    0.763247    0.944901    0.786731    0.743741    0.969104    0.775258    0.920103    0.760596    0.769707    0.763247    0.945496    0.824340    800         18.125644   0.295771    0.038260    0.807926    123.545892 
[37m[36mINFO[0m[0m 02/11 06:23:34 | 0.766329    0.767756    0.957219    0.784211    0.738027    0.979403    0.760825    0.934422    0.767468    0.766329    0.767756    0.957831    0.824340    1000        22.657055   0.220292    0.034091    0.786398    125.228142 
[37m[36mINFO[0m[0m 02/11 06:28:16 | 0.781813    0.776776    0.970760    0.802620    0.704663    0.985067    0.800000    0.956186    0.776632    0.781813    0.776776    0.971027    0.831228    1200        27.188465   0.166846    0.030936    0.776751    126.546660 
[37m[36mINFO[0m[0m 02/11 06:32:54 | 0.778998    0.768884    0.974638    0.802241    0.715781    0.988671    0.789691    0.957904    0.782360    0.778998    0.768884    0.977338    0.834673    1400        31.719876   0.132403    0.027977    0.803542    117.477050 
[37m[36mINFO[0m[0m 02/11 06:37:39 | 0.778716    0.766629    0.980598    0.796510    0.714043    0.990216    0.789691    0.965922    0.769759    0.778716    0.766629    0.985657    0.830080    1600        36.251287   0.111541    0.025803    0.809370    122.432512 
[37m[36mINFO[0m[0m 02/11 06:42:19 | 0.783221    0.772266    0.984380    0.799487    0.710091    0.993821    0.791753    0.968786    0.778923    0.783221    0.772266    0.990534    0.827784    1800        40.782698   0.097806    0.023912    0.800698    120.682411 
[37m[36mINFO[0m[0m 02/11 06:47:10 | 0.783784    0.783540    0.986290    0.807200    0.705034    0.993821    0.800000    0.973654    0.792669    0.783784    0.783540    0.991394    0.828932    2000        45.314109   0.083695    0.022525    0.834384    123.373079 
[37m[36mINFO[0m[0m 02/11 06:52:00 | 0.780405    0.772266    0.987150    0.803538    0.705199    0.993821    0.785567    0.974513    0.792669    0.780405    0.772266    0.993115    0.832377    2200        49.845520   0.079047    0.020920    0.801393    129.796706 
[37m[36mINFO[0m[0m 02/11 06:56:42 | 0.782095    0.772266    0.988372    0.805676    0.704423    0.994336    0.800000    0.977377    0.784651    0.782095    0.772266    0.993402    0.832377    2400        54.376931   0.064947    0.019741    0.806958    120.702119 
[37m[36mINFO[0m[0m 02/11 07:01:24 | 0.781813    0.762120    0.989327    0.803228    0.725899    0.994336    0.793814    0.979381    0.789233    0.781813    0.762120    0.994263    0.826636    2600        58.908342   0.060047    0.018609    0.796815    123.080916 
[37m[36mINFO[0m[0m 02/11 07:06:05 | 0.781813    0.759865    0.988066    0.806063    0.717460    0.994851    0.800000    0.975372    0.778923    0.781813    0.759865    0.993976    0.839265    2800        63.439753   0.054621    0.017703    0.785222    123.230420 
[37m[36mINFO[0m[0m 02/11 07:10:39 | 0.780968    0.767756    0.989518    0.808274    0.716700    0.994336    0.802062    0.979954    0.788087    0.780968    0.767756    0.994263    0.834673    3000        67.971164   0.052236    0.016942    0.782205    117.581212 
[37m[36mINFO[0m[0m 02/11 07:15:31 | 0.772241    0.763247    0.991179    0.803764    0.725112    0.995881    0.789691    0.981959    0.792669    0.772241    0.763247    0.995697    0.828932    3200        72.502575   0.046713    0.016202    0.809055    130.068826 
[37m[36mINFO[0m[0m 02/11 07:20:14 | 0.780968    0.771139    0.990549    0.801709    0.741276    0.994851    0.783505    0.981386    0.783505    0.780968    0.771139    0.995410    0.838117    3400        77.033986   0.046406    0.015340    0.765983    130.309734 
[37m[36mINFO[0m[0m 02/11 07:24:56 | 0.784910    0.771139    0.991313    0.806367    0.716489    0.994851    0.791753    0.983677    0.789233    0.784910    0.771139    0.995410    0.838117    3600        81.565396   0.044445    0.014990    0.791540    123.358808 
[37m[36mINFO[0m[0m 02/11 07:29:35 | 0.784065    0.773393    0.991791    0.797047    0.722273    0.994851    0.775258    0.983677    0.782360    0.784065    0.773393    0.996845    0.833525    3800        86.096807   0.044249    0.014052    0.767439    125.791710 
[37m[36mINFO[0m[0m 02/11 07:34:17 | 0.784065    0.764374    0.992153    0.803463    0.730396    0.995366    0.787629    0.984822    0.788087    0.784065    0.764374    0.996271    0.834673    4000        90.628218   0.039939    0.013897    0.787327    124.513447 
[37m[36mINFO[0m[0m 02/11 07:39:02 | 0.781250    0.757610    0.990664    0.800022    0.727801    0.994336    0.787629    0.982532    0.783505    0.781250    0.757610    0.995123    0.828932    4200        95.159629   0.039367    0.013282    0.819951    120.898626 
[37m[36mINFO[0m[0m 02/11 07:43:43 | 0.782658    0.762120    0.991370    0.807818    0.728907    0.995881    0.793814    0.981959    0.791523    0.782658    0.762120    0.996271    0.838117    4400        99.691040   0.036431    0.013021    0.790811    122.571571 
[37m[36mINFO[0m[0m 02/11 07:48:23 | 0.781250    0.762120    0.992668    0.795209    0.744394    0.996910    0.773196    0.984250    0.785796    0.781250    0.762120    0.996845    0.826636    4600        104.222451  0.038898    0.012676    0.797425    121.286247 
[37m[36mINFO[0m[0m 02/11 07:53:14 | 0.783221    0.766629    0.991408    0.800941    0.737249    0.994851    0.783505    0.983677    0.786942    0.783221    0.766629    0.995697    0.832377    4800        108.753862  0.035260    0.012416    0.808597    129.241503 
[37m[36mINFO[0m[0m 02/11 07:58:00 | 0.780124    0.765502    0.991923    0.805834    0.735157    0.996395    0.795876    0.984250    0.782360    0.780124    0.765502    0.995123    0.839265    5000        113.285273  0.034234    0.011978    0.808367    123.886659 
[37m[36mINFO[0m[0m 02/11 07:58:00 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[2]/250211_05-57-47_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/11 07:58:01 | ---
[37m[36mINFO[0m[0m 02/11 07:58:01 | test-domain validation(oracle) = 78.378%
[37m[36mINFO[0m[0m 02/11 07:58:01 | training-domain validation(iid) = 78.097%
[37m[36mINFO[0m[0m 02/11 07:58:01 | last = 78.012%
[37m[36mINFO[0m[0m 02/11 07:58:01 | last (inD) = 80.583%
[37m[36mINFO[0m[0m 02/11 07:58:01 | training-domain validation (iid, inD) = 80.827%
[37m[36mINFO[0m[0m 02/11 07:58:02 | === Summary ===
[37m[36mINFO[0m[0m 02/11 07:58:02 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 2 --dataset OfficeHome --trial_seed 2 --hparams_seed 12
[37m[36mINFO[0m[0m 02/11 07:58:02 | Unique name: 250211_05-57-47_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 07:58:02 | Out path: train_output/OfficeHome/CORAL/[2]/250211_05-57-47_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 07:58:02 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/11 07:58:02 | Dataset: OfficeHome

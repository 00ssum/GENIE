[37m[36mINFO[0m[0m 02/10 13:23:36 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 2 --dataset OfficeHome --trial_seed 0 --hparams_seed 2
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 2
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[2]/250210_13-23-36_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250210_13-23-36_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.9041073434446342e-05
	batch_size: 9
	weight_decay: 0.0006566989842279891
	mmd_gamma: 1.5832433896458313
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/10 13:23:36 | n_steps = 5001
[37m[36mINFO[0m[0m 02/10 13:23:36 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/10 13:23:36 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/10 13:23:36 | 
[37m[36mINFO[0m[0m 02/10 13:23:36 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 02/10 13:23:36 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 02/10 13:23:36 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 02/10 13:23:36 | Batch sizes for each domain: [9, 9, 0, 9] (total=27)
[37m[36mINFO[0m[0m 02/10 13:23:36 | steps-per-epoch for each domain: 215.78, 388.00, 387.33 -> min = 215.78
[37m[36mINFO[0m[0m 02/10 13:23:37 | # of params = 23641217
[37m[36mINFO[0m[0m 02/10 13:25:37 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/10 13:25:37 | 0.039696    0.036077    0.043915    0.036527    4.204490    0.054068    0.045361    0.035510    0.032073    0.039696    0.036077    0.042169    0.032147    0           0.000000    4.391729    0.058818    1.250211    118.133193 
[37m[36mINFO[0m[0m 02/10 13:28:11 | 0.579673    0.562570    0.609157    0.600193    1.556652    0.618435    0.612371    0.549542    0.536082    0.579673    0.562570    0.659495    0.652124    200         0.926880    2.893771    0.100288    0.186305    117.108617 
[37m[36mINFO[0m[0m 02/10 13:30:50 | 0.676239    0.656144    0.721688    0.677070    1.222639    0.727600    0.672165    0.667526    0.635739    0.676239    0.656144    0.769937    0.723307    400         1.853759    1.285670    0.135673    0.188283    120.626440 
[37m[36mINFO[0m[0m 02/10 13:33:31 | 0.676239    0.660654    0.764927    0.702278    1.148700    0.773944    0.703093    0.727090    0.671249    0.676239    0.660654    0.793746    0.732491    600         2.780639    0.949376    0.115021    0.183452    124.259282 
[37m[36mINFO[0m[0m 02/10 13:36:09 | 0.720158    0.694476    0.805628    0.741947    1.025302    0.829557    0.756701    0.763173    0.689576    0.720158    0.694476    0.824154    0.779564    800         3.707518    0.807149    0.101853    0.190757    120.392561 
[37m[36mINFO[0m[0m 02/10 13:38:50 | 0.705518    0.679820    0.830507    0.740040    0.980354    0.856334    0.756701    0.788660    0.681558    0.705518    0.679820    0.846529    0.781860    1000        4.634398    0.694422    0.092603    0.206208    119.235846 
[37m[36mINFO[0m[0m 02/10 13:41:35 | 0.718750    0.693348    0.853858    0.741878    0.993459    0.872812    0.717526    0.828465    0.719359    0.718750    0.693348    0.860298    0.788749    1200        5.561277    0.605886    0.088538    0.207088    123.549376 
[37m[36mINFO[0m[0m 02/10 13:44:13 | 0.713119    0.701240    0.863579    0.738806    1.000496    0.881050    0.717526    0.839633    0.731959    0.713119    0.701240    0.870052    0.766935    1400        6.488157    0.531005    0.084861    0.204927    117.843690 
[37m[36mINFO[0m[0m 02/10 13:46:45 | 0.724381    0.715896    0.892616    0.755774    0.921626    0.919156    0.744330    0.867125    0.736541    0.724381    0.715896    0.891566    0.786452    1600        7.415036    0.444346    0.079853    0.179599    115.944052 
[37m[36mINFO[0m[0m 02/10 13:49:16 | 0.716779    0.680947    0.896053    0.747522    0.960594    0.921730    0.729897    0.870848    0.733104    0.716779    0.680947    0.895582    0.779564    1800        8.341916    0.410958    0.076540    0.172023    116.737628 
[37m[36mINFO[0m[0m 02/10 13:51:58 | 0.747466    0.717024    0.916444    0.757687    0.884706    0.940783    0.744330    0.899485    0.737686    0.747466    0.717024    0.909065    0.791045    2000        9.268795    0.341865    0.073908    0.189062    124.240962 
[37m[36mINFO[0m[0m 02/10 13:54:31 | 0.737050    0.709132    0.927543    0.771376    0.855268    0.953141    0.756701    0.900916    0.741123    0.737050    0.709132    0.928571    0.816303    2200        10.195675   0.292535    0.071074    0.182529    116.208802 
[37m[36mINFO[0m[0m 02/10 13:57:09 | 0.734516    0.715896    0.932106    0.772744    0.862527    0.953656    0.740206    0.912658    0.769759    0.734516    0.715896    0.930006    0.808266    2400        11.122554   0.276727    0.068509    0.171501    123.521211 
[37m[36mINFO[0m[0m 02/10 13:59:43 | 0.734797    0.714769    0.931402    0.765780    0.910729    0.952111    0.773196    0.909221    0.735395    0.734797    0.714769    0.932874    0.788749    2600        12.049434   0.241728    0.066213    0.183440    117.614944 
[37m[36mINFO[0m[0m 02/10 14:02:14 | 0.744369    0.724915    0.942096    0.772365    0.862865    0.959835    0.750515    0.923826    0.754868    0.744369    0.724915    0.942628    0.811711    2800        12.976313   0.225366    0.063637    0.168357    117.174639 
[37m[36mINFO[0m[0m 02/10 14:04:48 | 0.742962    0.715896    0.946737    0.778177    0.855596    0.968589    0.748454    0.920389    0.762887    0.742962    0.715896    0.951234    0.823192    3000        13.903193   0.231133    0.060863    0.180447    117.507797 
[37m[36mINFO[0m[0m 02/10 14:07:27 | 0.739865    0.721533    0.956320    0.784588    0.816508    0.977858    0.771134    0.935853    0.765178    0.739865    0.721533    0.955250    0.817451    3200        14.830072   0.205383    0.058244    0.194038    120.152060 
[37m[36mINFO[0m[0m 02/10 14:09:58 | 0.747466    0.714769    0.961022    0.779553    0.845401    0.977343    0.752577    0.940722    0.761741    0.747466    0.714769    0.965003    0.824340    3400        15.756952   0.194282    0.056522    0.182170    115.306065 
[37m[36mINFO[0m[0m 02/10 14:12:31 | 0.740991    0.723788    0.964896    0.783675    0.834773    0.986097    0.754639    0.942440    0.774341    0.740991    0.723788    0.966150    0.822044    3600        16.683831   0.147608    0.055606    0.182450    116.217703 
[37m[36mINFO[0m[0m 02/10 14:15:11 | 0.757320    0.753100    0.967647    0.792307    0.822765    0.986612    0.769072    0.945304    0.781214    0.757320    0.753100    0.971027    0.826636    3800        17.610711   0.129173    0.053041    0.186439    122.477030 
[37m[36mINFO[0m[0m 02/10 14:17:46 | 0.755912    0.724915    0.970722    0.784359    0.815763    0.986097    0.756701    0.953608    0.777778    0.755912    0.724915    0.972461    0.818599    4000        18.537590   0.150016    0.052807    0.188395    117.672155 
[37m[36mINFO[0m[0m 02/10 14:20:24 | 0.735642    0.711387    0.963332    0.777332    0.844653    0.979403    0.750515    0.945017    0.765178    0.735642    0.711387    0.965577    0.816303    4200        19.464470   0.124739    0.049573    0.191052    119.417756 
[37m[36mINFO[0m[0m 02/10 14:22:56 | 0.755631    0.744081    0.975040    0.795064    0.816542    0.988157    0.767010    0.957331    0.782360    0.755631    0.744081    0.979633    0.835821    4400        20.391349   0.121796    0.048189    0.184355    115.169323 
[37m[36mINFO[0m[0m 02/10 14:25:29 | 0.756475    0.727170    0.978038    0.795438    0.820278    0.989701    0.777320    0.963345    0.783505    0.756475    0.727170    0.981067    0.825488    4600        21.318229   0.128390    0.046776    0.175267    118.039307 
[37m[36mINFO[0m[0m 02/10 14:28:06 | 0.750282    0.731680    0.981397    0.791465    0.772328    0.994336    0.760825    0.968213    0.790378    0.750282    0.731680    0.981641    0.823192    4800        22.245108   0.111029    0.046847    0.192795    118.438316 
[37m[36mINFO[0m[0m 02/10 14:30:45 | 0.746622    0.740699    0.979718    0.787642    0.810282    0.990731    0.760825    0.967068    0.784651    0.746622    0.740699    0.981354    0.817451    5000        23.171988   0.100123    0.044288    0.188928    121.312661 
[37m[36mINFO[0m[0m 02/10 14:30:45 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[2]/250210_13-23-36_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/10 14:30:47 | ---
[37m[36mINFO[0m[0m 02/10 14:30:47 | test-domain validation(oracle) = 75.732%
[37m[36mINFO[0m[0m 02/10 14:30:47 | training-domain validation(iid) = 75.648%
[37m[36mINFO[0m[0m 02/10 14:30:47 | last = 74.662%
[37m[36mINFO[0m[0m 02/10 14:30:47 | last (inD) = 78.764%
[37m[36mINFO[0m[0m 02/10 14:30:47 | training-domain validation (iid, inD) = 79.544%
[37m[36mINFO[0m[0m 02/10 14:30:47 | === Summary ===
[37m[36mINFO[0m[0m 02/10 14:30:47 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 2 --dataset OfficeHome --trial_seed 0 --hparams_seed 2
[37m[36mINFO[0m[0m 02/10 14:30:47 | Unique name: 250210_13-23-36_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 14:30:47 | Out path: train_output/OfficeHome/CORAL/[2]/250210_13-23-36_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 14:30:47 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/10 14:30:47 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 02/10 23:16:15 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 2 --dataset OfficeHome --trial_seed 0 --hparams_seed 9
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 9
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[2]/250210_23-16-15_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250210_23-16-15_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5.5014200978340895e-05
	batch_size: 15
	weight_decay: 3.288190104805334e-05
	mmd_gamma: 0.11332382437966244
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/10 23:16:15 | n_steps = 5001
[37m[36mINFO[0m[0m 02/10 23:16:15 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/10 23:16:15 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/10 23:16:15 | 
[37m[36mINFO[0m[0m 02/10 23:16:15 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 02/10 23:16:15 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 02/10 23:16:15 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 02/10 23:16:15 | Batch sizes for each domain: [15, 15, 0, 15] (total=45)
[37m[36mINFO[0m[0m 02/10 23:16:15 | steps-per-epoch for each domain: 129.47, 232.80, 232.40 -> min = 129.47
[37m[36mINFO[0m[0m 02/10 23:16:16 | # of params = 23641217
[37m[36mINFO[0m[0m 02/10 23:18:22 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/10 23:18:22 | 0.018581    0.021421    0.030306    0.025072    4.218718    0.037590    0.024742    0.016609    0.018328    0.018581    0.021421    0.036718    0.032147    0           0.000000    4.352459    0.039163    1.060328    124.527488 
[37m[36mINFO[0m[0m 02/10 23:21:16 | 0.645833    0.649380    0.714176    0.650107    1.267211    0.721421    0.637113    0.670676    0.597938    0.645833    0.649380    0.750430    0.715270    200         1.544799    2.057863    0.425284    0.247302    124.306113 
[37m[36mINFO[0m[0m 02/10 23:24:09 | 0.715935    0.703495    0.806704    0.721464    1.007893    0.821318    0.731959    0.768041    0.675830    0.715935    0.703495    0.830752    0.756602    400         3.089598    0.867500    0.428366    0.273732    118.923938 
[37m[36mINFO[0m[0m 02/10 23:27:11 | 0.726351    0.722661    0.845229    0.730263    0.966671    0.866117    0.721649    0.813860    0.689576    0.726351    0.722661    0.855709    0.779564    600         4.634398    0.591355    0.416385    0.269243    127.339168 
[37m[36mINFO[0m[0m 02/10 23:30:03 | 0.738739    0.717024    0.872134    0.747368    0.952298    0.900103    0.744330    0.830470    0.719359    0.738739    0.717024    0.885829    0.778416    800         6.179197    0.471910    0.390686    0.246694    123.012180 
[37m[36mINFO[0m[0m 02/10 23:32:59 | 0.732827    0.721533    0.896701    0.752420    0.957439    0.927394    0.742268    0.865693    0.721649    0.732827    0.721533    0.897017    0.793341    1000        7.723996    0.396730    0.366996    0.273137    121.335407 
[37m[36mINFO[0m[0m 02/10 23:35:59 | 0.754505    0.720406    0.921776    0.775263    0.881166    0.946447    0.775258    0.897194    0.743414    0.754505    0.720406    0.921687    0.807118    1200        9.268795    0.325023    0.357769    0.275547    125.392457 
[37m[36mINFO[0m[0m 02/10 23:38:55 | 0.724944    0.726043    0.932831    0.772734    0.861020    0.962410    0.781443    0.902062    0.741123    0.724944    0.726043    0.934022    0.795637    1400        10.813594   0.248691    0.361173    0.257413    124.146182 
[37m[36mINFO[0m[0m 02/10 23:41:53 | 0.755349    0.756483    0.952116    0.778392    0.843196    0.977858    0.773196    0.931271    0.757159    0.755349    0.756483    0.947217    0.804822    1600        12.358393   0.215096    0.330408    0.263152    124.936309 
[37m[36mINFO[0m[0m 02/10 23:44:48 | 0.748874    0.730552    0.957887    0.788257    0.857766    0.981977    0.785567    0.931844    0.756014    0.748874    0.730552    0.959839    0.823192    1800        13.903193   0.166403    0.330281    0.282438    119.383821 
[37m[36mINFO[0m[0m 02/10 23:47:51 | 0.750845    0.728298    0.955404    0.783217    0.885624    0.976828    0.756701    0.933849    0.769759    0.750845    0.728298    0.955536    0.823192    2000        15.447992   0.167645    0.313403    0.264765    129.473626 
[37m[36mINFO[0m[0m 02/10 23:50:44 | 0.755349    0.747463    0.966177    0.781301    0.876108    0.982492    0.777320    0.949026    0.752577    0.755349    0.747463    0.967011    0.814007    2200        16.992791   0.124680    0.297759    0.250444    123.181947 
[37m[36mINFO[0m[0m 02/10 23:53:43 | 0.766329    0.750846    0.965431    0.782291    0.894245    0.987127    0.771134    0.941867    0.765178    0.766329    0.750846    0.967298    0.810563    2400        18.537590   0.118677    0.285425    0.288921    120.784547 
[37m[36mINFO[0m[0m 02/10 23:56:37 | 0.763514    0.739572    0.975172    0.788870    0.816728    0.987127    0.769072    0.962199    0.772050    0.763514    0.739572    0.976190    0.825488    2600        20.082389   0.100394    0.268154    0.253665    123.521151 
[37m[36mINFO[0m[0m 02/10 23:59:33 | 0.757601    0.727170    0.976471    0.784882    0.902563    0.990731    0.783505    0.959908    0.768614    0.757601    0.727170    0.978772    0.802526    2800        21.627188   0.091071    0.256513    0.271850    121.192889 
[37m[36mINFO[0m[0m 02/11 00:02:27 | 0.755631    0.733935    0.980616    0.791539    0.854683    0.992276    0.779381    0.965349    0.775487    0.755631    0.733935    0.984223    0.819747    3000        23.171988   0.079611    0.249563    0.270794    120.260180 
[37m[36mINFO[0m[0m 02/11 00:05:24 | 0.765484    0.754228    0.981494    0.781302    0.914938    0.994336    0.767010    0.964490    0.761741    0.765484    0.754228    0.985657    0.815155    3200        24.716787   0.076911    0.236528    0.275811    121.442537 
[37m[36mINFO[0m[0m 02/11 00:08:20 | 0.759572    0.742954    0.981168    0.794213    0.867427    0.992791    0.779381    0.969072    0.781214    0.759572    0.742954    0.981641    0.822044    3400        26.261586   0.069556    0.222023    0.259220    124.992179 
[37m[36mINFO[0m[0m 02/11 00:11:09 | 0.771959    0.753100    0.980482    0.791392    0.872021    0.990731    0.783505    0.967640    0.762887    0.771959    0.753100    0.983075    0.827784    3600        27.806385   0.065211    0.219305    0.259133    116.988965 
[37m[36mINFO[0m[0m 02/11 00:14:04 | 0.764358    0.731680    0.988905    0.801242    0.855794    0.995366    0.785567    0.979095    0.791523    0.764358    0.731680    0.992255    0.826636    3800        29.351184   0.057488    0.208819    0.276177    119.058262 
[37m[36mINFO[0m[0m 02/11 00:17:00 | 0.763514    0.728298    0.987453    0.789776    0.881202    0.993306    0.775258    0.979381    0.782360    0.763514    0.728298    0.989673    0.811711    4000        30.895984   0.050878    0.200740    0.251353    126.186418 
[37m[36mINFO[0m[0m 02/11 00:19:52 | 0.770552    0.748591    0.987512    0.802997    0.854953    0.994336    0.789691    0.975945    0.794960    0.770552    0.748591    0.992255    0.824340    4200        32.440783   0.047456    0.192216    0.271305    118.212291 
[37m[36mINFO[0m[0m 02/11 00:22:48 | 0.756475    0.746336    0.986918    0.796116    0.865795    0.994851    0.789691    0.976804    0.784651    0.756475    0.746336    0.989099    0.814007    4400        33.985582   0.043555    0.186532    0.244794    126.502352 
[37m[36mINFO[0m[0m 02/11 00:25:41 | 0.776464    0.758737    0.990796    0.802390    0.826726    0.995881    0.785567    0.982245    0.791523    0.776464    0.758737    0.994263    0.830080    4600        35.530381   0.044129    0.175358    0.274617    117.799897 
[37m[36mINFO[0m[0m 02/11 00:28:43 | 0.766047    0.737317    0.988772    0.799711    0.874544    0.996395    0.795876    0.976518    0.781214    0.766047    0.737317    0.993402    0.822044    4800        37.075180   0.037955    0.174778    0.267285    128.585828 
[37m[36mINFO[0m[0m 02/11 00:31:40 | 0.774493    0.747463    0.990071    0.793753    0.855965    0.994851    0.781443    0.981672    0.780069    0.774493    0.747463    0.993689    0.819747    5000        38.619979   0.037787    0.171218    0.260290    124.906417 
[37m[36mINFO[0m[0m 02/11 00:31:40 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[2]/250210_23-16-15_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/11 00:31:41 | ---
[37m[36mINFO[0m[0m 02/11 00:31:41 | test-domain validation(oracle) = 77.646%
[37m[36mINFO[0m[0m 02/11 00:31:41 | training-domain validation(iid) = 77.055%
[37m[36mINFO[0m[0m 02/11 00:31:41 | last = 77.449%
[37m[36mINFO[0m[0m 02/11 00:31:41 | last (inD) = 79.375%
[37m[36mINFO[0m[0m 02/11 00:31:41 | training-domain validation (iid, inD) = 80.300%
[37m[36mINFO[0m[0m 02/11 00:31:41 | === Summary ===
[37m[36mINFO[0m[0m 02/11 00:31:41 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 2 --dataset OfficeHome --trial_seed 0 --hparams_seed 9
[37m[36mINFO[0m[0m 02/11 00:31:41 | Unique name: 250210_23-16-15_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 00:31:41 | Out path: train_output/OfficeHome/CORAL/[2]/250210_23-16-15_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 00:31:41 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/11 00:31:41 | Dataset: OfficeHome

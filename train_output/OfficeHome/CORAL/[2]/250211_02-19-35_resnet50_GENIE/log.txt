[37m[36mINFO[0m[0m 02/11 02:19:35 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 2 --dataset OfficeHome --trial_seed 1 --hparams_seed 15
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 15
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[2]/250211_02-19-35_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 1
	unique_name: 250211_02-19-35_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.7812453400894684e-05
	batch_size: 36
	weight_decay: 3.1651536009272826e-06
	mmd_gamma: 3.440541362473826
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/11 02:19:35 | n_steps = 5001
[37m[36mINFO[0m[0m 02/11 02:19:35 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/11 02:19:35 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/11 02:19:35 | 
[37m[36mINFO[0m[0m 02/11 02:19:35 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 02/11 02:19:35 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 02/11 02:19:35 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 02/11 02:19:35 | Batch sizes for each domain: [36, 36, 0, 36] (total=108)
[37m[36mINFO[0m[0m 02/11 02:19:35 | steps-per-epoch for each domain: 53.94, 97.00, 96.83 -> min = 53.94
[37m[36mINFO[0m[0m 02/11 02:19:36 | # of params = 23641217
[37m[36mINFO[0m[0m 02/11 02:21:39 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/11 02:21:39 | 0.015203    0.013529    0.020393    0.016203    4.186969    0.029351    0.016495    0.008877    0.014891    0.015203    0.013529    0.022949    0.017222    0           0.000000    4.306787    0.027696    1.102988    122.203384 
[37m[36mINFO[0m[0m 02/11 02:25:53 | 0.730856    0.680947    0.768083    0.734162    1.044787    0.776519    0.750515    0.723081    0.666667    0.730856    0.680947    0.804647    0.785304    200         3.707518    1.934873    0.057799    0.644411    125.012561 
[37m[36mINFO[0m[0m 02/11 02:30:03 | 0.755912    0.730552    0.858271    0.776718    0.839315    0.882595    0.787629    0.821019    0.730813    0.755912    0.730552    0.871199    0.811711    400         7.415036    0.723068    0.051686    0.637825    121.823333 
[37m[36mINFO[0m[0m 02/11 02:34:17 | 0.757883    0.740699    0.903160    0.799258    0.744845    0.928424    0.808247    0.872566    0.760596    0.757883    0.740699    0.908491    0.828932    600         11.122554   0.478150    0.044926    0.630474    127.859545 
[37m[36mINFO[0m[0m 02/11 02:38:29 | 0.760135    0.741826    0.925736    0.808131    0.722693    0.942842    0.806186    0.899485    0.770905    0.760135    0.741826    0.934882    0.847302    800         14.830072   0.344642    0.039823    0.618089    128.994912 
[37m[36mINFO[0m[0m 02/11 02:42:37 | 0.769144    0.754228    0.947536    0.809280    0.704804    0.972709    0.806186    0.921535    0.769759    0.769144    0.754228    0.948365    0.851894    1000        18.537590   0.260747    0.036077    0.626601    122.534106 
[37m[36mINFO[0m[0m 02/11 02:46:49 | 0.775619    0.760992    0.959377    0.809276    0.694062    0.977858    0.795876    0.941867    0.784651    0.775619    0.760992    0.958405    0.847302    1200        22.245108   0.200231    0.032794    0.631119    125.154034 
[37m[36mINFO[0m[0m 02/11 02:50:57 | 0.767736    0.760992    0.974311    0.818976    0.674450    0.989701    0.822680    0.958477    0.784651    0.767736    0.760992    0.974756    0.849598    1400        25.952626   0.160984    0.029734    0.631717    122.583391 
[37m[36mINFO[0m[0m 02/11 02:55:08 | 0.780405    0.771139    0.976358    0.814243    0.677891    0.988671    0.816495    0.959908    0.775487    0.780405    0.771139    0.980493    0.850746    1600        29.660144   0.132937    0.028066    0.651996    119.866165 
[37m[36mINFO[0m[0m 02/11 02:59:13 | 0.774212    0.756483    0.981455    0.815537    0.679212    0.992791    0.812371    0.968499    0.788087    0.774212    0.756483    0.983075    0.846154    1800        33.367662   0.110023    0.025404    0.633099    118.394612 
[37m[36mINFO[0m[0m 02/11 03:03:25 | 0.773649    0.757610    0.985066    0.808430    0.700250    0.993306    0.808247    0.973940    0.777778    0.773649    0.757610    0.987952    0.839265    2000        37.075180   0.100864    0.023885    0.628855    126.976791 
[37m[36mINFO[0m[0m 02/11 03:07:33 | 0.773367    0.754228    0.984989    0.804767    0.725413    0.995366    0.793814    0.971936    0.777778    0.773367    0.754228    0.987665    0.842710    2200        40.782698   0.085266    0.022337    0.612890    125.168053 
[37m[36mINFO[0m[0m 02/11 03:11:52 | 0.774493    0.767756    0.986843    0.824482    0.669125    0.994336    0.828866    0.974513    0.785796    0.774493    0.767756    0.991681    0.858783    2400        44.490216   0.072342    0.020860    0.647686    129.503469 
[37m[36mINFO[0m[0m 02/11 03:16:05 | 0.772523    0.764374    0.988046    0.815845    0.684218    0.995366    0.814433    0.976231    0.784651    0.772523    0.764374    0.992542    0.848450    2600        48.197734   0.066116    0.019896    0.660725    120.541733 
[37m[36mINFO[0m[0m 02/11 03:20:17 | 0.773367    0.770011    0.989173    0.816683    0.682389    0.995881    0.812371    0.977377    0.791523    0.773367    0.770011    0.994263    0.846154    2800        51.905252   0.061166    0.018752    0.662036    119.684722 
[37m[36mINFO[0m[0m 02/11 03:24:30 | 0.772804    0.766629    0.989976    0.818520    0.686920    0.994851    0.804124    0.980241    0.799542    0.772804    0.766629    0.994836    0.851894    3000        55.612770   0.060954    0.018113    0.658773    121.356634 
[37m[36mINFO[0m[0m 02/11 03:28:43 | 0.772804    0.772266    0.990530    0.812637    0.687160    0.995366    0.808247    0.979954    0.781214    0.772804    0.772266    0.996271    0.848450    3200        59.320288   0.057292    0.017381    0.631766    126.386871 
[37m[36mINFO[0m[0m 02/11 03:32:55 | 0.772241    0.762120    0.991123    0.808433    0.693023    0.994851    0.797938    0.981672    0.784651    0.772241    0.762120    0.996845    0.842710    3400        63.027806   0.050783    0.016737    0.626844    127.149837 
[37m[36mINFO[0m[0m 02/11 03:37:11 | 0.761824    0.759865    0.989824    0.809803    0.691983    0.993821    0.802062    0.980813    0.790378    0.761824    0.759865    0.994836    0.836969    3600        66.735324   0.052468    0.016140    0.648325    125.987813 
[37m[36mINFO[0m[0m 02/11 03:41:18 | 0.768863    0.765502    0.990033    0.814013    0.689184    0.995881    0.802062    0.978809    0.790378    0.768863    0.765502    0.995410    0.849598    3800        70.442842   0.046840    0.015210    0.641500    118.562320 
[37m[36mINFO[0m[0m 02/11 03:45:28 | 0.770552    0.759865    0.991560    0.812254    0.706276    0.995881    0.797938    0.983677    0.792669    0.770552    0.759865    0.995123    0.846154    4000        74.150360   0.044414    0.015004    0.642976    121.489369 
[37m[36mINFO[0m[0m 02/11 03:49:43 | 0.771959    0.764374    0.991428    0.815383    0.682908    0.994336    0.806186    0.983391    0.796105    0.771959    0.764374    0.996558    0.843858    4200        77.857878   0.040386    0.014368    0.644892    126.227743 
[37m[36mINFO[0m[0m 02/11 03:53:56 | 0.772241    0.772266    0.991771    0.819290    0.686679    0.995366    0.804124    0.984250    0.793814    0.772241    0.772266    0.995697    0.859931    4400        81.565396   0.039797    0.013913    0.627138    127.227478 
[37m[36mINFO[0m[0m 02/11 03:58:02 | 0.775619    0.771139    0.991484    0.817685    0.677092    0.995366    0.795876    0.983391    0.798396    0.775619    0.771139    0.995697    0.858783    4600        85.272915   0.042401    0.013597    0.606386    125.220006 
[37m[36mINFO[0m[0m 02/11 04:02:13 | 0.766610    0.766629    0.991408    0.815545    0.699482    0.994851    0.802062    0.983677    0.788087    0.766610    0.766629    0.995697    0.856487    4800        88.980433   0.038246    0.013285    0.655866    119.264510 
[37m[36mINFO[0m[0m 02/11 04:06:20 | 0.756194    0.768884    0.992879    0.811187    0.716471    0.996395    0.795876    0.985109    0.788087    0.756194    0.768884    0.997131    0.849598    5000        92.687951   0.039389    0.013015    0.632136    120.670315 
[37m[36mINFO[0m[0m 02/11 04:06:20 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[2]/250211_02-19-35_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/11 04:06:22 | ---
[37m[36mINFO[0m[0m 02/11 04:06:22 | test-domain validation(oracle) = 77.280%
[37m[36mINFO[0m[0m 02/11 04:06:22 | training-domain validation(iid) = 77.449%
[37m[36mINFO[0m[0m 02/11 04:06:22 | last = 75.619%
[37m[36mINFO[0m[0m 02/11 04:06:22 | last (inD) = 81.119%
[37m[36mINFO[0m[0m 02/11 04:06:22 | training-domain validation (iid, inD) = 82.448%
[37m[36mINFO[0m[0m 02/11 04:06:22 | === Summary ===
[37m[36mINFO[0m[0m 02/11 04:06:22 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 2 --dataset OfficeHome --trial_seed 1 --hparams_seed 15
[37m[36mINFO[0m[0m 02/11 04:06:22 | Unique name: 250211_02-19-35_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 04:06:22 | Out path: train_output/OfficeHome/CORAL/[2]/250211_02-19-35_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 04:06:22 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/11 04:06:22 | Dataset: OfficeHome

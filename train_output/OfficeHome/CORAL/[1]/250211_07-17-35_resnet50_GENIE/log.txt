[37m[36mINFO[0m[0m 02/11 07:17:35 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 8
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 8
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[1]/250211_07-17-35_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250211_07-17-35_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.9932388835350315e-05
	batch_size: 16
	weight_decay: 0.0025315391809104006
	mmd_gamma: 0.16699877508053515
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/11 07:17:35 | n_steps = 5001
[37m[36mINFO[0m[0m 02/11 07:17:35 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/11 07:17:35 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/11 07:17:35 | 
[37m[36mINFO[0m[0m 02/11 07:17:35 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 02/11 07:17:35 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 02/11 07:17:35 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 02/11 07:17:35 | Batch sizes for each domain: [16, 0, 16, 16] (total=48)
[37m[36mINFO[0m[0m 02/11 07:17:35 | steps-per-epoch for each domain: 121.38, 222.00, 217.88 -> min = 121.38
[37m[36mINFO[0m[0m 02/11 07:17:36 | # of params = 23641217
[37m[36mINFO[0m[0m 02/11 07:19:47 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/11 07:19:47 | 0.021191    0.017182    0.020280    0.017784    4.214652    0.022142    0.012371    0.021191    0.017182    0.016610    0.019166    0.022088    0.021814    0           0.000000    4.296136    0.038169    1.209136    129.194827 
[37m[36mINFO[0m[0m 02/11 07:22:44 | 0.482818    0.476518    0.777763    0.756172    0.918019    0.736354    0.711340    0.482818    0.476518    0.804336    0.793687    0.792599    0.763490    200         1.647786    1.691009    0.473502    0.280391    121.362044 
[37m[36mINFO[0m[0m 02/11 07:25:47 | 0.486827    0.485682    0.847875    0.779260    0.802048    0.835736    0.713402    0.486827    0.485682    0.868243    0.822999    0.839644    0.801378    400         3.295572    0.657387    0.397035    0.296052    123.251823 
[37m[36mINFO[0m[0m 02/11 07:28:54 | 0.516323    0.502864    0.889973    0.806504    0.713643    0.889804    0.756701    0.516323    0.502864    0.901745    0.855693    0.878371    0.807118    600         4.943357    0.473883    0.362596    0.287167    129.476281 
[37m[36mINFO[0m[0m 02/11 07:31:57 | 0.515750    0.516609    0.901537    0.803643    0.742596    0.900103    0.740206    0.515750    0.516609    0.916385    0.862458    0.888124    0.808266    800         6.591143    0.370548    0.336820    0.272236    128.799719 
[37m[36mINFO[0m[0m 02/11 07:34:56 | 0.548683    0.522337    0.926180    0.817605    0.674259    0.931514    0.754639    0.548683    0.522337    0.928209    0.868095    0.918818    0.830080    1000        8.238929    0.294626    0.315100    0.288051    121.291441 
[37m[36mINFO[0m[0m 02/11 07:38:04 | 0.510882    0.491409    0.943853    0.815146    0.679428    0.957261    0.748454    0.510882    0.491409    0.942286    0.870349    0.932014    0.826636    1200        9.886715    0.239091    0.289829    0.329691    122.065681 
[37m[36mINFO[0m[0m 02/11 07:41:05 | 0.536655    0.539519    0.958309    0.816876    0.655986    0.969104    0.752577    0.536655    0.539519    0.959178    0.874859    0.946644    0.823192    1400        11.534501   0.189572    0.277337    0.279370    125.188097 
[37m[36mINFO[0m[0m 02/11 07:44:03 | 0.528351    0.528064    0.965165    0.825310    0.648131    0.976828    0.760825    0.528351    0.528064    0.962556    0.883878    0.956110    0.831228    1600        13.182286   0.162975    0.264661    0.272588    123.690983 
[37m[36mINFO[0m[0m 02/11 07:47:08 | 0.528064    0.504009    0.970635    0.832197    0.645975    0.983007    0.781443    0.528064    0.504009    0.967624    0.881623    0.961274    0.833525    1800        14.830072   0.135559    0.249371    0.281327    128.564287 
[37m[36mINFO[0m[0m 02/11 07:50:22 | 0.526060    0.498282    0.977815    0.828459    0.604993    0.983522    0.756701    0.526060    0.498282    0.978322    0.895152    0.971601    0.833525    2000        16.477858   0.101449    0.236076    0.295524    135.183580 
[37m[36mINFO[0m[0m 02/11 07:53:33 | 0.542096    0.520046    0.977996    0.843208    0.600150    0.980947    0.779381    0.542096    0.520046    0.980293    0.908681    0.972748    0.841561    2200        18.125644   0.095129    0.224455    0.269737    136.887253 
[37m[36mINFO[0m[0m 02/11 07:56:40 | 0.532073    0.513173    0.976816    0.826991    0.628772    0.985067    0.756701    0.532073    0.513173    0.975788    0.885006    0.969593    0.839265    2400        19.773429   0.096841    0.210562    0.296594    127.241432 
[37m[36mINFO[0m[0m 02/11 07:59:37 | 0.563860    0.545246    0.983425    0.841336    0.611020    0.991246    0.779381    0.563860    0.545246    0.982264    0.901917    0.976764    0.842710    2600        21.421215   0.091043    0.210716    0.277585    122.024741 
[37m[36mINFO[0m[0m 02/11 08:02:41 | 0.538087    0.547537    0.981406    0.831814    0.630585    0.989186    0.781443    0.538087    0.547537    0.981137    0.881623    0.973896    0.832377    2800        23.069001   0.075397    0.201188    0.295224    124.688461 
[37m[36mINFO[0m[0m 02/11 08:05:42 | 0.517755    0.515464    0.982406    0.840196    0.646776    0.985067    0.769072    0.517755    0.515464    0.983953    0.901917    0.978199    0.849598    3000        24.716787   0.073158    0.194927    0.275445    126.239844 
[37m[36mINFO[0m[0m 02/11 08:08:49 | 0.543528    0.523482    0.986356    0.829310    0.618007    0.994336    0.754639    0.543528    0.523482    0.983953    0.894025    0.980780    0.839265    3200        26.364573   0.074757    0.184888    0.282095    130.047682 
[37m[36mINFO[0m[0m 02/11 08:11:56 | 0.549828    0.532646    0.990045    0.848325    0.601751    0.994336    0.785567    0.549828    0.532646    0.990428    0.909808    0.985370    0.849598    3400        28.012358   0.051020    0.178358    0.277541    131.885062 
[37m[36mINFO[0m[0m 02/11 08:15:07 | 0.542096    0.524628    0.989167    0.832416    0.636769    0.992791    0.760825    0.542096    0.524628    0.987331    0.910936    0.987378    0.825488    3600        29.660144   0.054275    0.168186    0.278717    135.613528 
[37m[36mINFO[0m[0m 02/11 08:18:06 | 0.534651    0.523482    0.989479    0.838687    0.647564    0.991761    0.777320    0.534651    0.523482    0.989583    0.909808    0.987091    0.828932    3800        31.307930   0.052867    0.167166    0.276542    123.175757 
[37m[36mINFO[0m[0m 02/11 08:21:17 | 0.552692    0.539519    0.992819    0.845588    0.607697    0.993821    0.787629    0.552692    0.539519    0.993243    0.906426    0.991394    0.842710    4000        32.955716   0.051598    0.162618    0.316126    128.101798 
[37m[36mINFO[0m[0m 02/11 08:24:23 | 0.540951    0.538373    0.990748    0.851754    0.596287    0.993821    0.795876    0.540951    0.538373    0.988176    0.910936    0.990247    0.848450    4200        34.603502   0.046507    0.159744    0.318541    121.727938 
[37m[36mINFO[0m[0m 02/11 08:27:33 | 0.531787    0.513173    0.989955    0.831289    0.647899    0.991761    0.760825    0.531787    0.513173    0.989865    0.907554    0.988239    0.825488    4400        36.251287   0.053965    0.153072    0.311607    127.955644 
[37m[36mINFO[0m[0m 02/11 08:30:37 | 0.540951    0.536082    0.987753    0.832734    0.676551    0.989701    0.773196    0.540951    0.536082    0.987613    0.907554    0.985944    0.817451    4600        37.899073   0.064151    0.156547    0.336857    117.095127 
[37m[36mINFO[0m[0m 02/11 08:33:50 | 0.542096    0.552119    0.991121    0.831903    0.632672    0.993821    0.767010    0.542096    0.552119    0.989583    0.894025    0.989960    0.834673    4800        39.546859   0.052458    0.152871    0.295668    133.028647 
[37m[36mINFO[0m[0m 02/11 08:36:52 | 0.530641    0.528064    0.992649    0.832443    0.619439    0.995881    0.771134    0.530641    0.528064    0.992680    0.905299    0.989386    0.820896    5000        41.194645   0.051193    0.148384    0.293761    123.439330 
[37m[36mINFO[0m[0m 02/11 08:36:52 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[1]/250211_07-17-35_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/11 08:36:53 | ---
[37m[36mINFO[0m[0m 02/11 08:36:53 | test-domain validation(oracle) = 54.210%
[37m[36mINFO[0m[0m 02/11 08:36:53 | training-domain validation(iid) = 54.095%
[37m[36mINFO[0m[0m 02/11 08:36:53 | last = 53.064%
[37m[36mINFO[0m[0m 02/11 08:36:53 | last (inD) = 83.244%
[37m[36mINFO[0m[0m 02/11 08:36:53 | training-domain validation (iid, inD) = 85.175%
[37m[36mINFO[0m[0m 02/11 08:36:53 | === Summary ===
[37m[36mINFO[0m[0m 02/11 08:36:53 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 8
[37m[36mINFO[0m[0m 02/11 08:36:53 | Unique name: 250211_07-17-35_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 08:36:53 | Out path: train_output/OfficeHome/CORAL/[1]/250211_07-17-35_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 08:36:53 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/11 08:36:53 | Dataset: OfficeHome

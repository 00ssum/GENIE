[37m[36mINFO[0m[0m 02/11 02:59:04 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 5
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 5
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[1]/250211_02-59-04_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250211_02-59-04_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.6343540304927548e-05
	batch_size: 23
	weight_decay: 3.844578840738432e-05
	mmd_gamma: 0.6855754528884209
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/11 02:59:04 | n_steps = 5001
[37m[36mINFO[0m[0m 02/11 02:59:04 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/11 02:59:04 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/11 02:59:04 | 
[37m[36mINFO[0m[0m 02/11 02:59:04 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 02/11 02:59:04 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 02/11 02:59:04 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 02/11 02:59:04 | Batch sizes for each domain: [23, 0, 23, 23] (total=69)
[37m[36mINFO[0m[0m 02/11 02:59:04 | steps-per-epoch for each domain: 84.43, 154.43, 151.57 -> min = 84.43
[37m[36mINFO[0m[0m 02/11 02:59:05 | # of params = 23641217
[37m[36mINFO[0m[0m 02/11 03:01:11 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/11 03:01:11 | 0.014605    0.011455    0.016469    0.017208    4.218104    0.017508    0.018557    0.014605    0.011455    0.012106    0.012401    0.019793    0.020666    0           0.000000    4.254340    0.024932    1.285438    124.546582 
[37m[36mINFO[0m[0m 02/11 03:04:36 | 0.527491    0.497136    0.819406    0.794518    0.809842    0.791452    0.752577    0.527491    0.497136    0.843187    0.838782    0.823580    0.792193    200         2.368692    1.562646    0.192333    0.419807    120.414631 
[37m[36mINFO[0m[0m 02/11 03:08:05 | 0.500000    0.499427    0.886502    0.805418    0.695601    0.894954    0.756701    0.500000    0.499427    0.890484    0.845547    0.874068    0.814007    400         4.737384    0.548155    0.157000    0.413113    126.640060 
[37m[36mINFO[0m[0m 02/11 03:11:26 | 0.548396    0.546392    0.913698    0.820448    0.662865    0.911946    0.758763    0.548396    0.546392    0.918074    0.878241    0.911073    0.824340    600         7.106076    0.365305    0.136040    0.392531    122.556582 
[37m[36mINFO[0m[0m 02/11 03:14:53 | 0.520905    0.516609    0.940349    0.833452    0.604443    0.949022    0.769072    0.520905    0.516609    0.941160    0.878241    0.930866    0.853042    800         9.474768    0.253974    0.124152    0.422604    122.188297 
[37m[36mINFO[0m[0m 02/11 03:18:23 | 0.536942    0.517755    0.961445    0.836189    0.601763    0.974768    0.775258    0.536942    0.517755    0.958333    0.892897    0.951234    0.840413    1000        11.843460   0.197294    0.111539    0.403334    129.244432 
[37m[36mINFO[0m[0m 02/11 03:21:43 | 0.543242    0.532646    0.968368    0.845574    0.598224    0.976828    0.787629    0.543242    0.532646    0.970158    0.908681    0.958118    0.840413    1200        14.212152   0.154395    0.105099    0.377790    124.330775 
[37m[36mINFO[0m[0m 02/11 03:25:04 | 0.536082    0.523482    0.974516    0.837084    0.583130    0.983522    0.771134    0.536082    0.523482    0.970721    0.897407    0.969306    0.842710    1400        16.580844   0.128665    0.097278    0.393312    123.009090 
[37m[36mINFO[0m[0m 02/11 03:28:32 | 0.538946    0.518900    0.981339    0.849280    0.572402    0.988157    0.791753    0.538946    0.518900    0.982827    0.903044    0.973035    0.853042    1600        18.949537   0.098852    0.089011    0.389892    129.510687 
[37m[36mINFO[0m[0m 02/11 03:31:51 | 0.561856    0.552119    0.986465    0.853434    0.556656    0.991246    0.791753    0.561856    0.552119    0.985360    0.912063    0.982788    0.856487    1800        21.318229   0.083894    0.083385    0.386357    122.062039 
[37m[36mINFO[0m[0m 02/11 03:35:16 | 0.555556    0.542955    0.989131    0.845510    0.588398    0.993306    0.789691    0.555556    0.542955    0.989865    0.906426    0.984223    0.840413    2000        23.686921   0.071594    0.075555    0.412179    122.234021 
[37m[36mINFO[0m[0m 02/11 03:38:44 | 0.551260    0.522337    0.989055    0.840920    0.586925    0.992791    0.769072    0.551260    0.522337    0.989865    0.908681    0.984509    0.845006    2200        26.055613   0.060796    0.071974    0.374761    133.666627 
[37m[36mINFO[0m[0m 02/11 03:42:02 | 0.536082    0.528064    0.992231    0.853847    0.569198    0.994336    0.789691    0.536082    0.528064    0.992399    0.919955    0.989960    0.851894    2400        28.424305   0.056429    0.068876    0.383569    120.717830 
[37m[36mINFO[0m[0m 02/11 03:45:24 | 0.560137    0.539519    0.993078    0.845901    0.565181    0.994851    0.779381    0.560137    0.539519    0.991554    0.906426    0.992828    0.851894    2600        30.792997   0.048414    0.064976    0.419043    118.624970 
[37m[36mINFO[0m[0m 02/11 03:48:52 | 0.561283    0.533792    0.993221    0.849847    0.561115    0.993306    0.795876    0.561283    0.533792    0.993243    0.909808    0.993115    0.843858    2800        33.161689   0.044687    0.060821    0.407228    125.941320 
[37m[36mINFO[0m[0m 02/11 03:52:07 | 0.534937    0.517755    0.992996    0.852676    0.579392    0.994336    0.791753    0.534937    0.517755    0.992399    0.910936    0.992255    0.855339    3000        35.530381   0.041499    0.058329    0.380204    118.864719 
[37m[36mINFO[0m[0m 02/11 03:55:34 | 0.545533    0.523482    0.993489    0.838912    0.603577    0.993821    0.773196    0.545533    0.523482    0.993243    0.898534    0.993402    0.845006    3200        37.899073   0.038029    0.055854    0.422220    122.726096 
[37m[36mINFO[0m[0m 02/11 03:59:00 | 0.534364    0.525773    0.993097    0.844942    0.593180    0.994336    0.785567    0.534364    0.525773    0.991554    0.899662    0.993402    0.849598    3400        40.267765   0.035231    0.054410    0.384601    129.456988 
[37m[36mINFO[0m[0m 02/11 04:02:16 | 0.554983    0.534937    0.994326    0.851244    0.563065    0.994336    0.789691    0.554983    0.534937    0.993806    0.907554    0.994836    0.856487    3600        42.636457   0.030454    0.051878    0.391536    117.210556 
[37m[36mINFO[0m[0m 02/11 04:05:42 | 0.563001    0.544101    0.994987    0.849926    0.582092    0.994336    0.793814    0.563001    0.544101    0.995214    0.909808    0.995410    0.846154    3800        45.005149   0.029760    0.049444    0.416825    122.939274 
[37m[36mINFO[0m[0m 02/11 04:09:09 | 0.562428    0.539519    0.995075    0.855312    0.557834    0.994336    0.802062    0.562428    0.539519    0.996340    0.916573    0.994550    0.847302    4000        47.373841   0.026970    0.046944    0.395160    128.413098 
[37m[36mINFO[0m[0m 02/11 04:12:35 | 0.556987    0.550974    0.995519    0.846219    0.570032    0.995366    0.781443    0.556987    0.550974    0.995495    0.904171    0.995697    0.853042    4200        49.742533   0.026955    0.045548    0.410061    123.780673 
[37m[36mINFO[0m[0m 02/11 04:16:05 | 0.564147    0.536082    0.995298    0.854341    0.577089    0.996395    0.797938    0.564147    0.536082    0.994088    0.913191    0.995410    0.851894    4400        52.111226   0.029331    0.044679    0.424786    124.457735 
[37m[36mINFO[0m[0m 02/11 04:19:21 | 0.575601    0.557847    0.995579    0.853146    0.573403    0.996395    0.787629    0.575601    0.557847    0.994932    0.922210    0.995410    0.849598    4600        54.479918   0.026468    0.043932    0.369674    122.557522 
[37m[36mINFO[0m[0m 02/11 04:22:43 | 0.562142    0.518900    0.995424    0.844193    0.583704    0.995366    0.783505    0.562142    0.518900    0.995495    0.909808    0.995410    0.839265    4800        56.848610   0.025732    0.042291    0.393530    122.789207 
[37m[36mINFO[0m[0m 02/11 04:26:04 | 0.562428    0.540664    0.995976    0.857402    0.580389    0.995881    0.808247    0.562428    0.540664    0.995777    0.912063    0.996271    0.851894    5000        59.217302   0.023994    0.041792    0.412128    118.502028 
[37m[36mINFO[0m[0m 02/11 04:26:04 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[1]/250211_02-59-04_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/11 04:26:05 | ---
[37m[36mINFO[0m[0m 02/11 04:26:05 | test-domain validation(oracle) = 57.560%
[37m[36mINFO[0m[0m 02/11 04:26:05 | training-domain validation(iid) = 56.243%
[37m[36mINFO[0m[0m 02/11 04:26:05 | last = 56.243%
[37m[36mINFO[0m[0m 02/11 04:26:05 | last (inD) = 85.740%
[37m[36mINFO[0m[0m 02/11 04:26:05 | training-domain validation (iid, inD) = 85.740%
[37m[36mINFO[0m[0m 02/11 04:26:05 | === Summary ===
[37m[36mINFO[0m[0m 02/11 04:26:05 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 5
[37m[36mINFO[0m[0m 02/11 04:26:05 | Unique name: 250211_02-59-04_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 04:26:05 | Out path: train_output/OfficeHome/CORAL/[1]/250211_02-59-04_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 04:26:05 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/11 04:26:05 | Dataset: OfficeHome

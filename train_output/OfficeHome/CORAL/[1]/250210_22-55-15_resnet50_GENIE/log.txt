[37m[36mINFO[0m[0m 02/10 22:55:15 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 2
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 2
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[1]/250210_22-55-15_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250210_22-55-15_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.9041073434446342e-05
	batch_size: 9
	weight_decay: 0.0006566989842279891
	mmd_gamma: 1.5832433896458313
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/10 22:55:15 | n_steps = 5001
[37m[36mINFO[0m[0m 02/10 22:55:15 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/10 22:55:15 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/10 22:55:15 | 
[37m[36mINFO[0m[0m 02/10 22:55:15 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 02/10 22:55:15 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 02/10 22:55:15 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 02/10 22:55:15 | Batch sizes for each domain: [9, 0, 9, 9] (total=27)
[37m[36mINFO[0m[0m 02/10 22:55:15 | steps-per-epoch for each domain: 215.78, 394.67, 387.33 -> min = 215.78
[37m[36mINFO[0m[0m 02/10 22:55:17 | # of params = 23641217
[37m[36mINFO[0m[0m 02/10 22:57:22 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/10 22:57:22 | 0.020046    0.014891    0.033252    0.022794    4.210670    0.029866    0.020619    0.020046    0.014891    0.035755    0.024803    0.034137    0.022962    0           0.000000    4.262134    0.054578    1.360280    124.287875 
[37m[36mINFO[0m[0m 02/10 23:00:06 | 0.434994    0.444444    0.720480    0.703815    1.153459    0.658084    0.632990    0.434994    0.444444    0.762106    0.766629    0.741251    0.711825    200         0.926880    2.380638    0.131313    0.176445    127.977811 
[37m[36mINFO[0m[0m 02/10 23:02:48 | 0.481672    0.463918    0.787711    0.735955    0.970429    0.744593    0.670103    0.481672    0.463918    0.814752    0.788050    0.803787    0.749713    400         1.853759    0.982828    0.134664    0.194068    123.111645 
[37m[36mINFO[0m[0m 02/10 23:05:32 | 0.500573    0.495991    0.810538    0.766113    0.887395    0.784243    0.707216    0.500573    0.495991    0.837275    0.820744    0.810098    0.770379    600         2.780639    0.726264    0.112893    0.188172    126.699380 
[37m[36mINFO[0m[0m 02/10 23:08:12 | 0.494273    0.491409    0.846072    0.781832    0.818758    0.820803    0.725773    0.494273    0.491409    0.865146    0.826381    0.852266    0.793341    800         3.707518    0.633740    0.099859    0.182834    123.871642 
[37m[36mINFO[0m[0m 02/10 23:10:57 | 0.524341    0.526919    0.869320    0.789765    0.776504    0.859423    0.725773    0.524341    0.526919    0.887950    0.843292    0.860585    0.800230    1000        4.634398    0.527804    0.092581    0.205650    123.545408 
[37m[36mINFO[0m[0m 02/10 23:13:47 | 0.530928    0.504009    0.863766    0.778736    0.869277    0.855819    0.725773    0.530928    0.504009    0.880631    0.832018    0.854848    0.778416    1200        5.561277    0.497009    0.086111    0.219685    125.730149 
[37m[36mINFO[0m[0m 02/10 23:16:28 | 0.524914    0.515464    0.905047    0.805889    0.729873    0.909887    0.742268    0.524914    0.515464    0.907376    0.857948    0.897877    0.817451    1400        6.488157    0.391631    0.083092    0.176303    126.026063 
[37m[36mINFO[0m[0m 02/10 23:19:09 | 0.541237    0.521191    0.911343    0.796144    0.723773    0.917096    0.727835    0.541237    0.521191    0.926802    0.851184    0.890132    0.809414    1600        7.415036    0.325471    0.077430    0.193524    122.068626 
[37m[36mINFO[0m[0m 02/10 23:21:56 | 0.541523    0.531501    0.926680    0.816141    0.692327    0.931514    0.740206    0.541523    0.531501    0.940034    0.883878    0.908491    0.824340    1800        8.341916    0.317248    0.074004    0.179431    130.961370 
[37m[36mINFO[0m[0m 02/10 23:24:33 | 0.534651    0.515464    0.945644    0.824153    0.644742    0.957261    0.762887    0.534651    0.515464    0.946509    0.872604    0.933161    0.836969    2000        9.268795    0.253297    0.070136    0.196472    117.917325 
[37m[36mINFO[0m[0m 02/10 23:27:17 | 0.549255    0.541810    0.946535    0.817791    0.664570    0.953141    0.748454    0.549255    0.541810    0.951295    0.875986    0.935169    0.828932    2200        10.195675   0.224858    0.067891    0.195194    124.823346 
[37m[36mINFO[0m[0m 02/10 23:29:56 | 0.528923    0.544101    0.946807    0.816578    0.670364    0.956231    0.750515    0.528923    0.544101    0.950169    0.873732    0.934022    0.825488    2400        11.122554   0.232032    0.065522    0.184698    122.100689 
[37m[36mINFO[0m[0m 02/10 23:32:36 | 0.560710    0.561283    0.955991    0.827489    0.637765    0.968074    0.777320    0.560710    0.561283    0.953829    0.863585    0.946070    0.841561    2600        12.049434   0.183251    0.061452    0.212554    118.117187 
[37m[36mINFO[0m[0m 02/10 23:35:15 | 0.544387    0.552119    0.965066    0.826403    0.624805    0.974253    0.742268    0.544387    0.552119    0.963401    0.882751    0.957544    0.854191    2800        12.976313   0.187095    0.061425    0.181660    122.192064 
[37m[36mINFO[0m[0m 02/10 23:37:58 | 0.535510    0.515464    0.968706    0.825820    0.638499    0.977858    0.758763    0.535510    0.515464    0.971002    0.875986    0.957258    0.842710    3000        13.903193   0.164473    0.058505    0.178856    126.948076 
[37m[36mINFO[0m[0m 02/10 23:40:40 | 0.517182    0.518900    0.962259    0.817053    0.682364    0.975283    0.748454    0.517182    0.518900    0.962556    0.871477    0.948939    0.831228    3200        14.830072   0.138973    0.056590    0.203230    121.274462 
[37m[36mINFO[0m[0m 02/10 23:43:25 | 0.537228    0.526919    0.974297    0.829557    0.636870    0.981462    0.758763    0.537228    0.526919    0.972410    0.890643    0.969019    0.839265    3400        15.756952   0.133108    0.054592    0.180948    129.543762 
[37m[36mINFO[0m[0m 02/10 23:46:02 | 0.555556    0.533792    0.977658    0.836247    0.618605    0.988671    0.773196    0.555556    0.533792    0.972128    0.896280    0.972174    0.839265    3600        16.683831   0.102652    0.050815    0.170754    122.236790 
[37m[36mINFO[0m[0m 02/10 23:48:48 | 0.555556    0.532646    0.981779    0.837949    0.602475    0.987127    0.777320    0.555556    0.532646    0.980011    0.905299    0.978199    0.831228    3800        17.610711   0.094227    0.048922    0.214253    123.390265 
[37m[36mINFO[0m[0m 02/10 23:51:35 | 0.559565    0.534937    0.981832    0.832816    0.603867    0.986097    0.773196    0.559565    0.534937    0.977759    0.894025    0.981641    0.831228    4000        18.537590   0.087700    0.048568    0.187455    129.801625 
[37m[36mINFO[0m[0m 02/10 23:54:14 | 0.538660    0.526919    0.984429    0.833413    0.636376    0.989701    0.767010    0.538660    0.526919    0.983953    0.897407    0.979633    0.835821    4200        19.464470   0.092191    0.047145    0.207605    117.496286 
[37m[36mINFO[0m[0m 02/10 23:56:57 | 0.533792    0.536082    0.985346    0.834476    0.617355    0.990731    0.769072    0.533792    0.536082    0.983953    0.898534    0.981354    0.835821    4400        20.391349   0.094132    0.046310    0.196355    123.335108 
[37m[36mINFO[0m[0m 02/10 23:59:36 | 0.541810    0.539519    0.988315    0.836785    0.592898    0.992791    0.779381    0.541810    0.539519    0.985923    0.895152    0.986231    0.835821    4600        21.318229   0.079128    0.044517    0.188149    121.880441 
[37m[36mINFO[0m[0m 02/11 00:02:20 | 0.551260    0.542955    0.985596    0.853141    0.577474    0.989186    0.810309    0.551260    0.542955    0.983953    0.907554    0.983649    0.841561    4800        22.245108   0.068605    0.043390    0.192639    125.514561 
[37m[36mINFO[0m[0m 02/11 00:05:07 | 0.551546    0.547537    0.989611    0.847949    0.579455    0.993821    0.785567    0.551546    0.547537    0.986486    0.908681    0.988526    0.849598    5000        23.171988   0.065937    0.041367    0.199910    126.215724 
[37m[36mINFO[0m[0m 02/11 00:05:07 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[1]/250210_22-55-15_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/11 00:05:08 | ---
[37m[36mINFO[0m[0m 02/11 00:05:08 | test-domain validation(oracle) = 56.071%
[37m[36mINFO[0m[0m 02/11 00:05:08 | training-domain validation(iid) = 55.126%
[37m[36mINFO[0m[0m 02/11 00:05:08 | last = 55.155%
[37m[36mINFO[0m[0m 02/11 00:05:08 | last (inD) = 84.795%
[37m[36mINFO[0m[0m 02/11 00:05:08 | training-domain validation (iid, inD) = 85.314%
[37m[36mINFO[0m[0m 02/11 00:05:08 | === Summary ===
[37m[36mINFO[0m[0m 02/11 00:05:08 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 2
[37m[36mINFO[0m[0m 02/11 00:05:08 | Unique name: 250210_22-55-15_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 00:05:08 | Out path: train_output/OfficeHome/CORAL/[1]/250210_22-55-15_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 00:05:08 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/11 00:05:08 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 02/11 00:05:12 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 3
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 3
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[1]/250211_00-05-12_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250211_00-05-12_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 6.166705009429313e-05
	batch_size: 14
	weight_decay: 3.4412812120883604e-06
	mmd_gamma: 0.7404937726102715
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/11 00:05:12 | n_steps = 5001
[37m[36mINFO[0m[0m 02/11 00:05:12 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/11 00:05:12 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/11 00:05:12 | 
[37m[36mINFO[0m[0m 02/11 00:05:12 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 02/11 00:05:12 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 02/11 00:05:12 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 02/11 00:05:12 | Batch sizes for each domain: [14, 0, 14, 14] (total=42)
[37m[36mINFO[0m[0m 02/11 00:05:12 | steps-per-epoch for each domain: 138.71, 253.71, 249.00 -> min = 138.71
[37m[36mINFO[0m[0m 02/11 00:05:13 | # of params = 23641217
[37m[36mINFO[0m[0m 02/11 00:07:22 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/11 00:07:22 | 0.022623    0.020619    0.025577    0.024566    4.199387    0.027806    0.024742    0.022623    0.020619    0.021959    0.022548    0.026965    0.026406    0           0.000000    4.431740    0.147515    0.977591    127.710395 
[37m[36mINFO[0m[0m 02/11 00:10:17 | 0.469072    0.474227    0.735213    0.710493    1.124295    0.690010    0.651546    0.469072    0.474227    0.765484    0.748591    0.750143    0.731343    200         1.441813    2.579515    0.233135    0.272443    120.777517 
[37m[36mINFO[0m[0m 02/11 00:13:15 | 0.478236    0.477663    0.817231    0.776191    0.899551    0.797631    0.713402    0.478236    0.477663    0.832489    0.824126    0.821572    0.791045    400         2.883625    0.981160    0.269806    0.245410    128.505610 
[37m[36mINFO[0m[0m 02/11 00:16:05 | 0.531501    0.530355    0.852486    0.793228    0.772450    0.833677    0.746392    0.531501    0.530355    0.877252    0.837655    0.846529    0.795637    600         4.325438    0.740029    0.219207    0.255356    119.397763 
[37m[36mINFO[0m[0m 02/11 00:19:00 | 0.536655    0.541810    0.880075    0.795617    0.741468    0.875901    0.734021    0.536655    0.541810    0.887387    0.836528    0.876936    0.816303    800         5.767250    0.613397    0.191709    0.265521    121.531789 
[37m[36mINFO[0m[0m 02/11 00:21:46 | 0.512887    0.498282    0.885400    0.796000    0.754769    0.890834    0.734021    0.512887    0.498282    0.893018    0.836528    0.872347    0.817451    1000        7.209063    0.474527    0.180559    0.226823    121.082070 
[37m[36mINFO[0m[0m 02/11 00:24:45 | 0.524914    0.510882    0.918128    0.819517    0.681695    0.919156    0.764948    0.524914    0.510882    0.930180    0.866967    0.905049    0.826636    1200        8.650875    0.401310    0.168209    0.259121    127.159691 
[37m[36mINFO[0m[0m 02/11 00:27:35 | 0.502577    0.497136    0.920265    0.811388    0.701001    0.919670    0.748454    0.502577    0.497136    0.936937    0.859076    0.904188    0.826636    1400        10.092688   0.339475    0.150293    0.224800    124.262771 
[37m[36mINFO[0m[0m 02/11 00:30:28 | 0.560710    0.540664    0.935227    0.820638    0.662094    0.945932    0.764948    0.560710    0.540664    0.938063    0.871477    0.921687    0.825488    1600        11.534501   0.293539    0.141452    0.277933    117.470012 
[37m[36mINFO[0m[0m 02/11 00:33:26 | 0.532646    0.539519    0.949397    0.813872    0.681465    0.952626    0.750515    0.532646    0.539519    0.955518    0.878241    0.940046    0.812859    1800        12.976313   0.273210    0.136774    0.246845    128.475076 
[37m[36mINFO[0m[0m 02/11 00:36:19 | 0.561283    0.548683    0.958050    0.834304    0.635381    0.968074    0.775258    0.561283    0.548683    0.960867    0.888388    0.945209    0.839265    2000        14.418126   0.227103    0.130480    0.250324    123.233413 
[37m[36mINFO[0m[0m 02/11 00:39:23 | 0.542383    0.530355    0.961676    0.836083    0.620548    0.970649    0.787629    0.542383    0.530355    0.961712    0.896280    0.952668    0.824340    2200        15.859938   0.193489    0.121835    0.292696    125.510089 
[37m[36mINFO[0m[0m 02/11 00:42:20 | 0.556128    0.547537    0.971556    0.839930    0.621637    0.980947    0.787629    0.556128    0.547537    0.970439    0.892897    0.963282    0.839265    2400        17.301751   0.178547    0.115043    0.293118    118.420779 
[37m[36mINFO[0m[0m 02/11 00:45:23 | 0.553265    0.549828    0.967856    0.832939    0.608662    0.969619    0.758763    0.553265    0.549828    0.973536    0.900789    0.960413    0.839265    2600        18.743563   0.152282    0.110388    0.269416    129.431477 
[37m[36mINFO[0m[0m 02/11 00:48:19 | 0.576174    0.552119    0.978823    0.840300    0.604897    0.987642    0.777320    0.576174    0.552119    0.975507    0.896280    0.973322    0.847302    2800        20.185376   0.127534    0.104762    0.262304    123.261415 
[37m[36mINFO[0m[0m 02/11 00:51:18 | 0.566151    0.546392    0.977778    0.835171    0.610549    0.982492    0.760825    0.566151    0.546392    0.975225    0.898534    0.975617    0.846154    3000        21.627188   0.121161    0.101685    0.280570    122.804905 
[37m[36mINFO[0m[0m 02/11 00:54:15 | 0.576174    0.555556    0.979750    0.831221    0.636866    0.985067    0.775258    0.576174    0.555556    0.980574    0.891770    0.973609    0.826636    3200        23.069001   0.113300    0.097526    0.263371    124.104161 
[37m[36mINFO[0m[0m 02/11 00:57:15 | 0.547251    0.541810    0.981763    0.835255    0.636516    0.987642    0.769072    0.547251    0.541810    0.979448    0.896280    0.978199    0.840413    3400        24.510814   0.103880    0.095305    0.251156    130.237271 
[37m[36mINFO[0m[0m 02/11 01:00:14 | 0.562715    0.560137    0.989274    0.852539    0.583065    0.994851    0.806186    0.562715    0.560137    0.988176    0.906426    0.984796    0.845006    3600        25.952626   0.087357    0.088610    0.264354    125.698287 
[37m[36mINFO[0m[0m 02/11 01:03:11 | 0.558133    0.564719    0.987201    0.839875    0.606045    0.991761    0.787629    0.558133    0.564719    0.986768    0.901917    0.983075    0.830080    3800        27.394439   0.082154    0.087672    0.287256    119.262052 
[37m[36mINFO[0m[0m 02/11 01:06:07 | 0.558992    0.540664    0.986046    0.837018    0.634169    0.989701    0.783505    0.558992    0.540664    0.985360    0.894025    0.983075    0.833525    4000        28.836251   0.073268    0.084163    0.258440    124.805815 
[37m[36mINFO[0m[0m 02/11 01:09:06 | 0.582761    0.565865    0.987716    0.837984    0.636041    0.993821    0.767010    0.582761    0.565865    0.983671    0.900789    0.985657    0.846154    4200        30.278064   0.070004    0.081624    0.254300    128.359872 
[37m[36mINFO[0m[0m 02/11 01:11:59 | 0.564433    0.552119    0.990622    0.845985    0.596472    0.991761    0.787629    0.564433    0.552119    0.990146    0.904171    0.989960    0.846154    4400        31.719876   0.066074    0.078602    0.277916    116.698664 
[37m[36mINFO[0m[0m 02/11 01:14:56 | 0.552978    0.539519    0.990660    0.841220    0.633926    0.990731    0.793814    0.552978    0.539519    0.990428    0.894025    0.990820    0.835821    4600        33.161689   0.059622    0.076075    0.265666    124.200453 
[37m[36mINFO[0m[0m 02/11 01:17:48 | 0.551260    0.530355    0.991101    0.841116    0.644045    0.991761    0.775258    0.551260    0.530355    0.990146    0.900789    0.991394    0.847302    4800        34.603502   0.061770    0.074454    0.241757    124.123315 
[37m[36mINFO[0m[0m 02/11 01:20:42 | 0.562715    0.533792    0.991325    0.851336    0.602418    0.993306    0.787629    0.562715    0.533792    0.990709    0.905299    0.989960    0.861079    5000        36.045314   0.055546    0.072446    0.267699    120.155374 
[37m[36mINFO[0m[0m 02/11 01:20:42 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[1]/250211_00-05-12_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/11 01:20:44 | ---
[37m[36mINFO[0m[0m 02/11 01:20:44 | test-domain validation(oracle) = 58.276%
[37m[36mINFO[0m[0m 02/11 01:20:44 | training-domain validation(iid) = 56.271%
[37m[36mINFO[0m[0m 02/11 01:20:44 | last = 56.271%
[37m[36mINFO[0m[0m 02/11 01:20:44 | last (inD) = 85.134%
[37m[36mINFO[0m[0m 02/11 01:20:44 | training-domain validation (iid, inD) = 85.254%
[37m[36mINFO[0m[0m 02/11 01:20:44 | === Summary ===
[37m[36mINFO[0m[0m 02/11 01:20:44 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 3
[37m[36mINFO[0m[0m 02/11 01:20:44 | Unique name: 250211_00-05-12_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 01:20:44 | Out path: train_output/OfficeHome/CORAL/[1]/250211_00-05-12_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 01:20:44 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/11 01:20:44 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 02/10 20:55:58 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[1]/250210_20-55-58_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250210_20-55-58_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5.0781288859686544e-05
	batch_size: 44
	weight_decay: 0.00046410133598234803
	mmd_gamma: 1.1642706271054615
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/10 20:55:58 | n_steps = 5001
[37m[36mINFO[0m[0m 02/10 20:55:58 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/10 20:55:58 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/10 20:55:58 | 
[37m[36mINFO[0m[0m 02/10 20:55:58 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 02/10 20:55:58 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 02/10 20:55:58 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 02/10 20:55:58 | Batch sizes for each domain: [44, 0, 44, 44] (total=132)
[37m[36mINFO[0m[0m 02/10 20:55:58 | steps-per-epoch for each domain: 44.14, 80.73, 79.23 -> min = 44.14
[37m[36mINFO[0m[0m 02/10 20:56:00 | # of params = 23641217
[37m[36mINFO[0m[0m 02/10 20:58:07 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/10 20:58:07 | 0.012600    0.006873    0.016738    0.017123    4.216333    0.020082    0.020619    0.012600    0.006873    0.014640    0.013529    0.015491    0.017222    0           0.000000    4.256566    0.018730    1.563509    125.859635 
[37m[36mINFO[0m[0m 02/10 21:02:52 | 0.544674    0.523482    0.861866    0.816468    0.724209    0.831617    0.756701    0.544674    0.523482    0.888232    0.853439    0.865749    0.839265    200         4.531411    1.453563    0.127563    0.779015    128.804500 
[37m[36mINFO[0m[0m 02/10 21:07:36 | 0.538087    0.530355    0.914671    0.825274    0.644260    0.912461    0.762887    0.538087    0.530355    0.927365    0.877114    0.904188    0.835821    400         9.062822    0.458515    0.100577    0.772996    129.681121 
[37m[36mINFO[0m[0m 02/10 21:12:16 | 0.550401    0.533792    0.947193    0.831716    0.605674    0.958290    0.783505    0.550401    0.533792    0.952421    0.885006    0.930866    0.826636    600         13.594233   0.291453    0.085993    0.746331    130.445259 
[37m[36mINFO[0m[0m 02/10 21:16:56 | 0.565578    0.533792    0.961630    0.844857    0.584160    0.971679    0.787629    0.565578    0.533792    0.962838    0.900789    0.950373    0.846154    800         18.125644   0.201715    0.076198    0.763925    127.866930 
[37m[36mINFO[0m[0m 02/10 21:21:35 | 0.546964    0.524628    0.976132    0.850223    0.570424    0.988157    0.795876    0.546964    0.524628    0.974662    0.910936    0.965577    0.843858    1000        22.657055   0.147105    0.067371    0.752320    127.876135 
[37m[36mINFO[0m[0m 02/10 21:26:11 | 0.546964    0.520046    0.982692    0.842670    0.572079    0.990216    0.773196    0.546964    0.520046    0.983390    0.909808    0.974469    0.845006    1200        27.188465   0.114093    0.061112    0.746506    127.203734 
[37m[36mINFO[0m[0m 02/10 21:30:53 | 0.544674    0.516609    0.988260    0.859004    0.554530    0.993821    0.806186    0.544674    0.516609    0.988457    0.913191    0.982501    0.857635    1400        31.719876   0.089351    0.055114    0.779654    125.367234 
[37m[36mINFO[0m[0m 02/10 21:35:33 | 0.556987    0.534937    0.990997    0.855601    0.549311    0.994336    0.806186    0.556987    0.534937    0.990991    0.906426    0.987665    0.854191    1600        36.251287   0.070221    0.050654    0.787975    122.729305 
[37m[36mINFO[0m[0m 02/10 21:40:13 | 0.550115    0.530355    0.992524    0.853504    0.573329    0.994336    0.800000    0.550115    0.530355    0.991554    0.912063    0.991681    0.848450    1800        40.782698   0.058390    0.046539    0.764236    127.520144 
[37m[36mINFO[0m[0m 02/10 21:45:04 | 0.560997    0.541810    0.993644    0.858103    0.552711    0.994851    0.810309    0.560997    0.541810    0.992680    0.909808    0.993402    0.854191    2000        45.314109   0.052995    0.043820    0.809942    129.089885 
[37m[36mINFO[0m[0m 02/10 21:49:44 | 0.560137    0.529210    0.994363    0.853278    0.563165    0.995881    0.795876    0.560137    0.529210    0.993806    0.912063    0.993402    0.851894    2200        49.845520   0.048171    0.040753    0.737313    131.933511 
[37m[36mINFO[0m[0m 02/10 21:54:27 | 0.568156    0.542955    0.993676    0.855319    0.565676    0.993821    0.802062    0.568156    0.542955    0.993806    0.915445    0.993402    0.848450    2400        54.376931   0.041239    0.038465    0.744139    134.654351 
[37m[36mINFO[0m[0m 02/10 21:59:04 | 0.567010    0.547537    0.994933    0.854127    0.559982    0.995881    0.804124    0.567010    0.547537    0.994369    0.909808    0.994550    0.848450    2600        58.908342   0.036859    0.036031    0.756198    124.952863 
[37m[36mINFO[0m[0m 02/10 22:03:44 | 0.557847    0.526919    0.995220    0.857239    0.562000    0.995881    0.802062    0.557847    0.526919    0.994369    0.914318    0.995410    0.855339    2800        63.439753   0.037277    0.034620    0.754361    129.841245 
[37m[36mINFO[0m[0m 02/10 22:08:20 | 0.566724    0.544101    0.995765    0.854639    0.560663    0.996395    0.800000    0.566724    0.544101    0.995777    0.914318    0.995123    0.849598    3000        67.971164   0.031879    0.032535    0.754245    125.224618 
[37m[36mINFO[0m[0m 02/10 22:13:04 | 0.557274    0.524628    0.995068    0.850613    0.568547    0.994851    0.795876    0.557274    0.524628    0.994369    0.909808    0.995984    0.846154    3200        72.502575   0.031659    0.031360    0.788229    125.912023 
[37m[36mINFO[0m[0m 02/10 22:17:43 | 0.554696    0.529210    0.995606    0.852422    0.575374    0.995881    0.787629    0.554696    0.529210    0.993806    0.915445    0.997131    0.854191    3400        77.033986   0.029655    0.030151    0.767132    125.661279 
[37m[36mINFO[0m[0m 02/10 22:22:23 | 0.559851    0.542955    0.995974    0.854944    0.560487    0.995881    0.791753    0.559851    0.542955    0.996059    0.915445    0.995984    0.857635    3600        81.565396   0.026499    0.028803    0.764390    127.577854 
[37m[36mINFO[0m[0m 02/10 22:27:04 | 0.557274    0.536082    0.995535    0.851853    0.562227    0.994851    0.793814    0.557274    0.536082    0.996059    0.907554    0.995697    0.854191    3800        86.096807   0.025178    0.028064    0.745959    131.482344 
[37m[36mINFO[0m[0m 02/10 22:31:42 | 0.544960    0.532646    0.995095    0.854490    0.586249    0.993821    0.793814    0.544960    0.532646    0.996340    0.914318    0.995123    0.855339    4000        90.628218   0.025170    0.026737    0.742543    129.468095 
[37m[36mINFO[0m[0m 02/10 22:36:17 | 0.529782    0.499427    0.996514    0.856836    0.566055    0.996910    0.802062    0.529782    0.499427    0.995214    0.917700    0.997418    0.850746    4200        95.159629   0.022608    0.026140    0.757266    123.533448 
[37m[36mINFO[0m[0m 02/10 22:41:01 | 0.561283    0.548683    0.996449    0.854567    0.579446    0.995881    0.802062    0.561283    0.548683    0.996622    0.913191    0.996845    0.848450    4400        99.691040   0.022868    0.025432    0.788676    126.112873 
[37m[36mINFO[0m[0m 02/10 22:45:43 | 0.556987    0.534937    0.996259    0.855540    0.564601    0.995881    0.795876    0.556987    0.534937    0.996340    0.917700    0.996558    0.853042    4600        104.222451  0.022530    0.024688    0.771629    127.548055 
[37m[36mINFO[0m[0m 02/10 22:50:25 | 0.549542    0.532646    0.995965    0.853873    0.567128    0.995881    0.800000    0.549542    0.532646    0.997466    0.914318    0.994550    0.847302    4800        108.753862  0.022766    0.024135    0.792569    123.490550 
[37m[36mINFO[0m[0m 02/10 22:55:09 | 0.557560    0.532646    0.997285    0.856241    0.564600    0.996395    0.797938    0.557560    0.532646    0.997466    0.915445    0.997992    0.855339    5000        113.285273  0.020973    0.023414    0.786072    126.782344 
[37m[36mINFO[0m[0m 02/10 22:55:09 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[1]/250210_20-55-58_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/10 22:55:10 | ---
[37m[36mINFO[0m[0m 02/10 22:55:10 | test-domain validation(oracle) = 56.128%
[37m[36mINFO[0m[0m 02/10 22:55:10 | training-domain validation(iid) = 54.467%
[37m[36mINFO[0m[0m 02/10 22:55:10 | last = 55.756%
[37m[36mINFO[0m[0m 02/10 22:55:10 | last (inD) = 85.624%
[37m[36mINFO[0m[0m 02/10 22:55:10 | training-domain validation (iid, inD) = 85.900%
[37m[36mINFO[0m[0m 02/10 22:55:10 | === Summary ===
[37m[36mINFO[0m[0m 02/10 22:55:10 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 1
[37m[36mINFO[0m[0m 02/10 22:55:10 | Unique name: 250210_20-55-58_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 22:55:10 | Out path: train_output/OfficeHome/CORAL/[1]/250210_20-55-58_resnet50_GENIE
[37m[36mINFO[0m[0m 02/10 22:55:10 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/10 22:55:10 | Dataset: OfficeHome

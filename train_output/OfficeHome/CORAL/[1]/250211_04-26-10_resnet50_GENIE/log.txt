[37m[36mINFO[0m[0m 02/11 04:26:10 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 6
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 6
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[1]/250211_04-26-10_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250211_04-26-10_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.5764387170443743e-05
	batch_size: 19
	weight_decay: 0.0006024239579587198
	mmd_gamma: 0.6238365410759901
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/11 04:26:10 | n_steps = 5001
[37m[36mINFO[0m[0m 02/11 04:26:10 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/11 04:26:10 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/11 04:26:10 | 
[37m[36mINFO[0m[0m 02/11 04:26:10 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 02/11 04:26:10 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 02/11 04:26:10 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 02/11 04:26:10 | Batch sizes for each domain: [19, 0, 19, 19] (total=57)
[37m[36mINFO[0m[0m 02/11 04:26:10 | steps-per-epoch for each domain: 102.21, 186.95, 183.47 -> min = 102.21
[37m[36mINFO[0m[0m 02/11 04:26:11 | # of params = 23641217
[37m[36mINFO[0m[0m 02/11 04:28:19 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/11 04:28:19 | 0.018328    0.010309    0.016738    0.016345    4.220113    0.017508    0.010309    0.018328    0.010309    0.014921    0.016911    0.017785    0.021814    0           0.000000    4.268047    0.034416    1.077805    126.188980 
[37m[36mINFO[0m[0m 02/11 04:31:35 | 0.482532    0.482245    0.807120    0.773557    0.841160    0.771370    0.725773    0.482532    0.482245    0.835304    0.802706    0.814687    0.792193    200         1.956746    1.728594    0.227028    0.320323    131.890439 
[37m[36mINFO[0m[0m 02/11 04:34:44 | 0.517755    0.505155    0.862222    0.799487    0.752538    0.849125    0.742268    0.517755    0.505155    0.877815    0.841037    0.859725    0.815155    400         3.913491    0.641026    0.188414    0.324972    124.250814 
[37m[36mINFO[0m[0m 02/11 04:37:53 | 0.535223    0.532646    0.889627    0.806087    0.699078    0.888774    0.756701    0.535223    0.532646    0.902309    0.861330    0.877797    0.800230    600         5.870237    0.446897    0.162024    0.343527    120.783063 
[37m[36mINFO[0m[0m 02/11 04:41:07 | 0.503436    0.505155    0.922415    0.821546    0.646496    0.927909    0.760825    0.503436    0.505155    0.925394    0.873732    0.913941    0.830080    800         7.826982    0.337974    0.149660    0.334137    126.972054 
[37m[36mINFO[0m[0m 02/11 04:44:20 | 0.532073    0.514318    0.946375    0.823729    0.625898    0.949537    0.762887    0.532073    0.514318    0.952984    0.879369    0.936604    0.828932    1000        9.783728    0.256272    0.133975    0.360702    120.495584 
[37m[36mINFO[0m[0m 02/11 04:47:34 | 0.545819    0.533792    0.956845    0.833163    0.605131    0.964985    0.764948    0.545819    0.533792    0.958333    0.888388    0.947217    0.846154    1200        11.740474   0.208475    0.124608    0.343818    125.327053 
[37m[36mINFO[0m[0m 02/11 04:50:44 | 0.579897    0.556701    0.968966    0.841992    0.581416    0.979403    0.793814    0.579897    0.556701    0.965935    0.892897    0.961561    0.839265    1400        13.697219   0.172050    0.117636    0.337519    122.868331 
[37m[36mINFO[0m[0m 02/11 04:53:56 | 0.554410    0.529210    0.976662    0.844512    0.571711    0.984037    0.775258    0.554410    0.529210    0.976070    0.908681    0.969880    0.849598    1600        15.653965   0.138725    0.108063    0.322576    127.238888 
[37m[36mINFO[0m[0m 02/11 04:56:56 | 0.545819    0.532646    0.978747    0.838458    0.584508    0.989186    0.775258    0.545819    0.532646    0.978322    0.897407    0.968732    0.842710    1800        17.610711   0.115041    0.100568    0.306208    118.862942 
[37m[36mINFO[0m[0m 02/11 05:00:05 | 0.571879    0.548683    0.984602    0.837021    0.595252    0.992791    0.771134    0.571879    0.548683    0.983390    0.907554    0.977625    0.832377    2000        19.567456   0.095078    0.096148    0.327767    123.154928 
[37m[36mINFO[0m[0m 02/11 05:03:15 | 0.550974    0.529210    0.985957    0.838963    0.581150    0.992276    0.771134    0.550974    0.529210    0.983953    0.903044    0.981641    0.842710    2200        21.524202   0.086965    0.089346    0.338714    122.855165 
[37m[36mINFO[0m[0m 02/11 05:06:26 | 0.558992    0.529210    0.990703    0.851081    0.562982    0.994851    0.793814    0.558992    0.529210    0.989020    0.908681    0.988239    0.850746    2400        23.480947   0.070047    0.083332    0.356689    119.075106 
[37m[36mINFO[0m[0m 02/11 05:09:40 | 0.554696    0.534937    0.990138    0.839876    0.578737    0.994851    0.777320    0.554696    0.534937    0.987613    0.903044    0.987952    0.839265    2600        25.437693   0.061095    0.080588    0.344920    124.739915 
[37m[36mINFO[0m[0m 02/11 05:12:53 | 0.540092    0.522337    0.989666    0.839876    0.594025    0.991761    0.777320    0.540092    0.522337    0.990146    0.903044    0.987091    0.839265    2800        27.394439   0.056624    0.076740    0.310277    130.918516 
[37m[36mINFO[0m[0m 02/11 05:16:03 | 0.558419    0.528064    0.991652    0.837432    0.600048    0.994851    0.771134    0.558419    0.528064    0.990146    0.903044    0.989960    0.838117    3000        29.351184   0.054922    0.073483    0.322923    125.711448 
[37m[36mINFO[0m[0m 02/11 05:19:14 | 0.542669    0.522337    0.993244    0.849926    0.577274    0.995366    0.793814    0.542669    0.522337    0.992399    0.909808    0.991968    0.846154    3200        31.307930   0.046346    0.069106    0.336738    123.827698 
[37m[36mINFO[0m[0m 02/11 05:22:25 | 0.543242    0.529210    0.989610    0.847078    0.616051    0.991246    0.787629    0.543242    0.529210    0.987050    0.913191    0.990534    0.840413    3400        33.264676   0.047192    0.069136    0.336528    123.457136 
[37m[36mINFO[0m[0m 02/11 05:25:37 | 0.554124    0.529210    0.994298    0.849670    0.576604    0.994851    0.800000    0.554124    0.529210    0.995214    0.913191    0.992828    0.835821    3600        35.221421   0.041451    0.063925    0.336445    124.848104 
[37m[36mINFO[0m[0m 02/11 05:28:49 | 0.558133    0.520046    0.995404    0.846455    0.572029    0.995881    0.783505    0.558133    0.520046    0.995495    0.915445    0.994836    0.840413    3800        37.178167   0.040468    0.063164    0.341212    123.991652 
[37m[36mINFO[0m[0m 02/11 05:32:04 | 0.556701    0.531501    0.994119    0.852654    0.576097    0.994851    0.802062    0.556701    0.531501    0.993243    0.913191    0.994263    0.842710    4000        39.134912   0.039615    0.059775    0.350979    125.050829 
[37m[36mINFO[0m[0m 02/11 05:35:23 | 0.561283    0.537228    0.995137    0.852576    0.563976    0.995366    0.804124    0.561283    0.537228    0.995495    0.913191    0.994550    0.840413    4200        41.091658   0.035266    0.057438    0.338626    130.730137 
[37m[36mINFO[0m[0m 02/11 05:38:36 | 0.560997    0.525773    0.994416    0.853355    0.549478    0.994336    0.804124    0.560997    0.525773    0.994651    0.910936    0.994263    0.845006    4400        43.048404   0.030360    0.055218    0.319243    128.930968 
[37m[36mINFO[0m[0m 02/11 05:41:46 | 0.561283    0.554410    0.992440    0.848260    0.581812    0.994336    0.787629    0.561283    0.554410    0.989583    0.907554    0.993402    0.849598    4600        45.005149   0.034286    0.054434    0.324746    125.469810 
[37m[36mINFO[0m[0m 02/11 05:44:55 | 0.558992    0.517755    0.995601    0.854910    0.575026    0.995881    0.791753    0.558992    0.517755    0.994651    0.921082    0.996271    0.851894    4800        46.961895   0.030501    0.054130    0.349600    119.360128 
[37m[36mINFO[0m[0m 02/11 05:48:10 | 0.565292    0.544101    0.995994    0.847020    0.574337    0.995366    0.789691    0.565292    0.544101    0.996059    0.909808    0.996558    0.841561    5000        48.918641   0.026396    0.050780    0.371026    120.526426 
[37m[36mINFO[0m[0m 02/11 05:48:10 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[1]/250211_04-26-10_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/11 05:48:12 | ---
[37m[36mINFO[0m[0m 02/11 05:48:12 | test-domain validation(oracle) = 57.990%
[37m[36mINFO[0m[0m 02/11 05:48:12 | training-domain validation(iid) = 55.899%
[37m[36mINFO[0m[0m 02/11 05:48:12 | last = 56.529%
[37m[36mINFO[0m[0m 02/11 05:48:12 | last (inD) = 84.702%
[37m[36mINFO[0m[0m 02/11 05:48:12 | training-domain validation (iid, inD) = 85.491%
[37m[36mINFO[0m[0m 02/11 05:48:12 | === Summary ===
[37m[36mINFO[0m[0m 02/11 05:48:12 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 6
[37m[36mINFO[0m[0m 02/11 05:48:12 | Unique name: 250211_04-26-10_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 05:48:12 | Out path: train_output/OfficeHome/CORAL/[1]/250211_04-26-10_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 05:48:12 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/11 05:48:12 | Dataset: OfficeHome

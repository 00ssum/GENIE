[37m[36mINFO[0m[0m 02/11 05:48:16 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 7
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 7
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[1]/250211_05-48-16_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250211_05-48-16_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.6632780446310692e-05
	batch_size: 24
	weight_decay: 5.717289389191427e-06
	mmd_gamma: 3.812683559377669
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/11 05:48:16 | n_steps = 5001
[37m[36mINFO[0m[0m 02/11 05:48:16 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/11 05:48:16 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/11 05:48:16 | 
[37m[36mINFO[0m[0m 02/11 05:48:16 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 02/11 05:48:16 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 02/11 05:48:16 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 02/11 05:48:16 | Batch sizes for each domain: [24, 0, 24, 24] (total=72)
[37m[36mINFO[0m[0m 02/11 05:48:16 | steps-per-epoch for each domain: 80.92, 148.00, 145.25 -> min = 80.92
[37m[36mINFO[0m[0m 02/11 05:48:17 | # of params = 23641217
[37m[36mINFO[0m[0m 02/11 05:50:24 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/11 05:50:24 | 0.012600    0.009164    0.016340    0.018945    4.215812    0.015448    0.022680    0.012600    0.009164    0.014640    0.015784    0.018933    0.018370    0           0.000000    4.235385    0.023867    0.992537    126.361048 
[37m[36mINFO[0m[0m 02/11 05:53:52 | 0.512887    0.494845    0.794650    0.762618    0.956640    0.752317    0.709278    0.512887    0.494845    0.820101    0.816234    0.811532    0.762342    200         2.471679    1.946993    0.063114    0.427359    121.801569 
[37m[36mINFO[0m[0m 02/11 05:57:29 | 0.531214    0.520046    0.866307    0.798595    0.750928    0.853244    0.744330    0.531214    0.520046    0.887387    0.848929    0.858290    0.802526    400         4.943357    0.658196    0.055741    0.455594    126.458817 
[37m[36mINFO[0m[0m 02/11 06:00:59 | 0.559565    0.558992    0.892191    0.808458    0.714842    0.893409    0.767010    0.559565    0.558992    0.907376    0.847802    0.875789    0.810563    600         7.415036    0.449033    0.046148    0.428516    124.351049 
[37m[36mINFO[0m[0m 02/11 06:04:30 | 0.547824    0.542955    0.937143    0.822490    0.646824    0.945417    0.754639    0.547824    0.542955    0.940597    0.882751    0.925416    0.830080    800         9.886715    0.346300    0.040481    0.429602    125.002488 
[37m[36mINFO[0m[0m 02/11 06:08:00 | 0.548396    0.534937    0.950945    0.834761    0.618787    0.965499    0.785567    0.548396    0.534937    0.950732    0.874859    0.936604    0.843858    1000        12.358393   0.263819    0.037249    0.427825    124.127073 
[37m[36mINFO[0m[0m 02/11 06:11:30 | 0.546392    0.530355    0.960615    0.829479    0.624985    0.973223    0.760825    0.546392    0.530355    0.962838    0.890643    0.945783    0.836969    1200        14.830072   0.212057    0.034331    0.446509    120.582132 
[37m[36mINFO[0m[0m 02/11 06:14:56 | 0.539805    0.549828    0.971159    0.837628    0.597523    0.981462    0.777320    0.539805    0.549828    0.969595    0.895152    0.962421    0.840413    1400        17.301751   0.170125    0.031846    0.433430    119.567594 
[37m[36mINFO[0m[0m 02/11 06:18:27 | 0.543242    0.541810    0.974387    0.837005    0.610868    0.984037    0.773196    0.543242    0.541810    0.972973    0.897407    0.966150    0.840413    1600        19.773429   0.148384    0.029616    0.438451    123.270039 
[37m[36mINFO[0m[0m 02/11 06:22:02 | 0.564719    0.526919    0.983844    0.838075    0.576801    0.992791    0.775258    0.564719    0.526919    0.982264    0.897407    0.976477    0.841561    1800        22.245108   0.115814    0.027505    0.421619    130.453585 
[37m[36mINFO[0m[0m 02/11 06:25:30 | 0.542955    0.524628    0.986068    0.840097    0.597900    0.991761    0.771134    0.542955    0.524628    0.984516    0.905299    0.981928    0.843858    2000        24.716787   0.103482    0.025324    0.431384    121.732605 
[37m[36mINFO[0m[0m 02/11 06:29:00 | 0.554124    0.547537    0.988446    0.840384    0.575630    0.991761    0.785567    0.554124    0.547537    0.986486    0.894025    0.987091    0.841561    2200        27.188465   0.084150    0.023878    0.439891    122.592866 
[37m[36mINFO[0m[0m 02/11 06:32:35 | 0.556701    0.544101    0.988712    0.852716    0.579781    0.991761    0.802062    0.556701    0.544101    0.989865    0.903044    0.984509    0.853042    2400        29.660144   0.076537    0.022817    0.463586    121.884921 
[37m[36mINFO[0m[0m 02/11 06:36:02 | 0.544387    0.532646    0.991336    0.846801    0.586595    0.992791    0.785567    0.544387    0.532646    0.992117    0.908681    0.989099    0.846154    2600        32.131823   0.065421    0.021459    0.428545    120.940285 
[37m[36mINFO[0m[0m 02/11 06:39:31 | 0.558419    0.537228    0.992662    0.841618    0.589479    0.992791    0.783505    0.558419    0.537228    0.994088    0.892897    0.991107    0.848450    2800        34.603502   0.059173    0.020363    0.423041    125.232879 
[37m[36mINFO[0m[0m 02/11 06:42:59 | 0.545246    0.536082    0.993773    0.845659    0.583094    0.996395    0.785567    0.545246    0.536082    0.993243    0.907554    0.991681    0.843858    3000        37.075180   0.057779    0.019769    0.427367    121.803923 
[37m[36mINFO[0m[0m 02/11 06:46:25 | 0.549542    0.538373    0.993062    0.846905    0.566981    0.995366    0.793814    0.549542    0.538373    0.990991    0.903044    0.992828    0.843858    3200        39.546859   0.048182    0.018705    0.451433    116.104847 
[37m[36mINFO[0m[0m 02/11 06:49:50 | 0.560710    0.547537    0.994742    0.851138    0.581444    0.995881    0.791753    0.560710    0.547537    0.994369    0.912063    0.993976    0.849598    3400        42.018538   0.045125    0.017995    0.413275    122.505742 
[37m[36mINFO[0m[0m 02/11 06:53:19 | 0.567010    0.555556    0.994347    0.850059    0.578452    0.996395    0.791753    0.567010    0.555556    0.993243    0.900789    0.993402    0.857635    3600        44.490216   0.044989    0.017242    0.448037    118.687856 
[37m[36mINFO[0m[0m 02/11 06:56:48 | 0.556701    0.554410    0.994469    0.848128    0.598201    0.995881    0.804124    0.556701    0.554410    0.992117    0.889515    0.995410    0.850746    3800        46.961895   0.043470    0.016896    0.457475    118.261023 
[37m[36mINFO[0m[0m 02/11 07:00:20 | 0.551833    0.540664    0.995314    0.848311    0.582460    0.995881    0.785567    0.551833    0.540664    0.994651    0.912063    0.995410    0.847302    4000        49.433574   0.040317    0.016213    0.453360    120.991390 
[37m[36mINFO[0m[0m 02/11 07:03:50 | 0.553551    0.538373    0.995422    0.847715    0.590340    0.995366    0.781443    0.553551    0.538373    0.995777    0.909808    0.995123    0.851894    4200        51.905252   0.041702    0.015688    0.425716    125.141437 
[37m[36mINFO[0m[0m 02/11 07:07:12 | 0.555556    0.553265    0.996059    0.848396    0.589951    0.996395    0.783505    0.555556    0.553265    0.994651    0.910936    0.997131    0.850746    4400        54.376931   0.039946    0.015399    0.402403    121.614232 
[37m[36mINFO[0m[0m 02/11 07:10:38 | 0.563860    0.532646    0.994556    0.848819    0.569337    0.995881    0.793814    0.563860    0.532646    0.993525    0.903044    0.994263    0.849598    4600        56.848610   0.034291    0.014677    0.431126    118.960845 
[37m[36mINFO[0m[0m 02/11 07:14:06 | 0.566724    0.557847    0.995944    0.849486    0.582603    0.996910    0.785567    0.566724    0.557847    0.994651    0.907554    0.996271    0.855339    4800        59.320288   0.032776    0.014263    0.450095    117.903703 
[37m[36mINFO[0m[0m 02/11 07:17:30 | 0.555269    0.550974    0.995728    0.844711    0.601896    0.994851    0.779381    0.555269    0.550974    0.995777    0.913191    0.996558    0.841561    5000        61.791967   0.033434    0.014001    0.418929    120.251284 
[37m[36mINFO[0m[0m 02/11 07:17:30 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[1]/250211_05-48-16_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/11 07:17:31 | ---
[37m[36mINFO[0m[0m 02/11 07:17:31 | test-domain validation(oracle) = 55.956%
[37m[36mINFO[0m[0m 02/11 07:17:31 | training-domain validation(iid) = 55.670%
[37m[36mINFO[0m[0m 02/11 07:17:31 | last = 55.527%
[37m[36mINFO[0m[0m 02/11 07:17:31 | last (inD) = 84.471%
[37m[36mINFO[0m[0m 02/11 07:17:31 | training-domain validation (iid, inD) = 85.272%
[37m[36mINFO[0m[0m 02/11 07:17:31 | === Summary ===
[37m[36mINFO[0m[0m 02/11 07:17:31 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 7
[37m[36mINFO[0m[0m 02/11 07:17:31 | Unique name: 250211_05-48-16_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 07:17:31 | Out path: train_output/OfficeHome/CORAL/[1]/250211_05-48-16_resnet50_GENIE
[37m[36mINFO[0m[0m 02/11 07:17:31 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/11 07:17:31 | Dataset: OfficeHome

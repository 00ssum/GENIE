[37m[36mINFO[0m[0m 01/26 16:30:45 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 18
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 18
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/OfficeHome/CORAL/[1]/250126_16-30-45_resnet50_EVE
	out_root: train_output/OfficeHome/CORAL/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250126_16-30-45_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: GENIE
	freeze_bn: False
	pretrained: True
	lr: 0.00021894640154701087
	batch_size: 13
	weight_decay: 7.1565884139944e-05
	mmd_gamma: 0.48667511803994756
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 01/26 16:30:45 | n_steps = 5001
[37m[36mINFO[0m[0m 01/26 16:30:45 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/26 16:30:45 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/26 16:30:45 | Target test envs = [[1]]
[37m[36mINFO[0m[0m 01/26 16:30:45 | 
[37m[36mINFO[0m[0m 01/26 16:30:45 | Testenv name escaping te_C -> te_C
[37m[36mINFO[0m[0m 01/26 16:30:45 | Test envs = [1], name = te_C
[37m[36mINFO[0m[0m 01/26 16:30:45 | Batch sizes for each domain: [13, 0, 13, 13] (total=39)
[37m[36mINFO[0m[0m 01/26 16:30:45 | steps-per-epoch for each domain: 149.38, 273.23, 268.15 -> min = 149.38
[37m[36mINFO[0m[0m 01/26 16:30:47 | # of params = 23641217
[37m[36mINFO[0m[0m 01/26 16:32:47 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 01/26 16:32:47 | 0.024628    0.021764    0.022506    0.019073    4.214283    0.020597    0.018557    0.024628    0.021764    0.021678    0.020293    0.025244    0.018370    0           0.000000    4.343720    0.046338    1.309177    118.991045 
[37m[36mINFO[0m[0m 01/26 16:35:39 | 0.501432    0.479954    0.767526    0.730391    0.983117    0.723481    0.647423    0.501432    0.479954    0.807151    0.774521    0.771945    0.769231    200         1.338826    1.887348    0.282279    0.262918    119.142176 
[37m[36mINFO[0m[0m 01/26 16:38:30 | 0.489691    0.493700    0.831112    0.765292    0.847720    0.803296    0.688660    0.489691    0.493700    0.856419    0.819617    0.833620    0.787600    400         2.677652    0.757747    0.243027    0.239369    122.304738 
[37m[36mINFO[0m[0m 01/26 16:41:19 | 0.498282    0.502864    0.870064    0.797018    0.735416    0.862513    0.748454    0.498282    0.502864    0.887669    0.830891    0.860011    0.811711    600         4.016478    0.580263    0.211523    0.241775    120.403863 
[37m[36mINFO[0m[0m 01/26 16:44:09 | 0.525487    0.526919    0.886777    0.803180    0.721450    0.884655    0.744330    0.525487    0.526919    0.893863    0.850056    0.881813    0.815155    800         5.355304    0.464228    0.189683    0.251279    119.909972 
[37m[36mINFO[0m[0m 01/26 16:46:57 | 0.546105    0.526919    0.913778    0.810051    0.680005    0.915551    0.742268    0.546105    0.526919    0.929054    0.865840    0.896730    0.822044    1000        6.694130    0.350810    0.179765    0.263491    114.388526 
[37m[36mINFO[0m[0m 01/26 16:49:41 | 0.523482    0.508591    0.935868    0.810794    0.697456    0.949022    0.752577    0.523482    0.508591    0.939189    0.868095    0.919392    0.811711    1200        8.032956    0.300018    0.168702    0.243295    115.083149 
[37m[36mINFO[0m[0m 01/26 16:52:23 | 0.542669    0.532646    0.950985    0.828358    0.633325    0.961380    0.760825    0.542669    0.532646    0.954110    0.886133    0.937464    0.838117    1400        9.371782    0.236407    0.160787    0.239668    114.513094 
[37m[36mINFO[0m[0m 01/26 16:55:16 | 0.523196    0.504009    0.948110    0.816829    0.685994    0.960350    0.742268    0.523196    0.504009    0.946227    0.883878    0.937751    0.824340    1600        10.710608   0.208551    0.149127    0.243480    123.272195 
[37m[36mINFO[0m[0m 01/26 16:58:05 | 0.564719    0.544101    0.961741    0.831159    0.644374    0.973738    0.756701    0.564719    0.544101    0.963119    0.891770    0.948365    0.845006    1800        12.049434   0.175120    0.141367    0.269428    115.806179 
[37m[36mINFO[0m[0m 01/26 17:00:54 | 0.564433    0.553265    0.962239    0.825422    0.639024    0.973223    0.769072    0.564433    0.553265    0.963119    0.877114    0.950373    0.830080    2000        13.388260   0.146688    0.130125    0.242553    119.524450 
[37m[36mINFO[0m[0m 01/26 17:03:35 | 0.558706    0.530355    0.967371    0.818408    0.658699    0.976313    0.742268    0.558706    0.530355    0.964527    0.875986    0.961274    0.836969    2200        14.727085   0.139519    0.125968    0.238287    113.654480 
[37m[36mINFO[0m[0m 01/26 17:06:21 | 0.521478    0.502864    0.976057    0.833921    0.638130    0.983007    0.775258    0.521478    0.502864    0.972128    0.888388    0.973035    0.838117    2400        16.065911   0.111743    0.118785    0.243039    117.118113 
[37m[36mINFO[0m[0m 01/26 17:09:13 | 0.566151    0.537228    0.983181    0.838600    0.633845    0.988157    0.781443    0.566151    0.537228    0.978885    0.898534    0.982501    0.835821    2600        17.404737   0.097592    0.115401    0.266479    118.633434 
[37m[36mINFO[0m[0m 01/26 17:11:57 | 0.547824    0.545246    0.982572    0.841611    0.609412    0.988671    0.783505    0.547824    0.545246    0.981419    0.894025    0.977625    0.847302    2800        18.743563   0.082433    0.107119    0.239578    115.776567 
[37m[36mINFO[0m[0m 01/26 17:14:42 | 0.533219    0.521191    0.983521    0.840097    0.613349    0.988671    0.771134    0.533219    0.521191    0.982545    0.905299    0.979346    0.843858    3000        20.082389   0.076988    0.101953    0.239367    116.738096 
[37m[36mINFO[0m[0m 01/26 17:17:30 | 0.562142    0.550974    0.989212    0.847410    0.573045    0.993821    0.789691    0.562142    0.550974    0.989020    0.908681    0.984796    0.843858    3200        21.421215   0.076253    0.099280    0.256126    117.375128 
[37m[36mINFO[0m[0m 01/26 17:20:22 | 0.555842    0.525773    0.988308    0.835100    0.618440    0.992791    0.762887    0.555842    0.525773    0.987050    0.897407    0.985083    0.845006    3400        22.760041   0.060155    0.096785    0.280348    115.262672 
[37m[36mINFO[0m[0m 01/26 17:23:06 | 0.569874    0.514318    0.990507    0.848410    0.589938    0.992276    0.783505    0.569874    0.514318    0.990146    0.908681    0.989099    0.853042    3600        24.098867   0.058236    0.089281    0.234266    117.040562 
[37m[36mINFO[0m[0m 01/26 17:25:51 | 0.574742    0.553265    0.990622    0.844116    0.582554    0.991761    0.775258    0.574742    0.553265    0.990146    0.910936    0.989960    0.846154    3800        25.437693   0.062311    0.091013    0.240874    116.576317 
[37m[36mINFO[0m[0m 01/26 17:28:41 | 0.569015    0.560137    0.991828    0.844355    0.597531    0.994851    0.789691    0.569015    0.560137    0.992680    0.907554    0.987952    0.835821    4000        26.776519   0.051557    0.088105    0.262493    117.038259 
[37m[36mINFO[0m[0m 01/26 17:31:26 | 0.565578    0.540664    0.993371    0.843824    0.586762    0.997425    0.783505    0.565578    0.540664    0.990146    0.907554    0.992542    0.840413    4200        28.115345   0.048745    0.084160    0.261146    113.096062 
[37m[36mINFO[0m[0m 01/26 17:34:08 | 0.566151    0.549828    0.991688    0.841945    0.586911    0.993821    0.783505    0.566151    0.549828    0.990709    0.901917    0.990534    0.840413    4400        29.454171   0.038364    0.078500    0.239656    114.490113 
[37m[36mINFO[0m[0m 01/26 17:36:52 | 0.556701    0.536082    0.991973    0.841131    0.601873    0.993821    0.783505    0.556701    0.536082    0.990991    0.909808    0.991107    0.830080    4600        30.792997   0.038891    0.077678    0.240549    115.159852 
[37m[36mINFO[0m[0m 01/26 17:39:32 | 0.555269    0.540664    0.993198    0.845128    0.611633    0.993821    0.779381    0.555269    0.540664    0.993806    0.907554    0.991968    0.848450    4800        32.131823   0.044310    0.075107    0.233788    113.659240 
[37m[36mINFO[0m[0m 01/26 17:42:13 | 0.556128    0.533792    0.993000    0.844312    0.599422    0.994336    0.781443    0.556128    0.533792    0.991836    0.903044    0.992828    0.848450    5000        33.470649   0.044018    0.075018    0.235869    113.762395 
[37m[36mINFO[0m[0m 01/26 17:42:13 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[1]/250126_16-30-45_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/26 17:42:15 | ---
[37m[36mINFO[0m[0m 01/26 17:42:15 | test-domain validation(oracle) = 56.901%
[37m[36mINFO[0m[0m 01/26 17:42:15 | training-domain validation(iid) = 56.987%
[37m[36mINFO[0m[0m 01/26 17:42:15 | last = 55.613%
[37m[36mINFO[0m[0m 01/26 17:42:15 | last (inD) = 84.431%
[37m[36mINFO[0m[0m 01/26 17:42:15 | training-domain validation (iid, inD) = 84.841%
[37m[36mINFO[0m[0m 01/26 17:42:15 | === Summary ===
[37m[36mINFO[0m[0m 01/26 17:42:15 | Command: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 1 --dataset OfficeHome --trial_seed 0 --hparams_seed 18
[37m[36mINFO[0m[0m 01/26 17:42:15 | Unique name: 250126_16-30-45_resnet50_EVE
[37m[36mINFO[0m[0m 01/26 17:42:15 | Out path: train_output/OfficeHome/CORAL/[1]/250126_16-30-45_resnet50_EVE
[37m[36mINFO[0m[0m 01/26 17:42:15 | Algorithm: CORAL
[37m[36mINFO[0m[0m 01/26 17:42:15 | Dataset: OfficeHome
[37m[36mINFO[0m[0m 01/26 17:42:15 | Max test_in: 0.5747

[37m[36mINFO[0m[0m 02/19 13:02:17 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 1 3 --dataset OfficeHome --trial_seed 1 --hparams_seed 20
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 20
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[0, 1, 3]/250219_13-02-17_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 1
	unique_name: 250219_13-02-17_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.6701621650738547e-05
	batch_size: 28
	weight_decay: 2.09977539257237e-05
	mmd_gamma: 2.1411578651095096
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/19 13:02:17 | n_steps = 5001
[37m[36mINFO[0m[0m 02/19 13:02:17 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/19 13:02:17 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/19 13:02:17 | 
[37m[36mINFO[0m[0m 02/19 13:02:17 | Testenv name escaping te_A_C_R -> te_A_C_R
[37m[36mINFO[0m[0m 02/19 13:02:17 | Test envs = [0, 1, 3], name = te_A_C_R
[37m[36mINFO[0m[0m 02/19 13:02:17 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 02/19 13:02:17 | Batch sizes for each domain: [0, 0, 28, 0] (total=28)
[37m[36mINFO[0m[0m 02/19 13:02:17 | steps-per-epoch for each domain: 126.86 -> min = 126.86
[37m[36mINFO[0m[0m 02/19 13:02:18 | # of params = 23641217
[37m[36mINFO[0m[0m 02/19 13:04:14 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/19 13:04:14 | 0.019535    0.013681    0.031813    0.037204    4.236291    0.021627    0.012371    0.015178    0.013746    0.031813    0.037204    0.021801    0.014925    0           0.000000    4.169934    0.000000    1.170060    114.233146 
[37m[36mINFO[0m[0m 02/19 13:06:31 | 0.431837    0.425333    0.790259    0.746336    0.902149    0.378991    0.404124    0.335624    0.297824    0.790259    0.746336    0.580895    0.574053    200         1.576577    1.529528    0.000000    0.131093    111.159177 
[37m[36mINFO[0m[0m 02/19 13:08:46 | 0.451008    0.452234    0.886261    0.812852    0.685692    0.367147    0.389691    0.372566    0.366552    0.886261    0.812852    0.613310    0.600459    400         3.153153    0.455390    0.000000    0.157431    103.206838 
[37m[36mINFO[0m[0m 02/19 13:11:03 | 0.446759    0.456430    0.923423    0.830891    0.628913    0.386200    0.430928    0.348225    0.343643    0.923423    0.830891    0.605852    0.594719    600         4.729730    0.325949    0.000000    0.130919    110.768457 
[37m[36mINFO[0m[0m 02/19 13:13:15 | 0.470516    0.465221    0.940597    0.854566    0.563883    0.407312    0.410309    0.372566    0.378007    0.940597    0.854566    0.631670    0.607348    800         6.306306    0.229415    0.000000    0.128899    106.654485 
[37m[36mINFO[0m[0m 02/19 13:15:31 | 0.474606    0.480290    0.958052    0.845547    0.611407    0.389804    0.416495    0.405212    0.384880    0.958052    0.845547    0.628801    0.639495    1000        7.882883    0.198013    0.000000    0.168061    101.902134 
[37m[36mINFO[0m[0m 02/19 13:17:46 | 0.476338    0.481728    0.971002    0.881623    0.486347    0.399588    0.439175    0.402921    0.383734    0.971002    0.881623    0.626506    0.622273    1200        9.459459    0.133116    0.000000    0.126138    109.532758 
[37m[36mINFO[0m[0m 02/19 13:19:56 | 0.503155    0.491069    0.976914    0.880496    0.526993    0.425850    0.435052    0.420103    0.383734    0.976914    0.880496    0.663511    0.654420    1400        11.036036   0.098758    0.000000    0.124184    105.364758 
[37m[36mINFO[0m[0m 02/19 13:22:14 | 0.469269    0.471881    0.981982    0.883878    0.507132    0.382080    0.406186    0.386598    0.381443    0.981982    0.883878    0.639128    0.628014    1600        12.612613   0.075683    0.000000    0.173952    103.063498 
[37m[36mINFO[0m[0m 02/19 13:24:29 | 0.478152    0.483032    0.977477    0.873732    0.505012    0.402163    0.424742    0.404066    0.394044    0.977477    0.873732    0.628227    0.630310    1800        14.189189   0.086517    0.000000    0.126143    110.298841 
[37m[36mINFO[0m[0m 02/19 13:26:39 | 0.443825    0.441383    0.972128    0.872604    0.516387    0.362513    0.362887    0.365979    0.369989    0.972128    0.872604    0.602983    0.591274    2000        15.765766   0.071004    0.000000    0.132355    103.745788 
[37m[36mINFO[0m[0m 02/19 13:28:54 | 0.481542    0.496951    0.985923    0.873732    0.491813    0.403708    0.441237    0.393471    0.391753    0.985923    0.873732    0.647447    0.657865    2200        17.342342   0.069545    0.000000    0.158447    102.652797 
[37m[36mINFO[0m[0m 02/19 13:31:12 | 0.493602    0.510845    0.991554    0.896280    0.439389    0.430999    0.468041    0.394616    0.413517    0.991554    0.896280    0.655192    0.650976    2400        18.918919   0.063010    0.000000    0.138402    111.090525 
[37m[36mINFO[0m[0m 02/19 13:33:23 | 0.490167    0.509018    0.994088    0.891770    0.576858    0.425850    0.465979    0.390607    0.402062    0.994088    0.891770    0.654045    0.659013    2600        20.495495   0.030634    0.000000    0.127667    104.900553 
[37m[36mINFO[0m[0m 02/19 13:35:42 | 0.482908    0.488313    0.980574    0.886133    0.584134    0.436148    0.468041    0.360538    0.350515    0.980574    0.886133    0.652037    0.646383    2800        22.072072   0.030548    0.000000    0.162838    106.096688 
[37m[36mINFO[0m[0m 02/19 13:37:57 | 0.483074    0.496051    0.993243    0.900789    0.536068    0.406282    0.435052    0.385739    0.374570    0.993243    0.900789    0.657200    0.678530    3000        23.648649   0.020041    0.000000    0.139620    107.971642 
[37m[36mINFO[0m[0m 02/19 13:40:05 | 0.473618    0.482427    0.984797    0.882751    0.671866    0.393409    0.451546    0.387457    0.357388    0.984797    0.882751    0.639989    0.638347    3200        25.225225   0.048263    0.000000    0.131420    101.325657 
[37m[36mINFO[0m[0m 02/19 13:42:27 | 0.461888    0.465715    0.989020    0.903044    0.479553    0.365088    0.367010    0.377721    0.375716    0.989020    0.903044    0.642857    0.654420    3400        26.801802   0.039217    0.000000    0.167674    108.139394 
[37m[36mINFO[0m[0m 02/19 13:44:43 | 0.493879    0.508181    0.995214    0.905299    0.513202    0.421215    0.468041    0.394903    0.394044    0.995214    0.905299    0.665519    0.662457    3600        28.378378   0.023215    0.000000    0.136000    109.325969 
[37m[36mINFO[0m[0m 02/19 13:46:56 | 0.476464    0.493658    0.989302    0.901917    0.590548    0.399073    0.457732    0.384880    0.378007    0.989302    0.901917    0.645439    0.645235    3800        29.954955   0.016898    0.000000    0.132402    105.885175 
[37m[36mINFO[0m[0m 02/19 13:49:13 | 0.489142    0.511011    0.994651    0.908681    0.536797    0.415036    0.474227    0.394616    0.389462    0.994651    0.908681    0.657774    0.669346    4000        31.531532   0.018708    0.000000    0.175072    102.513018 
[37m[36mINFO[0m[0m 02/19 13:51:27 | 0.477807    0.496723    0.992399    0.890643    0.481064    0.388774    0.447423    0.394330    0.383734    0.992399    0.890643    0.650316    0.659013    4200        33.108108   0.030988    0.000000    0.131085    107.945421 
[37m[36mINFO[0m[0m 02/19 13:53:40 | 0.498328    0.514445    0.993525    0.896280    0.478002    0.414521    0.474227    0.418099    0.403207    0.993525    0.896280    0.662364    0.665901    4400        34.684685   0.033798    0.000000    0.134358    105.325420 
[37m[36mINFO[0m[0m 02/19 13:55:56 | 0.499129    0.516828    0.993525    0.895152    0.502371    0.418641    0.441237    0.415808    0.422680    0.993525    0.895152    0.662937    0.686567    4600        36.261261   0.021759    0.000000    0.146396    107.443007 
[37m[36mINFO[0m[0m 02/19 13:58:12 | 0.469430    0.486159    0.986768    0.872604    0.738572    0.392894    0.443299    0.388316    0.389462    0.986768    0.872604    0.627080    0.625718    4800        37.837838   0.018890    0.000000    0.132018    109.620916 
[37m[36mINFO[0m[0m 02/19 14:00:21 | 0.472570    0.481666    0.993525    0.890643    0.558141    0.377961    0.400000    0.404926    0.403207    0.993525    0.890643    0.634825    0.641791    5000        39.414414   0.028714    0.000000    0.139011    100.513917 
[37m[36mINFO[0m[0m 02/19 14:00:21 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[0, 1, 3]/250219_13-02-17_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/19 14:00:22 | ---
[37m[36mINFO[0m[0m 02/19 14:00:22 | test-domain validation(oracle) = 49.913%
[37m[36mINFO[0m[0m 02/19 14:00:22 | training-domain validation(iid) = 48.914%
[37m[36mINFO[0m[0m 02/19 14:00:22 | last = 47.257%
[37m[36mINFO[0m[0m 02/19 14:00:22 | last (inD) = 89.064%
[37m[36mINFO[0m[0m 02/19 14:00:22 | training-domain validation (iid, inD) = 90.868%
[37m[36mINFO[0m[0m 02/19 14:00:22 | === Summary ===
[37m[36mINFO[0m[0m 02/19 14:00:22 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 1 3 --dataset OfficeHome --trial_seed 1 --hparams_seed 20
[37m[36mINFO[0m[0m 02/19 14:00:22 | Unique name: 250219_13-02-17_resnet50_GENIE
[37m[36mINFO[0m[0m 02/19 14:00:22 | Out path: train_output/OfficeHome/CORAL/[0, 1, 3]/250219_13-02-17_resnet50_GENIE
[37m[36mINFO[0m[0m 02/19 14:00:22 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/19 14:00:22 | Dataset: OfficeHome

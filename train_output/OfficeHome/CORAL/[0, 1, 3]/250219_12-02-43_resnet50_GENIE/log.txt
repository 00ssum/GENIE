[37m[36mINFO[0m[0m 02/19 12:02:43 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 1 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 20
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 20
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/OfficeHome/CORAL/[0, 1, 3]/250219_12-02-43_resnet50_GENIE
	out_root: train_output/OfficeHome/CORAL/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 0
	unique_name: 250219_12-02-43_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.6157673767852512e-05
	batch_size: 32
	weight_decay: 1.110622050999988e-05
	mmd_gamma: 0.11123344099864356
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 02/19 12:02:43 | n_steps = 5001
[37m[36mINFO[0m[0m 02/19 12:02:43 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/19 12:02:43 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/19 12:02:43 | 
[37m[36mINFO[0m[0m 02/19 12:02:43 | Testenv name escaping te_A_C_R -> te_A_C_R
[37m[36mINFO[0m[0m 02/19 12:02:43 | Test envs = [0, 1, 3], name = te_A_C_R
[37m[36mINFO[0m[0m 02/19 12:02:43 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 02/19 12:02:43 | Batch sizes for each domain: [0, 0, 32, 0] (total=32)
[37m[36mINFO[0m[0m 02/19 12:02:43 | steps-per-epoch for each domain: 111.00 -> min = 111.00
[37m[36mINFO[0m[0m 02/19 12:02:45 | # of params = 23641217
[37m[36mINFO[0m[0m 02/19 12:04:34 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/19 12:04:34 | 0.019610    0.020324    0.024775    0.022548    4.192404    0.019567    0.018557    0.022050    0.027491    0.024775    0.022548    0.017212    0.014925    0           0.000000    4.398559    0.000000    1.265528    107.914134 
[37m[36mINFO[0m[0m 02/19 12:06:48 | 0.458220    0.468278    0.836430    0.798196    0.722647    0.388260    0.410309    0.400916    0.384880    0.836430    0.798196    0.585485    0.609644    200         1.801802    1.966682    0.000000    0.141906    106.317551 
[37m[36mINFO[0m[0m 02/19 12:09:01 | 0.499604    0.495492    0.901745    0.839910    0.558920    0.436148    0.449485    0.425258    0.390607    0.901745    0.839910    0.637407    0.646383    400         3.603604    0.561522    0.000000    0.147298    103.521975 
[37m[36mINFO[0m[0m 02/19 12:11:22 | 0.488836    0.492054    0.934966    0.865840    0.474317    0.420185    0.428866    0.419530    0.402062    0.934966    0.865840    0.626793    0.645235    600         5.405405    0.354468    0.000000    0.177401    105.158964 
[37m[36mINFO[0m[0m 02/19 12:13:40 | 0.483605    0.484495    0.950732    0.865840    0.457038    0.415036    0.416495    0.379152    0.390607    0.950732    0.865840    0.656627    0.646383    800         7.207207    0.233105    0.000000    0.149630    108.419877 
[37m[36mINFO[0m[0m 02/19 12:15:57 | 0.491918    0.492058    0.945946    0.844419    0.565431    0.427394    0.439175    0.402348    0.387171    0.945946    0.844419    0.646013    0.649828    1000        9.009009    0.206263    0.000000    0.144737    107.753578 
[37m[36mINFO[0m[0m 02/19 12:18:16 | 0.511742    0.499627    0.968750    0.887260    0.466084    0.443872    0.430928    0.423540    0.406644    0.968750    0.887260    0.667814    0.661309    1200        10.810811   0.165250    0.000000    0.169327    105.050665 
[37m[36mINFO[0m[0m 02/19 12:20:40 | 0.460113    0.458527    0.973536    0.888388    0.521887    0.384140    0.375258    0.374284    0.359679    0.973536    0.888388    0.621916    0.640643    1400        12.612613   0.112989    0.000000    0.150106    114.334148 
[37m[36mINFO[0m[0m 02/19 12:23:05 | 0.485012    0.484664    0.980574    0.878241    0.544551    0.420700    0.412371    0.385166    0.374570    0.980574    0.878241    0.649168    0.667049    1600        14.414414   0.117509    0.000000    0.150881    114.225413 
[37m[36mINFO[0m[0m 02/19 12:25:23 | 0.492353    0.503675    0.988176    0.882751    0.498447    0.443872    0.455670    0.385739    0.392898    0.988176    0.882751    0.647447    0.662457    1800        16.216216   0.083502    0.000000    0.157213    106.732054 
[37m[36mINFO[0m[0m 02/19 12:27:45 | 0.488407    0.498190    0.983953    0.878241    0.534459    0.434604    0.439175    0.378293    0.375716    0.983953    0.878241    0.652324    0.679679    2000        18.018018   0.083686    0.000000    0.158418    109.897024 
[37m[36mINFO[0m[0m 02/19 12:30:05 | 0.476557    0.483361    0.988739    0.899662    0.448821    0.399073    0.426804    0.388889    0.361970    0.988739    0.899662    0.641710    0.661309    2200        19.819820   0.083054    0.000000    0.149878    110.737975 
[37m[36mINFO[0m[0m 02/19 12:32:21 | 0.494174    0.506431    0.987050    0.890643    0.497540    0.425850    0.432990    0.406930    0.414662    0.987050    0.890643    0.649742    0.671642    2400        21.621622   0.059329    0.000000    0.140308    107.982110 
[37m[36mINFO[0m[0m 02/19 12:34:35 | 0.471992    0.472415    0.985923    0.892897    0.533548    0.388260    0.391753    0.397480    0.398625    0.985923    0.892897    0.630235    0.626866    2600        23.423423   0.063761    0.000000    0.146535    104.672260 
[37m[36mINFO[0m[0m 02/19 12:36:56 | 0.501422    0.510386    0.989865    0.880496    0.519076    0.443872    0.470103    0.411226    0.411226    0.989865    0.880496    0.649168    0.649828    2800        25.225225   0.071756    0.000000    0.162172    108.184625 
[37m[36mINFO[0m[0m 02/19 12:39:17 | 0.492304    0.501225    0.992399    0.897407    0.490058    0.419670    0.439175    0.409221    0.410080    0.992399    0.897407    0.648021    0.654420    3000        27.027027   0.037584    0.000000    0.142879    112.541844 
[37m[36mINFO[0m[0m 02/19 12:41:29 | 0.495263    0.507120    0.989865    0.895152    0.500856    0.427394    0.445361    0.405785    0.402062    0.989865    0.895152    0.652610    0.673938    3200        28.828829   0.038304    0.000000    0.140339    104.106591 
[37m[36mINFO[0m[0m 02/19 12:43:44 | 0.479671    0.484863    0.988457    0.885006    0.578846    0.394954    0.416495    0.402062    0.410080    0.988457    0.885006    0.641997    0.628014    3400        30.630631   0.037246    0.000000    0.145246    106.090509 
[37m[36mINFO[0m[0m 02/19 12:46:06 | 0.515201    0.534016    0.994651    0.904171    0.440597    0.438208    0.472165    0.436140    0.435281    0.994651    0.904171    0.671256    0.694604    3600        32.432432   0.041365    0.000000    0.141419    113.632653 
[37m[36mINFO[0m[0m 02/19 12:48:19 | 0.494125    0.496198    0.994651    0.901917    0.459485    0.429969    0.441237    0.385739    0.375716    0.994651    0.901917    0.666667    0.671642    3800        34.234234   0.032790    0.000000    0.144021    103.340004 
[37m[36mINFO[0m[0m 02/19 12:50:36 | 0.512159    0.517817    0.994369    0.900789    0.503585    0.455716    0.465979    0.410939    0.405498    0.994369    0.900789    0.669822    0.681975    4000        36.036036   0.023370    0.000000    0.135996    110.674247 
[37m[36mINFO[0m[0m 02/19 12:52:59 | 0.481380    0.494645    0.992117    0.900789    0.536997    0.397528    0.430928    0.418958    0.415808    0.992117    0.900789    0.627653    0.637199    4200        37.837838   0.042171    0.000000    0.144260    113.975014 
[37m[36mINFO[0m[0m 02/19 12:55:12 | 0.486752    0.487567    0.990428    0.894025    0.591339    0.417611    0.406186    0.390034    0.387171    0.990428    0.894025    0.652610    0.669346    4400        39.639640   0.031639    0.000000    0.140807    104.713339 
[37m[36mINFO[0m[0m 02/19 12:57:37 | 0.485167    0.494897    0.991554    0.900789    0.490904    0.411432    0.424742    0.395189    0.391753    0.991554    0.900789    0.648881    0.668197    4600        41.441441   0.041128    0.000000    0.145788    115.691690 
[37m[36mINFO[0m[0m 02/19 13:00:00 | 0.506740    0.511556    0.997185    0.903044    0.536991    0.439753    0.449485    0.414948    0.402062    0.997185    0.903044    0.665519    0.683123    4800        43.243243   0.020835    0.000000    0.143871    113.846848 
[37m[36mINFO[0m[0m 02/19 13:02:11 | 0.503854    0.514910    0.994088    0.903044    0.532268    0.440268    0.451546    0.410653    0.418099    0.994088    0.903044    0.660643    0.675086    5000        45.045045   0.018702    0.000000    0.139838    103.379975 
[37m[36mINFO[0m[0m 02/19 13:02:11 | Cumulative gradient change saved at train_output/OfficeHome/CORAL/[0, 1, 3]/250219_12-02-43_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/19 13:02:12 | ---
[37m[36mINFO[0m[0m 02/19 13:02:12 | test-domain validation(oracle) = 51.520%
[37m[36mINFO[0m[0m 02/19 13:02:12 | training-domain validation(iid) = 51.520%
[37m[36mINFO[0m[0m 02/19 13:02:12 | last = 50.385%
[37m[36mINFO[0m[0m 02/19 13:02:12 | last (inD) = 90.304%
[37m[36mINFO[0m[0m 02/19 13:02:12 | training-domain validation (iid, inD) = 90.417%
[37m[36mINFO[0m[0m 02/19 13:02:13 | === Summary ===
[37m[36mINFO[0m[0m 02/19 13:02:13 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 1 3 --dataset OfficeHome --trial_seed 0 --hparams_seed 20
[37m[36mINFO[0m[0m 02/19 13:02:13 | Unique name: 250219_12-02-43_resnet50_GENIE
[37m[36mINFO[0m[0m 02/19 13:02:13 | Out path: train_output/OfficeHome/CORAL/[0, 1, 3]/250219_12-02-43_resnet50_GENIE
[37m[36mINFO[0m[0m 02/19 13:02:13 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/19 13:02:13 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 03/29 18:25:50 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd_p02 config/resnet50_sgd.yaml --algorithm GENIE_hp_p --test_envs 0 --dataset OfficeHome --trial_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE_hp_p
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd_p02
	out_dir: train_output/OfficeHome/GENIE_hp_p/[0]/250329_18-25-50_resnet50_sgd_p02
	out_root: train_output/OfficeHome/GENIE_hp_p/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 1
	unique_name: 250329_18-25-50_resnet50_sgd_p02
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	momentum: 0.9
	convergence_rate: 0.015
	moving_avg: 0.95
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/29 18:25:51 | n_steps = 5001
[37m[36mINFO[0m[0m 03/29 18:25:51 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/29 18:25:51 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/29 18:25:51 | 
[37m[36mINFO[0m[0m 03/29 18:25:51 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/29 18:25:51 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/29 18:25:51 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/29 18:25:51 | Batch sizes for each domain: [0, 32, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/29 18:25:51 | steps-per-epoch for each domain: 109.12, 111.00, 108.94 -> min = 108.94
[37m[36mINFO[0m[0m 03/29 18:25:52 | # of params = 23641217
[37m[36mINFO[0m[0m 03/29 18:27:54 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/29 18:27:54 | 0.025747    0.028866    0.018272    0.020600    4.209585    0.025747    0.028866    0.014891    0.022910    0.012387    0.007892    0.027539    0.030999    0           0.000000    4.283313    1.273455    120.725123 
[37m[36mINFO[0m[0m 03/29 18:31:38 | 0.583419    0.626804    0.805738    0.759142    0.859360    0.583419    0.626804    0.740836    0.678121    0.850788    0.812852    0.825588    0.786452    200         1.835915    1.465974    0.537610    116.325200 
[37m[36mINFO[0m[0m 03/29 18:35:23 | 0.563852    0.593814    0.872852    0.788403    0.779831    0.563852    0.593814    0.835911    0.722795    0.904561    0.841037    0.878084    0.801378    400         3.671830    0.535926    0.533282    119.037312 
[37m[36mINFO[0m[0m 03/29 18:39:03 | 0.605561    0.653608    0.910190    0.797853    0.818927    0.605561    0.653608    0.876861    0.723940    0.938908    0.860203    0.914802    0.809414    600         5.507745    0.345211    0.519008    116.252487 
[37m[36mINFO[0m[0m 03/29 18:42:49 | 0.596292    0.626804    0.932386    0.803955    0.774161    0.596292    0.626804    0.902062    0.733104    0.949887    0.862458    0.945209    0.816303    800         7.343660    0.249078    0.543759    117.256732 
[37m[36mINFO[0m[0m 03/29 18:46:32 | 0.619979    0.614433    0.946639    0.811531    0.769565    0.619979    0.614433    0.928981    0.744559    0.961712    0.873732    0.949225    0.816303    1000        9.179575    0.201398    0.523016    118.428546 
[37m[36mINFO[0m[0m 03/29 18:50:19 | 0.613800    0.628866    0.955195    0.811948    0.862021    0.613800    0.628866    0.942153    0.744559    0.968468    0.868095    0.954963    0.823192    1200        11.015491   0.153713    0.535120    119.257604 
[37m[36mINFO[0m[0m 03/29 18:54:01 | 0.583934    0.616495    0.965189    0.826705    0.806684    0.583934    0.616495    0.950458    0.775487    0.974944    0.891770    0.970166    0.812859    1400        12.851406   0.138045    0.518806    118.231290 
[37m[36mINFO[0m[0m 03/29 18:57:47 | 0.599897    0.643299    0.970027    0.823712    0.864659    0.599897    0.643299    0.953322    0.758305    0.980856    0.882751    0.975904    0.830080    1600        14.687321   0.113099    0.528186    121.117953 
[37m[36mINFO[0m[0m 03/29 19:01:30 | 0.613800    0.647423    0.972411    0.820339    0.896904    0.613800    0.647423    0.958763    0.773196    0.981419    0.869222    0.977051    0.818599    1800        16.523236   0.097956    0.529112    116.453220 
[37m[36mINFO[0m[0m 03/29 19:05:13 | 0.605561    0.632990    0.977926    0.829757    0.885459    0.605561    0.632990    0.965636    0.769759    0.985642    0.894025    0.982501    0.825488    2000        18.359151   0.081852    0.526338    118.389449 
[37m[36mINFO[0m[0m 03/29 19:08:57 | 0.590113    0.608247    0.976772    0.826701    0.942185    0.590113    0.608247    0.962772    0.762887    0.987050    0.894025    0.980493    0.823192    2200        20.195066   0.082012    0.522174    118.870407 
[37m[36mINFO[0m[0m 03/29 19:12:42 | 0.607621    0.626804    0.981157    0.834339    0.852429    0.607621    0.626804    0.970218    0.775487    0.988457    0.895152    0.984796    0.832377    2400        22.030981   0.068783    0.533578    118.401785 
[37m[36mINFO[0m[0m 03/29 19:16:27 | 0.614315    0.643299    0.983724    0.830513    0.877309    0.614315    0.643299    0.968499    0.765178    0.990991    0.896280    0.991681    0.830080    2600        23.866896   0.061811    0.534070    118.065024 
[37m[36mINFO[0m[0m 03/29 19:20:08 | 0.613800    0.665979    0.982679    0.833959    0.817676    0.613800    0.665979    0.971936    0.770905    0.989583    0.895152    0.986517    0.835821    2800        25.702811   0.053762    0.521786    117.407942 
[37m[36mINFO[0m[0m 03/29 19:24:01 | 0.602472    0.655670    0.984670    0.833571    0.866478    0.602472    0.655670    0.973654    0.777778    0.992117    0.895152    0.988239    0.827784    3000        27.538726   0.047407    0.549452    122.266547 
[37m[36mINFO[0m[0m 03/29 19:27:46 | 0.618435    0.635052    0.985913    0.833932    0.843237    0.618435    0.635052    0.974227    0.761741    0.992117    0.900789    0.991394    0.839265    3200        29.374641   0.047428    0.541163    117.019288 
[37m[36mINFO[0m[0m 03/29 19:31:27 | 0.600412    0.630928    0.982862    0.817240    0.921624    0.600412    0.630928    0.971077    0.767468    0.990991    0.875986    0.986517    0.808266    3400        31.210557   0.042451    0.517500    117.936523 
[37m[36mINFO[0m[0m 03/29 19:35:08 | 0.602987    0.641237    0.987334    0.828233    0.937445    0.602987    0.641237    0.977950    0.770905    0.993806    0.892897    0.990247    0.820896    3600        33.046472   0.043265    0.513574    117.895099 
[37m[36mINFO[0m[0m 03/29 19:38:56 | 0.611226    0.624742    0.986786    0.827496    0.984951    0.611226    0.624742    0.980241    0.769759    0.989583    0.888388    0.990534    0.824340    3800        34.882387   0.040170    0.541931    120.167124 
[37m[36mINFO[0m[0m 03/29 19:42:40 | 0.612770    0.657732    0.987533    0.833179    0.918101    0.612770    0.657732    0.980813    0.772050    0.992399    0.897407    0.989386    0.830080    4000        36.718302   0.035969    0.521826    118.997628 
[37m[36mINFO[0m[0m 03/29 19:46:24 | 0.605046    0.632990    0.988103    0.835905    0.951328    0.605046    0.632990    0.977663    0.774341    0.993243    0.889515    0.993402    0.843858    4200        38.554217   0.037221    0.544490    115.012283 
[37m[36mINFO[0m[0m 03/29 19:50:02 | 0.605046    0.626804    0.988190    0.834765    0.882128    0.605046    0.626804    0.979668    0.772050    0.994369    0.888388    0.990534    0.843858    4400        40.390132   0.039957    0.529794    112.470073 
[37m[36mINFO[0m[0m 03/29 19:53:41 | 0.606591    0.635052    0.988677    0.834713    0.893325    0.606591    0.635052    0.980241    0.768614    0.992962    0.897407    0.992828    0.838117    4600        42.226047   0.034837    0.524445    114.234459 
[37m[36mINFO[0m[0m 03/29 19:57:24 | 0.622039    0.645361    0.988293    0.834333    0.978310    0.622039    0.645361    0.980241    0.773196    0.993243    0.896280    0.991394    0.833525    4800        44.061962   0.038106    0.527752    117.175424 
[37m[36mINFO[0m[0m 03/29 20:01:09 | 0.629763    0.632990    0.989911    0.829764    0.908548    0.629763    0.632990    0.980527    0.769759    0.994369    0.892897    0.994836    0.826636    5000        45.897877   0.032180    0.548248    115.753893 
[37m[36mINFO[0m[0m 03/29 20:01:10 | Cumulative gradient change saved at train_output/OfficeHome/GENIE_hp_p/[0]/250329_18-25-50_resnet50_sgd_p02/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/29 20:01:11 | ---
[37m[36mINFO[0m[0m 03/29 20:01:11 | test-domain validation(oracle) = 61.380%
[37m[36mINFO[0m[0m 03/29 20:01:11 | training-domain validation(iid) = 60.505%
[37m[36mINFO[0m[0m 03/29 20:01:11 | last = 62.976%
[37m[36mINFO[0m[0m 03/29 20:01:11 | last (inD) = 82.976%
[37m[36mINFO[0m[0m 03/29 20:01:11 | training-domain validation (iid, inD) = 83.590%
[37m[36mINFO[0m[0m 03/29 20:01:11 | === Summary ===
[37m[36mINFO[0m[0m 03/29 20:01:11 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd_p02 config/resnet50_sgd.yaml --algorithm GENIE_hp_p --test_envs 0 --dataset OfficeHome --trial_seed 1
[37m[36mINFO[0m[0m 03/29 20:01:11 | Unique name: 250329_18-25-50_resnet50_sgd_p02
[37m[36mINFO[0m[0m 03/29 20:01:11 | Out path: train_output/OfficeHome/GENIE_hp_p/[0]/250329_18-25-50_resnet50_sgd_p02
[37m[36mINFO[0m[0m 03/29 20:01:11 | Algorithm: GENIE_hp_p
[37m[36mINFO[0m[0m 03/29 20:01:11 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 03/29 23:05:10 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd_p04 config/resnet50_sgd.yaml --algorithm GENIE_hp_p --test_envs 0 --dataset OfficeHome --trial_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE_hp_p
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd_p04
	out_dir: train_output/OfficeHome/GENIE_hp_p/[0]/250329_23-05-10_resnet50_sgd_p04
	out_root: train_output/OfficeHome/GENIE_hp_p/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 1
	unique_name: 250329_23-05-10_resnet50_sgd_p04
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	momentum: 0.9
	convergence_rate: 0.015
	moving_avg: 0.95
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/29 23:05:10 | n_steps = 5001
[37m[36mINFO[0m[0m 03/29 23:05:10 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/29 23:05:10 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/29 23:05:10 | 
[37m[36mINFO[0m[0m 03/29 23:05:10 | Testenv name escaping te_A -> te_A
[37m[36mINFO[0m[0m 03/29 23:05:10 | Test envs = [0], name = te_A
[37m[36mINFO[0m[0m 03/29 23:05:10 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/29 23:05:10 | Batch sizes for each domain: [0, 32, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/29 23:05:10 | steps-per-epoch for each domain: 109.12, 111.00, 108.94 -> min = 108.94
[37m[36mINFO[0m[0m 03/29 23:05:11 | # of params = 23641217
[37m[36mINFO[0m[0m 03/29 23:07:11 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/29 23:07:11 | 0.025747    0.030928    0.018272    0.021359    4.209212    0.025747    0.030928    0.014891    0.022910    0.012387    0.009019    0.027539    0.032147    0           0.000000    4.283313    1.001934    118.916949 
[37m[36mINFO[0m[0m 03/29 23:11:00 | 0.582389    0.608247    0.810677    0.753449    0.864232    0.582389    0.608247    0.742268    0.679267    0.855856    0.804961    0.833907    0.776119    200         1.835915    1.466778    0.554382    117.740152 
[37m[36mINFO[0m[0m 03/29 23:14:54 | 0.579300    0.593814    0.862465    0.782320    0.811758    0.579300    0.593814    0.819874    0.715922    0.900338    0.835400    0.867183    0.795637    400         3.671830    0.531322    0.555925    123.694321 
[37m[36mINFO[0m[0m 03/29 23:18:39 | 0.598352    0.670103    0.916268    0.808166    0.768892    0.598352    0.670103    0.884593    0.741123    0.944820    0.861330    0.919392    0.822044    600         5.507745    0.348110    0.536966    116.876526 
[37m[36mINFO[0m[0m 03/29 23:22:30 | 0.582389    0.597938    0.924963    0.807394    0.854058    0.582389    0.597938    0.898912    0.739977    0.944538    0.862458    0.931440    0.819747    800         7.343660    0.253352    0.553233    120.651424 
[37m[36mINFO[0m[0m 03/29 23:26:15 | 0.629248    0.643299    0.948426    0.821405    0.762916    0.629248    0.643299    0.927835    0.754868    0.966498    0.885006    0.950947    0.824340    1000        9.179575    0.193019    0.529065    119.545720 
[37m[36mINFO[0m[0m 03/29 23:30:06 | 0.611740    0.630928    0.955356    0.823342    0.771791    0.611740    0.630928    0.938144    0.759450    0.973536    0.880496    0.954389    0.830080    1200        11.015491   0.149790    0.549735    121.005078 
[37m[36mINFO[0m[0m 03/29 23:33:55 | 0.592173    0.614433    0.967458    0.826724    0.837564    0.592173    0.614433    0.949885    0.750286    0.979167    0.891770    0.973322    0.838117    1400        12.851406   0.125051    0.542494    119.880812 
[37m[36mINFO[0m[0m 03/29 23:37:42 | 0.597837    0.597938    0.970882    0.824465    0.821618    0.597837    0.597938    0.956472    0.765178    0.981419    0.883878    0.974756    0.824340    1600        14.687321   0.113782    0.543559    118.375565 
[37m[36mINFO[0m[0m 03/29 23:41:31 | 0.614830    0.628866    0.970127    0.821043    0.891597    0.614830    0.628866    0.958763    0.753723    0.979730    0.881623    0.971888    0.827784    1800        16.523236   0.087515    0.544330    120.135891 
[37m[36mINFO[0m[0m 03/29 23:45:17 | 0.614315    0.653608    0.974803    0.826360    0.877069    0.614315    0.653608    0.965636    0.753723    0.980574    0.888388    0.978199    0.836969    2000        18.359151   0.083150    0.543025    117.537786 
[37m[36mINFO[0m[0m 03/29 23:49:05 | 0.600412    0.604124    0.974887    0.821043    0.956331    0.600412    0.604124    0.960195    0.762887    0.982827    0.880496    0.981641    0.819747    2200        20.195066   0.082434    0.548395    118.013166 
[37m[36mINFO[0m[0m 03/29 23:52:55 | 0.585994    0.608247    0.979456    0.831346    0.997665    0.585994    0.608247    0.969931    0.775487    0.985360    0.883878    0.983075    0.834673    2400        22.030981   0.068959    0.555447    119.177095 
[37m[36mINFO[0m[0m 03/29 23:56:44 | 0.617920    0.651546    0.983245    0.830150    0.881935    0.617920    0.651546    0.969931    0.757159    0.990991    0.894025    0.988812    0.839265    2600        23.866896   0.063961    0.554010    117.831688 
[37m[36mINFO[0m[0m 03/30 00:00:31 | 0.605561    0.639175    0.983907    0.836230    0.901556    0.605561    0.639175    0.973081    0.776632    0.991836    0.898534    0.986804    0.833525    2800        25.702811   0.052002    0.542431    119.197560 
[37m[36mINFO[0m[0m 03/30 00:04:22 | 0.612255    0.641237    0.984295    0.838910    0.878928    0.612255    0.641237    0.973654    0.784651    0.990991    0.897407    0.988239    0.834673    3000        27.538726   0.050903    0.559456    118.833281 
[37m[36mINFO[0m[0m 03/30 00:08:13 | 0.618950    0.637113    0.985342    0.824074    0.886291    0.618950    0.637113    0.975086    0.767468    0.991554    0.885006    0.989386    0.819747    3200        29.374641   0.045139    0.547302    121.088160 
[37m[36mINFO[0m[0m 03/30 00:11:57 | 0.614315    0.637113    0.986967    0.826374    0.954123    0.614315    0.637113    0.979095    0.770905    0.991273    0.883878    0.990534    0.824340    3400        31.210557   0.044590    0.535340    117.828220 
[37m[36mINFO[0m[0m 03/30 00:15:47 | 0.624099    0.645361    0.987723    0.833209    0.967709    0.624099    0.645361    0.979381    0.777778    0.992680    0.891770    0.991107    0.830080    3600        33.046472   0.044578    0.537459    121.548669 
[37m[36mINFO[0m[0m 03/30 00:19:38 | 0.621524    0.628866    0.989429    0.833943    1.001362    0.621524    0.628866    0.980813    0.774341    0.994932    0.897407    0.992542    0.830080    3800        34.882387   0.038246    0.560743    119.288582 
[37m[36mINFO[0m[0m 03/30 00:23:22 | 0.623584    0.641237    0.990101    0.840051    0.907678    0.623584    0.641237    0.982818    0.776632    0.994369    0.899662    0.993115    0.843858    4000        36.718302   0.034312    0.522074    119.408766 
[37m[36mINFO[0m[0m 03/30 00:27:12 | 0.624614    0.649485    0.988665    0.838110    0.853428    0.624614    0.649485    0.979668    0.775487    0.994932    0.904171    0.991394    0.834673    4200        38.554217   0.034828    0.554265    119.073357 
[37m[36mINFO[0m[0m 03/30 00:31:01 | 0.605561    0.630928    0.985716    0.831655    0.954264    0.605561    0.630928    0.973654    0.762887    0.992962    0.897407    0.990534    0.834673    4400        40.390132   0.041803    0.554390    118.466920 
[37m[36mINFO[0m[0m 03/30 00:34:47 | 0.593203    0.628866    0.986019    0.822912    0.939752    0.593203    0.628866    0.976518    0.767468    0.990146    0.887260    0.991394    0.814007    4600        42.226047   0.036692    0.544575    116.889627 
[37m[36mINFO[0m[0m 03/30 00:38:37 | 0.612255    0.639175    0.989429    0.828961    0.936466    0.612255    0.639175    0.980813    0.765178    0.994932    0.899662    0.992542    0.822044    4800        44.061962   0.037853    0.550088    119.652806 
[37m[36mINFO[0m[0m 03/30 00:42:24 | 0.610196    0.626804    0.990960    0.834707    0.945535    0.610196    0.626804    0.982532    0.776632    0.994651    0.897407    0.995697    0.830080    5000        45.897877   0.035365    0.561501    115.177941 
[37m[36mINFO[0m[0m 03/30 00:42:24 | Cumulative gradient change saved at train_output/OfficeHome/GENIE_hp_p/[0]/250329_23-05-10_resnet50_sgd_p04/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/30 00:42:26 | ---
[37m[36mINFO[0m[0m 03/30 00:42:26 | test-domain validation(oracle) = 59.835%
[37m[36mINFO[0m[0m 03/30 00:42:26 | training-domain validation(iid) = 62.358%
[37m[36mINFO[0m[0m 03/30 00:42:26 | last = 61.020%
[37m[36mINFO[0m[0m 03/30 00:42:26 | last (inD) = 83.471%
[37m[36mINFO[0m[0m 03/30 00:42:26 | training-domain validation (iid, inD) = 84.005%
[37m[36mINFO[0m[0m 03/30 00:42:26 | === Summary ===
[37m[36mINFO[0m[0m 03/30 00:42:26 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd_p04 config/resnet50_sgd.yaml --algorithm GENIE_hp_p --test_envs 0 --dataset OfficeHome --trial_seed 1
[37m[36mINFO[0m[0m 03/30 00:42:26 | Unique name: 250329_23-05-10_resnet50_sgd_p04
[37m[36mINFO[0m[0m 03/30 00:42:26 | Out path: train_output/OfficeHome/GENIE_hp_p/[0]/250329_23-05-10_resnet50_sgd_p04
[37m[36mINFO[0m[0m 03/30 00:42:26 | Algorithm: GENIE_hp_p
[37m[36mINFO[0m[0m 03/30 00:42:26 | Dataset: OfficeHome

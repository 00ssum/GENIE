[37m[36mINFO[0m[0m 03/30 04:19:35 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd_p06 config/resnet50_sgd.yaml --algorithm GENIE_hp_p --test_envs 3 --dataset OfficeHome --trial_seed 2
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE_hp_p
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd_p06
	out_dir: train_output/OfficeHome/GENIE_hp_p/[3]/250330_04-19-35_resnet50_sgd_p06
	out_root: train_output/OfficeHome/GENIE_hp_p/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250330_04-19-35_resnet50_sgd_p06
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	momentum: 0.9
	convergence_rate: 0.015
	moving_avg: 0.95
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/30 04:19:35 | n_steps = 5001
[37m[36mINFO[0m[0m 03/30 04:19:35 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/30 04:19:35 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/30 04:19:35 | 
[37m[36mINFO[0m[0m 03/30 04:19:35 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 03/30 04:19:35 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 03/30 04:19:35 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/30 04:19:35 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 03/30 04:19:35 | steps-per-epoch for each domain: 60.69, 109.12, 111.00 -> min = 60.69
[37m[36mINFO[0m[0m 03/30 04:19:36 | # of params = 23641217
[37m[36mINFO[0m[0m 03/30 04:21:27 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/30 04:21:27 | 0.022662    0.028703    0.016743    0.021650    4.213850    0.019567    0.020619    0.015178    0.022910    0.015484    0.021421    0.022662    0.028703    0           0.000000    4.265646    1.261328    109.625235 
[37m[36mINFO[0m[0m 03/30 04:24:05 | 0.746701    0.758898    0.804369    0.732622    0.962184    0.802781    0.707216    0.747995    0.657503    0.862331    0.833145    0.746701    0.758898    200         3.295572    1.571197    0.229716    111.249170 
[37m[36mINFO[0m[0m 03/30 04:26:41 | 0.766781    0.747417    0.884070    0.760800    0.963209    0.905767    0.729897    0.839347    0.719359    0.907095    0.833145    0.766781    0.747417    400         6.591143    0.551850    0.234000    109.851097 
[37m[36mINFO[0m[0m 03/30 04:29:17 | 0.755307    0.753157    0.914687    0.771407    0.994730    0.937693    0.729897    0.870275    0.735395    0.936092    0.848929    0.755307    0.753157    600         9.886715    0.340845    0.235724    109.002711 
[37m[36mINFO[0m[0m 03/30 04:31:55 | 0.764487    0.757750    0.925546    0.768606    0.977324    0.937178    0.713402    0.896048    0.747995    0.943412    0.844419    0.764487    0.757750    800         13.182286   0.240430    0.234324    111.187356 
[37m[36mINFO[0m[0m 03/30 04:34:32 | 0.770511    0.771527    0.957893    0.787552    0.964509    0.974768    0.744330    0.932131    0.746850    0.966779    0.871477    0.770511    0.771527    1000        16.477858   0.189050    0.231688    110.019620 
[37m[36mINFO[0m[0m 03/30 04:37:07 | 0.765347    0.750861    0.957682    0.786688    0.974496    0.972194    0.736082    0.930412    0.747995    0.970439    0.875986    0.765347    0.750861    1200        19.773429   0.148176    0.232376    109.014821 
[37m[36mINFO[0m[0m 03/30 04:39:46 | 0.766208    0.750861    0.965259    0.791095    0.986756    0.981462    0.742268    0.944158    0.765178    0.970158    0.865840    0.766208    0.750861    1400        23.069001   0.112341    0.230757    112.431897 
[37m[36mINFO[0m[0m 03/30 04:42:22 | 0.768789    0.769231    0.974587    0.785671    1.086632    0.987642    0.721649    0.951604    0.754868    0.984516    0.880496    0.768789    0.769231    1600        26.364573   0.094828    0.228909    110.440164 
[37m[36mINFO[0m[0m 03/30 04:45:03 | 0.761905    0.784156    0.968333    0.784339    1.160857    0.974768    0.717526    0.953036    0.762887    0.977196    0.872604    0.761905    0.784156    1800        29.660144   0.085847    0.233716    113.753285 
[37m[36mINFO[0m[0m 03/30 04:47:42 | 0.761905    0.757750    0.974859    0.791105    1.051829    0.989186    0.729897    0.958477    0.765178    0.976914    0.878241    0.761905    0.757750    2000        32.955716   0.078842    0.235075    112.826530 
[37m[36mINFO[0m[0m 03/30 04:50:23 | 0.763626    0.762342    0.974406    0.802789    1.115512    0.983522    0.754639    0.963345    0.775487    0.976351    0.878241    0.763626    0.762342    2200        36.251287   0.072914    0.233450    114.147484 
[37m[36mINFO[0m[0m 03/30 04:53:02 | 0.773379    0.771527    0.975206    0.791606    1.166579    0.987127    0.727835    0.958763    0.776632    0.979730    0.870349    0.773379    0.771527    2400        39.546859   0.063001    0.228989    112.469651 
[37m[36mINFO[0m[0m 03/30 04:55:38 | 0.774814    0.778416    0.982792    0.792064    1.259675    0.989701    0.746392    0.970218    0.759450    0.988457    0.870349    0.774814    0.778416    2600        42.842430   0.054183    0.234390    110.001482 
[37m[36mINFO[0m[0m 03/30 04:58:15 | 0.770224    0.771527    0.983490    0.803987    1.081576    0.991246    0.752577    0.969359    0.776632    0.989865    0.882751    0.770224    0.771527    2800        46.138002   0.056440    0.231476    109.980225 
[37m[36mINFO[0m[0m 03/30 05:00:49 | 0.775100    0.769231    0.984128    0.798907    1.169871    0.989701    0.756701    0.974227    0.764032    0.988457    0.875986    0.775100    0.769231    3000        49.433574   0.044465    0.231307    108.212755 
[37m[36mINFO[0m[0m 03/30 05:03:25 | 0.770797    0.776119    0.987637    0.793378    1.038666    0.992276    0.729897    0.978236    0.768614    0.992399    0.881623    0.770797    0.776119    3200        52.729145   0.045967    0.231097    110.004753 
[37m[36mINFO[0m[0m 03/30 05:06:06 | 0.766208    0.779564    0.984530    0.787164    1.153002    0.989186    0.713402    0.975945    0.775487    0.988457    0.872604    0.766208    0.779564    3400        56.024717   0.040813    0.235024    113.396908 
[37m[36mINFO[0m[0m 03/30 05:08:44 | 0.780264    0.777268    0.988802    0.795968    1.067296    0.993821    0.742268    0.977090    0.762887    0.995495    0.882751    0.780264    0.777268    3600        59.320288   0.050054    0.230582    111.597893 
[37m[36mINFO[0m[0m 03/30 05:11:24 | 0.781124    0.789897    0.990446    0.809789    1.232372    0.993306    0.758763    0.982818    0.773196    0.995214    0.897407    0.781124    0.789897    3800        62.615860   0.032189    0.235983    112.899306 
[37m[36mINFO[0m[0m 03/30 05:13:58 | 0.767929    0.780712    0.986728    0.792291    1.317278    0.993821    0.727835    0.975372    0.764032    0.990991    0.885006    0.767929    0.780712    4000        65.911432   0.035261    0.232365    108.084229 
[37m[36mINFO[0m[0m 03/30 05:16:36 | 0.772519    0.772675    0.986880    0.803611    1.211872    0.992276    0.752577    0.977090    0.776632    0.991273    0.881623    0.772519    0.772675    4200        69.207003   0.037253    0.230548    111.739773 
[37m[36mINFO[0m[0m 03/30 05:19:12 | 0.775961    0.766935    0.988834    0.801835    1.211743    0.993306    0.736082    0.979954    0.769759    0.993243    0.899662    0.775961    0.766935    4400        72.502575   0.030694    0.227433    110.122892 
[37m[36mINFO[0m[0m 03/30 05:21:52 | 0.777395    0.771527    0.989502    0.796726    1.281272    0.995881    0.742268    0.979381    0.764032    0.993243    0.883878    0.777395    0.771527    4600        75.798146   0.035867    0.242737    111.959562 
[37m[36mINFO[0m[0m 03/30 05:24:30 | 0.767642    0.772675    0.986734    0.790999    1.216742    0.993821    0.731959    0.976518    0.757159    0.989865    0.883878    0.767642    0.772675    4800        79.093718   0.034188    0.231125    111.161227 
[37m[36mINFO[0m[0m 03/30 05:27:07 | 0.779403    0.774971    0.990109    0.802817    1.076675    0.992276    0.742268    0.983963    0.778923    0.994088    0.887260    0.779403    0.774971    5000        82.389289   0.036371    0.235019    110.665995 
[37m[36mINFO[0m[0m 03/30 05:27:07 | Cumulative gradient change saved at train_output/OfficeHome/GENIE_hp_p/[3]/250330_04-19-35_resnet50_sgd_p06/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/30 05:27:09 | ---
[37m[36mINFO[0m[0m 03/30 05:27:09 | test-domain validation(oracle) = 78.112%
[37m[36mINFO[0m[0m 03/30 05:27:09 | training-domain validation(iid) = 78.112%
[37m[36mINFO[0m[0m 03/30 05:27:09 | last = 77.940%
[37m[36mINFO[0m[0m 03/30 05:27:09 | last (inD) = 80.282%
[37m[36mINFO[0m[0m 03/30 05:27:09 | training-domain validation (iid, inD) = 80.979%
[37m[36mINFO[0m[0m 03/30 05:27:09 | === Summary ===
[37m[36mINFO[0m[0m 03/30 05:27:09 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd_p06 config/resnet50_sgd.yaml --algorithm GENIE_hp_p --test_envs 3 --dataset OfficeHome --trial_seed 2
[37m[36mINFO[0m[0m 03/30 05:27:09 | Unique name: 250330_04-19-35_resnet50_sgd_p06
[37m[36mINFO[0m[0m 03/30 05:27:09 | Out path: train_output/OfficeHome/GENIE_hp_p/[3]/250330_04-19-35_resnet50_sgd_p06
[37m[36mINFO[0m[0m 03/30 05:27:09 | Algorithm: GENIE_hp_p
[37m[36mINFO[0m[0m 03/30 05:27:09 | Dataset: OfficeHome

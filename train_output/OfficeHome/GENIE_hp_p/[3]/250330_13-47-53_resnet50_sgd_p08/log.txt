[37m[36mINFO[0m[0m 03/30 13:47:53 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd_p08 config/resnet50_sgd.yaml --algorithm GENIE_hp_p --test_envs 3 --dataset OfficeHome --trial_seed 2
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE_hp_p
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd_p08
	out_dir: train_output/OfficeHome/GENIE_hp_p/[3]/250330_13-47-53_resnet50_sgd_p08
	out_root: train_output/OfficeHome/GENIE_hp_p/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250330_13-47-53_resnet50_sgd_p08
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	momentum: 0.9
	convergence_rate: 0.015
	moving_avg: 0.95
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/30 13:47:53 | n_steps = 5001
[37m[36mINFO[0m[0m 03/30 13:47:53 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/30 13:47:53 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/30 13:47:53 | 
[37m[36mINFO[0m[0m 03/30 13:47:53 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 03/30 13:47:53 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 03/30 13:47:53 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/30 13:47:53 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 03/30 13:47:53 | steps-per-epoch for each domain: 60.69, 109.12, 111.00 -> min = 60.69
[37m[36mINFO[0m[0m 03/30 13:47:54 | # of params = 23641217
[37m[36mINFO[0m[0m 03/30 13:49:51 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/30 13:49:51 | 0.023236    0.026406    0.016627    0.022025    4.213727    0.020082    0.020619    0.014032    0.022910    0.015766    0.022548    0.023236    0.026406    0           0.000000    4.265646    1.101623    115.981065 
[37m[36mINFO[0m[0m 03/30 13:52:43 | 0.743832    0.769231    0.807368    0.737421    0.938158    0.813079    0.690722    0.754296    0.686140    0.854730    0.835400    0.743832    0.769231    200         3.295572    1.585261    0.252588    120.997826 
[37m[36mINFO[0m[0m 03/30 13:55:35 | 0.765921    0.748565    0.877780    0.755670    0.937277    0.898558    0.701031    0.832474    0.715922    0.902309    0.850056    0.765921    0.748565    400         6.591143    0.550705    0.262661    119.667678 
[37m[36mINFO[0m[0m 03/30 13:58:39 | 0.751291    0.726751    0.915597    0.765075    0.976556    0.934604    0.715464    0.881443    0.731959    0.930743    0.847802    0.751291    0.726751    600         9.886715    0.345456    0.337835    116.488574 
[37m[36mINFO[0m[0m 03/30 14:01:51 | 0.766495    0.754305    0.939297    0.778613    0.870824    0.956231    0.729897    0.910367    0.747995    0.951295    0.857948    0.766495    0.754305    800         13.182286   0.237274    0.380007    115.496114 
[37m[36mINFO[0m[0m 03/30 14:04:47 | 0.753299    0.737084    0.952209    0.775000    0.996735    0.968589    0.723711    0.921821    0.738832    0.966216    0.862458    0.753299    0.737084    1000        16.477858   0.187240    0.298747    116.769412 
[37m[36mINFO[0m[0m 03/30 14:07:39 | 0.766208    0.758898    0.958215    0.777713    1.000502    0.968589    0.711340    0.938431    0.752577    0.967624    0.869222    0.766208    0.758898    1200        19.773429   0.148494    0.259262    119.961097 
[37m[36mINFO[0m[0m 03/30 14:10:37 | 0.759036    0.758898    0.967946    0.789327    1.024714    0.983007    0.738144    0.946449    0.761741    0.974381    0.868095    0.759036    0.758898    1400        23.069001   0.113275    0.291065    119.795987 
[37m[36mINFO[0m[0m 03/30 14:13:44 | 0.766208    0.770379    0.966994    0.783563    1.077936    0.980947    0.727835    0.949313    0.747995    0.970721    0.874859    0.766208    0.770379    1600        26.364573   0.103852    0.367532    113.801248 
[37m[36mINFO[0m[0m 03/30 14:16:55 | 0.766208    0.762342    0.975011    0.780087    1.163672    0.984037    0.719588    0.957045    0.752577    0.983953    0.868095    0.766208    0.762342    1800        29.660144   0.081443    0.347456    121.683990 
[37m[36mINFO[0m[0m 03/30 14:19:42 | 0.774240    0.761194    0.976776    0.796662    1.032793    0.988157    0.744330    0.959908    0.764032    0.982264    0.881623    0.774240    0.761194    2000        32.955716   0.076507    0.249943    116.671053 
[37m[36mINFO[0m[0m 03/30 14:22:30 | 0.759897    0.753157    0.977853    0.795663    1.018294    0.990216    0.750515    0.962486    0.753723    0.980856    0.882751    0.759897    0.753157    2200        36.251287   0.075406    0.267997    114.481187 
[37m[36mINFO[0m[0m 03/30 14:25:33 | 0.763052    0.763490    0.975114    0.782659    1.171758    0.986612    0.731959    0.956186    0.743414    0.982545    0.872604    0.763052    0.763490    2400        39.546859   0.061985    0.348042    113.393293 
[37m[36mINFO[0m[0m 03/30 14:28:40 | 0.784280    0.773823    0.981853    0.784275    1.159542    0.992276    0.740206    0.967640    0.742268    0.985642    0.870349    0.784280    0.773823    2600        42.842430   0.062183    0.371781    112.524719 
[37m[36mINFO[0m[0m 03/30 14:31:31 | 0.775387    0.769231    0.984945    0.795522    1.126609    0.993306    0.744330    0.972509    0.761741    0.989020    0.880496    0.775387    0.769231    2800        46.138002   0.059424    0.285312    113.408985 
[37m[36mINFO[0m[0m 03/30 14:34:12 | 0.771658    0.754305    0.984919    0.798613    1.132609    0.988671    0.754639    0.975659    0.767468    0.990428    0.873732    0.771658    0.754305    3000        49.433574   0.047398    0.246395    112.082702 
[37m[36mINFO[0m[0m 03/30 14:37:07 | 0.767929    0.761194    0.984877    0.793895    1.024796    0.992276    0.736082    0.971363    0.760596    0.990991    0.885006    0.767929    0.761194    3200        52.729145   0.046042    0.315119    112.349939 
[37m[36mINFO[0m[0m 03/30 14:40:08 | 0.765921    0.757750    0.986361    0.800132    1.037618    0.993306    0.752577    0.973940    0.758305    0.991836    0.889515    0.765921    0.757750    3400        56.024717   0.040423    0.350109    110.892450 
[37m[36mINFO[0m[0m 03/30 14:42:56 | 0.767355    0.752009    0.982980    0.783005    1.060468    0.989701    0.721649    0.970218    0.747995    0.989020    0.879369    0.767355    0.752009    3600        59.320288   0.050415    0.281305    111.639275 
[37m[36mINFO[0m[0m 03/30 14:45:39 | 0.776822    0.787600    0.990356    0.799069    1.196286    0.995881    0.740206    0.981100    0.768614    0.994088    0.888388    0.776822    0.787600    3800        62.615860   0.037454    0.245300    113.587451 
[37m[36mINFO[0m[0m 03/30 14:48:34 | 0.771658    0.773823    0.985186    0.794917    1.265441    0.991761    0.740206    0.973368    0.765178    0.990428    0.879369    0.771658    0.773823    4000        65.911432   0.032871    0.321986    110.502222 
[37m[36mINFO[0m[0m 03/30 14:51:39 | 0.767642    0.770379    0.984809    0.794365    1.222979    0.989186    0.734021    0.975659    0.766323    0.989583    0.882751    0.767642    0.770379    4200        69.207003   0.036437    0.368440    111.828185 
[37m[36mINFO[0m[0m 03/30 14:54:30 | 0.775961    0.764638    0.988807    0.794118    1.081786    0.994336    0.729897    0.980813    0.766323    0.991273    0.886133    0.775961    0.764638    4400        72.502575   0.036389    0.291228    112.567050 
[37m[36mINFO[0m[0m 03/30 14:57:11 | 0.781985    0.771527    0.989102    0.796827    1.194632    0.993821    0.740206    0.980241    0.770905    0.993243    0.879369    0.781985    0.771527    4600        75.798146   0.036915    0.240525    112.941220 
[37m[36mINFO[0m[0m 03/30 15:00:05 | 0.776535    0.764638    0.989984    0.803239    1.204912    0.995366    0.750515    0.978809    0.765178    0.995777    0.894025    0.776535    0.764638    4800        79.093718   0.031967    0.307121    112.651441 
[37m[36mINFO[0m[0m 03/30 15:03:10 | 0.772806    0.779564    0.990172    0.802194    1.066766    0.993306    0.738144    0.984250    0.778923    0.992962    0.889515    0.772806    0.779564    5000        82.389289   0.030564    0.360968    112.513492 
[37m[36mINFO[0m[0m 03/30 15:03:10 | Cumulative gradient change saved at train_output/OfficeHome/GENIE_hp_p/[3]/250330_13-47-53_resnet50_sgd_p08/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/30 15:03:13 | ---
[37m[36mINFO[0m[0m 03/30 15:03:13 | test-domain validation(oracle) = 77.682%
[37m[36mINFO[0m[0m 03/30 15:03:13 | training-domain validation(iid) = 77.653%
[37m[36mINFO[0m[0m 03/30 15:03:13 | last = 77.281%
[37m[36mINFO[0m[0m 03/30 15:03:13 | last (inD) = 80.219%
[37m[36mINFO[0m[0m 03/30 15:03:13 | training-domain validation (iid, inD) = 80.324%
[37m[36mINFO[0m[0m 03/30 15:03:13 | === Summary ===
[37m[36mINFO[0m[0m 03/30 15:03:13 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd_p08 config/resnet50_sgd.yaml --algorithm GENIE_hp_p --test_envs 3 --dataset OfficeHome --trial_seed 2
[37m[36mINFO[0m[0m 03/30 15:03:13 | Unique name: 250330_13-47-53_resnet50_sgd_p08
[37m[36mINFO[0m[0m 03/30 15:03:13 | Out path: train_output/OfficeHome/GENIE_hp_p/[3]/250330_13-47-53_resnet50_sgd_p08
[37m[36mINFO[0m[0m 03/30 15:03:13 | Algorithm: GENIE_hp_p
[37m[36mINFO[0m[0m 03/30 15:03:13 | Dataset: OfficeHome

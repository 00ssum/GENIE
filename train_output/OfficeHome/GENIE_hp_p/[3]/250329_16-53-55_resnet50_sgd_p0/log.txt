[37m[36mINFO[0m[0m 03/29 16:53:55 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd_p0 config/resnet50_sgd.yaml --algorithm GENIE_hp_p --test_envs 3 --dataset OfficeHome --trial_seed 2
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE_hp_p
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd_p0
	out_dir: train_output/OfficeHome/GENIE_hp_p/[3]/250329_16-53-55_resnet50_sgd_p0
	out_root: train_output/OfficeHome/GENIE_hp_p/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250329_16-53-55_resnet50_sgd_p0
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	momentum: 0.9
	convergence_rate: 0.015
	moving_avg: 0.95
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/29 16:53:55 | n_steps = 5001
[37m[36mINFO[0m[0m 03/29 16:53:55 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/29 16:53:55 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/29 16:53:55 | 
[37m[36mINFO[0m[0m 03/29 16:53:55 | Testenv name escaping te_R -> te_R
[37m[36mINFO[0m[0m 03/29 16:53:55 | Test envs = [3], name = te_R
[37m[36mINFO[0m[0m 03/29 16:53:55 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/29 16:53:55 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 03/29 16:53:55 | steps-per-epoch for each domain: 60.69, 109.12, 111.00 -> min = 60.69
[37m[36mINFO[0m[0m 03/29 16:53:56 | # of params = 23641217
[37m[36mINFO[0m[0m 03/29 16:55:55 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/29 16:55:55 | 0.023523    0.027555    0.016551    0.022783    4.214314    0.019567    0.020619    0.014318    0.024055    0.015766    0.023675    0.023523    0.027555    0           0.000000    4.265646    1.284232    117.223539 
[37m[36mINFO[0m[0m 03/29 16:59:06 | 0.757315    0.762342    0.804235    0.730729    0.962899    0.804325    0.684536    0.749427    0.663230    0.858953    0.844419    0.757315    0.762342    200         3.295572    1.577093    0.360283    118.844009 
[37m[36mINFO[0m[0m 03/29 17:02:14 | 0.766208    0.746269    0.883341    0.771813    0.900986    0.899073    0.740206    0.839633    0.730813    0.911318    0.844419    0.766208    0.746269    400         6.591143    0.547200    0.371663    114.183597 
[37m[36mINFO[0m[0m 03/29 17:05:10 | 0.757602    0.752009    0.911274    0.766526    0.998132    0.925335    0.717526    0.879152    0.734250    0.929336    0.847802    0.757602    0.752009    600         9.886715    0.337954    0.302216    115.974693 
[37m[36mINFO[0m[0m 03/29 17:07:51 | 0.777108    0.769231    0.940731    0.772591    0.972866    0.960865    0.705155    0.907216    0.742268    0.954110    0.870349    0.777108    0.769231    800         13.182286   0.235646    0.228447    114.416334 
[37m[36mINFO[0m[0m 03/29 17:10:39 | 0.773379    0.768083    0.956759    0.779216    0.944964    0.977343    0.711340    0.928408    0.752577    0.964527    0.873732    0.773379    0.768083    1000        16.477858   0.188857    0.271060    113.756585 
[37m[36mINFO[0m[0m 03/29 17:13:43 | 0.777108    0.772675    0.959664    0.778390    1.033116    0.973738    0.725773    0.941008    0.752577    0.964245    0.856821    0.777108    0.772675    1200        19.773429   0.146492    0.350843    114.246197 
[37m[36mINFO[0m[0m 03/29 17:16:52 | 0.772806    0.754305    0.961295    0.789220    1.037943    0.975283    0.729897    0.939290    0.764032    0.969313    0.873732    0.772806    0.754305    1400        23.069001   0.109825    0.379027    112.973280 
[37m[36mINFO[0m[0m 03/29 17:19:50 | 0.765921    0.765786    0.962052    0.774588    1.112975    0.977858    0.703093    0.937858    0.752577    0.970439    0.868095    0.765921    0.765786    1600        26.364573   0.107024    0.301204    117.909434 
[37m[36mINFO[0m[0m 03/29 17:22:31 | 0.772519    0.758898    0.970350    0.779540    1.092821    0.976313    0.713402    0.953036    0.754868    0.981700    0.870349    0.772519    0.758898    1800        29.660144   0.091602    0.231573    115.013281 
[37m[36mINFO[0m[0m 03/29 17:25:21 | 0.777395    0.789897    0.982195    0.790583    1.052207    0.990731    0.734021    0.969931    0.761741    0.985923    0.875986    0.777395    0.789897    2000        32.955716   0.073841    0.271167    115.445574 
[37m[36mINFO[0m[0m 03/29 17:28:26 | 0.781411    0.779564    0.974779    0.786214    1.060328    0.985582    0.729897    0.957617    0.764032    0.981137    0.864713    0.781411    0.779564    2200        36.251287   0.072555    0.361188    112.749342 
[37m[36mINFO[0m[0m 03/29 17:31:33 | 0.772806    0.772675    0.972653    0.786431    1.229383    0.978888    0.723711    0.959622    0.768614    0.979448    0.866967    0.772806    0.772675    2400        39.546859   0.062194    0.358753    115.697580 
[37m[36mINFO[0m[0m 03/29 17:34:31 | 0.778256    0.791045    0.983433    0.794435    1.173878    0.990731    0.742268    0.973081    0.757159    0.986486    0.883878    0.778256    0.791045    2600        42.842430   0.061139    0.299460    117.914143 
[37m[36mINFO[0m[0m 03/29 17:37:11 | 0.757889    0.758898    0.977788    0.789908    1.096254    0.984037    0.742268    0.966781    0.753723    0.982545    0.873732    0.757889    0.758898    2800        46.138002   0.053322    0.237554    111.879052 
[37m[36mINFO[0m[0m 03/29 17:40:05 | 0.757315    0.752009    0.985195    0.794576    1.157245    0.991761    0.738144    0.975086    0.759450    0.988739    0.886133    0.757315    0.752009    3000        49.433574   0.049878    0.296619    115.329448 
[37m[36mINFO[0m[0m 03/29 17:43:13 | 0.765634    0.757750    0.984206    0.780304    1.154694    0.990216    0.723711    0.974227    0.746850    0.988176    0.870349    0.765634    0.757750    3200        52.729145   0.046581    0.359961    115.367225 
[37m[36mINFO[0m[0m 03/29 17:46:22 | 0.770511    0.756602    0.988527    0.808521    1.155333    0.993821    0.762887    0.978236    0.770905    0.993525    0.891770    0.770511    0.756602    3400        56.024717   0.042631    0.375847    113.750769 
[37m[36mINFO[0m[0m 03/29 17:49:14 | 0.773092    0.763490    0.985036    0.790464    1.102487    0.990731    0.736082    0.974513    0.751432    0.989865    0.883878    0.773092    0.763490    3600        59.320288   0.044557    0.301324    111.818342 
[37m[36mINFO[0m[0m 03/29 17:52:00 | 0.786575    0.781860    0.990619    0.804968    1.114867    0.993821    0.756701    0.983104    0.773196    0.994932    0.885006    0.786575    0.781860    3800        62.615860   0.035870    0.241572    118.116769 
[37m[36mINFO[0m[0m 03/29 17:54:50 | 0.765060    0.780712    0.986140    0.795299    1.270986    0.991761    0.740206    0.976231    0.766323    0.990428    0.879369    0.765060    0.780712    4000        65.911432   0.031844    0.279716    114.040234 
[37m[36mINFO[0m[0m 03/29 17:57:52 | 0.779690    0.768083    0.989593    0.804256    1.127591    0.993306    0.754639    0.981386    0.768614    0.994088    0.889515    0.779690    0.768083    4200        69.207003   0.035202    0.349510    112.459038 
[37m[36mINFO[0m[0m 03/29 18:00:58 | 0.776822    0.772675    0.987679    0.804544    1.155590    0.993821    0.736082    0.977663    0.784651    0.991554    0.892897    0.776822    0.772675    4400        72.502575   0.036728    0.371394    111.296602 
[37m[36mINFO[0m[0m 03/29 18:03:51 | 0.787435    0.770379    0.989867    0.800309    1.219040    0.993821    0.748454    0.982818    0.767468    0.992962    0.885006    0.787435    0.770379    4600        75.798146   0.031916    0.289634    115.225082 
[37m[36mINFO[0m[0m 03/29 18:06:32 | 0.778830    0.771527    0.990121    0.797984    1.198840    0.994336    0.740206    0.980813    0.776632    0.995214    0.877114    0.778830    0.771527    4800        79.093718   0.031997    0.235362    113.504177 
[37m[36mINFO[0m[0m 03/29 18:09:26 | 0.775961    0.764638    0.988504    0.793061    1.127617    0.992276    0.717526    0.982245    0.777778    0.990991    0.883878    0.775961    0.764638    5000        82.389289   0.030998    0.291689    116.059253 
[37m[36mINFO[0m[0m 03/29 18:09:26 | Cumulative gradient change saved at train_output/OfficeHome/GENIE_hp_p/[3]/250329_16-53-55_resnet50_sgd_p0/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/29 18:09:28 | ---
[37m[36mINFO[0m[0m 03/29 18:09:28 | test-domain validation(oracle) = 77.826%
[37m[36mINFO[0m[0m 03/29 18:09:28 | training-domain validation(iid) = 77.051%
[37m[36mINFO[0m[0m 03/29 18:09:28 | last = 77.596%
[37m[36mINFO[0m[0m 03/29 18:09:28 | last (inD) = 79.306%
[37m[36mINFO[0m[0m 03/29 18:09:28 | training-domain validation (iid, inD) = 80.852%
[37m[36mINFO[0m[0m 03/29 18:09:28 | === Summary ===
[37m[36mINFO[0m[0m 03/29 18:09:28 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd_p0 config/resnet50_sgd.yaml --algorithm GENIE_hp_p --test_envs 3 --dataset OfficeHome --trial_seed 2
[37m[36mINFO[0m[0m 03/29 18:09:28 | Unique name: 250329_16-53-55_resnet50_sgd_p0
[37m[36mINFO[0m[0m 03/29 18:09:28 | Out path: train_output/OfficeHome/GENIE_hp_p/[3]/250329_16-53-55_resnet50_sgd_p0
[37m[36mINFO[0m[0m 03/29 18:09:28 | Algorithm: GENIE_hp_p
[37m[36mINFO[0m[0m 03/29 18:09:28 | Dataset: OfficeHome

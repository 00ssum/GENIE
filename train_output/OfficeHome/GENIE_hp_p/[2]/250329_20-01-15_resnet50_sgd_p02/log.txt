[37m[36mINFO[0m[0m 03/29 20:01:15 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd_p02 config/resnet50_sgd.yaml --algorithm GENIE_hp_p --test_envs 2 --dataset OfficeHome --trial_seed 0
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE_hp_p
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: OfficeHome
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd_p02
	out_dir: train_output/OfficeHome/GENIE_hp_p/[2]/250329_20-01-15_resnet50_sgd_p02
	out_root: train_output/OfficeHome/GENIE_hp_p/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250329_20-01-15_resnet50_sgd_p02
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	momentum: 0.9
	convergence_rate: 0.015
	moving_avg: 0.95
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[OfficeHome] #envs=4, #classes=65
	env0: A (#2427)
	env1: C (#4365)
	env2: P (#4439)
	env3: R (#4357)

[37m[36mINFO[0m[0m 03/29 20:01:15 | n_steps = 5001
[37m[36mINFO[0m[0m 03/29 20:01:15 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/29 20:01:15 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/29 20:01:15 | 
[37m[36mINFO[0m[0m 03/29 20:01:15 | Testenv name escaping te_P -> te_P
[37m[36mINFO[0m[0m 03/29 20:01:15 | Test envs = [2], name = te_P
[37m[36mINFO[0m[0m 03/29 20:01:15 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 03/29 20:01:15 | Batch sizes for each domain: [32, 32, 0, 32] (total=96)
[37m[36mINFO[0m[0m 03/29 20:01:15 | steps-per-epoch for each domain: 60.69, 109.12, 108.94 -> min = 60.69
[37m[36mINFO[0m[0m 03/29 20:01:16 | # of params = 23641217
[37m[36mINFO[0m[0m 03/29 20:03:10 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/29 20:03:10 | 0.006757    0.007892    0.017031    0.014982    4.222745    0.024717    0.018557    0.008305    0.006873    0.006757    0.007892    0.018072    0.019518    0           0.000000    4.290899    1.258566    112.763304 
[37m[36mINFO[0m[0m 03/29 20:06:50 | 0.691160    0.684329    0.775889    0.721846    1.093984    0.800206    0.752577    0.711913    0.655212    0.691160    0.684329    0.815548    0.757750    200         3.295572    1.641899    0.501699    119.127427 
[37m[36mINFO[0m[0m 03/29 20:10:23 | 0.742680    0.726043    0.867970    0.757389    0.974886    0.896498    0.752577    0.827320    0.718213    0.742680    0.726043    0.880092    0.801378    400         6.591143    0.566391    0.510772    111.184546 
[37m[36mINFO[0m[0m 03/29 20:14:00 | 0.735079    0.723788    0.900987    0.755100    1.024714    0.925335    0.742268    0.865979    0.719359    0.735079    0.723788    0.911647    0.803674    600         9.886715    0.379285    0.512296    114.494357 
[37m[36mINFO[0m[0m 03/29 20:17:31 | 0.742962    0.749718    0.920786    0.763652    1.035875    0.939753    0.738144    0.899485    0.750286    0.742962    0.749718    0.923121    0.802526    800         13.182286   0.265460    0.488823    112.713534 
[37m[36mINFO[0m[0m 03/29 20:21:14 | 0.753097    0.723788    0.953229    0.759449    1.141486    0.973738    0.748454    0.930985    0.731959    0.753097    0.723788    0.954963    0.797933    1000        16.477858   0.194534    0.521335    118.952608 
[37m[36mINFO[0m[0m 03/29 20:24:54 | 0.742117    0.721533    0.954662    0.774810    1.043763    0.973738    0.756701    0.933562    0.753723    0.742117    0.721533    0.956684    0.814007    1200        19.773429   0.152328    0.509036    117.929588 
[37m[36mINFO[0m[0m 03/29 20:28:31 | 0.732264    0.719278    0.961192    0.764574    1.212037    0.977858    0.744330    0.944731    0.739977    0.732264    0.719278    0.960987    0.809414    1400        23.069001   0.124182    0.515203    114.664915 
[37m[36mINFO[0m[0m 03/29 20:32:10 | 0.750000    0.735062    0.971795    0.774131    1.250697    0.983007    0.744330    0.955040    0.753723    0.750000    0.735062    0.977338    0.824340    1600        26.364573   0.106664    0.514427    116.306150 
[37m[36mINFO[0m[0m 03/29 20:35:48 | 0.759572    0.733935    0.975822    0.776878    1.161709    0.987642    0.752577    0.961340    0.756014    0.759572    0.733935    0.978485    0.822044    1800        29.660144   0.081614    0.511374    115.633080 
[37m[36mINFO[0m[0m 03/29 20:39:29 | 0.747185    0.741826    0.978343    0.786662    1.230128    0.989186    0.767010    0.965922    0.759450    0.747185    0.741826    0.979920    0.833525    2000        32.955716   0.078386    0.522386    116.073565 
[37m[36mINFO[0m[0m 03/29 20:43:10 | 0.753941    0.739572    0.983348    0.773127    1.191559    0.990731    0.760825    0.973368    0.749141    0.753941    0.739572    0.985944    0.809414    2200        36.251287   0.069990    0.516793    117.885146 
[37m[36mINFO[0m[0m 03/29 20:46:53 | 0.744088    0.717024    0.977313    0.764569    1.268909    0.983522    0.754639    0.969072    0.735395    0.744088    0.717024    0.979346    0.803674    2400        39.546859   0.058292    0.537040    115.158609 
[37m[36mINFO[0m[0m 03/29 20:50:34 | 0.757601    0.726043    0.985105    0.760302    1.410663    0.992276    0.736082    0.974513    0.729668    0.757601    0.726043    0.988526    0.815155    2600        42.842430   0.055394    0.526878    116.204372 
[37m[36mINFO[0m[0m 03/29 20:54:10 | 0.744369    0.732807    0.982833    0.761365    1.349945    0.989186    0.738144    0.972222    0.738832    0.744369    0.732807    0.987091    0.807118    2800        46.138002   0.057588    0.505345    114.308222 
[37m[36mINFO[0m[0m 03/29 20:57:47 | 0.766047    0.728298    0.986689    0.764032    1.379635    0.993306    0.738144    0.977950    0.753723    0.766047    0.728298    0.988812    0.800230    3000        49.433574   0.050896    0.515518    114.311740 
[37m[36mINFO[0m[0m 03/29 21:01:23 | 0.762387    0.747463    0.985331    0.771595    1.313393    0.996395    0.760825    0.974227    0.750286    0.762387    0.747463    0.985370    0.803674    3200        52.729145   0.042104    0.503088    115.498970 
[37m[36mINFO[0m[0m 03/29 21:05:01 | 0.759572    0.749718    0.987950    0.774277    1.311200    0.992791    0.750515    0.981386    0.757159    0.759572    0.749718    0.989673    0.815155    3400        56.024717   0.040861    0.522555    113.454927 
[37m[36mINFO[0m[0m 03/29 21:08:36 | 0.756194    0.739572    0.989154    0.780698    1.273289    0.993821    0.762887    0.981959    0.754868    0.756194    0.739572    0.991681    0.824340    3600        59.320288   0.039980    0.507359    113.598397 
[37m[36mINFO[0m[0m 03/29 21:12:13 | 0.762950    0.738444    0.990509    0.784140    1.292457    0.995881    0.762887    0.982245    0.758305    0.762950    0.738444    0.993402    0.831228    3800        62.615860   0.037517    0.526329    111.658272 
[37m[36mINFO[0m[0m 03/29 21:15:51 | 0.764358    0.741826    0.988390    0.779857    1.385950    0.993821    0.764948    0.979095    0.751432    0.764358    0.741826    0.992255    0.823192    4000        65.911432   0.031268    0.521707    113.803849 
[37m[36mINFO[0m[0m 03/29 21:19:27 | 0.748029    0.719278    0.981784    0.753712    1.597992    0.986612    0.738144    0.971363    0.736541    0.748029    0.719278    0.987378    0.786452    4200        69.207003   0.035929    0.519198    112.314604 
[37m[36mINFO[0m[0m 03/29 21:22:59 | 0.754505    0.745209    0.989421    0.770076    1.333796    0.994336    0.740206    0.981959    0.756014    0.754505    0.745209    0.991968    0.814007    4400        72.502575   0.034781    0.501459    111.307607 
[37m[36mINFO[0m[0m 03/29 21:26:36 | 0.750845    0.737317    0.989326    0.769387    1.387945    0.994336    0.758763    0.980813    0.737686    0.750845    0.737317    0.992828    0.811711    4600        75.798146   0.034268    0.509346    115.352728 
[37m[36mINFO[0m[0m 03/29 21:30:11 | 0.755349    0.733935    0.991579    0.781468    1.347370    0.995366    0.752577    0.984536    0.759450    0.755349    0.733935    0.994836    0.832377    4800        79.093718   0.033306    0.510444    112.384091 
[37m[36mINFO[0m[0m 03/29 21:33:47 | 0.756475    0.732807    0.987722    0.771826    1.539519    0.991246    0.744330    0.981672    0.765178    0.756475    0.732807    0.990247    0.805970    5000        82.389289   0.029541    0.516623    112.599301 
[37m[36mINFO[0m[0m 03/29 21:33:47 | Cumulative gradient change saved at train_output/OfficeHome/GENIE_hp_p/[2]/250329_20-01-15_resnet50_sgd_p02/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/29 21:33:48 | ---
[37m[36mINFO[0m[0m 03/29 21:33:48 | test-domain validation(oracle) = 74.296%
[37m[36mINFO[0m[0m 03/29 21:33:48 | training-domain validation(iid) = 74.718%
[37m[36mINFO[0m[0m 03/29 21:33:48 | last = 75.648%
[37m[36mINFO[0m[0m 03/29 21:33:48 | last (inD) = 77.183%
[37m[36mINFO[0m[0m 03/29 21:33:48 | training-domain validation (iid, inD) = 78.666%
[37m[36mINFO[0m[0m 03/29 21:33:49 | === Summary ===
[37m[36mINFO[0m[0m 03/29 21:33:49 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd_p02 config/resnet50_sgd.yaml --algorithm GENIE_hp_p --test_envs 2 --dataset OfficeHome --trial_seed 0
[37m[36mINFO[0m[0m 03/29 21:33:49 | Unique name: 250329_20-01-15_resnet50_sgd_p02
[37m[36mINFO[0m[0m 03/29 21:33:49 | Out path: train_output/OfficeHome/GENIE_hp_p/[2]/250329_20-01-15_resnet50_sgd_p02
[37m[36mINFO[0m[0m 03/29 21:33:49 | Algorithm: GENIE_hp_p
[37m[36mINFO[0m[0m 03/29 21:33:49 | Dataset: OfficeHome

[37m[36mINFO[0m[0m 05/01 16:59:52 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 2 --dataset DomainNet --trial_seed 2 --hparams_seed 3
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: DomainNet
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 3
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/DomainNet/GENIE/[2]/250501_16-59-52_resnet50_sgd
	out_root: train_output/DomainNet/GENIE/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 2
	unique_name: 250501_16-59-52_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 0.0002649077542048787
	batch_size: 17
	weight_decay: 0.0023111806563778695
	momentum: 0.8125216593488789
	convergence_rate: 0.0014082699681704626
	moving_avg: 0.9196111047565869
	p: 0.4412278223193331
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[DomainNet] #envs=6, #classes=345
	env0: clip (#48129)
	env1: info (#51605)
	env2: paint (#72266)
	env3: quick (#172500)
	env4: real (#172947)
	env5: sketch (#69128)

[37m[36mINFO[0m[0m 05/01 16:59:53 | n_steps = 15001
[37m[36mINFO[0m[0m 05/01 16:59:53 | checkpoint_freq = 1000
[37m[36mINFO[0m[0m 05/01 16:59:53 | n_steps is updated to 15001 => 15001 for checkpointing
[37m[36mINFO[0m[0m 05/01 16:59:53 | 
[37m[36mINFO[0m[0m 05/01 16:59:54 | Testenv name escaping te_paint -> te_paint
[37m[36mINFO[0m[0m 05/01 16:59:54 | Test envs = [2], name = te_paint
[37m[36mINFO[0m[0m 05/01 16:59:54 | Train environments: [0, 1, 3, 4, 5], Test environments: [2]
[37m[36mINFO[0m[0m 05/01 16:59:54 | Batch sizes for each domain: [17, 17, 0, 17, 17, 17] (total=85)
[37m[36mINFO[0m[0m 05/01 16:59:54 | steps-per-epoch for each domain: 2264.94, 2428.47, 8117.65, 8138.71, 3253.12 -> min = 2264.94
[37m[36mINFO[0m[0m 05/01 16:59:55 | # of params = 24214937
[37m[36mINFO[0m[0m 05/01 17:42:52 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    env4_in     env4_out    env5_in     env5_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 05/01 17:42:52 | 0.003200    0.002352    0.002821    0.002643    5.908072    0.003636    0.002909    0.002204    0.002519    0.003200    0.002352    0.003899    0.003797    0.001655    0.002110    0.002712    0.001881    0           0.000000    5.870948    1.177801    2575.54164 
[37m[36mINFO[0m[0m 05/01 18:30:04 | 0.021691    0.021587    0.029134    0.028713    5.650096    0.035347    0.035013    0.031780    0.031102    0.021691    0.021587    0.004594    0.004696    0.037894    0.034202    0.036056    0.038553    1000        0.441513    5.793907    0.249352    2582.17749 
[37m[36mINFO[0m[0m 05/01 19:15:59 | 0.275941    0.281326    0.295975    0.296688    3.447442    0.379779    0.382026    0.167644    0.151826    0.275941    0.281326    0.147478    0.158174    0.443870    0.461361    0.341103    0.330054    2000        0.883025    4.446846    0.248517    2507.14221 
[37m[36mINFO[0m[0m 05/01 20:01:58 | 0.360974    0.364907    0.396916    0.397662    2.853068    0.496883    0.501818    0.222047    0.199496    0.360974    0.364907    0.259065    0.275594    0.565215    0.581890    0.441368    0.429512    3000        1.324538    3.091765    0.250049    2508.68001 
[37m[36mINFO[0m[0m 05/01 20:48:33 | 0.396935    0.402131    0.446090    0.443307    2.627499    0.560072    0.563636    0.245059    0.215386    0.396935    0.402131    0.333775    0.350986    0.604157    0.619041    0.487388    0.467486    4000        1.766050    2.695847    0.250912    2544.28318 
[37m[36mINFO[0m[0m 05/01 21:34:36 | 0.411361    0.417284    0.475515    0.472730    2.476719    0.586536    0.585247    0.267731    0.234764    0.411361    0.417284    0.379928    0.402000    0.630914    0.643124    0.512468    0.498517    5000        2.207563    2.491112    0.257784    2505.28447 
[37m[36mINFO[0m[0m 05/01 22:21:53 | 0.412001    0.417699    0.493976    0.486410    2.380552    0.613079    0.606857    0.281199    0.240190    0.412001    0.417699    0.404935    0.423101    0.643917    0.654630    0.526753    0.507269    6000        2.649075    2.367343    0.279074    2557.12110 
[37m[36mINFO[0m[0m 05/01 23:08:58 | 0.432342    0.436172    0.513179    0.503138    2.300240    0.629753    0.623377    0.296434    0.249782    0.432342    0.436172    0.427377    0.444522    0.662831    0.669982    0.549500    0.528029    7000        3.090588    2.265428    0.295748    2529.60692 
[37m[36mINFO[0m[0m 05/01 23:56:34 | 0.440714    0.442054    0.520282    0.509415    2.258177    0.641752    0.628260    0.302103    0.259083    0.440714    0.442054    0.430913    0.446580    0.668339    0.676949    0.558306    0.536203    8000        3.532101    2.186312    0.294419    2561.67416 
[37m[36mINFO[0m[0m 05/02 00:43:10 | 0.439936    0.443507    0.536196    0.522795    2.200547    0.659100    0.642701    0.315861    0.264025    0.439936    0.443507    0.455717    0.473594    0.680098    0.689208    0.570204    0.544448    9000        3.973613    2.112405    0.261855    2533.75633 
[37m[36mINFO[0m[0m 05/02 01:30:11 | 0.445419    0.445375    0.545111    0.531153    2.162066    0.671722    0.654961    0.323636    0.276427    0.445419    0.445375    0.468768    0.481188    0.684514    0.691723    0.576913    0.551465    10000       4.415126    2.065056    0.245603    2575.59882 
[37m[36mINFO[0m[0m 05/02 02:16:29 | 0.447719    0.449388    0.554325    0.538460    2.125841    0.680760    0.661610    0.330128    0.276233    0.447719    0.449388    0.479609    0.495188    0.693238    0.700714    0.587889    0.558553    11000       4.856638    2.017618    0.254720    2523.74705 
[37m[36mINFO[0m[0m 05/02 03:02:40 | 0.457977    0.460596    0.563241    0.544536    2.092149    0.687617    0.667844    0.340326    0.279624    0.457977    0.460596    0.496913    0.510435    0.696989    0.703692    0.594362    0.561085    12000       5.298151    1.977930    0.246642    2523.66892 
[37m[36mINFO[0m[0m 05/02 03:48:42 | 0.465899    0.465094    0.571284    0.548880    2.069718    0.694863    0.668364    0.351516    0.287860    0.465899    0.465094    0.504855    0.512870    0.705091    0.708722    0.600094    0.566582    13000       5.739663    1.941147    0.242217    2520.26858 
[37m[36mINFO[0m[0m 05/02 04:35:21 | 0.461609    0.465578    0.575563    0.551625    2.049801    0.704628    0.677091    0.350136    0.283015    0.461609    0.465578    0.507674    0.517449    0.708539    0.711527    0.606839    0.569042    14000       6.181176    1.897544    0.240432    2558.28830 
[37m[36mINFO[0m[0m 05/02 05:21:20 | 0.470136    0.471736    0.580618    0.558063    2.020014    0.707329    0.676675    0.356579    0.292704    0.470136    0.471736    0.513435    0.526725    0.711820    0.713377    0.613927    0.580832    15000       6.622689    1.868619    0.239004    2520.49955 
[37m[36mINFO[0m[0m 05/02 05:21:21 | Cumulative gradient change saved at train_output/DomainNet/GENIE/[2]/250501_16-59-52_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 05/02 05:21:22 | ---
[37m[36mINFO[0m[0m 05/02 05:21:22 | test-domain validation(oracle) = 47.014%
[37m[36mINFO[0m[0m 05/02 05:21:22 | training-domain validation(iid) = 47.014%
[37m[36mINFO[0m[0m 05/02 05:21:22 | last = 47.014%
[37m[36mINFO[0m[0m 05/02 05:21:22 | last (inD) = 55.806%
[37m[36mINFO[0m[0m 05/02 05:21:22 | training-domain validation (iid, inD) = 55.806%
[37m[36mINFO[0m[0m 05/02 05:21:22 | === Summary ===
[37m[36mINFO[0m[0m 05/02 05:21:22 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 2 --dataset DomainNet --trial_seed 2 --hparams_seed 3
[37m[36mINFO[0m[0m 05/02 05:21:22 | Unique name: 250501_16-59-52_resnet50_sgd
[37m[36mINFO[0m[0m 05/02 05:21:22 | Out path: train_output/DomainNet/GENIE/[2]/250501_16-59-52_resnet50_sgd
[37m[36mINFO[0m[0m 05/02 05:21:22 | Algorithm: GENIE
[37m[36mINFO[0m[0m 05/02 05:21:22 | Dataset: DomainNet

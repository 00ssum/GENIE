[37m[36mINFO[0m[0m 01/14 17:57:14 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 3 --dataset DomainNet --trial_seed 0 --hparams_seed 0
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: DomainNet
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/DomainNet/GENIE/[3]/250114_17-57-14_resnet50_sgd
	out_root: train_output/DomainNet/GENIE/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250114_17-57-14_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	momentum: 0.9
	convergence_rate: 0.015
	moving_avg: 0.95
	p: 0.4
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[DomainNet] #envs=6, #classes=345
	env0: clip (#48129)
	env1: info (#51605)
	env2: paint (#72266)
	env3: quick (#172500)
	env4: real (#172947)
	env5: sketch (#69128)

[37m[36mINFO[0m[0m 01/14 17:57:14 | n_steps = 15001
[37m[36mINFO[0m[0m 01/14 17:57:14 | checkpoint_freq = 1000
[37m[36mINFO[0m[0m 01/14 17:57:14 | n_steps is updated to 15001 => 15001 for checkpointing
[37m[36mINFO[0m[0m 01/14 17:57:14 | Target test envs = [[3]]
[37m[36mINFO[0m[0m 01/14 17:57:14 | 
[37m[36mINFO[0m[0m 01/14 17:57:15 | Testenv name escaping te_quick -> te_quick
[37m[36mINFO[0m[0m 01/14 17:57:15 | Test envs = [3], name = te_quick
[37m[36mINFO[0m[0m 01/14 17:57:15 | Batch sizes for each domain: [32, 32, 32, 0, 32, 32] (total=160)
[37m[36mINFO[0m[0m 01/14 17:57:15 | steps-per-epoch for each domain: 1203.25, 1290.12, 1806.66, 4323.69, 1728.22 -> min = 1203.25
[37m[36mINFO[0m[0m 01/14 17:57:16 | # of params = 24214937
[37m[36mINFO[0m[0m 01/14 18:33:37 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    env4_in     env4_out    env5_in     env5_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/14 18:33:37 | 0.003652    0.003913    0.003060    0.002459    5.898748    0.003480    0.003636    0.002664    0.001260    0.004480    0.003598    0.003652    0.003913    0.002053    0.001995    0.002622    0.001808    0           0.000000    5.938574    1.382038    2179.67136 
[37m[36mINFO[0m[0m 01/14 19:15:41 | 0.091906    0.093478    0.510255    0.501874    2.362029    0.593185    0.598234    0.279673    0.241159    0.521786    0.525012    0.091906    0.093478    0.637202    0.649773    0.519429    0.495190    1000        0.831082    3.247175    0.367511    2155.69656 
[37m[36mINFO[0m[0m 01/14 19:58:19 | 0.102174    0.103014    0.562717    0.543643    2.146705    0.661516    0.651013    0.325937    0.272164    0.572224    0.562721    0.102174    0.103014    0.677395    0.680708    0.576515    0.551609    2000        1.662165    2.114874    0.368136    2189.11488 
[37m[36mINFO[0m[0m 01/14 20:40:42 | 0.123406    0.124377    0.595861    0.568208    2.049014    0.702265    0.679584    0.361690    0.293576    0.605556    0.586453    0.123406    0.124377    0.700805    0.704501    0.608990    0.576926    3000        2.493247    1.901851    0.381258    2162.14680 
[37m[36mINFO[0m[0m 01/14 21:24:22 | 0.131159    0.129942    0.621003    0.584817    1.948809    0.737300    0.702649    0.379566    0.300262    0.634390    0.608593    0.131159    0.129942    0.719055    0.716268    0.634703    0.596311    4000        3.324330    1.771065    0.393268    2226.65444 
[37m[36mINFO[0m[0m 01/14 22:07:37 | 0.116486    0.116928    0.634375    0.589805    1.928740    0.754337    0.710545    0.400010    0.307722    0.641015    0.611776    0.116486    0.116928    0.728465    0.724334    0.648048    0.594647    5000        4.155412    1.658079    0.417600    2176.29241 
[37m[36mINFO[0m[0m 01/14 22:51:06 | 0.131725    0.129043    0.650577    0.600998    1.899048    0.768492    0.715636    0.422246    0.321480    0.659540    0.624576    0.131725    0.129043    0.733004    0.726445    0.669602    0.616854    6000        4.986495    1.584947    0.423397    2185.49880 
[37m[36mINFO[0m[0m 01/14 23:34:37 | 0.125065    0.121217    0.668696    0.608118    1.876236    0.787061    0.725403    0.443731    0.324484    0.678688    0.635508    0.125065    0.121217    0.751254    0.738848    0.682748    0.616347    7000        5.817577    1.507606    0.423820    2186.76796 
[37m[36mINFO[0m[0m 01/15 00:18:03 | 0.135964    0.133275    0.677400    0.611636    1.865677    0.795398    0.726130    0.457320    0.333495    0.688859    0.635439    0.135964    0.133275    0.755713    0.744167    0.689709    0.618951    8000        6.648660    1.444976    0.422395    2183.53423 
[37m[36mINFO[0m[0m 01/15 01:01:53 | 0.121594    0.120783    0.681171    0.608293    1.858708    0.797554    0.719688    0.457175    0.325744    0.698511    0.636684    0.121594    0.120783    0.753719    0.735841    0.698895    0.623508    9000        7.479742    1.387774    0.423210    2206.60269 
[37m[36mINFO[0m[0m 01/15 01:44:52 | 0.124783    0.123710    0.691701    0.610973    1.833392    0.815526    0.721662    0.475705    0.330104    0.699600    0.638414    0.124783    0.123710    0.757079    0.741103    0.710594    0.623580    10000       8.310825    1.327903    0.387983    2190.49236 
[37m[36mINFO[0m[0m 01/15 02:28:32 | 0.122768    0.122638    0.705446    0.618825    1.837573    0.824979    0.738597    0.499152    0.341730    0.712902    0.639383    0.122768    0.122638    0.768680    0.745410    0.721516    0.629005    11000       9.141907    1.279855    0.417122    2203.64310 
[37m[36mINFO[0m[0m 01/15 03:12:16 | 0.132225    0.131797    0.716888    0.621077    1.830001    0.837212    0.733818    0.516471    0.339599    0.727795    0.643465    0.132225    0.131797    0.774484    0.750961    0.728478    0.637541    12000       9.972990    1.236132    0.426710    2196.83664 
[37m[36mINFO[0m[0m 01/15 03:55:59 | 0.132152    0.132145    0.725083    0.621060    1.845760    0.846198    0.736935    0.527517    0.336014    0.731877    0.642704    0.132152    0.132145    0.778415    0.750730    0.741406    0.638915    13000       10.804072   1.195017    0.429168    2192.89664 
[37m[36mINFO[0m[0m 01/15 04:39:36 | 0.144580    0.143971    0.729001    0.619806    1.851124    0.851054    0.731117    0.538078    0.345412    0.733849    0.642981    0.144580    0.143971    0.775481    0.746104    0.746542    0.633418    14000       11.635155   1.148579    0.442380    2174.95061 
[37m[36mINFO[0m[0m 01/15 05:23:17 | 0.135725    0.136029    0.740460    0.624629    1.888450    0.861703    0.739325    0.553604    0.342215    0.745957    0.647478    0.135725    0.136029    0.783988    0.751164    0.757048    0.642966    15000       12.466237   1.105396    0.447556    2172.96959 
[37m[36mINFO[0m[0m 01/15 05:23:17 | ---
[37m[36mINFO[0m[0m 01/15 05:23:17 | test-domain validation(oracle) = 14.458%
[37m[36mINFO[0m[0m 01/15 05:23:17 | training-domain validation(iid) = 13.572%
[37m[36mINFO[0m[0m 01/15 05:23:17 | last = 13.572%
[37m[36mINFO[0m[0m 01/15 05:23:17 | last (inD) = 62.463%
[37m[36mINFO[0m[0m 01/15 05:23:17 | training-domain validation (iid, inD) = 62.463%
[37m[36mINFO[0m[0m 01/15 05:23:17 | === Summary ===
[37m[36mINFO[0m[0m 01/15 05:23:17 | Command: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 3 --dataset DomainNet --trial_seed 0 --hparams_seed 0
[37m[36mINFO[0m[0m 01/15 05:23:17 | Unique name: 250114_17-57-14_resnet50_sgd
[37m[36mINFO[0m[0m 01/15 05:23:17 | Out path: train_output/DomainNet/GENIE/[3]/250114_17-57-14_resnet50_sgd
[37m[36mINFO[0m[0m 01/15 05:23:17 | Algorithm: GENIE
[37m[36mINFO[0m[0m 01/15 05:23:17 | Dataset: DomainNet
[37m[36mINFO[0m[0m 01/15 05:23:17 | Max test_in: 0.1446

[37m[36mINFO[0m[0m 05/01 15:46:20 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 3 --dataset DomainNet --trial_seed 2 --hparams_seed 14
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: DomainNet
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 14
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/DomainNet/GENIE/[3]/250501_15-46-20_resnet50_sgd
	out_root: train_output/DomainNet/GENIE/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250501_15-46-20_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 4.223376545632674e-05
	batch_size: 21
	weight_decay: 1.4009530778122364e-05
	momentum: 0.97624308836667
	convergence_rate: 0.007433824219408728
	moving_avg: 0.9835243535862955
	p: 0.4547494637981545
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[DomainNet] #envs=6, #classes=345
	env0: clip (#48129)
	env1: info (#51605)
	env2: paint (#72266)
	env3: quick (#172500)
	env4: real (#172947)
	env5: sketch (#69128)

[37m[36mINFO[0m[0m 05/01 15:46:21 | n_steps = 15001
[37m[36mINFO[0m[0m 05/01 15:46:21 | checkpoint_freq = 1000
[37m[36mINFO[0m[0m 05/01 15:46:21 | n_steps is updated to 15001 => 15001 for checkpointing
[37m[36mINFO[0m[0m 05/01 15:46:21 | 
[37m[36mINFO[0m[0m 05/01 15:46:22 | Testenv name escaping te_quick -> te_quick
[37m[36mINFO[0m[0m 05/01 15:46:22 | Test envs = [3], name = te_quick
[37m[36mINFO[0m[0m 05/01 15:46:22 | Train environments: [0, 1, 2, 4, 5], Test environments: [3]
[37m[36mINFO[0m[0m 05/01 15:46:22 | Batch sizes for each domain: [21, 21, 21, 0, 21, 21] (total=105)
[37m[36mINFO[0m[0m 05/01 15:46:22 | steps-per-epoch for each domain: 1833.52, 1965.90, 2753.00, 6588.48, 2633.48 -> min = 1833.52
[37m[36mINFO[0m[0m 05/01 15:46:24 | # of params = 24214937
[37m[36mINFO[0m[0m 05/01 16:28:48 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    env4_in     env4_out    env5_in     env5_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 05/01 16:28:48 | 0.003841    0.003652    0.002835    0.002396    5.904779    0.003454    0.003221    0.002107    0.002035    0.004186    0.002906    0.003841    0.003652    0.001807    0.002371    0.002622    0.001447    0           0.000000    5.945378    2.347636    2541.43462 
[37m[36mINFO[0m[0m 05/01 17:15:50 | 0.051993    0.050667    0.319197    0.320297    3.433349    0.339809    0.338909    0.166699    0.155024    0.343729    0.355636    0.051993    0.050667    0.417265    0.429530    0.328481    0.322387    1000        0.545398    5.311174    0.291022    2531.11715 
[37m[36mINFO[0m[0m 05/01 18:02:57 | 0.085268    0.085014    0.484833    0.479483    2.510925    0.555968    0.556571    0.252253    0.219359    0.509384    0.512696    0.085268    0.085014    0.612520    0.624447    0.494042    0.484340    2000        1.090796    3.081763    0.310033    2516.61154 
[37m[36mINFO[0m[0m 05/01 18:50:08 | 0.097812    0.098174    0.531636    0.521136    2.282567    0.617053    0.605818    0.293673    0.253076    0.551433    0.552688    0.097812    0.098174    0.651043    0.660788    0.544979    0.533309    3000        1.636194    2.556709    0.286302    2545.05823 
[37m[36mINFO[0m[0m 05/01 19:36:56 | 0.117022    0.114493    0.557743    0.543031    2.179793    0.648270    0.636883    0.317338    0.267610    0.572293    0.566803    0.117022    0.114493    0.679541    0.686027    0.571271    0.557830    4000        2.181592    2.340352    0.281161    2526.49918 
[37m[36mINFO[0m[0m 05/01 20:22:37 | 0.112507    0.110870    0.577167    0.560255    2.082445    0.673411    0.656104    0.334318    0.285922    0.596527    0.591227    0.112507    0.110870    0.692876    0.698546    0.588702    0.569476    5000        2.726989    2.197209    0.279744    2461.31806 
[37m[36mINFO[0m[0m 05/01 21:08:32 | 0.113768    0.111449    0.589290    0.568116    2.040203    0.689669    0.666286    0.351855    0.297258    0.600142    0.592541    0.113768    0.111449    0.700205    0.705253    0.604578    0.579241    6000        3.272387    2.094458    0.276507    2478.79008 
[37m[36mINFO[0m[0m 05/01 21:55:21 | 0.113783    0.112261    0.603102    0.577722    1.996672    0.711822    0.684364    0.358032    0.300940    0.617422    0.602574    0.113783    0.112261    0.710418    0.711440    0.617815    0.589295    7000        3.817785    2.014468    0.285393    2523.11783 
[37m[36mINFO[0m[0m 05/01 22:43:06 | 0.128862    0.127159    0.616677    0.588221    1.927105    0.726470    0.695169    0.373268    0.313923    0.630049    0.609977    0.128862    0.127159    0.719835    0.719362    0.633763    0.602676    8000        4.363183    1.955726    0.282026    2583.15040 
[37m[36mINFO[0m[0m 05/01 23:30:47 | 0.114377    0.113884    0.623179    0.593288    1.910552    0.732158    0.700052    0.381480    0.320512    0.638369    0.612399    0.114377    0.113884    0.723890    0.723496    0.640001    0.609982    9000        4.908581    1.886857    0.290177    2570.82261 
[37m[36mINFO[0m[0m 05/02 00:17:39 | 0.128855    0.127014    0.628957    0.594731    1.907965    0.738547    0.702442    0.387487    0.320608    0.643246    0.620010    0.128855    0.127014    0.730222    0.726185    0.645281    0.604412    10000       5.453979    1.835325    0.301880    2509.88831 
[37m[36mINFO[0m[0m 05/02 01:04:50 | 0.134283    0.134290    0.640840    0.602985    1.865456    0.756363    0.714909    0.400567    0.326616    0.653123    0.624576    0.134283    0.134290    0.736083    0.729798    0.658066    0.619024    11000       5.999377    1.803337    0.305874    2525.84151 
[37m[36mINFO[0m[0m 05/02 01:51:19 | 0.124007    0.123101    0.647005    0.604948    1.854484    0.763271    0.717714    0.408488    0.326228    0.660509    0.631703    0.124007    0.123101    0.740622    0.735638    0.662134    0.613454    12000       6.544775    1.753489    0.300360    2487.70471 
[37m[36mINFO[0m[0m 05/02 02:38:06 | 0.133377    0.129536    0.650054    0.607820    1.849988    0.764492    0.715740    0.416990    0.332720    0.664038    0.633156    0.133377    0.129536    0.740304    0.733181    0.664449    0.624304    13000       7.090172    1.714528    0.299201    2508.38427 
[37m[36mINFO[0m[0m 05/02 03:25:41 | 0.134826    0.134348    0.658795    0.612337    1.832920    0.773608    0.720312    0.426194    0.339405    0.673153    0.638829    0.134826    0.134348    0.745775    0.737749    0.675244    0.625389    14000       7.635570    1.679788    0.300153    2554.60576 
[37m[36mINFO[0m[0m 05/02 04:13:04 | 0.124333    0.123565    0.661838    0.614035    1.815477    0.780101    0.724468    0.427042    0.336402    0.677875    0.639660    0.124333    0.123565    0.749216    0.741941    0.674954    0.627703    15000       8.180968    1.665350    0.299361    2544.13274 
[37m[36mINFO[0m[0m 05/02 04:13:05 | Cumulative gradient change saved at train_output/DomainNet/GENIE/[3]/250501_15-46-20_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 05/02 04:13:06 | ---
[37m[36mINFO[0m[0m 05/02 04:13:06 | test-domain validation(oracle) = 13.483%
[37m[36mINFO[0m[0m 05/02 04:13:06 | training-domain validation(iid) = 12.433%
[37m[36mINFO[0m[0m 05/02 04:13:06 | last = 12.433%
[37m[36mINFO[0m[0m 05/02 04:13:06 | last (inD) = 61.403%
[37m[36mINFO[0m[0m 05/02 04:13:06 | training-domain validation (iid, inD) = 61.403%
[37m[36mINFO[0m[0m 05/02 04:13:06 | === Summary ===
[37m[36mINFO[0m[0m 05/02 04:13:06 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 3 --dataset DomainNet --trial_seed 2 --hparams_seed 14
[37m[36mINFO[0m[0m 05/02 04:13:06 | Unique name: 250501_15-46-20_resnet50_sgd
[37m[36mINFO[0m[0m 05/02 04:13:06 | Out path: train_output/DomainNet/GENIE/[3]/250501_15-46-20_resnet50_sgd
[37m[36mINFO[0m[0m 05/02 04:13:06 | Algorithm: GENIE
[37m[36mINFO[0m[0m 05/02 04:13:06 | Dataset: DomainNet

[37m[36mINFO[0m[0m 05/11 06:26:55 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 4 --dataset DomainNet --trial_seed 1 --hparams_seed 10
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: DomainNet
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 10
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/DomainNet/GENIE/[4]/250511_06-26-55_resnet50_sgd
	out_root: train_output/DomainNet/GENIE/[4]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [4]
	trial_seed: 1
	unique_name: 250511_06-26-55_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 2.2128485336217652e-05
	batch_size: 9
	weight_decay: 0.00030907441430549757
	momentum: 0.8474843367197127
	convergence_rate: 0.004441557497475281
	moving_avg: 0.9380010014495695
	p: 0.18097596178424713
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[DomainNet] #envs=6, #classes=345
	env0: clip (#48129)
	env1: info (#51605)
	env2: paint (#72266)
	env3: quick (#172500)
	env4: real (#172947)
	env5: sketch (#69128)

[37m[36mINFO[0m[0m 05/11 06:26:56 | n_steps = 15001
[37m[36mINFO[0m[0m 05/11 06:26:56 | checkpoint_freq = 1000
[37m[36mINFO[0m[0m 05/11 06:26:56 | n_steps is updated to 15001 => 15001 for checkpointing
[37m[36mINFO[0m[0m 05/11 06:26:56 | 
[37m[36mINFO[0m[0m 05/11 06:26:57 | Testenv name escaping te_real -> te_real
[37m[36mINFO[0m[0m 05/11 06:26:57 | Test envs = [4], name = te_real
[37m[36mINFO[0m[0m 05/11 06:26:57 | Train environments: [0, 1, 2, 3, 5], Test environments: [4]
[37m[36mINFO[0m[0m 05/11 06:26:57 | Batch sizes for each domain: [9, 9, 9, 9, 0, 9] (total=45)
[37m[36mINFO[0m[0m 05/11 06:26:57 | steps-per-epoch for each domain: 4278.22, 4587.11, 6423.67, 15333.33, 6144.78 -> min = 4278.22
[37m[36mINFO[0m[0m 05/11 06:26:59 | # of params = 24214937
[37m[36mINFO[0m[0m 05/11 07:01:25 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    env4_in     env4_out    env5_in     env5_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 05/11 07:01:25 | 0.002118    0.002168    0.003172    0.002950    5.898321    0.003610    0.004364    0.001671    0.002519    0.004013    0.003321    0.003580    0.003101    0.002118    0.002168    0.002984    0.001447    0           0.000000    6.076706    1.214118    2064.68494 
[37m[36mINFO[0m[0m 05/11 07:38:23 | 0.040186    0.039695    0.036300    0.036685    5.553665    0.039424    0.041351    0.027710    0.024029    0.054676    0.056320    0.013290    0.014203    0.040186    0.039695    0.046399    0.047523    1000        0.233742    5.781871    0.159610    2058.51105 
[37m[36mINFO[0m[0m 05/11 08:15:40 | 0.322757    0.317124    0.248145    0.246966    3.793740    0.326589    0.332260    0.152165    0.137487    0.327937    0.327821    0.116928    0.125362    0.322757    0.317124    0.317108    0.311899    2000        0.467484    4.847524    0.189123    2048.43228 
[37m[36mINFO[0m[0m 05/11 08:55:03 | 0.453490    0.449218    0.354152    0.354091    3.161465    0.469016    0.477299    0.211099    0.189517    0.431097    0.436518    0.230783    0.246580    0.453490    0.449218    0.428765    0.420542    3000        0.701226    3.737348    0.270300    2092.31042 
[37m[36mINFO[0m[0m 05/11 09:32:27 | 0.502378    0.499725    0.400884    0.400450    2.886606    0.529971    0.539636    0.235200    0.210154    0.475620    0.470491    0.284268    0.307536    0.502378    0.499725    0.479359    0.474430    4000        0.934968    3.294008    0.177126    2067.14554 
[37m[36mINFO[0m[0m 05/11 10:09:05 | 0.521690    0.519356    0.435721    0.433074    2.708778    0.580407    0.584623    0.253028    0.225656    0.500061    0.495537    0.340022    0.358145    0.521690    0.519356    0.505090    0.501410    5000        1.168710    3.020871    0.165064    2032.31679 
[37m[36mINFO[0m[0m 05/11 10:45:56 | 0.536883    0.536674    0.449033    0.442984    2.627034    0.590874    0.592104    0.271316    0.241934    0.502655    0.496575    0.361848    0.374000    0.536883    0.536674    0.518471    0.510307    6000        1.402452    2.860556    0.164893    2046.14410 
[37m[36mINFO[0m[0m 05/11 11:23:37 | 0.554684    0.552517    0.474846    0.469017    2.502982    0.616014    0.618182    0.282071    0.246391    0.538426    0.540580    0.394312    0.406551    0.554684    0.552517    0.543406    0.533382    7000        1.636194    2.719614    0.177890    2083.42887 
[37m[36mINFO[0m[0m 05/11 12:01:07 | 0.567311    0.563908    0.493565    0.482518    2.420652    0.635648    0.631896    0.300383    0.258987    0.550291    0.540511    0.422761    0.434870    0.567311    0.563908    0.558740    0.546329    8000        1.869936    2.631011    0.169636    2079.83319 
[37m[36mINFO[0m[0m 05/11 12:37:56 | 0.573310    0.571887    0.502488    0.493274    2.376585    0.640946    0.639896    0.310968    0.268579    0.560428    0.556148    0.434181    0.447101    0.573310    0.571887    0.565919    0.554647    9000        2.103678    2.542593    0.163134    2046.04125 
[37m[36mINFO[0m[0m 05/11 13:14:41 | 0.578449    0.576946    0.511397    0.500231    2.337683    0.652815    0.650701    0.315740    0.271970    0.571602    0.563551    0.443623    0.458261    0.578449    0.576946    0.573206    0.556673    10000       2.337419    2.494276    0.163237    2041.81095 
[37m[36mINFO[0m[0m 05/11 13:51:47 | 0.589651    0.588251    0.524731    0.510028    2.283706    0.672294    0.664416    0.323394    0.274198    0.583329    0.573791    0.463710    0.475855    0.589651    0.588251    0.580927    0.561881    11000       2.571161    2.421969    0.176173    2049.74781 
[37m[36mINFO[0m[0m 05/11 14:29:21 | 0.588249    0.587499    0.528491    0.511981    2.254589    0.672995    0.657766    0.332235    0.287278    0.588899    0.574967    0.461000    0.470348    0.588249    0.587499    0.587328    0.569548    12000       2.804903    2.372895    0.196268    2058.28256 
[37m[36mINFO[0m[0m 05/11 15:06:50 | 0.585141    0.585649    0.534398    0.516220    2.235759    0.680267    0.661818    0.334827    0.284565    0.591684    0.574621    0.474848    0.489101    0.585141    0.585649    0.590366    0.570995    13000       3.038645    2.316462    0.175985    2073.05165 
[37m[36mINFO[0m[0m 05/11 15:43:40 | 0.592991    0.591691    0.540641    0.519265    2.231295    0.682033    0.669091    0.340204    0.284759    0.599865    0.580710    0.485312    0.493304    0.592991    0.591691    0.595790    0.568463    14000       3.272387    2.280092    0.167509    2042.11307 
[37m[36mINFO[0m[0m 05/11 16:21:10 | 0.593829    0.593917    0.545679    0.523854    2.222717    0.695097    0.678234    0.343378    0.286503    0.593275    0.574414    0.497312    0.507101    0.593829    0.593917    0.599335    0.573020    15000       3.506129    2.238784    0.162769    2087.65554 
[37m[36mINFO[0m[0m 05/11 16:21:11 | Cumulative gradient change saved at train_output/DomainNet/GENIE/[4]/250511_06-26-55_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 05/11 16:21:12 | ---
[37m[36mINFO[0m[0m 05/11 16:21:12 | test-domain validation(oracle) = 59.383%
[37m[36mINFO[0m[0m 05/11 16:21:12 | training-domain validation(iid) = 59.383%
[37m[36mINFO[0m[0m 05/11 16:21:12 | last = 59.383%
[37m[36mINFO[0m[0m 05/11 16:21:12 | last (inD) = 52.385%
[37m[36mINFO[0m[0m 05/11 16:21:12 | training-domain validation (iid, inD) = 52.385%
[37m[36mINFO[0m[0m 05/11 16:21:12 | === Summary ===
[37m[36mINFO[0m[0m 05/11 16:21:12 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 4 --dataset DomainNet --trial_seed 1 --hparams_seed 10
[37m[36mINFO[0m[0m 05/11 16:21:12 | Unique name: 250511_06-26-55_resnet50_sgd
[37m[36mINFO[0m[0m 05/11 16:21:12 | Out path: train_output/DomainNet/GENIE/[4]/250511_06-26-55_resnet50_sgd
[37m[36mINFO[0m[0m 05/11 16:21:12 | Algorithm: GENIE
[37m[36mINFO[0m[0m 05/11 16:21:12 | Dataset: DomainNet

[37m[36mINFO[0m[0m 05/10 19:47:28 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 4 --dataset DomainNet --trial_seed 1 --hparams_seed 9
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: DomainNet
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 9
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/DomainNet/GENIE/[4]/250510_19-47-28_resnet50_sgd
	out_root: train_output/DomainNet/GENIE/[4]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [4]
	trial_seed: 1
	unique_name: 250510_19-47-28_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 2.7532223448653515e-05
	batch_size: 26
	weight_decay: 0.007511403320794324
	momentum: 0.9872565509707083
	convergence_rate: 0.019543659090931836
	moving_avg: 0.900758517723229
	p: 0.5423165174183379
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[DomainNet] #envs=6, #classes=345
	env0: clip (#48129)
	env1: info (#51605)
	env2: paint (#72266)
	env3: quick (#172500)
	env4: real (#172947)
	env5: sketch (#69128)

[37m[36mINFO[0m[0m 05/10 19:47:29 | n_steps = 15001
[37m[36mINFO[0m[0m 05/10 19:47:29 | checkpoint_freq = 1000
[37m[36mINFO[0m[0m 05/10 19:47:29 | n_steps is updated to 15001 => 15001 for checkpointing
[37m[36mINFO[0m[0m 05/10 19:47:29 | 
[37m[36mINFO[0m[0m 05/10 19:47:29 | Testenv name escaping te_real -> te_real
[37m[36mINFO[0m[0m 05/10 19:47:29 | Test envs = [4], name = te_real
[37m[36mINFO[0m[0m 05/10 19:47:29 | Train environments: [0, 1, 2, 3, 5], Test environments: [4]
[37m[36mINFO[0m[0m 05/10 19:47:29 | Batch sizes for each domain: [26, 26, 26, 26, 0, 26] (total=130)
[37m[36mINFO[0m[0m 05/10 19:47:29 | steps-per-epoch for each domain: 1480.92, 1587.85, 2223.58, 5307.69, 2127.04 -> min = 1480.92
[37m[36mINFO[0m[0m 05/10 19:47:31 | # of params = 24214937
[37m[36mINFO[0m[0m 05/10 20:21:47 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    env4_in     env4_out    env5_in     env5_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 05/10 20:21:47 | 0.002392    0.002486    0.003351    0.002968    5.891139    0.003766    0.003636    0.002228    0.003004    0.004238    0.003390    0.003594    0.003507    0.002392    0.002486    0.002929    0.001302    0           0.000000    6.000945    2.068567    2054.20281 
[37m[36mINFO[0m[0m 05/10 21:01:47 | 0.459807    0.456908    0.366964    0.363280    3.083513    0.492494    0.492156    0.213715    0.190292    0.437566    0.435411    0.252406    0.260928    0.459807    0.456908    0.438638    0.437613    1000        0.675255    4.591944    0.368024    2031.26546 
[37m[36mINFO[0m[0m 05/10 21:42:15 | 0.554077    0.550666    0.472127    0.464488    2.524046    0.614456    0.612156    0.287327    0.249491    0.528462    0.522383    0.394109    0.412406    0.554077    0.550666    0.536282    0.526004    2000        1.350509    2.942411    0.361667    2066.36843 
[37m[36mINFO[0m[0m 05/10 22:23:31 | 0.579656    0.575848    0.502701    0.488626    2.388529    0.648011    0.636675    0.318114    0.274973    0.552973    0.543071    0.435522    0.448377    0.579656    0.575848    0.558885    0.540036    3000        2.025764    2.553911    0.354432    2121.93371 
[37m[36mINFO[0m[0m 05/10 23:04:18 | 0.577285    0.578565    0.534519    0.511703    2.273875    0.682916    0.667948    0.327972    0.271195    0.581219    0.562928    0.487087    0.492899    0.577285    0.578565    0.593404    0.563544    4000        2.701018    2.370287    0.362515    2084.52502 
[37m[36mINFO[0m[0m 05/10 23:45:28 | 0.598910    0.596375    0.555665    0.530158    2.190693    0.702914    0.681039    0.349482    0.286406    0.601162    0.580226    0.512957    0.521710    0.598910    0.596375    0.611811    0.581410    5000        3.376273    2.234501    0.353371    2116.79266 
[37m[36mINFO[0m[0m 05/11 00:25:16 | 0.599177    0.597444    0.575834    0.545152    2.111997    0.725042    0.697143    0.370822    0.296289    0.620068    0.594548    0.537377    0.545594    0.599177    0.597444    0.625861    0.592188    6000        4.051527    2.114526    0.348707    2039.13754 
[37m[36mINFO[0m[0m 05/11 01:05:43 | 0.602929    0.603169    0.586944    0.551808    2.075603    0.738079    0.702753    0.383272    0.306947    0.633110    0.599114    0.541362    0.546609    0.602929    0.603169    0.638898    0.603617    7000        4.726782    2.036296    0.338154    2088.19575 
[37m[36mINFO[0m[0m 05/11 01:46:43 | 0.609968    0.610223    0.601438    0.560027    2.032790    0.749377    0.703896    0.402456    0.319543    0.646585    0.609493    0.557739    0.558957    0.609968    0.610223    0.651032    0.608246    8000        5.402036    1.955870    0.344578    2115.55827 
[37m[36mINFO[0m[0m 05/11 02:27:02 | 0.617420    0.616005    0.608253    0.564707    2.004189    0.772076    0.724987    0.401269    0.320705    0.650390    0.603473    0.561399    0.561275    0.617420    0.616005    0.656131    0.613092    9000        6.077291    1.896232    0.342446    2076.72932 
[37m[36mINFO[0m[0m 05/11 03:07:39 | 0.611074    0.607014    0.621587    0.572611    1.984184    0.771504    0.720519    0.420744    0.327972    0.661633    0.614198    0.585754    0.579391    0.611074    0.607014    0.668300    0.620976    10000       6.752545    1.831544    0.358429    2078.93527 
[37m[36mINFO[0m[0m 05/11 03:47:23 | 0.613257    0.616294    0.627500    0.574759    1.963635    0.783555    0.729455    0.430796    0.329329    0.667532    0.614267    0.581261    0.579188    0.613257    0.616294    0.674358    0.621555    11000       7.427800    1.788140    0.343427    2040.46045 
[37m[36mINFO[0m[0m 05/11 04:27:06 | 0.619675    0.617219    0.638245    0.578602    1.971357    0.792697    0.728416    0.441721    0.330879    0.679224    0.624161    0.594746    0.588145    0.619675    0.617219    0.682838    0.621410    12000       8.103054    1.743692    0.324864    2057.75395 
[37m[36mINFO[0m[0m 05/11 05:06:38 | 0.628869    0.627685    0.646289    0.586383    1.953408    0.797372    0.731221    0.456327    0.338727    0.686091    0.629765    0.600645    0.600667    0.628869    0.627685    0.691011    0.631537    13000       8.778309    1.694695    0.326187    2045.61925 
[37m[36mINFO[0m[0m 05/11 05:46:44 | 0.618678    0.617826    0.649693    0.581196    1.919742    0.798930    0.729351    0.461341    0.337661    0.686731    0.625130    0.601174    0.588667    0.618678    0.617826    0.700288    0.625172    14000       9.453563    1.655463    0.329967    2076.11808 
[37m[36mINFO[0m[0m 05/11 06:26:49 | 0.636826    0.635462    0.654958    0.587732    1.930879    0.807397    0.733922    0.467954    0.340471    0.691021    0.626998    0.606957    0.603130    0.636826    0.635462    0.701463    0.634141    15000       10.128818   1.615619    0.344050    2061.08495 
[37m[36mINFO[0m[0m 05/11 06:26:49 | Cumulative gradient change saved at train_output/DomainNet/GENIE/[4]/250510_19-47-28_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 05/11 06:26:50 | ---
[37m[36mINFO[0m[0m 05/11 06:26:50 | test-domain validation(oracle) = 63.683%
[37m[36mINFO[0m[0m 05/11 06:26:50 | training-domain validation(iid) = 63.683%
[37m[36mINFO[0m[0m 05/11 06:26:50 | last = 63.683%
[37m[36mINFO[0m[0m 05/11 06:26:50 | last (inD) = 58.773%
[37m[36mINFO[0m[0m 05/11 06:26:50 | training-domain validation (iid, inD) = 58.773%
[37m[36mINFO[0m[0m 05/11 06:26:51 | === Summary ===
[37m[36mINFO[0m[0m 05/11 06:26:51 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 4 --dataset DomainNet --trial_seed 1 --hparams_seed 9
[37m[36mINFO[0m[0m 05/11 06:26:51 | Unique name: 250510_19-47-28_resnet50_sgd
[37m[36mINFO[0m[0m 05/11 06:26:51 | Out path: train_output/DomainNet/GENIE/[4]/250510_19-47-28_resnet50_sgd
[37m[36mINFO[0m[0m 05/11 06:26:51 | Algorithm: GENIE
[37m[36mINFO[0m[0m 05/11 06:26:51 | Dataset: DomainNet

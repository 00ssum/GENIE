[37m[36mINFO[0m[0m 05/12 13:03:48 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 4 --dataset DomainNet --trial_seed 1 --hparams_seed 13
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: DomainNet
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 13
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/DomainNet/GENIE/[4]/250512_13-03-48_resnet50_sgd
	out_root: train_output/DomainNet/GENIE/[4]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [4]
	trial_seed: 1
	unique_name: 250512_13-03-48_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 6.984990754803203e-05
	batch_size: 11
	weight_decay: 2.888048423418205e-06
	momentum: 0.9854141873014248
	convergence_rate: 0.015148948830862787
	moving_avg: 0.9052324001892587
	p: 0.5844147065794474
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[DomainNet] #envs=6, #classes=345
	env0: clip (#48129)
	env1: info (#51605)
	env2: paint (#72266)
	env3: quick (#172500)
	env4: real (#172947)
	env5: sketch (#69128)

[37m[36mINFO[0m[0m 05/12 13:03:48 | n_steps = 15001
[37m[36mINFO[0m[0m 05/12 13:03:48 | checkpoint_freq = 1000
[37m[36mINFO[0m[0m 05/12 13:03:48 | n_steps is updated to 15001 => 15001 for checkpointing
[37m[36mINFO[0m[0m 05/12 13:03:48 | 
[37m[36mINFO[0m[0m 05/12 13:03:49 | Testenv name escaping te_real -> te_real
[37m[36mINFO[0m[0m 05/12 13:03:49 | Test envs = [4], name = te_real
[37m[36mINFO[0m[0m 05/12 13:03:49 | Train environments: [0, 1, 2, 3, 5], Test environments: [4]
[37m[36mINFO[0m[0m 05/12 13:03:49 | Batch sizes for each domain: [11, 11, 11, 11, 0, 11] (total=55)
[37m[36mINFO[0m[0m 05/12 13:03:49 | steps-per-epoch for each domain: 3500.36, 3753.09, 5255.73, 12545.45, 5027.55 -> min = 3500.36
[37m[36mINFO[0m[0m 05/12 13:03:50 | # of params = 24214937
[37m[36mINFO[0m[0m 05/12 13:38:14 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    env4_in     env4_out    env5_in     env5_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 05/12 13:38:14 | 0.002934    0.002920    0.003284    0.003220    5.893154    0.003376    0.003429    0.001720    0.003391    0.004860    0.004428    0.003877    0.003188    0.002934    0.002920    0.002586    0.001664    0           0.000000    5.961287    1.113077    2062.79758 
[37m[36mINFO[0m[0m 05/12 14:15:38 | 0.453512    0.452427    0.338135    0.337546    3.216209    0.455070    0.463481    0.199763    0.179440    0.404477    0.397841    0.224478    0.244725    0.453512    0.452427    0.406886    0.402242    1000        0.285685    4.287038    0.173710    2070.07291 
[37m[36mINFO[0m[0m 05/12 14:53:06 | 0.492331    0.489289    0.414197    0.409123    2.832774    0.556825    0.556156    0.236096    0.201822    0.464722    0.465578    0.333007    0.350377    0.492331    0.489289    0.480336    0.471682    2000        0.571369    2.942360    0.179848    2068.52037 
[37m[36mINFO[0m[0m 05/12 15:31:29 | 0.530515    0.530169    0.459493    0.449905    2.596210    0.599107    0.596364    0.274876    0.231760    0.505526    0.499689    0.399159    0.412203    0.530515    0.530169    0.518796    0.509512    3000        0.857054    2.638300    0.195962    2106.49713 
[37m[36mINFO[0m[0m 05/12 16:10:16 | 0.552668    0.549163    0.485900    0.472828    2.467365    0.631155    0.625662    0.290766    0.245519    0.537215    0.523006    0.425493    0.440696    0.552668    0.549163    0.544871    0.529259    4000        1.142738    2.447039    0.265663    2061.64227 
[37m[36mINFO[0m[0m 05/12 16:48:17 | 0.566848    0.567030    0.503118    0.484756    2.395766    0.652789    0.634805    0.312785    0.264122    0.546365    0.534975    0.451384    0.459101    0.566848    0.567030    0.552267    0.530778    5000        1.428423    2.325104    0.198220    2082.31408 
[37m[36mINFO[0m[0m 05/12 17:26:37 | 0.563712    0.563763    0.519118    0.498321    2.343893    0.655257    0.645195    0.328117    0.272067    0.567692    0.548952    0.471370    0.480725    0.563712    0.563763    0.573152    0.544665    6000        1.714108    2.227908    0.190028    2109.67467 
[37m[36mINFO[0m[0m 05/12 18:05:34 | 0.574098    0.572523    0.537278    0.509741    2.275733    0.687929    0.659221    0.343281    0.276911    0.577396    0.555317    0.485500    0.493855    0.574098    0.572523    0.592283    0.563400    7000        1.999792    2.129656    0.194616    2142.91465 
[37m[36mINFO[0m[0m 05/12 18:43:37 | 0.576382    0.574980    0.543476    0.515067    2.246007    0.690993    0.660052    0.343378    0.275942    0.589591    0.567356    0.495819    0.502580    0.576382    0.574980    0.597599    0.569403    8000        2.285477    2.084248    0.184964    2097.73144 
[37m[36mINFO[0m[0m 05/12 19:21:45 | 0.570585    0.567926    0.547964    0.515169    2.245629    0.701641    0.673247    0.353793    0.283015    0.581720    0.551304    0.499913    0.502348    0.570585    0.567926    0.602752    0.565931    9000        2.571161    2.024805    0.181121    2106.83244 
[37m[36mINFO[0m[0m 05/12 19:58:48 | 0.578492    0.579173    0.569113    0.534065    2.155552    0.715744    0.684364    0.367237    0.292898    0.605815    0.575106    0.533819    0.535101    0.578492    0.579173    0.622950    0.582857    10000       2.856846    1.962037    0.179305    2044.32751 
[37m[36mINFO[0m[0m 05/12 20:36:17 | 0.587194    0.586718    0.565613    0.531903    2.179395    0.715588    0.681455    0.367140    0.294545    0.598533    0.574275    0.528609    0.529565    0.587194    0.586718    0.618194    0.579675    11000       3.142531    1.930694    0.192131    2056.30080 
[37m[36mINFO[0m[0m 05/12 21:14:03 | 0.587707    0.586342    0.583203    0.545000    2.109787    0.730340    0.695273    0.381794    0.294642    0.623164    0.588943    0.546196    0.552580    0.587707    0.586342    0.634523    0.593562    12000       3.428215    1.889484    0.188435    2077.63322 
[37m[36mINFO[0m[0m 05/12 21:51:22 | 0.584578    0.583394    0.587641    0.546725    2.103277    0.745481    0.702026    0.391798    0.301909    0.619082    0.584585    0.543884    0.548580    0.584578    0.583394    0.637958    0.596528    13000       3.713900    1.827156    0.179971    2059.22106 
[37m[36mINFO[0m[0m 05/12 22:28:39 | 0.597595    0.592240    0.592304    0.548127    2.112513    0.743377    0.698701    0.401899    0.307238    0.630118    0.589220    0.544116    0.552783    0.597595    0.592240    0.642009    0.592694    14000       3.999584    1.786906    0.179587    2057.60261 
[37m[36mINFO[0m[0m 05/12 23:06:30 | 0.596258    0.594553    0.599568    0.546916    2.117507    0.750260    0.695169    0.405121    0.300165    0.635203    0.590535    0.561254    0.558696    0.596258    0.594553    0.646005    0.590018    15000       4.285269    1.767589    0.183522    2086.86134 
[37m[36mINFO[0m[0m 05/12 23:06:30 | Cumulative gradient change saved at train_output/DomainNet/GENIE/[4]/250512_13-03-48_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 05/12 23:06:31 | ---
[37m[36mINFO[0m[0m 05/12 23:06:31 | test-domain validation(oracle) = 59.626%
[37m[36mINFO[0m[0m 05/12 23:06:31 | training-domain validation(iid) = 59.759%
[37m[36mINFO[0m[0m 05/12 23:06:31 | last = 59.626%
[37m[36mINFO[0m[0m 05/12 23:06:31 | last (inD) = 54.692%
[37m[36mINFO[0m[0m 05/12 23:06:31 | training-domain validation (iid, inD) = 54.813%
[37m[36mINFO[0m[0m 05/12 23:06:32 | === Summary ===
[37m[36mINFO[0m[0m 05/12 23:06:32 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 4 --dataset DomainNet --trial_seed 1 --hparams_seed 13
[37m[36mINFO[0m[0m 05/12 23:06:32 | Unique name: 250512_13-03-48_resnet50_sgd
[37m[36mINFO[0m[0m 05/12 23:06:32 | Out path: train_output/DomainNet/GENIE/[4]/250512_13-03-48_resnet50_sgd
[37m[36mINFO[0m[0m 05/12 23:06:32 | Algorithm: GENIE
[37m[36mINFO[0m[0m 05/12 23:06:32 | Dataset: DomainNet

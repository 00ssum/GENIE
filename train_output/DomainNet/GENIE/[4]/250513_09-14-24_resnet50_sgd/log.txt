[37m[36mINFO[0m[0m 05/13 09:14:24 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 4 --dataset DomainNet --trial_seed 1 --hparams_seed 15
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: DomainNet
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 15
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/DomainNet/GENIE/[4]/250513_09-14-24_resnet50_sgd
	out_root: train_output/DomainNet/GENIE/[4]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [4]
	trial_seed: 1
	unique_name: 250513_09-14-24_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 1.7812453400894684e-05
	batch_size: 27
	weight_decay: 3.1651536009272826e-06
	momentum: 0.9528943649421413
	convergence_rate: 0.0025748176710103194
	moving_avg: 0.919405819570856
	p: 0.31443299474225483
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[DomainNet] #envs=6, #classes=345
	env0: clip (#48129)
	env1: info (#51605)
	env2: paint (#72266)
	env3: quick (#172500)
	env4: real (#172947)
	env5: sketch (#69128)

[37m[36mINFO[0m[0m 05/13 09:14:25 | n_steps = 15001
[37m[36mINFO[0m[0m 05/13 09:14:25 | checkpoint_freq = 1000
[37m[36mINFO[0m[0m 05/13 09:14:25 | n_steps is updated to 15001 => 15001 for checkpointing
[37m[36mINFO[0m[0m 05/13 09:14:25 | 
[37m[36mINFO[0m[0m 05/13 09:14:26 | Testenv name escaping te_real -> te_real
[37m[36mINFO[0m[0m 05/13 09:14:26 | Test envs = [4], name = te_real
[37m[36mINFO[0m[0m 05/13 09:14:26 | Train environments: [0, 1, 2, 3, 5], Test environments: [4]
[37m[36mINFO[0m[0m 05/13 09:14:26 | Batch sizes for each domain: [27, 27, 27, 27, 0, 27] (total=135)
[37m[36mINFO[0m[0m 05/13 09:14:26 | steps-per-epoch for each domain: 1426.07, 1529.04, 2141.22, 5111.11, 2048.26 -> min = 1426.07
[37m[36mINFO[0m[0m 05/13 09:14:27 | # of params = 24214937
[37m[36mINFO[0m[0m 05/13 09:49:25 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    env4_in     env4_out    env5_in     env5_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 05/13 09:49:25 | 0.001923    0.002139    0.003328    0.002802    5.907484    0.003532    0.004052    0.002059    0.002228    0.004030    0.002629    0.004109    0.003652    0.001923    0.002139    0.002911    0.001447    0           0.000000    5.903478    1.237589    2096.90343 
[37m[36mINFO[0m[0m 05/13 10:30:29 | 0.304059    0.304606    0.221144    0.219975    3.980770    0.294775    0.301506    0.134435    0.120822    0.294000    0.296617    0.102761    0.111565    0.304059    0.304606    0.279750    0.269367    1000        0.701226    5.375665    0.342173    2122.45253 
[37m[36mINFO[0m[0m 05/13 11:12:20 | 0.486853    0.481598    0.388625    0.386741    2.931532    0.513271    0.516987    0.221175    0.199884    0.460554    0.461565    0.287442    0.303043    0.486853    0.481598    0.460680    0.452224    2000        1.402452    3.287942    0.408045    2102.85267 
[37m[36mINFO[0m[0m 05/13 11:52:57 | 0.547189    0.547168    0.446309    0.439711    2.638725    0.583394    0.579325    0.262305    0.232051    0.509315    0.507922    0.367210    0.381391    0.547189    0.547168    0.509321    0.497866    3000        2.103678    2.707747    0.393777    2043.13819 
[37m[36mINFO[0m[0m 05/13 12:34:09 | 0.569118    0.567348    0.478561    0.469322    2.475292    0.615027    0.607273    0.286116    0.251817    0.541660    0.537812    0.415312    0.428116    0.569118    0.567348    0.534691    0.521591    4000        2.804903    2.474448    0.366851    2105.31942 
[37m[36mINFO[0m[0m 05/13 13:15:30 | 0.590851    0.591662    0.504477    0.491489    2.371428    0.644790    0.637818    0.302975    0.262087    0.566793    0.554902    0.444804    0.458841    0.590851    0.591662    0.563026    0.543797    5000        3.506129    2.332420    0.365992    2114.14476 
[37m[36mINFO[0m[0m 05/13 13:56:43 | 0.600016    0.599150    0.523823    0.506580    2.284953    0.664866    0.646130    0.320899    0.272939    0.583658    0.571093    0.469993    0.482957    0.600016    0.599150    0.579697    0.559783    6000        4.207355    2.201315    0.377117    2096.63041 
[37m[36mINFO[0m[0m 05/13 14:39:40 | 0.606420    0.605279    0.539657    0.519616    2.233732    0.681981    0.666078    0.332477    0.284178    0.595991    0.577942    0.492246    0.499391    0.606420    0.605279    0.595592    0.570488    7000        4.908581    2.119654    0.372876    2203.94644 
[37m[36mINFO[0m[0m 05/13 15:21:30 | 0.613055    0.612709    0.550714    0.527674    2.177919    0.693798    0.673558    0.346090    0.292220    0.606455    0.585899    0.503297    0.509623    0.613055    0.612709    0.603927    0.577071    8000        5.609807    2.059080    0.373560    2136.49992 
[37m[36mINFO[0m[0m 05/13 16:03:23 | 0.621655    0.620371    0.562209    0.533158    2.158183    0.714445    0.684156    0.353527    0.293479    0.617404    0.593856    0.511616    0.514551    0.621655    0.620371    0.614053    0.579747    9000        6.311033    1.986714    0.366973    2146.06615 
[37m[36mINFO[0m[0m 05/13 16:45:26 | 0.624373    0.623435    0.573423    0.542487    2.127566    0.725301    0.694026    0.366486    0.301715    0.626018    0.600291    0.525312    0.530870    0.624373    0.623435    0.623999    0.585533    10000       7.012258    1.925415    0.366484    2155.83773 
[37m[36mINFO[0m[0m 05/13 17:27:36 | 0.630459    0.627974    0.581340    0.546540    2.086946    0.734183    0.693299    0.374334    0.307238    0.630239    0.601259    0.534775    0.535391    0.630459    0.627974    0.633166    0.595515    11000       7.713484    1.894126    0.375369    2154.56949 
[37m[36mINFO[0m[0m 05/13 18:09:02 | 0.629447    0.628784    0.588473    0.553326    2.066229    0.736183    0.693403    0.379832    0.311791    0.637019    0.603958    0.551971    0.557478    0.629447    0.628784    0.637361    0.600000    12000       8.414710    1.841697    0.359915    2126.91042 
[37m[36mINFO[0m[0m 05/13 18:49:56 | 0.634347    0.631501    0.596132    0.556223    2.056491    0.745715    0.704208    0.389594    0.309175    0.646014    0.610323    0.551761    0.552058    0.634347    0.631501    0.647578    0.605353    13000       9.115936    1.793926    0.357126    2096.70825 
[37m[36mINFO[0m[0m 05/13 19:31:14 | 0.632316    0.630634    0.600674    0.556097    2.046387    0.754337    0.708468    0.391483    0.304815    0.649248    0.606241    0.556833    0.555101    0.632316    0.630634    0.651466    0.605859    14000       9.817162    1.765211    0.338864    2139.25560 
[37m[36mINFO[0m[0m 05/13 20:12:32 | 0.638373    0.636040    0.612286    0.565915    2.012802    0.765557    0.712727    0.407906    0.321674    0.659436    0.617657    0.567319    0.565217    0.638373    0.636040    0.661212    0.612297    15000       10.518388   1.721569    0.353884    2123.61845 
[37m[36mINFO[0m[0m 05/13 20:12:32 | Cumulative gradient change saved at train_output/DomainNet/GENIE/[4]/250513_09-14-24_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 05/13 20:12:34 | ---
[37m[36mINFO[0m[0m 05/13 20:12:34 | test-domain validation(oracle) = 63.837%
[37m[36mINFO[0m[0m 05/13 20:12:34 | training-domain validation(iid) = 63.837%
[37m[36mINFO[0m[0m 05/13 20:12:34 | last = 63.837%
[37m[36mINFO[0m[0m 05/13 20:12:34 | last (inD) = 56.591%
[37m[36mINFO[0m[0m 05/13 20:12:34 | training-domain validation (iid, inD) = 56.591%
[37m[36mINFO[0m[0m 05/13 20:12:34 | === Summary ===
[37m[36mINFO[0m[0m 05/13 20:12:34 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 4 --dataset DomainNet --trial_seed 1 --hparams_seed 15
[37m[36mINFO[0m[0m 05/13 20:12:34 | Unique name: 250513_09-14-24_resnet50_sgd
[37m[36mINFO[0m[0m 05/13 20:12:34 | Out path: train_output/DomainNet/GENIE/[4]/250513_09-14-24_resnet50_sgd
[37m[36mINFO[0m[0m 05/13 20:12:34 | Algorithm: GENIE
[37m[36mINFO[0m[0m 05/13 20:12:34 | Dataset: DomainNet

[37m[36mINFO[0m[0m 05/11 16:21:17 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 4 --dataset DomainNet --trial_seed 1 --hparams_seed 11
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: DomainNet
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 11
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/DomainNet/GENIE/[4]/250511_16-21-17_resnet50_sgd
	out_root: train_output/DomainNet/GENIE/[4]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [4]
	trial_seed: 1
	unique_name: 250511_16-21-17_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5.340583028754034e-05
	batch_size: 9
	weight_decay: 2.5000172438864113e-05
	momentum: 0.8767635383777153
	convergence_rate: 0.09127051002858298
	moving_avg: 0.9809207436419558
	p: 0.4617513937588046
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[DomainNet] #envs=6, #classes=345
	env0: clip (#48129)
	env1: info (#51605)
	env2: paint (#72266)
	env3: quick (#172500)
	env4: real (#172947)
	env5: sketch (#69128)

[37m[36mINFO[0m[0m 05/11 16:21:18 | n_steps = 15001
[37m[36mINFO[0m[0m 05/11 16:21:18 | checkpoint_freq = 1000
[37m[36mINFO[0m[0m 05/11 16:21:18 | n_steps is updated to 15001 => 15001 for checkpointing
[37m[36mINFO[0m[0m 05/11 16:21:18 | 
[37m[36mINFO[0m[0m 05/11 16:21:18 | Testenv name escaping te_real -> te_real
[37m[36mINFO[0m[0m 05/11 16:21:18 | Test envs = [4], name = te_real
[37m[36mINFO[0m[0m 05/11 16:21:18 | Train environments: [0, 1, 2, 3, 5], Test environments: [4]
[37m[36mINFO[0m[0m 05/11 16:21:18 | Batch sizes for each domain: [9, 9, 9, 9, 0, 9] (total=45)
[37m[36mINFO[0m[0m 05/11 16:21:18 | steps-per-epoch for each domain: 4278.22, 4587.11, 6423.67, 15333.33, 6144.78 -> min = 4278.22
[37m[36mINFO[0m[0m 05/11 16:21:20 | # of params = 24214937
[37m[36mINFO[0m[0m 05/11 16:55:56 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    env4_in     env4_out    env5_in     env5_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 05/11 16:55:56 | 0.006302    0.006013    0.005783    0.006138    5.884044    0.008441    0.009351    0.006056    0.006104    0.005864    0.006435    0.003493    0.003304    0.006302    0.006013    0.005063    0.005497    0           0.000000    5.961956    0.985472    2075.36806 
[37m[36mINFO[0m[0m 05/11 17:33:54 | 0.101165    0.101911    0.096429    0.095987    4.774806    0.138375    0.145662    0.060871    0.054452    0.107692    0.105860    0.051000    0.055188    0.101165    0.101911    0.124207    0.118770    1000        0.233742    5.569795    0.190909    2086.95852 
[37m[36mINFO[0m[0m 05/11 18:11:03 | 0.236669    0.235826    0.232868    0.232398    3.769211    0.324668    0.331636    0.128476    0.114330    0.230640    0.222929    0.201239    0.218377    0.236669    0.235826    0.279316    0.274720    2000        0.467484    4.184792    0.173899    2055.33371 
[37m[36mINFO[0m[0m 05/11 18:47:52 | 0.301927    0.299864    0.301942    0.303013    3.412223    0.427956    0.439792    0.157834    0.129251    0.303305    0.306788    0.269442    0.289652    0.301927    0.299864    0.351174    0.349584    3000        0.701226    3.538256    0.170637    2038.59149 
[37m[36mINFO[0m[0m 05/11 19:25:22 | 0.339258    0.336118    0.353113    0.352899    3.092178    0.479067    0.488831    0.196807    0.168879    0.349766    0.345741    0.336312    0.361913    0.339258    0.336118    0.403613    0.399132    4000        0.934968    3.198665    0.159023    2090.77337 
[37m[36mINFO[0m[0m 05/11 20:04:12 | 0.380470    0.379080    0.383937    0.376289    2.986479    0.521245    0.520623    0.211486    0.177793    0.378358    0.368920    0.366268    0.378232    0.380470    0.379080    0.442327    0.435877    5000        1.168710    2.976425    0.240930    2088.98166 
[37m[36mINFO[0m[0m 05/11 20:42:12 | 0.377781    0.377635    0.414588    0.404389    2.836832    0.545398    0.543481    0.228321    0.189613    0.416567    0.405175    0.413638    0.432029    0.377781    0.377635    0.469016    0.451646    6000        1.402452    2.821784    0.205385    2074.27854 
[37m[36mINFO[0m[0m 05/11 21:19:48 | 0.413803    0.412270    0.429975    0.420451    2.747132    0.561916    0.565091    0.246464    0.204728    0.442807    0.423096    0.419746    0.440841    0.413803    0.412270    0.478943    0.468499    7000        1.636194    2.704634    0.179056    2077.02875 
[37m[36mINFO[0m[0m 05/11 21:57:26 | 0.409712    0.407471    0.447766    0.433691    2.664662    0.593393    0.587221    0.249249    0.202790    0.450625    0.437971    0.444341    0.457652    0.409712    0.407471    0.501221    0.482821    8000        1.869936    2.613834    0.187551    2070.41022 
[37m[36mINFO[0m[0m 05/11 22:34:58 | 0.421718    0.420914    0.450024    0.437332    2.673334    0.591471    0.591584    0.257945    0.206957    0.442980    0.430776    0.454116    0.473942    0.421718    0.420914    0.503607    0.483400    9000        2.103678    2.554291    0.177203    2075.43237 
[37m[36mINFO[0m[0m 05/11 23:12:21 | 0.432133    0.427650    0.468246    0.449409    2.588536    0.615546    0.602390    0.273108    0.222362    0.462681    0.448765    0.474406    0.481449    0.432133    0.427650    0.515487    0.492080    10000       2.337419    2.483940    0.164233    2078.22309 
[37m[36mINFO[0m[0m 05/11 23:50:14 | 0.432436    0.431351    0.480353    0.461168    2.526537    0.628714    0.612052    0.280230    0.225656    0.481864    0.469937    0.484152    0.497652    0.432436    0.431351    0.526807    0.500542    11000       2.571161    2.421852    0.163361    2109.72248 
[37m[36mINFO[0m[0m 05/12 00:28:17 | 0.443661    0.442135    0.494810    0.472086    2.478233    0.636479    0.618701    0.293431    0.233698    0.494508    0.475611    0.504543    0.511913    0.443661    0.442135    0.545088    0.520506    12000       2.804903    2.359334    0.190911    2091.58403 
[37m[36mINFO[0m[0m 05/12 01:05:54 | 0.435978    0.434647    0.494705    0.472385    2.499220    0.637518    0.620156    0.294279    0.235733    0.501808    0.476994    0.493007    0.508174    0.435978    0.434647    0.546914    0.520868    13000       3.038645    2.304114    0.195321    2062.54096 
[37m[36mINFO[0m[0m 05/12 01:44:25 | 0.450845    0.447744    0.497448    0.470941    2.511771    0.638765    0.616416    0.294109    0.227110    0.512653    0.486681    0.496609    0.508551    0.450845    0.447744    0.545106    0.515949    14000       3.272387    2.283033    0.182259    2128.58892 
[37m[36mINFO[0m[0m 05/12 02:23:52 | 0.450975    0.448322    0.504839    0.476307    2.469497    0.654426    0.632000    0.297476    0.227110    0.502499    0.475957    0.519391    0.529217    0.450975    0.448322    0.550404    0.517251    15000       3.506129    2.242148    0.188293    2178.46303 
[37m[36mINFO[0m[0m 05/12 02:23:52 | Cumulative gradient change saved at train_output/DomainNet/GENIE/[4]/250511_16-21-17_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 05/12 02:23:53 | ---
[37m[36mINFO[0m[0m 05/12 02:23:53 | test-domain validation(oracle) = 45.098%
[37m[36mINFO[0m[0m 05/12 02:23:53 | training-domain validation(iid) = 45.098%
[37m[36mINFO[0m[0m 05/12 02:23:53 | last = 45.098%
[37m[36mINFO[0m[0m 05/12 02:23:53 | last (inD) = 47.631%
[37m[36mINFO[0m[0m 05/12 02:23:53 | training-domain validation (iid, inD) = 47.631%
[37m[36mINFO[0m[0m 05/12 02:23:54 | === Summary ===
[37m[36mINFO[0m[0m 05/12 02:23:54 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 4 --dataset DomainNet --trial_seed 1 --hparams_seed 11
[37m[36mINFO[0m[0m 05/12 02:23:54 | Unique name: 250511_16-21-17_resnet50_sgd
[37m[36mINFO[0m[0m 05/12 02:23:54 | Out path: train_output/DomainNet/GENIE/[4]/250511_16-21-17_resnet50_sgd
[37m[36mINFO[0m[0m 05/12 02:23:54 | Algorithm: GENIE
[37m[36mINFO[0m[0m 05/12 02:23:54 | Dataset: DomainNet

[37m[36mINFO[0m[0m 05/14 06:22:56 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 4 --dataset DomainNet --trial_seed 1 --hparams_seed 17
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: DomainNet
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 17
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/DomainNet/GENIE/[4]/250514_06-22-56_resnet50_sgd
	out_root: train_output/DomainNet/GENIE/[4]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [4]
	trial_seed: 1
	unique_name: 250514_06-22-56_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 0.0002990700776954947
	batch_size: 8
	weight_decay: 4.0966675521600606e-05
	momentum: 0.8008562887985442
	convergence_rate: 0.03899671923069269
	moving_avg: 0.9874705734650768
	p: 0.430076897775002
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[DomainNet] #envs=6, #classes=345
	env0: clip (#48129)
	env1: info (#51605)
	env2: paint (#72266)
	env3: quick (#172500)
	env4: real (#172947)
	env5: sketch (#69128)

[37m[36mINFO[0m[0m 05/14 06:22:56 | n_steps = 15001
[37m[36mINFO[0m[0m 05/14 06:22:56 | checkpoint_freq = 1000
[37m[36mINFO[0m[0m 05/14 06:22:56 | n_steps is updated to 15001 => 15001 for checkpointing
[37m[36mINFO[0m[0m 05/14 06:22:56 | 
[37m[36mINFO[0m[0m 05/14 06:22:57 | Testenv name escaping te_real -> te_real
[37m[36mINFO[0m[0m 05/14 06:22:57 | Test envs = [4], name = te_real
[37m[36mINFO[0m[0m 05/14 06:22:57 | Train environments: [0, 1, 2, 3, 5], Test environments: [4]
[37m[36mINFO[0m[0m 05/14 06:22:57 | Batch sizes for each domain: [8, 8, 8, 8, 0, 8] (total=40)
[37m[36mINFO[0m[0m 05/14 06:22:57 | steps-per-epoch for each domain: 4813.00, 5160.50, 7226.62, 17250.00, 6912.88 -> min = 4813.00
[37m[36mINFO[0m[0m 05/14 06:22:58 | # of params = 24214937
[37m[36mINFO[0m[0m 05/14 06:57:15 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    env4_in     env4_out    env5_in     env5_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 05/14 06:57:15 | 0.004777    0.004626    0.003563    0.003816    5.877163    0.003117    0.004364    0.003076    0.002907    0.005846    0.006711    0.002594    0.002348    0.004777    0.004626    0.003182    0.002749    0           0.000000    6.164907    1.102744    2055.64310 
[37m[36mINFO[0m[0m 05/14 07:34:03 | 0.017852    0.017260    0.019858    0.020320    5.534821    0.025945    0.027429    0.012886    0.012596    0.025738    0.025739    0.007739    0.008783    0.017852    0.017260    0.026979    0.027052    1000        0.207771    5.768658    0.150239    2057.67137 
[37m[36mINFO[0m[0m 05/14 08:11:13 | 0.222452    0.222094    0.200917    0.203076    4.036737    0.273764    0.289247    0.118254    0.101347    0.234791    0.234484    0.123739    0.133594    0.222452    0.222094    0.254037    0.256709    2000        0.415541    4.817685    0.174188    2056.26826 
[37m[36mINFO[0m[0m 05/14 08:48:22 | 0.317213    0.313539    0.291003    0.292509    3.435796    0.403542    0.420779    0.165270    0.147369    0.311297    0.315229    0.219101    0.231391    0.317213    0.313539    0.355803    0.347776    3000        0.623312    3.847913    0.155578    2072.95430 
[37m[36mINFO[0m[0m 05/14 09:24:46 | 0.370257    0.367313    0.338539    0.336019    3.207915    0.456628    0.460052    0.200223    0.169751    0.370418    0.370235    0.262754    0.281072    0.370257    0.367313    0.402673    0.398987    4000        0.831082    3.446597    0.158930    2024.79890 
[37m[36mINFO[0m[0m 05/14 10:01:18 | 0.382775    0.380497    0.366294    0.361585    3.035565    0.489534    0.488519    0.208047    0.180603    0.390552    0.388224    0.311333    0.326783    0.382775    0.380497    0.432002    0.423797    5000        1.038853    3.208664    0.159215    2033.22852 
[37m[36mINFO[0m[0m 05/14 10:40:32 | 0.429726    0.428489    0.404770    0.402283    2.824583    0.546619    0.550753    0.231567    0.200853    0.429004    0.427178    0.348587    0.373246    0.429726    0.428489    0.468076    0.459385    6000        1.246624    3.028130    0.334474    2019.57558 
[37m[36mINFO[0m[0m 05/14 11:17:49 | 0.431453    0.427679    0.420752    0.412848    2.782279    0.554722    0.554597    0.242879    0.206472    0.448896    0.440116    0.380399    0.396145    0.431453    0.427679    0.476864    0.466908    7000        1.454394    2.925050    0.183483    2053.59862 
[37m[36mINFO[0m[0m 05/14 11:54:36 | 0.443473    0.441441    0.439232    0.428014    2.710011    0.569343    0.570494    0.255862    0.216549    0.463944    0.449388    0.404543    0.417130    0.443473    0.441441    0.502468    0.486510    8000        1.662165    2.841524    0.161184    2045.70157 
[37m[36mINFO[0m[0m 05/14 12:31:44 | 0.453122    0.449825    0.448218    0.436753    2.662078    0.583030    0.585870    0.261821    0.218002    0.474478    0.467792    0.416239    0.424870    0.453122    0.449825    0.505524    0.487233    9000        1.869936    2.737009    0.158385    2069.56266 
[37m[36mINFO[0m[0m 05/14 13:09:14 | 0.454596    0.452803    0.456848    0.442057    2.621018    0.603574    0.592416    0.260173    0.218680    0.475412    0.458452    0.439087    0.452203    0.454596    0.452803    0.505994    0.488535    10000       2.077706    2.660145    0.167776    2082.03481 
[37m[36mINFO[0m[0m 05/14 13:46:10 | 0.470620    0.468473    0.465550    0.450793    2.596597    0.608664    0.605195    0.273229    0.229048    0.484061    0.466616    0.448080    0.459797    0.470620    0.468473    0.513715    0.493309    11000       2.285477    2.608387    0.172322    2043.78741 
[37m[36mINFO[0m[0m 05/14 14:23:13 | 0.478382    0.476741    0.485240    0.468371    2.487389    0.626013    0.610805    0.294933    0.245906    0.506720    0.495191    0.466123    0.476174    0.478382    0.476741    0.532412    0.513779    12000       2.493247    2.575392    0.154542    2068.78345 
[37m[36mINFO[0m[0m 05/14 14:59:50 | 0.476185    0.472433    0.499325    0.480750    2.443288    0.641050    0.626078    0.304137    0.250460    0.521077    0.504255    0.481384    0.495072    0.476185    0.472433    0.548976    0.527884    13000       2.701018    2.537502    0.159988    2036.52433 
[37m[36mINFO[0m[0m 05/14 15:38:02 | 0.485162    0.484258    0.497387    0.477056    2.461239    0.641726    0.633143    0.300722    0.241740    0.515541    0.496852    0.481399    0.489565    0.485162    0.484258    0.547547    0.523978    14000       2.908789    2.470130    0.266429    2025.85283 
[37m[36mINFO[0m[0m 05/14 16:15:20 | 0.473728    0.468126    0.500786    0.476367    2.452032    0.646660    0.634286    0.300237    0.239124    0.517911    0.492562    0.485768    0.491739    0.473728    0.468126    0.553352    0.524123    15000       3.116559    2.447144    0.163596    2074.52434 
[37m[36mINFO[0m[0m 05/14 16:15:20 | Cumulative gradient change saved at train_output/DomainNet/GENIE/[4]/250514_06-22-56_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 05/14 16:15:21 | ---
[37m[36mINFO[0m[0m 05/14 16:15:21 | test-domain validation(oracle) = 48.516%
[37m[36mINFO[0m[0m 05/14 16:15:21 | training-domain validation(iid) = 47.618%
[37m[36mINFO[0m[0m 05/14 16:15:21 | last = 47.373%
[37m[36mINFO[0m[0m 05/14 16:15:21 | last (inD) = 47.637%
[37m[36mINFO[0m[0m 05/14 16:15:21 | training-domain validation (iid, inD) = 48.075%
[37m[36mINFO[0m[0m 05/14 16:15:22 | === Summary ===
[37m[36mINFO[0m[0m 05/14 16:15:22 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 4 --dataset DomainNet --trial_seed 1 --hparams_seed 17
[37m[36mINFO[0m[0m 05/14 16:15:22 | Unique name: 250514_06-22-56_resnet50_sgd
[37m[36mINFO[0m[0m 05/14 16:15:22 | Out path: train_output/DomainNet/GENIE/[4]/250514_06-22-56_resnet50_sgd
[37m[36mINFO[0m[0m 05/14 16:15:22 | Algorithm: GENIE
[37m[36mINFO[0m[0m 05/14 16:15:22 | Dataset: DomainNet

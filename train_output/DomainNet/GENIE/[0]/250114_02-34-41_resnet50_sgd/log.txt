[37m[36mINFO[0m[0m 01/14 02:34:41 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm gnsr1224 --test_envs 0 --dataset DomainNet --trial_seed 0 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: gnsr1224
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: DomainNet
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/DomainNet/gnsr1224/[0]/250114_02-34-41_resnet50_sgd
	out_root: train_output/DomainNet/gnsr1224/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250114_02-34-41_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5.0781288859686544e-05
	batch_size: 31
	weight_decay: 0.00046410133598234803
	momentum: 0.9060723671260025
	convergence_rate: 0.013251603567592897
	moving_avg: 0.9034847647862135
	p: 0.5341202871092618
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[DomainNet] #envs=6, #classes=345
	env0: clip (#48129)
	env1: info (#51605)
	env2: paint (#72266)
	env3: quick (#172500)
	env4: real (#172947)
	env5: sketch (#69128)

[37m[36mINFO[0m[0m 01/14 02:34:42 | n_steps = 15001
[37m[36mINFO[0m[0m 01/14 02:34:42 | checkpoint_freq = 1000
[37m[36mINFO[0m[0m 01/14 02:34:42 | n_steps is updated to 15001 => 15001 for checkpointing
[37m[36mINFO[0m[0m 01/14 02:34:42 | Target test envs = [[0]]
[37m[36mINFO[0m[0m 01/14 02:34:42 | 
[37m[36mINFO[0m[0m 01/14 02:34:42 | Testenv name escaping te_clip -> te_clip
[37m[36mINFO[0m[0m 01/14 02:34:42 | Test envs = [0], name = te_clip
[37m[36mINFO[0m[0m 01/14 02:34:42 | Batch sizes for each domain: [0, 31, 31, 31, 31, 31] (total=155)
[37m[36mINFO[0m[0m 01/14 02:34:42 | steps-per-epoch for each domain: 1331.74, 1864.94, 4451.61, 4463.16, 1783.97 -> min = 1331.74
[37m[36mINFO[0m[0m 01/14 02:34:44 | # of params = 24214937
[37m[36mINFO[0m[0m 01/14 03:12:40 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    env4_in     env4_out    env5_in     env5_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/14 03:12:40 | 0.003714    0.003844    0.003323    0.002524    5.898300    0.003714    0.003844    0.003028    0.001841    0.004688    0.003252    0.003899    0.004319    0.002125    0.001908    0.002875    0.001302    0           0.000000    5.944069    1.670970    2273.81613 
[37m[36mINFO[0m[0m 01/14 03:55:25 | 0.456316    0.460675    0.438828    0.434801    2.665871    0.456316    0.460675    0.266713    0.225560    0.506685    0.513942    0.317312    0.336464    0.612606    0.625343    0.490823    0.472694    1000        0.750896    3.743391    0.319633    2245.36352 
[37m[36mINFO[0m[0m 01/14 04:39:17 | 0.524569    0.527688    0.506038    0.495039    2.330173    0.524569    0.527688    0.314141    0.264219    0.562330    0.556217    0.439580    0.455768    0.662434    0.675157    0.551706    0.523834    2000        1.501792    2.442137    0.330462    2301.19030 
[37m[36mINFO[0m[0m 01/14 05:22:53 | 0.543034    0.548571    0.541349    0.523533    2.174420    0.543034    0.548571    0.348416    0.286213    0.598256    0.583270    0.476188    0.490203    0.693534    0.699066    0.590348    0.558915    3000        2.252689    2.198088    0.329136    2286.22482 
[37m[36mINFO[0m[0m 01/14 06:06:46 | 0.575083    0.578494    0.561303    0.539736    2.102384    0.575083    0.578494    0.360866    0.296192    0.613980    0.595586    0.516775    0.524551    0.705416    0.706294    0.609479    0.576058    4000        3.003585    2.034817    0.327061    2306.42516 
[37m[36mINFO[0m[0m 01/14 06:50:16 | 0.573629    0.581714    0.582977    0.552179    2.033554    0.573629    0.581714    0.386203    0.305397    0.639666    0.608939    0.536797    0.540841    0.720067    0.720836    0.632154    0.584882    5000        3.754481    1.922399    0.324672    2284.41480 
[37m[36mINFO[0m[0m 01/14 07:34:16 | 0.588484    0.596779    0.598614    0.560279    2.003576    0.588484    0.596779    0.408148    0.312179    0.654022    0.618072    0.550710    0.554464    0.732881    0.725577    0.647307    0.591103    6000        4.505377    1.842020    0.326233    2313.99776 
[37m[36mINFO[0m[0m 01/14 08:17:37 | 0.600873    0.605091    0.611100    0.570664    1.969976    0.600873    0.605091    0.419557    0.320124    0.660146    0.617311    0.579507    0.580319    0.738837    0.733615    0.657451    0.601953    7000        5.256274    1.774599    0.320149    2280.59100 
[37m[36mINFO[0m[0m 01/14 09:00:57 | 0.598353    0.607896    0.621843    0.575332    1.942972    0.598353    0.607896    0.434066    0.323418    0.677477    0.628520    0.577913    0.579681    0.747496    0.738674    0.672260    0.606365    8000        6.007170    1.711084    0.328572    2270.88481 
[37m[36mINFO[0m[0m 01/14 09:44:25 | 0.610716    0.620260    0.632761    0.582912    1.900795    0.610716    0.620260    0.451119    0.334657    0.685953    0.629004    0.589652    0.586261    0.752273    0.742433    0.684809    0.622206    9000        6.758066    1.658251    0.327406    2280.20157 
[37m[36mINFO[0m[0m 01/14 10:28:02 | 0.602898    0.611948    0.639238    0.584181    1.913552    0.602898    0.611948    0.459040    0.330879    0.691938    0.637307    0.599123    0.591362    0.756378    0.743126    0.689709    0.618228    10000       7.508962    1.604103    0.326497    2290.46212 
[37m[36mINFO[0m[0m 01/14 11:11:46 | 0.611833    0.618494    0.647482    0.586417    1.920146    0.611833    0.618494    0.476771    0.334173    0.699341    0.638345    0.607232    0.597855    0.760541    0.745295    0.693525    0.616420    11000       8.259859    1.546077    0.321490    2301.55714 
[37m[36mINFO[0m[0m 01/14 11:55:36 | 0.617442    0.625039    0.657135    0.592721    1.873850    0.617442    0.625039    0.487889    0.343668    0.710913    0.644157    0.613312    0.602377    0.764141    0.747290    0.709419    0.626112    12000       9.010755    1.513227    0.319825    2309.82837 
[37m[36mINFO[0m[0m 01/14 12:39:10 | 0.621935    0.625455    0.667146    0.596829    1.869567    0.621935    0.625455    0.501720    0.346575    0.719233    0.647616    0.618623    0.604551    0.772886    0.751915    0.723270    0.633490    13000       9.761651    1.466577    0.319296    2294.90528 
[37m[36mINFO[0m[0m 01/14 13:22:46 | 0.624039    0.625870    0.676079    0.597425    1.848658    0.624039    0.625870    0.518990    0.342893    0.726809    0.643949    0.635580    0.618232    0.772019    0.750007    0.726995    0.632043    14000       10.512547   1.439539    0.329174    2285.95355 
[37m[36mINFO[0m[0m 01/14 14:06:19 | 0.629935    0.634390    0.681575    0.602132    1.858222    0.629935    0.634390    0.530327    0.354617    0.731842    0.648170    0.636196    0.617913    0.777758    0.754228    0.731751    0.635732    15000       11.263443   1.401548    0.322165    2291.13521 
[37m[36mINFO[0m[0m 01/14 14:06:20 | ---
[37m[36mINFO[0m[0m 01/14 14:06:20 | test-domain validation(oracle) = 62.993%
[37m[36mINFO[0m[0m 01/14 14:06:20 | training-domain validation(iid) = 62.993%
[37m[36mINFO[0m[0m 01/14 14:06:20 | last = 62.993%
[37m[36mINFO[0m[0m 01/14 14:06:20 | last (inD) = 60.213%
[37m[36mINFO[0m[0m 01/14 14:06:20 | training-domain validation (iid, inD) = 60.213%
[37m[36mINFO[0m[0m 01/14 14:06:20 | === Summary ===
[37m[36mINFO[0m[0m 01/14 14:06:20 | Command: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm gnsr1224 --test_envs 0 --dataset DomainNet --trial_seed 0 --hparams_seed 1
[37m[36mINFO[0m[0m 01/14 14:06:20 | Unique name: 250114_02-34-41_resnet50_sgd
[37m[36mINFO[0m[0m 01/14 14:06:20 | Out path: train_output/DomainNet/gnsr1224/[0]/250114_02-34-41_resnet50_sgd
[37m[36mINFO[0m[0m 01/14 14:06:20 | Algorithm: gnsr1224
[37m[36mINFO[0m[0m 01/14 14:06:20 | Dataset: DomainNet
[37m[36mINFO[0m[0m 01/14 14:06:20 | Max test_in: 0.6299

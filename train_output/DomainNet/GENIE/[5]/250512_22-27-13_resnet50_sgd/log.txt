[37m[36mINFO[0m[0m 05/12 22:27:13 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 5 --dataset DomainNet --trial_seed 2 --hparams_seed 7
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: DomainNet
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 7
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/DomainNet/GENIE/[5]/250512_22-27-13_resnet50_sgd
	out_root: train_output/DomainNet/GENIE/[5]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [5]
	trial_seed: 2
	unique_name: 250512_22-27-13_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 0.00023761560100715143
	batch_size: 17
	weight_decay: 4.1733891298839565e-05
	momentum: 0.9775138903226575
	convergence_rate: 0.005702476855965589
	moving_avg: 0.9725185670317151
	p: 0.24062656316141764
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[DomainNet] #envs=6, #classes=345
	env0: clip (#48129)
	env1: info (#51605)
	env2: paint (#72266)
	env3: quick (#172500)
	env4: real (#172947)
	env5: sketch (#69128)

[37m[36mINFO[0m[0m 05/12 22:27:14 | n_steps = 15001
[37m[36mINFO[0m[0m 05/12 22:27:14 | checkpoint_freq = 1000
[37m[36mINFO[0m[0m 05/12 22:27:14 | n_steps is updated to 15001 => 15001 for checkpointing
[37m[36mINFO[0m[0m 05/12 22:27:14 | 
[37m[36mINFO[0m[0m 05/12 22:27:14 | Testenv name escaping te_sketch -> te_sketch
[37m[36mINFO[0m[0m 05/12 22:27:14 | Test envs = [5], name = te_sketch
[37m[36mINFO[0m[0m 05/12 22:27:14 | Train environments: [0, 1, 2, 3, 4], Test environments: [5]
[37m[36mINFO[0m[0m 05/12 22:27:14 | Batch sizes for each domain: [17, 17, 17, 17, 17, 0] (total=85)
[37m[36mINFO[0m[0m 05/12 22:27:14 | steps-per-epoch for each domain: 2264.94, 2428.47, 3400.76, 8117.65, 8138.71 -> min = 2264.94
[37m[36mINFO[0m[0m 05/12 22:27:16 | # of params = 24214937
[37m[36mINFO[0m[0m 05/12 23:05:40 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    env4_in     env4_out    env5_in     env5_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 05/12 23:05:40 | 0.002550    0.001881    0.003011    0.002680    5.906247    0.003558    0.003013    0.002083    0.002325    0.003978    0.002214    0.003761    0.003768    0.001677    0.002082    0.002550    0.001881    0           0.000000    5.890320    1.332714    2302.79763 
[37m[36mINFO[0m[0m 05/12 23:48:14 | 0.339982    0.336203    0.363781    0.372591    3.005407    0.455927    0.461195    0.205358    0.187191    0.419957    0.434373    0.208725    0.226841    0.528939    0.553355    0.339982    0.336203    1000        0.441513    4.533801    0.244134    2309.79186 
[37m[36mINFO[0m[0m 05/13 00:31:19 | 0.404734    0.403689    0.457714    0.460121    2.520584    0.559994    0.563844    0.265890    0.232923    0.505613    0.504740    0.342123    0.368058    0.614948    0.631039    0.404734    0.403689    2000        0.883025    2.685598    0.245899    2339.46778 
[37m[36mINFO[0m[0m 05/13 01:14:03 | 0.440826    0.437468    0.501223    0.494767    2.318439    0.612871    0.603325    0.296216    0.253173    0.543511    0.536428    0.400319    0.422783    0.653197    0.658128    0.440826    0.437468    3000        1.324538    2.353188    0.237200    2327.12617 
[37m[36mINFO[0m[0m 05/13 01:56:53 | 0.453990    0.444919    0.532545    0.523582    2.190589    0.653127    0.638130    0.314044    0.270129    0.572657    0.564865    0.445754    0.461449    0.677142    0.683339    0.453990    0.444919    4000        1.766050    2.166045    0.261624    2308.22629 
[37m[36mINFO[0m[0m 05/13 02:40:07 | 0.471276    0.468282    0.549343    0.538028    2.105382    0.670008    0.649870    0.335360    0.283693    0.581738    0.573168    0.479007    0.492435    0.680604    0.690971    0.471276    0.468282    5000        2.207563    2.044800    0.268127    2325.26151 
[37m[36mINFO[0m[0m 05/13 03:23:02 | 0.473627    0.470886    0.568018    0.550932    2.056768    0.693538    0.663273    0.351274    0.290282    0.603325    0.592472    0.497188    0.509449    0.694763    0.699182    0.473627    0.470886    6000        2.649075    1.964372    0.267532    2307.90496 
[37m[36mINFO[0m[0m 05/13 04:06:43 | 0.473247    0.473924    0.578952    0.558167    2.000107    0.705485    0.674390    0.360648    0.299002    0.611264    0.591849    0.510623    0.518000    0.706739    0.707595    0.473247    0.473924    7000        3.090588    1.892602    0.269960    2350.54957 
[37m[36mINFO[0m[0m 05/13 04:51:53 | 0.475905    0.472405    0.584724    0.559746    2.015513    0.707849    0.672104    0.369296    0.301327    0.621400    0.592195    0.517326    0.526232    0.707751    0.706872    0.475905    0.472405    8000        3.532101    1.816489    0.352492    2358.28456 
[37m[36mINFO[0m[0m 05/13 05:35:32 | 0.484006    0.481230    0.601713    0.572415    1.951051    0.734989    0.692675    0.385912    0.306559    0.629011    0.602920    0.538471    0.543130    0.720182    0.716789    0.484006    0.481230    9000        3.973613    1.756072    0.241026    2377.82600 
[37m[36mINFO[0m[0m 05/13 06:18:11 | 0.491113    0.487595    0.611269    0.579319    1.926673    0.741663    0.697558    0.394899    0.314020    0.647311    0.613783    0.543645    0.547855    0.728827    0.723380    0.491113    0.487595    10000       4.415126    1.718105    0.236973    2322.05791 
[37m[36mINFO[0m[0m 05/13 07:00:51 | 0.489811    0.481664    0.618248    0.582257    1.892822    0.752260    0.698182    0.406719    0.322934    0.650753    0.612952    0.549942    0.547623    0.731566    0.729596    0.489811    0.481664    11000       4.856638    1.684727    0.244658    2315.18151 
[37m[36mINFO[0m[0m 05/13 07:43:38 | 0.500226    0.502929    0.620653    0.583247    1.903562    0.754597    0.698078    0.406283    0.311113    0.649162    0.614198    0.561326    0.564609    0.731898    0.728237    0.500226    0.502929    12000       5.298151    1.643611    0.257767    2308.94870 
[37m[36mINFO[0m[0m 05/13 08:26:42 | 0.495380    0.491863    0.627465    0.585544    1.901790    0.761427    0.700260    0.419049    0.322643    0.662325    0.617450    0.560645    0.559304    0.733879    0.728064    0.495380    0.491863    13000       5.739663    1.613686    0.264338    2319.60347 
[37m[36mINFO[0m[0m 05/13 09:08:47 | 0.507712    0.504955    0.635185    0.592379    1.861662    0.776413    0.713143    0.420550    0.318961    0.665387    0.623192    0.570667    0.572232    0.742906    0.734366    0.507712    0.504955    14000       6.181176    1.565305    0.243109    2281.65944 
[37m[36mINFO[0m[0m 05/13 09:51:55 | 0.507224    0.502857    0.641433    0.594128    1.856136    0.776802    0.711065    0.433873    0.327197    0.675506    0.624092    0.578290    0.577246    0.742696    0.731042    0.507224    0.502857    15000       6.622689    1.530152    0.265421    2322.60292 
[37m[36mINFO[0m[0m 05/13 09:51:55 | Cumulative gradient change saved at train_output/DomainNet/GENIE/[5]/250512_22-27-13_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 05/13 09:51:57 | ---
[37m[36mINFO[0m[0m 05/13 09:51:57 | test-domain validation(oracle) = 50.771%
[37m[36mINFO[0m[0m 05/13 09:51:57 | training-domain validation(iid) = 50.722%
[37m[36mINFO[0m[0m 05/13 09:51:57 | last = 50.722%
[37m[36mINFO[0m[0m 05/13 09:51:57 | last (inD) = 59.413%
[37m[36mINFO[0m[0m 05/13 09:51:57 | training-domain validation (iid, inD) = 59.413%
[37m[36mINFO[0m[0m 05/13 09:51:57 | === Summary ===
[37m[36mINFO[0m[0m 05/13 09:51:57 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 5 --dataset DomainNet --trial_seed 2 --hparams_seed 7
[37m[36mINFO[0m[0m 05/13 09:51:57 | Unique name: 250512_22-27-13_resnet50_sgd
[37m[36mINFO[0m[0m 05/13 09:51:57 | Out path: train_output/DomainNet/GENIE/[5]/250512_22-27-13_resnet50_sgd
[37m[36mINFO[0m[0m 05/13 09:51:57 | Algorithm: GENIE
[37m[36mINFO[0m[0m 05/13 09:51:57 | Dataset: DomainNet

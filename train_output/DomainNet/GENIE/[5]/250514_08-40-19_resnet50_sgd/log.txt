[37m[36mINFO[0m[0m 05/14 08:40:19 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 5 --dataset DomainNet --trial_seed 2 --hparams_seed 10
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: DomainNet
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 10
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/DomainNet/GENIE/[5]/250514_08-40-19_resnet50_sgd
	out_root: train_output/DomainNet/GENIE/[5]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [5]
	trial_seed: 2
	unique_name: 250514_08-40-19_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 7.494887873901297e-05
	batch_size: 18
	weight_decay: 0.000495139494108363
	momentum: 0.9161886820913123
	convergence_rate: 0.003714112431183281
	moving_avg: 0.9624846363789884
	p: 0.14674963900384252
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[DomainNet] #envs=6, #classes=345
	env0: clip (#48129)
	env1: info (#51605)
	env2: paint (#72266)
	env3: quick (#172500)
	env4: real (#172947)
	env5: sketch (#69128)

[37m[36mINFO[0m[0m 05/14 08:40:19 | n_steps = 15001
[37m[36mINFO[0m[0m 05/14 08:40:19 | checkpoint_freq = 1000
[37m[36mINFO[0m[0m 05/14 08:40:19 | n_steps is updated to 15001 => 15001 for checkpointing
[37m[36mINFO[0m[0m 05/14 08:40:19 | 
[37m[36mINFO[0m[0m 05/14 08:40:20 | Testenv name escaping te_sketch -> te_sketch
[37m[36mINFO[0m[0m 05/14 08:40:20 | Test envs = [5], name = te_sketch
[37m[36mINFO[0m[0m 05/14 08:40:20 | Train environments: [0, 1, 2, 3, 4], Test environments: [5]
[37m[36mINFO[0m[0m 05/14 08:40:20 | Batch sizes for each domain: [18, 18, 18, 18, 18, 0] (total=90)
[37m[36mINFO[0m[0m 05/14 08:40:20 | steps-per-epoch for each domain: 2139.11, 2293.56, 3211.83, 7666.67, 7686.56 -> min = 2139.11
[37m[36mINFO[0m[0m 05/14 08:40:21 | # of params = 24214937
[37m[36mINFO[0m[0m 05/14 09:18:34 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    env4_in     env4_out    env5_in     env5_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 05/14 09:18:34 | 0.002477    0.001881    0.002943    0.002758    5.904847    0.003532    0.003013    0.001914    0.002519    0.004099    0.002352    0.003558    0.003710    0.001612    0.002197    0.002477    0.001881    0           0.000000    5.961601    1.151179    2291.21461 
[37m[36mINFO[0m[0m 05/14 10:01:19 | 0.025261    0.025678    0.033206    0.033483    5.605795    0.039684    0.037610    0.031562    0.030327    0.047740    0.049886    0.003138    0.004290    0.043908    0.045303    0.025261    0.025678    1000        0.467484    5.795585    0.271010    2294.44655 
[37m[36mINFO[0m[0m 05/14 10:44:41 | 0.321266    0.317324    0.326256    0.330046    3.364434    0.397076    0.396571    0.190873    0.172851    0.404546    0.414170    0.148486    0.159884    0.490301    0.506751    0.321266    0.317324    2000        0.934968    4.646109    0.334845    2267.37145 
[37m[36mINFO[0m[0m 05/14 11:27:17 | 0.395639    0.392550    0.417899    0.422420    2.774878    0.520855    0.526338    0.245834    0.218874    0.482158    0.492700    0.254754    0.273275    0.585893    0.600914    0.395639    0.392550    3000        1.402452    3.355996    0.246188    2309.40679 
[37m[36mINFO[0m[0m 05/14 12:09:23 | 0.434787    0.428571    0.470284    0.469116    2.478603    0.581108    0.578597    0.273568    0.243000    0.526525    0.526742    0.338812    0.354870    0.631405    0.642372    0.434787    0.428571    4000        1.869936    2.924613    0.245743    2279.89968 
[37m[36mINFO[0m[0m 05/14 12:52:08 | 0.445057    0.439060    0.496472    0.494331    2.350529    0.606612    0.601662    0.293237    0.256274    0.550291    0.551373    0.380087    0.398580    0.652134    0.663766    0.445057    0.439060    5000        2.337419    2.681664    0.269192    2296.35724 
[37m[36mINFO[0m[0m 05/14 13:35:03 | 0.458818    0.454322    0.518001    0.511774    2.264542    0.635596    0.625766    0.309418    0.267222    0.561569    0.560437    0.416623    0.428870    0.666799    0.676573    0.458818    0.454322    6000        2.804903    2.535998    0.281510    2293.17257 
[37m[36mINFO[0m[0m 05/14 14:18:04 | 0.467642    0.463146    0.530517    0.523184    2.190699    0.647128    0.638961    0.320681    0.276039    0.572293    0.567841    0.437522    0.450435    0.674959    0.682645    0.467642    0.463146    7000        3.272387    2.411975    0.269844    2311.69057 
[37m[36mINFO[0m[0m 05/14 15:00:55 | 0.480155    0.476311    0.543086    0.535226    2.140845    0.665671    0.653818    0.325429    0.284372    0.585612    0.577873    0.452312    0.466058    0.686408    0.694007    0.480155    0.476311    8000        3.739871    2.311676    0.281003    2289.82168 
[37m[36mINFO[0m[0m 05/14 15:44:36 | 0.481945    0.477468    0.559954    0.548941    2.066874    0.680812    0.665143    0.342966    0.291638    0.602460    0.592403    0.479551    0.493159    0.693982    0.702362    0.481945    0.477468    9000        4.207355    2.238544    0.298304    2322.86309 
[37m[36mINFO[0m[0m 05/14 16:27:01 | 0.489160    0.487378    0.566068    0.552316    2.049647    0.686422    0.665870    0.348707    0.295320    0.606784    0.592887    0.483862    0.497420    0.704564    0.710081    0.489160    0.487378    10000       4.674839    2.179730    0.243085    2301.46010 
[37m[36mINFO[0m[0m 05/14 17:10:14 | 0.501618    0.500687    0.576230    0.559882    2.005602    0.696733    0.672416    0.359704    0.305397    0.613218    0.598077    0.503797    0.510000    0.707700    0.713522    0.501618    0.500687    11000       5.142323    2.111615    0.267545    2325.48597 
[37m[36mINFO[0m[0m 05/14 17:53:49 | 0.501528    0.501410    0.584322    0.566036    1.979298    0.708472    0.680727    0.367116    0.311501    0.620258    0.604442    0.511370    0.516203    0.714393    0.717309    0.501528    0.501410    12000       5.609807    2.068513    0.284446    2330.84500 
[37m[36mINFO[0m[0m 05/14 18:36:19 | 0.503210    0.497794    0.590593    0.571135    1.949255    0.716133    0.685506    0.371597    0.319155    0.629080    0.607763    0.518420    0.524899    0.717732    0.718350    0.503210    0.497794    13000       6.077291    2.035071    0.260174    2289.47188 
[37m[36mINFO[0m[0m 05/14 19:19:41 | 0.508851    0.503219    0.596527    0.575181    1.936841    0.721535    0.692052    0.374770    0.312082    0.632107    0.608040    0.532246    0.541014    0.721975    0.722715    0.508851    0.503219    14000       6.544775    1.979458    0.310287    2292.04836 
[37m[36mINFO[0m[0m 05/14 20:02:41 | 0.507748    0.501483    0.602730    0.578788    1.916209    0.727093    0.694649    0.380753    0.316539    0.637953    0.614129    0.540435    0.543014    0.727417    0.725606    0.507748    0.501483    15000       7.012258    1.945397    0.285101    2294.92032 
[37m[36mINFO[0m[0m 05/14 20:02:41 | Cumulative gradient change saved at train_output/DomainNet/GENIE/[5]/250514_08-40-19_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 05/14 20:02:43 | ---
[37m[36mINFO[0m[0m 05/14 20:02:43 | test-domain validation(oracle) = 50.885%
[37m[36mINFO[0m[0m 05/14 20:02:43 | training-domain validation(iid) = 50.775%
[37m[36mINFO[0m[0m 05/14 20:02:43 | last = 50.775%
[37m[36mINFO[0m[0m 05/14 20:02:43 | last (inD) = 57.879%
[37m[36mINFO[0m[0m 05/14 20:02:43 | training-domain validation (iid, inD) = 57.879%
[37m[36mINFO[0m[0m 05/14 20:02:43 | === Summary ===
[37m[36mINFO[0m[0m 05/14 20:02:43 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 5 --dataset DomainNet --trial_seed 2 --hparams_seed 10
[37m[36mINFO[0m[0m 05/14 20:02:43 | Unique name: 250514_08-40-19_resnet50_sgd
[37m[36mINFO[0m[0m 05/14 20:02:43 | Out path: train_output/DomainNet/GENIE/[5]/250514_08-40-19_resnet50_sgd
[37m[36mINFO[0m[0m 05/14 20:02:43 | Algorithm: GENIE
[37m[36mINFO[0m[0m 05/14 20:02:43 | Dataset: DomainNet

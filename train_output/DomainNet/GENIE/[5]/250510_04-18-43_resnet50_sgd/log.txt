[37m[36mINFO[0m[0m 05/10 04:18:43 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 5 --dataset DomainNet --trial_seed 2 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: DomainNet
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/DomainNet/GENIE/[5]/250510_04-18-43_resnet50_sgd
	out_root: train_output/DomainNet/GENIE/[5]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [5]
	trial_seed: 2
	unique_name: 250510_04-18-43_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 3.1159521264763664e-05
	batch_size: 10
	weight_decay: 1.4650833494643601e-05
	momentum: 0.8489654784568189
	convergence_rate: 0.0014662523646731694
	moving_avg: 0.9055169203703878
	p: 0.5984347546894057
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[DomainNet] #envs=6, #classes=345
	env0: clip (#48129)
	env1: info (#51605)
	env2: paint (#72266)
	env3: quick (#172500)
	env4: real (#172947)
	env5: sketch (#69128)

[37m[36mINFO[0m[0m 05/10 04:18:44 | n_steps = 15001
[37m[36mINFO[0m[0m 05/10 04:18:44 | checkpoint_freq = 1000
[37m[36mINFO[0m[0m 05/10 04:18:44 | n_steps is updated to 15001 => 15001 for checkpointing
[37m[36mINFO[0m[0m 05/10 04:18:44 | 
[37m[36mINFO[0m[0m 05/10 04:18:45 | Testenv name escaping te_sketch -> te_sketch
[37m[36mINFO[0m[0m 05/10 04:18:45 | Test envs = [5], name = te_sketch
[37m[36mINFO[0m[0m 05/10 04:18:45 | Train environments: [0, 1, 2, 3, 4], Test environments: [5]
[37m[36mINFO[0m[0m 05/10 04:18:45 | Batch sizes for each domain: [10, 10, 10, 10, 10, 0] (total=50)
[37m[36mINFO[0m[0m 05/10 04:18:45 | steps-per-epoch for each domain: 3850.40, 4128.40, 5781.30, 13800.00, 13835.80 -> min = 3850.40
[37m[36mINFO[0m[0m 05/10 04:18:47 | # of params = 24214937
[37m[36mINFO[0m[0m 05/10 04:57:26 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    env4_in     env4_out    env5_in     env5_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 05/10 04:57:26 | 0.002604    0.002025    0.002998    0.002650    5.906221    0.003610    0.002909    0.002156    0.002422    0.003961    0.002214    0.003674    0.003623    0.001590    0.002082    0.002604    0.002025    0           0.000000    5.987269    1.268293    2318.14163 
[37m[36mINFO[0m[0m 05/10 05:38:58 | 0.004719    0.004991    0.006633    0.006621    5.812158    0.004649    0.004364    0.012111    0.012499    0.007317    0.006435    0.003304    0.003101    0.005782    0.006707    0.004719    0.004991    1000        0.259713    5.845390    0.155463    2336.14894 
[37m[36mINFO[0m[0m 05/10 06:19:55 | 0.017974    0.017866    0.021864    0.021486    5.693416    0.025010    0.022753    0.021776    0.021606    0.031775    0.032242    0.002935    0.003188    0.027826    0.027639    0.017974    0.017866    2000        0.519427    5.782985    0.159556    2297.25474 
[37m[36mINFO[0m[0m 05/10 07:00:40 | 0.124369    0.124412    0.129706    0.132909    4.875025    0.151491    0.144727    0.089139    0.087298    0.180755    0.190203    0.025659    0.029014    0.201485    0.213305    0.124369    0.124412    3000        0.779140    5.518239    0.155824    2289.76020 
[37m[36mINFO[0m[0m 05/10 07:41:30 | 0.269660    0.265750    0.276585    0.280706    3.700390    0.333498    0.331948    0.168831    0.156283    0.354626    0.365184    0.103652    0.111304    0.422317    0.438810    0.269660    0.265750    4000        1.038853    4.568049    0.153368    2296.39367 
[37m[36mINFO[0m[0m 05/10 08:22:01 | 0.342857    0.342134    0.350357    0.355214    3.214248    0.430864    0.433455    0.209524    0.189807    0.422258    0.433543    0.175000    0.186725    0.514137    0.532539    0.342857    0.342134    5000        1.298566    3.840272    0.154769    2275.83131 
[37m[36mINFO[0m[0m 05/10 09:02:34 | 0.369166    0.363617    0.391413    0.395676    2.975894    0.484443    0.488727    0.227885    0.208604    0.459585    0.467515    0.227159    0.239246    0.557994    0.574287    0.369166    0.363617    6000        1.558280    3.465981    0.151137    2281.99907 
[37m[36mINFO[0m[0m 05/10 09:42:36 | 0.392999    0.391682    0.419904    0.424724    2.774019    0.512622    0.517922    0.244792    0.226432    0.486707    0.492770    0.266333    0.282029    0.589066    0.604470    0.392999    0.391682    7000        1.817993    3.208673    0.153957    2248.46913 
[37m[36mINFO[0m[0m 05/10 10:23:24 | 0.418567    0.418083    0.445106    0.448439    2.668596    0.551267    0.554597    0.256903    0.231857    0.504177    0.509583    0.303877    0.322058    0.609303    0.624100    0.418567    0.418083    8000        2.077706    3.032861    0.151591    2296.34228 
[37m[36mINFO[0m[0m 05/10 11:03:37 | 0.431477    0.429295    0.463314    0.464931    2.518316    0.566565    0.568623    0.276039    0.243387    0.513743    0.522798    0.332217    0.346725    0.628008    0.643124    0.431477    0.429295    9000        2.337419    2.895183    0.153901    2258.71551 
[37m[36mINFO[0m[0m 05/10 11:44:06 | 0.434678    0.436600    0.476823    0.478003    2.469030    0.581810    0.583065    0.278050    0.247166    0.531939    0.535529    0.349116    0.369565    0.643201    0.654688    0.434678    0.436600    10000       2.597133    2.804245    0.152558    2276.86125 
[37m[36mINFO[0m[0m 05/10 12:23:52 | 0.445853    0.442604    0.492702    0.491690    2.379460    0.599081    0.596779    0.290088    0.255789    0.547126    0.550336    0.380283    0.396957    0.646930    0.658591    0.445853    0.442604    11000       2.856846    2.702776    0.148332    2237.73584 
[37m[36mINFO[0m[0m 05/10 13:03:59 | 0.453646    0.451139    0.500320    0.499482    2.332726    0.608352    0.609455    0.299826    0.263734    0.548804    0.554003    0.388804    0.401710    0.655813    0.668507    0.453646    0.451139    12000       3.116559    2.623789    0.151292    2255.32693 
[37m[36mINFO[0m[0m 05/10 13:44:12 | 0.462760    0.462134    0.510166    0.505854    2.295879    0.620974    0.617143    0.305518    0.268094    0.555636    0.559330    0.408341    0.413971    0.660359    0.670733    0.462760    0.462134    13000       3.376273    2.555913    0.150751    2262.43369 
[37m[36mINFO[0m[0m 05/10 14:24:37 | 0.462724    0.465823    0.515836    0.512092    2.255862    0.630506    0.629195    0.308110    0.266641    0.558369    0.560783    0.415167    0.424087    0.667030    0.679754    0.462724    0.465823    14000       3.635986    2.506178    0.147826    2276.84518 
[37m[36mINFO[0m[0m 05/10 15:05:31 | 0.467027    0.464521    0.523408    0.518195    2.238131    0.633726    0.629506    0.315037    0.272551    0.572812    0.572061    0.425667    0.437565    0.669799    0.679291    0.467027    0.464521    15000       3.895699    2.460431    0.149000    2305.43874 
[37m[36mINFO[0m[0m 05/10 15:05:31 | Cumulative gradient change saved at train_output/DomainNet/GENIE/[5]/250510_04-18-43_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 05/10 15:05:33 | ---
[37m[36mINFO[0m[0m 05/10 15:05:33 | test-domain validation(oracle) = 46.272%
[37m[36mINFO[0m[0m 05/10 15:05:33 | training-domain validation(iid) = 46.703%
[37m[36mINFO[0m[0m 05/10 15:05:33 | last = 46.703%
[37m[36mINFO[0m[0m 05/10 15:05:33 | last (inD) = 51.820%
[37m[36mINFO[0m[0m 05/10 15:05:33 | training-domain validation (iid, inD) = 51.820%
[37m[36mINFO[0m[0m 05/10 15:05:33 | === Summary ===
[37m[36mINFO[0m[0m 05/10 15:05:33 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 5 --dataset DomainNet --trial_seed 2 --hparams_seed 1
[37m[36mINFO[0m[0m 05/10 15:05:33 | Unique name: 250510_04-18-43_resnet50_sgd
[37m[36mINFO[0m[0m 05/10 15:05:33 | Out path: train_output/DomainNet/GENIE/[5]/250510_04-18-43_resnet50_sgd
[37m[36mINFO[0m[0m 05/10 15:05:33 | Algorithm: GENIE
[37m[36mINFO[0m[0m 05/10 15:05:33 | Dataset: DomainNet

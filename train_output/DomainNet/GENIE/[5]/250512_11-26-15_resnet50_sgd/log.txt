[37m[36mINFO[0m[0m 05/12 11:26:15 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 5 --dataset DomainNet --trial_seed 2 --hparams_seed 6
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: DomainNet
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 6
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/DomainNet/GENIE/[5]/250512_11-26-15_resnet50_sgd
	out_root: train_output/DomainNet/GENIE/[5]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [5]
	trial_seed: 2
	unique_name: 250512_11-26-15_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 0.00020671063342821416
	batch_size: 9
	weight_decay: 0.00021810605040355685
	momentum: 0.983248094981694
	convergence_rate: 0.09526529734855639
	moving_avg: 0.9670582205613204
	p: 0.5926314552294079
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[DomainNet] #envs=6, #classes=345
	env0: clip (#48129)
	env1: info (#51605)
	env2: paint (#72266)
	env3: quick (#172500)
	env4: real (#172947)
	env5: sketch (#69128)

[37m[36mINFO[0m[0m 05/12 11:26:16 | n_steps = 15001
[37m[36mINFO[0m[0m 05/12 11:26:16 | checkpoint_freq = 1000
[37m[36mINFO[0m[0m 05/12 11:26:16 | n_steps is updated to 15001 => 15001 for checkpointing
[37m[36mINFO[0m[0m 05/12 11:26:16 | 
[37m[36mINFO[0m[0m 05/12 11:26:17 | Testenv name escaping te_sketch -> te_sketch
[37m[36mINFO[0m[0m 05/12 11:26:17 | Test envs = [5], name = te_sketch
[37m[36mINFO[0m[0m 05/12 11:26:17 | Train environments: [0, 1, 2, 3, 4], Test environments: [5]
[37m[36mINFO[0m[0m 05/12 11:26:17 | Batch sizes for each domain: [9, 9, 9, 9, 9, 0] (total=45)
[37m[36mINFO[0m[0m 05/12 11:26:17 | steps-per-epoch for each domain: 4278.22, 4587.11, 6423.67, 15333.33, 15373.11 -> min = 4278.22
[37m[36mINFO[0m[0m 05/12 11:26:18 | # of params = 24214937
[37m[36mINFO[0m[0m 05/12 12:04:34 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    env4_in     env4_out    env5_in     env5_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 05/12 12:04:34 | 0.001103    0.001302    0.003374    0.003195    5.914820    0.001740    0.001974    0.004094    0.003682    0.003425    0.002560    0.003109    0.003420    0.004503    0.004337    0.001103    0.001302    0           0.000000    5.912591    1.422924    2294.25499 
[37m[36mINFO[0m[0m 05/12 12:46:04 | 0.113050    0.110307    0.105151    0.108637    4.678093    0.128636    0.132987    0.066345    0.062785    0.135662    0.137480    0.053913    0.060841    0.141199    0.149094    0.113050    0.110307    1000        0.233742    5.484206    0.184618    2306.02360 
[37m[36mINFO[0m[0m 05/12 13:27:37 | 0.225033    0.229078    0.243621    0.246965    3.654188    0.327265    0.337455    0.130922    0.114427    0.252054    0.248599    0.201877    0.218870    0.305989    0.315476    0.225033    0.229078    2000        0.467484    4.074742    0.178969    2313.28872 
[37m[36mINFO[0m[0m 05/12 14:09:04 | 0.269117    0.269873    0.299246    0.301464    3.350277    0.401647    0.407792    0.158052    0.142622    0.298860    0.296686    0.262333    0.274261    0.375338    0.385961    0.269117    0.269873    3000        0.701226    3.465250    0.181194    2305.76446 
[37m[36mINFO[0m[0m 05/12 14:50:28 | 0.304739    0.306618    0.346676    0.343928    3.140421    0.449745    0.448208    0.183025    0.158706    0.364174    0.364146    0.305710    0.310841    0.430723    0.437740    0.304739    0.306618    4000        0.934968    3.150422    0.177668    2306.93924 
[37m[36mINFO[0m[0m 05/12 15:32:37 | 0.346292    0.342857    0.392938    0.389109    2.887302    0.504545    0.499325    0.222847    0.188160    0.403767    0.403861    0.363087    0.380464    0.470446    0.473734    0.346292    0.342857    5000        1.168710    2.963035    0.196608    2331.56132 
[37m[36mINFO[0m[0m 05/12 16:15:12 | 0.348498    0.346763    0.413797    0.408253    2.814894    0.540697    0.530390    0.222314    0.189517    0.417813    0.413409    0.392377    0.405971    0.495786    0.501980    0.348498    0.346763    6000        1.402452    2.813489    0.254891    2300.41337 
[37m[36mINFO[0m[0m 05/12 16:55:21 | 0.359800    0.359349    0.424722    0.420683    2.712860    0.543112    0.543273    0.235249    0.194167    0.418522    0.410987    0.421464    0.438348    0.505262    0.516638    0.359800    0.359349    7000        1.636194    2.695621    0.161807    2247.08677 
[37m[36mINFO[0m[0m 05/12 17:36:09 | 0.358190    0.352984    0.433593    0.425029    2.683297    0.555475    0.547844    0.247965    0.198333    0.435525    0.422404    0.412877    0.433971    0.516125    0.522594    0.358190    0.352984    8000        1.869936    2.629851    0.153632    2294.27205 
[37m[36mINFO[0m[0m 05/12 18:18:09 | 0.394210    0.390597    0.473226    0.462179    2.502797    0.601574    0.587221    0.272503    0.226916    0.472662    0.457760    0.466123    0.482957    0.553268    0.556044    0.394210    0.390597    9000        2.103678    2.536165    0.167812    2352.83597 
[37m[36mINFO[0m[0m 05/12 18:59:58 | 0.389183    0.388210    0.475375    0.463741    2.492286    0.604223    0.588883    0.274828    0.227982    0.479131    0.467031    0.471000    0.482580    0.547695    0.552228    0.389183    0.388210    10000       2.337419    2.458108    0.176823    2332.24553 
[37m[36mINFO[0m[0m 05/12 19:41:54 | 0.382113    0.375118    0.467276    0.456445    2.563102    0.598561    0.584208    0.275603    0.224591    0.467213    0.452986    0.459261    0.483768    0.535741    0.536674    0.382113    0.375118    11000       2.571161    2.410933    0.182095    2333.82124 
[37m[36mINFO[0m[0m 05/12 20:23:09 | 0.404119    0.401519    0.495563    0.475024    2.433399    0.631389    0.601766    0.285655    0.222362    0.498365    0.478309    0.490000    0.506029    0.572406    0.566654    0.404119    0.401519    12000       2.804903    2.373220    0.182195    2292.52162 
[37m[36mINFO[0m[0m 05/12 21:04:44 | 0.414950    0.414177    0.504204    0.484182    2.429313    0.638323    0.611740    0.294787    0.232632    0.510698    0.491663    0.507870    0.514319    0.569342    0.570557    0.414950    0.414177    13000       3.038645    2.324527    0.186029    2309.15088 
[37m[36mINFO[0m[0m 05/12 21:45:40 | 0.396561    0.390958    0.497887    0.478293    2.444385    0.637960    0.610701    0.291057    0.225560    0.484216    0.467377    0.511877    0.515826    0.564326    0.572003    0.396561    0.390958    14000       3.272387    2.276249    0.166196    2290.05398 
[37m[36mINFO[0m[0m 05/12 22:27:07 | 0.394228    0.394213    0.492149    0.467263    2.470699    0.630324    0.589818    0.291324    0.224009    0.487693    0.460942    0.492319    0.504087    0.559086    0.557460    0.394228    0.394213    15000       3.506129    2.246959    0.177572    2309.30684 
[37m[36mINFO[0m[0m 05/12 22:27:07 | Cumulative gradient change saved at train_output/DomainNet/GENIE/[5]/250512_11-26-15_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 05/12 22:27:09 | ---
[37m[36mINFO[0m[0m 05/12 22:27:09 | test-domain validation(oracle) = 41.495%
[37m[36mINFO[0m[0m 05/12 22:27:09 | training-domain validation(iid) = 41.495%
[37m[36mINFO[0m[0m 05/12 22:27:09 | last = 39.423%
[37m[36mINFO[0m[0m 05/12 22:27:09 | last (inD) = 46.726%
[37m[36mINFO[0m[0m 05/12 22:27:09 | training-domain validation (iid, inD) = 48.418%
[37m[36mINFO[0m[0m 05/12 22:27:09 | === Summary ===
[37m[36mINFO[0m[0m 05/12 22:27:09 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 5 --dataset DomainNet --trial_seed 2 --hparams_seed 6
[37m[36mINFO[0m[0m 05/12 22:27:09 | Unique name: 250512_11-26-15_resnet50_sgd
[37m[36mINFO[0m[0m 05/12 22:27:09 | Out path: train_output/DomainNet/GENIE/[5]/250512_11-26-15_resnet50_sgd
[37m[36mINFO[0m[0m 05/12 22:27:09 | Algorithm: GENIE
[37m[36mINFO[0m[0m 05/12 22:27:09 | Dataset: DomainNet

[37m[36mINFO[0m[0m 05/13 21:07:19 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 5 --dataset DomainNet --trial_seed 2 --hparams_seed 9
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: DomainNet
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 9
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/DomainNet/GENIE/[5]/250513_21-07-19_resnet50_sgd
	out_root: train_output/DomainNet/GENIE/[5]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [5]
	trial_seed: 2
	unique_name: 250513_21-07-19_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 2.716671579524612e-05
	batch_size: 23
	weight_decay: 1.71368232883332e-06
	momentum: 0.9092933546128503
	convergence_rate: 0.02426611940613899
	moving_avg: 0.947722940872739
	p: 0.5933807106679234
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[DomainNet] #envs=6, #classes=345
	env0: clip (#48129)
	env1: info (#51605)
	env2: paint (#72266)
	env3: quick (#172500)
	env4: real (#172947)
	env5: sketch (#69128)

[37m[36mINFO[0m[0m 05/13 21:07:20 | n_steps = 15001
[37m[36mINFO[0m[0m 05/13 21:07:20 | checkpoint_freq = 1000
[37m[36mINFO[0m[0m 05/13 21:07:20 | n_steps is updated to 15001 => 15001 for checkpointing
[37m[36mINFO[0m[0m 05/13 21:07:20 | 
[37m[36mINFO[0m[0m 05/13 21:07:21 | Testenv name escaping te_sketch -> te_sketch
[37m[36mINFO[0m[0m 05/13 21:07:21 | Test envs = [5], name = te_sketch
[37m[36mINFO[0m[0m 05/13 21:07:21 | Train environments: [0, 1, 2, 3, 4], Test environments: [5]
[37m[36mINFO[0m[0m 05/13 21:07:21 | Batch sizes for each domain: [23, 23, 23, 23, 23, 0] (total=115)
[37m[36mINFO[0m[0m 05/13 21:07:21 | steps-per-epoch for each domain: 1674.09, 1794.96, 2513.61, 6000.00, 6015.57 -> min = 1674.09
[37m[36mINFO[0m[0m 05/13 21:07:23 | # of params = 24214937
[37m[36mINFO[0m[0m 05/13 21:46:07 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    env4_in     env4_out    env5_in     env5_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 05/13 21:46:07 | 0.002477    0.001664    0.002993    0.002911    5.895350    0.003013    0.002701    0.002132    0.003100    0.004324    0.003252    0.003703    0.003391    0.001792    0.002110    0.002477    0.001664    0           0.000000    5.929097    1.505041    2323.14308 
[37m[36mINFO[0m[0m 05/13 22:30:11 | 0.387791    0.384231    0.438902    0.439240    2.626680    0.542775    0.540987    0.251744    0.221684    0.483888    0.482806    0.333862    0.354203    0.582243    0.596519    0.387791    0.384231    1000        0.597341    3.516666    0.323742    2319.93562 
[37m[36mINFO[0m[0m 05/13 23:15:14 | 0.438891    0.434141    0.502799    0.498657    2.298826    0.619338    0.614130    0.308376    0.264994    0.538305    0.538227    0.403993    0.420754    0.643982    0.655179    0.438891    0.434141    2000        1.194681    2.359756    0.318673    2384.48389 
[37m[36mINFO[0m[0m 05/14 00:00:57 | 0.462018    0.454105    0.551056    0.535272    2.122616    0.680423    0.659429    0.337661    0.281077    0.578071    0.565696    0.481572    0.490348    0.677554    0.679812    0.462018    0.454105    3000        1.792022    2.106818    0.323968    2419.39437 
[37m[36mINFO[0m[0m 05/14 00:45:42 | 0.467588    0.464304    0.568419    0.544771    2.062908    0.696369    0.660156    0.357548    0.292704    0.600159    0.578357    0.502297    0.507130    0.685721    0.685507    0.467588    0.464304    4000        2.389362    1.963759    0.382714    2301.36572 
[37m[36mINFO[0m[0m 05/14 01:29:02 | 0.489124    0.482749    0.591992    0.565355    2.002915    0.728158    0.692052    0.382715    0.306947    0.614965    0.590466    0.526159    0.532058    0.707961    0.705253    0.489124    0.482749    5000        2.986703    1.841560    0.281482    2318.55220 
[37m[36mINFO[0m[0m 05/14 02:12:21 | 0.479576    0.478409    0.599924    0.565932    1.969981    0.732885    0.678857    0.390127    0.311501    0.623683    0.592472    0.548326    0.545652    0.704600    0.701177    0.479576    0.478409    6000        3.584043    1.754376    0.285023    2313.91680 
[37m[36mINFO[0m[0m 05/14 02:56:14 | 0.473699    0.473418    0.617599    0.574846    1.951312    0.757921    0.692883    0.408681    0.309369    0.644232    0.605549    0.559312    0.556986    0.717848    0.709445    0.473699    0.473418    7000        4.181384    1.677707    0.314471    2318.81090 
[37m[36mINFO[0m[0m 05/14 03:39:30 | 0.494404    0.492948    0.622412    0.581830    1.923296    0.757350    0.699740    0.421083    0.321190    0.651912    0.610531    0.558065    0.562029    0.723652    0.715661    0.494404    0.492948    8000        4.778724    1.612117    0.332965    2263.38746 
[37m[36mINFO[0m[0m 05/14 04:21:45 | 0.500262    0.494973    0.641516    0.591244    1.879294    0.775945    0.714597    0.444894    0.323224    0.668258    0.617588    0.585275    0.580928    0.733207    0.719882    0.500262    0.494973    9000        5.376065    1.565429    0.302567    2232.44958 
[37m[36mINFO[0m[0m 05/14 05:04:46 | 0.496176    0.489259    0.643813    0.590520    1.900527    0.786905    0.715740    0.440970    0.320705    0.680331    0.620217    0.574558    0.575594    0.736300    0.720345    0.496176    0.489259    10000       5.973405    1.517958    0.328447    2252.82851 
[37m[36mINFO[0m[0m 05/14 05:48:57 | 0.503951    0.497722    0.663296    0.599323    1.866359    0.805085    0.718130    0.474906    0.331557    0.692941    0.625476    0.599022    0.592319    0.744525    0.729134    0.503951    0.497722    11000       6.570746    1.462780    0.380745    2269.26649 
[37m[36mINFO[0m[0m 05/14 06:31:07 | 0.499250    0.499964    0.670376    0.599990    1.837313    0.817603    0.719792    0.480452    0.332817    0.693892    0.622085    0.610877    0.598522    0.749057    0.726734    0.499250    0.499964    12000       7.168086    1.419481    0.286998    2243.40509 
[37m[36mINFO[0m[0m 05/14 07:13:33 | 0.509773    0.511682    0.668726    0.598584    1.876398    0.815110    0.719584    0.482439    0.332235    0.694532    0.626306    0.598891    0.588261    0.752656    0.726532    0.509773    0.511682    13000       7.765427    1.386317    0.290136    2255.89149 
[37m[36mINFO[0m[0m 05/14 07:57:07 | 0.504132    0.498011    0.677700    0.601803    1.847768    0.824044    0.722597    0.495446    0.331460    0.700725    0.625268    0.616920    0.602203    0.751362    0.727486    0.504132    0.498011    14000       8.362768    1.339918    0.315724    2298.03685 
[37m[36mINFO[0m[0m 05/14 08:40:13 | 0.496212    0.490995    0.688906    0.608117    1.835386    0.828875    0.720935    0.511627    0.343571    0.714857    0.629973    0.629297    0.611275    0.759877    0.734829    0.496212    0.490995    15000       8.960108    1.312418    0.322786    2263.48411 
[37m[36mINFO[0m[0m 05/14 08:40:13 | Cumulative gradient change saved at train_output/DomainNet/GENIE/[5]/250513_21-07-19_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 05/14 08:40:14 | ---
[37m[36mINFO[0m[0m 05/14 08:40:14 | test-domain validation(oracle) = 50.977%
[37m[36mINFO[0m[0m 05/14 08:40:14 | training-domain validation(iid) = 49.621%
[37m[36mINFO[0m[0m 05/14 08:40:14 | last = 49.621%
[37m[36mINFO[0m[0m 05/14 08:40:14 | last (inD) = 60.812%
[37m[36mINFO[0m[0m 05/14 08:40:14 | training-domain validation (iid, inD) = 60.812%
[37m[36mINFO[0m[0m 05/14 08:40:15 | === Summary ===
[37m[36mINFO[0m[0m 05/14 08:40:15 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 5 --dataset DomainNet --trial_seed 2 --hparams_seed 9
[37m[36mINFO[0m[0m 05/14 08:40:15 | Unique name: 250513_21-07-19_resnet50_sgd
[37m[36mINFO[0m[0m 05/14 08:40:15 | Out path: train_output/DomainNet/GENIE/[5]/250513_21-07-19_resnet50_sgd
[37m[36mINFO[0m[0m 05/14 08:40:15 | Algorithm: GENIE
[37m[36mINFO[0m[0m 05/14 08:40:15 | Dataset: DomainNet

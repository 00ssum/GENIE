[37m[36mINFO[0m[0m 05/11 13:16:26 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 5 --dataset DomainNet --trial_seed 2 --hparams_seed 4
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: DomainNet
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 4
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/DomainNet/GENIE/[5]/250511_13-16-26_resnet50_sgd
	out_root: train_output/DomainNet/GENIE/[5]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [5]
	trial_seed: 2
	unique_name: 250511_13-16-26_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 6.164076981615215e-05
	batch_size: 10
	weight_decay: 3.184710792983041e-06
	momentum: 0.9903641916058693
	convergence_rate: 0.02352745664367345
	moving_avg: 0.9093139163665226
	p: 0.17159261258202024
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[DomainNet] #envs=6, #classes=345
	env0: clip (#48129)
	env1: info (#51605)
	env2: paint (#72266)
	env3: quick (#172500)
	env4: real (#172947)
	env5: sketch (#69128)

[37m[36mINFO[0m[0m 05/11 13:16:27 | n_steps = 15001
[37m[36mINFO[0m[0m 05/11 13:16:27 | checkpoint_freq = 1000
[37m[36mINFO[0m[0m 05/11 13:16:27 | n_steps is updated to 15001 => 15001 for checkpointing
[37m[36mINFO[0m[0m 05/11 13:16:27 | 
[37m[36mINFO[0m[0m 05/11 13:16:27 | Testenv name escaping te_sketch -> te_sketch
[37m[36mINFO[0m[0m 05/11 13:16:27 | Test envs = [5], name = te_sketch
[37m[36mINFO[0m[0m 05/11 13:16:27 | Train environments: [0, 1, 2, 3, 4], Test environments: [5]
[37m[36mINFO[0m[0m 05/11 13:16:27 | Batch sizes for each domain: [10, 10, 10, 10, 10, 0] (total=50)
[37m[36mINFO[0m[0m 05/11 13:16:27 | steps-per-epoch for each domain: 3850.40, 4128.40, 5781.30, 13800.00, 13835.80 -> min = 3850.40
[37m[36mINFO[0m[0m 05/11 13:16:29 | # of params = 24214937
[37m[36mINFO[0m[0m 05/11 13:54:35 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    env4_in     env4_out    env5_in     env5_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 05/11 13:54:35 | 0.002333    0.002098    0.003275    0.002978    5.898410    0.002415    0.002286    0.002277    0.002035    0.005552    0.004636    0.003725    0.003623    0.002407    0.002313    0.002333    0.002098    0           0.000000    5.888185    1.885904    2284.34995 
[37m[36mINFO[0m[0m 05/11 14:35:24 | 0.318373    0.315660    0.350854    0.351642    3.109710    0.451356    0.445506    0.199375    0.180603    0.386782    0.390922    0.229029    0.242870    0.487727    0.498309    0.318373    0.315660    1000        0.259713    4.284840    0.177788    2271.23985 
[37m[36mINFO[0m[0m 05/11 15:16:43 | 0.373036    0.370488    0.404714    0.405517    2.781963    0.504701    0.506701    0.232996    0.202887    0.435663    0.440739    0.316210    0.331884    0.533999    0.545376    0.373036    0.370488    2000        0.519427    2.922306    0.161119    2317.83196 
[37m[36mINFO[0m[0m 05/11 15:58:06 | 0.382348    0.376058    0.432232    0.433385    2.663123    0.559396    0.556052    0.249249    0.214902    0.446509    0.453262    0.354978    0.374551    0.551027    0.568158    0.382348    0.376058    3000        0.779140    2.597923    0.176370    2306.55482 
[37m[36mINFO[0m[0m 05/11 16:40:00 | 0.409707    0.407016    0.472867    0.465589    2.484301    0.595289    0.587740    0.263516    0.221103    0.495096    0.488342    0.402993    0.415768    0.607439    0.614993    0.409707    0.407016    4000        1.038853    2.442163    0.191574    2322.12720 
[37m[36mINFO[0m[0m 05/11 17:21:41 | 0.438837    0.434575    0.495089    0.485086    2.374631    0.625260    0.611636    0.297185    0.248716    0.522581    0.514219    0.415138    0.428232    0.615281    0.622626    0.438837    0.434575    5000        1.298566    2.307487    0.197425    2303.59665 
[37m[36mINFO[0m[0m 05/11 18:02:38 | 0.426143    0.425461    0.515189    0.501174    2.289348    0.643258    0.625766    0.307165    0.252398    0.541799    0.529163    0.445761    0.454232    0.637961    0.644309    0.426143    0.425461    6000        1.558280    2.218128    0.193079    2263.84002 
[37m[36mINFO[0m[0m 05/11 18:42:58 | 0.437083    0.431465    0.537180    0.521201    2.201183    0.658347    0.640727    0.331073    0.274683    0.570252    0.552135    0.476268    0.485681    0.649959    0.652780    0.437083    0.431465    7000        1.817993    2.132804    0.166522    2253.30921 
[37m[36mINFO[0m[0m 05/11 19:24:28 | 0.450066    0.448318    0.537768    0.519047    2.206618    0.670190    0.640623    0.324315    0.263734    0.554529    0.539473    0.493188    0.504116    0.646620    0.647287    0.450066    0.448318    8000        2.077706    2.081387    0.184745    2305.29760 
[37m[36mINFO[0m[0m 05/11 20:06:22 | 0.445961    0.441591    0.541183    0.517708    2.233546    0.678865    0.646857    0.332671    0.256661    0.557539    0.536636    0.485710    0.499362    0.651130    0.649021    0.445961    0.441591    9000        2.337419    2.015239    0.250794    2263.74723 
[37m[36mINFO[0m[0m 05/11 20:47:38 | 0.450012    0.446872    0.556546    0.530589    2.152089    0.702265    0.663481    0.343014    0.274876    0.573055    0.545838    0.503848    0.514696    0.660547    0.654052    0.450012    0.446872    10000       2.597133    1.955455    0.192123    2283.41785 
[37m[36mINFO[0m[0m 05/11 21:28:43 | 0.475128    0.473128    0.569436    0.542519    2.117779    0.700784    0.661195    0.371015    0.292123    0.592704    0.568740    0.515862    0.522319    0.666814    0.668218    0.475128    0.473128    11000       2.856846    1.908892    0.171358    2294.33010 
[37m[36mINFO[0m[0m 05/11 22:08:59 | 0.463519    0.456420    0.581038    0.547151    2.085467    0.715614    0.667636    0.378936    0.293479    0.602356    0.570262    0.526659    0.531043    0.681623    0.673335    0.463519    0.456420    12000       3.116559    1.877203    0.160457    2255.18318 
[37m[36mINFO[0m[0m 05/11 22:49:29 | 0.479884    0.471826    0.584442    0.551406    2.087992    0.719925    0.669818    0.381455    0.297161    0.613426    0.582578    0.527674    0.530783    0.679729    0.676689    0.479884    0.471826    13000       3.376273    1.839816    0.161176    2268.75465 
[37m[36mINFO[0m[0m 05/11 23:30:56 | 0.454261    0.450633    0.577617    0.545597    2.078580    0.717198    0.668156    0.378113    0.293673    0.591407    0.564589    0.528130    0.528725    0.673239    0.672844    0.454261    0.450633    14000       3.635986    1.802815    0.176828    2310.58305 
[37m[36mINFO[0m[0m 05/12 00:12:16 | 0.477117    0.473996    0.594210    0.556793    2.050610    0.732781    0.684260    0.393373    0.305784    0.622127    0.579810    0.536094    0.537362    0.686675    0.676747    0.477117    0.473996    15000       3.895699    1.783056    0.182304    2296.97550 
[37m[36mINFO[0m[0m 05/12 00:12:16 | Cumulative gradient change saved at train_output/DomainNet/GENIE/[5]/250511_13-16-26_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 05/12 00:12:17 | ---
[37m[36mINFO[0m[0m 05/12 00:12:17 | test-domain validation(oracle) = 47.712%
[37m[36mINFO[0m[0m 05/12 00:12:17 | training-domain validation(iid) = 47.712%
[37m[36mINFO[0m[0m 05/12 00:12:17 | last = 47.712%
[37m[36mINFO[0m[0m 05/12 00:12:17 | last (inD) = 55.679%
[37m[36mINFO[0m[0m 05/12 00:12:17 | training-domain validation (iid, inD) = 55.679%
[37m[36mINFO[0m[0m 05/12 00:12:18 | === Summary ===
[37m[36mINFO[0m[0m 05/12 00:12:18 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 5 --dataset DomainNet --trial_seed 2 --hparams_seed 4
[37m[36mINFO[0m[0m 05/12 00:12:18 | Unique name: 250511_13-16-26_resnet50_sgd
[37m[36mINFO[0m[0m 05/12 00:12:18 | Out path: train_output/DomainNet/GENIE/[5]/250511_13-16-26_resnet50_sgd
[37m[36mINFO[0m[0m 05/12 00:12:18 | Algorithm: GENIE
[37m[36mINFO[0m[0m 05/12 00:12:18 | Dataset: DomainNet

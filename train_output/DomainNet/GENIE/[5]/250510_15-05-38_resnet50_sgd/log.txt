[37m[36mINFO[0m[0m 05/10 15:05:38 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 5 --dataset DomainNet --trial_seed 2 --hparams_seed 2
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: DomainNet
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 2
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/DomainNet/GENIE/[5]/250510_15-05-38_resnet50_sgd
	out_root: train_output/DomainNet/GENIE/[5]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [5]
	trial_seed: 2
	unique_name: 250510_15-05-38_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 7.73819221686661e-05
	batch_size: 9
	weight_decay: 8.231814847964724e-05
	momentum: 0.9800348052461371
	convergence_rate: 0.004852785234856202
	moving_avg: 0.9435938286563235
	p: 0.7786881251417024
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[DomainNet] #envs=6, #classes=345
	env0: clip (#48129)
	env1: info (#51605)
	env2: paint (#72266)
	env3: quick (#172500)
	env4: real (#172947)
	env5: sketch (#69128)

[37m[36mINFO[0m[0m 05/10 15:05:39 | n_steps = 15001
[37m[36mINFO[0m[0m 05/10 15:05:39 | checkpoint_freq = 1000
[37m[36mINFO[0m[0m 05/10 15:05:39 | n_steps is updated to 15001 => 15001 for checkpointing
[37m[36mINFO[0m[0m 05/10 15:05:39 | 
[37m[36mINFO[0m[0m 05/10 15:05:39 | Testenv name escaping te_sketch -> te_sketch
[37m[36mINFO[0m[0m 05/10 15:05:39 | Test envs = [5], name = te_sketch
[37m[36mINFO[0m[0m 05/10 15:05:39 | Train environments: [0, 1, 2, 3, 4], Test environments: [5]
[37m[36mINFO[0m[0m 05/10 15:05:39 | Batch sizes for each domain: [9, 9, 9, 9, 9, 0] (total=45)
[37m[36mINFO[0m[0m 05/10 15:05:39 | steps-per-epoch for each domain: 4278.22, 4587.11, 6423.67, 15333.33, 15373.11 -> min = 4278.22
[37m[36mINFO[0m[0m 05/10 15:05:41 | # of params = 24214937
[37m[36mINFO[0m[0m 05/10 15:44:04 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    env4_in     env4_out    env5_in     env5_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 05/10 15:44:04 | 0.002712    0.001664    0.002983    0.002902    5.901099    0.003480    0.003740    0.002035    0.002616    0.004151    0.002422    0.003609    0.003652    0.001641    0.002082    0.002712    0.001664    0           0.000000    6.025042    1.011923    2302.46635 
[37m[36mINFO[0m[0m 05/10 16:24:40 | 0.059617    0.060470    0.069612    0.071059    5.287554    0.078252    0.073870    0.054767    0.052805    0.089772    0.093060    0.017638    0.020377    0.107634    0.115181    0.059617    0.060470    1000        0.233742    5.756766    0.150006    2285.28882 
[37m[36mINFO[0m[0m 05/10 17:04:59 | 0.327993    0.321808    0.329920    0.338482    3.279824    0.413801    0.422338    0.187482    0.170914    0.399616    0.415969    0.161580    0.177652    0.487120    0.505536    0.327993    0.321808    2000        0.467484    4.351829    0.146908    2272.61103 
[37m[36mINFO[0m[0m 05/10 17:45:14 | 0.388388    0.387703    0.402331    0.406007    2.864667    0.509428    0.509506    0.224881    0.203662    0.459239    0.466754    0.248341    0.263594    0.569768    0.586516    0.388388    0.387703    3000        0.701226    3.335121    0.145097    2269.44062 
[37m[36mINFO[0m[0m 05/10 18:26:01 | 0.416397    0.416781    0.445218    0.448899    2.612114    0.553813    0.559169    0.263686    0.235636    0.497639    0.505362    0.314667    0.330232    0.596286    0.614097    0.416397    0.416781    4000        0.934968    2.988938    0.149306    2297.82923 
[37m[36mINFO[0m[0m 05/10 19:06:06 | 0.429760    0.429005    0.473533    0.469494    2.469549    0.584355    0.579844    0.277904    0.240384    0.520765    0.520169    0.356942    0.367710    0.627698    0.639365    0.429760    0.429005    5000        1.168710    2.779097    0.147552    2257.80442 
[37m[36mINFO[0m[0m 05/10 19:45:57 | 0.442815    0.442893    0.493431    0.490394    2.375776    0.607132    0.602182    0.291784    0.257533    0.539394    0.542448    0.385797    0.401391    0.643049    0.648414    0.442815    0.442893    6000        1.402452    2.633897    0.145603    2245.70886 
[37m[36mINFO[0m[0m 05/10 20:26:54 | 0.445057    0.438481    0.497717    0.491911    2.350379    0.611573    0.608104    0.293334    0.252010    0.546694    0.540372    0.392210    0.406116    0.644777    0.652953    0.445057    0.438481    7000        1.636194    2.516904    0.152296    2304.27086 
[37m[36mINFO[0m[0m 05/10 21:09:12 | 0.447806    0.443400    0.515159    0.508938    2.253188    0.631337    0.628571    0.312688    0.268191    0.557089    0.552342    0.417928    0.429275    0.656753    0.666310    0.447806    0.443400    8000        1.869936    2.439812    0.211763    2326.29482 
[37m[36mINFO[0m[0m 05/10 21:50:32 | 0.462380    0.463002    0.525021    0.519587    2.206490    0.644375    0.637506    0.314795    0.273908    0.561586    0.558431    0.440761    0.455652    0.663590    0.672439    0.462380    0.463002    9000        2.103678    2.375057    0.166720    2313.51436 
[37m[36mINFO[0m[0m 05/10 22:31:44 | 0.481005    0.474937    0.544278    0.534138    2.133074    0.663931    0.649974    0.331557    0.281949    0.586910    0.576974    0.457906    0.474319    0.681088    0.687473    0.481005    0.474937    10000       2.337419    2.282873    0.168712    2302.64245 
[37m[36mINFO[0m[0m 05/10 23:13:04 | 0.468058    0.464521    0.551897    0.539901    2.094809    0.674086    0.654961    0.340834    0.290185    0.586114    0.577527    0.474819    0.487739    0.683632    0.689092    0.468058    0.464521    11000       2.571161    2.233773    0.162807    2317.24858 
[37m[36mINFO[0m[0m 05/10 23:54:18 | 0.469016    0.464810    0.561426    0.548405    2.068008    0.681825    0.666805    0.348004    0.293576    0.601266    0.589566    0.479804    0.491565    0.696230    0.700512    0.469016    0.464810    12000       2.804903    2.184290    0.171787    2302.33161 
[37m[36mINFO[0m[0m 05/11 00:34:58 | 0.477822    0.478192    0.560250    0.543679    2.079356    0.681617    0.656831    0.348028    0.289701    0.598153    0.582370    0.484739    0.498290    0.688713    0.691202    0.477822    0.478192    13000       3.038645    2.149138    0.152055    2288.23278 
[37m[36mINFO[0m[0m 05/11 01:15:33 | 0.476556    0.475371    0.568986    0.553906    2.038414    0.691149    0.674494    0.357863    0.301909    0.600453    0.587006    0.498362    0.500290    0.697105    0.705831    0.476556    0.475371    14000       3.272387    2.109905    0.165387    2269.91363 
[37m[36mINFO[0m[0m 05/11 01:56:30 | 0.496212    0.494033    0.577029    0.558779    2.027030    0.703537    0.673974    0.362102    0.305106    0.611177    0.593994    0.505471    0.515594    0.702858    0.705224    0.496212    0.494033    15000       3.506129    2.069045    0.158462    2298.44598 
[37m[36mINFO[0m[0m 05/11 01:56:31 | Cumulative gradient change saved at train_output/DomainNet/GENIE/[5]/250510_15-05-38_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 05/11 01:56:32 | ---
[37m[36mINFO[0m[0m 05/11 01:56:32 | test-domain validation(oracle) = 49.621%
[37m[36mINFO[0m[0m 05/11 01:56:32 | training-domain validation(iid) = 49.621%
[37m[36mINFO[0m[0m 05/11 01:56:32 | last = 49.621%
[37m[36mINFO[0m[0m 05/11 01:56:32 | last (inD) = 55.878%
[37m[36mINFO[0m[0m 05/11 01:56:32 | training-domain validation (iid, inD) = 55.878%
[37m[36mINFO[0m[0m 05/11 01:56:32 | === Summary ===
[37m[36mINFO[0m[0m 05/11 01:56:32 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 5 --dataset DomainNet --trial_seed 2 --hparams_seed 2
[37m[36mINFO[0m[0m 05/11 01:56:32 | Unique name: 250510_15-05-38_resnet50_sgd
[37m[36mINFO[0m[0m 05/11 01:56:32 | Out path: train_output/DomainNet/GENIE/[5]/250510_15-05-38_resnet50_sgd
[37m[36mINFO[0m[0m 05/11 01:56:32 | Algorithm: GENIE
[37m[36mINFO[0m[0m 05/11 01:56:32 | Dataset: DomainNet

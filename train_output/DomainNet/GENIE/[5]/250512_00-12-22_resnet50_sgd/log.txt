[37m[36mINFO[0m[0m 05/12 00:12:22 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 5 --dataset DomainNet --trial_seed 2 --hparams_seed 5
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: DomainNet
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 5
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/DomainNet/GENIE/[5]/250512_00-12-22_resnet50_sgd
	out_root: train_output/DomainNet/GENIE/[5]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [5]
	trial_seed: 2
	unique_name: 250512_00-12-22_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 0.0002982828768978312
	batch_size: 9
	weight_decay: 0.0003180957897867641
	momentum: 0.8904627167531411
	convergence_rate: 0.00346423000837165
	moving_avg: 0.9394248867967866
	p: 0.7427011929432814
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[DomainNet] #envs=6, #classes=345
	env0: clip (#48129)
	env1: info (#51605)
	env2: paint (#72266)
	env3: quick (#172500)
	env4: real (#172947)
	env5: sketch (#69128)

[37m[36mINFO[0m[0m 05/12 00:12:23 | n_steps = 15001
[37m[36mINFO[0m[0m 05/12 00:12:23 | checkpoint_freq = 1000
[37m[36mINFO[0m[0m 05/12 00:12:23 | n_steps is updated to 15001 => 15001 for checkpointing
[37m[36mINFO[0m[0m 05/12 00:12:23 | 
[37m[36mINFO[0m[0m 05/12 00:12:24 | Testenv name escaping te_sketch -> te_sketch
[37m[36mINFO[0m[0m 05/12 00:12:24 | Test envs = [5], name = te_sketch
[37m[36mINFO[0m[0m 05/12 00:12:24 | Train environments: [0, 1, 2, 3, 4], Test environments: [5]
[37m[36mINFO[0m[0m 05/12 00:12:24 | Batch sizes for each domain: [9, 9, 9, 9, 9, 0] (total=45)
[37m[36mINFO[0m[0m 05/12 00:12:24 | steps-per-epoch for each domain: 4278.22, 4587.11, 6423.67, 15333.33, 15373.11 -> min = 4278.22
[37m[36mINFO[0m[0m 05/12 00:12:25 | # of params = 24214937
[37m[36mINFO[0m[0m 05/12 00:51:17 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    env4_in     env4_out    env5_in     env5_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 05/12 00:51:17 | 0.002694    0.001881    0.002997    0.002871    5.903139    0.003584    0.003532    0.002083    0.002713    0.004013    0.002145    0.003652    0.003826    0.001655    0.002139    0.002694    0.001881    0           0.000000    6.025042    1.438375    2330.14807 
[37m[36mINFO[0m[0m 05/12 01:34:03 | 0.017305    0.018011    0.019475    0.019314    5.676751    0.023140    0.019325    0.023472    0.022188    0.022106    0.024078    0.004522    0.006000    0.024133    0.024979    0.017305    0.018011    1000        0.233742    5.808619    0.189510    2376.73474 
[37m[36mINFO[0m[0m 05/12 02:18:08 | 0.262246    0.259892    0.260586    0.266288    3.759559    0.323135    0.322182    0.153910    0.141072    0.335323    0.348924    0.089746    0.098812    0.400815    0.420452    0.262246    0.259892    2000        0.467484    5.003059    0.186994    2457.79295 
[37m[36mINFO[0m[0m 05/12 03:02:56 | 0.365134    0.359421    0.366881    0.371507    3.079089    0.461251    0.465143    0.206303    0.186513    0.431547    0.440531    0.197355    0.208232    0.537952    0.557114    0.365134    0.359421    3000        0.701226    3.681919    0.198425    2489.75414 
[37m[36mINFO[0m[0m 05/12 03:48:54 | 0.405421    0.401374    0.421631    0.426295    2.759006    0.521400    0.528000    0.246560    0.223719    0.481016    0.493185    0.279341    0.288696    0.579836    0.597878    0.405421    0.401374    4000        0.934968    3.196134    0.342190    2416.16127 
[37m[36mINFO[0m[0m 05/12 04:31:36 | 0.415204    0.411501    0.453412    0.453952    2.567265    0.560617    0.559481    0.264146    0.236121    0.506288    0.510967    0.322333    0.335913    0.613676    0.627280    0.415204    0.411501    5000        1.168710    2.937281    0.209467    2352.17085 
[37m[36mINFO[0m[0m 05/12 05:12:55 | 0.435058    0.436383    0.476052    0.476359    2.451395    0.587004    0.586078    0.277105    0.247844    0.524155    0.529648    0.359406    0.374203    0.632591    0.644020    0.435058    0.436383    6000        1.402452    2.766417    0.167991    2310.93357 
[37m[36mINFO[0m[0m 05/12 05:54:23 | 0.439072    0.432405    0.482851    0.481859    2.415244    0.591185    0.594597    0.283354    0.247650    0.534101    0.533592    0.368014    0.385072    0.637600    0.648385    0.439072    0.432405    7000        1.636194    2.638096    0.162405    2325.67263 
[37m[36mINFO[0m[0m 05/12 06:35:36 | 0.449252    0.444557    0.506772    0.502331    2.299641    0.623624    0.622961    0.306293    0.265575    0.551104    0.549159    0.395870    0.405768    0.656970    0.668189    0.449252    0.444557    8000        1.869936    2.535643    0.166000    2306.99813 
[37m[36mINFO[0m[0m 05/12 07:16:44 | 0.459939    0.459241    0.516389    0.514248    2.243571    0.632688    0.631065    0.307262    0.271485    0.558594    0.558362    0.421833    0.439072    0.661566    0.671254    0.459939    0.459241    9000        2.103678    2.469800    0.160832    2306.85367 
[37m[36mINFO[0m[0m 05/12 07:59:04 | 0.471240    0.466329    0.530536    0.523221    2.186927    0.648140    0.635948    0.320366    0.275942    0.573124    0.568117    0.438159    0.454435    0.672892    0.681662    0.471240    0.466329    10000       2.337419    2.370481    0.164038    2376.18540 
[37m[36mINFO[0m[0m 05/12 08:40:56 | 0.454532    0.454467    0.538512    0.530585    2.150600    0.658893    0.647169    0.329498    0.281368    0.574058    0.568325    0.455913    0.473101    0.674200    0.682963    0.454532    0.454467    11000       2.571161    2.316130    0.169850    2341.96248 
[37m[36mINFO[0m[0m 05/12 09:22:10 | 0.464893    0.463074    0.549303    0.538113    2.121461    0.667437    0.655377    0.335966    0.286019    0.590940    0.580848    0.462522    0.473594    0.689653    0.694730    0.464893    0.463074    12000       2.804903    2.262822    0.163627    2310.92746 
[37m[36mINFO[0m[0m 05/12 10:03:10 | 0.479468    0.480289    0.554703    0.540616    2.101476    0.675514    0.657143    0.341609    0.285534    0.593984    0.580710    0.475159    0.487768    0.687246    0.691925    0.479468    0.480289    13000       3.038645    2.224604    0.176395    2283.47420 
[37m[36mINFO[0m[0m 05/12 10:44:05 | 0.479594    0.479711    0.559696    0.546858    2.078346    0.680189    0.665143    0.347447    0.298614    0.593586    0.584308    0.483457    0.486174    0.693802    0.700049    0.479594    0.479711    14000       3.272387    2.188416    0.175880    2279.23036 
[37m[36mINFO[0m[0m 05/12 11:26:09 | 0.481674    0.478119    0.565194    0.550381    2.063186    0.689409    0.667221    0.351516    0.295998    0.601439    0.589220    0.487152    0.497101    0.696454    0.702362    0.481674    0.478119    15000       3.506129    2.137372    0.182273    2341.51557 
[37m[36mINFO[0m[0m 05/12 11:26:09 | Cumulative gradient change saved at train_output/DomainNet/GENIE/[5]/250512_00-12-22_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 05/12 11:26:11 | ---
[37m[36mINFO[0m[0m 05/12 11:26:11 | test-domain validation(oracle) = 47.947%
[37m[36mINFO[0m[0m 05/12 11:26:11 | training-domain validation(iid) = 48.167%
[37m[36mINFO[0m[0m 05/12 11:26:11 | last = 48.167%
[37m[36mINFO[0m[0m 05/12 11:26:11 | last (inD) = 55.038%
[37m[36mINFO[0m[0m 05/12 11:26:11 | training-domain validation (iid, inD) = 55.038%
[37m[36mINFO[0m[0m 05/12 11:26:11 | === Summary ===
[37m[36mINFO[0m[0m 05/12 11:26:11 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 5 --dataset DomainNet --trial_seed 2 --hparams_seed 5
[37m[36mINFO[0m[0m 05/12 11:26:11 | Unique name: 250512_00-12-22_resnet50_sgd
[37m[36mINFO[0m[0m 05/12 11:26:11 | Out path: train_output/DomainNet/GENIE/[5]/250512_00-12-22_resnet50_sgd
[37m[36mINFO[0m[0m 05/12 11:26:11 | Algorithm: GENIE
[37m[36mINFO[0m[0m 05/12 11:26:11 | Dataset: DomainNet

[37m[36mINFO[0m[0m 05/09 15:58:35 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 5 --dataset DomainNet --trial_seed 2 --hparams_seed 0
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: DomainNet
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/DomainNet/GENIE/[5]/250509_15-58-35_resnet50_sgd
	out_root: train_output/DomainNet/GENIE/[5]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [5]
	trial_seed: 2
	unique_name: 250509_15-58-35_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	momentum: 0.9
	convergence_rate: 0.015
	moving_avg: 0.95
	p: 0.4
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[DomainNet] #envs=6, #classes=345
	env0: clip (#48129)
	env1: info (#51605)
	env2: paint (#72266)
	env3: quick (#172500)
	env4: real (#172947)
	env5: sketch (#69128)

[37m[36mINFO[0m[0m 05/09 15:58:36 | n_steps = 15001
[37m[36mINFO[0m[0m 05/09 15:58:36 | checkpoint_freq = 1000
[37m[36mINFO[0m[0m 05/09 15:58:36 | n_steps is updated to 15001 => 15001 for checkpointing
[37m[36mINFO[0m[0m 05/09 15:58:36 | 
[37m[36mINFO[0m[0m 05/09 15:58:37 | Testenv name escaping te_sketch -> te_sketch
[37m[36mINFO[0m[0m 05/09 15:58:37 | Test envs = [5], name = te_sketch
[37m[36mINFO[0m[0m 05/09 15:58:37 | Train environments: [0, 1, 2, 3, 4], Test environments: [5]
[37m[36mINFO[0m[0m 05/09 15:58:37 | Batch sizes for each domain: [32, 32, 32, 32, 32, 0] (total=160)
[37m[36mINFO[0m[0m 05/09 15:58:37 | steps-per-epoch for each domain: 1203.25, 1290.12, 1806.66, 4312.50, 4323.69 -> min = 1203.25
[37m[36mINFO[0m[0m 05/09 15:58:38 | # of params = 24214937
[37m[36mINFO[0m[0m 05/09 16:40:17 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    env4_in     env4_out    env5_in     env5_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 05/09 16:40:17 | 0.002586    0.001808    0.003073    0.003056    5.894440    0.002987    0.003532    0.002107    0.002713    0.004878    0.003183    0.003558    0.003855    0.001836    0.001995    0.002586    0.001808    0           0.000000    5.946076    1.485909    2497.10833 
[37m[36mINFO[0m[0m 05/09 17:28:16 | 0.423630    0.419892    0.465101    0.464657    2.477054    0.572200    0.572364    0.274368    0.239318    0.511632    0.513942    0.346703    0.361710    0.620600    0.635954    0.423630    0.419892    1000        0.831082    3.487723    0.344032    2534.97794 
[37m[36mINFO[0m[0m 05/09 18:15:15 | 0.457082    0.455407    0.531122    0.518658    2.190926    0.653231    0.634286    0.321020    0.272745    0.569630    0.553449    0.443232    0.458899    0.668498    0.673914    0.457082    0.455407    2000        1.662165    2.239658    0.342580    2476.18179 
[37m[36mINFO[0m[0m 05/09 19:02:52 | 0.460680    0.454611    0.562553    0.543697    2.076393    0.688474    0.656623    0.345800    0.286794    0.595056    0.581263    0.488601    0.499826    0.694835    0.693978    0.460680    0.454611    3000        2.493247    1.992133    0.338827    2518.80765 
[37m[36mINFO[0m[0m 05/09 19:51:23 | 0.484314    0.479638    0.592626    0.565489    1.970162    0.721276    0.685610    0.374794    0.302878    0.627696    0.599806    0.528652    0.528493    0.710714    0.710659    0.484314    0.479638    4000        3.324330    1.842859    0.354059    2556.12284 
[37m[36mINFO[0m[0m 05/09 20:38:58 | 0.488418    0.486582    0.609292    0.573398    1.954936    0.741975    0.699013    0.395480    0.302103    0.640185    0.599737    0.542754    0.543449    0.726066    0.722686    0.488418    0.486582    5000        4.155412    1.734431    0.352217    2502.87370 
[37m[36mINFO[0m[0m 05/09 21:24:48 | 0.497080    0.492875    0.628014    0.587977    1.861260    0.765011    0.702234    0.417837    0.324000    0.663398    0.625406    0.560094    0.562145    0.733727    0.726098    0.497080    0.492875    6000        4.986495    1.644660    0.349779    2400.07518 
[37m[36mINFO[0m[0m 05/09 22:11:04 | 0.501528    0.497649    0.637541    0.592411    1.868501    0.777062    0.718857    0.425540    0.318768    0.670368    0.620840    0.572442    0.571043    0.742292    0.732545    0.501528    0.497649    7000        5.817577    1.561827    0.344645    2431.53840 
[37m[36mINFO[0m[0m 05/09 22:56:51 | 0.486248    0.478481    0.652206    0.599506    1.848025    0.788749    0.720623    0.445766    0.328747    0.686143    0.627413    0.592899    0.587797    0.747474    0.732950    0.486248    0.478481    8000        6.648660    1.512778    0.353329    2393.41773 
[37m[36mINFO[0m[0m 05/09 23:42:56 | 0.494801    0.488969    0.659824    0.601502    1.835783    0.802878    0.721766    0.461486    0.336983    0.688721    0.626514    0.594312    0.586261    0.751724    0.735985    0.494801    0.488969    9000        7.479742    1.453884    0.351701    2414.00063 
[37m[36mINFO[0m[0m 05/10 00:28:55 | 0.520641    0.516239    0.676030    0.609116    1.817448    0.818928    0.728312    0.481324    0.338146    0.708301    0.640144    0.608101    0.594667    0.763498    0.744312    0.520641    0.516239    10000       8.310825    1.385462    0.354494    2404.17825 
[37m[36mINFO[0m[0m 05/10 01:14:30 | 0.496049    0.491863    0.677436    0.604256    1.847614    0.818954    0.718961    0.490432    0.334173    0.707246    0.630457    0.607790    0.598696    0.762760    0.738992    0.496049    0.491863    11000       9.141907    1.341100    0.354096    2380.96641 
[37m[36mINFO[0m[0m 05/10 01:59:35 | 0.520605    0.512260    0.693224    0.613999    1.813220    0.830589    0.726961    0.513589    0.342312    0.728072    0.645610    0.620580    0.607391    0.773291    0.747723    0.520605    0.512260    12000       9.972990    1.298382    0.345769    2359.00639 
[37m[36mINFO[0m[0m 05/10 02:45:19 | 0.495398    0.490778    0.696531    0.609295    1.848831    0.839108    0.723325    0.518264    0.333592    0.729525    0.643673    0.624783    0.605188    0.770978    0.740698    0.495398    0.490778    13000       10.804072   1.255104    0.345698    2398.69768 
[37m[36mINFO[0m[0m 05/10 03:32:35 | 0.507640    0.503363    0.708935    0.615139    1.837355    0.851989    0.730805    0.537739    0.343571    0.737360    0.640559    0.635232    0.609246    0.782354    0.751511    0.507640    0.503363    14000       11.635155   1.219646    0.352199    2483.83762 
[37m[36mINFO[0m[0m 05/10 04:18:37 | 0.511744    0.506618    0.715417    0.615648    1.813319    0.853885    0.723117    0.549390    0.345800    0.752218    0.646994    0.638884    0.613797    0.782709    0.748533    0.511744    0.506618    15000       12.466237   1.166915    0.344155    2417.20264 
[37m[36mINFO[0m[0m 05/10 04:18:37 | Cumulative gradient change saved at train_output/DomainNet/GENIE/[5]/250509_15-58-35_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 05/10 04:18:38 | ---
[37m[36mINFO[0m[0m 05/10 04:18:38 | test-domain validation(oracle) = 52.064%
[37m[36mINFO[0m[0m 05/10 04:18:38 | training-domain validation(iid) = 51.174%
[37m[36mINFO[0m[0m 05/10 04:18:38 | last = 51.174%
[37m[36mINFO[0m[0m 05/10 04:18:38 | last (inD) = 61.565%
[37m[36mINFO[0m[0m 05/10 04:18:38 | training-domain validation (iid, inD) = 61.565%
[37m[36mINFO[0m[0m 05/10 04:18:39 | === Summary ===
[37m[36mINFO[0m[0m 05/10 04:18:39 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 5 --dataset DomainNet --trial_seed 2 --hparams_seed 0
[37m[36mINFO[0m[0m 05/10 04:18:39 | Unique name: 250509_15-58-35_resnet50_sgd
[37m[36mINFO[0m[0m 05/10 04:18:39 | Out path: train_output/DomainNet/GENIE/[5]/250509_15-58-35_resnet50_sgd
[37m[36mINFO[0m[0m 05/10 04:18:39 | Algorithm: GENIE
[37m[36mINFO[0m[0m 05/10 04:18:39 | Dataset: DomainNet

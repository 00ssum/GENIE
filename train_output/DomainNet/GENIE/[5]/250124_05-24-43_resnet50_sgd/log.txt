[37m[36mINFO[0m[0m 01/24 05:24:43 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm gnsr1224 --test_envs 5 --dataset DomainNet --trial_seed 0 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: gnsr1224
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: DomainNet
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/DomainNet/gnsr1224/[5]/250124_05-24-43_resnet50_sgd
	out_root: train_output/DomainNet/gnsr1224/[5]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [5]
	trial_seed: 0
	unique_name: 250124_05-24-43_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5.0781288859686544e-05
	batch_size: 31
	weight_decay: 0.00046410133598234803
	momentum: 0.9060723671260025
	convergence_rate: 0.013251603567592897
	moving_avg: 0.9034847647862135
	p: 0.5341202871092618
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[DomainNet] #envs=6, #classes=345
	env0: clip (#48129)
	env1: info (#51605)
	env2: paint (#72266)
	env3: quick (#172500)
	env4: real (#172947)
	env5: sketch (#69128)

[37m[36mINFO[0m[0m 01/24 05:24:44 | n_steps = 15001
[37m[36mINFO[0m[0m 01/24 05:24:44 | checkpoint_freq = 1000
[37m[36mINFO[0m[0m 01/24 05:24:44 | n_steps is updated to 15001 => 15001 for checkpointing
[37m[36mINFO[0m[0m 01/24 05:24:44 | Target test envs = [[5]]
[37m[36mINFO[0m[0m 01/24 05:24:44 | 
[37m[36mINFO[0m[0m 01/24 05:24:45 | Testenv name escaping te_sketch -> te_sketch
[37m[36mINFO[0m[0m 01/24 05:24:45 | Test envs = [5], name = te_sketch
[37m[36mINFO[0m[0m 01/24 05:24:45 | Batch sizes for each domain: [31, 31, 31, 31, 31, 0] (total=155)
[37m[36mINFO[0m[0m 01/24 05:24:45 | steps-per-epoch for each domain: 1242.06, 1331.74, 1864.94, 4451.61, 4463.16 -> min = 1242.06
[37m[36mINFO[0m[0m 01/24 05:24:47 | # of params = 24214937
[37m[36mINFO[0m[0m 01/24 06:02:02 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    env4_in     env4_out    env5_in     env5_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/24 06:02:02 | 0.002712    0.001736    0.003456    0.003094    5.897088    0.004077    0.004260    0.002325    0.001066    0.004601    0.003598    0.004188    0.004406    0.002089    0.002139    0.002712    0.001736    0           0.000000    5.914740    1.572575    2233.35379 
[37m[36mINFO[0m[0m 01/24 06:45:39 | 0.430013    0.426040    0.456427    0.459753    2.502639    0.564331    0.574753    0.264437    0.231567    0.502534    0.501142    0.337167    0.362232    0.613669    0.629073    0.430013    0.426040    1000        0.805111    3.695713    0.364321    2252.58965 
[37m[36mINFO[0m[0m 01/24 07:29:08 | 0.459487    0.458011    0.521722    0.516042    2.213001    0.631934    0.632519    0.316927    0.275458    0.559390    0.550543    0.436478    0.451072    0.663879    0.670618    0.459487    0.458011    2000        1.610222    2.348277    0.368005    2240.66886 
[37m[36mINFO[0m[0m 01/24 08:13:33 | 0.457805    0.456637    0.555418    0.542496    2.079988    0.673359    0.658182    0.340883    0.288635    0.593967    0.576282    0.484072    0.500203    0.684810    0.689179    0.457805    0.456637    3000        2.415333    2.073600    0.391903    2272.99997 
[37m[36mINFO[0m[0m 01/24 08:58:40 | 0.497912    0.493888    0.585940    0.566716    1.970616    0.710186    0.688104    0.368084    0.299486    0.620674    0.597800    0.519667    0.534435    0.711090    0.713753    0.497912    0.493888    4000        3.220445    1.927815    0.476732    2229.21220 
[37m[36mINFO[0m[0m 01/24 09:43:22 | 0.489196    0.484919    0.610020    0.579035    1.904670    0.742105    0.701610    0.396279    0.309079    0.641620    0.610392    0.539580    0.546058    0.730518    0.728035    0.489196    0.484919    5000        4.025556    1.820167    0.466220    2215.55891 
[37m[36mINFO[0m[0m 01/24 10:28:06 | 0.508580    0.503436    0.615314    0.583212    1.890330    0.749403    0.702753    0.403982    0.317896    0.644319    0.611845    0.548087    0.552783    0.730778    0.730781    0.508580    0.503436    6000        4.830667    1.726573    0.440821    2243.00977 
[37m[36mINFO[0m[0m 01/24 11:12:37 | 0.499955    0.495913    0.634275    0.593453    1.868929    0.775114    0.726442    0.420357    0.318089    0.664677    0.621601    0.574196    0.572377    0.737030    0.728758    0.499955    0.495913    7000        5.635778    1.653910    0.402558    2267.81523 
[37m[36mINFO[0m[0m 01/24 11:55:55 | 0.498544    0.495841    0.641954    0.596230    1.852063    0.782464    0.722390    0.433073    0.322740    0.668725    0.621532    0.582065    0.581565    0.743441    0.732921    0.498544    0.495841    8000        6.440889    1.589729    0.355799    2242.08009 
[37m[36mINFO[0m[0m 01/24 12:39:38 | 0.521292    0.513924    0.655284    0.601456    1.809991    0.794359    0.725714    0.451894    0.326519    0.684656    0.630803    0.595572    0.586783    0.749939    0.737460    0.521292    0.513924    9000        7.246000    1.528989    0.370066    2252.02351 
[37m[36mINFO[0m[0m 01/24 13:23:18 | 0.506537    0.504521    0.666017    0.609269    1.803352    0.807890    0.734442    0.466064    0.333398    0.694048    0.636131    0.605268    0.600058    0.756812    0.742317    0.506537    0.504521    10000       8.051112    1.481733    0.384447    2235.71432 
[37m[36mINFO[0m[0m 01/24 14:06:41 | 0.517278    0.513996    0.670791    0.608274    1.790062    0.812903    0.733610    0.479532    0.336983    0.698269    0.631772    0.602123    0.593884    0.761127    0.745121    0.517278    0.513996    11000       8.856223    1.430362    0.380727    2221.45251 
[37m[36mINFO[0m[0m 01/24 14:50:22 | 0.512233    0.509367    0.679027    0.611274    1.781467    0.821213    0.730390    0.487768    0.337564    0.709218    0.641182    0.612109    0.600087    0.764827    0.747145    0.512233    0.509367    12000       9.661334    1.389061    0.364728    2256.55797 
[37m[36mINFO[0m[0m 01/24 15:34:23 | 0.506627    0.503508    0.688627    0.614991    1.782070    0.830096    0.735792    0.504481    0.345315    0.717520    0.638760    0.621181    0.607130    0.769858    0.747955    0.506627    0.503508    13000       10.466445   1.349679    0.359352    2281.44407 
[37m[36mINFO[0m[0m 01/24 16:19:16 | 0.518471    0.513490    0.693022    0.613676    1.794275    0.831628    0.723636    0.512087    0.344443    0.721931    0.640905    0.625283    0.608986    0.774180    0.750412    0.518471    0.513490    14000       11.271556   1.310183    0.367172    2325.62174 
[37m[36mINFO[0m[0m 01/24 17:03:37 | 0.520171    0.515588    0.702747    0.616903    1.770493    0.845730    0.734026    0.524537    0.341634    0.734679    0.645748    0.631623    0.612638    0.777165    0.750470    0.520171    0.515588    15000       12.076667   1.276945    0.368994    2291.97357 
[37m[36mINFO[0m[0m 01/24 17:03:37 | ---
[37m[36mINFO[0m[0m 01/24 17:03:37 | test-domain validation(oracle) = 52.017%
[37m[36mINFO[0m[0m 01/24 17:03:37 | training-domain validation(iid) = 52.017%
[37m[36mINFO[0m[0m 01/24 17:03:37 | last = 52.017%
[37m[36mINFO[0m[0m 01/24 17:03:37 | last (inD) = 61.690%
[37m[36mINFO[0m[0m 01/24 17:03:37 | training-domain validation (iid, inD) = 61.690%
[37m[36mINFO[0m[0m 01/24 17:03:38 | === Summary ===
[37m[36mINFO[0m[0m 01/24 17:03:38 | Command: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm gnsr1224 --test_envs 5 --dataset DomainNet --trial_seed 0 --hparams_seed 1
[37m[36mINFO[0m[0m 01/24 17:03:38 | Unique name: 250124_05-24-43_resnet50_sgd
[37m[36mINFO[0m[0m 01/24 17:03:38 | Out path: train_output/DomainNet/gnsr1224/[5]/250124_05-24-43_resnet50_sgd
[37m[36mINFO[0m[0m 01/24 17:03:38 | Algorithm: gnsr1224
[37m[36mINFO[0m[0m 01/24 17:03:38 | Dataset: DomainNet
[37m[36mINFO[0m[0m 01/24 17:03:38 | Max test_in: 0.5213

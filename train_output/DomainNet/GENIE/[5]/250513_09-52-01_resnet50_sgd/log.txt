[37m[36mINFO[0m[0m 05/13 09:52:01 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 5 --dataset DomainNet --trial_seed 2 --hparams_seed 8
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: DomainNet
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 8
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/DomainNet/GENIE/[5]/250513_09-52-01_resnet50_sgd
	out_root: train_output/DomainNet/GENIE/[5]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [5]
	trial_seed: 2
	unique_name: 250513_09-52-01_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 3.019123985218396e-05
	batch_size: 9
	weight_decay: 0.0020603523571546007
	momentum: 0.9857599800923462
	convergence_rate: 0.03171500703990235
	moving_avg: 0.9979585507888638
	p: 0.6204179532934113
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[DomainNet] #envs=6, #classes=345
	env0: clip (#48129)
	env1: info (#51605)
	env2: paint (#72266)
	env3: quick (#172500)
	env4: real (#172947)
	env5: sketch (#69128)

[37m[36mINFO[0m[0m 05/13 09:52:02 | n_steps = 15001
[37m[36mINFO[0m[0m 05/13 09:52:02 | checkpoint_freq = 1000
[37m[36mINFO[0m[0m 05/13 09:52:02 | n_steps is updated to 15001 => 15001 for checkpointing
[37m[36mINFO[0m[0m 05/13 09:52:02 | 
[37m[36mINFO[0m[0m 05/13 09:52:03 | Testenv name escaping te_sketch -> te_sketch
[37m[36mINFO[0m[0m 05/13 09:52:03 | Test envs = [5], name = te_sketch
[37m[36mINFO[0m[0m 05/13 09:52:03 | Train environments: [0, 1, 2, 3, 4], Test environments: [5]
[37m[36mINFO[0m[0m 05/13 09:52:03 | Batch sizes for each domain: [9, 9, 9, 9, 9, 0] (total=45)
[37m[36mINFO[0m[0m 05/13 09:52:03 | steps-per-epoch for each domain: 4278.22, 4587.11, 6423.67, 15333.33, 15373.11 -> min = 4278.22
[37m[36mINFO[0m[0m 05/13 09:52:05 | # of params = 24214937
[37m[36mINFO[0m[0m 05/13 10:31:03 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    env4_in     env4_out    env5_in     env5_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 05/13 10:31:03 | 0.002333    0.002170    0.003874    0.003572    5.897615    0.002467    0.001870    0.003294    0.004166    0.006469    0.005397    0.003087    0.003188    0.004055    0.003238    0.002333    0.002170    0           0.000000    5.909909    2.438025    2335.59734 
[37m[36mINFO[0m[0m 05/13 11:16:00 | 0.017015    0.016854    0.021753    0.022370    5.526462    0.027114    0.028052    0.021534    0.021897    0.026689    0.028714    0.011304    0.010029    0.022124    0.023158    0.017015    0.016854    1000        0.233742    5.730499    0.386756    2310.88147 
[37m[36mINFO[0m[0m 05/13 11:58:48 | 0.194763    0.199060    0.186994    0.189999    4.029355    0.245585    0.251117    0.115880    0.103672    0.215782    0.215526    0.099420    0.109014    0.258301    0.270664    0.194763    0.199060    2000        0.467484    4.792996    0.271020    2296.61210 
[37m[36mINFO[0m[0m 05/13 12:40:52 | 0.327758    0.325931    0.328344    0.338090    3.143945    0.425644    0.438753    0.188112    0.171398    0.358726    0.367675    0.227486    0.247420    0.441753    0.465206    0.327758    0.325931    3000        0.701226    3.506951    0.184683    2338.87219 
[37m[36mINFO[0m[0m 05/13 13:23:02 | 0.342151    0.342351    0.375653    0.382205    2.910048    0.468471    0.479481    0.211462    0.187966    0.406033    0.415900    0.297920    0.320928    0.494377    0.506751    0.342151    0.342351    4000        0.934968    3.009397    0.173259    2357.39434 
[37m[36mINFO[0m[0m 05/13 14:04:12 | 0.345985    0.343508    0.416151    0.411543    2.741356    0.523634    0.520416    0.238228    0.206278    0.436597    0.433889    0.347565    0.358667    0.534729    0.538466    0.345985    0.343508    5000        1.168710    2.743242    0.167203    2302.19110 
[37m[36mINFO[0m[0m 05/13 14:46:47 | 0.386001    0.382857    0.444854    0.438301    2.607205    0.566045    0.555844    0.259301    0.218874    0.463719    0.459835    0.371964    0.382522    0.563242    0.574431    0.386001    0.382857    6000        1.402452    2.570866    0.170799    2384.23265 
[37m[36mINFO[0m[0m 05/13 15:27:51 | 0.400521    0.392767    0.457031    0.451587    2.535627    0.580329    0.573195    0.268651    0.225366    0.470379    0.468000    0.407478    0.423101    0.558320    0.568273    0.400521    0.392767    7000        1.636194    2.476406    0.162261    2302.30703 
[37m[36mINFO[0m[0m 05/13 16:10:15 | 0.392004    0.382568    0.484356    0.476496    2.405052    0.612508    0.601558    0.282870    0.239415    0.495356    0.487096    0.442623    0.460232    0.588423    0.594177    0.392004    0.382568    8000        1.869936    2.371269    0.179640    2364.05345 
[37m[36mINFO[0m[0m 05/13 16:52:38 | 0.424389    0.420904    0.504853    0.489203    2.346897    0.639570    0.614338    0.297355    0.242418    0.519935    0.506262    0.458101    0.469188    0.609303    0.613808    0.424389    0.420904    9000        2.103678    2.291906    0.181717    2361.03259 
[37m[36mINFO[0m[0m 05/13 17:36:04 | 0.430429    0.423942    0.507413    0.490687    2.339494    0.638609    0.621922    0.299583    0.241353    0.519589    0.498582    0.468739    0.479391    0.610547    0.612189    0.430429    0.423942    10000       2.337419    2.184346    0.182118    2424.16658 
[37m[36mINFO[0m[0m 05/13 18:18:25 | 0.430591    0.424521    0.521130    0.505342    2.271785    0.645491    0.629299    0.315934    0.257727    0.540259    0.522798    0.484072    0.494957    0.619892    0.621932    0.430591    0.424521    11000       2.571161    2.130492    0.176222    2364.51873 
[37m[36mINFO[0m[0m 05/13 19:00:53 | 0.429579    0.425750    0.531013    0.512067    2.282366    0.665697    0.642182    0.320657    0.258308    0.549773    0.527365    0.486957    0.497478    0.631984    0.635000    0.429579    0.425750    12000       2.804903    2.068680    0.181221    2366.68593 
[37m[36mINFO[0m[0m 05/13 19:43:07 | 0.457624    0.453526    0.545514    0.524812    2.201059    0.678527    0.651325    0.335433    0.267804    0.563887    0.542586    0.507761    0.520783    0.641965    0.641562    0.457624    0.453526    13000       3.038645    2.037709    0.169281    2365.27312 
[37m[36mINFO[0m[0m 05/13 20:25:19 | 0.444605    0.443834    0.556750    0.529629    2.125078    0.694525    0.653091    0.350693    0.278364    0.573781    0.546184    0.516268    0.524667    0.648484    0.645841    0.444605    0.443834    14000       3.272387    1.988317    0.173817    2358.10691 
[37m[36mINFO[0m[0m 05/13 21:07:12 | 0.449343    0.443038    0.563146    0.533612    2.135338    0.700213    0.657974    0.354181    0.278171    0.579126    0.551443    0.528413    0.532493    0.653797    0.647981    0.449343    0.443038    15000       3.506129    1.945658    0.175784    2337.34549 
[37m[36mINFO[0m[0m 05/13 21:07:13 | Cumulative gradient change saved at train_output/DomainNet/GENIE/[5]/250513_09-52-01_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 05/13 21:07:14 | ---
[37m[36mINFO[0m[0m 05/13 21:07:14 | test-domain validation(oracle) = 45.762%
[37m[36mINFO[0m[0m 05/13 21:07:14 | training-domain validation(iid) = 44.934%
[37m[36mINFO[0m[0m 05/13 21:07:14 | last = 44.934%
[37m[36mINFO[0m[0m 05/13 21:07:14 | last (inD) = 53.361%
[37m[36mINFO[0m[0m 05/13 21:07:14 | training-domain validation (iid, inD) = 53.361%
[37m[36mINFO[0m[0m 05/13 21:07:14 | === Summary ===
[37m[36mINFO[0m[0m 05/13 21:07:14 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 5 --dataset DomainNet --trial_seed 2 --hparams_seed 8
[37m[36mINFO[0m[0m 05/13 21:07:14 | Unique name: 250513_09-52-01_resnet50_sgd
[37m[36mINFO[0m[0m 05/13 21:07:14 | Out path: train_output/DomainNet/GENIE/[5]/250513_09-52-01_resnet50_sgd
[37m[36mINFO[0m[0m 05/13 21:07:14 | Algorithm: GENIE
[37m[36mINFO[0m[0m 05/13 21:07:14 | Dataset: DomainNet

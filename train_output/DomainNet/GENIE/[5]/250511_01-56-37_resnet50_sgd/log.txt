[37m[36mINFO[0m[0m 05/11 01:56:37 | Command :: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 5 --dataset DomainNet --trial_seed 2 --hparams_seed 3
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: DomainNet
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 3
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/DomainNet/GENIE/[5]/250511_01-56-37_resnet50_sgd
	out_root: train_output/DomainNet/GENIE/[5]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [5]
	trial_seed: 2
	unique_name: 250511_01-56-37_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 0.0002649077542048787
	batch_size: 17
	weight_decay: 0.0023111806563778695
	momentum: 0.8125216593488789
	convergence_rate: 0.0014082699681704626
	moving_avg: 0.9196111047565869
	p: 0.4412278223193331
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[DomainNet] #envs=6, #classes=345
	env0: clip (#48129)
	env1: info (#51605)
	env2: paint (#72266)
	env3: quick (#172500)
	env4: real (#172947)
	env5: sketch (#69128)

[37m[36mINFO[0m[0m 05/11 01:56:37 | n_steps = 15001
[37m[36mINFO[0m[0m 05/11 01:56:37 | checkpoint_freq = 1000
[37m[36mINFO[0m[0m 05/11 01:56:37 | n_steps is updated to 15001 => 15001 for checkpointing
[37m[36mINFO[0m[0m 05/11 01:56:37 | 
[37m[36mINFO[0m[0m 05/11 01:56:38 | Testenv name escaping te_sketch -> te_sketch
[37m[36mINFO[0m[0m 05/11 01:56:38 | Test envs = [5], name = te_sketch
[37m[36mINFO[0m[0m 05/11 01:56:38 | Train environments: [0, 1, 2, 3, 4], Test environments: [5]
[37m[36mINFO[0m[0m 05/11 01:56:38 | Batch sizes for each domain: [17, 17, 17, 17, 17, 0] (total=85)
[37m[36mINFO[0m[0m 05/11 01:56:38 | steps-per-epoch for each domain: 2264.94, 2428.47, 3400.76, 8117.65, 8138.71 -> min = 2264.94
[37m[36mINFO[0m[0m 05/11 01:56:39 | # of params = 24214937
[37m[36mINFO[0m[0m 05/11 02:35:30 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    env4_in     env4_out    env5_in     env5_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 05/11 02:35:30 | 0.002586    0.001808    0.002994    0.002667    5.908065    0.003558    0.002909    0.002083    0.002422    0.003875    0.002214    0.003848    0.003681    0.001605    0.002110    0.002586    0.001808    0           0.000000    5.890320    1.042905    2329.82819 
[37m[36mINFO[0m[0m 05/11 03:18:17 | 0.020813    0.019964    0.026077    0.026462    5.628791    0.027737    0.026701    0.026572    0.026451    0.038400    0.039161    0.004036    0.004899    0.033637    0.035098    0.020813    0.019964    1000        0.441513    5.788486    0.240769    2326.62459 
[37m[36mINFO[0m[0m 05/11 04:01:01 | 0.286748    0.283906    0.301559    0.308372    3.399715    0.368170    0.370701    0.173627    0.158415    0.371716    0.385733    0.132826    0.142580    0.461455    0.484431    0.286748    0.283906    2000        0.883025    4.415300    0.240119    2323.85354 
[37m[36mINFO[0m[0m 05/11 04:43:24 | 0.360216    0.354720    0.397022    0.399220    2.849166    0.487534    0.489558    0.222072    0.196105    0.455313    0.457275    0.249391    0.268667    0.570802    0.584492    0.360216    0.354720    3000        1.324538    3.075620    0.242101    2300.19114 
[37m[36mINFO[0m[0m 05/11 05:26:28 | 0.391787    0.385389    0.444352    0.445807    2.599431    0.543528    0.542545    0.247239    0.218777    0.498452    0.501211    0.322304    0.340319    0.610236    0.626182    0.391787    0.385389    4000        1.766050    2.687963    0.261572    2322.70551 
[37m[36mINFO[0m[0m 05/11 06:08:52 | 0.412021    0.409693    0.470561    0.471043    2.467844    0.571369    0.571013    0.267440    0.235055    0.518897    0.520722    0.365587    0.383826    0.629512    0.644598    0.412021    0.409693    5000        2.207563    2.481669    0.270142    2273.82370 
[37m[36mINFO[0m[0m 05/11 06:52:05 | 0.429398    0.431103    0.496378    0.491387    2.346449    0.606534    0.594909    0.285801    0.247263    0.540968    0.537951    0.398145    0.413739    0.650443    0.663072    0.429398    0.431103    6000        2.649075    2.358311    0.271517    2321.14964 
[37m[36mINFO[0m[0m 05/11 07:34:18 | 0.436034    0.431682    0.509699    0.502812    2.282318    0.618118    0.610286    0.294618    0.253270    0.554547    0.547014    0.420667    0.433159    0.660547    0.670329    0.436034    0.431682    7000        3.090588    2.254919    0.246706    2286.74668 
[37m[36mINFO[0m[0m 05/11 08:17:07 | 0.450916    0.447740    0.524189    0.515508    2.233174    0.635570    0.619532    0.304379    0.260731    0.568955    0.559469    0.440138    0.456928    0.671902    0.680881    0.450916    0.447740    8000        3.532101    2.168800    0.288270    2280.12413 
[37m[36mINFO[0m[0m 05/11 09:01:05 | 0.453809    0.445787    0.536947    0.527186    2.178275    0.653517    0.636364    0.320124    0.275942    0.573418    0.562305    0.455000    0.470435    0.682678    0.690884    0.453809    0.445787    9000        3.973613    2.096721    0.298085    2340.47980 
[37m[36mINFO[0m[0m 05/11 09:43:24 | 0.458727    0.458951    0.545806    0.534683    2.130285    0.660165    0.643740    0.325719    0.275555    0.581357    0.570331    0.470326    0.484551    0.691460    0.699240    0.458727    0.458951    10000       4.415126    2.049557    0.237153    2301.25714 
[37m[36mINFO[0m[0m 05/11 10:25:46 | 0.457606    0.452441    0.553195    0.538443    2.109011    0.672657    0.644779    0.330830    0.280593    0.589971    0.573445    0.475094    0.488841    0.697423    0.704559    0.457606    0.452441    11000       4.856638    2.017328    0.244388    2297.92621 
[37m[36mINFO[0m[0m 05/11 11:07:49 | 0.466665    0.464159    0.562708    0.547898    2.077880    0.681643    0.659844    0.338582    0.286309    0.601335    0.588459    0.491188    0.500029    0.700791    0.704848    0.466665    0.464159    12000       5.298151    1.963931    0.269175    2254.10070 
[37m[36mINFO[0m[0m 05/11 11:50:17 | 0.467389    0.463002    0.571004    0.551471    2.045935    0.687175    0.655688    0.349385    0.289507    0.608739    0.590812    0.501746    0.508377    0.707975    0.712972    0.467389    0.463002    13000       5.739663    1.938621    0.273865    2274.13833 
[37m[36mINFO[0m[0m 05/11 12:32:56 | 0.478636    0.471537    0.573417    0.555352    2.042217    0.699408    0.671273    0.349385    0.290960    0.608029    0.588667    0.498442    0.509188    0.711820    0.716673    0.478636    0.471537    14000       6.181176    1.893869    0.258852    2299.62236 
[37m[36mINFO[0m[0m 05/11 13:16:20 | 0.479196    0.475443    0.579214    0.558822    2.016127    0.701434    0.675325    0.356530    0.290863    0.615830    0.592956    0.510500    0.520261    0.711777    0.714707    0.479196    0.475443    15000       6.622689    1.861793    0.279918    2324.62159 
[37m[36mINFO[0m[0m 05/11 13:16:20 | Cumulative gradient change saved at train_output/DomainNet/GENIE/[5]/250511_01-56-37_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 05/11 13:16:22 | ---
[37m[36mINFO[0m[0m 05/11 13:16:22 | test-domain validation(oracle) = 47.920%
[37m[36mINFO[0m[0m 05/11 13:16:22 | training-domain validation(iid) = 47.920%
[37m[36mINFO[0m[0m 05/11 13:16:22 | last = 47.920%
[37m[36mINFO[0m[0m 05/11 13:16:22 | last (inD) = 55.882%
[37m[36mINFO[0m[0m 05/11 13:16:22 | training-domain validation (iid, inD) = 55.882%
[37m[36mINFO[0m[0m 05/11 13:16:22 | === Summary ===
[37m[36mINFO[0m[0m 05/11 13:16:22 | Command: /jsm0707/GENIE/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 5 --dataset DomainNet --trial_seed 2 --hparams_seed 3
[37m[36mINFO[0m[0m 05/11 13:16:22 | Unique name: 250511_01-56-37_resnet50_sgd
[37m[36mINFO[0m[0m 05/11 13:16:22 | Out path: train_output/DomainNet/GENIE/[5]/250511_01-56-37_resnet50_sgd
[37m[36mINFO[0m[0m 05/11 13:16:22 | Algorithm: GENIE
[37m[36mINFO[0m[0m 05/11 13:16:22 | Dataset: DomainNet

[37m[36mINFO[0m[0m 01/26 15:04:40 | Command :: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm SAM --test_envs 1 2 3 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: SAM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/TerraIncognita/SAM/[1, 2, 3]/250126_15-04-40_resnet50_sgd
	out_root: train_output/TerraIncognita/SAM/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 0
	unique_name: 250126_15-04-40_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	rho: 0.05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/26 15:04:40 | n_steps = 5001
[37m[36mINFO[0m[0m 01/26 15:04:40 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/26 15:04:40 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/26 15:04:40 | 
[37m[36mINFO[0m[0m 01/26 15:04:40 | Testenv name escaping te_L38_L43_L46 -> te_L38_L43_L46
[37m[36mINFO[0m[0m 01/26 15:04:40 | Test envs = [1, 2, 3], name = te_L38_L43_L46
[37m[36mINFO[0m[0m 01/26 15:04:40 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 01/26 15:04:40 | Batch sizes for each domain: [32, 0, 0, 0] (total=32)
[37m[36mINFO[0m[0m 01/26 15:04:40 | steps-per-epoch for each domain: 118.53 -> min = 118.53
[37m[36mINFO[0m[0m 01/26 15:04:41 | # of params = 23528522
[37m[36mINFO[0m[0m 01/26 15:07:21 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/26 15:07:21 | 0.031158    0.030439    0.066438    0.059072    2.819712    0.066438    0.059072    0.045962    0.051361    0.041562    0.034005    0.005949    0.005952    0           0.000000    4.527713    1.512460    158.491767 
[37m[36mINFO[0m[0m 01/26 15:11:01 | 0.125602    0.131735    0.579752    0.573840    1.205800    0.579752    0.573840    0.039286    0.039034    0.101700    0.109572    0.235819    0.246599    200         1.687319    1.758721    0.260957    167.691225 
[37m[36mINFO[0m[0m 01/26 15:14:29 | 0.142122    0.143559    0.600580    0.590717    1.116722    0.600580    0.590717    0.041982    0.040062    0.143892    0.142317    0.240493    0.248299    400         3.374637    1.344948    0.231530    161.873594 
[37m[36mINFO[0m[0m 01/26 15:18:31 | 0.145574    0.148011    0.639336    0.639241    1.078607    0.639336    0.639241    0.052125    0.053416    0.143892    0.142317    0.240705    0.248299    600         5.061956    1.250317    0.280985    185.568407 
[37m[36mINFO[0m[0m 01/26 15:22:07 | 0.151071    0.156913    0.651727    0.645570    1.049336    0.651727    0.645570    0.068301    0.080123    0.144207    0.142317    0.240705    0.248299    800         6.749275    1.226636    0.251144    165.404706 
[37m[36mINFO[0m[0m 01/26 15:25:59 | 0.155697    0.160093    0.653836    0.646624    1.022327    0.653836    0.646624    0.096033    0.104777    0.130353    0.127204    0.240705    0.248299    1000        8.436594    1.182657    0.236109    184.299760 
[37m[36mINFO[0m[0m 01/26 15:29:38 | 0.158273    0.162584    0.659900    0.646624    0.991402    0.659900    0.646624    0.105020    0.113508    0.129093    0.125945    0.240705    0.248299    1200        10.123912   1.153969    0.252573    167.931076 
[37m[36mINFO[0m[0m 01/26 15:33:18 | 0.158226    0.162867    0.658582    0.644515    0.973465    0.658582    0.644515    0.105919    0.113508    0.127204    0.125945    0.241555    0.249150    1400        11.811231   1.111987    0.267701    166.499313 
[37m[36mINFO[0m[0m 01/26 15:36:55 | 0.157926    0.162448    0.660427    0.644515    0.952931    0.660427    0.644515    0.105020    0.113508    0.127204    0.124685    0.241555    0.249150    1600        13.498550   1.089450    0.236568    170.498156 
[37m[36mINFO[0m[0m 01/26 15:40:24 | 0.157782    0.163151    0.661482    0.644515    0.925662    0.661482    0.644515    0.103736    0.113508    0.127204    0.125945    0.242405    0.250000    1800        15.185869   1.064209    0.234370    161.502606 
[37m[36mINFO[0m[0m 01/26 15:43:47 | 0.157691    0.162808    0.660691    0.644515    0.896352    0.660691    0.644515    0.103993    0.112481    0.126889    0.125945    0.242192    0.250000    2000        16.873187   1.024681    0.244370    154.512874 
[37m[36mINFO[0m[0m 01/26 15:47:21 | 0.158523    0.163157    0.709728    0.680380    0.863165    0.709728    0.680380    0.106817    0.116076    0.127834    0.125945    0.240918    0.247449    2200        18.560506   1.006038    0.236389    166.228220 
[37m[36mINFO[0m[0m 01/26 15:50:52 | 0.158455    0.163269    0.710519    0.685654    0.845228    0.710519    0.685654    0.106817    0.115562    0.127204    0.125945    0.241343    0.248299    2400        20.247825   1.006893    0.243069    161.915686 
[37m[36mINFO[0m[0m 01/26 15:54:10 | 0.165516    0.169213    0.741893    0.724684    0.823714    0.741893    0.724684    0.129285    0.137648    0.127834    0.125945    0.239431    0.244048    2600        21.935144   0.976033    0.226052    152.693843 
[37m[36mINFO[0m[0m 01/26 15:57:41 | 0.176709    0.182142    0.751384    0.732068    0.814272    0.751384    0.732068    0.166774    0.180277    0.126259    0.127204    0.237094    0.238946    2800        23.622462   0.957271    0.245477    161.717887 
[37m[36mINFO[0m[0m 01/26 16:01:11 | 0.170789    0.177455    0.753757    0.736287    0.786038    0.753757    0.736287    0.147644    0.162815    0.127204    0.127204    0.237519    0.242347    3000        25.309781   0.951364    0.237029    162.729517 
[37m[36mINFO[0m[0m 01/26 16:04:40 | 0.172215    0.179574    0.755339    0.748945    0.767228    0.755339    0.748945    0.155732    0.172573    0.125945    0.127204    0.234969    0.238946    3200        26.997100   0.957107    0.233298    161.594113 
[37m[36mINFO[0m[0m 01/26 16:08:04 | 0.170518    0.178659    0.756921    0.745781    0.754854    0.756921    0.745781    0.149570    0.168978    0.125315    0.127204    0.236669    0.239796    3400        28.684419   0.956838    0.231675    157.599322 
[37m[36mINFO[0m[0m 01/26 16:11:33 | 0.165276    0.171463    0.756921    0.748945    0.733562    0.756921    0.748945    0.132366    0.144838    0.125945    0.127204    0.237519    0.242347    3600        30.371737   0.889977    0.229241    162.752543 
[37m[36mINFO[0m[0m 01/26 16:14:53 | 0.174628    0.183052    0.760612    0.756329    0.718633    0.760612    0.756329    0.160098    0.181305    0.125630    0.127204    0.238156    0.240646    3800        32.059056   0.860729    0.225758    154.339890 
[37m[36mINFO[0m[0m 01/26 16:18:05 | 0.191961    0.202470    0.763248    0.753165    0.701719    0.763248    0.753165    0.172936    0.197740    0.146096    0.148615    0.256851    0.261054    4000        33.746375   0.835267    0.226682    147.162503 
[37m[36mINFO[0m[0m 01/26 16:21:24 | 0.180516    0.188251    0.769312    0.759494    0.687163    0.769312    0.759494    0.166902    0.188495    0.132242    0.134761    0.242405    0.241497    4200        35.433694   0.862517    0.226028    153.717932 
[37m[36mINFO[0m[0m 01/26 16:24:49 | 0.208013    0.227919    0.782758    0.767932    0.674875    0.782758    0.767932    0.185261    0.203903    0.178526    0.212846    0.260251    0.267007    4400        37.121012   0.853923    0.226160    159.042337 
[37m[36mINFO[0m[0m 01/26 16:28:24 | 0.178135    0.186557    0.780912    0.775316    0.663520    0.780912    0.775316    0.161253    0.181305    0.132872    0.136020    0.240280    0.242347    4600        38.808331   0.849900    0.244367    166.384660 
[37m[36mINFO[0m[0m 01/26 16:31:54 | 0.193872    0.208232    0.792249    0.777426    0.654063    0.792249    0.777426    0.178842    0.197740    0.142947    0.159950    0.259826    0.267007    4800        40.495650   0.811214    0.233267    163.245070 
[37m[36mINFO[0m[0m 01/26 16:35:19 | 0.210603    0.228168    0.795413    0.781646    0.643836    0.795413    0.781646    0.188343    0.210067    0.177267    0.204030    0.266199    0.270408    5000        42.182969   0.810068    0.227955    158.911948 
[37m[36mINFO[0m[0m 01/26 16:35:19 | Cumulative gradient change saved at train_output/TerraIncognita/SAM/[1, 2, 3]/250126_15-04-40_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/26 16:35:21 | ---
[37m[36mINFO[0m[0m 01/26 16:35:21 | test-domain validation(oracle) = 21.060%
[37m[36mINFO[0m[0m 01/26 16:35:21 | training-domain validation(iid) = 21.060%
[37m[36mINFO[0m[0m 01/26 16:35:21 | last = 21.060%
[37m[36mINFO[0m[0m 01/26 16:35:21 | last (inD) = 78.165%
[37m[36mINFO[0m[0m 01/26 16:35:21 | training-domain validation (iid, inD) = 78.165%
[37m[36mINFO[0m[0m 01/26 16:35:21 | === Summary ===
[37m[36mINFO[0m[0m 01/26 16:35:21 | Command: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm SAM --test_envs 1 2 3 --dataset TerraIncognita
[37m[36mINFO[0m[0m 01/26 16:35:21 | Unique name: 250126_15-04-40_resnet50_sgd
[37m[36mINFO[0m[0m 01/26 16:35:21 | Out path: train_output/TerraIncognita/SAM/[1, 2, 3]/250126_15-04-40_resnet50_sgd
[37m[36mINFO[0m[0m 01/26 16:35:21 | Algorithm: SAM
[37m[36mINFO[0m[0m 01/26 16:35:21 | Dataset: TerraIncognita

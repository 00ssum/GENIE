[37m[36mINFO[0m[0m 01/26 19:33:11 | Command :: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm SAM --test_envs 0 1 2 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: SAM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/TerraIncognita/SAM/[0, 1, 2]/250126_19-33-11_resnet50_sgd
	out_root: train_output/TerraIncognita/SAM/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 0
	unique_name: 250126_19-33-11_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	rho: 0.05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/26 19:33:11 | n_steps = 5001
[37m[36mINFO[0m[0m 01/26 19:33:11 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/26 19:33:11 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/26 19:33:11 | 
[37m[36mINFO[0m[0m 01/26 19:33:11 | Testenv name escaping te_L100_L38_L43 -> te_L100_L38_L43
[37m[36mINFO[0m[0m 01/26 19:33:11 | Test envs = [0, 1, 2], name = te_L100_L38_L43
[37m[36mINFO[0m[0m 01/26 19:33:11 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 01/26 19:33:11 | Batch sizes for each domain: [0, 0, 0, 32] (total=32)
[37m[36mINFO[0m[0m 01/26 19:33:11 | steps-per-epoch for each domain: 147.09 -> min = 147.09
[37m[36mINFO[0m[0m 01/26 19:33:13 | # of params = 23528522
[37m[36mINFO[0m[0m 01/26 19:35:53 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/26 19:35:53 | 0.052827    0.048643    0.030593    0.005952    2.524355    0.069338    0.059072    0.045064    0.050334    0.044081    0.036524    0.030593    0.005952    0           0.000000    3.281239    1.160584    158.992175 
[37m[36mINFO[0m[0m 01/26 19:39:19 | 0.247956    0.264815    0.419375    0.427721    1.629719    0.375692    0.391350    0.108101    0.122239    0.260076    0.280856    0.419375    0.427721    200         1.359677    2.157216    0.231811    159.677189 
[37m[36mINFO[0m[0m 01/26 19:42:44 | 0.278599    0.299178    0.437434    0.430272    1.483533    0.199578    0.205696    0.341507    0.363123    0.294710    0.328715    0.437434    0.430272    400         2.719354    1.800759    0.228051    159.081988 
[37m[36mINFO[0m[0m 01/26 19:46:09 | 0.228331    0.247369    0.439346    0.432823    1.444061    0.199315    0.205696    0.190653    0.217771    0.295025    0.318640    0.439346    0.432823    600         4.079031    1.696225    0.227761    158.867030 
[37m[36mINFO[0m[0m 01/26 19:49:33 | 0.281800    0.304031    0.442107    0.433673    1.429594    0.199051    0.204641    0.324560    0.349769    0.321788    0.357683    0.442107    0.433673    800         5.438708    1.680377    0.228759    158.522280 
[37m[36mINFO[0m[0m 01/26 19:53:04 | 0.295873    0.322052    0.445507    0.434524    1.416429    0.199051    0.204641    0.372448    0.397535    0.316121    0.363980    0.445507    0.434524    1000        6.798385    1.662034    0.236182    163.463659 
[37m[36mINFO[0m[0m 01/26 19:56:30 | 0.286652    0.311535    0.447419    0.437925    1.401615    0.204060    0.208861    0.333162    0.357987    0.322733    0.367758    0.447419    0.437925    1200        8.158062    1.639104    0.238874    157.905555 
[37m[36mINFO[0m[0m 01/26 19:59:55 | 0.301074    0.326892    0.450393    0.441327    1.388564    0.204324    0.209916    0.382462    0.406780    0.316436    0.363980    0.450393    0.441327    1400        9.517740    1.611151    0.224477    159.965772 
[37m[36mINFO[0m[0m 01/26 20:03:19 | 0.309610    0.338576    0.467177    0.467687    1.375899    0.216715    0.224684    0.372063    0.400616    0.340050    0.390428    0.467177    0.467687    1600        10.877417   1.585248    0.224296    158.434863 
[37m[36mINFO[0m[0m 01/26 20:06:41 | 0.331294    0.360968    0.474400    0.477891    1.365612    0.218824    0.226793    0.420208    0.444273    0.354849    0.411839    0.474400    0.477891    1800        12.237094   1.583689    0.233606    154.919890 
[37m[36mINFO[0m[0m 01/26 20:10:06 | 0.326022    0.354047    0.473338    0.476190    1.358312    0.218561    0.226793    0.413789    0.438624    0.345718    0.396725    0.473338    0.476190    2000        13.596771   1.570094    0.245313    155.915202 
[37m[36mINFO[0m[0m 01/26 20:13:22 | 0.335839    0.364615    0.482685    0.490646    1.348285    0.221988    0.229958    0.408011    0.429379    0.377519    0.434509    0.482685    0.490646    2200        14.956448   1.552593    0.219520    152.693410 
[37m[36mINFO[0m[0m 01/26 20:16:49 | 0.328917    0.357267    0.475675    0.474490    1.338474    0.216451    0.226793    0.421749    0.443246    0.348552    0.401763    0.475675    0.474490    2400        16.316125   1.540137    0.226054    160.851935 
[37m[36mINFO[0m[0m 01/26 20:20:16 | 0.345893    0.376915    0.488209    0.494048    1.332984    0.219615    0.232068    0.446527    0.470467    0.371537    0.428212    0.488209    0.494048    2600        17.675802   1.522836    0.234925    160.236795 
[37m[36mINFO[0m[0m 01/26 20:23:38 | 0.337148    0.367044    0.487147    0.489796    1.325414    0.224624    0.233122    0.429452    0.447355    0.357368    0.420655    0.487147    0.489796    2800        19.035479   1.518528    0.224298    156.378389 
[37m[36mINFO[0m[0m 01/26 20:26:58 | 0.335981    0.364628    0.485447    0.485544    1.320564    0.225415    0.234177    0.428938    0.447869    0.353589    0.411839    0.485447    0.485544    3000        20.395156   1.526917    0.223412    155.497190 
[37m[36mINFO[0m[0m 01/26 20:30:16 | 0.339148    0.370043    0.497344    0.494898    1.311974    0.227524    0.236287    0.426884    0.449409    0.363035    0.424433    0.497344    0.494898    3200        21.754833   1.533170    0.226668    152.666563 
[37m[36mINFO[0m[0m 01/26 20:33:35 | 0.343366    0.371692    0.498619    0.494898    1.302094    0.225679    0.234177    0.444216    0.462763    0.360202    0.418136    0.498619    0.494898    3400        23.114510   1.518541    0.222137    154.922767 
[37m[36mINFO[0m[0m 01/26 20:36:58 | 0.336119    0.368605    0.499256    0.495748    1.291739    0.227524    0.237342    0.422519    0.445300    0.358312    0.423174    0.499256    0.495748    3600        24.474187   1.509216    0.227194    156.925975 
[37m[36mINFO[0m[0m 01/26 20:40:19 | 0.352644    0.378563    0.512428    0.511905    1.288500    0.228052    0.237342    0.452048    0.466359    0.377834    0.431990    0.512428    0.511905    3800        25.833864   1.502834    0.224997    156.216724 
[37m[36mINFO[0m[0m 01/26 20:43:37 | 0.344945    0.371957    0.502443    0.494048    1.281547    0.225679    0.234177    0.448325    0.464818    0.360831    0.416877    0.502443    0.494048    4000        27.193542   1.478390    0.224715    153.195675 
[37m[36mINFO[0m[0m 01/26 20:46:50 | 0.358841    0.387134    0.523476    0.528061    1.268951    0.227261    0.236287    0.438054    0.456600    0.411209    0.468514    0.523476    0.528061    4200        28.553219   1.477622    0.229037    146.906434 
[37m[36mINFO[0m[0m 01/26 20:50:12 | 0.344481    0.373169    0.514765    0.513605    1.258538    0.229897    0.236287    0.434844    0.452491    0.368703    0.430730    0.514765    0.513605    4400        29.912896   1.471861    0.222547    157.460194 
[37m[36mINFO[0m[0m 01/26 20:53:35 | 0.344576    0.371795    0.524750    0.528912    1.251424    0.229634    0.235232    0.447041    0.463277    0.357053    0.416877    0.524750    0.528912    4600        31.272573   1.470544    0.224094    157.428898 
[37m[36mINFO[0m[0m 01/26 20:56:57 | 0.335121    0.358986    0.526025    0.531463    1.241560    0.232797    0.241561    0.424958    0.441192    0.347607    0.394207    0.526025    0.531463    4800        32.632250   1.474001    0.224443    157.523172 
[37m[36mINFO[0m[0m 01/26 21:00:21 | 0.341998    0.363612    0.529637    0.534014    1.232073    0.233325    0.236287    0.452305    0.467899    0.340365    0.386650    0.529637    0.534014    5000        33.991927   1.433887    0.223063    159.170714 
[37m[36mINFO[0m[0m 01/26 21:00:21 | Cumulative gradient change saved at train_output/TerraIncognita/SAM/[0, 1, 2]/250126_19-33-11_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/26 21:00:22 | ---
[37m[36mINFO[0m[0m 01/26 21:00:22 | test-domain validation(oracle) = 35.884%
[37m[36mINFO[0m[0m 01/26 21:00:22 | training-domain validation(iid) = 34.200%
[37m[36mINFO[0m[0m 01/26 21:00:22 | last = 34.200%
[37m[36mINFO[0m[0m 01/26 21:00:22 | last (inD) = 53.401%
[37m[36mINFO[0m[0m 01/26 21:00:22 | training-domain validation (iid, inD) = 53.401%
[37m[36mINFO[0m[0m 01/26 21:00:22 | === Summary ===
[37m[36mINFO[0m[0m 01/26 21:00:22 | Command: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm SAM --test_envs 0 1 2 --dataset TerraIncognita
[37m[36mINFO[0m[0m 01/26 21:00:22 | Unique name: 250126_19-33-11_resnet50_sgd
[37m[36mINFO[0m[0m 01/26 21:00:22 | Out path: train_output/TerraIncognita/SAM/[0, 1, 2]/250126_19-33-11_resnet50_sgd
[37m[36mINFO[0m[0m 01/26 21:00:22 | Algorithm: SAM
[37m[36mINFO[0m[0m 01/26 21:00:22 | Dataset: TerraIncognita

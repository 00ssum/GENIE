[37m[36mINFO[0m[0m 01/30 20:01:35 | Command :: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 0 2 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 0
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/TerraIncognita/CORAL/[0, 2, 3]/250130_20-01-35_resnet50_EVE
	out_root: train_output/TerraIncognita/CORAL/[0, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 2, 3]
	trial_seed: 2
	unique_name: 250130_20-01-35_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: GENIE
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	mmd_gamma: 1.0
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/30 20:01:35 | n_steps = 5001
[37m[36mINFO[0m[0m 01/30 20:01:35 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/30 20:01:35 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/30 20:01:35 | 
[37m[36mINFO[0m[0m 01/30 20:01:35 | Testenv name escaping te_L100_L43_L46 -> te_L100_L43_L46
[37m[36mINFO[0m[0m 01/30 20:01:35 | Test envs = [0, 2, 3], name = te_L100_L43_L46
[37m[36mINFO[0m[0m 01/30 20:01:35 | Train environments: [1], Test environments: [0, 2, 3]
[37m[36mINFO[0m[0m 01/30 20:01:35 | Batch sizes for each domain: [0, 32, 0, 0] (total=32)
[37m[36mINFO[0m[0m 01/30 20:01:35 | steps-per-epoch for each domain: 243.41 -> min = 243.41
[37m[36mINFO[0m[0m 01/30 20:01:37 | # of params = 23528522
[37m[36mINFO[0m[0m 01/30 20:05:01 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 01/30 20:05:01 | 0.207727    0.194947    0.464886    0.443760    1.946763    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.222860    0.207483    0           0.000000    2.214193    0.000000    1.820431    202.058031 
[37m[36mINFO[0m[0m 01/30 20:09:19 | 0.205808    0.191976    0.595584    0.564972    1.135730    0.205906    0.199367    0.595584    0.564972    0.192695    0.177582    0.218823    0.198980    200         0.821672    1.126377    0.000000    0.325691    192.919751 
[37m[36mINFO[0m[0m 01/30 20:13:44 | 0.208450    0.195944    0.632302    0.619414    1.102355    0.205642    0.199367    0.632302    0.619414    0.191751    0.177582    0.227958    0.210884    400         1.643343    1.111221    0.000000    0.295223    205.528860 
[37m[36mINFO[0m[0m 01/30 20:18:14 | 0.208391    0.193609    0.665426    0.650231    0.987889    0.206433    0.198312    0.665426    0.650231    0.192695    0.177582    0.226046    0.204932    600         2.465015    1.016873    0.000000    0.279112    214.030395 
[37m[36mINFO[0m[0m 01/30 20:22:35 | 0.193161    0.185683    0.730517    0.717514    0.846070    0.187187    0.194093    0.730517    0.717514    0.192380    0.177582    0.199915    0.185374    800         3.286686    0.920565    0.000000    0.265638    206.948157 
[37m[36mINFO[0m[0m 01/30 20:26:54 | 0.163138    0.150251    0.764540    0.754494    0.761641    0.172950    0.159283    0.764540    0.754494    0.164987    0.148615    0.151477    0.142857    1000        4.108358    0.775935    0.000000    0.296393    199.379867 
[37m[36mINFO[0m[0m 01/30 20:31:04 | 0.197185    0.189163    0.790474    0.789420    0.622474    0.229897    0.226793    0.790474    0.789420    0.160894    0.156171    0.200765    0.184524    1200        4.930030    0.710242    0.000000    0.325252    185.255627 
[37m[36mINFO[0m[0m 01/30 20:35:38 | 0.218445    0.221437    0.787007    0.796097    0.569850    0.321118    0.325949    0.787007    0.796097    0.172544    0.172544    0.161674    0.165816    1400        5.751701    0.642694    0.000000    0.269614    219.427656 
[37m[36mINFO[0m[0m 01/30 20:40:05 | 0.209517    0.206525    0.824239    0.830508    0.494049    0.305299    0.301688    0.824239    0.830508    0.174748    0.177582    0.148502    0.140306    1600        6.573373    0.588175    0.000000    0.279930    210.686762 
[37m[36mINFO[0m[0m 01/30 20:45:03 | 0.201611    0.188668    0.814996    0.807910    0.586160    0.239388    0.222574    0.814996    0.807910    0.181675    0.175063    0.183769    0.168367    1800        7.395044    0.545501    0.000000    0.307355    236.033867 
[37m[36mINFO[0m[0m 01/30 20:50:06 | 0.228135    0.223026    0.839517    0.835645    0.478286    0.354337    0.352321    0.839517    0.835645    0.164358    0.166247    0.165711    0.150510    2000        8.216716    0.474894    0.000000    0.368160    228.327441 
[37m[36mINFO[0m[0m 01/30 20:54:52 | 0.202966    0.199310    0.846964    0.854648    0.463601    0.273135    0.268987    0.846964    0.854648    0.176637    0.177582    0.159125    0.151361    2200        9.038387    0.481673    0.000000    0.342251    217.273717 
[37m[36mINFO[0m[0m 01/30 20:59:58 | 0.191683    0.185069    0.848376    0.859784    0.423747    0.275771    0.263713    0.848376    0.859784    0.180730    0.180101    0.118547    0.111395    2400        9.860059    0.469288    0.000000    0.336242    238.347885 
[37m[36mINFO[0m[0m 01/30 21:04:55 | 0.233076    0.242225    0.852741    0.840781    0.440287    0.375956    0.388186    0.852741    0.840781    0.146725    0.162469    0.176546    0.176020    2600        10.681731   0.450793    0.000000    0.320665    232.806948 
[37m[36mINFO[0m[0m 01/30 21:09:49 | 0.295236    0.287908    0.859160    0.851053    0.430993    0.488532    0.479958    0.859160    0.851053    0.219144    0.212846    0.178033    0.170918    2800        11.503402   0.418723    0.000000    0.335201    227.020822 
[37m[36mINFO[0m[0m 01/30 21:14:33 | 0.185394    0.177976    0.863525    0.845917    0.446959    0.233061    0.223629    0.863525    0.845917    0.185453    0.172544    0.137667    0.137755    3000        12.325074   0.414431    0.000000    0.330718    217.260579 
[37m[36mINFO[0m[0m 01/30 21:19:59 | 0.189253    0.183820    0.874823    0.872625    0.379749    0.313472    0.301688    0.874823    0.872625    0.141688    0.151134    0.112598    0.098639    3200        13.146745   0.387586    0.000000    0.422443    241.267336 
[37m[36mINFO[0m[0m 01/30 21:24:19 | 0.259668    0.257431    0.875722    0.874679    0.358704    0.405220    0.407173    0.875722    0.874679    0.203401    0.207809    0.170385    0.157313    3400        13.968417   0.384703    0.000000    0.317324    196.922473 
[37m[36mINFO[0m[0m 01/30 21:28:31 | 0.240445    0.235786    0.883040    0.875193    0.391550    0.385183    0.377637    0.883040    0.875193    0.205919    0.216625    0.130232    0.113095    3600        14.790089   0.374649    0.000000    0.293092    192.623234 
[37m[36mINFO[0m[0m 01/30 21:32:40 | 0.136255    0.133517    0.884838    0.887519    0.354744    0.168205    0.163502    0.884838    0.887519    0.134761    0.148615    0.105800    0.088435    3800        15.611760   0.333560    0.000000    0.328978    183.056802 
[37m[36mINFO[0m[0m 01/30 21:36:58 | 0.262116    0.259197    0.893953    0.877761    0.368493    0.394674    0.390295    0.893953    0.877761    0.208753    0.202771    0.182919    0.184524    4000        16.433432   0.347615    0.000000    0.318917    194.198222 
[37m[36mINFO[0m[0m 01/30 21:41:14 | 0.170947    0.166004    0.868789    0.854135    0.417520    0.177959    0.174051    0.868789    0.854135    0.196788    0.201511    0.138092    0.122449    4200        17.255103   0.316568    0.000000    0.358269    183.977100 
[37m[36mINFO[0m[0m 01/30 21:45:16 | 0.279095    0.273136    0.883939    0.862866    0.382838    0.441076    0.421941    0.883939    0.862866    0.202456    0.205290    0.193754    0.192177    4400        18.076775   0.319999    0.000000    0.285476    185.355781 
[37m[36mINFO[0m[0m 01/30 21:49:11 | 0.256048    0.248698    0.904737    0.893683    0.333445    0.398893    0.388186    0.904737    0.893683    0.200567    0.206549    0.168685    0.151361    4600        18.898447   0.314642    0.000000    0.234250    188.187027 
[37m[36mINFO[0m[0m 01/30 21:53:03 | 0.209873    0.205986    0.904609    0.897791    0.341907    0.332191    0.323840    0.904609    0.897791    0.140428    0.141058    0.157000    0.153061    4800        19.720118   0.301209    0.000000    0.235526    184.428264 
[37m[36mINFO[0m[0m 01/30 21:56:59 | 0.316296    0.299245    0.912055    0.913200    0.280964    0.492750    0.479958    0.912055    0.913200    0.227330    0.212846    0.228808    0.204932    5000        20.541790   0.286161    0.000000    0.262457    184.071364 
[37m[36mINFO[0m[0m 01/30 21:57:00 | Cumulative gradient change saved at train_output/TerraIncognita/CORAL/[0, 2, 3]/250130_20-01-35_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/30 21:57:01 | ---
[37m[36mINFO[0m[0m 01/30 21:57:01 | test-domain validation(oracle) = 31.630%
[37m[36mINFO[0m[0m 01/30 21:57:01 | training-domain validation(iid) = 31.630%
[37m[36mINFO[0m[0m 01/30 21:57:01 | last = 31.630%
[37m[36mINFO[0m[0m 01/30 21:57:01 | last (inD) = 91.320%
[37m[36mINFO[0m[0m 01/30 21:57:01 | training-domain validation (iid, inD) = 91.320%
[37m[36mINFO[0m[0m 01/30 21:57:01 | === Summary ===
[37m[36mINFO[0m[0m 01/30 21:57:01 | Command: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 0 2 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 0
[37m[36mINFO[0m[0m 01/30 21:57:01 | Unique name: 250130_20-01-35_resnet50_EVE
[37m[36mINFO[0m[0m 01/30 21:57:01 | Out path: train_output/TerraIncognita/CORAL/[0, 2, 3]/250130_20-01-35_resnet50_EVE
[37m[36mINFO[0m[0m 01/30 21:57:01 | Algorithm: CORAL
[37m[36mINFO[0m[0m 01/30 21:57:01 | Dataset: TerraIncognita

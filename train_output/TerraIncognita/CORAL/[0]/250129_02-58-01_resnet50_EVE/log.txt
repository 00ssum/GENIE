[37m[36mINFO[0m[0m 01/29 02:58:01 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 0 --dataset TerraIncognita --trial_seed 2 --hparams_seed 19
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 19
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/TerraIncognita/CORAL/[0]/250129_02-58-01_resnet50_EVE
	out_root: train_output/TerraIncognita/CORAL/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 2
	unique_name: 250129_02-58-01_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: GENIE
	freeze_bn: False
	pretrained: True
	lr: 7.509081014584126e-05
	batch_size: 8
	weight_decay: 2.862344444160157e-05
	mmd_gamma: 0.2739283225580369
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/29 02:58:01 | n_steps = 5001
[37m[36mINFO[0m[0m 01/29 02:58:01 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/29 02:58:01 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/29 02:58:01 | Target test envs = [[0]]
[37m[36mINFO[0m[0m 01/29 02:58:01 | 
[37m[36mINFO[0m[0m 01/29 02:58:01 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 01/29 02:58:01 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 01/29 02:58:01 | Batch sizes for each domain: [0, 8, 8, 8] (total=24)
[37m[36mINFO[0m[0m 01/29 02:58:01 | steps-per-epoch for each domain: 973.62, 397.00, 588.38 -> min = 397.00
[37m[36mINFO[0m[0m 01/29 02:58:04 | # of params = 23528522
[37m[36mINFO[0m[0m 01/29 03:01:09 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 01/29 03:01:09 | 0.515687    0.532700    0.165981    0.187333    2.181214    0.515687    0.532700    0.034022    0.039034    0.207494    0.232997    0.256427    0.289966    0           0.000000    2.424696    0.061637    2.056816    183.391536 
[37m[36mINFO[0m[0m 01/29 03:04:51 | 0.210124    0.204641    0.490184    0.482923    1.446410    0.210124    0.204641    0.618950    0.595788    0.412469    0.392947    0.439133    0.460034    200         0.503778    1.578646    0.063374    0.174174    187.216282 
[37m[36mINFO[0m[0m 01/29 03:08:31 | 0.199051    0.202532    0.559118    0.542590    1.163133    0.199051    0.202532    0.687251    0.674371    0.475126    0.453401    0.514978    0.500000    400         1.007557    1.329972    0.084870    0.175068    184.326810 
[37m[36mINFO[0m[0m 01/29 03:12:16 | 0.456894    0.459916    0.666891    0.678092    0.903925    0.456894    0.459916    0.735396    0.732922    0.646411    0.673804    0.618866    0.627551    600         1.511335    1.096770    0.088758    0.187422    187.478362 
[37m[36mINFO[0m[0m 01/29 03:16:10 | 0.493541    0.502110    0.651928    0.649886    0.937887    0.493541    0.502110    0.741173    0.723677    0.584698    0.583123    0.629913    0.642857    800         2.015113    0.967046    0.090405    0.206603    191.760314 
[37m[36mINFO[0m[0m 01/29 03:19:55 | 0.412339    0.431435    0.671552    0.674183    0.891238    0.412339    0.431435    0.737193    0.733436    0.622481    0.633501    0.654982    0.655612    1000        2.518892    0.907336    0.075315    0.203240    185.043725 
[37m[36mINFO[0m[0m 01/29 03:23:44 | 0.253361    0.247890    0.695346    0.700139    0.813147    0.253361    0.247890    0.753370    0.751412    0.660264    0.671285    0.672403    0.677721    1200        3.022670    0.840102    0.070168    0.210410    186.235695 
[37m[36mINFO[0m[0m 01/29 03:27:34 | 0.533087    0.537975    0.735227    0.740599    0.715579    0.533087    0.537975    0.775067    0.783770    0.721033    0.725441    0.709581    0.712585    1400        3.526448    0.824056    0.065215    0.180098    193.896981 
[37m[36mINFO[0m[0m 01/29 03:31:20 | 0.456367    0.444093    0.725092    0.734839    0.742888    0.456367    0.444093    0.746181    0.742681    0.723552    0.725441    0.705545    0.736395    1600        4.030227    0.755026    0.067460    0.181834    189.991587 
[37m[36mINFO[0m[0m 01/29 03:35:07 | 0.445294    0.448312    0.743734    0.751968    0.700823    0.445294    0.448312    0.789575    0.798665    0.732683    0.719144    0.708944    0.738095    1800        4.534005    0.775780    0.060548    0.193776    187.529166 
[37m[36mINFO[0m[0m 01/29 03:38:54 | 0.449249    0.438819    0.747389    0.743281    0.709490    0.449249    0.438819    0.767493    0.743195    0.749370    0.746851    0.725303    0.739796    2000        5.037783    0.712676    0.060698    0.207664    185.781695 
[37m[36mINFO[0m[0m 01/29 03:42:40 | 0.450040    0.459916    0.765053    0.768957    0.653095    0.450040    0.459916    0.790089    0.791474    0.756612    0.759446    0.748460    0.755952    2200        5.541562    0.707124    0.055509    0.221022    182.005386 
[37m[36mINFO[0m[0m 01/29 03:46:30 | 0.408911    0.402954    0.766957    0.765647    0.638126    0.408911    0.402954    0.787007    0.792501    0.767317    0.751889    0.746548    0.752551    2400        6.045340    0.673608    0.053870    0.180325    193.056743 
[37m[36mINFO[0m[0m 01/29 03:50:13 | 0.447139    0.452532    0.773074    0.781978    0.632412    0.447139    0.452532    0.814354    0.820236    0.755982    0.751889    0.748885    0.773810    2600        6.549118    0.679176    0.054908    0.198353    183.774154 
[37m[36mINFO[0m[0m 01/29 03:53:54 | 0.445558    0.448312    0.786904    0.787874    0.582796    0.445558    0.448312    0.805880    0.813046    0.778967    0.768262    0.775866    0.782313    2800        7.052897    0.695247    0.050699    0.230174    174.375998 
[37m[36mINFO[0m[0m 01/29 03:57:44 | 0.401529    0.379747    0.786964    0.785785    0.604456    0.401529    0.379747    0.819746    0.811505    0.768892    0.772040    0.772254    0.773810    3000        7.556675    0.620633    0.051679    0.206759    188.050999 
[37m[36mINFO[0m[0m 01/29 04:01:22 | 0.399420    0.389241    0.786642    0.782776    0.595148    0.399420    0.389241    0.823084    0.826913    0.773300    0.754408    0.763544    0.767007    3200        8.060453    0.632018    0.050196    0.214171    175.246981 
[37m[36mINFO[0m[0m 01/29 04:05:09 | 0.354073    0.348101    0.783104    0.784277    0.608437    0.354073    0.348101    0.812043    0.795583    0.773300    0.778338    0.763969    0.778912    3400        8.564232    0.616631    0.050865    0.180666    191.248921 
[37m[36mINFO[0m[0m 01/29 04:08:48 | 0.614817    0.604430    0.782476    0.775802    0.617623    0.614817    0.604430    0.815509    0.822804    0.776448    0.739295    0.755471    0.765306    3600        9.068010    0.584165    0.048612    0.173731    183.752938 
[37m[36mINFO[0m[0m 01/29 04:12:39 | 0.486159    0.456751    0.801096    0.784893    0.581325    0.486159    0.456751    0.812299    0.781715    0.801952    0.779597    0.789038    0.793367    3800        9.571788    0.596512    0.049652    0.176735    196.160555 
[37m[36mINFO[0m[0m 01/29 04:16:20 | 0.581598    0.575949    0.807561    0.812846    0.527287    0.581598    0.575949    0.839902    0.854648    0.795655    0.789673    0.787126    0.794218    4000        10.075567   0.571118    0.049209    0.174222    185.564556 
[37m[36mINFO[0m[0m 01/29 04:20:08 | 0.571316    0.571730    0.813151    0.802850    0.533854    0.571316    0.571730    0.839646    0.829481    0.810768    0.801008    0.789038    0.778061    4200        10.579345   0.581042    0.044622    0.179411    192.138932 
[37m[36mINFO[0m[0m 01/29 04:23:55 | 0.502768    0.488397    0.799022    0.795449    0.582761    0.502768    0.488397    0.818334    0.812532    0.787783    0.779597    0.790950    0.794218    4400        11.083123   0.559827    0.045115    0.173628    192.312362 
[37m[36mINFO[0m[0m 01/29 04:27:41 | 0.389402    0.377637    0.796875    0.784137    0.597250    0.389402    0.377637    0.816665    0.804828    0.795970    0.769521    0.777990    0.778061    4600        11.586902   0.531071    0.045362    0.172778    190.890269 
[37m[36mINFO[0m[0m 01/29 04:31:32 | 0.549697    0.559072    0.804295    0.794899    0.575351    0.549697    0.559072    0.824624    0.798665    0.807935    0.788413    0.780327    0.797619    4800        12.090680   0.522421    0.045020    0.193582    192.794864 
[37m[36mINFO[0m[0m 01/29 04:35:23 | 0.470604    0.449367    0.812286    0.808867    0.543860    0.470604    0.449367    0.845808    0.851053    0.796914    0.777078    0.794136    0.798469    5000        12.594458   0.521146    0.046076    0.185804    194.162399 
[37m[36mINFO[0m[0m 01/29 04:35:24 | Cumulative gradient change saved at train_output/TerraIncognita/CORAL/[0]/250129_02-58-01_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/29 04:35:25 | ---
[37m[36mINFO[0m[0m 01/29 04:35:25 | test-domain validation(oracle) = 61.482%
[37m[36mINFO[0m[0m 01/29 04:35:25 | training-domain validation(iid) = 58.160%
[37m[36mINFO[0m[0m 01/29 04:35:25 | last = 47.060%
[37m[36mINFO[0m[0m 01/29 04:35:25 | last (inD) = 80.887%
[37m[36mINFO[0m[0m 01/29 04:35:25 | training-domain validation (iid, inD) = 81.285%
[37m[36mINFO[0m[0m 01/29 04:35:25 | === Summary ===
[37m[36mINFO[0m[0m 01/29 04:35:25 | Command: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 0 --dataset TerraIncognita --trial_seed 2 --hparams_seed 19
[37m[36mINFO[0m[0m 01/29 04:35:25 | Unique name: 250129_02-58-01_resnet50_EVE
[37m[36mINFO[0m[0m 01/29 04:35:25 | Out path: train_output/TerraIncognita/CORAL/[0]/250129_02-58-01_resnet50_EVE
[37m[36mINFO[0m[0m 01/29 04:35:25 | Algorithm: CORAL
[37m[36mINFO[0m[0m 01/29 04:35:25 | Dataset: TerraIncognita
[37m[36mINFO[0m[0m 01/29 04:35:25 | Max test_in: 0.6148

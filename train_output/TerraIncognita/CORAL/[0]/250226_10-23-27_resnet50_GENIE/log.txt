[37m[36mINFO[0m[0m 02/26 10:23:27 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 20
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 20
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/CORAL/[0]/250226_10-23-27_resnet50_GENIE
	out_root: train_output/TerraIncognita/CORAL/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250226_10-23-27_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.6157673767852512e-05
	batch_size: 32
	weight_decay: 1.110622050999988e-05
	mmd_gamma: 0.11123344099864356
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/26 10:23:27 | n_steps = 5001
[37m[36mINFO[0m[0m 02/26 10:23:27 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/26 10:23:27 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/26 10:23:27 | 
[37m[36mINFO[0m[0m 02/26 10:23:27 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 02/26 10:23:27 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 02/26 10:23:27 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 02/26 10:23:27 | Batch sizes for each domain: [0, 32, 32, 32] (total=96)
[37m[36mINFO[0m[0m 02/26 10:23:27 | steps-per-epoch for each domain: 243.41, 99.25, 147.09 -> min = 99.25
[37m[36mINFO[0m[0m 02/26 10:23:28 | # of params = 23528522
[37m[36mINFO[0m[0m 02/26 10:26:26 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/26 10:26:26 | 0.200633    0.208861    0.288045    0.304317    2.037531    0.200633    0.208861    0.455514    0.481253    0.186398    0.221662    0.222222    0.210034    0           0.000000    2.444953    0.073771    1.408784    176.693847 
[37m[36mINFO[0m[0m 02/26 10:30:35 | 0.205906    0.212025    0.608635    0.625838    1.055967    0.205906    0.212025    0.704198    0.717514    0.563602    0.589421    0.558105    0.570578    200         2.015113    1.441416    0.100780    0.381585    173.121362 
[37m[36mINFO[0m[0m 02/26 10:34:43 | 0.360928    0.369198    0.703093    0.693876    0.819263    0.360928    0.369198    0.738221    0.747304    0.700567    0.688917    0.670491    0.645408    400         4.030227    0.951927    0.144719    0.369598    173.804324 
[37m[36mINFO[0m[0m 02/26 10:38:54 | 0.477722    0.491561    0.740243    0.751272    0.658067    0.477722    0.491561    0.789447    0.811505    0.718514    0.722922    0.712768    0.719388    600         6.045340    0.770888    0.131464    0.361226    178.768128 
[37m[36mINFO[0m[0m 02/26 10:43:02 | 0.537306    0.531646    0.772325    0.782634    0.594346    0.537306    0.531646    0.812685    0.824859    0.768577    0.793451    0.735713    0.729592    800         8.060453    0.679396    0.116321    0.348776    178.521554 
[37m[36mINFO[0m[0m 02/26 10:47:05 | 0.527814    0.533755    0.787730    0.792478    0.589157    0.527814    0.533755    0.815509    0.832563    0.781801    0.782116    0.765881    0.762755    1000        10.075567   0.621405    0.108902    0.366594    168.795474 
[37m[36mINFO[0m[0m 02/26 10:51:16 | 0.489059    0.487342    0.803181    0.804183    0.547800    0.489059    0.487342    0.820131    0.837699    0.809509    0.798489    0.779902    0.776361    1200        12.090680   0.567668    0.107580    0.382024    175.421500 
[37m[36mINFO[0m[0m 02/26 10:55:30 | 0.464804    0.451477    0.814429    0.809476    0.538808    0.464804    0.451477    0.832970    0.846430    0.811083    0.804786    0.799235    0.777211    1400        14.105793   0.563106    0.098343    0.361677    181.572217 
[37m[36mINFO[0m[0m 02/26 10:59:45 | 0.470604    0.459916    0.823880    0.812927    0.511746    0.470604    0.459916    0.842342    0.841294    0.831549    0.823678    0.797748    0.773810    1600        16.120907   0.525198    0.096634    0.352888    184.379582 
[37m[36mINFO[0m[0m 02/26 11:04:01 | 0.428948    0.429325    0.830196    0.826928    0.487338    0.428948    0.429325    0.854667    0.862352    0.828401    0.814861    0.807521    0.803571    1800        18.136020   0.485475    0.093578    0.410066    173.948976 
[37m[36mINFO[0m[0m 02/26 11:08:17 | 0.497495    0.510549    0.839973    0.835018    0.462115    0.497495    0.510549    0.865451    0.884951    0.831864    0.817380    0.822605    0.802721    2000        20.151134   0.469117    0.092662    0.358586    183.612150 
[37m[36mINFO[0m[0m 02/26 11:12:34 | 0.452940    0.466245    0.841550    0.828417    0.480002    0.452940    0.466245    0.868918    0.877247    0.841625    0.832494    0.814107    0.775510    2200        22.166247   0.445371    0.088160    0.361904    184.692835 
[37m[36mINFO[0m[0m 02/26 11:17:05 | 0.440285    0.445148    0.867608    0.852702    0.408183    0.440285    0.445148    0.887534    0.891115    0.870592    0.841310    0.844699    0.825680    2400        24.181360   0.418155    0.091002    0.409030    189.614631 
[37m[36mINFO[0m[0m 02/26 11:21:42 | 0.481940    0.492616    0.864739    0.845243    0.423623    0.481940    0.492616    0.876492    0.883410    0.871537    0.824937    0.846187    0.827381    2600        26.196474   0.417389    0.082624    0.387298    199.552911 
[37m[36mINFO[0m[0m 02/26 11:25:55 | 0.394411    0.412447    0.863371    0.854205    0.418343    0.394411    0.412447    0.865836    0.893169    0.891688    0.848866    0.832590    0.820578    2800        28.211587   0.388835    0.086211    0.364701    180.250065 
[37m[36mINFO[0m[0m 02/26 11:30:16 | 0.493541    0.482068    0.867216    0.852549    0.423975    0.493541    0.482068    0.876492    0.892142    0.880668    0.857683    0.844487    0.807823    3000        30.226700   0.374046    0.085606    0.375322    185.719223 
[37m[36mINFO[0m[0m 02/26 11:34:42 | 0.464804    0.467300    0.886460    0.859620    0.396340    0.464804    0.467300    0.891642    0.896251    0.899244    0.850126    0.868494    0.832483    3200        32.241814   0.353195    0.082825    0.390572    187.406652 
[37m[36mINFO[0m[0m 02/26 11:39:00 | 0.385974    0.411392    0.876924    0.857094    0.392477    0.385974    0.411392    0.893183    0.901900    0.888854    0.853904    0.848736    0.815476    3400        34.256927   0.345095    0.077321    0.372234    183.875592 
[37m[36mINFO[0m[0m 02/26 11:43:21 | 0.382020    0.385021    0.890493    0.875654    0.363115    0.382020    0.385021    0.887149    0.900360    0.914987    0.867758    0.869344    0.858844    3600        36.272040   0.338929    0.073314    0.366665    187.394147 
[37m[36mINFO[0m[0m 02/26 11:47:35 | 0.442130    0.465190    0.897061    0.877843    0.347844    0.442130    0.465190    0.896906    0.914741    0.918136    0.880353    0.876142    0.838435    3800        38.287154   0.325216    0.074137    0.374244    179.762822 
[37m[36mINFO[0m[0m 02/26 11:51:45 | 0.462694    0.465190    0.902877    0.879374    0.343290    0.462694    0.465190    0.907177    0.909605    0.921914    0.884131    0.879541    0.844388    4000        40.302267   0.302398    0.073279    0.371022    174.965319 
[37m[36mINFO[0m[0m 02/26 11:56:05 | 0.560770    0.565401    0.889238    0.876288    0.370038    0.560770    0.565401    0.887405    0.902928    0.913728    0.886650    0.866582    0.839286    4200        42.317380   0.304798    0.071508    0.393322    182.322629 
[37m[36mINFO[0m[0m 02/26 12:00:24 | 0.513050    0.522152    0.908071    0.885418    0.337202    0.513050    0.522152    0.907947    0.914227    0.926952    0.891688    0.889314    0.850340    4400        44.332494   0.292160    0.069765    0.398897    178.337569 
[37m[36mINFO[0m[0m 02/26 12:04:32 | 0.457422    0.476793    0.902788    0.872444    0.375354    0.457422    0.476793    0.897034    0.892655    0.922229    0.885390    0.889101    0.839286    4600        46.347607   0.274194    0.070822    0.378784    172.256596 
[37m[36mINFO[0m[0m 02/26 12:08:47 | 0.559979    0.554852    0.914394    0.894856    0.317425    0.559979    0.554852    0.919759    0.924499    0.941121    0.910579    0.882303    0.849490    4800        48.362720   0.281875    0.065964    0.377016    179.502482 
[37m[36mINFO[0m[0m 02/26 12:13:02 | 0.459003    0.470464    0.914526    0.897706    0.322644    0.459003    0.470464    0.912312    0.916795    0.933879    0.903023    0.897387    0.873299    5000        50.377834   0.262341    0.067512    0.392955    176.642713 
[37m[36mINFO[0m[0m 02/26 12:13:02 | Cumulative gradient change saved at train_output/TerraIncognita/CORAL/[0]/250226_10-23-27_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/26 12:13:03 | ---
[37m[36mINFO[0m[0m 02/26 12:13:03 | test-domain validation(oracle) = 56.077%
[37m[36mINFO[0m[0m 02/26 12:13:03 | training-domain validation(iid) = 45.900%
[37m[36mINFO[0m[0m 02/26 12:13:03 | last = 45.900%
[37m[36mINFO[0m[0m 02/26 12:13:03 | last (inD) = 89.771%
[37m[36mINFO[0m[0m 02/26 12:13:03 | training-domain validation (iid, inD) = 89.771%
[37m[36mINFO[0m[0m 02/26 12:13:03 | === Summary ===
[37m[36mINFO[0m[0m 02/26 12:13:03 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 20
[37m[36mINFO[0m[0m 02/26 12:13:03 | Unique name: 250226_10-23-27_resnet50_GENIE
[37m[36mINFO[0m[0m 02/26 12:13:03 | Out path: train_output/TerraIncognita/CORAL/[0]/250226_10-23-27_resnet50_GENIE
[37m[36mINFO[0m[0m 02/26 12:13:03 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/26 12:13:03 | Dataset: TerraIncognita

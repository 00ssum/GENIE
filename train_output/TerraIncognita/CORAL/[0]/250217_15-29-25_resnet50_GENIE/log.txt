[37m[36mINFO[0m[0m 02/17 15:29:25 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 --dataset TerraIncognita --trial_seed 1 --hparams_seed 2
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 2
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/CORAL/[0]/250217_15-29-25_resnet50_GENIE
	out_root: train_output/TerraIncognita/CORAL/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 1
	unique_name: 250217_15-29-25_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.0001126313085293539
	batch_size: 38
	weight_decay: 0.006639128805224463
	mmd_gamma: 0.28205739923739065
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/17 15:29:25 | n_steps = 5001
[37m[36mINFO[0m[0m 02/17 15:29:25 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/17 15:29:25 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/17 15:29:25 | 
[37m[36mINFO[0m[0m 02/17 15:29:25 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 02/17 15:29:25 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 02/17 15:29:25 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 02/17 15:29:25 | Batch sizes for each domain: [0, 38, 38, 38] (total=114)
[37m[36mINFO[0m[0m 02/17 15:29:25 | steps-per-epoch for each domain: 204.97, 83.58, 123.87 -> min = 83.58
[37m[36mINFO[0m[0m 02/17 15:29:26 | # of params = 23528522
[37m[36mINFO[0m[0m 02/17 15:32:21 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/17 15:32:21 | 0.208015    0.179325    0.289186    0.299757    2.129127    0.208015    0.179325    0.461933    0.455573    0.188287    0.214106    0.217336    0.229592    0           0.000000    2.428817    0.060854    1.000338    174.086953 
[37m[36mINFO[0m[0m 02/17 15:36:26 | 0.224624    0.200422    0.513524    0.537581    1.279488    0.224624    0.200422    0.611247    0.608115    0.467884    0.503778    0.461440    0.500850    200         2.392947    1.490504    0.064292    0.371441    170.370241 
[37m[36mINFO[0m[0m 02/17 15:40:38 | 0.287635    0.274262    0.638266    0.634773    1.033877    0.287635    0.274262    0.684427    0.686697    0.625315    0.638539    0.605056    0.579082    400         4.785894    1.188976    0.079742    0.372634    177.755487 
[37m[36mINFO[0m[0m 02/17 15:44:43 | 0.145268    0.154008    0.690047    0.700964    0.853037    0.145268    0.154008    0.736937    0.741140    0.668451    0.705290    0.664755    0.656463    600         7.178841    0.925655    0.079203    0.313686    182.212543 
[37m[36mINFO[0m[0m 02/17 15:48:45 | 0.351701    0.374473    0.740952    0.745372    0.710985    0.351701    0.374473    0.759019    0.763739    0.749370    0.765743    0.714468    0.706633    800         9.571788    0.773587    0.071939    0.323829    177.457294 
[37m[36mINFO[0m[0m 02/17 15:53:03 | 0.446612    0.463080    0.761703    0.756652    0.691157    0.446612    0.463080    0.771473    0.776579    0.768577    0.785894    0.745061    0.707483    1000        11.964736   0.680784    0.065797    0.358214    185.925152 
[37m[36mINFO[0m[0m 02/17 15:57:12 | 0.358819    0.370253    0.783153    0.784558    0.618232    0.358819    0.370253    0.803184    0.833590    0.784005    0.792191    0.762269    0.727891    1200        14.357683   0.613054    0.059902    0.349435    179.294340 
[37m[36mINFO[0m[0m 02/17 16:01:26 | 0.390983    0.415612    0.805028    0.799662    0.581049    0.390983    0.415612    0.817306    0.826913    0.811713    0.816121    0.786063    0.755952    1400        16.750630   0.592516    0.055987    0.370474    180.190506 
[37m[36mINFO[0m[0m 02/17 16:05:44 | 0.374374    0.409283    0.810271    0.795344    0.560510    0.374374    0.409283    0.819617    0.807910    0.817695    0.808564    0.793499    0.769558    1600        19.143577   0.571033    0.052458    0.332164    191.692298 
[37m[36mINFO[0m[0m 02/17 16:09:55 | 0.496968    0.517932    0.818374    0.795354    0.568687    0.496968    0.517932    0.824368    0.804828    0.834068    0.831234    0.796686    0.750000    1800        21.536524   0.563516    0.049476    0.340467    182.762623 
[37m[36mINFO[0m[0m 02/17 16:14:03 | 0.341682    0.371308    0.816796    0.802222    0.547696    0.341682    0.371308    0.826679    0.829995    0.828086    0.822418    0.795624    0.754252    2000        23.929471   0.526909    0.047356    0.337054    180.042481 
[37m[36mINFO[0m[0m 02/17 16:18:14 | 0.474558    0.506329    0.828339    0.821469    0.503130    0.474558    0.506329    0.847220    0.851053    0.831549    0.846348    0.806246    0.767007    2200        26.322418   0.511358    0.045611    0.336682    184.486429 
[37m[36mINFO[0m[0m 02/17 16:22:42 | 0.415766    0.449367    0.821893    0.808801    0.540336    0.415766    0.449367    0.856207    0.857730    0.837217    0.816121    0.772254    0.752551    2400        28.715365   0.488278    0.044767    0.412818    185.495597 
[37m[36mINFO[0m[0m 02/17 16:26:49 | 0.327445    0.372363    0.834009    0.824894    0.500388    0.327445    0.372363    0.847349    0.864407    0.840995    0.821159    0.813682    0.789116    2600        31.108312   0.489929    0.043663    0.300572    185.972808 
[37m[36mINFO[0m[0m 02/17 16:30:54 | 0.358819    0.363924    0.833271    0.824885    0.506183    0.358819    0.363924    0.836179    0.838213    0.846977    0.836272    0.816656    0.800170    2800        33.501259   0.487093    0.040151    0.324187    180.443077 
[37m[36mINFO[0m[0m 02/17 16:35:07 | 0.396520    0.445148    0.841152    0.832443    0.496914    0.396520    0.445148    0.863397    0.866461    0.843829    0.840050    0.816231    0.790816    3000        35.894207   0.482267    0.038965    0.333133    186.002547 
[37m[36mINFO[0m[0m 02/17 16:39:12 | 0.415766    0.457806    0.849148    0.829416    0.471434    0.415766    0.457806    0.861856    0.871084    0.867443    0.847607    0.818143    0.769558    3200        38.287154   0.475568    0.038199    0.313377    182.644030 
[37m[36mINFO[0m[0m 02/17 16:43:21 | 0.408911    0.462025    0.838321    0.825980    0.491908    0.408911    0.462025    0.849531    0.850539    0.856423    0.845088    0.809008    0.782313    3400        40.680101   0.462481    0.037812    0.356539    178.033631 
[37m[36mINFO[0m[0m 02/17 16:47:35 | 0.369892    0.400844    0.850202    0.826058    0.469819    0.369892    0.400844    0.852484    0.856189    0.867443    0.836272    0.830678    0.785714    3600        43.073048   0.467534    0.035399    0.366956    180.902490 
[37m[36mINFO[0m[0m 02/17 16:51:41 | 0.244398    0.280591    0.852342    0.831119    0.454616    0.244398    0.280591    0.868276    0.869543    0.851700    0.826196    0.837051    0.797619    3800        45.465995   0.443275    0.036679    0.345795    175.858202 
[37m[36mINFO[0m[0m 02/17 16:55:48 | 0.246770    0.294304    0.849423    0.838719    0.466855    0.246770    0.294304    0.870972    0.871597    0.858942    0.866499    0.818356    0.778061    4000        47.858942   0.441641    0.036083    0.334428    180.990590 
[37m[36mINFO[0m[0m 02/17 16:59:51 | 0.263116    0.298523    0.856281    0.839607    0.457821    0.263116    0.298523    0.870202    0.870570    0.868388    0.843829    0.830253    0.804422    4200        50.251889   0.450637    0.034096    0.330256    176.222298 
[37m[36mINFO[0m[0m 02/17 17:03:53 | 0.390456    0.435654    0.863805    0.843458    0.440907    0.390456    0.435654    0.879959    0.877247    0.880353    0.861461    0.831103    0.791667    4400        52.644836   0.448393    0.033349    0.309713    180.396261 
[37m[36mINFO[0m[0m 02/17 17:07:58 | 0.223306    0.243671    0.850644    0.838513    0.471821    0.223306    0.243671    0.865580    0.872111    0.856738    0.855164    0.829615    0.788265    4600        55.037783   0.454267    0.032653    0.293525    186.560332 
[37m[36mINFO[0m[0m 02/17 17:11:57 | 0.422093    0.453586    0.836183    0.813367    0.531088    0.422093    0.453586    0.842727    0.849512    0.868073    0.831234    0.797748    0.759354    4800        57.430730   0.474382    0.031542    0.309041    176.677268 
[37m[36mINFO[0m[0m 02/17 17:16:05 | 0.394411    0.416667    0.848009    0.823185    0.491192    0.394411    0.416667    0.845937    0.843349    0.869962    0.838791    0.828128    0.787415    5000        59.823678   0.427773    0.031765    0.285623    190.858197 
[37m[36mINFO[0m[0m 02/17 17:16:05 | Cumulative gradient change saved at train_output/TerraIncognita/CORAL/[0]/250217_15-29-25_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/17 17:16:07 | ---
[37m[36mINFO[0m[0m 02/17 17:16:07 | test-domain validation(oracle) = 49.697%
[37m[36mINFO[0m[0m 02/17 17:16:07 | training-domain validation(iid) = 39.046%
[37m[36mINFO[0m[0m 02/17 17:16:07 | last = 39.441%
[37m[36mINFO[0m[0m 02/17 17:16:07 | last (inD) = 82.318%
[37m[36mINFO[0m[0m 02/17 17:16:07 | training-domain validation (iid, inD) = 84.346%
[37m[36mINFO[0m[0m 02/17 17:16:07 | === Summary ===
[37m[36mINFO[0m[0m 02/17 17:16:07 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 --dataset TerraIncognita --trial_seed 1 --hparams_seed 2
[37m[36mINFO[0m[0m 02/17 17:16:07 | Unique name: 250217_15-29-25_resnet50_GENIE
[37m[36mINFO[0m[0m 02/17 17:16:07 | Out path: train_output/TerraIncognita/CORAL/[0]/250217_15-29-25_resnet50_GENIE
[37m[36mINFO[0m[0m 02/17 17:16:07 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/17 17:16:07 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 01/31 15:36:07 | Command :: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 0 1 3 --dataset TerraIncognita --trial_seed 0 --hparams_seed 4
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 4
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/TerraIncognita/CORAL/[0, 1, 3]/250131_15-36-07_resnet50_EVE
	out_root: train_output/TerraIncognita/CORAL/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 0
	unique_name: 250131_15-36-07_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: GENIE
	freeze_bn: False
	pretrained: True
	lr: 2.0793009436922532e-05
	batch_size: 30
	weight_decay: 0.0007980067844361917
	mmd_gamma: 0.10537155511080055
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/31 15:36:07 | n_steps = 5001
[37m[36mINFO[0m[0m 01/31 15:36:07 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/31 15:36:07 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/31 15:36:07 | 
[37m[36mINFO[0m[0m 01/31 15:36:08 | Testenv name escaping te_L100_L38_L46 -> te_L100_L38_L46
[37m[36mINFO[0m[0m 01/31 15:36:08 | Test envs = [0, 1, 3], name = te_L100_L38_L46
[37m[36mINFO[0m[0m 01/31 15:36:08 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 01/31 15:36:08 | Batch sizes for each domain: [0, 0, 30, 0] (total=30)
[37m[36mINFO[0m[0m 01/31 15:36:08 | steps-per-epoch for each domain: 105.87 -> min = 105.87
[37m[36mINFO[0m[0m 01/31 15:36:09 | # of params = 23528522
[37m[36mINFO[0m[0m 01/31 15:39:25 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 01/31 15:39:25 | 0.104725    0.099343    0.300063    0.229219    2.049727    0.155022    0.147679    0.003852    0.001541    0.300063    0.229219    0.155301    0.148810    0           0.000000    2.476334    0.000000    1.075070    195.155513 
[37m[36mINFO[0m[0m 01/31 15:44:00 | 0.248834    0.260414    0.497481    0.505038    1.381095    0.133140    0.140295    0.431506    0.455573    0.497481    0.505038    0.181857    0.185374    200         1.889169    1.566441    0.000000    0.277996    218.632958 
[37m[36mINFO[0m[0m 01/31 15:48:23 | 0.232083    0.243933    0.556360    0.559194    1.121918    0.087793    0.100211    0.380922    0.403698    0.556360    0.559194    0.227533    0.227891    400         3.778338    1.230778    0.000000    0.265017    209.844183 
[37m[36mINFO[0m[0m 01/31 15:53:14 | 0.229159    0.243450    0.671285    0.672544    0.897271    0.091221    0.102321    0.302863    0.328711    0.671285    0.672544    0.293393    0.299320    600         5.667506    0.950095    0.000000    0.313825    227.958915 
[37m[36mINFO[0m[0m 01/31 15:58:13 | 0.378641    0.388474    0.708438    0.704030    0.833693    0.328500    0.355485    0.432661    0.446841    0.708438    0.704030    0.374761    0.363095    800         7.556675    0.809121    0.000000    0.378093    222.178442 
[37m[36mINFO[0m[0m 01/31 16:03:17 | 0.383343    0.402031    0.747481    0.755668    0.668046    0.405484    0.436709    0.356400    0.384181    0.747481    0.755668    0.388145    0.385204    1000        9.445844    0.732469    0.000000    0.280735    247.649847 
[37m[36mINFO[0m[0m 01/31 16:08:16 | 0.364121    0.381233    0.786839    0.783375    0.611052    0.356973    0.385021    0.395044    0.410889    0.786839    0.783375    0.340344    0.347789    1200        11.335013   0.628827    0.000000    0.385541    221.655573 
[37m[36mINFO[0m[0m 01/31 16:12:57 | 0.382087    0.394271    0.771411    0.769521    0.660937    0.381229    0.394515    0.393247    0.414997    0.771411    0.769521    0.371787    0.373299    1400        13.224181   0.601780    0.000000    0.263529    227.454089 
[37m[36mINFO[0m[0m 01/31 16:17:48 | 0.361185    0.376641    0.795655    0.782116    0.588884    0.315845    0.337553    0.393375    0.413970    0.795655    0.782116    0.374336    0.378401    1600        15.113350   0.565798    0.000000    0.294443    231.467221 
[37m[36mINFO[0m[0m 01/31 16:22:35 | 0.402204    0.410218    0.813287    0.823678    0.537581    0.399156    0.385021    0.419309    0.444273    0.813287    0.823678    0.388145    0.401361    1800        17.002519   0.515062    0.000000    0.320158    222.890275 
[37m[36mINFO[0m[0m 01/31 16:27:30 | 0.258579    0.275557    0.815491    0.779597    0.600741    0.151859    0.165612    0.410579    0.436569    0.815491    0.779597    0.213299    0.224490    2000        18.891688   0.517421    0.000000    0.315587    231.890169 
[37m[36mINFO[0m[0m 01/31 16:32:11 | 0.362966    0.383733    0.828086    0.817380    0.513778    0.336673    0.368143    0.450122    0.470981    0.828086    0.817380    0.302103    0.312075    2200        20.780856   0.458797    0.000000    0.302197    220.267772 
[37m[36mINFO[0m[0m 01/31 16:37:01 | 0.414309    0.427785    0.841625    0.819899    0.488371    0.460058    0.477848    0.421492    0.445814    0.841625    0.819899    0.361377    0.359694    2400        22.670025   0.454709    0.000000    0.307405    227.878705 
[37m[36mINFO[0m[0m 01/31 16:41:48 | 0.436207    0.440810    0.836272    0.817380    0.523915    0.469286    0.485232    0.439081    0.454545    0.836272    0.817380    0.400255    0.382653    2600        24.559194   0.413910    0.000000    0.319714    223.338386 
[37m[36mINFO[0m[0m 01/31 16:46:34 | 0.401997    0.407808    0.861461    0.837531    0.488754    0.435012    0.444093    0.398767    0.422188    0.861461    0.837531    0.372212    0.357143    2800        26.448363   0.408734    0.000000    0.349319    216.392268 
[37m[36mINFO[0m[0m 01/31 16:51:30 | 0.376181    0.396382    0.838476    0.827456    0.513388    0.423148    0.432489    0.383746    0.413970    0.838476    0.827456    0.321649    0.342687    3000        28.337531   0.388388    0.000000    0.385631    219.153321 
[37m[36mINFO[0m[0m 01/31 16:56:13 | 0.381642    0.399216    0.873426    0.823678    0.504140    0.464013    0.476793    0.311465    0.349255    0.873426    0.823678    0.369450    0.371599    3200        30.226700   0.361700    0.000000    0.326633    217.759121 
[37m[36mINFO[0m[0m 01/31 17:01:04 | 0.410004    0.422301    0.875630    0.835013    0.420760    0.501977    0.508439    0.317371    0.352851    0.875630    0.835013    0.410665    0.405612    3400        32.115869   0.370300    0.000000    0.334077    223.284834 
[37m[36mINFO[0m[0m 01/31 17:05:54 | 0.413251    0.424989    0.882242    0.874055    0.403680    0.516741    0.525316    0.351650    0.383154    0.882242    0.874055    0.371362    0.366497    3600        34.005038   0.326116    0.000000    0.312396    228.102870 
[37m[36mINFO[0m[0m 01/31 17:11:55 | 0.416479    0.435424    0.892947    0.858942    0.424648    0.443185    0.473629    0.429580    0.460195    0.892947    0.858942    0.376673    0.372449    3800        35.894207   0.308817    0.000000    0.483987    264.409613 
[37m[36mINFO[0m[0m 01/31 17:17:17 | 0.372226    0.390704    0.870592    0.823678    0.469814    0.367255    0.387131    0.396970    0.427838    0.870592    0.823678    0.352454    0.357143    4000        37.783375   0.317971    0.000000    0.284275    263.985484 
[37m[36mINFO[0m[0m 01/31 17:23:09 | 0.400567    0.410413    0.907746    0.863980    0.384985    0.393883    0.393460    0.434330    0.465331    0.907746    0.863980    0.373486    0.372449    4200        39.672544   0.310502    0.000000    0.401239    271.616329 
[37m[36mINFO[0m[0m 01/31 17:28:37 | 0.407883    0.410858    0.893577    0.832494    0.454915    0.411548    0.410338    0.397612    0.429379    0.893577    0.832494    0.414489    0.392857    4400        41.561713   0.286047    0.000000    0.346563    258.157348 
[37m[36mINFO[0m[0m 01/31 17:34:19 | 0.403586    0.408541    0.912154    0.874055    0.388084    0.473767    0.476793    0.315702    0.336415    0.912154    0.874055    0.421287    0.412415    4600        43.450882   0.240427    0.000000    0.465955    248.321746 
[37m[36mINFO[0m[0m 01/31 17:39:26 | 0.452116    0.462626    0.916562    0.877834    0.341247    0.560506    0.583333    0.369881    0.403184    0.916562    0.877834    0.425961    0.401361    4800        45.340050   0.274782    0.000000    0.323661    242.968269 
[37m[36mINFO[0m[0m 01/31 17:45:06 | 0.328197    0.343398    0.905227    0.858942    0.427246    0.277617    0.295359    0.384902    0.405752    0.905227    0.858942    0.322074    0.329082    5000        47.229219   0.250740    0.000000    0.389899    261.915409 
[37m[36mINFO[0m[0m 01/31 17:45:06 | Cumulative gradient change saved at train_output/TerraIncognita/CORAL/[0, 1, 3]/250131_15-36-07_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/31 17:45:08 | ---
[37m[36mINFO[0m[0m 01/31 17:45:08 | test-domain validation(oracle) = 45.212%
[37m[36mINFO[0m[0m 01/31 17:45:08 | training-domain validation(iid) = 45.212%
[37m[36mINFO[0m[0m 01/31 17:45:08 | last = 32.820%
[37m[36mINFO[0m[0m 01/31 17:45:08 | last (inD) = 85.894%
[37m[36mINFO[0m[0m 01/31 17:45:08 | training-domain validation (iid, inD) = 87.783%
[37m[36mINFO[0m[0m 01/31 17:45:08 | === Summary ===
[37m[36mINFO[0m[0m 01/31 17:45:08 | Command: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 0 1 3 --dataset TerraIncognita --trial_seed 0 --hparams_seed 4
[37m[36mINFO[0m[0m 01/31 17:45:08 | Unique name: 250131_15-36-07_resnet50_EVE
[37m[36mINFO[0m[0m 01/31 17:45:08 | Out path: train_output/TerraIncognita/CORAL/[0, 1, 3]/250131_15-36-07_resnet50_EVE
[37m[36mINFO[0m[0m 01/31 17:45:08 | Algorithm: CORAL
[37m[36mINFO[0m[0m 01/31 17:45:08 | Dataset: TerraIncognita

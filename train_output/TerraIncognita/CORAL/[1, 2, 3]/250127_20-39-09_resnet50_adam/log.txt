[37m[36mINFO[0m[0m 01/27 20:39:09 | Command :: /jsm0707/Large-scale/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm CORAL --test_envs 1 2 3 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_adam.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_adam
	out_dir: train_output/TerraIncognita/CORAL/[1, 2, 3]/250127_20-39-09_resnet50_adam
	out_root: train_output/TerraIncognita/CORAL/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 0
	unique_name: 250127_20-39-09_resnet50_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	mmd_gamma: 1.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/27 20:39:09 | n_steps = 5001
[37m[36mINFO[0m[0m 01/27 20:39:09 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/27 20:39:09 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/27 20:39:09 | 
[37m[36mINFO[0m[0m 01/27 20:39:09 | Testenv name escaping te_L38_L43_L46 -> te_L38_L43_L46
[37m[36mINFO[0m[0m 01/27 20:39:09 | Test envs = [1, 2, 3], name = te_L38_L43_L46
[37m[36mINFO[0m[0m 01/27 20:39:09 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 01/27 20:39:09 | Batch sizes for each domain: [32, 0, 0, 0] (total=32)
[37m[36mINFO[0m[0m 01/27 20:39:09 | steps-per-epoch for each domain: 118.53 -> min = 118.53
[37m[36mINFO[0m[0m 01/27 20:39:10 | # of params = 23528522
[37m[36mINFO[0m[0m 01/27 20:41:43 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 01/27 20:41:43 | 0.275810    0.287557    0.214869    0.208861    2.157614    0.214869    0.208861    0.441905    0.464304    0.119962    0.134761    0.265562    0.263605    0           0.000000    2.953307    0.000000    1.193127    151.475868 
[37m[36mINFO[0m[0m 01/27 20:45:03 | 0.171175    0.186210    0.820195    0.823840    0.513387    0.820195    0.823840    0.110926    0.123780    0.183564    0.207809    0.219035    0.227041    200         1.687319    0.748218    0.000000    0.219066    155.861619 
[37m[36mINFO[0m[0m 01/27 20:48:22 | 0.258234    0.274814    0.864224    0.855485    0.430774    0.864224    0.855485    0.290410    0.315357    0.191751    0.187657    0.292543    0.321429    400         3.374637    0.467713    0.000000    0.219169    154.780521 
[37m[36mINFO[0m[0m 01/27 20:51:42 | 0.263082    0.272363    0.891115    0.880802    0.299251    0.891115    0.880802    0.227885    0.236775    0.239924    0.236776    0.321436    0.343537    600         5.061956    0.351986    0.000000    0.229168    153.876435 
[37m[36mINFO[0m[0m 01/27 20:55:00 | 0.274348    0.287069    0.899815    0.888186    0.335466    0.899815    0.888186    0.350751    0.375963    0.191436    0.190176    0.280858    0.295068    800         6.749275    0.329812    0.000000    0.218871    154.159858 
[37m[36mINFO[0m[0m 01/27 20:58:16 | 0.213097    0.232367    0.915634    0.913502    0.264375    0.915634    0.913502    0.225831    0.251669    0.207809    0.211587    0.205651    0.233844    1000        8.436594    0.260034    0.000000    0.217901    152.659780 
[37m[36mINFO[0m[0m 01/27 21:01:41 | 0.258657    0.271720    0.922752    0.914557    0.252781    0.922752    0.914557    0.326871    0.334874    0.238350    0.245592    0.210750    0.234694    1200        10.123912   0.242555    0.000000    0.217727    161.534578 
[37m[36mINFO[0m[0m 01/27 21:05:01 | 0.274135    0.287900    0.906670    0.899789    0.277264    0.906670    0.899789    0.352677    0.371854    0.227960    0.239295    0.241768    0.252551    1400        11.811231   0.231631    0.000000    0.221132    155.871071 
[37m[36mINFO[0m[0m 01/27 21:08:24 | 0.314178    0.327742    0.929871    0.898734    0.317928    0.929871    0.898734    0.399538    0.408834    0.221348    0.234257    0.321649    0.340136    1600        13.498550   0.209683    0.000000    0.214831    159.327567 
[37m[36mINFO[0m[0m 01/27 21:11:39 | 0.240775    0.254326    0.932244    0.910338    0.296722    0.932244    0.910338    0.274361    0.280431    0.253149    0.268262    0.194816    0.214286    1800        15.185869   0.178275    0.000000    0.211478    153.255520 
[37m[36mINFO[0m[0m 01/27 21:14:57 | 0.239688    0.252275    0.948590    0.930380    0.259939    0.948590    0.930380    0.339710    0.355932    0.217254    0.236776    0.162099    0.164116    2000        16.873187   0.159401    0.000000    0.214947    154.950711 
[37m[36mINFO[0m[0m 01/27 21:18:18 | 0.244546    0.248081    0.959399    0.941983    0.211207    0.959399    0.941983    0.317499    0.330252    0.240869    0.243073    0.175271    0.170918    2200        18.560506   0.143536    0.000000    0.218200    156.651349 
[37m[36mINFO[0m[0m 01/27 21:21:33 | 0.229359    0.229049    0.962563    0.941983    0.173153    0.962563    0.941983    0.334318    0.343092    0.199307    0.192695    0.154451    0.151361    2400        20.247825   0.157632    0.000000    0.213369    152.797920 
[37m[36mINFO[0m[0m 01/27 21:24:44 | 0.244015    0.254424    0.967835    0.940928    0.171389    0.967835    0.940928    0.335216    0.350796    0.256612    0.261965    0.140217    0.150510    2600        21.935144   0.137717    0.000000    0.215559    147.373063 
[37m[36mINFO[0m[0m 01/27 21:28:03 | 0.234297    0.244251    0.961508    0.936709    0.188381    0.961508    0.936709    0.296444    0.304058    0.243073    0.256927    0.163374    0.171769    2800        23.622462   0.119578    0.000000    0.212379    157.011228 
[37m[36mINFO[0m[0m 01/27 21:31:15 | 0.273517    0.285983    0.962299    0.930380    0.249141    0.962299    0.930380    0.413917    0.434001    0.218829    0.229219    0.187805    0.194728    3000        25.309781   0.103821    0.000000    0.213577    148.931046 
[37m[36mINFO[0m[0m 01/27 21:34:33 | 0.258947    0.259074    0.957817    0.932489    0.211147    0.957817    0.932489    0.364617    0.371854    0.230793    0.219144    0.181432    0.186224    3200        26.997100   0.121199    0.000000    0.214156    155.220384 
[37m[36mINFO[0m[0m 01/27 21:37:55 | 0.269402    0.279144    0.962563    0.944093    0.171406    0.962563    0.944093    0.346514    0.360041    0.242443    0.239295    0.219248    0.238095    3400        28.684419   0.121193    0.000000    0.212873    159.445700 
[37m[36mINFO[0m[0m 01/27 21:41:18 | 0.247934    0.246769    0.971263    0.945148    0.162268    0.971263    0.945148    0.349467    0.354905    0.234572    0.217884    0.159762    0.167517    3600        30.371737   0.088748    0.000000    0.228660    157.133234 
[37m[36mINFO[0m[0m 01/27 21:44:31 | 0.283203    0.296246    0.964672    0.948312    0.172866    0.964672    0.948312    0.405957    0.418593    0.232053    0.240554    0.211600    0.229592    3800        32.059056   0.079554    0.000000    0.222530    148.781928 
[37m[36mINFO[0m[0m 01/27 21:47:52 | 0.249489    0.269251    0.967835    0.956751    0.147655    0.967835    0.956751    0.268841    0.286595    0.252519    0.274559    0.227109    0.246599    4000        33.746375   0.101875    0.000000    0.212127    158.231435 
[37m[36mINFO[0m[0m 01/27 21:51:00 | 0.228528    0.236676    0.957817    0.933544    0.203781    0.957817    0.933544    0.278470    0.304571    0.240554    0.245592    0.166560    0.159864    4200        35.433694   0.102795    0.000000    0.207786    146.939485 
[37m[36mINFO[0m[0m 01/27 21:54:15 | 0.265045    0.265450    0.973372    0.958861    0.137440    0.973372    0.958861    0.321736    0.335901    0.240554    0.234257    0.232845    0.226190    4400        37.121012   0.088059    0.000000    0.217255    150.881332 
[37m[36mINFO[0m[0m 01/27 21:57:27 | 0.202191    0.208590    0.974690    0.950422    0.136559    0.974690    0.950422    0.272821    0.278891    0.228589    0.238035    0.105163    0.108844    4600        38.808331   0.073132    0.000000    0.219527    148.010682 
[37m[36mINFO[0m[0m 01/27 22:00:42 | 0.272443    0.283780    0.969681    0.950422    0.157625    0.969681    0.950422    0.344075    0.357473    0.208753    0.214106    0.264500    0.279762    4800        40.495650   0.086154    0.000000    0.225567    149.893131 
[37m[36mINFO[0m[0m 01/27 22:03:57 | 0.269477    0.288704    0.980227    0.960970    0.120206    0.980227    0.960970    0.334574    0.364664    0.246537    0.253149    0.227321    0.248299    5000        42.182969   0.076114    0.000000    0.212795    152.326512 
[37m[36mINFO[0m[0m 01/27 22:03:57 | Cumulative gradient change saved at train_output/TerraIncognita/CORAL/[1, 2, 3]/250127_20-39-09_resnet50_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/27 22:03:58 | ---
[37m[36mINFO[0m[0m 01/27 22:03:58 | test-domain validation(oracle) = 31.418%
[37m[36mINFO[0m[0m 01/27 22:03:58 | training-domain validation(iid) = 26.948%
[37m[36mINFO[0m[0m 01/27 22:03:58 | last = 26.948%
[37m[36mINFO[0m[0m 01/27 22:03:58 | last (inD) = 96.097%
[37m[36mINFO[0m[0m 01/27 22:03:58 | training-domain validation (iid, inD) = 96.097%
[37m[36mINFO[0m[0m 01/27 22:03:58 | === Summary ===
[37m[36mINFO[0m[0m 01/27 22:03:58 | Command: /jsm0707/Large-scale/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm CORAL --test_envs 1 2 3 --dataset TerraIncognita
[37m[36mINFO[0m[0m 01/27 22:03:58 | Unique name: 250127_20-39-09_resnet50_adam
[37m[36mINFO[0m[0m 01/27 22:03:58 | Out path: train_output/TerraIncognita/CORAL/[1, 2, 3]/250127_20-39-09_resnet50_adam
[37m[36mINFO[0m[0m 01/27 22:03:58 | Algorithm: CORAL
[37m[36mINFO[0m[0m 01/27 22:03:58 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 01/28 04:34:17 | Command :: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 1 2 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 12
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 12
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/TerraIncognita/CORAL/[1, 2, 3]/250128_04-34-17_resnet50_EVE
	out_root: train_output/TerraIncognita/CORAL/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 1
	unique_name: 250128_04-34-17_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: GENIE
	freeze_bn: False
	pretrained: True
	lr: 3.0065625733392338e-05
	batch_size: 34
	weight_decay: 4.89485556145273e-06
	mmd_gamma: 0.8969215075436004
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/28 04:34:17 | n_steps = 5001
[37m[36mINFO[0m[0m 01/28 04:34:17 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/28 04:34:17 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/28 04:34:17 | 
[37m[36mINFO[0m[0m 01/28 04:34:17 | Testenv name escaping te_L38_L43_L46 -> te_L38_L43_L46
[37m[36mINFO[0m[0m 01/28 04:34:17 | Test envs = [1, 2, 3], name = te_L38_L43_L46
[37m[36mINFO[0m[0m 01/28 04:34:17 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 01/28 04:34:17 | Batch sizes for each domain: [34, 0, 0, 0] (total=34)
[37m[36mINFO[0m[0m 01/28 04:34:17 | steps-per-epoch for each domain: 111.56 -> min = 111.56
[37m[36mINFO[0m[0m 01/28 04:34:19 | # of params = 23528522
[37m[36mINFO[0m[0m 01/28 04:37:22 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 01/28 04:37:22 | 0.120335    0.111127    0.517005    0.541139    1.771570    0.517005    0.541139    0.019515    0.022085    0.098237    0.094458    0.243255    0.216837    0           0.000000    2.859109    0.000000    1.273246    181.207835 
[37m[36mINFO[0m[0m 01/28 04:41:09 | 0.132975    0.121955    0.626417    0.650844    1.005868    0.626417    0.650844    0.054051    0.052902    0.099496    0.096977    0.245379    0.215986    200         1.792776    1.103534    0.000000    0.268013    173.118230 
[37m[36mINFO[0m[0m 01/28 04:45:02 | 0.134934    0.126645    0.713419    0.729958    0.823373    0.713419    0.729958    0.087303    0.090909    0.114610    0.107053    0.202889    0.181973    400         3.585552    0.973966    0.000000    0.273234    178.410138 
[37m[36mINFO[0m[0m 01/28 04:48:56 | 0.139939    0.137449    0.774057    0.787975    0.673199    0.774057    0.787975    0.069200    0.078069    0.134131    0.125945    0.216486    0.208333    600         5.378328    0.769245    0.000000    0.280856    177.741740 
[37m[36mINFO[0m[0m 01/28 04:53:04 | 0.192084    0.187763    0.829159    0.823840    0.513496    0.829159    0.823840    0.173578    0.182845    0.151134    0.139798    0.251540    0.240646    800         7.171105    0.553803    0.000000    0.285180    189.947364 
[37m[36mINFO[0m[0m 01/28 04:57:00 | 0.217168    0.217488    0.860533    0.838608    0.449208    0.860533    0.838608    0.245089    0.267078    0.158060    0.152393    0.248354    0.232993    1000        8.963881    0.461310    0.000000    0.272400    181.141607 
[37m[36mINFO[0m[0m 01/28 05:01:00 | 0.251014    0.248181    0.869496    0.839662    0.460093    0.869496    0.839662    0.277443    0.313303    0.172859    0.157431    0.302741    0.273810    1200        10.756657   0.424121    0.000000    0.303679    179.301785 
[37m[36mINFO[0m[0m 01/28 05:05:04 | 0.270768    0.266080    0.884524    0.824895    0.495423    0.884524    0.824895    0.328283    0.350282    0.196788    0.180101    0.287232    0.267857    1400        12.549433   0.361347    0.000000    0.306425    181.442958 
[37m[36mINFO[0m[0m 01/28 05:08:49 | 0.188757    0.186447    0.875033    0.858650    0.386971    0.875033    0.858650    0.099756    0.114022    0.159950    0.153652    0.306565    0.291667    1600        14.342209   0.335240    0.000000    0.253762    174.777048 
[37m[36mINFO[0m[0m 01/28 05:12:40 | 0.231848    0.220950    0.895597    0.893460    0.322988    0.895597    0.893460    0.137887    0.155624    0.229849    0.200252    0.327810    0.306973    1800        16.134985   0.279277    0.000000    0.288875    171.985194 
[37m[36mINFO[0m[0m 01/28 05:16:38 | 0.229184    0.222671    0.920907    0.897679    0.304252    0.920907    0.897679    0.156760    0.172060    0.202771    0.183879    0.328022    0.312075    2000        17.927762   0.251468    0.000000    0.304387    176.995448 
[37m[36mINFO[0m[0m 01/28 05:20:34 | 0.246400    0.244352    0.915898    0.890295    0.315282    0.915898    0.890295    0.245860    0.257833    0.207809    0.209068    0.285532    0.266156    2200        19.720538   0.231960    0.000000    0.281385    179.815600 
[37m[36mINFO[0m[0m 01/28 05:24:34 | 0.312938    0.307040    0.937780    0.910338    0.281156    0.937780    0.910338    0.337399    0.345660    0.248111    0.250630    0.353304    0.324830    2400        21.513314   0.192384    0.000000    0.280651    183.304152 
[37m[36mINFO[0m[0m 01/28 05:28:14 | 0.253376    0.245423    0.921698    0.900844    0.283135    0.921698    0.900844    0.256644    0.263996    0.186083    0.173804    0.317400    0.298469    2600        23.306090   0.225642    0.000000    0.281415    163.932415 
[37m[36mINFO[0m[0m 01/28 05:32:09 | 0.255196    0.243208    0.922489    0.902954    0.336697    0.922489    0.902954    0.292207    0.297381    0.198048    0.178841    0.275335    0.253401    2800        25.098866   0.186388    0.000000    0.292364    175.855819 
[37m[36mINFO[0m[0m 01/28 05:36:13 | 0.302946    0.292724    0.950171    0.916667    0.235449    0.950171    0.916667    0.336885    0.349255    0.242443    0.232997    0.329509    0.295918    3000        26.891642   0.176915    0.000000    0.285555    187.736702 
[37m[36mINFO[0m[0m 01/28 05:40:12 | 0.302248    0.297490    0.933298    0.915612    0.239719    0.933298    0.915612    0.332263    0.337442    0.226700    0.219144    0.347780    0.335884    3200        28.684419   0.165278    0.000000    0.275314    183.422784 
[37m[36mINFO[0m[0m 01/28 05:44:04 | 0.319725    0.316145    0.953071    0.909283    0.283783    0.953071    0.909283    0.375273    0.384181    0.238035    0.229219    0.345868    0.335034    3400        30.477195   0.178225    0.000000    0.285309    174.998661 
[37m[36mINFO[0m[0m 01/28 05:47:58 | 0.249018    0.244086    0.939889    0.905063    0.307323    0.939889    0.905063    0.248170    0.265537    0.215050    0.209068    0.283833    0.257653    3600        32.269971   0.134588    0.000000    0.308972    172.278934 
[37m[36mINFO[0m[0m 01/28 05:51:43 | 0.257732    0.255285    0.960190    0.927215    0.261618    0.960190    0.927215    0.279753    0.290190    0.208123    0.207809    0.285320    0.267857    3800        34.062747   0.146577    0.000000    0.267422    171.067797 
[37m[36mINFO[0m[0m 01/28 05:55:29 | 0.303284    0.295530    0.955708    0.935654    0.235758    0.955708    0.935654    0.364617    0.360041    0.273300    0.251889    0.271935    0.274660    4000        35.855523   0.128398    0.000000    0.262793    174.084017 
[37m[36mINFO[0m[0m 01/28 05:59:15 | 0.303141    0.297411    0.969681    0.947257    0.189837    0.969681    0.947257    0.338811    0.350282    0.256612    0.244332    0.314000    0.297619    4200        37.648299   0.112453    0.000000    0.275572    170.262338 
[37m[36mINFO[0m[0m 01/28 06:03:04 | 0.324392    0.324068    0.963881    0.940928    0.198663    0.963881    0.940928    0.401592    0.405752    0.246537    0.256927    0.325048    0.309524    4400        39.441076   0.109529    0.000000    0.281010    172.850385 
[37m[36mINFO[0m[0m 01/28 06:06:56 | 0.290725    0.291963    0.961244    0.928270    0.238633    0.961244    0.928270    0.356015    0.361582    0.209383    0.211587    0.306777    0.302721    4600        41.233852   0.114750    0.000000    0.254164    180.914134 
[37m[36mINFO[0m[0m 01/28 06:10:38 | 0.302554    0.294216    0.973636    0.941983    0.190134    0.973636    0.941983    0.326358    0.331279    0.250945    0.239295    0.330359    0.312075    4800        43.026628   0.092727    0.000000    0.263887    169.630137 
[37m[36mINFO[0m[0m 01/28 06:14:21 | 0.285607    0.268657    0.970208    0.937764    0.212832    0.970208    0.937764    0.276801    0.279918    0.251574    0.224181    0.328447    0.301871    5000        44.819404   0.090615    0.000000    0.278849    166.361297 
[37m[36mINFO[0m[0m 01/28 06:14:21 | Cumulative gradient change saved at train_output/TerraIncognita/CORAL/[1, 2, 3]/250128_04-34-17_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/28 06:14:22 | ---
[37m[36mINFO[0m[0m 01/28 06:14:22 | test-domain validation(oracle) = 32.439%
[37m[36mINFO[0m[0m 01/28 06:14:22 | training-domain validation(iid) = 30.314%
[37m[36mINFO[0m[0m 01/28 06:14:22 | last = 28.561%
[37m[36mINFO[0m[0m 01/28 06:14:22 | last (inD) = 93.776%
[37m[36mINFO[0m[0m 01/28 06:14:22 | training-domain validation (iid, inD) = 94.726%
[37m[36mINFO[0m[0m 01/28 06:14:22 | === Summary ===
[37m[36mINFO[0m[0m 01/28 06:14:22 | Command: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 1 2 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 12
[37m[36mINFO[0m[0m 01/28 06:14:22 | Unique name: 250128_04-34-17_resnet50_EVE
[37m[36mINFO[0m[0m 01/28 06:14:22 | Out path: train_output/TerraIncognita/CORAL/[1, 2, 3]/250128_04-34-17_resnet50_EVE
[37m[36mINFO[0m[0m 01/28 06:14:22 | Algorithm: CORAL
[37m[36mINFO[0m[0m 01/28 06:14:22 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 01/27 14:47:53 | Command :: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm CORAL --test_envs 1 2 3 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/TerraIncognita/CORAL/[1, 2, 3]/250127_14-47-53_resnet50_sgd
	out_root: train_output/TerraIncognita/CORAL/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 0
	unique_name: 250127_14-47-53_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	mmd_gamma: 1.0
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/27 14:47:53 | n_steps = 5001
[37m[36mINFO[0m[0m 01/27 14:47:53 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/27 14:47:53 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/27 14:47:53 | 
[37m[36mINFO[0m[0m 01/27 14:47:53 | Testenv name escaping te_L38_L43_L46 -> te_L38_L43_L46
[37m[36mINFO[0m[0m 01/27 14:47:53 | Test envs = [1, 2, 3], name = te_L38_L43_L46
[37m[36mINFO[0m[0m 01/27 14:47:53 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 01/27 14:47:53 | Batch sizes for each domain: [32, 0, 0, 0] (total=32)
[37m[36mINFO[0m[0m 01/27 14:47:53 | steps-per-epoch for each domain: 118.53 -> min = 118.53
[37m[36mINFO[0m[0m 01/27 14:47:55 | # of params = 23528522
[37m[36mINFO[0m[0m 01/27 14:50:47 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 01/27 14:50:47 | 0.031987    0.030287    0.066438    0.059072    2.796450    0.066438    0.059072    0.045192    0.048793    0.044395    0.035264    0.006373    0.006803    0           0.000000    2.953307    0.000000    1.847516    169.990427 
[37m[36mINFO[0m[0m 01/27 14:54:05 | 0.154724    0.165748    0.533351    0.533755    1.263793    0.533351    0.533755    0.131339    0.139188    0.111461    0.128463    0.221372    0.229592    200         1.687319    1.577790    0.000000    0.226832    151.945236 
[37m[36mINFO[0m[0m 01/27 14:57:23 | 0.176324    0.182050    0.595571    0.584388    1.167091    0.595571    0.584388    0.180768    0.189009    0.122796    0.133501    0.225409    0.223639    400         3.374637    1.168994    0.000000    0.230801    152.077791 
[37m[36mINFO[0m[0m 01/27 15:00:42 | 0.269655    0.287515    0.678355    0.643460    1.076665    0.678355    0.643460    0.381949    0.413970    0.202456    0.231738    0.224559    0.216837    600         5.061956    1.067717    0.000000    0.226228    153.075923 
[37m[36mINFO[0m[0m 01/27 15:04:00 | 0.295323    0.312814    0.718165    0.716245    1.003751    0.718165    0.716245    0.439081    0.475603    0.219144    0.246851    0.227746    0.215986    800         6.749275    0.994706    0.000000    0.229992    152.268191 
[37m[36mINFO[0m[0m 01/27 15:07:20 | 0.299790    0.314435    0.725547    0.727848    0.936795    0.725547    0.727848    0.445500    0.481253    0.221662    0.241814    0.232207    0.220238    1000        8.436594    0.921848    0.000000    0.225523    153.871699 
[37m[36mINFO[0m[0m 01/27 15:10:41 | 0.279944    0.293856    0.740047    0.733122    0.890193    0.740047    0.733122    0.388368    0.424242    0.227330    0.245592    0.224134    0.211735    1200        10.123912   0.894482    0.000000    0.228995    155.123732 
[37m[36mINFO[0m[0m 01/27 15:14:02 | 0.241203    0.256320    0.736620    0.740506    0.863983    0.736620    0.740506    0.293876    0.329738    0.214736    0.231738    0.214999    0.207483    1400        11.811231   0.830443    0.000000    0.233745    153.806400 
[37m[36mINFO[0m[0m 01/27 15:17:22 | 0.285341    0.300312    0.740311    0.745781    0.820057    0.740311    0.745781    0.391963    0.429379    0.239924    0.263224    0.224134    0.208333    1600        13.498550   0.804364    0.000000    0.226344    155.406857 
[37m[36mINFO[0m[0m 01/27 15:20:42 | 0.250991    0.266380    0.753493    0.744726    0.809332    0.753493    0.744726    0.286686    0.317411    0.240239    0.265743    0.226046    0.215986    1800        15.185869   0.774591    0.000000    0.226132    153.845186 
[37m[36mINFO[0m[0m 01/27 15:23:58 | 0.267813    0.285349    0.757975    0.747890    0.774947    0.757975    0.747890    0.322121    0.350796    0.253149    0.288413    0.228171    0.216837    2000        16.873187   0.736329    0.000000    0.221241    151.449356 
[37m[36mINFO[0m[0m 01/27 15:27:19 | 0.242289    0.260801    0.761930    0.753165    0.753651    0.761930    0.753165    0.256002    0.285054    0.239295    0.274559    0.231570    0.222789    2200        18.560506   0.708849    0.000000    0.226942    155.772237 
[37m[36mINFO[0m[0m 01/27 15:30:42 | 0.270054    0.287346    0.772212    0.764768    0.710628    0.772212    0.764768    0.316857    0.346174    0.254723    0.289673    0.238581    0.226190    2400        20.247825   0.729530    0.000000    0.235589    155.453836 
[37m[36mINFO[0m[0m 01/27 15:34:03 | 0.250930    0.272607    0.778276    0.772152    0.696919    0.778276    0.772152    0.257543    0.289676    0.252204    0.293451    0.243042    0.234694    2600        21.935144   0.686881    0.000000    0.217216    157.242248 
[37m[36mINFO[0m[0m 01/27 15:37:20 | 0.248878    0.270352    0.788558    0.774262    0.670953    0.788558    0.774262    0.247657    0.279918    0.251259    0.292191    0.247716    0.238946    2800        23.622462   0.661379    0.000000    0.218349    153.572312 
[37m[36mINFO[0m[0m 01/27 15:40:42 | 0.274866    0.289464    0.788294    0.780591    0.648634    0.788294    0.780591    0.308512    0.329224    0.259446    0.295970    0.256639    0.243197    3000        25.309781   0.648348    0.000000    0.237161    154.270778 
[37m[36mINFO[0m[0m 01/27 15:44:04 | 0.260823    0.277443    0.801213    0.789030    0.625899    0.801213    0.789030    0.268070    0.298921    0.249685    0.280856    0.264712    0.252551    3200        26.997100   0.642902    0.000000    0.229466    155.911559 
[37m[36mINFO[0m[0m 01/27 15:47:30 | 0.256367    0.273225    0.810177    0.799578    0.601718    0.810177    0.799578    0.267557    0.294299    0.240869    0.277078    0.260676    0.248299    3400        28.684419   0.632710    0.000000    0.223401    160.886869 
[37m[36mINFO[0m[0m 01/27 15:50:50 | 0.261136    0.280893    0.805958    0.794304    0.595281    0.805958    0.794304    0.264219    0.283513    0.248741    0.294710    0.270448    0.264456    3600        30.371737   0.578827    0.000000    0.221745    155.153734 
[37m[36mINFO[0m[0m 01/27 15:54:14 | 0.223903    0.244777    0.813604    0.794304    0.596749    0.813604    0.794304    0.191039    0.214176    0.219144    0.253149    0.261525    0.267007    3800        32.059056   0.549140    0.000000    0.217652    160.552128 
[37m[36mINFO[0m[0m 01/27 15:57:44 | 0.267572    0.285070    0.806486    0.785865    0.585366    0.806486    0.785865    0.268456    0.285054    0.258501    0.299748    0.275760    0.270408    4000        33.746375   0.534562    0.000000    0.227179    164.050213 
[37m[36mINFO[0m[0m 01/27 16:01:08 | 0.212691    0.233540    0.822568    0.808017    0.559516    0.822568    0.808017    0.163692    0.184900    0.212217    0.234257    0.262163    0.281463    4200        35.433694   0.553962    0.000000    0.221924    159.614912 
[37m[36mINFO[0m[0m 01/27 16:04:30 | 0.204003    0.225800    0.825995    0.817511    0.540611    0.825995    0.817511    0.167801    0.192604    0.203715    0.225441    0.240493    0.259354    4400        37.121012   0.542817    0.000000    0.221473    157.592499 
[37m[36mINFO[0m[0m 01/27 16:07:51 | 0.247913    0.272479    0.839441    0.821730    0.513129    0.839441    0.821730    0.227629    0.249101    0.239924    0.275819    0.276184    0.292517    4600        38.808331   0.528300    0.000000    0.225955    155.520295 
[37m[36mINFO[0m[0m 01/27 16:11:18 | 0.221231    0.243165    0.835223    0.823840    0.507516    0.835223    0.823840    0.194890    0.219825    0.216625    0.241814    0.252178    0.267857    4800        40.495650   0.498323    0.000000    0.226510    161.607937 
[37m[36mINFO[0m[0m 01/27 16:14:41 | 0.203095    0.220906    0.829423    0.813291    0.525429    0.829423    0.813291    0.135191    0.148947    0.209383    0.220403    0.264712    0.293367    5000        42.182969   0.497549    0.000000    0.228321    157.124478 
[37m[36mINFO[0m[0m 01/27 16:14:41 | Cumulative gradient change saved at train_output/TerraIncognita/CORAL/[1, 2, 3]/250127_14-47-53_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/27 16:14:42 | ---
[37m[36mINFO[0m[0m 01/27 16:14:42 | test-domain validation(oracle) = 29.979%
[37m[36mINFO[0m[0m 01/27 16:14:42 | training-domain validation(iid) = 22.123%
[37m[36mINFO[0m[0m 01/27 16:14:42 | last = 20.310%
[37m[36mINFO[0m[0m 01/27 16:14:42 | last (inD) = 81.329%
[37m[36mINFO[0m[0m 01/27 16:14:42 | training-domain validation (iid, inD) = 82.384%
[37m[36mINFO[0m[0m 01/27 16:14:42 | === Summary ===
[37m[36mINFO[0m[0m 01/27 16:14:42 | Command: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm CORAL --test_envs 1 2 3 --dataset TerraIncognita
[37m[36mINFO[0m[0m 01/27 16:14:42 | Unique name: 250127_14-47-53_resnet50_sgd
[37m[36mINFO[0m[0m 01/27 16:14:42 | Out path: train_output/TerraIncognita/CORAL/[1, 2, 3]/250127_14-47-53_resnet50_sgd
[37m[36mINFO[0m[0m 01/27 16:14:42 | Algorithm: CORAL
[37m[36mINFO[0m[0m 01/27 16:14:42 | Dataset: TerraIncognita

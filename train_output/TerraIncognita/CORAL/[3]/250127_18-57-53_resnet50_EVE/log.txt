[37m[36mINFO[0m[0m 01/27 18:57:53 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 17
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 17
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/TerraIncognita/CORAL/[3]/250127_18-57-53_resnet50_EVE
	out_root: train_output/TerraIncognita/CORAL/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250127_18-57-53_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: GENIE
	freeze_bn: False
	pretrained: True
	lr: 0.0002990700776954947
	batch_size: 8
	weight_decay: 4.0966675521600606e-05
	mmd_gamma: 0.10200134949133195
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/27 18:57:53 | n_steps = 5001
[37m[36mINFO[0m[0m 01/27 18:57:53 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/27 18:57:53 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/27 18:57:53 | Target test envs = [[3]]
[37m[36mINFO[0m[0m 01/27 18:57:53 | 
[37m[36mINFO[0m[0m 01/27 18:57:53 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 01/27 18:57:53 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 01/27 18:57:53 | Batch sizes for each domain: [8, 8, 8, 0] (total=24)
[37m[36mINFO[0m[0m 01/27 18:57:53 | steps-per-epoch for each domain: 474.12, 973.62, 397.00 -> min = 397.00
[37m[36mINFO[0m[0m 01/27 18:57:54 | # of params = 23528522
[37m[36mINFO[0m[0m 01/27 19:00:38 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 01/27 19:00:38 | 0.217336    0.229592    0.286078    0.283001    2.040852    0.208015    0.179325    0.461933    0.455573    0.188287    0.214106    0.217336    0.229592    0           0.000000    2.403693    0.196257    1.144405    162.514643 
[37m[36mINFO[0m[0m 01/27 19:03:52 | 0.216274    0.228741    0.499979    0.529146    1.330122    0.587398    0.678270    0.563359    0.557781    0.349181    0.351385    0.216274    0.228741    200         0.503778    1.550625    0.102743    0.168678    160.146249 
[37m[36mINFO[0m[0m 01/27 19:07:11 | 0.288719    0.292517    0.543063    0.579718    1.199038    0.628526    0.716245    0.587880    0.578326    0.412783    0.444584    0.288719    0.292517    400         1.007557    1.313150    0.116536    0.186931    161.882675 
[37m[36mINFO[0m[0m 01/27 19:10:33 | 0.203739    0.210884    0.539316    0.574021    1.215612    0.620881    0.638186    0.554372    0.578839    0.442695    0.505038    0.203739    0.210884    600         1.511335    1.203502    0.104301    0.192389    162.382114 
[37m[36mINFO[0m[0m 01/27 19:13:54 | 0.195878    0.199830    0.607744    0.600284    1.076746    0.741366    0.757384    0.632559    0.612738    0.449307    0.430730    0.195878    0.199830    800         2.015113    1.137223    0.110152    0.171772    167.005724 
[37m[36mINFO[0m[0m 01/27 19:17:17 | 0.236881    0.223639    0.699400    0.719235    0.819158    0.798313    0.804852    0.712672    0.734463    0.587217    0.618388    0.236881    0.223639    1000        2.518892    0.989447    0.144547    0.167974    169.437229 
[37m[36mINFO[0m[0m 01/27 19:20:41 | 0.333758    0.324830    0.712057    0.734686    0.782699    0.796204    0.784810    0.737322    0.755521    0.602645    0.663728    0.333758    0.324830    1200        3.022670    0.854861    0.143492    0.178966    167.748156 
[37m[36mINFO[0m[0m 01/27 19:24:03 | 0.318462    0.310374    0.728664    0.746286    0.728051    0.815713    0.815401    0.741815    0.764766    0.628463    0.658690    0.318462    0.310374    1400        3.526448    0.854979    0.126028    0.180799    165.090436 
[37m[36mINFO[0m[0m 01/27 19:27:25 | 0.317825    0.307823    0.772364    0.770967    0.633028    0.860533    0.859705    0.765438    0.791988    0.691121    0.661209    0.317825    0.307823    1600        4.030227    0.742150    0.137698    0.176772    165.880063 
[37m[36mINFO[0m[0m 01/27 19:30:50 | 0.304440    0.306122    0.717311    0.730897    0.770385    0.801476    0.798523    0.716010    0.721623    0.634446    0.672544    0.304440    0.306122    1800        4.534005    0.738579    0.124807    0.211716    162.820172 
[37m[36mINFO[0m[0m 01/27 19:34:25 | 0.404079    0.410714    0.789776    0.806469    0.567430    0.869233    0.868143    0.783156    0.809450    0.716940    0.741814    0.404079    0.410714    2000        5.037783    0.709026    0.117738    0.213528    171.703902 
[37m[36mINFO[0m[0m 01/27 19:37:42 | 0.360739    0.357143    0.779204    0.784829    0.583356    0.871606    0.871308    0.765438    0.779147    0.700567    0.704030    0.360739    0.357143    2200        5.541562    0.700645    0.115492    0.194939    158.134549 
[37m[36mINFO[0m[0m 01/27 19:40:54 | 0.336733    0.336735    0.792668    0.793135    0.586788    0.885051    0.874473    0.788291    0.797124    0.704660    0.707809    0.336733    0.336735    2400        6.045340    0.643820    0.108943    0.167793    158.813531 
[37m[36mINFO[0m[0m 01/27 19:44:13 | 0.344168    0.339286    0.769274    0.769996    0.655990    0.858687    0.859705    0.769033    0.771443    0.680101    0.678841    0.344168    0.339286    2600        6.549118    0.646065    0.110012    0.170398    164.091919 
[37m[36mINFO[0m[0m 01/27 19:47:31 | 0.314213    0.298469    0.796397    0.799319    0.562158    0.873715    0.863924    0.784054    0.790960    0.731423    0.743073    0.314213    0.298469    2800        7.052897    0.608021    0.104027    0.170256    164.896394 
[37m[36mINFO[0m[0m 01/27 19:50:49 | 0.379010    0.365646    0.801190    0.811360    0.536016    0.865805    0.863924    0.787136    0.809450    0.750630    0.760705    0.379010    0.365646    3000        7.556675    0.576993    0.116333    0.170312    163.437564 
[37m[36mINFO[0m[0m 01/27 19:54:10 | 0.336733    0.332483    0.792129    0.804930    0.574670    0.867915    0.873418    0.786494    0.805855    0.721977    0.735516    0.336733    0.332483    3200        8.060453    0.548103    0.115224    0.176866    164.805802 
[37m[36mINFO[0m[0m 01/27 19:57:31 | 0.343531    0.346939    0.817203    0.819654    0.510804    0.888742    0.883966    0.792400    0.799178    0.770466    0.775819    0.343531    0.346939    3400        8.564232    0.540504    0.106652    0.174779    166.774854 
[37m[36mINFO[0m[0m 01/27 20:00:55 | 0.295942    0.300170    0.790978    0.788293    0.554863    0.876088    0.871308    0.774554    0.769389    0.722292    0.724181    0.295942    0.300170    3600        9.068010    0.518408    0.110487    0.179880    167.093765 
[37m[36mINFO[0m[0m 01/27 20:04:17 | 0.413002    0.409014    0.821030    0.832146    0.482482    0.898234    0.893460    0.801001    0.839753    0.763854    0.763224    0.413002    0.409014    3800        9.571788    0.556953    0.101614    0.179174    166.026464 
[37m[36mINFO[0m[0m 01/27 20:07:32 | 0.368600    0.360544    0.821221    0.826001    0.502474    0.896124    0.883966    0.803056    0.806882    0.764484    0.787154    0.368600    0.360544    4000        10.075567   0.517234    0.099827    0.169415    161.376971 
[37m[36mINFO[0m[0m 01/27 20:10:55 | 0.405354    0.398810    0.817665    0.831463    0.485751    0.898234    0.883966    0.806650    0.820750    0.748111    0.789673    0.405354    0.398810    4200        10.579345   0.502618    0.098759    0.186112    165.535629 
[37m[36mINFO[0m[0m 01/27 20:14:20 | 0.325898    0.329932    0.832104    0.834177    0.467017    0.904825    0.882911    0.810630    0.827427    0.780856    0.792191    0.325898    0.329932    4400        11.083123   0.505135    0.096841    0.177557    169.585042 
[37m[36mINFO[0m[0m 01/27 20:17:45 | 0.349055    0.339286    0.842530    0.838124    0.447001    0.908252    0.892405    0.828091    0.844890    0.791247    0.777078    0.349055    0.339286    4600        11.586902   0.470577    0.097485    0.177323    168.694435 
[37m[36mINFO[0m[0m 01/27 20:21:10 | 0.373486    0.385204    0.823592    0.834784    0.481912    0.899025    0.898734    0.792785    0.819723    0.778967    0.785894    0.373486    0.385204    4800        12.090680   0.455819    0.098584    0.172384    170.863938 
[37m[36mINFO[0m[0m 01/27 20:24:27 | 0.406204    0.398810    0.841234    0.848122    0.427434    0.902452    0.892405    0.829375    0.845917    0.791877    0.806045    0.406204    0.398810    5000        12.594458   0.456715    0.097989    0.174120    162.307452 
[37m[36mINFO[0m[0m 01/27 20:24:28 | Cumulative gradient change saved at train_output/TerraIncognita/CORAL/[3]/250127_18-57-53_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/27 20:24:29 | ---
[37m[36mINFO[0m[0m 01/27 20:24:29 | test-domain validation(oracle) = 40.408%
[37m[36mINFO[0m[0m 01/27 20:24:29 | training-domain validation(iid) = 40.620%
[37m[36mINFO[0m[0m 01/27 20:24:29 | last = 40.620%
[37m[36mINFO[0m[0m 01/27 20:24:29 | last (inD) = 84.812%
[37m[36mINFO[0m[0m 01/27 20:24:29 | training-domain validation (iid, inD) = 84.812%
[37m[36mINFO[0m[0m 01/27 20:24:29 | === Summary ===
[37m[36mINFO[0m[0m 01/27 20:24:29 | Command: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 17
[37m[36mINFO[0m[0m 01/27 20:24:29 | Unique name: 250127_18-57-53_resnet50_EVE
[37m[36mINFO[0m[0m 01/27 20:24:29 | Out path: train_output/TerraIncognita/CORAL/[3]/250127_18-57-53_resnet50_EVE
[37m[36mINFO[0m[0m 01/27 20:24:29 | Algorithm: CORAL
[37m[36mINFO[0m[0m 01/27 20:24:29 | Dataset: TerraIncognita
[37m[36mINFO[0m[0m 01/27 20:24:29 | Max test_in: 0.4130

[37m[36mINFO[0m[0m 01/26 12:58:17 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 1 --dataset TerraIncognita --trial_seed 1 --hparams_seed 13
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 13
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/TerraIncognita/CORAL/[1]/250126_12-58-17_resnet50_EVE
	out_root: train_output/TerraIncognita/CORAL/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250126_12-58-17_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: EVE
	freeze_bn: False
	pretrained: True
	lr: 6.984990754803203e-05
	batch_size: 13
	weight_decay: 2.888048423418205e-06
	mmd_gamma: 7.302291555616863
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/26 12:58:17 | n_steps = 5001
[37m[36mINFO[0m[0m 01/26 12:58:17 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/26 12:58:17 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/26 12:58:17 | Target test envs = [[1]]
[37m[36mINFO[0m[0m 01/26 12:58:17 | 
[37m[36mINFO[0m[0m 01/26 12:58:17 | Testenv name escaping te_L38 -> te_L38
[37m[36mINFO[0m[0m 01/26 12:58:17 | Test envs = [1], name = te_L38
[37m[36mINFO[0m[0m 01/26 12:58:17 | Batch sizes for each domain: [13, 0, 13, 13] (total=39)
[37m[36mINFO[0m[0m 01/26 12:58:17 | steps-per-epoch for each domain: 291.77, 244.31, 362.08 -> min = 244.31
[37m[36mINFO[0m[0m 01/26 12:58:19 | # of params = 23528522
[37m[36mINFO[0m[0m 01/26 13:01:02 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 01/26 13:01:02 | 0.019515    0.022085    0.286166    0.284145    2.090813    0.517005    0.541139    0.019515    0.022085    0.098237    0.094458    0.243255    0.216837    0           0.000000    2.419500    0.062813    1.170612    162.101895 
[37m[36mINFO[0m[0m 01/26 13:04:18 | 0.023495    0.029789    0.383271    0.387394    1.576059    0.539942    0.578059    0.023495    0.029789    0.260390    0.238035    0.349479    0.346088    200         0.818640    1.680706    0.004215    0.218419    152.096667 
[37m[36mINFO[0m[0m 01/26 13:07:47 | 0.034407    0.038007    0.445110    0.481211    1.408933    0.605326    0.630802    0.034407    0.038007    0.339736    0.374055    0.390270    0.438776    400         1.637280    1.540328    0.005206    0.233957    161.738687 
[37m[36mINFO[0m[0m 01/26 13:11:17 | 0.028502    0.036980    0.457696    0.492804    1.390051    0.623253    0.657173    0.028502    0.036980    0.342569    0.381612    0.407266    0.439626    600         2.455919    1.433589    0.005936    0.231056    163.471126 
[37m[36mINFO[0m[0m 01/26 13:14:42 | 0.103608    0.104777    0.496424    0.505189    1.363969    0.674664    0.695148    0.103608    0.104777    0.379723    0.379093    0.434884    0.441327    800         3.274559    1.375287    0.005933    0.205537    163.492756 
[37m[36mINFO[0m[0m 01/26 13:18:06 | 0.026704    0.034412    0.543819    0.564902    1.260220    0.696283    0.697257    0.026704    0.034412    0.476071    0.500000    0.459103    0.497449    1000        4.093199    1.332921    0.006001    0.212587    161.672053 
[37m[36mINFO[0m[0m 01/26 13:21:31 | 0.026448    0.032357    0.567322    0.571429    1.224363    0.723438    0.726793    0.026448    0.032357    0.492443    0.513854    0.486085    0.473639    1200        4.911839    1.258455    0.006196    0.244932    155.526946 
[37m[36mINFO[0m[0m 01/26 13:24:57 | 0.203877    0.211094    0.569629    0.582125    1.180989    0.726602    0.718354    0.203877    0.211094    0.506612    0.536524    0.475675    0.491497    1400        5.730479    1.244607    0.005851    0.267558    151.962624 
[37m[36mINFO[0m[0m 01/26 13:28:28 | 0.273077    0.273754    0.596122    0.610790    1.082727    0.759293    0.750000    0.273077    0.273754    0.546599    0.575567    0.482473    0.506803    1600        6.549118    1.174475    0.005881    0.231269    164.605025 
[37m[36mINFO[0m[0m 01/26 13:31:51 | 0.177558    0.186954    0.633968    0.637955    1.022974    0.742684    0.758439    0.177558    0.186954    0.597292    0.614610    0.561929    0.540816    1800        7.367758    1.058980    0.007039    0.222375    158.175932 
[37m[36mINFO[0m[0m 01/26 13:35:16 | 0.187187    0.191063    0.688107    0.695797    0.865998    0.811495    0.829114    0.187187    0.191063    0.639484    0.651134    0.613342    0.607143    2000        8.186398    0.942444    0.007920    0.230486    159.136543 
[37m[36mINFO[0m[0m 01/26 13:38:49 | 0.112595    0.122239    0.720149    0.733134    0.792614    0.832586    0.850211    0.112595    0.122239    0.662469    0.690176    0.665392    0.659014    2200        9.005038    0.808444    0.008048    0.261484    160.720695 
[37m[36mINFO[0m[0m 01/26 13:42:29 | 0.302093    0.310734    0.754729    0.749786    0.721331    0.859742    0.866034    0.302093    0.310734    0.706549    0.714106    0.697897    0.669218    2400        9.823678    0.766486    0.007783    0.273887    163.974951 
[37m[36mINFO[0m[0m 01/26 13:45:56 | 0.413275    0.422188    0.736058    0.734135    0.781547    0.843923    0.832278    0.413275    0.422188    0.701196    0.715365    0.663055    0.654762    2600        10.642317   0.732812    0.007442    0.218315    163.002981 
[37m[36mINFO[0m[0m 01/26 13:49:10 | 0.366543    0.366718    0.779289    0.774673    0.668660    0.856578    0.853376    0.366543    0.366718    0.746851    0.768262    0.734438    0.702381    2800        11.460957   0.699647    0.007079    0.203302    153.170596 
[37m[36mINFO[0m[0m 01/26 13:52:31 | 0.281679    0.286081    0.782901    0.779276    0.636279    0.877933    0.869198    0.281679    0.286081    0.729534    0.759446    0.741236    0.709184    3000        12.279597   0.633068    0.006859    0.213950    157.892539 
[37m[36mINFO[0m[0m 01/26 13:55:58 | 0.385672    0.382640    0.790099    0.779857    0.628404    0.876615    0.868143    0.385672    0.382640    0.749685    0.773300    0.743998    0.698129    3200        13.098237   0.619940    0.006622    0.242889    158.519027 
[37m[36mINFO[0m[0m 01/26 13:59:22 | 0.273334    0.263996    0.799594    0.788056    0.620177    0.889797    0.880802    0.273334    0.263996    0.766688    0.770781    0.742299    0.712585    3400        13.916877   0.593560    0.006580    0.235646    156.007820 
[37m[36mINFO[0m[0m 01/26 14:02:40 | 0.336629    0.345660    0.804104    0.797955    0.609809    0.895861    0.887131    0.336629    0.345660    0.764169    0.772040    0.752284    0.734694    3600        14.735516   0.558179    0.006259    0.209769    155.736345 
[37m[36mINFO[0m[0m 01/26 14:05:59 | 0.361022    0.358500    0.808730    0.799728    0.588334    0.892433    0.880802    0.361022    0.358500    0.791247    0.792191    0.742511    0.726190    3800        15.554156   0.549268    0.005973    0.226764    153.917760 
[37m[36mINFO[0m[0m 01/26 14:09:29 | 0.372448    0.376990    0.832455    0.822921    0.525755    0.907988    0.898734    0.372448    0.376990    0.803526    0.809824    0.785851    0.760204    4000        16.372796   0.518542    0.005792    0.231192    162.632298 
[37m[36mINFO[0m[0m 01/26 14:12:58 | 0.396713    0.388290    0.840859    0.824244    0.510409    0.907725    0.894515    0.396713    0.388290    0.813917    0.801008    0.800935    0.777211    4200        17.191436   0.509384    0.005924    0.220647    164.497805 
[37m[36mINFO[0m[0m 01/26 14:16:24 | 0.348440    0.342065    0.811525    0.795121    0.582733    0.886633    0.874473    0.348440    0.342065    0.786524    0.779597    0.761419    0.731293    4400        18.010076   0.490718    0.005914    0.213525    163.192848 
[37m[36mINFO[0m[0m 01/26 14:19:45 | 0.337912    0.338469    0.837058    0.816954    0.537093    0.905088    0.893460    0.337912    0.338469    0.809824    0.799748    0.796261    0.757653    4600        18.828715   0.469104    0.005656    0.216658    157.971454 
[37m[36mINFO[0m[0m 01/26 14:23:10 | 0.244576    0.243965    0.837838    0.828295    0.514703    0.904825    0.896624    0.244576    0.243965    0.813917    0.813602    0.794774    0.774660    4800        19.647355   0.458840    0.005239    0.214112    162.384497 
[37m[36mINFO[0m[0m 01/26 14:26:35 | 0.431763    0.428351    0.847606    0.830653    0.487796    0.922489    0.906118    0.431763    0.428351    0.817695    0.803526    0.802634    0.782313    5000        20.465995   0.440423    0.005190    0.233651    157.545973 
[37m[36mINFO[0m[0m 01/26 14:26:35 | Cumulative gradient change saved at train_output/TerraIncognita/CORAL/[1]/250126_12-58-17_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/26 14:26:37 | ---
[37m[36mINFO[0m[0m 01/26 14:26:37 | test-domain validation(oracle) = 43.176%
[37m[36mINFO[0m[0m 01/26 14:26:37 | training-domain validation(iid) = 43.176%
[37m[36mINFO[0m[0m 01/26 14:26:37 | last = 43.176%
[37m[36mINFO[0m[0m 01/26 14:26:37 | last (inD) = 83.065%
[37m[36mINFO[0m[0m 01/26 14:26:37 | training-domain validation (iid, inD) = 83.065%
[37m[36mINFO[0m[0m 01/26 14:26:37 | === Summary ===
[37m[36mINFO[0m[0m 01/26 14:26:37 | Command: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 1 --dataset TerraIncognita --trial_seed 1 --hparams_seed 13
[37m[36mINFO[0m[0m 01/26 14:26:37 | Unique name: 250126_12-58-17_resnet50_EVE
[37m[36mINFO[0m[0m 01/26 14:26:37 | Out path: train_output/TerraIncognita/CORAL/[1]/250126_12-58-17_resnet50_EVE
[37m[36mINFO[0m[0m 01/26 14:26:37 | Algorithm: CORAL
[37m[36mINFO[0m[0m 01/26 14:26:37 | Dataset: TerraIncognita
[37m[36mINFO[0m[0m 01/26 14:26:37 | Max test_in: 0.4318

[37m[36mINFO[0m[0m 02/15 06:51:42 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 1 --dataset TerraIncognita --trial_seed 0 --hparams_seed 5
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 5
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/CORAL/[1]/250215_06-51-42_resnet50_GENIE
	out_root: train_output/TerraIncognita/CORAL/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250215_06-51-42_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.6343540304927548e-05
	batch_size: 23
	weight_decay: 3.844578840738432e-05
	mmd_gamma: 0.6855754528884209
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/15 06:51:42 | n_steps = 5001
[37m[36mINFO[0m[0m 02/15 06:51:42 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/15 06:51:42 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/15 06:51:42 | 
[37m[36mINFO[0m[0m 02/15 06:51:42 | Testenv name escaping te_L38 -> te_L38
[37m[36mINFO[0m[0m 02/15 06:51:42 | Test envs = [1], name = te_L38
[37m[36mINFO[0m[0m 02/15 06:51:42 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 02/15 06:51:42 | Batch sizes for each domain: [23, 0, 23, 23] (total=69)
[37m[36mINFO[0m[0m 02/15 06:51:42 | steps-per-epoch for each domain: 164.91, 138.09, 204.65 -> min = 138.09
[37m[36mINFO[0m[0m 02/15 06:51:43 | # of params = 23528522
[37m[36mINFO[0m[0m 02/15 06:54:47 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/15 06:54:47 | 0.019258    0.023112    0.284710    0.289972    2.089489    0.522278    0.520042    0.019258    0.023112    0.096033    0.103275    0.235819    0.246599    0           0.000000    2.373244    0.066267    1.098416    182.815812 
[37m[36mINFO[0m[0m 02/15 06:58:52 | 0.031711    0.033385    0.515427    0.520312    1.293071    0.712892    0.719409    0.031711    0.033385    0.355164    0.357683    0.478224    0.483844    200         1.448363    1.460619    0.032491    0.281869    188.077570 
[37m[36mINFO[0m[0m 02/15 07:03:06 | 0.077160    0.084232    0.606738    0.606520    1.068178    0.756393    0.750000    0.077160    0.084232    0.545655    0.546599    0.518164    0.522959    400         2.896725    1.188809    0.041129    0.360472    182.548516 
[37m[36mINFO[0m[0m 02/15 07:07:27 | 0.161253    0.161787    0.724890    0.712424    0.775618    0.840759    0.820675    0.161253    0.161787    0.680416    0.678841    0.653495    0.637755    600         4.345088    0.920280    0.042716    0.365682    187.722558 
[37m[36mINFO[0m[0m 02/15 07:12:03 | 0.224933    0.235747    0.741877    0.752233    0.713703    0.861587    0.866034    0.224933    0.235747    0.692065    0.705290    0.671978    0.685374    800         5.793451    0.726526    0.039490    0.395477    197.228392 
[37m[36mINFO[0m[0m 02/15 07:16:35 | 0.336757    0.348228    0.787702    0.783933    0.625018    0.873978    0.857595    0.336757    0.348228    0.748741    0.754408    0.740387    0.739796    1000        7.241814    0.651741    0.036916    0.356724    200.124774 
[37m[36mINFO[0m[0m 02/15 07:21:09 | 0.288741    0.295326    0.794814    0.793344    0.581921    0.888479    0.871308    0.288741    0.295326    0.745592    0.749370    0.750372    0.759354    1200        8.690176    0.591527    0.033060    0.278096    218.502912 
[37m[36mINFO[0m[0m 02/15 07:25:33 | 0.338940    0.358500    0.825975    0.813968    0.529303    0.912470    0.883966    0.338940    0.358500    0.796599    0.790932    0.768855    0.767007    1400        10.138539   0.523667    0.031293    0.253415    213.159800 
[37m[36mINFO[0m[0m 02/15 07:30:10 | 0.393375    0.406780    0.838129    0.829157    0.497529    0.910888    0.896624    0.393375    0.406780    0.812972    0.811083    0.790525    0.779762    1600        11.586902   0.485793    0.030081    0.312504    214.644534 
[37m[36mINFO[0m[0m 02/15 07:34:35 | 0.336372    0.359527    0.836990    0.821672    0.493628    0.902979    0.896624    0.336372    0.359527    0.818955    0.804786    0.789038    0.763605    1800        13.035264   0.470033    0.028501    0.350292    194.544210 
[37m[36mINFO[0m[0m 02/15 07:39:00 | 0.409167    0.434001    0.848230    0.821747    0.487445    0.914316    0.890295    0.409167    0.434001    0.830290    0.790932    0.800085    0.784014    2000        14.483627   0.435720    0.026935    0.364942    192.370652 
[37m[36mINFO[0m[0m 02/15 07:43:08 | 0.292977    0.297894    0.864405    0.847358    0.451037    0.923280    0.915612    0.292977    0.297894    0.844144    0.818640    0.825791    0.807823    2200        15.931990   0.414043    0.026441    0.318014    184.811928 
[37m[36mINFO[0m[0m 02/15 07:47:23 | 0.348183    0.355419    0.860614    0.832475    0.478875    0.923280    0.911392    0.348183    0.355419    0.835957    0.788413    0.822605    0.797619    2400        17.380353   0.411867    0.024048    0.269676    200.282427 
[37m[36mINFO[0m[0m 02/15 07:51:32 | 0.323276    0.351310    0.879087    0.864520    0.399852    0.934880    0.930380    0.323276    0.351310    0.875315    0.840050    0.827066    0.823129    2600        18.828715   0.366266    0.025169    0.246320    200.030698 
[37m[36mINFO[0m[0m 02/15 07:55:30 | 0.434716    0.459682    0.876739    0.851184    0.411786    0.932771    0.899789    0.434716    0.459682    0.870592    0.845088    0.826854    0.808673    2800        20.277078   0.349383    0.024175    0.232576    191.084452 
[37m[36mINFO[0m[0m 02/15 07:59:26 | 0.433047    0.449409    0.873393    0.844172    0.433434    0.929607    0.912447    0.433047    0.449409    0.859257    0.819899    0.831315    0.800170    3000        21.725441   0.333225    0.023117    0.297648    176.578837 
[37m[36mINFO[0m[0m 02/15 08:03:35 | 0.380922    0.406266    0.876532    0.859328    0.408269    0.946217    0.927215    0.380922    0.406266    0.856738    0.846348    0.826641    0.804422    3200        23.173804   0.323175    0.021819    0.358574    178.017717 
[37m[36mINFO[0m[0m 02/15 08:07:42 | 0.405572    0.425270    0.897431    0.868492    0.389589    0.954126    0.927215    0.405572    0.425270    0.893892    0.857683    0.844274    0.820578    3400        24.622166   0.304127    0.022250    0.376294    171.051524 
[37m[36mINFO[0m[0m 02/15 08:11:54 | 0.370651    0.377504    0.888666    0.867957    0.394525    0.951226    0.944093    0.370651    0.377504    0.869647    0.840050    0.845124    0.819728    3600        26.070529   0.297356    0.021766    0.325025    187.689327 
[37m[36mINFO[0m[0m 02/15 08:16:03 | 0.413789    0.434515    0.885920    0.850239    0.442447    0.947799    0.922996    0.413789    0.434515    0.863350    0.819899    0.846611    0.807823    3800        27.518892   0.288187    0.021780    0.236119    200.971164 
[37m[36mINFO[0m[0m 02/15 08:20:21 | 0.378354    0.400616    0.897271    0.882740    0.347080    0.957553    0.934599    0.378354    0.400616    0.883186    0.885390    0.851073    0.828231    4000        28.967254   0.269179    0.021182    0.301305    197.821930 
[37m[36mINFO[0m[0m 02/15 08:24:21 | 0.434074    0.455059    0.909765    0.877157    0.362851    0.946744    0.915612    0.434074    0.455059    0.912783    0.876574    0.869768    0.839286    4200        30.415617   0.264927    0.020899    0.247939    190.915630 
[37m[36mINFO[0m[0m 02/15 08:28:30 | 0.432148    0.446328    0.914910    0.880085    0.336782    0.960717    0.938819    0.432148    0.446328    0.906171    0.874055    0.877842    0.827381    4400        31.863980   0.244490    0.020872    0.278598    193.464821 
[37m[36mINFO[0m[0m 02/15 08:32:56 | 0.433047    0.453005    0.924697    0.893626    0.310295    0.969681    0.943038    0.433047    0.453005    0.914673    0.886650    0.889739    0.851190    4600        33.312343   0.237757    0.020078    0.332242    198.877337 
[37m[36mINFO[0m[0m 02/15 08:37:20 | 0.355758    0.383667    0.906954    0.876658    0.367284    0.958344    0.933544    0.355758    0.383667    0.891688    0.866499    0.870831    0.829932    4800        34.760705   0.250632    0.019120    0.309573    202.105352 
[37m[36mINFO[0m[0m 02/15 08:42:10 | 0.379124    0.404725    0.926339    0.892198    0.314410    0.969417    0.945148    0.379124    0.404725    0.924748    0.887909    0.884852    0.843537    5000        36.209068   0.220335    0.019488    0.335472    223.009223 
[37m[36mINFO[0m[0m 02/15 08:42:10 | Cumulative gradient change saved at train_output/TerraIncognita/CORAL/[1]/250215_06-51-42_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/15 08:42:12 | ---
[37m[36mINFO[0m[0m 02/15 08:42:12 | test-domain validation(oracle) = 43.472%
[37m[36mINFO[0m[0m 02/15 08:42:12 | training-domain validation(iid) = 43.305%
[37m[36mINFO[0m[0m 02/15 08:42:12 | last = 37.912%
[37m[36mINFO[0m[0m 02/15 08:42:12 | last (inD) = 89.220%
[37m[36mINFO[0m[0m 02/15 08:42:12 | training-domain validation (iid, inD) = 89.363%
[37m[36mINFO[0m[0m 02/15 08:42:12 | === Summary ===
[37m[36mINFO[0m[0m 02/15 08:42:12 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 1 --dataset TerraIncognita --trial_seed 0 --hparams_seed 5
[37m[36mINFO[0m[0m 02/15 08:42:12 | Unique name: 250215_06-51-42_resnet50_GENIE
[37m[36mINFO[0m[0m 02/15 08:42:12 | Out path: train_output/TerraIncognita/CORAL/[1]/250215_06-51-42_resnet50_GENIE
[37m[36mINFO[0m[0m 02/15 08:42:12 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/15 08:42:12 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 02/19 12:59:56 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 1 --dataset TerraIncognita --trial_seed 1 --hparams_seed 7
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 7
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/CORAL/[1]/250219_12-59-56_resnet50_GENIE
	out_root: train_output/TerraIncognita/CORAL/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250219_12-59-56_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.00025471109765784857
	batch_size: 39
	weight_decay: 9.10622179414602e-05
	mmd_gamma: 8.495822994867268
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/19 12:59:56 | n_steps = 5001
[37m[36mINFO[0m[0m 02/19 12:59:56 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/19 12:59:56 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/19 12:59:56 | 
[37m[36mINFO[0m[0m 02/19 12:59:56 | Testenv name escaping te_L38 -> te_L38
[37m[36mINFO[0m[0m 02/19 12:59:56 | Test envs = [1], name = te_L38
[37m[36mINFO[0m[0m 02/19 12:59:56 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 02/19 12:59:56 | Batch sizes for each domain: [39, 0, 39, 39] (total=117)
[37m[36mINFO[0m[0m 02/19 12:59:56 | steps-per-epoch for each domain: 97.26, 81.44, 120.69 -> min = 81.44
[37m[36mINFO[0m[0m 02/19 12:59:58 | # of params = 23528522
[37m[36mINFO[0m[0m 02/19 13:02:41 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/19 13:02:41 | 0.019515    0.022085    0.286166    0.284145    2.068927    0.517005    0.541139    0.019515    0.022085    0.098237    0.094458    0.243255    0.216837    0           0.000000    2.453860    0.076150    1.452446    161.612147 
[37m[36mINFO[0m[0m 02/19 13:06:42 | 0.023366    0.026708    0.387090    0.397685    1.542644    0.538887    0.574895    0.023366    0.026708    0.262280    0.269521    0.360102    0.348639    200         2.455919    1.679193    0.004795    0.354513    170.123703 
[37m[36mINFO[0m[0m 02/19 13:10:26 | 0.026191    0.032357    0.499796    0.528559    1.379414    0.653836    0.689873    0.026191    0.032357    0.394521    0.435768    0.451030    0.460034    400         4.911839    1.479731    0.005981    0.309556    162.508237 
[37m[36mINFO[0m[0m 02/19 13:14:19 | 0.110027    0.117103    0.541442    0.559248    1.285723    0.702083    0.713080    0.110027    0.117103    0.465050    0.503778    0.457191    0.460884    600         7.367758    1.370562    0.006172    0.298941    173.309330 
[37m[36mINFO[0m[0m 02/19 13:18:07 | 0.384388    0.383154    0.566127    0.581321    1.202856    0.727656    0.736287    0.384388    0.383154    0.496537    0.531486    0.474187    0.476190    800         9.823678    1.269133    0.006310    0.298671    167.753224 
[37m[36mINFO[0m[0m 02/19 13:21:50 | 0.433175    0.432974    0.562903    0.571885    1.226031    0.719220    0.696203    0.433175    0.432974    0.501889    0.541562    0.467601    0.477891    1000        12.279597   1.193757    0.006234    0.294953    163.955195 
[37m[36mINFO[0m[0m 02/19 13:25:36 | 0.354474    0.349255    0.622534    0.617806    1.065923    0.711574    0.672996    0.354474    0.349255    0.624055    0.654912    0.531974    0.525510    1200        14.735516   1.113093    0.006175    0.309461    163.972272 
[37m[36mINFO[0m[0m 02/19 13:29:25 | 0.292977    0.300462    0.714188    0.704686    0.835401    0.820722    0.789030    0.292977    0.300462    0.685768    0.717884    0.636074    0.607143    1400        17.191436   0.926109    0.006857    0.325551    164.125443 
[37m[36mINFO[0m[0m 02/19 13:33:15 | 0.305559    0.298921    0.731251    0.737074    0.810317    0.822041    0.828059    0.305559    0.298921    0.707809    0.726700    0.663905    0.656463    1600        19.647355   0.803516    0.007019    0.339561    161.935894 
[37m[36mINFO[0m[0m 02/19 13:37:11 | 0.306586    0.324088    0.769962    0.766969    0.708228    0.868442    0.861814    0.306586    0.324088    0.730164    0.741814    0.711281    0.697279    1800        22.103275   0.741773    0.006998    0.337098    168.946565 
[37m[36mINFO[0m[0m 02/19 13:41:10 | 0.269739    0.280945    0.773339    0.768563    0.664747    0.860796    0.857595    0.269739    0.280945    0.753463    0.769521    0.705757    0.678571    2000        24.559194   0.656293    0.006821    0.310395    176.427343 
[37m[36mINFO[0m[0m 02/19 13:44:54 | 0.385544    0.384181    0.815641    0.803764    0.585799    0.890588    0.881857    0.385544    0.384181    0.795340    0.792191    0.760994    0.737245    2200        27.015113   0.601036    0.006526    0.297347    165.151091 
[37m[36mINFO[0m[0m 02/19 13:48:36 | 0.303377    0.310221    0.828252    0.800378    0.558927    0.899552    0.885021    0.303377    0.310221    0.814861    0.803526    0.770342    0.712585    2400        29.471033   0.556312    0.006289    0.300098    161.550695 
[37m[36mINFO[0m[0m 02/19 13:52:24 | 0.293234    0.296867    0.839045    0.823046    0.524417    0.914579    0.905063    0.293234    0.296867    0.820529    0.809824    0.782027    0.754252    2600        31.926952   0.522997    0.006000    0.295331    169.333141 
[37m[36mINFO[0m[0m 02/19 13:56:19 | 0.334318    0.338469    0.844621    0.815641    0.513957    0.885051    0.859705    0.334318    0.338469    0.851700    0.828715    0.797111    0.758503    2800        34.382872   0.460467    0.005832    0.324206    170.408973 
[37m[36mINFO[0m[0m 02/19 14:00:11 | 0.313519    0.321520    0.850790    0.834187    0.498540    0.923016    0.904008    0.313519    0.321520    0.835642    0.840050    0.793711    0.758503    3000        36.838791   0.433095    0.005611    0.341830    163.513022 
[37m[36mINFO[0m[0m 02/19 14:04:07 | 0.320965    0.323061    0.854222    0.831636    0.485624    0.921962    0.897679    0.320965    0.323061    0.845718    0.843829    0.794986    0.753401    3200        39.294710   0.426947    0.005268    0.325487    170.526102 
[37m[36mINFO[0m[0m 02/19 14:07:57 | 0.344075    0.355419    0.875191    0.856993    0.416928    0.937516    0.919831    0.344075    0.355419    0.865239    0.850126    0.822817    0.801020    3400        41.750630   0.393287    0.005182    0.314532    167.209496 
[37m[36mINFO[0m[0m 02/19 14:11:51 | 0.393375    0.394453    0.876274    0.863537    0.408374    0.928289    0.906118    0.393375    0.394453    0.861146    0.869018    0.839388    0.815476    3600        44.206549   0.359502    0.005141    0.302024    173.618356 
[37m[36mINFO[0m[0m 02/19 14:15:44 | 0.423161    0.426810    0.876108    0.844395    0.441166    0.943580    0.917722    0.423161    0.426810    0.866814    0.847607    0.817931    0.767857    3800        46.662469   0.360914    0.004888    0.290352    175.344688 
[37m[36mINFO[0m[0m 02/19 14:19:32 | 0.420465    0.425270    0.898140    0.882661    0.352756    0.945689    0.933544    0.420465    0.425270    0.889798    0.887909    0.858934    0.826531    4000        49.118388   0.347946    0.004710    0.314225    164.783843 
[37m[36mINFO[0m[0m 02/19 14:23:44 | 0.396200    0.398048    0.889965    0.863752    0.401874    0.940153    0.924051    0.396200    0.398048    0.879093    0.857683    0.850648    0.809524    4200        51.574307   0.333652    0.004730    0.344131    182.703818 
[37m[36mINFO[0m[0m 02/19 14:28:36 | 0.428938    0.438110    0.893457    0.859784    0.410441    0.957026    0.926160    0.428938    0.438110    0.880982    0.856423    0.842362    0.796769    4400        54.030227   0.316106    0.004537    0.398919    212.354282 
[37m[36mINFO[0m[0m 02/19 14:33:18 | 0.446142    0.456600    0.912419    0.879618    0.362227    0.955972    0.939873    0.446142    0.456600    0.912154    0.866499    0.869131    0.832483    4600        56.486146   0.306795    0.004550    0.355218    210.858865 
[37m[36mINFO[0m[0m 02/19 14:38:01 | 0.270510    0.281972    0.887119    0.857915    0.421505    0.944108    0.921941    0.270510    0.281972    0.884446    0.865239    0.832802    0.786565    4800        58.942065   0.291394    0.004456    0.358742    211.924829 
[37m[36mINFO[0m[0m 02/19 14:42:27 | 0.369752    0.365691    0.906677    0.878988    0.358440    0.949380    0.916667    0.369752    0.365691    0.904282    0.895466    0.866369    0.824830    5000        61.397985   0.282082    0.004421    0.357472    193.879637 
[37m[36mINFO[0m[0m 02/19 14:42:27 | Cumulative gradient change saved at train_output/TerraIncognita/CORAL/[1]/250219_12-59-56_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/19 14:42:28 | ---
[37m[36mINFO[0m[0m 02/19 14:42:28 | test-domain validation(oracle) = 44.614%
[37m[36mINFO[0m[0m 02/19 14:42:28 | training-domain validation(iid) = 42.046%
[37m[36mINFO[0m[0m 02/19 14:42:28 | last = 36.975%
[37m[36mINFO[0m[0m 02/19 14:42:28 | last (inD) = 87.899%
[37m[36mINFO[0m[0m 02/19 14:42:28 | training-domain validation (iid, inD) = 88.266%
[37m[36mINFO[0m[0m 02/19 14:42:28 | === Summary ===
[37m[36mINFO[0m[0m 02/19 14:42:28 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 1 --dataset TerraIncognita --trial_seed 1 --hparams_seed 7
[37m[36mINFO[0m[0m 02/19 14:42:28 | Unique name: 250219_12-59-56_resnet50_GENIE
[37m[36mINFO[0m[0m 02/19 14:42:28 | Out path: train_output/TerraIncognita/CORAL/[1]/250219_12-59-56_resnet50_GENIE
[37m[36mINFO[0m[0m 02/19 14:42:28 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/19 14:42:28 | Dataset: TerraIncognita

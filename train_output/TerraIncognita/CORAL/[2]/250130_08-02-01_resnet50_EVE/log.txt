[37m[36mINFO[0m[0m 01/30 08:02:01 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 2 --dataset TerraIncognita --trial_seed 2 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/TerraIncognita/CORAL/[2]/250130_08-02-01_resnet50_EVE
	out_root: train_output/TerraIncognita/CORAL/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 2
	unique_name: 250130_08-02-01_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: GENIE
	freeze_bn: False
	pretrained: True
	lr: 3.1159521264763664e-05
	batch_size: 11
	weight_decay: 1.4650833494643601e-05
	mmd_gamma: 0.310538435991174
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/30 08:02:01 | n_steps = 5001
[37m[36mINFO[0m[0m 01/30 08:02:01 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/30 08:02:01 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/30 08:02:01 | Target test envs = [[2]]
[37m[36mINFO[0m[0m 01/30 08:02:01 | 
[37m[36mINFO[0m[0m 01/30 08:02:01 | Testenv name escaping te_L43 -> te_L43
[37m[36mINFO[0m[0m 01/30 08:02:01 | Test envs = [2], name = te_L43
[37m[36mINFO[0m[0m 01/30 08:02:01 | Batch sizes for each domain: [11, 11, 0, 11] (total=33)
[37m[36mINFO[0m[0m 01/30 08:02:01 | steps-per-epoch for each domain: 344.82, 708.09, 427.91 -> min = 344.82
[37m[36mINFO[0m[0m 01/30 08:02:03 | # of params = 23528522
[37m[36mINFO[0m[0m 01/30 08:04:56 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 01/30 08:04:56 | 0.113665    0.112091    0.311447    0.332902    1.977903    0.519905    0.532700    0.200924    0.259373    0.113665    0.112091    0.213512    0.206633    0           0.000000    2.414771    0.162860    3.376406    170.437066 
[37m[36mINFO[0m[0m 01/30 08:08:48 | 0.220088    0.217884    0.504486    0.515073    1.309526    0.564197    0.585443    0.582360    0.576271    0.220088    0.217884    0.366900    0.383503    200         0.580016    1.513776    0.053269    0.293491    172.152269 
[37m[36mINFO[0m[0m 01/30 08:12:43 | 0.269521    0.261965    0.569007    0.562092    1.175618    0.698919    0.702532    0.593401    0.574730    0.269521    0.261965    0.414702    0.409014    400         1.160032    1.274158    0.072075    0.275708    179.860157 
[37m[36mINFO[0m[0m 01/30 08:16:40 | 0.338476    0.319899    0.578481    0.593473    1.110358    0.671500    0.727848    0.594428    0.567026    0.338476    0.319899    0.469513    0.485544    600         1.740047    1.198827    0.067308    0.228224    190.945073 
[37m[36mINFO[0m[0m 01/30 08:20:17 | 0.313602    0.302267    0.648296    0.643524    0.973135    0.778276    0.782700    0.643985    0.601952    0.313602    0.302267    0.522626    0.545918    800         2.320063    1.053474    0.075358    0.206593    175.464962 
[37m[36mINFO[0m[0m 01/30 08:24:10 | 0.333438    0.340050    0.688309    0.680760    0.888158    0.813340    0.795359    0.714726    0.715460    0.333438    0.340050    0.536860    0.531463    1000        2.900079    0.914913    0.079468    0.208596    190.740000 
[37m[36mINFO[0m[0m 01/30 08:28:00 | 0.436083    0.424433    0.737045    0.745683    0.742519    0.846032    0.839662    0.748363    0.759630    0.436083    0.424433    0.616741    0.637755    1200        3.480095    0.819096    0.077802    0.206603    187.690391 
[37m[36mINFO[0m[0m 01/30 08:31:41 | 0.444270    0.433249    0.748761    0.744042    0.723449    0.856314    0.834388    0.761330    0.761685    0.444270    0.433249    0.628638    0.636054    1400        4.060111    0.764392    0.074247    0.203994    180.746189 
[37m[36mINFO[0m[0m 01/30 08:35:24 | 0.433564    0.399244    0.767485    0.767326    0.675921    0.852096    0.824895    0.775196    0.775552    0.433564    0.399244    0.675165    0.701531    1600        4.640127    0.708711    0.070764    0.228113    176.992065 
[37m[36mINFO[0m[0m 01/30 08:39:16 | 0.489295    0.496222    0.780660    0.786765    0.647607    0.869496    0.852321    0.785210    0.791988    0.489295    0.496222    0.687274    0.715986    1800        5.220142    0.667399    0.069804    0.254461    180.352513 
[37m[36mINFO[0m[0m 01/30 08:42:50 | 0.473552    0.460957    0.775991    0.771390    0.633166    0.845769    0.835443    0.789832    0.792501    0.473552    0.460957    0.692373    0.686224    2000        5.800158    0.623339    0.070233    0.192775    175.101539 
[37m[36mINFO[0m[0m 01/30 08:46:37 | 0.468514    0.454660    0.775795    0.780773    0.626235    0.868969    0.858650    0.796636    0.794042    0.468514    0.454660    0.661780    0.689626    2200        6.380174    0.660462    0.060779    0.193879    188.812915 
[37m[36mINFO[0m[0m 01/30 08:50:26 | 0.445529    0.415617    0.807202    0.801353    0.561428    0.900343    0.874473    0.803184    0.794042    0.445529    0.415617    0.718079    0.735544    2400        6.960190    0.615039    0.062122    0.181562    192.310444 
[37m[36mINFO[0m[0m 01/30 08:54:14 | 0.447418    0.443325    0.789091    0.789129    0.628689    0.862114    0.839662    0.791116    0.795583    0.447418    0.443325    0.714043    0.732143    2600        7.540206    0.588737    0.060851    0.239401    179.751143 
[37m[36mINFO[0m[0m 01/30 08:57:56 | 0.459383    0.435768    0.799974    0.775021    0.634749    0.877406    0.836498    0.799974    0.763225    0.459383    0.435768    0.722541    0.725340    2800        8.120221    0.560161    0.057975    0.228364    176.487039 
[37m[36mINFO[0m[0m 01/30 09:01:50 | 0.375630    0.380353    0.805436    0.803310    0.561322    0.891642    0.869198    0.815509    0.782229    0.375630    0.380353    0.709157    0.758503    3000        8.700237    0.552686    0.056188    0.262940    181.580121 
[37m[36mINFO[0m[0m 01/30 09:05:30 | 0.465365    0.439547    0.813566    0.796555    0.573739    0.901134    0.868143    0.813198    0.808937    0.465365    0.439547    0.726365    0.712585    3200        9.280253    0.553773    0.055529    0.227655    174.291433 
[37m[36mINFO[0m[0m 01/30 09:09:22 | 0.509131    0.518892    0.828745    0.822111    0.492349    0.905879    0.868143    0.819361    0.829481    0.509131    0.518892    0.760994    0.768707    3400        9.860269    0.512512    0.056062    0.266351    178.665729 
[37m[36mINFO[0m[0m 01/30 09:13:16 | 0.486461    0.473552    0.840247    0.830879    0.476613    0.910888    0.885021    0.832713    0.815100    0.486461    0.473552    0.777140    0.792517    3600        10.440285   0.485797    0.055106    0.241314    185.739934 
[37m[36mINFO[0m[0m 01/30 09:16:59 | 0.531801    0.517632    0.839231    0.828487    0.494013    0.917743    0.887131    0.838105    0.825372    0.531801    0.517632    0.761844    0.772959    3800        11.020301   0.473249    0.054417    0.207710    180.201835 
[37m[36mINFO[0m[0m 01/30 09:20:44 | 0.509131    0.472292    0.832889    0.818144    0.518247    0.909307    0.877637    0.819232    0.808937    0.509131    0.472292    0.770130    0.767857    4000        11.600316   0.471744    0.050565    0.195156    186.549989 
[37m[36mINFO[0m[0m 01/30 09:24:32 | 0.481738    0.501259    0.843876    0.830627    0.489175    0.907988    0.881857    0.835666    0.819209    0.481738    0.501259    0.787975    0.790816    4200        12.180332   0.485314    0.048944    0.198306    187.759018 
[37m[36mINFO[0m[0m 01/30 09:28:18 | 0.509761    0.476071    0.822779    0.819053    0.518480    0.909307    0.891350    0.802285    0.819209    0.509761    0.476071    0.756745    0.746599    4400        12.760348   0.489397    0.048417    0.209691    184.062288 
[37m[36mINFO[0m[0m 01/30 09:32:06 | 0.545340    0.536524    0.850575    0.850249    0.430908    0.923807    0.901899    0.839517    0.852080    0.545340    0.536524    0.788400    0.796769    4600        13.340364   0.453250    0.050256    0.209614    186.529613 
[37m[36mINFO[0m[0m 01/30 09:35:48 | 0.537783    0.516373    0.843895    0.840990    0.447414    0.908516    0.886076    0.829246    0.844376    0.537783    0.516373    0.793924    0.792517    4800        13.920380   0.451956    0.049117    0.192231    182.700674 
[37m[36mINFO[0m[0m 01/30 09:39:39 | 0.489924    0.472292    0.852798    0.849658    0.443209    0.923280    0.895570    0.841828    0.846430    0.489924    0.472292    0.793287    0.806973    5000        14.500395   0.422994    0.048038    0.222099    186.900994 
[37m[36mINFO[0m[0m 01/30 09:39:39 | Cumulative gradient change saved at train_output/TerraIncognita/CORAL/[2]/250130_08-02-01_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/30 09:39:40 | ---
[37m[36mINFO[0m[0m 01/30 09:39:40 | test-domain validation(oracle) = 54.534%
[37m[36mINFO[0m[0m 01/30 09:39:40 | training-domain validation(iid) = 54.534%
[37m[36mINFO[0m[0m 01/30 09:39:40 | last = 48.992%
[37m[36mINFO[0m[0m 01/30 09:39:40 | last (inD) = 84.966%
[37m[36mINFO[0m[0m 01/30 09:39:40 | training-domain validation (iid, inD) = 85.025%
[37m[36mINFO[0m[0m 01/30 09:39:40 | === Summary ===
[37m[36mINFO[0m[0m 01/30 09:39:40 | Command: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm CORAL --test_envs 2 --dataset TerraIncognita --trial_seed 2 --hparams_seed 1
[37m[36mINFO[0m[0m 01/30 09:39:40 | Unique name: 250130_08-02-01_resnet50_EVE
[37m[36mINFO[0m[0m 01/30 09:39:40 | Out path: train_output/TerraIncognita/CORAL/[2]/250130_08-02-01_resnet50_EVE
[37m[36mINFO[0m[0m 01/30 09:39:40 | Algorithm: CORAL
[37m[36mINFO[0m[0m 01/30 09:39:40 | Dataset: TerraIncognita
[37m[36mINFO[0m[0m 01/30 09:39:40 | Max test_in: 0.5453

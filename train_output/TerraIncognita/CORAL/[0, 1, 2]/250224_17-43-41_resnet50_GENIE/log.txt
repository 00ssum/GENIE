[37m[36mINFO[0m[0m 02/24 17:43:41 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 2 --hparams_seed 11
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 11
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/CORAL/[0, 1, 2]/250224_17-43-41_resnet50_GENIE
	out_root: train_output/TerraIncognita/CORAL/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 2
	unique_name: 250224_17-43-41_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.00030079935666912124
	batch_size: 16
	weight_decay: 6.276702207693199e-06
	mmd_gamma: 5.291098002392549
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/24 17:43:41 | n_steps = 5001
[37m[36mINFO[0m[0m 02/24 17:43:41 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/24 17:43:41 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/24 17:43:41 | 
[37m[36mINFO[0m[0m 02/24 17:43:41 | Testenv name escaping te_L100_L38_L43 -> te_L100_L38_L43
[37m[36mINFO[0m[0m 02/24 17:43:41 | Test envs = [0, 1, 2], name = te_L100_L38_L43
[37m[36mINFO[0m[0m 02/24 17:43:41 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 02/24 17:43:41 | Batch sizes for each domain: [0, 0, 0, 16] (total=16)
[37m[36mINFO[0m[0m 02/24 17:43:41 | steps-per-epoch for each domain: 294.19 -> min = 294.19
[37m[36mINFO[0m[0m 02/24 17:43:42 | # of params = 23528522
[37m[36mINFO[0m[0m 02/24 17:46:34 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/24 17:46:34 | 0.280680    0.266267    0.289781    0.281463    2.114433    0.203533    0.197257    0.442034    0.422702    0.196474    0.178841    0.289781    0.281463    0           0.000000    2.637231    0.000000    1.041967    170.413219 
[37m[36mINFO[0m[0m 02/24 17:49:51 | 0.336320    0.321086    0.433397    0.430272    1.446401    0.233061    0.231013    0.438054    0.421161    0.337846    0.311083    0.433397    0.430272    200         0.679839    1.555289    0.000000    0.157770    166.000567 
[37m[36mINFO[0m[0m 02/24 17:53:18 | 0.331142    0.317064    0.463990    0.483844    1.375050    0.233061    0.227848    0.448966    0.429892    0.311398    0.293451    0.463990    0.483844    400         1.359677    1.457590    0.000000    0.156140    175.269012 
[37m[36mINFO[0m[0m 02/24 17:56:35 | 0.284631    0.273677    0.477799    0.475340    1.381326    0.210651    0.212025    0.346643    0.325629    0.296599    0.283375    0.477799    0.475340    600         2.039516    1.393419    0.000000    0.148164    167.654481 
[37m[36mINFO[0m[0m 02/24 17:59:55 | 0.334513    0.319426    0.446356    0.467687    1.350475    0.193514    0.186709    0.441007    0.422702    0.369018    0.348866    0.446356    0.467687    800         2.719354    1.358495    0.000000    0.123984    175.678012 
[37m[36mINFO[0m[0m 02/24 18:03:05 | 0.346401    0.332202    0.597196    0.590986    1.073764    0.189032    0.191983    0.475799    0.451977    0.374370    0.352645    0.597196    0.590986    1000        3.399193    1.211816    0.000000    0.128883    163.349970 
[37m[36mINFO[0m[0m 02/24 18:06:17 | 0.338598    0.326343    0.606331    0.600340    1.007997    0.198260    0.196203    0.398767    0.392399    0.418766    0.390428    0.606331    0.600340    1200        4.079031    1.115674    0.000000    0.129320    166.728541 
[37m[36mINFO[0m[0m 02/24 18:09:22 | 0.324029    0.315952    0.639473    0.662415    0.976521    0.396784    0.416667    0.237771    0.221366    0.337531    0.309824    0.639473    0.662415    1400        4.758870    1.017873    0.000000    0.153494    153.654881 
[37m[36mINFO[0m[0m 02/24 18:12:34 | 0.329761    0.320273    0.671978    0.686224    0.884230    0.311363    0.316456    0.285916    0.277863    0.392003    0.366499    0.671978    0.686224    1600        5.438708    0.967458    0.000000    0.156593    161.610281 
[37m[36mINFO[0m[0m 02/24 18:15:48 | 0.365963    0.351529    0.704908    0.713435    0.858088    0.368310    0.376582    0.353319    0.337956    0.376259    0.340050    0.704908    0.713435    1800        6.118547    0.911985    0.000000    0.136488    165.869478 
[37m[36mINFO[0m[0m 02/24 18:18:55 | 0.300218    0.295489    0.738050    0.762755    0.753354    0.215924    0.252110    0.273206    0.255265    0.411524    0.379093    0.738050    0.762755    2000        6.798385    0.816021    0.000000    0.129617    161.760986 
[37m[36mINFO[0m[0m 02/24 18:21:57 | 0.390078    0.382165    0.731039    0.726190    0.790832    0.427630    0.440928    0.339581    0.330252    0.403023    0.375315    0.731039    0.726190    2200        7.478224    0.799621    0.000000    0.132247    155.298977 
[37m[36mINFO[0m[0m 02/24 18:25:06 | 0.287701    0.283289    0.740174    0.750000    0.774943    0.304508    0.325949    0.143921    0.130971    0.414673    0.392947    0.740174    0.750000    2400        8.158062    0.746957    0.000000    0.143207    159.978419 
[37m[36mINFO[0m[0m 02/24 18:28:06 | 0.265337    0.255644    0.734226    0.730442    0.802620    0.155813    0.172996    0.289126    0.275295    0.351071    0.318640    0.734226    0.730442    2600        8.837901    0.759806    0.000000    0.120170    156.724268 
[37m[36mINFO[0m[0m 02/24 18:31:11 | 0.320790    0.316461    0.755471    0.774660    0.682661    0.239125    0.251055    0.324945    0.320493    0.398300    0.377834    0.755471    0.774660    2800        9.517740    0.684365    0.000000    0.125679    159.035763 
[37m[36mINFO[0m[0m 02/24 18:34:15 | 0.343514    0.329180    0.734651    0.755102    0.722373    0.278408    0.290084    0.300937    0.288136    0.451196    0.409320    0.734651    0.755102    3000        10.197578   0.744998    0.000000    0.116628    160.873043 
[37m[36mINFO[0m[0m 02/24 18:37:23 | 0.201537    0.198788    0.763756    0.776361    0.686896    0.115212    0.114979    0.094877    0.093477    0.394521    0.387909    0.763756    0.776361    3200        10.877417   0.673920    0.000000    0.119941    163.738591 
[37m[36mINFO[0m[0m 02/24 18:40:27 | 0.258512    0.257575    0.752709    0.751701    0.711278    0.140522    0.157173    0.254975    0.246533    0.380038    0.369018    0.752709    0.751701    3400        11.557255   0.679259    0.000000    0.133415    158.112304 
[37m[36mINFO[0m[0m 02/24 18:43:37 | 0.359676    0.350387    0.786063    0.784014    0.655406    0.204060    0.213080    0.385672    0.370827    0.489295    0.467254    0.786063    0.784014    3600        12.237094   0.685579    0.000000    0.132857    162.601641 
[37m[36mINFO[0m[0m 02/24 18:46:47 | 0.287819    0.276689    0.790312    0.804422    0.658840    0.104403    0.091772    0.267557    0.263482    0.491499    0.474811    0.790312    0.804422    3800        12.916932   0.618918    0.000000    0.142147    161.729228 
[37m[36mINFO[0m[0m 02/24 18:49:49 | 0.315085    0.305499    0.767155    0.775510    0.671634    0.155286    0.154008    0.346643    0.343092    0.443325    0.419395    0.767155    0.775510    4000        13.596771   0.600432    0.000000    0.147001    152.857711 
[37m[36mINFO[0m[0m 02/24 18:53:03 | 0.399269    0.387168    0.790100    0.782313    0.657305    0.291062    0.295359    0.414302    0.402671    0.492443    0.463476    0.790100    0.782313    4200        14.276609   0.573656    0.000000    0.155289    162.826165 
[37m[36mINFO[0m[0m 02/24 18:56:22 | 0.278966    0.273609    0.796473    0.789966    0.649722    0.096494    0.089662    0.263705    0.272727    0.476700    0.458438    0.796473    0.789966    4400        14.956448   0.566293    0.000000    0.161417    167.206136 
[37m[36mINFO[0m[0m 02/24 18:59:30 | 0.368721    0.357297    0.809433    0.787415    0.676990    0.221988    0.208861    0.409680    0.410889    0.474496    0.452141    0.809433    0.787415    4600        15.636286   0.539812    0.000000    0.123394    162.987040 
[37m[36mINFO[0m[0m 02/24 19:02:44 | 0.325910    0.322886    0.796261    0.795918    0.594417    0.283417    0.291139    0.230838    0.220339    0.463476    0.457179    0.796261    0.795918    4800        16.316125   0.581197    0.000000    0.131051    167.442494 
[37m[36mINFO[0m[0m 02/24 19:05:51 | 0.303379    0.292195    0.747822    0.740646    0.812386    0.289481    0.293249    0.172294    0.168978    0.448363    0.414358    0.747822    0.740646    5000        16.995963   0.515952    0.000000    0.119256    163.745561 
[37m[36mINFO[0m[0m 02/24 19:05:51 | Cumulative gradient change saved at train_output/TerraIncognita/CORAL/[0, 1, 2]/250224_17-43-41_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/24 19:05:53 | ---
[37m[36mINFO[0m[0m 02/24 19:05:53 | test-domain validation(oracle) = 39.927%
[37m[36mINFO[0m[0m 02/24 19:05:53 | training-domain validation(iid) = 28.782%
[37m[36mINFO[0m[0m 02/24 19:05:53 | last = 30.338%
[37m[36mINFO[0m[0m 02/24 19:05:53 | last (inD) = 74.065%
[37m[36mINFO[0m[0m 02/24 19:05:53 | training-domain validation (iid, inD) = 80.442%
[37m[36mINFO[0m[0m 02/24 19:05:53 | === Summary ===
[37m[36mINFO[0m[0m 02/24 19:05:53 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 2 --hparams_seed 11
[37m[36mINFO[0m[0m 02/24 19:05:53 | Unique name: 250224_17-43-41_resnet50_GENIE
[37m[36mINFO[0m[0m 02/24 19:05:53 | Out path: train_output/TerraIncognita/CORAL/[0, 1, 2]/250224_17-43-41_resnet50_GENIE
[37m[36mINFO[0m[0m 02/24 19:05:53 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/24 19:05:53 | Dataset: TerraIncognita

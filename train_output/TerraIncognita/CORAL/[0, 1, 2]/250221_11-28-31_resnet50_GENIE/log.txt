[37m[36mINFO[0m[0m 02/21 11:28:31 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 0 --hparams_seed 0
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/CORAL/[0, 1, 2]/250221_11-28-31_resnet50_GENIE
	out_root: train_output/TerraIncognita/CORAL/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 0
	unique_name: 250221_11-28-31_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	mmd_gamma: 1.0
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/21 11:28:31 | n_steps = 5001
[37m[36mINFO[0m[0m 02/21 11:28:31 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/21 11:28:31 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/21 11:28:31 | 
[37m[36mINFO[0m[0m 02/21 11:28:31 | Testenv name escaping te_L100_L38_L43 -> te_L100_L38_L43
[37m[36mINFO[0m[0m 02/21 11:28:31 | Test envs = [0, 1, 2], name = te_L100_L38_L43
[37m[36mINFO[0m[0m 02/21 11:28:31 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 02/21 11:28:31 | Batch sizes for each domain: [0, 0, 0, 32] (total=32)
[37m[36mINFO[0m[0m 02/21 11:28:31 | steps-per-epoch for each domain: 147.09 -> min = 147.09
[37m[36mINFO[0m[0m 02/21 11:28:32 | # of params = 23528522
[37m[36mINFO[0m[0m 02/21 11:31:36 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/21 11:31:36 | 0.280848    0.303925    0.222222    0.210034    2.271557    0.200633    0.208861    0.455514    0.481253    0.186398    0.221662    0.222222    0.210034    0           0.000000    2.490531    0.000000    1.177972    181.962515 
[37m[36mINFO[0m[0m 02/21 11:35:34 | 0.330728    0.355411    0.464415    0.473639    1.379819    0.225679    0.233122    0.414174    0.440164    0.352330    0.392947    0.464415    0.473639    200         1.359677    1.544786    0.000000    0.308001    176.437360 
[37m[36mINFO[0m[0m 02/21 11:39:29 | 0.291815    0.300472    0.485447    0.482143    1.340568    0.142368    0.161392    0.451277    0.459168    0.281801    0.280856    0.485447    0.482143    400         2.719354    1.381474    0.000000    0.296509    175.951677 
[37m[36mINFO[0m[0m 02/21 11:43:21 | 0.337560    0.351403    0.571489    0.579082    1.176192    0.325336    0.370253    0.414045    0.411916    0.273300    0.272040    0.571489    0.579082    600         4.079031    1.248577    0.000000    0.299941    172.566612 
[37m[36mINFO[0m[0m 02/21 11:47:13 | 0.235865    0.246683    0.648396    0.681122    0.897092    0.129449    0.146624    0.182052    0.182845    0.396096    0.410579    0.648396    0.681122    800         5.438708    1.038737    0.000000    0.273346    176.475567 
[37m[36mINFO[0m[0m 02/21 11:51:02 | 0.324092    0.335639    0.703420    0.717687    0.792684    0.337727    0.360759    0.257029    0.253210    0.377519    0.392947    0.703420    0.717687    1000        6.798385    0.896466    0.000000    0.280016    173.878642 
[37m[36mINFO[0m[0m 02/21 11:54:59 | 0.345568    0.356422    0.747822    0.747449    0.739983    0.257316    0.280591    0.316857    0.316384    0.462531    0.472292    0.747822    0.747449    1200        8.158062    0.819850    0.000000    0.277658    181.236073 
[37m[36mINFO[0m[0m 02/21 11:58:56 | 0.215567    0.209107    0.734438    0.742347    0.701423    0.092012    0.088608    0.147259    0.140729    0.407431    0.397985    0.734438    0.742347    1400        9.517740    0.704530    0.000000    0.273241    181.963734 
[37m[36mINFO[0m[0m 02/21 12:02:44 | 0.479670    0.503421    0.776716    0.775510    0.660809    0.475086    0.513713    0.444088    0.477658    0.519836    0.518892    0.776716    0.775510    1600        10.877417   0.662880    0.000000    0.275258    173.051839 
[37m[36mINFO[0m[0m 02/21 12:06:28 | 0.352450    0.370135    0.794561    0.783163    0.583463    0.283944    0.298523    0.273719    0.291731    0.499685    0.520151    0.794561    0.783163    1800        12.237094   0.656973    0.000000    0.269904    169.689415 
[37m[36mINFO[0m[0m 02/21 12:10:23 | 0.308679    0.331039    0.797111    0.799320    0.604748    0.129713    0.160338    0.280267    0.291217    0.516058    0.541562    0.797111    0.799320    2000        13.596771   0.601250    0.000000    0.300331    175.421590 
[37m[36mINFO[0m[0m 02/21 12:14:19 | 0.291160    0.304848    0.786913    0.784864    0.615102    0.145531    0.148734    0.287457    0.306112    0.440491    0.459698    0.786913    0.784864    2200        14.956448   0.542971    0.000000    0.303778    175.368839 
[37m[36mINFO[0m[0m 02/21 12:18:16 | 0.402115    0.425436    0.834289    0.821429    0.510949    0.366992    0.387131    0.317627    0.342578    0.521725    0.546599    0.834289    0.821429    2400        16.316125   0.516754    0.000000    0.247952    186.906964 
[37m[36mINFO[0m[0m 02/21 12:22:02 | 0.401643    0.402115    0.816231    0.779762    0.619467    0.388083    0.395570    0.346129    0.352337    0.470718    0.458438    0.816231    0.779762    2600        17.675802   0.496122    0.000000    0.253550    175.885602 
[37m[36mINFO[0m[0m 02/21 12:25:56 | 0.452998    0.463072    0.813257    0.816327    0.600661    0.497759    0.506329    0.378868    0.395480    0.482368    0.487406    0.813257    0.816327    2800        19.035479   0.500887    0.000000    0.255788    182.553910 
[37m[36mINFO[0m[0m 02/21 12:29:43 | 0.352493    0.366055    0.837264    0.811224    0.545239    0.272344    0.281646    0.287970    0.310221    0.497166    0.506297    0.837264    0.811224    3000        20.395156   0.487922    0.000000    0.231500    180.663328 
[37m[36mINFO[0m[0m 02/21 12:33:31 | 0.363710    0.372530    0.854472    0.839286    0.454850    0.285526    0.308017    0.317884    0.315871    0.487720    0.493703    0.854472    0.839286    3200        21.754833   0.444080    0.000000    0.280412    172.141025 
[37m[36mINFO[0m[0m 02/21 12:37:35 | 0.406074    0.429722    0.843425    0.819728    0.543684    0.371210    0.395570    0.356143    0.375963    0.490869    0.517632    0.843425    0.819728    3400        23.114510   0.429929    0.000000    0.306973    182.767732 
[37m[36mINFO[0m[0m 02/21 12:41:41 | 0.370639    0.397335    0.846824    0.830782    0.512226    0.224888    0.241561    0.377584    0.411402    0.509446    0.539043    0.846824    0.830782    3600        24.474187   0.419777    0.000000    0.286359    188.157028 
[37m[36mINFO[0m[0m 02/21 12:45:48 | 0.321443    0.336079    0.843000    0.823129    0.523092    0.170050    0.196203    0.341507    0.352337    0.452771    0.459698    0.843000    0.823129    3800        25.833864   0.397836    0.000000    0.256276    196.215733 
[37m[36mINFO[0m[0m 02/21 12:49:57 | 0.352073    0.368445    0.868281    0.841837    0.494240    0.239125    0.251055    0.322763    0.335388    0.494332    0.518892    0.868281    0.841837    4000        27.193542   0.391084    0.000000    0.230737    202.406860 
[37m[36mINFO[0m[0m 02/21 12:54:06 | 0.328579    0.341127    0.860208    0.840136    0.483060    0.206433    0.224684    0.246245    0.260914    0.533060    0.537783    0.860208    0.840136    4200        28.553219   0.370457    0.000000    0.242302    200.798467 
[37m[36mINFO[0m[0m 02/21 12:58:09 | 0.349372    0.368948    0.874230    0.853741    0.462029    0.299499    0.324895    0.291437    0.307139    0.457179    0.474811    0.874230    0.853741    4400        29.912896   0.360447    0.000000    0.254677    191.881590 
[37m[36mINFO[0m[0m 02/21 13:02:18 | 0.362947    0.380185    0.874655    0.846088    0.461953    0.267335    0.292194    0.326229    0.342065    0.495277    0.506297    0.874655    0.846088    4600        31.272573   0.342823    0.000000    0.232916    202.185465 
[37m[36mINFO[0m[0m 02/21 13:06:14 | 0.404160    0.422790    0.861908    0.834184    0.491294    0.370419    0.385021    0.373861    0.393426    0.468199    0.489924    0.861908    0.834184    4800        32.632250   0.358781    0.000000    0.268397    182.119728 
[37m[36mINFO[0m[0m 02/21 13:10:04 | 0.349601    0.346850    0.889951    0.855442    0.432284    0.264698    0.262658    0.309924    0.305598    0.474181    0.472292    0.889951    0.855442    5000        33.991927   0.342047    0.000000    0.273119    175.955241 
[37m[36mINFO[0m[0m 02/21 13:10:04 | Cumulative gradient change saved at train_output/TerraIncognita/CORAL/[0, 1, 2]/250221_11-28-31_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/21 13:10:06 | ---
[37m[36mINFO[0m[0m 02/21 13:10:06 | test-domain validation(oracle) = 47.967%
[37m[36mINFO[0m[0m 02/21 13:10:06 | training-domain validation(iid) = 34.960%
[37m[36mINFO[0m[0m 02/21 13:10:06 | last = 34.960%
[37m[36mINFO[0m[0m 02/21 13:10:06 | last (inD) = 85.544%
[37m[36mINFO[0m[0m 02/21 13:10:06 | training-domain validation (iid, inD) = 85.544%
[37m[36mINFO[0m[0m 02/21 13:10:06 | === Summary ===
[37m[36mINFO[0m[0m 02/21 13:10:06 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 0 --hparams_seed 0
[37m[36mINFO[0m[0m 02/21 13:10:06 | Unique name: 250221_11-28-31_resnet50_GENIE
[37m[36mINFO[0m[0m 02/21 13:10:06 | Out path: train_output/TerraIncognita/CORAL/[0, 1, 2]/250221_11-28-31_resnet50_GENIE
[37m[36mINFO[0m[0m 02/21 13:10:06 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/21 13:10:06 | Dataset: TerraIncognita

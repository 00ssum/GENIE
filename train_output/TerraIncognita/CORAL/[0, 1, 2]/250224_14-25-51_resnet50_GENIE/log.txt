[37m[36mINFO[0m[0m 02/24 14:25:51 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 2 --hparams_seed 9
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 9
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/CORAL/[0, 1, 2]/250224_14-25-51_resnet50_GENIE
	out_root: train_output/TerraIncognita/CORAL/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 2
	unique_name: 250224_14-25-51_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.716671579524612e-05
	batch_size: 29
	weight_decay: 1.71368232883332e-06
	mmd_gamma: 1.254370045611671
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/24 14:25:51 | n_steps = 5001
[37m[36mINFO[0m[0m 02/24 14:25:51 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/24 14:25:51 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/24 14:25:51 | 
[37m[36mINFO[0m[0m 02/24 14:25:51 | Testenv name escaping te_L100_L38_L43 -> te_L100_L38_L43
[37m[36mINFO[0m[0m 02/24 14:25:51 | Test envs = [0, 1, 2], name = te_L100_L38_L43
[37m[36mINFO[0m[0m 02/24 14:25:51 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 02/24 14:25:51 | Batch sizes for each domain: [0, 0, 0, 29] (total=29)
[37m[36mINFO[0m[0m 02/24 14:25:51 | steps-per-epoch for each domain: 162.31 -> min = 162.31
[37m[36mINFO[0m[0m 02/24 14:25:52 | # of params = 23528522
[37m[36mINFO[0m[0m 02/24 14:28:57 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/24 14:28:57 | 0.288403    0.273706    0.223709    0.207483    2.173522    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.223709    0.207483    0           0.000000    2.460340    0.000000    1.190504    183.729282 
[37m[36mINFO[0m[0m 02/24 14:32:39 | 0.201382    0.193237    0.443170    0.445578    1.411805    0.223306    0.222574    0.078572    0.063688    0.302267    0.293451    0.443170    0.445578    200         1.232207    1.503387    0.000000    0.205995    180.962219 
[37m[36mINFO[0m[0m 02/24 14:36:39 | 0.227548    0.222622    0.487784    0.500850    1.377912    0.258634    0.250000    0.120169    0.104263    0.303841    0.313602    0.487784    0.500850    400         2.464415    1.357260    0.000000    0.317012    176.219234 
[37m[36mINFO[0m[0m 02/24 14:40:31 | 0.355817    0.349463    0.618228    0.617347    1.052151    0.284999    0.295359    0.408396    0.401644    0.374055    0.351385    0.618228    0.617347    600         3.696622    1.110016    0.000000    0.224501    187.500729 
[37m[36mINFO[0m[0m 02/24 14:44:11 | 0.378661    0.363800    0.670278    0.693027    0.841351    0.341155    0.366034    0.383618    0.351310    0.411209    0.374055    0.670278    0.693027    800         4.928829    0.962310    0.000000    0.215907    176.383089 
[37m[36mINFO[0m[0m 02/24 14:48:00 | 0.224177    0.213241    0.699384    0.718537    0.841675    0.075666    0.068565    0.169598    0.164355    0.427267    0.406801    0.699384    0.718537    1000        6.161037    0.843294    0.000000    0.214494    186.233159 
[37m[36mINFO[0m[0m 02/24 14:52:08 | 0.439105    0.438220    0.732101    0.747449    0.800155    0.382547    0.412447    0.470664    0.457627    0.464106    0.444584    0.732101    0.747449    1200        7.393244    0.749105    0.000000    0.312321    185.796146 
[37m[36mINFO[0m[0m 02/24 14:56:00 | 0.385085    0.377526    0.744211    0.767007    0.743989    0.345637    0.347046    0.307100    0.296867    0.502519    0.488665    0.744211    0.767007    1400        8.625451    0.776424    0.000000    0.218108    188.247394 
[37m[36mINFO[0m[0m 02/24 14:59:56 | 0.366108    0.353990    0.770767    0.786565    0.657070    0.185869    0.181435    0.383490    0.378017    0.528967    0.502519    0.770767    0.786565    1600        9.857659    0.655499    0.000000    0.205615    194.959643 
[37m[36mINFO[0m[0m 02/24 15:04:06 | 0.350691    0.347019    0.792649    0.778061    0.727905    0.167414    0.171941    0.388753    0.386749    0.495907    0.482368    0.792649    0.778061    1800        11.089866   0.578491    0.000000    0.267309    196.245514 
[37m[36mINFO[0m[0m 02/24 15:07:52 | 0.395120    0.389194    0.804546    0.812075    0.594005    0.334827    0.348101    0.339196    0.333333    0.511335    0.486146    0.804546    0.812075    2000        12.322074   0.599856    0.000000    0.246076    177.329531 
[37m[36mINFO[0m[0m 02/24 15:11:38 | 0.300906    0.293334    0.793074    0.766156    0.651654    0.156604    0.166667    0.269097    0.262455    0.477015    0.450882    0.793074    0.766156    2200        13.554281   0.593027    0.000000    0.218692    182.491962 
[37m[36mINFO[0m[0m 02/24 15:15:32 | 0.302525    0.304178    0.831315    0.808673    0.601724    0.156077    0.174051    0.224419    0.220853    0.527078    0.517632    0.831315    0.808673    2400        14.786488   0.540070    0.000000    0.217533    190.534762 
[37m[36mINFO[0m[0m 02/24 15:19:15 | 0.321711    0.314023    0.823454    0.817177    0.608974    0.215397    0.222574    0.224547    0.215716    0.525189    0.503778    0.823454    0.817177    2600        16.018696   0.518148    0.000000    0.226696    177.656627 
[37m[36mINFO[0m[0m 02/24 15:23:24 | 0.356981    0.356622    0.827279    0.811224    0.568323    0.240179    0.248945    0.336115    0.329738    0.494647    0.491184    0.827279    0.811224    2800        17.250903   0.520535    0.000000    0.262820    195.610808 
[37m[36mINFO[0m[0m 02/24 15:27:13 | 0.322629    0.327557    0.808583    0.790816    0.644712    0.208542    0.235232    0.279497    0.267591    0.479849    0.479849    0.808583    0.790816    3000        18.483110   0.498095    0.000000    0.199101    189.657936 
[37m[36mINFO[0m[0m 02/24 15:31:04 | 0.342731    0.338154    0.840663    0.830782    0.578427    0.225152    0.234177    0.279112    0.272727    0.523929    0.507557    0.840663    0.830782    3200        19.715318   0.484158    0.000000    0.240635    182.864394 
[37m[36mINFO[0m[0m 02/24 15:34:58 | 0.282711    0.281569    0.820268    0.789966    0.609882    0.128922    0.132911    0.258570    0.260914    0.460642    0.450882    0.820268    0.789966    3400        20.947525   0.459535    0.000000    0.245371    184.368882 
[37m[36mINFO[0m[0m 02/24 15:38:56 | 0.387045    0.368541    0.829191    0.805272    0.551799    0.245979    0.247890    0.402876    0.384181    0.512280    0.473552    0.829191    0.805272    3600        22.179732   0.457372    0.000000    0.273843    183.607224 
[37m[36mINFO[0m[0m 02/24 15:42:46 | 0.355008    0.343878    0.855959    0.820578    0.542789    0.226206    0.238397    0.306073    0.304571    0.532746    0.488665    0.855959    0.820578    3800        23.411940   0.449201    0.000000    0.222171    185.782768 
[37m[36mINFO[0m[0m 02/24 15:46:45 | 0.298538    0.302429    0.831740    0.813776    0.570982    0.122594    0.143460    0.286558    0.281459    0.486461    0.482368    0.831740    0.813776    4000        24.644147   0.378932    0.000000    0.248657    189.030568 
[37m[36mINFO[0m[0m 02/24 15:50:31 | 0.374750    0.367226    0.865732    0.840136    0.513731    0.212760    0.218354    0.372448    0.365691    0.539043    0.517632    0.865732    0.840136    4200        25.876354   0.442692    0.000000    0.215899    183.079075 
[37m[36mINFO[0m[0m 02/24 15:54:22 | 0.324452    0.322727    0.858721    0.840136    0.535278    0.167414    0.182489    0.315702    0.318439    0.490239    0.467254    0.858721    0.840136    4400        27.108562   0.392322    0.000000    0.248090    181.311041 
[37m[36mINFO[0m[0m 02/24 15:58:12 | 0.370030    0.360033    0.868069    0.833333    0.515869    0.240707    0.248945    0.320580    0.298408    0.548804    0.532746    0.868069    0.833333    4600        28.340769   0.387213    0.000000    0.212243    187.066449 
[37m[36mINFO[0m[0m 02/24 16:02:06 | 0.278525    0.272835    0.879966    0.842687    0.470714    0.083048    0.090717    0.268584    0.254237    0.483942    0.473552    0.879966    0.842687    4800        29.572976   0.369277    0.000000    0.283658    177.073930 
[37m[36mINFO[0m[0m 02/24 16:06:04 | 0.397827    0.386982    0.880816    0.861395    0.476899    0.272607    0.278481    0.352548    0.347201    0.568325    0.535264    0.880816    0.861395    5000        30.805184   0.340073    0.000000    0.260319    186.266386 
[37m[36mINFO[0m[0m 02/24 16:06:04 | Cumulative gradient change saved at train_output/TerraIncognita/CORAL/[0, 1, 2]/250224_14-25-51_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/24 16:06:10 | ---
[37m[36mINFO[0m[0m 02/24 16:06:10 | test-domain validation(oracle) = 43.911%
[37m[36mINFO[0m[0m 02/24 16:06:10 | training-domain validation(iid) = 39.783%
[37m[36mINFO[0m[0m 02/24 16:06:10 | last = 39.783%
[37m[36mINFO[0m[0m 02/24 16:06:10 | last (inD) = 86.139%
[37m[36mINFO[0m[0m 02/24 16:06:10 | training-domain validation (iid, inD) = 86.139%
[37m[36mINFO[0m[0m 02/24 16:06:10 | === Summary ===
[37m[36mINFO[0m[0m 02/24 16:06:10 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 2 --hparams_seed 9
[37m[36mINFO[0m[0m 02/24 16:06:10 | Unique name: 250224_14-25-51_resnet50_GENIE
[37m[36mINFO[0m[0m 02/24 16:06:10 | Out path: train_output/TerraIncognita/CORAL/[0, 1, 2]/250224_14-25-51_resnet50_GENIE
[37m[36mINFO[0m[0m 02/24 16:06:10 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/24 16:06:10 | Dataset: TerraIncognita

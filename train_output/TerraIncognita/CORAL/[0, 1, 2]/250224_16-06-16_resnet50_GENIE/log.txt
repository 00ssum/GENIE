[37m[36mINFO[0m[0m 02/24 16:06:16 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 2 --hparams_seed 10
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 10
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/CORAL/[0, 1, 2]/250224_16-06-16_resnet50_GENIE
	out_root: train_output/TerraIncognita/CORAL/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 2
	unique_name: 250224_16-06-16_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 7.494887873901297e-05
	batch_size: 23
	weight_decay: 0.000495139494108363
	mmd_gamma: 1.4713820315478223
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/24 16:06:16 | n_steps = 5001
[37m[36mINFO[0m[0m 02/24 16:06:16 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/24 16:06:16 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/24 16:06:16 | 
[37m[36mINFO[0m[0m 02/24 16:06:16 | Testenv name escaping te_L100_L38_L43 -> te_L100_L38_L43
[37m[36mINFO[0m[0m 02/24 16:06:16 | Test envs = [0, 1, 2], name = te_L100_L38_L43
[37m[36mINFO[0m[0m 02/24 16:06:16 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 02/24 16:06:16 | Batch sizes for each domain: [0, 0, 0, 23] (total=23)
[37m[36mINFO[0m[0m 02/24 16:06:16 | steps-per-epoch for each domain: 204.65 -> min = 204.65
[37m[36mINFO[0m[0m 02/24 16:06:17 | # of params = 23528522
[37m[36mINFO[0m[0m 02/24 16:09:24 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/24 16:09:24 | 0.288403    0.273706    0.247291    0.230442    2.109229    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.247291    0.230442    0           0.000000    2.672933    0.000000    1.326661    185.518295 
[37m[36mINFO[0m[0m 02/24 16:13:15 | 0.341359    0.326700    0.454430    0.482993    1.427241    0.220406    0.217300    0.444730    0.425270    0.358942    0.337531    0.454430    0.482993    200         0.977268    1.609352    0.000000    0.200639    190.698324 
[37m[36mINFO[0m[0m 02/24 16:17:08 | 0.275606    0.267112    0.450605    0.463435    1.391221    0.201951    0.199367    0.294261    0.287108    0.330605    0.314861    0.450605    0.463435    400         1.954536    1.451735    0.000000    0.196462    193.550418 
[37m[36mINFO[0m[0m 02/24 16:20:58 | 0.340892    0.325855    0.475250    0.489796    1.370163    0.226470    0.223629    0.442932    0.422702    0.353275    0.331234    0.475250    0.489796    600         2.931804    1.424369    0.000000    0.207269    188.253470 
[37m[36mINFO[0m[0m 02/24 16:24:35 | 0.307886    0.298618    0.489484    0.482993    1.314430    0.232534    0.231013    0.387598    0.373909    0.303526    0.290932    0.489484    0.482993    800         3.909072    1.394673    0.000000    0.178811    181.377629 
[37m[36mINFO[0m[0m 02/24 16:28:29 | 0.324916    0.311659    0.500956    0.501701    1.274041    0.213288    0.208861    0.420465    0.403698    0.340995    0.322418    0.500956    0.501701    1000        4.886339    1.338986    0.000000    0.191439    195.927513 
[37m[36mINFO[0m[0m 02/24 16:32:21 | 0.302177    0.289143    0.579562    0.561224    1.140119    0.134458    0.133966    0.395815    0.379558    0.376259    0.353904    0.579562    0.561224    1200        5.863607    1.267168    0.000000    0.197397    192.908369 
[37m[36mINFO[0m[0m 02/24 16:36:13 | 0.412569    0.415347    0.644147    0.654762    0.951077    0.464804    0.495781    0.330209    0.335901    0.442695    0.414358    0.644147    0.654762    1400        6.840875    1.097477    0.000000    0.221310    187.237091 
[37m[36mINFO[0m[0m 02/24 16:40:26 | 0.391463    0.398773    0.676439    0.695578    0.867869    0.389402    0.419831    0.346386    0.350796    0.438602    0.425693    0.676439    0.695578    1600        7.818143    0.940864    0.000000    0.269590    198.886319 
[37m[36mINFO[0m[0m 02/24 16:44:14 | 0.264534    0.250135    0.707032    0.717687    0.808675    0.111258    0.116034    0.280267    0.269132    0.402078    0.365239    0.707032    0.717687    1800        8.795411    0.857696    0.000000    0.223902    182.986947 
[37m[36mINFO[0m[0m 02/24 16:47:56 | 0.343402    0.330499    0.704908    0.729592    0.800744    0.225679    0.213080    0.327513    0.319979    0.477015    0.458438    0.704908    0.729592    2000        9.772679    0.818841    0.000000    0.192994    183.435063 
[37m[36mINFO[0m[0m 02/24 16:51:28 | 0.338789    0.341986    0.736350    0.756803    0.760372    0.304245    0.319620    0.216844    0.212635    0.495277    0.493703    0.736350    0.756803    2200        10.749947   0.791090    0.000000    0.179452    176.480759 
[37m[36mINFO[0m[0m 02/24 16:55:16 | 0.231155    0.220334    0.737412    0.750850    0.782316    0.077511    0.077004    0.183335    0.177196    0.432620    0.406801    0.737412    0.750850    2400        11.727215   0.758133    0.000000    0.208776    185.936072 
[37m[36mINFO[0m[0m 02/24 16:59:04 | 0.376159    0.381616    0.759507    0.752551    0.706644    0.260743    0.287975    0.369624    0.365691    0.498111    0.491184    0.759507    0.752551    2600        12.704483   0.717062    0.000000    0.212735    185.812947 
[37m[36mINFO[0m[0m 02/24 17:02:54 | 0.405951    0.395225    0.760569    0.734694    0.736027    0.292908    0.293249    0.437540    0.420134    0.487406    0.472292    0.760569    0.734694    2800        13.681751   0.685367    0.000000    0.206360    189.046476 
[37m[36mINFO[0m[0m 02/24 17:06:32 | 0.339024    0.340365    0.775866    0.786565    0.674142    0.277353    0.291139    0.263962    0.275295    0.475756    0.454660    0.775866    0.786565    3000        14.659018   0.647840    0.000000    0.159787    185.191171 
[37m[36mINFO[0m[0m 02/24 17:10:14 | 0.391228    0.375517    0.777140    0.778061    0.623797    0.308727    0.293249    0.409038    0.397535    0.455919    0.435768    0.777140    0.778061    3200        15.636286   0.634843    0.000000    0.161148    190.114060 
[37m[36mINFO[0m[0m 02/24 17:14:01 | 0.342922    0.337833    0.788400    0.806122    0.630131    0.370946    0.372363    0.182694    0.175141    0.475126    0.465995    0.788400    0.806122    3400        16.613554   0.624345    0.000000    0.168560    193.481990 
[37m[36mINFO[0m[0m 02/24 17:17:47 | 0.344784    0.336443    0.788825    0.791667    0.626488    0.288162    0.277426    0.306329    0.311248    0.439861    0.420655    0.788825    0.791667    3600        17.590822   0.627295    0.000000    0.208318    184.588163 
[37m[36mINFO[0m[0m 02/24 17:21:46 | 0.367790    0.361628    0.790312    0.786565    0.683862    0.399947    0.413502    0.246245    0.241911    0.457179    0.429471    0.790312    0.786565    3800        18.568090   0.563858    0.000000    0.241928    189.881802 
[37m[36mINFO[0m[0m 02/24 17:25:25 | 0.228202    0.231849    0.776078    0.802721    0.606336    0.133667    0.135021    0.125562    0.122239    0.425378    0.438287    0.776078    0.802721    4000        19.545358   0.580545    0.000000    0.232417    172.640018 
[37m[36mINFO[0m[0m 02/24 17:29:09 | 0.369339    0.359614    0.807946    0.807823    0.597151    0.323491    0.323840    0.325459    0.320493    0.459068    0.434509    0.807946    0.807823    4200        20.522626   0.571501    0.000000    0.177240    188.573705 
[37m[36mINFO[0m[0m 02/24 17:32:37 | 0.314672    0.303660    0.822180    0.807823    0.675710    0.196414    0.200422    0.238156    0.235747    0.509446    0.474811    0.822180    0.807823    4400        21.499894   0.539904    0.000000    0.155230    177.549289 
[37m[36mINFO[0m[0m 02/24 17:36:15 | 0.325644    0.323915    0.809008    0.789966    0.651062    0.185869    0.204641    0.304917    0.294813    0.486146    0.472292    0.809008    0.789966    4600        22.477162   0.518836    0.000000    0.169315    183.978814 
[37m[36mINFO[0m[0m 02/24 17:39:56 | 0.446707    0.441868    0.821755    0.805272    0.584412    0.415502    0.437764    0.410451    0.404212    0.514169    0.483627    0.821755    0.805272    4800        23.454430   0.515589    0.000000    0.181609    184.915828 
[37m[36mINFO[0m[0m 02/24 17:43:34 | 0.261712    0.259001    0.822605    0.812075    0.591924    0.095439    0.091772    0.190012    0.189009    0.499685    0.496222    0.822605    0.812075    5000        24.431697   0.488898    0.000000    0.194098    178.337182 
[37m[36mINFO[0m[0m 02/24 17:43:34 | Cumulative gradient change saved at train_output/TerraIncognita/CORAL/[0, 1, 2]/250224_16-06-16_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/24 17:43:35 | ---
[37m[36mINFO[0m[0m 02/24 17:43:35 | test-domain validation(oracle) = 44.671%
[37m[36mINFO[0m[0m 02/24 17:43:35 | training-domain validation(iid) = 26.171%
[37m[36mINFO[0m[0m 02/24 17:43:35 | last = 26.171%
[37m[36mINFO[0m[0m 02/24 17:43:35 | last (inD) = 81.207%
[37m[36mINFO[0m[0m 02/24 17:43:35 | training-domain validation (iid, inD) = 81.207%
[37m[36mINFO[0m[0m 02/24 17:43:35 | === Summary ===
[37m[36mINFO[0m[0m 02/24 17:43:35 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 2 --hparams_seed 10
[37m[36mINFO[0m[0m 02/24 17:43:35 | Unique name: 250224_16-06-16_resnet50_GENIE
[37m[36mINFO[0m[0m 02/24 17:43:35 | Out path: train_output/TerraIncognita/CORAL/[0, 1, 2]/250224_16-06-16_resnet50_GENIE
[37m[36mINFO[0m[0m 02/24 17:43:35 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/24 17:43:35 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 02/24 22:23:38 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 2 --hparams_seed 14
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 14
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/CORAL/[0, 1, 2]/250224_22-23-38_resnet50_GENIE
	out_root: train_output/TerraIncognita/CORAL/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 2
	unique_name: 250224_22-23-38_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 4.223376545632674e-05
	batch_size: 27
	weight_decay: 1.4009530778122364e-05
	mmd_gamma: 5.905916742185723
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/24 22:23:38 | n_steps = 5001
[37m[36mINFO[0m[0m 02/24 22:23:38 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/24 22:23:38 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/24 22:23:38 | 
[37m[36mINFO[0m[0m 02/24 22:23:38 | Testenv name escaping te_L100_L38_L43 -> te_L100_L38_L43
[37m[36mINFO[0m[0m 02/24 22:23:38 | Test envs = [0, 1, 2], name = te_L100_L38_L43
[37m[36mINFO[0m[0m 02/24 22:23:38 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 02/24 22:23:38 | Batch sizes for each domain: [0, 0, 0, 27] (total=27)
[37m[36mINFO[0m[0m 02/24 22:23:38 | steps-per-epoch for each domain: 174.33 -> min = 174.33
[37m[36mINFO[0m[0m 02/24 22:23:39 | # of params = 23528522
[37m[36mINFO[0m[0m 02/24 22:26:25 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/24 22:26:25 | 0.288403    0.273706    0.223709    0.207483    2.159589    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.223709    0.207483    0           0.000000    2.569406    0.000000    0.970496    164.833252 
[37m[36mINFO[0m[0m 02/24 22:29:57 | 0.329729    0.312836    0.472488    0.489796    1.418847    0.214342    0.210970    0.445500    0.425270    0.329345    0.302267    0.472488    0.489796    200         1.147228    1.577149    0.000000    0.227882    166.895381 
[37m[36mINFO[0m[0m 02/24 22:33:42 | 0.329899    0.317401    0.472063    0.490646    1.364864    0.219088    0.219409    0.428040    0.410375    0.342569    0.322418    0.472063    0.490646    400         2.294455    1.439775    0.000000    0.271664    170.707974 
[37m[36mINFO[0m[0m 02/24 22:37:12 | 0.183583    0.174525    0.534736    0.563776    1.243187    0.015028    0.022152    0.179612    0.166410    0.356108    0.335013    0.534736    0.563776    600         3.441683    1.332232    0.000000    0.212798    167.221669 
[37m[36mINFO[0m[0m 02/24 22:40:39 | 0.234491    0.229766    0.606756    0.593537    1.055557    0.117585    0.146624    0.234818    0.229070    0.351071    0.313602    0.606756    0.593537    800         4.588910    1.126229    0.000000    0.202719    166.417594 
[37m[36mINFO[0m[0m 02/24 22:44:18 | 0.258991    0.264994    0.663480    0.681973    0.872358    0.130504    0.150844    0.248170    0.239856    0.398300    0.404282    0.663480    0.681973    1000        5.736138    1.008697    0.000000    0.217707    175.304916 
[37m[36mINFO[0m[0m 02/24 22:47:45 | 0.413232    0.409490    0.678139    0.679422    0.880842    0.491695    0.511603    0.348440    0.341551    0.399559    0.375315    0.678139    0.679422    1200        6.883365    0.915205    0.000000    0.191087    169.146891 
[37m[36mINFO[0m[0m 02/24 22:51:10 | 0.395527    0.385950    0.726153    0.754252    0.742791    0.351964    0.371308    0.383104    0.375963    0.451511    0.410579    0.726153    0.754252    1400        8.030593    0.848416    0.000000    0.200771    164.247855 
[37m[36mINFO[0m[0m 02/24 22:54:55 | 0.309347    0.304940    0.746548    0.759354    0.693360    0.187187    0.200422    0.257543    0.252183    0.483312    0.462217    0.746548    0.759354    1600        9.177820    0.774472    0.000000    0.235612    177.661732 
[37m[36mINFO[0m[0m 02/24 22:58:30 | 0.309780    0.305282    0.738262    0.765306    0.699342    0.209069    0.235232    0.241366    0.237288    0.478904    0.443325    0.738262    0.765306    1800        10.325048   0.722221    0.000000    0.223218    170.892614 
[37m[36mINFO[0m[0m 02/24 23:02:11 | 0.292353    0.289108    0.769492    0.761905    0.740639    0.129713    0.142405    0.281037    0.275295    0.466310    0.449622    0.769492    0.761905    2000        11.472275   0.678707    0.000000    0.200606    180.826937 
[37m[36mINFO[0m[0m 02/24 23:05:37 | 0.339554    0.337847    0.776078    0.789966    0.682931    0.183760    0.199367    0.365130    0.345660    0.469773    0.468514    0.776078    0.789966    2200        12.619503   0.645312    0.000000    0.205201    164.782320 
[37m[36mINFO[0m[0m 02/24 23:09:08 | 0.408760    0.401079    0.784364    0.801871    0.638697    0.325600    0.345992    0.426499    0.411402    0.474181    0.445844    0.784364    0.801871    2400        13.766730   0.653642    0.000000    0.183668    174.030752 
[37m[36mINFO[0m[0m 02/24 23:12:46 | 0.336468    0.326931    0.780752    0.770408    0.699985    0.187978    0.193038    0.302221    0.281459    0.519207    0.506297    0.780752    0.770408    2600        14.913958   0.608259    0.000000    0.209893    176.418468 
[37m[36mINFO[0m[0m 02/24 23:16:22 | 0.383418    0.369207    0.814744    0.795918    0.617421    0.273926    0.278481    0.354603    0.337956    0.521725    0.491184    0.814744    0.795918    2800        16.061185   0.589940    0.000000    0.226717    170.763762 
[37m[36mINFO[0m[0m 02/24 23:19:56 | 0.339300    0.328462    0.808158    0.811224    0.613573    0.233588    0.221519    0.334061    0.323061    0.450252    0.440806    0.808158    0.811224    3000        17.208413   0.561263    0.000000    0.205936    172.208369 
[37m[36mINFO[0m[0m 02/24 23:23:25 | 0.350569    0.345092    0.811770    0.801871    0.598269    0.261007    0.270042    0.302349    0.289163    0.488350    0.476071    0.811770    0.801871    3200        18.355641   0.550694    0.000000    0.188523    172.025481 
[37m[36mINFO[0m[0m 02/24 23:26:59 | 0.415767    0.407491    0.816444    0.782313    0.644919    0.348273    0.363924    0.376043    0.361068    0.522985    0.497481    0.816444    0.782313    3400        19.502868   0.562891    0.000000    0.215760    170.621407 
[37m[36mINFO[0m[0m 02/24 23:30:36 | 0.322661    0.317246    0.808583    0.788265    0.637208    0.231479    0.239451    0.296957    0.286595    0.439547    0.425693    0.808583    0.788265    3600        20.650096   0.485651    0.000000    0.177463    181.758537 
[37m[36mINFO[0m[0m 02/24 23:34:03 | 0.385155    0.377317    0.839601    0.832483    0.527554    0.330873    0.345992    0.319553    0.306112    0.505038    0.479849    0.839601    0.832483    3800        21.797323   0.486145    0.000000    0.192725    168.183688 
[37m[36mINFO[0m[0m 02/24 23:37:40 | 0.273332    0.262223    0.793499    0.777211    0.646269    0.148959    0.147679    0.228656    0.220853    0.442380    0.418136    0.793499    0.777211    4000        22.944551   0.491565    0.000000    0.230540    170.628821 
[37m[36mINFO[0m[0m 02/24 23:41:04 | 0.384317    0.379379    0.825791    0.812075    0.642122    0.371210    0.389241    0.284889    0.277863    0.496851    0.471033    0.825791    0.812075    4200        24.091778   0.506071    0.000000    0.207559    162.850374 
[37m[36mINFO[0m[0m 02/24 23:44:40 | 0.457924    0.446372    0.842575    0.813776    0.556359    0.430530    0.431435    0.396328    0.374936    0.546914    0.532746    0.842575    0.813776    4400        25.239006   0.467739    0.000000    0.243364    167.540548 
[37m[36mINFO[0m[0m 02/24 23:48:05 | 0.279991    0.272372    0.854472    0.841837    0.481652    0.143686    0.141350    0.205418    0.194658    0.490869    0.481108    0.854472    0.841837    4600        26.386233   0.441890    0.000000    0.212635    162.295369 
[37m[36mINFO[0m[0m 02/24 23:51:56 | 0.340995    0.326448    0.848736    0.835884    0.547673    0.133667    0.132911    0.382077    0.372881    0.507242    0.473552    0.848736    0.835884    4800        27.533461   0.443068    0.000000    0.269158    177.177591 
[37m[36mINFO[0m[0m 02/24 23:55:23 | 0.332477    0.314044    0.857021    0.835884    0.515395    0.178750    0.165612    0.293491    0.286595    0.525189    0.489924    0.857021    0.835884    5000        28.680688   0.448680    0.000000    0.179941    170.500555 
[37m[36mINFO[0m[0m 02/24 23:55:23 | Cumulative gradient change saved at train_output/TerraIncognita/CORAL/[0, 1, 2]/250224_22-23-38_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/24 23:55:24 | ---
[37m[36mINFO[0m[0m 02/24 23:55:24 | test-domain validation(oracle) = 45.792%
[37m[36mINFO[0m[0m 02/24 23:55:24 | training-domain validation(iid) = 27.999%
[37m[36mINFO[0m[0m 02/24 23:55:24 | last = 33.248%
[37m[36mINFO[0m[0m 02/24 23:55:24 | last (inD) = 83.588%
[37m[36mINFO[0m[0m 02/24 23:55:24 | training-domain validation (iid, inD) = 84.184%
[37m[36mINFO[0m[0m 02/24 23:55:24 | === Summary ===
[37m[36mINFO[0m[0m 02/24 23:55:24 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 2 --hparams_seed 14
[37m[36mINFO[0m[0m 02/24 23:55:24 | Unique name: 250224_22-23-38_resnet50_GENIE
[37m[36mINFO[0m[0m 02/24 23:55:24 | Out path: train_output/TerraIncognita/CORAL/[0, 1, 2]/250224_22-23-38_resnet50_GENIE
[37m[36mINFO[0m[0m 02/24 23:55:24 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/24 23:55:24 | Dataset: TerraIncognita

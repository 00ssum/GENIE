[37m[36mINFO[0m[0m 02/24 20:56:02 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 2 --hparams_seed 13
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 13
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/CORAL/[0, 1, 2]/250224_20-56-02_resnet50_GENIE
	out_root: train_output/TerraIncognita/CORAL/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 2
	unique_name: 250224_20-56-02_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.00010514591448387436
	batch_size: 9
	weight_decay: 2.4366015497066046e-05
	mmd_gamma: 0.11427248695687856
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/24 20:56:02 | n_steps = 5001
[37m[36mINFO[0m[0m 02/24 20:56:02 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/24 20:56:02 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/24 20:56:02 | 
[37m[36mINFO[0m[0m 02/24 20:56:02 | Testenv name escaping te_L100_L38_L43 -> te_L100_L38_L43
[37m[36mINFO[0m[0m 02/24 20:56:02 | Test envs = [0, 1, 2], name = te_L100_L38_L43
[37m[36mINFO[0m[0m 02/24 20:56:02 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 02/24 20:56:02 | Batch sizes for each domain: [0, 0, 0, 9] (total=9)
[37m[36mINFO[0m[0m 02/24 20:56:02 | steps-per-epoch for each domain: 523.00 -> min = 523.00
[37m[36mINFO[0m[0m 02/24 20:56:04 | # of params = 23528522
[37m[36mINFO[0m[0m 02/24 20:59:18 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/24 20:59:18 | 0.288403    0.273706    0.222860    0.207483    2.275180    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.222860    0.207483    0           0.000000    2.559062    0.000000    1.827432    192.173727 
[37m[36mINFO[0m[0m 02/24 21:03:11 | 0.256402    0.256059    0.283195    0.291667    1.676231    0.548379    0.566456    0.032225    0.024140    0.188602    0.177582    0.283195    0.291667    200         0.382409    1.641720    0.000000    0.211339    190.723691 
[37m[36mINFO[0m[0m 02/24 21:06:48 | 0.334819    0.318330    0.454642    0.479592    1.483248    0.222252    0.218354    0.448453    0.426810    0.333753    0.309824    0.454642    0.479592    400         0.764818    1.513741    0.000000    0.141369    188.487596 
[37m[36mINFO[0m[0m 02/24 21:10:30 | 0.326035    0.311800    0.469938    0.486395    1.376232    0.221197    0.219409    0.416228    0.401130    0.340680    0.314861    0.469938    0.486395    600         1.147228    1.500634    0.000000    0.171261    187.798533 
[37m[36mINFO[0m[0m 02/24 21:14:22 | 0.337715    0.325186    0.462715    0.456633    1.412882    0.225415    0.223629    0.444216    0.423215    0.343514    0.328715    0.462715    0.456633    800         1.529637    1.421008    0.000000    0.178294    196.614152 
[37m[36mINFO[0m[0m 02/24 21:17:52 | 0.290310    0.277554    0.406628    0.401361    1.424891    0.202478    0.198312    0.314546    0.294299    0.353904    0.340050    0.406628    0.401361    1000        1.912046    1.423155    0.000000    0.117618    185.759982 
[37m[36mINFO[0m[0m 02/24 21:21:09 | 0.262892    0.246810    0.497132    0.510204    1.352828    0.187187    0.163502    0.313391    0.294813    0.288098    0.282116    0.497132    0.510204    1200        2.294455    1.412574    0.000000    0.107353    176.466519 
[37m[36mINFO[0m[0m 02/24 21:24:29 | 0.333157    0.322150    0.483323    0.494048    1.379242    0.222515    0.220464    0.417383    0.402157    0.359572    0.343829    0.483323    0.494048    1400        2.676864    1.367927    0.000000    0.116695    176.037444 
[37m[36mINFO[0m[0m 02/24 21:27:52 | 0.144724    0.146928    0.380285    0.410714    1.417008    0.169259    0.177215    0.025934    0.017976    0.238980    0.245592    0.380285    0.410714    1600        3.059273    1.342415    0.000000    0.106576    181.894071 
[37m[36mINFO[0m[0m 02/24 21:31:18 | 0.278066    0.270510    0.521989    0.520408    1.217777    0.211969    0.235232    0.251637    0.222393    0.370592    0.353904    0.521989    0.520408    1800        3.441683    1.355234    0.000000    0.141286    177.985573 
[37m[36mINFO[0m[0m 02/24 21:34:34 | 0.345985    0.340738    0.594434    0.591837    1.138579    0.343528    0.354430    0.349339    0.330252    0.345088    0.337531    0.594434    0.591837    2000        3.824092    1.232661    0.000000    0.108261    173.801616 
[37m[36mINFO[0m[0m 02/24 21:37:42 | 0.193076    0.194352    0.594646    0.602041    1.112810    0.040074    0.048523    0.158172    0.159219    0.380982    0.375315    0.594646    0.602041    2200        4.206501    1.333680    0.000000    0.120239    164.496372 
[37m[36mINFO[0m[0m 02/24 21:41:09 | 0.282587    0.266175    0.588485    0.616497    1.055202    0.281308    0.267932    0.239312    0.229584    0.327141    0.301008    0.588485    0.616497    2400        4.588910    1.135060    0.000000    0.139610    179.149546 
[37m[36mINFO[0m[0m 02/24 21:44:43 | 0.343180    0.338047    0.620990    0.619048    1.076976    0.431321    0.452532    0.197715    0.178737    0.400504    0.382872    0.620990    0.619048    2600        4.971319    1.044973    0.000000    0.163343    181.109647 
[37m[36mINFO[0m[0m 02/24 21:48:01 | 0.318752    0.309768    0.591884    0.579082    1.168457    0.247034    0.254219    0.385544    0.356446    0.323678    0.318640    0.591884    0.579082    2800        5.353728    1.077994    0.000000    0.111892    175.692933 
[37m[36mINFO[0m[0m 02/24 21:51:30 | 0.263096    0.260339    0.639048    0.640306    1.085990    0.158450    0.174051    0.253948    0.245506    0.376889    0.361461    0.639048    0.640306    3000        5.736138    1.033755    0.000000    0.113648    185.520492 
[37m[36mINFO[0m[0m 02/24 21:54:39 | 0.211337    0.219662    0.626089    0.675170    1.015511    0.175850    0.182489    0.097959    0.101181    0.360202    0.375315    0.626089    0.675170    3200        6.118547    1.045630    0.000000    0.131244    162.764651 
[37m[36mINFO[0m[0m 02/24 21:57:54 | 0.306580    0.308988    0.648821    0.654762    0.994758    0.400475    0.413502    0.125690    0.124294    0.393577    0.389169    0.648821    0.654762    3400        6.500956    1.018095    0.000000    0.120871    171.047659 
[37m[36mINFO[0m[0m 02/24 22:01:04 | 0.365708    0.362190    0.676864    0.696429    0.911321    0.443712    0.456751    0.252279    0.241911    0.401134    0.387909    0.676864    0.696429    3600        6.883365    0.974657    0.000000    0.111998    167.759098 
[37m[36mINFO[0m[0m 02/24 22:04:09 | 0.243195    0.230453    0.671553    0.666667    0.941318    0.125231    0.122363    0.212351    0.196199    0.392003    0.372796    0.671553    0.666667    3800        7.265774    0.973933    0.000000    0.118955    161.306034 
[37m[36mINFO[0m[0m 02/24 22:07:27 | 0.328806    0.332170    0.667304    0.686224    0.879978    0.475877    0.490506    0.137116    0.129430    0.373426    0.376574    0.667304    0.686224    4000        7.648184    0.936967    0.000000    0.108189    176.193300 
[37m[36mINFO[0m[0m 02/24 22:10:36 | 0.223218    0.220610    0.708307    0.718537    0.825831    0.160823    0.177215    0.100141    0.104263    0.408690    0.380353    0.708307    0.718537    4200        8.030593    0.917037    0.000000    0.111934    166.983040 
[37m[36mINFO[0m[0m 02/24 22:13:52 | 0.197803    0.196397    0.692373    0.696429    0.975834    0.103348    0.123418    0.106561    0.106831    0.383501    0.358942    0.692373    0.696429    4400        8.413002    0.821209    0.000000    0.129939    169.653935 
[37m[36mINFO[0m[0m 02/24 22:17:06 | 0.385344    0.370249    0.688549    0.681122    0.913669    0.388083    0.383966    0.331236    0.319979    0.436713    0.406801    0.688549    0.681122    4600        8.795411    0.824640    0.000000    0.110163    172.390217 
[37m[36mINFO[0m[0m 02/24 22:20:17 | 0.329843    0.321068    0.722966    0.713435    0.844158    0.208542    0.212025    0.371036    0.370827    0.409950    0.380353    0.722966    0.713435    4800        9.177820    0.817426    0.000000    0.110792    168.473411 
[37m[36mINFO[0m[0m 02/24 22:23:32 | 0.322819    0.303225    0.724028    0.716837    0.824428    0.279989    0.275316    0.267814    0.255265    0.420655    0.379093    0.724028    0.716837    5000        9.560229    0.795449    0.000000    0.109422    172.705637 
[37m[36mINFO[0m[0m 02/24 22:23:32 | Cumulative gradient change saved at train_output/TerraIncognita/CORAL/[0, 1, 2]/250224_20-56-02_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/24 22:23:34 | ---
[37m[36mINFO[0m[0m 02/24 22:23:34 | test-domain validation(oracle) = 38.534%
[37m[36mINFO[0m[0m 02/24 22:23:34 | training-domain validation(iid) = 22.322%
[37m[36mINFO[0m[0m 02/24 22:23:34 | last = 32.282%
[37m[36mINFO[0m[0m 02/24 22:23:34 | last (inD) = 71.684%
[37m[36mINFO[0m[0m 02/24 22:23:34 | training-domain validation (iid, inD) = 71.854%
[37m[36mINFO[0m[0m 02/24 22:23:34 | === Summary ===
[37m[36mINFO[0m[0m 02/24 22:23:34 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 2 --hparams_seed 13
[37m[36mINFO[0m[0m 02/24 22:23:34 | Unique name: 250224_20-56-02_resnet50_GENIE
[37m[36mINFO[0m[0m 02/24 22:23:34 | Out path: train_output/TerraIncognita/CORAL/[0, 1, 2]/250224_20-56-02_resnet50_GENIE
[37m[36mINFO[0m[0m 02/24 22:23:34 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/24 22:23:34 | Dataset: TerraIncognita

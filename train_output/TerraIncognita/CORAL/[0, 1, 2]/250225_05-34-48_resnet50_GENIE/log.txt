[37m[36mINFO[0m[0m 02/25 05:34:48 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 2 --hparams_seed 19
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 19
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/CORAL/[0, 1, 2]/250225_05-34-48_resnet50_GENIE
	out_root: train_output/TerraIncognita/CORAL/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 2
	unique_name: 250225_05-34-48_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 7.509081014584126e-05
	batch_size: 8
	weight_decay: 2.862344444160157e-05
	mmd_gamma: 0.2739283225580369
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/25 05:34:48 | n_steps = 5001
[37m[36mINFO[0m[0m 02/25 05:34:48 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/25 05:34:48 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/25 05:34:48 | 
[37m[36mINFO[0m[0m 02/25 05:34:48 | Testenv name escaping te_L100_L38_L43 -> te_L100_L38_L43
[37m[36mINFO[0m[0m 02/25 05:34:48 | Test envs = [0, 1, 2], name = te_L100_L38_L43
[37m[36mINFO[0m[0m 02/25 05:34:48 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 02/25 05:34:48 | Batch sizes for each domain: [0, 0, 0, 8] (total=8)
[37m[36mINFO[0m[0m 02/25 05:34:48 | steps-per-epoch for each domain: 588.38 -> min = 588.38
[37m[36mINFO[0m[0m 02/25 05:34:49 | # of params = 23528522
[37m[36mINFO[0m[0m 02/25 05:37:30 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/25 05:37:30 | 0.288403    0.273706    0.222860    0.207483    2.491944    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.222860    0.207483    0           0.000000    2.509025    0.000000    1.100738    159.553727 
[37m[36mINFO[0m[0m 02/25 05:40:29 | 0.348694    0.332828    0.405991    0.408163    1.584139    0.232534    0.227848    0.540249    0.518747    0.273300    0.251889    0.405991    0.408163    200         0.339919    1.663061    0.000000    0.104232    158.628212 
[37m[36mINFO[0m[0m 02/25 05:43:29 | 0.345886    0.329836    0.387083    0.400510    1.557398    0.199315    0.198312    0.486327    0.461222    0.352015    0.329975    0.387083    0.400510    400         0.679839    1.549748    0.000000    0.113290    157.282551 
[37m[36mINFO[0m[0m 02/25 05:46:31 | 0.249339    0.232801    0.465264    0.486395    1.387139    0.224097    0.218354    0.168443    0.155110    0.355479    0.324937    0.465264    0.486395    600         1.019758    1.501799    0.000000    0.109177    159.751270 
[37m[36mINFO[0m[0m 02/25 05:49:25 | 0.330418    0.320861    0.390907    0.415816    1.500980    0.213024    0.206751    0.557196    0.548023    0.221033    0.207809    0.390907    0.415816    800         1.359677    1.495834    0.000000    0.110991    152.034932 
[37m[36mINFO[0m[0m 02/25 05:52:32 | 0.341322    0.324058    0.466752    0.491497    1.383268    0.215133    0.212025    0.451149    0.431433    0.357683    0.328715    0.466752    0.491497    1000        1.699596    1.425525    0.000000    0.109244    164.816362 
[37m[36mINFO[0m[0m 02/25 05:55:37 | 0.309406    0.297693    0.456767    0.465986    1.351181    0.201687    0.195148    0.405058    0.391885    0.321474    0.306045    0.456767    0.465986    1200        2.039516    1.493573    0.000000    0.110729    163.242100 
[37m[36mINFO[0m[0m 02/25 05:58:51 | 0.329758    0.317472    0.474825    0.478741    1.427485    0.198260    0.201477    0.424830    0.410889    0.366184    0.340050    0.474825    0.478741    1400        2.379435    1.386725    0.000000    0.131751    167.676424 
[37m[36mINFO[0m[0m 02/25 06:02:04 | 0.344912    0.330035    0.482685    0.491497    1.349568    0.225152    0.221519    0.444345    0.424756    0.365239    0.343829    0.482685    0.491497    1600        2.719354    1.408054    0.000000    0.121888    168.899544 
[37m[36mINFO[0m[0m 02/25 06:05:30 | 0.337282    0.325238    0.437434    0.442177    1.338764    0.226997    0.226793    0.554372    0.542373    0.230479    0.206549    0.437434    0.442177    1800        3.059273    1.331633    0.000000    0.143648    177.255168 
[37m[36mINFO[0m[0m 02/25 06:08:46 | 0.272723    0.260087    0.466539    0.475340    1.337617    0.224624    0.222574    0.239954    0.223934    0.353589    0.333753    0.466539    0.475340    2000        3.399193    1.330925    0.000000    0.109714    173.869206 
[37m[36mINFO[0m[0m 02/25 06:12:03 | 0.335596    0.338994    0.503930    0.511905    1.206124    0.545215    0.565401    0.148286    0.141757    0.313287    0.309824    0.503930    0.511905    2200        3.739112    1.257760    0.000000    0.110860    174.962114 
[37m[36mINFO[0m[0m 02/25 06:15:18 | 0.332548    0.318490    0.460803    0.467687    1.399416    0.205378    0.200422    0.431121    0.414997    0.361146    0.340050    0.460803    0.467687    2400        4.079031    1.301494    0.000000    0.112220    172.685401 
[37m[36mINFO[0m[0m 02/25 06:18:26 | 0.243623    0.242352    0.538135    0.543367    1.175175    0.255734    0.273207    0.228913    0.220853    0.246222    0.232997    0.538135    0.543367    2600        4.418950    1.246052    0.000000    0.149982    157.794425 
[37m[36mINFO[0m[0m 02/25 06:21:47 | 0.285966    0.284432    0.625876    0.638605    0.978828    0.197205    0.217300    0.270895    0.261941    0.389798    0.374055    0.625876    0.638605    2800        4.758870    1.098561    0.000000    0.155508    169.657614 
[37m[36mINFO[0m[0m 02/25 06:25:05 | 0.338729    0.325103    0.606119    0.604592    1.095541    0.406275    0.405063    0.249711    0.235234    0.360202    0.335013    0.606119    0.604592    3000        5.098789    1.096924    0.000000    0.156784    167.076938 
[37m[36mINFO[0m[0m 02/25 06:28:32 | 0.197197    0.202264    0.627151    0.647109    0.979823    0.076193    0.095992    0.170625    0.169492    0.344773    0.341310    0.627151    0.647109    3200        5.438708    1.114306    0.000000    0.169156    172.782771 
[37m[36mINFO[0m[0m 02/25 06:31:49 | 0.330829    0.328497    0.623539    0.616497    1.169003    0.387820    0.392405    0.225575    0.217771    0.379093    0.375315    0.623539    0.616497    3400        5.778628    1.016102    0.000000    0.132964    170.138696 
[37m[36mINFO[0m[0m 02/25 06:35:05 | 0.409358    0.398711    0.656682    0.670918    0.960045    0.493541    0.497890    0.339068    0.329224    0.395466    0.369018    0.656682    0.670918    3600        6.118547    0.993394    0.000000    0.123098    171.408571 
[37m[36mINFO[0m[0m 02/25 06:38:17 | 0.275918    0.282683    0.625027    0.640306    1.014742    0.277353    0.286920    0.163436    0.166923    0.386965    0.394207    0.625027    0.640306    3800        6.458466    1.032044    0.000000    0.113749    169.566554 
[37m[36mINFO[0m[0m 02/25 06:41:35 | 0.360133    0.345371    0.668791    0.683673    0.884069    0.349328    0.349156    0.339068    0.331793    0.392003    0.355164    0.668791    0.683673    4000        6.798385    0.911035    0.000000    0.129586    171.625715 
[37m[36mINFO[0m[0m 02/25 06:44:53 | 0.411763    0.408638    0.680476    0.675170    0.953472    0.537042    0.555907    0.315060    0.314843    0.383186    0.355164    0.680476    0.675170    4200        7.138305    0.938487    0.000000    0.122656    173.702734 
[37m[36mINFO[0m[0m 02/25 06:48:22 | 0.332176    0.323825    0.670491    0.666667    0.917328    0.273398    0.277426    0.338683    0.333847    0.384446    0.360202    0.670491    0.666667    4400        7.478224    0.926379    0.000000    0.128060    183.266459 
[37m[36mINFO[0m[0m 02/25 06:51:39 | 0.317742    0.310783    0.648396    0.642857    0.968566    0.349328    0.359705    0.281166    0.255265    0.322733    0.317380    0.648396    0.642857    4600        7.818143    0.860917    0.000000    0.113592    174.244971 
[37m[36mINFO[0m[0m 02/25 06:55:15 | 0.264243    0.260025    0.659868    0.678571    0.923610    0.211706    0.231013    0.190910    0.181305    0.390113    0.367758    0.659868    0.678571    4800        8.158062    0.908147    0.000000    0.158689    184.977936 
[37m[36mINFO[0m[0m 02/25 06:58:40 | 0.370681    0.354692    0.692798    0.711735    0.890426    0.332455    0.332278    0.360508    0.345146    0.419081    0.386650    0.692798    0.711735    5000        8.497982    0.861673    0.000000    0.136871    177.368503 
[37m[36mINFO[0m[0m 02/25 06:58:40 | Cumulative gradient change saved at train_output/TerraIncognita/CORAL/[0, 1, 2]/250225_05-34-48_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/25 06:58:42 | ---
[37m[36mINFO[0m[0m 02/25 06:58:42 | test-domain validation(oracle) = 41.176%
[37m[36mINFO[0m[0m 02/25 06:58:42 | training-domain validation(iid) = 37.068%
[37m[36mINFO[0m[0m 02/25 06:58:42 | last = 37.068%
[37m[36mINFO[0m[0m 02/25 06:58:42 | last (inD) = 71.173%
[37m[36mINFO[0m[0m 02/25 06:58:42 | training-domain validation (iid, inD) = 71.173%
[37m[36mINFO[0m[0m 02/25 06:58:42 | === Summary ===
[37m[36mINFO[0m[0m 02/25 06:58:42 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 2 --hparams_seed 19
[37m[36mINFO[0m[0m 02/25 06:58:42 | Unique name: 250225_05-34-48_resnet50_GENIE
[37m[36mINFO[0m[0m 02/25 06:58:42 | Out path: train_output/TerraIncognita/CORAL/[0, 1, 2]/250225_05-34-48_resnet50_GENIE
[37m[36mINFO[0m[0m 02/25 06:58:42 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/25 06:58:42 | Dataset: TerraIncognita

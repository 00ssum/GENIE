[37m[36mINFO[0m[0m 02/24 23:55:29 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 2 --hparams_seed 15
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 15
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/CORAL/[0, 1, 2]/250224_23-55-29_resnet50_GENIE
	out_root: train_output/TerraIncognita/CORAL/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 2
	unique_name: 250224_23-55-29_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.00023237243746776078
	batch_size: 13
	weight_decay: 1.8132449266758068e-05
	mmd_gamma: 0.9275323400445011
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/24 23:55:29 | n_steps = 5001
[37m[36mINFO[0m[0m 02/24 23:55:29 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/24 23:55:29 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/24 23:55:29 | 
[37m[36mINFO[0m[0m 02/24 23:55:29 | Testenv name escaping te_L100_L38_L43 -> te_L100_L38_L43
[37m[36mINFO[0m[0m 02/24 23:55:29 | Test envs = [0, 1, 2], name = te_L100_L38_L43
[37m[36mINFO[0m[0m 02/24 23:55:29 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 02/24 23:55:29 | Batch sizes for each domain: [0, 0, 0, 13] (total=13)
[37m[36mINFO[0m[0m 02/24 23:55:29 | steps-per-epoch for each domain: 362.08 -> min = 362.08
[37m[36mINFO[0m[0m 02/24 23:55:31 | # of params = 23528522
[37m[36mINFO[0m[0m 02/24 23:58:33 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/24 23:58:33 | 0.288403    0.273706    0.243467    0.221939    2.114015    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.243467    0.221939    0           0.000000    2.616688    0.000000    1.190786    181.093612 
[37m[36mINFO[0m[0m 02/25 00:02:00 | 0.337197    0.319249    0.448693    0.479592    1.431223    0.228052    0.220464    0.439081    0.421161    0.344458    0.316121    0.448693    0.479592    200         0.552369    1.583379    0.000000    0.144036    178.804548 
[37m[36mINFO[0m[0m 02/25 00:05:22 | 0.258820    0.252922    0.470788    0.482143    1.387904    0.206169    0.209916    0.255745    0.249101    0.314547    0.299748    0.470788    0.482143    400         1.104738    1.459390    0.000000    0.129709    175.159491 
[37m[36mINFO[0m[0m 02/25 00:08:31 | 0.321862    0.308843    0.466539    0.479592    1.390625    0.217770    0.217300    0.421620    0.403184    0.326196    0.306045    0.466539    0.479592    600         1.657106    1.426668    0.000000    0.124194    165.084518 
[37m[36mINFO[0m[0m 02/25 00:11:57 | 0.302924    0.297475    0.483960    0.490646    1.357433    0.214606    0.209916    0.372063    0.362609    0.322103    0.319899    0.483960    0.490646    800         2.209475    1.396995    0.000000    0.168023    171.734879 
[37m[36mINFO[0m[0m 02/25 00:15:09 | 0.318270    0.308342    0.499894    0.508503    1.302518    0.228315    0.225738    0.416356    0.397021    0.310139    0.302267    0.499894    0.508503    1000        2.761844    1.359149    0.000000    0.126694    167.052298 
[37m[36mINFO[0m[0m 02/25 00:18:38 | 0.296315    0.295474    0.589547    0.606293    1.135468    0.294226    0.297468    0.252150    0.238829    0.342569    0.350126    0.589547    0.606293    1200        3.314213    1.267243    0.000000    0.142953    180.486882 
[37m[36mINFO[0m[0m 02/25 00:21:56 | 0.274129    0.268024    0.579137    0.598639    1.134139    0.157922    0.174051    0.316857    0.305085    0.347607    0.324937    0.579137    0.598639    1400        3.866582    1.131448    0.000000    0.142770    168.852725 
[37m[36mINFO[0m[0m 02/25 00:25:15 | 0.326457    0.313601    0.568940    0.541667    1.151470    0.224361    0.223629    0.392605    0.370827    0.362406    0.346348    0.568940    0.541667    1600        4.418950    1.021207    0.000000    0.150492    169.585609 
[37m[36mINFO[0m[0m 02/25 00:28:44 | 0.230015    0.223888    0.647334    0.660714    0.973651    0.102030    0.109705    0.171139    0.157678    0.416877    0.404282    0.647334    0.660714    1800        4.971319    1.057631    0.000000    0.145914    179.017780 
[37m[36mINFO[0m[0m 02/25 00:32:04 | 0.320213    0.314433    0.675377    0.684524    0.897921    0.187451    0.188819    0.361664    0.359014    0.411524    0.395466    0.675377    0.684524    2000        5.523688    0.922756    0.000000    0.130099    174.757559 
[37m[36mINFO[0m[0m 02/25 00:35:15 | 0.195117    0.187748    0.608668    0.610544    1.238950    0.069075    0.062236    0.173707    0.171032    0.342569    0.329975    0.608668    0.610544    2200        6.076057    0.939746    0.000000    0.121613    166.751615 
[37m[36mINFO[0m[0m 02/25 00:38:27 | 0.372541    0.357660    0.729977    0.734694    0.776431    0.396520    0.409283    0.328155    0.300976    0.392947    0.362720    0.729977    0.734694    2400        6.628426    0.876807    0.000000    0.122338    166.570096 
[37m[36mINFO[0m[0m 02/25 00:41:28 | 0.251775    0.244951    0.701508    0.710884    0.835170    0.144740    0.142405    0.188984    0.184386    0.421599    0.408060    0.701508    0.710884    2600        7.180795    0.826521    0.000000    0.124920    156.292548 
[37m[36mINFO[0m[0m 02/25 00:44:44 | 0.310658    0.304176    0.739962    0.741497    0.744716    0.235170    0.252110    0.292207    0.287622    0.404597    0.372796    0.739962    0.741497    2800        7.733163    0.880560    0.000000    0.135711    169.035834 
[37m[36mINFO[0m[0m 02/25 00:47:54 | 0.345980    0.329209    0.723603    0.733844    0.792236    0.334036    0.325949    0.304660    0.287622    0.399244    0.374055    0.723603    0.733844    3000        8.285532    0.801361    0.000000    0.139820    162.497020 
[37m[36mINFO[0m[0m 02/25 00:51:13 | 0.391567    0.369651    0.740387    0.746599    0.756571    0.382020    0.383966    0.370137    0.344633    0.422544    0.380353    0.740387    0.746599    3200        8.837901    0.717740    0.000000    0.142007    169.817326 
[37m[36mINFO[0m[0m 02/25 00:54:22 | 0.273978    0.276657    0.747397    0.767007    0.704693    0.221197    0.247890    0.224162    0.221880    0.376574    0.360202    0.747397    0.767007    3400        9.390270    0.785196    0.000000    0.129792    163.737104 
[37m[36mINFO[0m[0m 02/25 00:57:37 | 0.309037    0.305451    0.748885    0.755102    0.809206    0.267071    0.273207    0.243163    0.227530    0.416877    0.415617    0.748885    0.755102    3600        9.942639    0.730099    0.000000    0.130972    168.379986 
[37m[36mINFO[0m[0m 02/25 01:00:49 | 0.388903    0.380395    0.745698    0.757653    0.717083    0.344846    0.368143    0.374759    0.354905    0.447103    0.418136    0.745698    0.757653    3800        10.495007   0.724927    0.000000    0.130410    166.421131 
[37m[36mINFO[0m[0m 02/25 01:04:04 | 0.282897    0.281426    0.775228    0.769558    0.711586    0.188241    0.202532    0.271280    0.272727    0.389169    0.369018    0.775228    0.769558    4000        11.047376   0.696861    0.000000    0.140403    166.661340 
[37m[36mINFO[0m[0m 02/25 01:07:09 | 0.306316    0.312034    0.720204    0.715136    0.809903    0.373847    0.401899    0.159712    0.155110    0.385390    0.379093    0.720204    0.715136    4200        11.599745   0.709969    0.000000    0.131755    157.996016 
[37m[36mINFO[0m[0m 02/25 01:10:28 | 0.289095    0.271140    0.778628    0.765306    0.744806    0.179541    0.169831    0.266145    0.250642    0.421599    0.392947    0.778628    0.765306    4400        12.152114   0.671660    0.000000    0.135308    171.944931 
[37m[36mINFO[0m[0m 02/25 01:13:37 | 0.384725    0.379280    0.787338    0.799320    0.623982    0.389402    0.414557    0.326486    0.321520    0.438287    0.401763    0.787338    0.799320    4600        12.704483   0.618962    0.000000    0.152849    158.689492 
[37m[36mINFO[0m[0m 02/25 01:16:51 | 0.318893    0.313251    0.784576    0.791667    0.626498    0.276298    0.296414    0.190140    0.184900    0.490239    0.458438    0.784576    0.791667    4800        13.256851   0.637494    0.000000    0.145278    165.064101 
[37m[36mINFO[0m[0m 02/25 01:19:59 | 0.390707    0.382457    0.734651    0.735544    0.741508    0.365674    0.380802    0.335730    0.319466    0.470718    0.447103    0.734651    0.735544    5000        13.809220   0.595594    0.000000    0.133815    161.607153 
[37m[36mINFO[0m[0m 02/25 01:19:59 | Cumulative gradient change saved at train_output/TerraIncognita/CORAL/[0, 1, 2]/250224_23-55-29_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/25 01:20:01 | ---
[37m[36mINFO[0m[0m 02/25 01:20:01 | test-domain validation(oracle) = 39.071%
[37m[36mINFO[0m[0m 02/25 01:20:01 | training-domain validation(iid) = 38.472%
[37m[36mINFO[0m[0m 02/25 01:20:01 | last = 39.071%
[37m[36mINFO[0m[0m 02/25 01:20:01 | last (inD) = 73.554%
[37m[36mINFO[0m[0m 02/25 01:20:01 | training-domain validation (iid, inD) = 79.932%
[37m[36mINFO[0m[0m 02/25 01:20:01 | === Summary ===
[37m[36mINFO[0m[0m 02/25 01:20:01 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 2 --hparams_seed 15
[37m[36mINFO[0m[0m 02/25 01:20:01 | Unique name: 250224_23-55-29_resnet50_GENIE
[37m[36mINFO[0m[0m 02/25 01:20:01 | Out path: train_output/TerraIncognita/CORAL/[0, 1, 2]/250224_23-55-29_resnet50_GENIE
[37m[36mINFO[0m[0m 02/25 01:20:01 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/25 01:20:01 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 02/25 02:44:48 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 2 --hparams_seed 17
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 17
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/CORAL/[0, 1, 2]/250225_02-44-48_resnet50_GENIE
	out_root: train_output/TerraIncognita/CORAL/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 2
	unique_name: 250225_02-44-48_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 4.54558611872744e-05
	batch_size: 30
	weight_decay: 2.0881632317009623e-05
	mmd_gamma: 1.2137942108482616
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/25 02:44:48 | n_steps = 5001
[37m[36mINFO[0m[0m 02/25 02:44:48 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/25 02:44:48 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/25 02:44:48 | 
[37m[36mINFO[0m[0m 02/25 02:44:48 | Testenv name escaping te_L100_L38_L43 -> te_L100_L38_L43
[37m[36mINFO[0m[0m 02/25 02:44:48 | Test envs = [0, 1, 2], name = te_L100_L38_L43
[37m[36mINFO[0m[0m 02/25 02:44:48 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 02/25 02:44:48 | Batch sizes for each domain: [0, 0, 0, 30] (total=30)
[37m[36mINFO[0m[0m 02/25 02:44:48 | steps-per-epoch for each domain: 156.90 -> min = 156.90
[37m[36mINFO[0m[0m 02/25 02:44:49 | # of params = 23528522
[37m[36mINFO[0m[0m 02/25 02:47:30 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/25 02:47:30 | 0.288403    0.273706    0.222860    0.207483    2.184159    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.222860    0.207483    0           0.000000    2.550519    0.000000    1.084977    159.754706 
[37m[36mINFO[0m[0m 02/25 02:50:50 | 0.288622    0.272231    0.445719    0.472789    1.437398    0.227788    0.229958    0.320067    0.307139    0.318010    0.279597    0.445719    0.472789    200         1.274697    1.580252    0.000000    0.211382    157.821745 
[37m[36mINFO[0m[0m 02/25 02:54:07 | 0.336216    0.319450    0.458254    0.444728    1.379135    0.211706    0.209916    0.445243    0.424756    0.351700    0.323678    0.458254    0.444728    400         2.549395    1.431852    0.000000    0.211788    154.509244 
[37m[36mINFO[0m[0m 02/25 02:57:30 | 0.313769    0.306780    0.538347    0.551020    1.230431    0.197205    0.217300    0.398382    0.369286    0.345718    0.333753    0.538347    0.551020    600         3.824092    1.363834    0.000000    0.199922    163.639159 
[37m[36mINFO[0m[0m 02/25 03:00:42 | 0.283903    0.274636    0.627788    0.624150    1.050299    0.127340    0.142405    0.357556    0.336415    0.366814    0.345088    0.627788    0.624150    800         5.098789    1.189505    0.000000    0.212821    149.430880 
[37m[36mINFO[0m[0m 02/25 03:03:57 | 0.356406    0.346703    0.688549    0.698980    0.869494    0.340627    0.353376    0.318013    0.293785    0.410579    0.392947    0.688549    0.698980    1000        6.373486    0.974693    0.000000    0.194211    156.050404 
[37m[36mINFO[0m[0m 02/25 03:07:13 | 0.431473    0.429363    0.711706    0.727041    0.843252    0.415502    0.429325    0.451021    0.438110    0.427897    0.420655    0.711706    0.727041    1200        7.648184    0.845197    0.000000    0.205823    154.299428 
[37m[36mINFO[0m[0m 02/25 03:10:31 | 0.391688    0.382261    0.695347    0.719388    0.817003    0.381229    0.404008    0.341379    0.313303    0.452456    0.429471    0.695347    0.719388    1400        8.922881    0.839288    0.000000    0.201860    157.543799 
[37m[36mINFO[0m[0m 02/25 03:13:44 | 0.389772    0.378485    0.726153    0.744898    0.748855    0.337991    0.341772    0.395558    0.380586    0.435768    0.413098    0.726153    0.744898    1600        10.197578   0.755478    0.000000    0.206082    152.396732 
[37m[36mINFO[0m[0m 02/25 03:17:06 | 0.388969    0.389792    0.754833    0.758503    0.715163    0.389665    0.414557    0.329824    0.324088    0.447418    0.430730    0.754833    0.758503    1800        11.472275   0.738920    0.000000    0.203841    161.223717 
[37m[36mINFO[0m[0m 02/25 03:20:26 | 0.308665    0.301860    0.772891    0.779762    0.654359    0.187451    0.205696    0.242008    0.243965    0.496537    0.455919    0.772891    0.779762    2000        12.746973   0.665670    0.000000    0.202468    159.321932 
[37m[36mINFO[0m[0m 02/25 03:23:46 | 0.323177    0.324589    0.792649    0.787415    0.671919    0.247561    0.271097    0.238028    0.231638    0.483942    0.471033    0.792649    0.787415    2200        14.021670   0.623346    0.000000    0.224242    155.096325 
[37m[36mINFO[0m[0m 02/25 03:27:10 | 0.395014    0.395192    0.794349    0.803571    0.599956    0.389929    0.410338    0.309282    0.311762    0.485831    0.463476    0.794349    0.803571    2400        15.296367   0.586017    0.000000    0.203301    163.007920 
[37m[36mINFO[0m[0m 02/25 03:30:33 | 0.330037    0.323165    0.800935    0.801871    0.578022    0.236752    0.247890    0.276030    0.273241    0.477330    0.448363    0.800935    0.801871    2600        16.571064   0.593040    0.000000    0.219765    158.979785 
[37m[36mINFO[0m[0m 02/25 03:34:00 | 0.287093    0.279994    0.808795    0.821429    0.533164    0.214606    0.217300    0.156118    0.145352    0.490554    0.477330    0.808795    0.821429    2800        17.845762   0.568629    0.000000    0.216842    163.904583 
[37m[36mINFO[0m[0m 02/25 03:37:19 | 0.331757    0.318161    0.812832    0.805272    0.609518    0.183760    0.182489    0.297342    0.287108    0.514169    0.484887    0.812832    0.805272    3000        19.120459   0.551856    0.000000    0.210040    157.535684 
[37m[36mINFO[0m[0m 02/25 03:40:49 | 0.298456    0.290000    0.826429    0.821429    0.554069    0.145795    0.151899    0.225960    0.221880    0.523615    0.496222    0.826429    0.821429    3200        20.395156   0.541277    0.000000    0.232933    162.982576 
[37m[36mINFO[0m[0m 02/25 03:44:21 | 0.385736    0.371521    0.809008    0.801020    0.663059    0.269444    0.264768    0.389652    0.377504    0.498111    0.472292    0.809008    0.801020    3400        21.669853   0.507189    0.000000    0.213492    169.365870 
[37m[36mINFO[0m[0m 02/25 03:47:54 | 0.332545    0.324354    0.833227    0.837585    0.493042    0.263380    0.275316    0.258185    0.250642    0.476071    0.447103    0.833227    0.837585    3600        22.944551   0.537774    0.000000    0.232573    166.014386 
[37m[36mINFO[0m[0m 02/25 03:51:23 | 0.290977    0.287099    0.806246    0.804422    0.582440    0.161613    0.164557    0.230838    0.224448    0.480479    0.472292    0.806246    0.804422    3800        24.219248   0.464051    0.000000    0.210936    167.036235 
[37m[36mINFO[0m[0m 02/25 03:54:47 | 0.301842    0.295151    0.829615    0.813776    0.573338    0.155813    0.161392    0.266401    0.256805    0.483312    0.467254    0.829615    0.813776    4000        25.493945   0.456035    0.000000    0.210716    162.407166 
[37m[36mINFO[0m[0m 02/25 03:58:20 | 0.304570    0.297733    0.851073    0.851190    0.496424    0.215397    0.227848    0.229169    0.229584    0.469144    0.435768    0.851073    0.851190    4200        26.768642   0.453745    0.000000    0.210545    170.395968 
[37m[36mINFO[0m[0m 02/25 04:02:00 | 0.377446    0.373903    0.860846    0.840986    0.489988    0.288162    0.303797    0.313006    0.304058    0.531171    0.513854    0.860846    0.840986    4400        28.043340   0.425474    0.000000    0.253110    169.257210 
[37m[36mINFO[0m[0m 02/25 04:05:38 | 0.424683    0.417967    0.860208    0.828231    0.567927    0.392038    0.396624    0.358711    0.347201    0.523300    0.510076    0.860208    0.828231    4600        29.318037   0.413800    0.000000    0.238587    170.243641 
[37m[36mINFO[0m[0m 02/25 04:09:04 | 0.374148    0.377203    0.864032    0.824830    0.521548    0.276298    0.285865    0.337014    0.336929    0.509131    0.508816    0.864032    0.824830    4800        30.592734   0.403911    0.000000    0.204339    165.061990 
[37m[36mINFO[0m[0m 02/25 04:12:35 | 0.291213    0.295046    0.866157    0.846939    0.496282    0.106776    0.119198    0.247657    0.247047    0.519207    0.518892    0.866157    0.846939    5000        31.867431   0.394602    0.000000    0.212981    168.523330 
[37m[36mINFO[0m[0m 02/25 04:12:35 | Cumulative gradient change saved at train_output/TerraIncognita/CORAL/[0, 1, 2]/250225_02-44-48_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/25 04:12:37 | ---
[37m[36mINFO[0m[0m 02/25 04:12:37 | test-domain validation(oracle) = 43.147%
[37m[36mINFO[0m[0m 02/25 04:12:37 | training-domain validation(iid) = 30.457%
[37m[36mINFO[0m[0m 02/25 04:12:37 | last = 29.121%
[37m[36mINFO[0m[0m 02/25 04:12:37 | last (inD) = 84.694%
[37m[36mINFO[0m[0m 02/25 04:12:37 | training-domain validation (iid, inD) = 85.119%
[37m[36mINFO[0m[0m 02/25 04:12:37 | === Summary ===
[37m[36mINFO[0m[0m 02/25 04:12:37 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 2 --hparams_seed 17
[37m[36mINFO[0m[0m 02/25 04:12:37 | Unique name: 250225_02-44-48_resnet50_GENIE
[37m[36mINFO[0m[0m 02/25 04:12:37 | Out path: train_output/TerraIncognita/CORAL/[0, 1, 2]/250225_02-44-48_resnet50_GENIE
[37m[36mINFO[0m[0m 02/25 04:12:37 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/25 04:12:37 | Dataset: TerraIncognita

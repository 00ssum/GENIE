[37m[36mINFO[0m[0m 02/20 13:53:56 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 2 --hparams_seed 20
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: CORAL
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 20
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/CORAL/[0, 1, 2]/250220_13-53-56_resnet50_GENIE
	out_root: train_output/TerraIncognita/CORAL/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 2
	unique_name: 250220_13-53-56_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 3.0575564760860844e-05
	batch_size: 27
	weight_decay: 7.45235722180653e-06
	mmd_gamma: 1.450436842057683
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/20 13:53:56 | n_steps = 5001
[37m[36mINFO[0m[0m 02/20 13:53:56 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/20 13:53:56 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/20 13:53:56 | 
[37m[36mINFO[0m[0m 02/20 13:53:56 | Testenv name escaping te_L100_L38_L43 -> te_L100_L38_L43
[37m[36mINFO[0m[0m 02/20 13:53:56 | Test envs = [0, 1, 2], name = te_L100_L38_L43
[37m[36mINFO[0m[0m 02/20 13:53:56 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 02/20 13:53:56 | Batch sizes for each domain: [0, 0, 0, 27] (total=27)
[37m[36mINFO[0m[0m 02/20 13:53:56 | steps-per-epoch for each domain: 174.33 -> min = 174.33
[37m[36mINFO[0m[0m 02/20 13:53:57 | # of params = 23528522
[37m[36mINFO[0m[0m 02/20 13:56:53 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        penalty     step_time   eval_time  
[37m[36mINFO[0m[0m 02/20 13:56:53 | 0.288403    0.273706    0.227746    0.211735    2.147994    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.227746    0.211735    0           0.000000    2.493870    0.000000    1.239793    174.583133 
[37m[36mINFO[0m[0m 02/20 14:00:32 | 0.335262    0.318572    0.458679    0.464286    1.412199    0.202742    0.200422    0.448196    0.427838    0.354849    0.327456    0.458679    0.464286    200         1.147228    1.510385    0.000000    0.217312    175.687144 
[37m[36mINFO[0m[0m 02/20 14:04:15 | 0.325826    0.314656    0.483110    0.470238    1.353230    0.229106    0.225738    0.417769    0.399589    0.330605    0.318640    0.483110    0.470238    400         2.294455    1.389295    0.000000    0.203031    181.578506 
[37m[36mINFO[0m[0m 02/20 14:07:45 | 0.238272    0.237543    0.596558    0.582483    1.122202    0.066438    0.074895    0.268969    0.273754    0.379408    0.363980    0.596558    0.582483    600         3.441683    1.167948    0.000000    0.215474    167.668350 
[37m[36mINFO[0m[0m 02/20 14:11:31 | 0.269122    0.268946    0.647121    0.653061    0.976106    0.408384    0.421941    0.075619    0.066256    0.323363    0.318640    0.647121    0.653061    800         4.588910    0.993416    0.000000    0.224037    180.344942 
[37m[36mINFO[0m[0m 02/20 14:15:13 | 0.275410    0.272880    0.704908    0.697279    0.859738    0.225415    0.246835    0.165361    0.158706    0.435453    0.413098    0.704908    0.697279    1000        5.736138    0.903105    0.000000    0.243165    173.824486 
[37m[36mINFO[0m[0m 02/20 14:18:55 | 0.446766    0.436434    0.700021    0.685374    0.916603    0.428421    0.447257    0.468866    0.451464    0.443010    0.410579    0.700021    0.685374    1200        6.883365    0.816970    0.000000    0.196766    182.708955 
[37m[36mINFO[0m[0m 02/20 14:22:26 | 0.232544    0.225664    0.762694    0.760204    0.708275    0.087530    0.081224    0.157016    0.147406    0.453086    0.448363    0.762694    0.760204    1400        8.030593    0.780036    0.000000    0.195971    171.907033 
[37m[36mINFO[0m[0m 02/20 14:25:56 | 0.278708    0.278913    0.734651    0.744898    0.753547    0.207751    0.234177    0.223777    0.225989    0.404597    0.376574    0.734651    0.744898    1600        9.177820    0.728299    0.000000    0.195949    171.035508 
[37m[36mINFO[0m[0m 02/20 14:29:41 | 0.270771    0.271631    0.765031    0.769558    0.676754    0.139467    0.157173    0.204648    0.199281    0.468199    0.458438    0.765031    0.769558    1800        10.325048   0.654002    0.000000    0.194546    185.161505 
[37m[36mINFO[0m[0m 02/20 14:33:16 | 0.277101    0.271929    0.773954    0.753401    0.708280    0.105721    0.124473    0.262421    0.256805    0.463161    0.434509    0.773954    0.753401    2000        11.472275   0.612026    0.000000    0.193458    176.611743 
[37m[36mINFO[0m[0m 02/20 14:36:51 | 0.381604    0.372483    0.794561    0.796769    0.644239    0.303190    0.303797    0.393889    0.384181    0.447733    0.429471    0.794561    0.796769    2200        12.619503   0.576585    0.000000    0.189080    176.884131 
[37m[36mINFO[0m[0m 02/20 14:40:20 | 0.336394    0.316639    0.774379    0.730442    0.811298    0.141313    0.132911    0.446270    0.427838    0.421599    0.389169    0.774379    0.730442    2400        13.766730   0.564545    0.000000    0.194194    170.924251 
[37m[36mINFO[0m[0m 02/20 14:43:51 | 0.363710    0.348221    0.795836    0.779762    0.642899    0.344055    0.337553    0.250225    0.239856    0.496851    0.467254    0.795836    0.779762    2600        14.913958   0.552805    0.000000    0.185966    173.038925 
[37m[36mINFO[0m[0m 02/20 14:47:28 | 0.390204    0.380671    0.805609    0.780612    0.649305    0.297390    0.291139    0.389909    0.381099    0.483312    0.469773    0.805609    0.780612    2800        16.061185   0.549404    0.000000    0.206244    176.487630 
[37m[36mINFO[0m[0m 02/20 14:50:57 | 0.343759    0.336626    0.819630    0.816327    0.546139    0.258634    0.264768    0.323020    0.316898    0.449622    0.428212    0.819630    0.816327    3000        17.208413   0.511475    0.000000    0.198027    168.780686 
[37m[36mINFO[0m[0m 02/20 14:54:23 | 0.342988    0.340636    0.806458    0.773810    0.840319    0.183232    0.200422    0.345102    0.332820    0.500630    0.488665    0.806458    0.773810    3200        18.355641   0.489324    0.000000    0.192628    167.603416 
[37m[36mINFO[0m[0m 02/20 14:57:50 | 0.326931    0.328363    0.825579    0.803571    0.588390    0.322436    0.342827    0.184491    0.181305    0.473866    0.460957    0.825579    0.803571    3400        19.502868   0.496009    0.000000    0.194440    168.436010 
[37m[36mINFO[0m[0m 02/20 15:01:18 | 0.299387    0.292547    0.840663    0.823980    0.565982    0.133931    0.138186    0.264861    0.258346    0.499370    0.481108    0.840663    0.823980    3600        20.650096   0.452534    0.000000    0.185251    171.175412 
[37m[36mINFO[0m[0m 02/20 15:04:46 | 0.323386    0.318412    0.838751    0.818027    0.566514    0.148168    0.144515    0.305302    0.296867    0.516688    0.513854    0.838751    0.818027    3800        21.797323   0.421203    0.000000    0.186497    170.681192 
[37m[36mINFO[0m[0m 02/20 15:08:18 | 0.235444    0.239894    0.844699    0.809524    0.557602    0.211178    0.234177    0.059700    0.058552    0.435453    0.426952    0.844699    0.809524    4000        22.944551   0.429782    0.000000    0.191315    173.210174 
[37m[36mINFO[0m[0m 02/20 15:11:49 | 0.351822    0.343918    0.861270    0.829082    0.560967    0.312945    0.321730    0.268969    0.260401    0.473552    0.449622    0.861270    0.829082    4200        24.091778   0.441079    0.000000    0.193860    172.629025 
[37m[36mINFO[0m[0m 02/20 15:15:20 | 0.419750    0.410651    0.841938    0.795918    0.639543    0.349855    0.342827    0.431121    0.431947    0.478275    0.457179    0.841938    0.795918    4400        25.239006   0.397006    0.000000    0.189845    172.306359 
[37m[36mINFO[0m[0m 02/20 15:18:48 | 0.243985    0.224659    0.853622    0.817177    0.546591    0.072766    0.063291    0.148800    0.137134    0.510390    0.473552    0.853622    0.817177    4600        26.386233   0.402759    0.000000    0.188819    170.778275 
[37m[36mINFO[0m[0m 02/20 15:22:09 | 0.309345    0.301307    0.867431    0.819728    0.500206    0.139204    0.130802    0.300167    0.293272    0.488665    0.479849    0.867431    0.819728    4800        27.533461   0.404521    0.000000    0.211968    158.281052 
[37m[36mINFO[0m[0m 02/20 15:25:42 | 0.451874    0.440546    0.872105    0.842687    0.546840    0.473504    0.458861    0.347798    0.345146    0.534320    0.517632    0.872105    0.842687    5000        28.680688   0.372643    0.000000    0.213184    170.267372 
[37m[36mINFO[0m[0m 02/20 15:25:42 | Cumulative gradient change saved at train_output/TerraIncognita/CORAL/[0, 1, 2]/250220_13-53-56_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/20 15:25:43 | ---
[37m[36mINFO[0m[0m 02/20 15:25:43 | test-domain validation(oracle) = 45.187%
[37m[36mINFO[0m[0m 02/20 15:25:43 | training-domain validation(iid) = 45.187%
[37m[36mINFO[0m[0m 02/20 15:25:43 | last = 45.187%
[37m[36mINFO[0m[0m 02/20 15:25:43 | last (inD) = 84.269%
[37m[36mINFO[0m[0m 02/20 15:25:43 | training-domain validation (iid, inD) = 84.269%
[37m[36mINFO[0m[0m 02/20 15:25:43 | === Summary ===
[37m[36mINFO[0m[0m 02/20 15:25:43 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm CORAL --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 2 --hparams_seed 20
[37m[36mINFO[0m[0m 02/20 15:25:43 | Unique name: 250220_13-53-56_resnet50_GENIE
[37m[36mINFO[0m[0m 02/20 15:25:43 | Out path: train_output/TerraIncognita/CORAL/[0, 1, 2]/250220_13-53-56_resnet50_GENIE
[37m[36mINFO[0m[0m 02/20 15:25:43 | Algorithm: CORAL
[37m[36mINFO[0m[0m 02/20 15:25:43 | Dataset: TerraIncognita

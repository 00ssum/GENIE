[37m[36mINFO[0m[0m 03/12 01:37:46 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 16
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 16
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/TerraIncognita/ERM/[0]/250312_01-37-46_clip_vitb16_GENIE
	out_root: train_output/TerraIncognita/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250312_01-37-46_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 4.249952708249365e-05
	batch_size: 17
	weight_decay: 9.786966598736845e-06
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/12 01:37:46 | n_steps = 5001
[37m[36mINFO[0m[0m 03/12 01:37:46 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/12 01:37:46 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/12 01:37:46 | 
[37m[36mINFO[0m[0m 03/12 01:37:46 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 03/12 01:37:46 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 03/12 01:37:46 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/12 01:37:46 | Batch sizes for each domain: [0, 17, 17, 17] (total=51)
[37m[36mINFO[0m[0m 03/12 01:37:46 | steps-per-epoch for each domain: 458.18, 186.82, 276.88 -> min = 186.82
[37m[36mINFO[0m[0m 03/12 01:37:48 | # of params = 86197770
[37m[36mINFO[0m[0m 03/12 01:40:36 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/12 01:40:36 | 0.010546    0.020042    0.146040    0.130403    2.322892    0.010546    0.020042    0.006933    0.002568    0.270151    0.230479    0.161037    0.158163    0           0.000000    2.357336    1.505455    166.420031 
[37m[36mINFO[0m[0m 03/12 01:44:22 | 0.206169    0.215190    0.454180    0.487639    1.496944    0.206169    0.215190    0.582231    0.608115    0.361146    0.416877    0.419163    0.437925    200         1.070529    1.640067    0.301439    165.793662 
[37m[36mINFO[0m[0m 03/12 01:48:10 | 0.220670    0.231013    0.477511    0.494872    1.430507    0.220670    0.231013    0.579535    0.605033    0.402393    0.440806    0.450605    0.438776    400         2.141058    1.514786    0.310361    165.305242 
[37m[36mINFO[0m[0m 03/12 01:52:00 | 0.214079    0.216245    0.493254    0.516264    1.323188    0.214079    0.216245    0.593273    0.610169    0.426322    0.478589    0.460166    0.460034    600         3.211587    1.445359    0.302495    169.292492 
[37m[36mINFO[0m[0m 03/12 01:55:49 | 0.227524    0.237342    0.496697    0.515531    1.288501    0.227524    0.237342    0.594171    0.603493    0.437028    0.460957    0.458891    0.482143    800         4.282116    1.382758    0.319863    165.566048 
[37m[36mINFO[0m[0m 03/12 01:59:39 | 0.222515    0.235232    0.520361    0.528728    1.277886    0.222515    0.235232    0.621132    0.651772    0.458753    0.442065    0.481198    0.492347    1000        5.352645    1.333778    0.324000    164.574542 
[37m[36mINFO[0m[0m 03/12 02:03:32 | 0.216715    0.222574    0.527395    0.535323    1.232916    0.216715    0.222574    0.613558    0.617874    0.485516    0.500000    0.483110    0.488095    1200        6.423174    1.274119    0.346760    164.467753 
[37m[36mINFO[0m[0m 03/12 02:07:26 | 0.216188    0.217300    0.537946    0.551223    1.197036    0.216188    0.217300    0.639748    0.662558    0.490554    0.530227    0.483535    0.460884    1400        7.493703    1.218926    0.357043    162.553054 
[37m[36mINFO[0m[0m 03/12 02:11:26 | 0.121803    0.131857    0.565792    0.568368    1.128699    0.121803    0.131857    0.645269    0.659476    0.539043    0.522670    0.513066    0.522959    1600        8.564232    1.165481    0.358034    167.599097 
[37m[36mINFO[0m[0m 03/12 02:15:26 | 0.223833    0.229958    0.629113    0.626695    0.994407    0.223833    0.229958    0.667608    0.688752    0.618073    0.599496    0.601657    0.591837    1800        9.634761    1.050034    0.349421    170.146590 
[37m[36mINFO[0m[0m 03/12 02:19:15 | 0.104930    0.109705    0.663399    0.668765    0.906053    0.104930    0.109705    0.718963    0.748331    0.654282    0.642317    0.616953    0.615646    2000        10.705290   0.988035    0.314553    166.934301 
[37m[36mINFO[0m[0m 03/12 02:23:02 | 0.361192    0.387131    0.663465    0.667319    0.897727    0.361192    0.387131    0.702016    0.717514    0.650819    0.666247    0.637561    0.618197    2200        11.775819   0.942919    0.300976    166.431718 
[37m[36mINFO[0m[0m 03/12 02:26:47 | 0.156868    0.167722    0.664483    0.671507    0.907822    0.156868    0.167722    0.716523    0.737031    0.658060    0.644836    0.618866    0.632653    2400        12.846348   0.863980    0.292471    166.403924 
[37m[36mINFO[0m[0m 03/12 02:30:32 | 0.250989    0.272152    0.690140    0.687311    0.833594    0.250989    0.272152    0.725767    0.744735    0.687972    0.664987    0.656682    0.652211    2600        13.916877   0.823125    0.286581    167.783537 
[37m[36mINFO[0m[0m 03/12 02:34:18 | 0.194042    0.198312    0.707245    0.703964    0.804621    0.194042    0.198312    0.723071    0.740627    0.710327    0.692695    0.688337    0.678571    2800        14.987406   0.807458    0.279921    169.752167 
[37m[36mINFO[0m[0m 03/12 02:38:02 | 0.286317    0.281646    0.739842    0.733258    0.732236    0.286317    0.281646    0.767878    0.783256    0.747166    0.711587    0.704483    0.704932    3000        16.057935   0.775666    0.278330    168.196774 
[37m[36mINFO[0m[0m 03/12 02:41:42 | 0.221197    0.247890    0.741262    0.737997    0.717000    0.221197    0.247890    0.761715    0.785824    0.755038    0.731738    0.707032    0.696429    3200        17.128463   0.728354    0.274660    165.858184 
[37m[36mINFO[0m[0m 03/12 02:45:29 | 0.413657    0.418776    0.738245    0.752763    0.684703    0.413657    0.418776    0.741430    0.763739    0.748426    0.760705    0.724878    0.733844    3400        18.198992   0.717715    0.280162    170.621655 
[37m[36mINFO[0m[0m 03/12 02:49:13 | 0.329291    0.342827    0.756815    0.753098    0.674273    0.329291    0.342827    0.769675    0.771957    0.778652    0.759446    0.722116    0.727891    3600        19.269521   0.684683    0.264043    170.974304 
[37m[36mINFO[0m[0m 03/12 02:52:55 | 0.290535    0.322785    0.780694    0.781561    0.601123    0.290535    0.322785    0.794582    0.817668    0.796914    0.782116    0.750584    0.744898    3800        20.340050   0.677375    0.280024    166.353750 
[37m[36mINFO[0m[0m 03/12 02:56:35 | 0.404693    0.424051    0.791619    0.781599    0.595128    0.404693    0.424051    0.797278    0.787365    0.812972    0.797229    0.764606    0.760204    4000        21.410579   0.596872    0.275457    164.599584 
[37m[36mINFO[0m[0m 03/12 03:00:15 | 0.312418    0.331224    0.783630    0.777211    0.600490    0.312418    0.331224    0.789832    0.800205    0.800063    0.769521    0.760994    0.761905    4200        22.481108   0.593819    0.264351    167.305370 
[37m[36mINFO[0m[0m 03/12 03:03:55 | 0.389402    0.398734    0.771590    0.766469    0.648406    0.389402    0.398734    0.793427    0.803287    0.772670    0.770781    0.748672    0.725340    4400        23.551637   0.572351    0.268080    166.593452 
[37m[36mINFO[0m[0m 03/12 03:07:39 | 0.230424    0.240506    0.783318    0.773619    0.620275    0.230424    0.240506    0.777250    0.800205    0.820844    0.780856    0.751859    0.739796    4600        24.622166   0.572281    0.264805    170.287012 
[37m[36mINFO[0m[0m 03/12 03:11:20 | 0.225152    0.234177    0.804254    0.789300    0.572695    0.225152    0.234177    0.801258    0.804828    0.827141    0.788413    0.784364    0.774660    4800        25.692695   0.576124    0.258073    170.206397 
[37m[36mINFO[0m[0m 03/12 03:14:55 | 0.385974    0.407173    0.824277    0.794960    0.550263    0.385974    0.407173    0.827192    0.820236    0.850441    0.798489    0.795199    0.766156    5000        26.763224   0.516899    0.245204    165.463694 
[37m[36mINFO[0m[0m 03/12 03:14:55 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0]/250312_01-37-46_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/12 03:14:57 | ---
[37m[36mINFO[0m[0m 03/12 03:14:57 | test-domain validation(oracle) = 40.469%
[37m[36mINFO[0m[0m 03/12 03:14:57 | training-domain validation(iid) = 38.597%
[37m[36mINFO[0m[0m 03/12 03:14:57 | last = 38.597%
[37m[36mINFO[0m[0m 03/12 03:14:57 | last (inD) = 79.496%
[37m[36mINFO[0m[0m 03/12 03:14:57 | training-domain validation (iid, inD) = 79.496%
[37m[36mINFO[0m[0m 03/12 03:14:57 | === Summary ===
[37m[36mINFO[0m[0m 03/12 03:14:57 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 16
[37m[36mINFO[0m[0m 03/12 03:14:57 | Unique name: 250312_01-37-46_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 03:14:57 | Out path: train_output/TerraIncognita/ERM/[0]/250312_01-37-46_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 03:14:57 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/12 03:14:57 | Dataset: TerraIncognita

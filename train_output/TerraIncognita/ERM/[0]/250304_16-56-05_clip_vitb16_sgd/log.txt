[37m[36mINFO[0m[0m 03/04 16:56:05 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_sgd config/clip_vitb16_sgd.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_sgd.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_sgd
	out_dir: train_output/TerraIncognita/ERM/[0]/250304_16-56-05_clip_vitb16_sgd
	out_root: train_output/TerraIncognita/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250304_16-56-05_clip_vitb16_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: clip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/04 16:56:05 | n_steps = 5001
[37m[36mINFO[0m[0m 03/04 16:56:05 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/04 16:56:05 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/04 16:56:05 | 
[37m[36mINFO[0m[0m 03/04 16:56:05 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 03/04 16:56:05 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 03/04 16:56:05 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/04 16:56:05 | Batch sizes for each domain: [0, 32, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/04 16:56:05 | steps-per-epoch for each domain: 243.41, 99.25, 147.09 -> min = 99.25
[37m[36mINFO[0m[0m 03/04 16:56:07 | # of params = 86197770
[37m[36mINFO[0m[0m 03/04 16:58:53 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/04 16:58:53 | 0.132876    0.147679    0.243452    0.300039    2.277099    0.132876    0.147679    0.375658    0.443246    0.130353    0.181360    0.224347    0.275510    0           0.000000    2.252024    1.100500    165.052601 
[37m[36mINFO[0m[0m 03/04 17:02:59 | 0.201424    0.208861    0.358519    0.341549    1.909876    0.201424    0.208861    0.466042    0.481767    0.316121    0.304786    0.293393    0.238095    200         2.015113    2.040050    0.406601    164.059752 
[37m[36mINFO[0m[0m 03/04 17:07:00 | 0.201951    0.208861    0.401137    0.401757    1.790438    0.201951    0.208861    0.485300    0.517720    0.348237    0.362720    0.369875    0.324830    400         4.030227    1.848856    0.405816    160.401957 
[37m[36mINFO[0m[0m 03/04 17:11:09 | 0.204060    0.208861    0.430460    0.442495    1.701603    0.204060    0.208861    0.538965    0.573703    0.357683    0.370277    0.394731    0.383503    600         6.045340    1.742910    0.410026    166.561484 
[37m[36mINFO[0m[0m 03/04 17:15:13 | 0.207751    0.215190    0.448874    0.448749    1.631006    0.207751    0.215190    0.590063    0.593220    0.357368    0.362720    0.399193    0.390306    800         8.060453    1.677259    0.406898    162.317686 
[37m[36mINFO[0m[0m 03/04 17:19:15 | 0.208542    0.217300    0.464338    0.464929    1.563540    0.208542    0.217300    0.596739    0.607088    0.384761    0.377834    0.411515    0.409864    1000        10.075567   1.610877    0.405523    161.356823 
[37m[36mINFO[0m[0m 03/04 17:23:20 | 0.085157    0.107595    0.245203    0.252728    2.144336    0.085157    0.107595    0.310695    0.328197    0.244332    0.255668    0.180582    0.174320    1200        12.090680   1.565735    0.409139    162.831099 
[37m[36mINFO[0m[0m 03/04 17:27:28 | 0.209069    0.218354    0.485766    0.487442    1.471633    0.209069    0.218354    0.607523    0.633282    0.405542    0.403023    0.444232    0.426020    1400        14.105793   1.699026    0.410032    165.845095 
[37m[36mINFO[0m[0m 03/04 17:31:41 | 0.210651    0.220464    0.512577    0.509519    1.417561    0.210651    0.220464    0.634099    0.658449    0.422859    0.416877    0.480773    0.453231    1600        16.120907   1.460797    0.416898    170.391198 
[37m[36mINFO[0m[0m 03/04 17:35:46 | 0.216979    0.229958    0.538868    0.554160    1.366883    0.216979    0.229958    0.652715    0.669748    0.438287    0.469773    0.525600    0.522959    1800        18.136020   1.418262    0.409467    162.912570 
[37m[36mINFO[0m[0m 03/04 17:39:56 | 0.213288    0.220464    0.555353    0.557749    1.318555    0.213288    0.220464    0.667351    0.672830    0.466310    0.467254    0.532399    0.533163    2000        20.151134   1.373581    0.408808    168.492393 
[37m[36mINFO[0m[0m 03/04 17:44:04 | 0.220406    0.226793    0.580012    0.588180    1.254362    0.220406    0.226793    0.711645    0.715973    0.471348    0.492443    0.557043    0.556122    2200        22.166247   1.311117    0.406745    166.086998 
[37m[36mINFO[0m[0m 03/04 17:48:16 | 0.224624    0.236287    0.608144    0.618000    1.204973    0.224624    0.236287    0.724226    0.732409    0.514484    0.534005    0.585723    0.587585    2400        24.181360   1.255249    0.408439    170.936525 
[37m[36mINFO[0m[0m 03/04 17:52:20 | 0.233325    0.242616    0.621257    0.631043    1.161166    0.233325    0.242616    0.728720    0.730354    0.540617    0.571788    0.594434    0.590986    2600        26.196474   1.214974    0.410631    161.724517 
[37m[36mINFO[0m[0m 03/04 17:56:26 | 0.260216    0.276371    0.634200    0.641366    1.127473    0.260216    0.276371    0.732315    0.742681    0.560768    0.576826    0.609518    0.604592    2800        28.211587   1.178573    0.407207    164.413930 
[37m[36mINFO[0m[0m 03/04 18:00:29 | 0.293699    0.302743    0.649213    0.653632    1.090345    0.293699    0.302743    0.739376    0.743708    0.591310    0.605793    0.616953    0.611395    3000        30.226700   1.142736    0.406295    161.432310 
[37m[36mINFO[0m[0m 03/04 18:04:40 | 0.327182    0.347046    0.654269    0.663347    1.074537    0.327182    0.347046    0.737322    0.746276    0.607683    0.622166    0.617803    0.621599    3200        32.241814   1.142103    0.409089    169.331339 
[37m[36mINFO[0m[0m 03/04 18:08:46 | 0.299235    0.319620    0.662093    0.669570    1.027426    0.299235    0.319620    0.746309    0.749358    0.604534    0.633501    0.635437    0.625850    3400        34.256927   1.072873    0.407206    164.089615 
[37m[36mINFO[0m[0m 03/04 18:12:53 | 0.381756    0.428270    0.676598    0.688350    0.991580    0.381756    0.428270    0.748235    0.752953    0.635076    0.664987    0.646484    0.647109    3600        36.272040   1.074004    0.413632    164.517514 
[37m[36mINFO[0m[0m 03/04 18:17:04 | 0.377801    0.422996    0.686817    0.698926    0.963022    0.377801    0.422996    0.750417    0.753980    0.652078    0.691436    0.657956    0.651361    3800        38.287154   1.003402    0.405673    169.576510 
[37m[36mINFO[0m[0m 03/04 18:21:08 | 0.456367    0.496835    0.695419    0.704165    0.941230    0.456367    0.496835    0.750931    0.759117    0.659950    0.695214    0.675377    0.658163    4000        40.302267   1.084614    0.410479    162.632895 
[37m[36mINFO[0m[0m 03/04 18:25:11 | 0.491432    0.525316    0.702960    0.708688    0.921958    0.491432    0.525316    0.757222    0.770416    0.670970    0.683879    0.680688    0.671769    4200        42.317380   0.962701    0.407583    161.305023 
[37m[36mINFO[0m[0m 03/04 18:29:20 | 0.504614    0.537975    0.711063    0.717411    0.894219    0.504614    0.537975    0.764925    0.770416    0.676952    0.698992    0.691311    0.682823    4400        44.332494   0.946588    0.407403    167.655843 
[37m[36mINFO[0m[0m 03/04 18:33:30 | 0.472977    0.517932    0.719434    0.732042    0.871096    0.472977    0.517932    0.762871    0.763739    0.696474    0.734257    0.698959    0.698129    4600        46.347607   0.913395    0.409467    167.712549 
[37m[36mINFO[0m[0m 03/04 18:37:35 | 0.471131    0.522152    0.727212    0.732357    0.850363    0.471131    0.522152    0.763513    0.763739    0.708753    0.726700    0.709369    0.706633    4800        48.362720   0.879156    0.412069    162.953886 
[37m[36mINFO[0m[0m 03/04 18:41:41 | 0.468758    0.500000    0.726822    0.733902    0.844890    0.468758    0.500000    0.761715    0.759117    0.709383    0.734257    0.709369    0.708333    5000        50.377834   0.867926    0.412137    163.368876 
[37m[36mINFO[0m[0m 03/04 18:41:41 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0]/250304_16-56-05_clip_vitb16_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/04 18:41:43 | ---
[37m[36mINFO[0m[0m 03/04 18:41:43 | test-domain validation(oracle) = 50.461%
[37m[36mINFO[0m[0m 03/04 18:41:43 | training-domain validation(iid) = 46.876%
[37m[36mINFO[0m[0m 03/04 18:41:43 | last = 46.876%
[37m[36mINFO[0m[0m 03/04 18:41:43 | last (inD) = 73.390%
[37m[36mINFO[0m[0m 03/04 18:41:43 | training-domain validation (iid, inD) = 73.390%
[37m[36mINFO[0m[0m 03/04 18:41:43 | === Summary ===
[37m[36mINFO[0m[0m 03/04 18:41:43 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_sgd config/clip_vitb16_sgd.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita
[37m[36mINFO[0m[0m 03/04 18:41:43 | Unique name: 250304_16-56-05_clip_vitb16_sgd
[37m[36mINFO[0m[0m 03/04 18:41:43 | Out path: train_output/TerraIncognita/ERM/[0]/250304_16-56-05_clip_vitb16_sgd
[37m[36mINFO[0m[0m 03/04 18:41:43 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/04 18:41:43 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 03/12 11:01:17 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 1 --hparams_seed 14
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 14
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/TerraIncognita/ERM/[0]/250312_11-01-17_clip_vitb16_GENIE
	out_root: train_output/TerraIncognita/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 1
	unique_name: 250312_11-01-17_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.00011127987942826837
	batch_size: 12
	weight_decay: 3.236767350601091e-05
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/12 11:01:17 | n_steps = 5001
[37m[36mINFO[0m[0m 03/12 11:01:17 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/12 11:01:17 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/12 11:01:17 | 
[37m[36mINFO[0m[0m 03/12 11:01:17 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 03/12 11:01:17 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 03/12 11:01:17 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/12 11:01:17 | Batch sizes for each domain: [0, 12, 12, 12] (total=36)
[37m[36mINFO[0m[0m 03/12 11:01:17 | steps-per-epoch for each domain: 649.08, 264.67, 392.25 -> min = 264.67
[37m[36mINFO[0m[0m 03/12 11:01:20 | # of params = 86197770
[37m[36mINFO[0m[0m 03/12 11:04:06 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/12 11:04:06 | 0.011600    0.015823    0.104204    0.090631    2.348294    0.011600    0.015823    0.002824    0.003595    0.172544    0.132242    0.137242    0.136054    0           0.000000    2.409960    1.663016    164.940049 
[37m[36mINFO[0m[0m 03/12 11:07:45 | 0.377538    0.393460    0.447673    0.475753    1.534117    0.377538    0.393460    0.575555    0.545968    0.351700    0.406801    0.415764    0.474490    200         0.755668    1.637887    0.270534    165.003749 
[37m[36mINFO[0m[0m 03/12 11:11:23 | 0.228315    0.203586    0.471744    0.487331    1.457129    0.228315    0.203586    0.594300    0.582435    0.375000    0.409320    0.445932    0.470238    400         1.511335    1.517293    0.268302    164.486271 
[37m[36mINFO[0m[0m 03/12 11:15:00 | 0.228315    0.214135    0.474870    0.495711    1.442698    0.228315    0.214135    0.596482    0.599897    0.403652    0.440806    0.424474    0.446429    600         2.267003    1.487598    0.255190    165.021320 
[37m[36mINFO[0m[0m 03/12 11:18:30 | 0.217242    0.193038    0.494240    0.523514    1.406551    0.217242    0.193038    0.594942    0.611197    0.442695    0.487406    0.445082    0.471939    800         3.022670    1.479849    0.246213    161.028095 
[37m[36mINFO[0m[0m 03/12 11:22:01 | 0.211706    0.187764    0.466106    0.459835    1.379519    0.211706    0.187764    0.589678    0.571649    0.372481    0.363980    0.436159    0.443878    1000        3.778338    1.384261    0.227194    165.451214 
[37m[36mINFO[0m[0m 03/12 11:25:32 | 0.210124    0.193038    0.519141    0.547552    1.258203    0.210124    0.193038    0.604827    0.602979    0.476071    0.522670    0.476524    0.517007    1200        4.534005    1.360234    0.208632    169.628847 
[37m[36mINFO[0m[0m 03/12 11:28:58 | 0.218033    0.191983    0.534180    0.547427    1.257002    0.218033    0.191983    0.623187    0.631741    0.511965    0.540302    0.467389    0.470238    1400        5.289673    1.287909    0.223147    161.694913 
[37m[36mINFO[0m[0m 03/12 11:32:20 | 0.204587    0.193038    0.546333    0.550555    1.203970    0.204587    0.193038    0.651432    0.643041    0.509131    0.523929    0.478436    0.484694    1600        6.045340    1.245554    0.192886    162.739713 
[37m[36mINFO[0m[0m 03/12 11:35:40 | 0.225152    0.200422    0.554404    0.571145    1.188139    0.225152    0.200422    0.642701    0.669235    0.525504    0.568010    0.495007    0.476190    1800        6.801008    1.228860    0.196416    161.416297 
[37m[36mINFO[0m[0m 03/12 11:38:58 | 0.131822    0.132911    0.575453    0.552936    1.205916    0.131822    0.132911    0.669919    0.633282    0.549748    0.565491    0.506692    0.460034    2000        7.556675    1.188370    0.180910    161.204977 
[37m[36mINFO[0m[0m 03/12 11:42:22 | 0.160823    0.142405    0.574610    0.584090    1.143406    0.160823    0.142405    0.655026    0.665639    0.537469    0.541562    0.531336    0.545068    2200        8.312343    1.142192    0.206096    162.563278 
[37m[36mINFO[0m[0m 03/12 11:45:52 | 0.092012    0.097046    0.581298    0.584823    1.109965    0.092012    0.097046    0.633457    0.627632    0.573363    0.589421    0.537072    0.537415    2400        9.068010    1.128804    0.245589    160.823174 
[37m[36mINFO[0m[0m 03/12 11:49:26 | 0.220142    0.201477    0.607662    0.612418    1.062035    0.220142    0.201477    0.664784    0.684129    0.611146    0.628463    0.547058    0.524660    2600        9.823678    1.073244    0.262511    161.726102 
[37m[36mINFO[0m[0m 03/12 11:52:48 | 0.188769    0.190928    0.634987    0.632236    1.015633    0.188769    0.190928    0.699576    0.697483    0.636020    0.647355    0.569365    0.551871    2800        10.579345   1.038943    0.191595    163.472653 
[37m[36mINFO[0m[0m 03/12 11:56:07 | 0.143422    0.135021    0.628169    0.635066    1.004849    0.143422    0.135021    0.703941    0.719569    0.606738    0.613350    0.573826    0.572279    3000        11.335013   1.009098    0.191085    160.727024 
[37m[36mINFO[0m[0m 03/12 11:59:32 | 0.235434    0.221519    0.643257    0.645070    0.997281    0.235434    0.221519    0.685711    0.705187    0.643892    0.666247    0.600170    0.563776    3200        12.090680   0.996728    0.194133    166.549836 
[37m[36mINFO[0m[0m 03/12 12:02:55 | 0.199315    0.200422    0.668124    0.668351    0.926498    0.199315    0.200422    0.708692    0.716487    0.670655    0.676322    0.625027    0.612245    3400        12.846348   0.983606    0.212332    160.350938 
[37m[36mINFO[0m[0m 03/12 12:06:29 | 0.129185    0.138186    0.651916    0.637780    0.979203    0.129185    0.138186    0.685454    0.682589    0.644207    0.642317    0.626089    0.588435    3600        13.602015   0.975953    0.234117    167.092566 
[37m[36mINFO[0m[0m 03/12 12:10:09 | 0.217770    0.243671    0.643529    0.642743    0.965839    0.217770    0.243671    0.702529    0.702106    0.623426    0.638539    0.604631    0.587585    3800        14.357683   0.929315    0.253384    169.770263 
[37m[36mINFO[0m[0m 03/12 12:13:49 | 0.279989    0.287975    0.666651    0.658911    0.929819    0.279989    0.287975    0.696752    0.707756    0.681360    0.678841    0.621840    0.590136    4000        15.113350   0.905014    0.249272    169.909784 
[37m[36mINFO[0m[0m 03/12 12:17:22 | 0.191933    0.201477    0.674693    0.665458    0.894771    0.191933    0.201477    0.724098    0.715460    0.675378    0.676322    0.624602    0.604592    4200        15.869018   0.863939    0.243188    164.336259 
[37m[36mINFO[0m[0m 03/12 12:21:04 | 0.282099    0.278481    0.698475    0.697711    0.834694    0.282099    0.278481    0.724997    0.752953    0.699937    0.696474    0.670491    0.643707    4400        16.624685   0.870299    0.260675    170.483592 
[37m[36mINFO[0m[0m 03/12 12:24:37 | 0.222515    0.214135    0.675463    0.657444    0.900284    0.222515    0.214135    0.704327    0.694915    0.685139    0.683879    0.636924    0.593537    4600        17.380353   0.817813    0.256876    160.739545 
[37m[36mINFO[0m[0m 03/12 12:28:14 | 0.143158    0.171941    0.722234    0.710900    0.779957    0.143158    0.171941    0.760560    0.751926    0.715680    0.714106    0.690461    0.666667    4800        18.136020   0.818324    0.273898    162.388082 
[37m[36mINFO[0m[0m 03/12 12:31:52 | 0.335355    0.348101    0.721015    0.695540    0.812625    0.335355    0.348101    0.746694    0.751412    0.723552    0.686398    0.692798    0.648810    5000        18.891688   0.787245    0.268767    164.530004 
[37m[36mINFO[0m[0m 03/12 12:31:52 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0]/250312_11-01-17_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/12 12:31:54 | ---
[37m[36mINFO[0m[0m 03/12 12:31:54 | test-domain validation(oracle) = 37.754%
[37m[36mINFO[0m[0m 03/12 12:31:54 | training-domain validation(iid) = 14.316%
[37m[36mINFO[0m[0m 03/12 12:31:54 | last = 33.535%
[37m[36mINFO[0m[0m 03/12 12:31:54 | last (inD) = 69.554%
[37m[36mINFO[0m[0m 03/12 12:31:54 | training-domain validation (iid, inD) = 71.090%
[37m[36mINFO[0m[0m 03/12 12:31:54 | === Summary ===
[37m[36mINFO[0m[0m 03/12 12:31:54 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 1 --hparams_seed 14
[37m[36mINFO[0m[0m 03/12 12:31:54 | Unique name: 250312_11-01-17_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 12:31:54 | Out path: train_output/TerraIncognita/ERM/[0]/250312_11-01-17_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 12:31:54 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/12 12:31:54 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 03/11 20:56:57 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 13
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 13
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/TerraIncognita/ERM/[0]/250311_20-56-57_clip_vitb16_GENIE
	out_root: train_output/TerraIncognita/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250311_20-56-57_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.00014596629881421895
	batch_size: 9
	weight_decay: 0.0009399117661702502
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/11 20:56:57 | n_steps = 5001
[37m[36mINFO[0m[0m 03/11 20:56:57 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/11 20:56:57 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/11 20:56:57 | 
[37m[36mINFO[0m[0m 03/11 20:56:57 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 03/11 20:56:57 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 03/11 20:56:57 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/11 20:56:57 | Batch sizes for each domain: [0, 9, 9, 9] (total=27)
[37m[36mINFO[0m[0m 03/11 20:56:57 | steps-per-epoch for each domain: 865.44, 352.89, 523.00 -> min = 352.89
[37m[36mINFO[0m[0m 03/11 20:56:59 | # of params = 86197770
[37m[36mINFO[0m[0m 03/11 20:59:48 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/11 20:59:48 | 0.009755    0.018987    0.146960    0.131232    2.327825    0.009755    0.018987    0.004237    0.002568    0.275819    0.235516    0.160824    0.155612    0           0.000000    2.312391    1.029265    167.451374 
[37m[36mINFO[0m[0m 03/11 21:03:17 | 0.199578    0.207806    0.440900    0.467952    1.536463    0.199578    0.207806    0.574400    0.621983    0.337846    0.367758    0.410453    0.414116    200         0.566751    1.694809    0.165523    175.825323 
[37m[36mINFO[0m[0m 03/11 21:06:50 | 0.206697    0.216245    0.436273    0.443647    1.502645    0.206697    0.216245    0.559507    0.589625    0.350756    0.347607    0.398555    0.393707    400         1.133501    1.578299    0.216308    170.084718 
[37m[36mINFO[0m[0m 03/11 21:10:25 | 0.206697    0.209916    0.480854    0.514939    1.451249    0.206697    0.209916    0.589421    0.637904    0.408060    0.464736    0.445082    0.442177    600         1.700252    1.492786    0.217540    171.601442 
[37m[36mINFO[0m[0m 03/11 21:13:55 | 0.195624    0.194093    0.467332    0.486287    1.470937    0.195624    0.194093    0.595070    0.618387    0.373741    0.406801    0.433185    0.433673    800         2.267003    1.491957    0.205889    168.979592 
[37m[36mINFO[0m[0m 03/11 21:17:24 | 0.258107    0.280591    0.484211    0.511593    1.435308    0.258107    0.280591    0.580691    0.608629    0.434509    0.489924    0.437434    0.436224    1000        2.833753    1.487913    0.178071    172.947125 
[37m[36mINFO[0m[0m 03/11 21:20:39 | 0.199842    0.214135    0.487509    0.520408    1.386286    0.199842    0.214135    0.596996    0.623010    0.420025    0.477330    0.445507    0.460884    1200        3.400504    1.464385    0.144983    165.957551 
[37m[36mINFO[0m[0m 03/11 21:24:03 | 0.200105    0.209916    0.496256    0.519936    1.354817    0.200105    0.209916    0.602516    0.629687    0.428212    0.478589    0.458041    0.451531    1400        3.967254    1.403566    0.206526    163.000873 
[37m[36mINFO[0m[0m 03/11 21:27:32 | 0.211178    0.218354    0.496327    0.511415    1.339015    0.211178    0.218354    0.600334    0.618387    0.432305    0.463476    0.456342    0.452381    1600        4.534005    1.382015    0.223619    163.637391 
[37m[36mINFO[0m[0m 03/11 21:31:02 | 0.209860    0.219409    0.494573    0.532505    1.333891    0.209860    0.219409    0.606753    0.665126    0.423174    0.467254    0.453792    0.465136    1800        5.100756    1.371462    0.219933    166.454144 
[37m[36mINFO[0m[0m 03/11 21:34:25 | 0.218561    0.220464    0.517517    0.538176    1.302127    0.218561    0.220464    0.614071    0.640986    0.475126    0.507557    0.463352    0.465986    2000        5.667506    1.345419    0.179693    166.673870 
[37m[36mINFO[0m[0m 03/11 21:37:47 | 0.200896    0.218354    0.504948    0.501777    1.272173    0.200896    0.218354    0.626525    0.654340    0.441751    0.415617    0.446569    0.435374    2200        6.234257    1.332533    0.162862    169.359182 
[37m[36mINFO[0m[0m 03/11 21:41:07 | 0.213288    0.223629    0.523241    0.536465    1.263527    0.213288    0.223629    0.627167    0.664099    0.480479    0.488665    0.462078    0.456633    2400        6.801008    1.308145    0.150872    170.630485 
[37m[36mINFO[0m[0m 03/11 21:44:43 | 0.218824    0.229958    0.529188    0.555400    1.268632    0.218824    0.229958    0.630761    0.662044    0.470718    0.507557    0.486085    0.496599    2600        7.367758    1.261041    0.215155    173.039491 
[37m[36mINFO[0m[0m 03/11 21:48:17 | 0.205378    0.215190    0.524320    0.531655    1.225118    0.205378    0.215190    0.619335    0.642013    0.496222    0.488665    0.457404    0.464286    2800        7.934509    1.233086    0.220874    169.720844 
[37m[36mINFO[0m[0m 03/11 21:51:52 | 0.219615    0.232068    0.536725    0.545029    1.188492    0.219615    0.232068    0.606496    0.615819    0.503149    0.522670    0.500531    0.496599    3000        8.501259    1.223801    0.203995    173.666544 
[37m[36mINFO[0m[0m 03/11 21:55:16 | 0.192196    0.212025    0.557263    0.567618    1.141104    0.192196    0.212025    0.662729    0.688238    0.497481    0.487406    0.511579    0.527211    3200        9.068010    1.210131    0.178683    168.089642 
[37m[36mINFO[0m[0m 03/11 21:58:37 | 0.206169    0.215190    0.535404    0.547556    1.156921    0.206169    0.215190    0.655668    0.677966    0.478904    0.467254    0.471638    0.497449    3400        9.634761    1.194454    0.158454    169.873023 
[37m[36mINFO[0m[0m 03/11 22:01:57 | 0.192987    0.190928    0.566023    0.577224    1.137640    0.192987    0.190928    0.647195    0.672316    0.544395    0.546599    0.506480    0.512755    3600        10.201511   1.160564    0.168993    165.936484 
[37m[36mINFO[0m[0m 03/11 22:05:36 | 0.179541    0.188819    0.575816    0.574397    1.119257    0.179541    0.188819    0.669791    0.690293    0.545655    0.554156    0.512003    0.478741    3800        10.768262   1.166754    0.220726    174.913390 
[37m[36mINFO[0m[0m 03/11 22:09:10 | 0.112576    0.135021    0.573093    0.593059    1.116384    0.112576    0.135021    0.689947    0.712892    0.525189    0.536524    0.504143    0.529762    4000        11.335013   1.126047    0.218073    170.240831 
[37m[36mINFO[0m[0m 03/11 22:12:37 | 0.192196    0.199367    0.586140    0.599825    1.082614    0.192196    0.199367    0.669534    0.695942    0.563287    0.583123    0.525600    0.520408    4200        11.901763   1.106112    0.195488    167.861530 
[37m[36mINFO[0m[0m 03/11 22:15:59 | 0.230424    0.242616    0.605820    0.604809    1.071345    0.230424    0.242616    0.673899    0.692347    0.592254    0.595718    0.551307    0.526361    4400        12.468514   1.091565    0.184059    165.449011 
[37m[36mINFO[0m[0m 03/11 22:19:14 | 0.098339    0.107595    0.596455    0.587756    1.095957    0.098339    0.107595    0.671075    0.689779    0.582494    0.571788    0.535798    0.501701    4600        13.035264   1.078633    0.143324    166.405182 
[37m[36mINFO[0m[0m 03/11 22:22:36 | 0.161086    0.175105    0.609495    0.606358    1.042892    0.161086    0.175105    0.693414    0.703133    0.591625    0.576826    0.543446    0.539116    4800        13.602015   1.058971    0.193927    163.135678 
[37m[36mINFO[0m[0m 03/11 22:25:53 | 0.195887    0.209916    0.612206    0.620568    1.035048    0.195887    0.209916    0.672615    0.701079    0.614610    0.607053    0.549395    0.553571    5000        14.168766   1.039940    0.143299    167.922229 
[37m[36mINFO[0m[0m 03/11 22:25:53 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0]/250311_20-56-57_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/11 22:25:57 | ---
[37m[36mINFO[0m[0m 03/11 22:25:57 | test-domain validation(oracle) = 25.811%
[37m[36mINFO[0m[0m 03/11 22:25:57 | training-domain validation(iid) = 19.589%
[37m[36mINFO[0m[0m 03/11 22:25:57 | last = 19.589%
[37m[36mINFO[0m[0m 03/11 22:25:57 | last (inD) = 62.057%
[37m[36mINFO[0m[0m 03/11 22:25:57 | training-domain validation (iid, inD) = 62.057%
[37m[36mINFO[0m[0m 03/11 22:25:57 | === Summary ===
[37m[36mINFO[0m[0m 03/11 22:25:57 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 13
[37m[36mINFO[0m[0m 03/11 22:25:57 | Unique name: 250311_20-56-57_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/11 22:25:57 | Out path: train_output/TerraIncognita/ERM/[0]/250311_20-56-57_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/11 22:25:57 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/11 22:25:57 | Dataset: TerraIncognita

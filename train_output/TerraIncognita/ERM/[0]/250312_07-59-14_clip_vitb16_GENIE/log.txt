[37m[36mINFO[0m[0m 03/12 07:59:14 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 1 --hparams_seed 11
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 11
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/TerraIncognita/ERM/[0]/250312_07-59-14_clip_vitb16_GENIE
	out_root: train_output/TerraIncognita/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 1
	unique_name: 250312_07-59-14_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5.340583028754034e-05
	batch_size: 10
	weight_decay: 2.5000172438864113e-05
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/12 07:59:14 | n_steps = 5001
[37m[36mINFO[0m[0m 03/12 07:59:14 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/12 07:59:14 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/12 07:59:14 | 
[37m[36mINFO[0m[0m 03/12 07:59:14 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 03/12 07:59:14 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 03/12 07:59:14 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/12 07:59:14 | Batch sizes for each domain: [0, 10, 10, 10] (total=30)
[37m[36mINFO[0m[0m 03/12 07:59:14 | steps-per-epoch for each domain: 778.90, 317.60, 470.70 -> min = 317.60
[37m[36mINFO[0m[0m 03/12 07:59:16 | # of params = 86197770
[37m[36mINFO[0m[0m 03/12 08:02:01 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/12 08:02:01 | 0.011600    0.015823    0.114240    0.103428    2.294787    0.011600    0.015823    0.002311    0.002568    0.205290    0.175063    0.135118    0.132653    0           0.000000    2.415665    0.930926    164.361356 
[37m[36mINFO[0m[0m 03/12 08:05:26 | 0.280780    0.264768    0.431977    0.460159    1.530804    0.280780    0.264768    0.566055    0.594761    0.350441    0.366499    0.379435    0.419218    200         0.629723    1.660939    0.212401    162.257321 
[37m[36mINFO[0m[0m 03/12 08:08:51 | 0.206960    0.179325    0.454520    0.484304    1.493373    0.206960    0.179325    0.563615    0.560349    0.371222    0.423174    0.428723    0.469388    400         1.259446    1.557370    0.200344    165.172953 
[37m[36mINFO[0m[0m 03/12 08:12:20 | 0.216188    0.188819    0.472256    0.494736    1.412480    0.216188    0.188819    0.585955    0.570108    0.392317    0.434509    0.438496    0.479592    600         1.889169    1.518808    0.192760    169.971408 
[37m[36mINFO[0m[0m 03/12 08:15:37 | 0.306617    0.303797    0.477406    0.518601    1.431355    0.306617    0.303797    0.580691    0.589625    0.427267    0.484887    0.424262    0.481293    800         2.518892    1.434376    0.163662    164.369507 
[37m[36mINFO[0m[0m 03/12 08:18:56 | 0.224888    0.198312    0.487376    0.507229    1.406902    0.224888    0.198312    0.582360    0.570621    0.428526    0.469773    0.451243    0.481293    1000        3.148615    1.439863    0.164360    166.374235 
[37m[36mINFO[0m[0m 03/12 08:22:16 | 0.220406    0.205696    0.467841    0.469800    1.424664    0.220406    0.205696    0.585955    0.582435    0.389484    0.399244    0.428086    0.427721    1200        3.778338    1.405804    0.165825    166.270533 
[37m[36mINFO[0m[0m 03/12 08:25:37 | 0.209069    0.188819    0.498820    0.516619    1.349788    0.209069    0.188819    0.575170    0.563431    0.464736    0.497481    0.456554    0.488946    1400        4.408060    1.395747    0.166693    168.438494 
[37m[36mINFO[0m[0m 03/12 08:28:53 | 0.209860    0.181435    0.502418    0.528425    1.267267    0.209860    0.181435    0.614328    0.606061    0.429786    0.496222    0.463140    0.482993    1600        5.037783    1.308510    0.168284    162.181193 
[37m[36mINFO[0m[0m 03/12 08:32:22 | 0.208806    0.187764    0.513521    0.520284    1.241608    0.208806    0.187764    0.630119    0.637904    0.439232    0.440806    0.471213    0.482143    1800        5.667506    1.307741    0.175814    173.645217 
[37m[36mINFO[0m[0m 03/12 08:35:43 | 0.215924    0.194093    0.525316    0.544949    1.243727    0.215924    0.194093    0.598023    0.593220    0.498426    0.536524    0.479499    0.505102    2000        6.297229    1.275975    0.173189    165.938700 
[37m[36mINFO[0m[0m 03/12 08:39:12 | 0.213288    0.196203    0.529590    0.543497    1.236750    0.213288    0.196203    0.616254    0.617874    0.488980    0.544081    0.483535    0.468537    2200        6.926952    1.244805    0.176157    173.793499 
[37m[36mINFO[0m[0m 03/12 08:42:34 | 0.217770    0.188819    0.551992    0.560706    1.218260    0.217770    0.188819    0.641161    0.646122    0.504723    0.511335    0.510091    0.524660    2400        7.556675    1.208005    0.204996    161.542723 
[37m[36mINFO[0m[0m 03/12 08:45:59 | 0.141313    0.120253    0.560222    0.573101    1.170840    0.141313    0.120253    0.636282    0.632768    0.527708    0.549118    0.516677    0.537415    2600        8.186398    1.189002    0.194111    166.364035 
[37m[36mINFO[0m[0m 03/12 08:49:24 | 0.154759    0.142405    0.578380    0.583553    1.165906    0.154759    0.142405    0.682244    0.692347    0.544081    0.561713    0.508817    0.496599    2800        8.816121    1.177541    0.199930    164.994358 
[37m[36mINFO[0m[0m 03/12 08:53:04 | 0.215133    0.189873    0.580779    0.595986    1.108509    0.215133    0.189873    0.655668    0.666667    0.562343    0.590680    0.524325    0.530612    3000        9.445844    1.174663    0.265614    166.794541 
[37m[36mINFO[0m[0m 03/12 08:56:39 | 0.148959    0.152954    0.583461    0.601719    1.081827    0.148959    0.152954    0.661446    0.684643    0.532746    0.551637    0.556193    0.568878    3200        10.075567   1.100449    0.227829    168.967583 
[37m[36mINFO[0m[0m 03/12 09:00:08 | 0.162141    0.147679    0.598925    0.605944    1.093689    0.162141    0.147679    0.645911    0.646122    0.576826    0.604534    0.574039    0.567177    3400        10.705290   1.110341    0.206005    167.414401 
[37m[36mINFO[0m[0m 03/12 09:03:31 | 0.088584    0.085443    0.629779    0.633951    1.021657    0.088584    0.085443    0.702658    0.699538    0.610516    0.638539    0.576163    0.563776    3600        11.335013   1.068478    0.202070    162.952825 
[37m[36mINFO[0m[0m 03/12 09:06:54 | 0.250725    0.257384    0.616367    0.606216    1.061157    0.250725    0.257384    0.675953    0.675912    0.613980    0.609572    0.559167    0.533163    3800        11.964736   1.074838    0.187852    165.558060 
[37m[36mINFO[0m[0m 03/12 09:10:21 | 0.071711    0.083333    0.616937    0.625670    1.022281    0.071711    0.083333    0.686738    0.686697    0.608942    0.646096    0.555131    0.544218    4000        12.594458   1.051453    0.197444    167.898495 
[37m[36mINFO[0m[0m 03/12 09:13:48 | 0.201687    0.226793    0.648981    0.653642    0.965959    0.201687    0.226793    0.711003    0.717514    0.639169    0.649874    0.596771    0.593537    4200        13.224181   1.003411    0.177110    171.655125 
[37m[36mINFO[0m[0m 03/12 09:17:10 | 0.225415    0.218354    0.634648    0.640054    0.993914    0.225415    0.218354    0.695725    0.710324    0.638854    0.648615    0.569365    0.561224    4400        13.853904   1.005779    0.169175    168.070363 
[37m[36mINFO[0m[0m 03/12 09:20:28 | 0.101766    0.110759    0.658279    0.655083    0.971189    0.101766    0.110759    0.712800    0.716487    0.650819    0.663728    0.611217    0.585034    4600        14.483627   0.957680    0.177291    161.868345 
[37m[36mINFO[0m[0m 03/12 09:23:52 | 0.150277    0.154008    0.648519    0.636664    1.015515    0.150277    0.154008    0.690718    0.690293    0.639798    0.642317    0.615041    0.577381    4800        15.113350   0.945516    0.181580    168.059062 
[37m[36mINFO[0m[0m 03/12 09:27:17 | 0.150804    0.160338    0.649283    0.657169    0.953676    0.150804    0.160338    0.704583    0.715973    0.639484    0.666247    0.603782    0.589286    5000        15.743073   0.943594    0.174421    169.846781 
[37m[36mINFO[0m[0m 03/12 09:27:17 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0]/250312_07-59-14_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/12 09:27:19 | ---
[37m[36mINFO[0m[0m 03/12 09:27:19 | test-domain validation(oracle) = 30.662%
[37m[36mINFO[0m[0m 03/12 09:27:19 | training-domain validation(iid) = 15.080%
[37m[36mINFO[0m[0m 03/12 09:27:19 | last = 15.080%
[37m[36mINFO[0m[0m 03/12 09:27:19 | last (inD) = 65.717%
[37m[36mINFO[0m[0m 03/12 09:27:19 | training-domain validation (iid, inD) = 65.717%
[37m[36mINFO[0m[0m 03/12 09:27:19 | === Summary ===
[37m[36mINFO[0m[0m 03/12 09:27:19 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 1 --hparams_seed 11
[37m[36mINFO[0m[0m 03/12 09:27:19 | Unique name: 250312_07-59-14_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 09:27:19 | Out path: train_output/TerraIncognita/ERM/[0]/250312_07-59-14_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 09:27:19 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/12 09:27:19 | Dataset: TerraIncognita

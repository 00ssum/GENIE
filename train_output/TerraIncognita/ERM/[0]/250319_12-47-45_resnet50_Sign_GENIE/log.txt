[37m[36mINFO[0m[0m 03/19 12:47:45 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 12
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 12
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[0]/250319_12-47-45_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250319_12-47-45_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00012111338094255871
	batch_size: 9
	weight_decay: 1.821145631101786e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/19 12:47:45 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 12:47:45 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 12:47:45 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 12:47:45 | 
[37m[36mINFO[0m[0m 03/19 12:47:45 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 03/19 12:47:45 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 03/19 12:47:45 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 12:47:45 | Batch sizes for each domain: [0, 9, 9, 9] (total=27)
[37m[36mINFO[0m[0m 03/19 12:47:45 | steps-per-epoch for each domain: 865.44, 352.89, 523.00 -> min = 352.89
[37m[36mINFO[0m[0m 03/19 12:47:46 | # of params = 23528522
[37m[36mINFO[0m[0m 03/19 12:50:32 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 12:50:32 | 0.016873    0.028481    0.201779    0.164363    2.100327    0.016873    0.028481    0.133136    0.105804    0.295655    0.236776    0.176546    0.150510    0           0.000000    2.344731    0.913217    165.423994 
[37m[36mINFO[0m[0m 03/19 12:53:45 | 0.224888    0.231013    0.482907    0.490343    1.328454    0.224888    0.231013    0.594813    0.615819    0.414987    0.418136    0.438921    0.437075    200         0.566751    1.612706    0.112518    169.731921 
[37m[36mINFO[0m[0m 03/19 12:56:52 | 0.160823    0.165612    0.607116    0.622560    1.023975    0.160823    0.165612    0.697651    0.722137    0.583438    0.589421    0.540259    0.556122    400         1.133501    1.307651    0.114346    165.112154 
[37m[36mINFO[0m[0m 03/19 13:00:09 | 0.274453    0.270042    0.620991    0.633514    0.950566    0.274453    0.270042    0.740788    0.751926    0.515428    0.515113    0.606756    0.633503    600         1.700252    1.082912    0.126777    170.859520 
[37m[36mINFO[0m[0m 03/19 13:03:23 | 0.349855    0.386076    0.674553    0.690813    0.849048    0.349855    0.386076    0.747208    0.757576    0.653338    0.681360    0.623115    0.633503    800         2.267003    0.944679    0.112288    171.442154 
[37m[36mINFO[0m[0m 03/19 13:06:37 | 0.440021    0.464135    0.708246    0.714776    0.763750    0.440021    0.464135    0.757607    0.768875    0.700252    0.697733    0.666879    0.677721    1000        2.833753    0.847393    0.119959    170.668489 
[37m[36mINFO[0m[0m 03/19 13:09:54 | 0.486159    0.489451    0.679197    0.692577    0.837199    0.486159    0.489451    0.734241    0.750899    0.660264    0.676322    0.643085    0.650510    1200        3.400504    0.838653    0.124204    171.447345 
[37m[36mINFO[0m[0m 03/19 13:13:05 | 0.461113    0.492616    0.744579    0.754740    0.684260    0.461113    0.492616    0.785210    0.794042    0.732997    0.738035    0.715530    0.732143    1400        3.967254    0.835345    0.113098    169.129707 
[37m[36mINFO[0m[0m 03/19 13:16:19 | 0.538360    0.540084    0.738717    0.736236    0.678611    0.538360    0.540084    0.761458    0.774525    0.741499    0.726700    0.713193    0.707483    1600        4.534005    0.754915    0.114957    170.424075 
[37m[36mINFO[0m[0m 03/19 13:19:32 | 0.557079    0.561181    0.720613    0.718681    0.740588    0.557079    0.561181    0.752215    0.734463    0.726385    0.748111    0.683238    0.673469    1800        5.100756    0.757183    0.113228    170.790651 
[37m[36mINFO[0m[0m 03/19 13:22:47 | 0.616926    0.625527    0.757172    0.773416    0.630288    0.616926    0.625527    0.784825    0.796097    0.756927    0.773300    0.729764    0.750850    2000        5.667506    0.722001    0.117135    171.114449 
[37m[36mINFO[0m[0m 03/19 13:25:58 | 0.466913    0.473629    0.742841    0.743874    0.715641    0.466913    0.473629    0.779047    0.782229    0.724811    0.734257    0.724665    0.715136    2200        6.234257    0.713965    0.120363    166.724173 
[37m[36mINFO[0m[0m 03/19 13:29:03 | 0.398102    0.419831    0.751600    0.755708    0.683563    0.398102    0.419831    0.786751    0.794556    0.734887    0.750630    0.733163    0.721939    2400        6.801008    0.713678    0.115120    162.182589 
[37m[36mINFO[0m[0m 03/19 13:32:07 | 0.533615    0.534810    0.783019    0.786850    0.586956    0.533615    0.534810    0.815124    0.837185    0.776763    0.768262    0.757170    0.755102    2600        7.367758    0.672482    0.112137    161.867552 
[37m[36mINFO[0m[0m 03/19 13:35:18 | 0.379647    0.383966    0.768105    0.767530    0.646395    0.379647    0.383966    0.802414    0.814587    0.755353    0.740554    0.746548    0.747449    2800        7.934509    0.641685    0.114733    167.515579 
[37m[36mINFO[0m[0m 03/19 13:38:24 | 0.406538    0.419831    0.777756    0.773144    0.629230    0.406538    0.419831    0.811401    0.822804    0.764484    0.764484    0.757383    0.732143    3000        8.501259    0.645817    0.112203    163.785590 
[37m[36mINFO[0m[0m 03/19 13:41:31 | 0.597153    0.589662    0.795487    0.805140    0.540424    0.597153    0.589662    0.819617    0.839753    0.787154    0.801008    0.779690    0.774660    3200        9.068010    0.608659    0.110896    165.001182 
[37m[36mINFO[0m[0m 03/19 13:44:41 | 0.616399    0.597046    0.785113    0.785237    0.575373    0.616399    0.597046    0.808705    0.814587    0.780542    0.775819    0.766093    0.765306    3400        9.634761    0.626582    0.114995    166.812089 
[37m[36mINFO[0m[0m 03/19 13:47:51 | 0.527814    0.562236    0.792853    0.787468    0.587476    0.527814    0.562236    0.818847    0.840267    0.779597    0.764484    0.780115    0.757653    3600        10.201511   0.573494    0.117139    167.220014 
[37m[36mINFO[0m[0m 03/19 13:51:02 | 0.488532    0.498945    0.785475    0.784786    0.582474    0.488532    0.498945    0.804211    0.821263    0.784635    0.772040    0.767580    0.761054    3800        10.768262   0.595717    0.112204    168.262019 
[37m[36mINFO[0m[0m 03/19 13:54:20 | 0.409175    0.429325    0.795259    0.792161    0.553753    0.409175    0.429325    0.846450    0.865434    0.787469    0.767003    0.751859    0.744048    4000        11.335013   0.574324    0.127792    172.423614 
[37m[36mINFO[0m[0m 03/19 13:57:31 | 0.567361    0.599156    0.809275    0.807356    0.526064    0.567361    0.599156    0.842085    0.854648    0.796914    0.780856    0.788825    0.786565    4200        11.901763   0.557412    0.119624    166.979410 
[37m[36mINFO[0m[0m 03/19 14:00:45 | 0.489586    0.503165    0.814242    0.816223    0.532233    0.489586    0.503165    0.846322    0.854135    0.802267    0.788413    0.794136    0.806122    4400        12.468514   0.559303    0.113657    171.063016 
[37m[36mINFO[0m[0m 03/19 14:03:54 | 0.539678    0.550633    0.803058    0.802779    0.540707    0.539678    0.550633    0.839132    0.856189    0.795025    0.778338    0.775016    0.773810    4600        13.035264   0.540430    0.116739    166.051059 
[37m[36mINFO[0m[0m 03/19 14:07:17 | 0.487741    0.497890    0.820770    0.808647    0.509753    0.487741    0.497890    0.849788    0.851567    0.813287    0.802267    0.799235    0.772109    4800        13.602015   0.535046    0.137943    174.785336 
[37m[36mINFO[0m[0m 03/19 14:10:32 | 0.469022    0.495781    0.807309    0.806513    0.517614    0.469022    0.495781    0.835922    0.844376    0.810139    0.807305    0.775866    0.767857    5000        14.168766   0.515272    0.141628    167.482192 
[37m[36mINFO[0m[0m 03/19 14:10:33 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0]/250319_12-47-45_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 14:10:34 | ---
[37m[36mINFO[0m[0m 03/19 14:10:34 | test-domain validation(oracle) = 61.693%
[37m[36mINFO[0m[0m 03/19 14:10:34 | training-domain validation(iid) = 48.959%
[37m[36mINFO[0m[0m 03/19 14:10:34 | last = 46.902%
[37m[36mINFO[0m[0m 03/19 14:10:34 | last (inD) = 80.651%
[37m[36mINFO[0m[0m 03/19 14:10:34 | training-domain validation (iid, inD) = 81.622%
[37m[36mINFO[0m[0m 03/19 14:10:34 | === Summary ===
[37m[36mINFO[0m[0m 03/19 14:10:34 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 12
[37m[36mINFO[0m[0m 03/19 14:10:34 | Unique name: 250319_12-47-45_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 14:10:34 | Out path: train_output/TerraIncognita/ERM/[0]/250319_12-47-45_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 14:10:34 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 14:10:34 | Dataset: TerraIncognita

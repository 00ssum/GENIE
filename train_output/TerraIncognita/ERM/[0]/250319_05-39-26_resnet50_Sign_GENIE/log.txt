[37m[36mINFO[0m[0m 03/19 05:39:26 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 7
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 7
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[0]/250319_05-39-26_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250319_05-39-26_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 1.6632780446310692e-05
	batch_size: 24
	weight_decay: 5.717289389191427e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/19 05:39:26 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 05:39:26 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 05:39:26 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 05:39:26 | 
[37m[36mINFO[0m[0m 03/19 05:39:26 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 03/19 05:39:26 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 03/19 05:39:26 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 05:39:26 | Batch sizes for each domain: [0, 24, 24, 24] (total=72)
[37m[36mINFO[0m[0m 03/19 05:39:26 | steps-per-epoch for each domain: 324.54, 132.33, 196.12 -> min = 132.33
[37m[36mINFO[0m[0m 03/19 05:39:27 | # of params = 23528522
[37m[36mINFO[0m[0m 03/19 05:42:14 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 05:42:14 | 0.200633    0.208861    0.288045    0.304317    2.049818    0.200633    0.208861    0.455514    0.481253    0.186398    0.221662    0.222222    0.210034    0           0.000000    2.380955    0.953108    166.401832 
[37m[36mINFO[0m[0m 03/19 05:45:40 | 0.210651    0.229958    0.616775    0.635918    1.000982    0.210651    0.229958    0.671203    0.691834    0.602960    0.638539    0.576163    0.577381    200         1.511335    1.382514    0.182276    169.613814 
[37m[36mINFO[0m[0m 03/19 05:49:06 | 0.382810    0.411392    0.694671    0.705543    0.766566    0.382810    0.411392    0.770060    0.793015    0.670655    0.695214    0.643297    0.628401    400         3.022670    0.906794    0.192346    166.913432 
[37m[36mINFO[0m[0m 03/19 05:52:28 | 0.363037    0.398734    0.728727    0.747246    0.667422    0.363037    0.398734    0.783027    0.822291    0.699307    0.715365    0.703845    0.704082    600         4.534005    0.761731    0.191177    164.297100 
[37m[36mINFO[0m[0m 03/19 05:55:49 | 0.481413    0.492616    0.779981    0.785870    0.606732    0.481413    0.492616    0.811272    0.826913    0.781486    0.793451    0.747185    0.737245    800         6.045340    0.680998    0.184982    163.852476 
[37m[36mINFO[0m[0m 03/19 05:59:14 | 0.364092    0.382911    0.790276    0.789991    0.569218    0.364092    0.382911    0.803312    0.831022    0.793136    0.779597    0.774379    0.759354    1000        7.556675    0.637551    0.184039    168.073591 
[37m[36mINFO[0m[0m 03/19 06:02:32 | 0.451885    0.460970    0.802374    0.811768    0.526724    0.451885    0.460970    0.831044    0.853621    0.796599    0.795970    0.779477    0.785714    1200        9.068010    0.581880    0.187328    160.699980 
[37m[36mINFO[0m[0m 03/19 06:05:55 | 0.478777    0.482068    0.796381    0.810468    0.531573    0.478777    0.482068    0.800231    0.827427    0.798174    0.814861    0.790737    0.789116    1400        10.579345   0.539282    0.190841    164.711795 
[37m[36mINFO[0m[0m 03/19 06:09:21 | 0.440548    0.451477    0.813736    0.808662    0.532735    0.440548    0.451477    0.828348    0.838726    0.811713    0.792191    0.801147    0.795068    1600        12.090680   0.535900    0.187247    168.134543 
[37m[36mINFO[0m[0m 03/19 06:12:49 | 0.584761    0.588608    0.826314    0.816591    0.503336    0.584761    0.588608    0.842599    0.844376    0.819899    0.803526    0.816444    0.801871    1800        13.602015   0.485624    0.191201    170.593753 
[37m[36mINFO[0m[0m 03/19 06:16:12 | 0.405484    0.399789    0.826319    0.818934    0.473782    0.405484    0.399789    0.831814    0.846430    0.831549    0.813602    0.815594    0.796769    2000        15.113350   0.484600    0.189818    164.995435 
[37m[36mINFO[0m[0m 03/19 06:19:36 | 0.445294    0.450422    0.845263    0.837036    0.459523    0.445294    0.450422    0.857235    0.863893    0.851700    0.824937    0.826854    0.822279    2200        16.624685   0.471807    0.192589    165.339652 
[37m[36mINFO[0m[0m 03/19 06:23:07 | 0.568416    0.585443    0.849313    0.841769    0.437605    0.568416    0.585443    0.866992    0.881870    0.855793    0.821159    0.825154    0.822279    2400        18.136020   0.454419    0.193667    171.920748 
[37m[36mINFO[0m[0m 03/19 06:26:35 | 0.557079    0.541139    0.835878    0.828546    0.473412    0.557079    0.541139    0.873540    0.883924    0.803841    0.792191    0.830253    0.809524    2600        19.647355   0.415578    0.200345    168.341722 
[37m[36mINFO[0m[0m 03/19 06:30:02 | 0.571316    0.573840    0.862154    0.851485    0.412904    0.571316    0.573840    0.879702    0.889574    0.864610    0.840050    0.842150    0.824830    2800        21.158690   0.409176    0.196739    167.623221 
[37m[36mINFO[0m[0m 03/19 06:33:27 | 0.580016    0.570675    0.860266    0.847763    0.430274    0.580016    0.570675    0.868019    0.872111    0.867443    0.846348    0.845337    0.824830    3000        22.670025   0.395511    0.192030    166.685120 
[37m[36mINFO[0m[0m 03/19 06:36:55 | 0.580807    0.594937    0.861953    0.852281    0.418568    0.580807    0.594937    0.878162    0.884438    0.866184    0.850126    0.841513    0.822279    3200        24.181360   0.367791    0.180883    171.375500 
[37m[36mINFO[0m[0m 03/19 06:40:14 | 0.463485    0.455696    0.877974    0.858099    0.406147    0.463485    0.455696    0.895750    0.899846    0.884761    0.856423    0.853410    0.818027    3400        25.692695   0.366399    0.181677    162.407098 
[37m[36mINFO[0m[0m 03/19 06:43:39 | 0.434748    0.443038    0.877160    0.867675    0.399279    0.434748    0.443038    0.880601    0.880329    0.887909    0.874055    0.862970    0.848639    3600        27.204030   0.348236    0.193994    166.482369 
[37m[36mINFO[0m[0m 03/19 06:47:00 | 0.540733    0.536920    0.866247    0.848378    0.436360    0.540733    0.536920    0.877263    0.891115    0.877204    0.824937    0.844274    0.829082    3800        28.715365   0.336643    0.189611    163.319829 
[37m[36mINFO[0m[0m 03/19 06:50:24 | 0.581598    0.592827    0.885948    0.867102    0.405451    0.581598    0.592827    0.896521    0.899332    0.893892    0.865239    0.867431    0.836735    4000        30.226700   0.341408    0.184843    166.469642 
[37m[36mINFO[0m[0m 03/19 06:53:46 | 0.533878    0.536920    0.872083    0.856770    0.403800    0.533878    0.536920    0.885736    0.898819    0.876889    0.855164    0.853622    0.816327    4200        31.738035   0.333876    0.187012    165.109643 
[37m[36mINFO[0m[0m 03/19 06:57:19 | 0.430794    0.464135    0.875723    0.844675    0.452999    0.430794    0.464135    0.872898    0.860298    0.888539    0.846348    0.865732    0.827381    4400        33.249370   0.323066    0.197635    173.086596 
[37m[36mINFO[0m[0m 03/19 07:00:42 | 0.552333    0.556962    0.889015    0.862665    0.395839    0.552333    0.556962    0.895494    0.891628    0.909005    0.871537    0.862545    0.824830    4600        34.760705   0.311556    0.188132    165.648482 
[37m[36mINFO[0m[0m 03/19 07:04:05 | 0.547324    0.549578    0.886736    0.864417    0.389241    0.547324    0.549578    0.907305    0.894710    0.887594    0.867758    0.865307    0.830782    4800        36.272040   0.297568    0.192038    164.037462 
[37m[36mINFO[0m[0m 03/19 07:07:28 | 0.472449    0.468354    0.890137    0.867027    0.382012    0.472449    0.468354    0.891000    0.895737    0.909005    0.867758    0.870406    0.837585    5000        37.783375   0.294421    0.190339    165.052844 
[37m[36mINFO[0m[0m 03/19 07:07:28 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0]/250319_05-39-26_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 07:07:29 | ---
[37m[36mINFO[0m[0m 03/19 07:07:29 | test-domain validation(oracle) = 58.081%
[37m[36mINFO[0m[0m 03/19 07:07:29 | training-domain validation(iid) = 43.475%
[37m[36mINFO[0m[0m 03/19 07:07:29 | last = 47.245%
[37m[36mINFO[0m[0m 03/19 07:07:29 | last (inD) = 86.703%
[37m[36mINFO[0m[0m 03/19 07:07:29 | training-domain validation (iid, inD) = 86.767%
[37m[36mINFO[0m[0m 03/19 07:07:29 | === Summary ===
[37m[36mINFO[0m[0m 03/19 07:07:29 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 7
[37m[36mINFO[0m[0m 03/19 07:07:29 | Unique name: 250319_05-39-26_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 07:07:29 | Out path: train_output/TerraIncognita/ERM/[0]/250319_05-39-26_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 07:07:29 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 07:07:29 | Dataset: TerraIncognita

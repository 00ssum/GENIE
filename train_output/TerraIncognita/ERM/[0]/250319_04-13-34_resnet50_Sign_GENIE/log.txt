[37m[36mINFO[0m[0m 03/19 04:13:34 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 6
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 6
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[0]/250319_04-13-34_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250319_04-13-34_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 1.5764387170443743e-05
	batch_size: 19
	weight_decay: 0.0006024239579587198
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/19 04:13:34 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 04:13:34 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 04:13:34 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 04:13:34 | 
[37m[36mINFO[0m[0m 03/19 04:13:34 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 03/19 04:13:34 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 03/19 04:13:34 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 04:13:34 | Batch sizes for each domain: [0, 19, 19, 19] (total=57)
[37m[36mINFO[0m[0m 03/19 04:13:34 | steps-per-epoch for each domain: 409.95, 167.16, 247.74 -> min = 167.16
[37m[36mINFO[0m[0m 03/19 04:13:35 | # of params = 23528522
[37m[36mINFO[0m[0m 03/19 04:16:21 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 04:16:21 | 0.200633    0.208861    0.288255    0.304317    2.001506    0.200633    0.208861    0.455514    0.481253    0.187028    0.221662    0.222222    0.210034    0           0.000000    2.361235    0.916378    164.702326 
[37m[36mINFO[0m[0m 03/19 04:19:43 | 0.293435    0.304852    0.619372    0.635410    1.006068    0.293435    0.304852    0.700989    0.735490    0.594773    0.580605    0.562354    0.590136    200         1.196474    1.379519    0.153840    171.090203 
[37m[36mINFO[0m[0m 03/19 04:23:02 | 0.431848    0.431435    0.691418    0.699527    0.791365    0.431848    0.431435    0.750160    0.770930    0.666562    0.678841    0.657531    0.648810    400         2.392947    0.934483    0.158846    167.589808 
[37m[36mINFO[0m[0m 03/19 04:26:27 | 0.358555    0.362869    0.739015    0.744805    0.672563    0.358555    0.362869    0.751958    0.768875    0.742758    0.768262    0.722328    0.697279    600         3.589421    0.795387    0.163362    172.200394 
[37m[36mINFO[0m[0m 03/19 04:29:46 | 0.436857    0.432489    0.760554    0.778213    0.662069    0.436857    0.432489    0.789960    0.816127    0.755353    0.782116    0.736350    0.736395    800         4.785894    0.703257    0.168094    166.023743 
[37m[36mINFO[0m[0m 03/19 04:33:04 | 0.497495    0.478903    0.766873    0.780464    0.627375    0.497495    0.478903    0.808063    0.831536    0.746222    0.760705    0.746335    0.749150    1000        5.982368    0.652416    0.163903    164.506763 
[37m[36mINFO[0m[0m 03/19 04:36:30 | 0.441867    0.448312    0.779786    0.789918    0.588638    0.441867    0.448312    0.820259    0.844376    0.773615    0.777078    0.745485    0.748299    1200        7.178841    0.609710    0.159262    174.089921 
[37m[36mINFO[0m[0m 03/19 04:39:48 | 0.481413    0.495781    0.787277    0.793484    0.565605    0.481413    0.495781    0.823726    0.840781    0.783060    0.789673    0.755046    0.750000    1400        8.375315    0.598663    0.163166    165.974212 
[37m[36mINFO[0m[0m 03/19 04:43:11 | 0.542578    0.556962    0.793789    0.792860    0.562769    0.542578    0.556962    0.803312    0.809964    0.800063    0.787154    0.777990    0.781463    1600        9.571788    0.548135    0.166419    169.810262 
[37m[36mINFO[0m[0m 03/19 04:46:28 | 0.485895    0.478903    0.803822    0.799873    0.540468    0.485895    0.478903    0.833226    0.843349    0.793451    0.788413    0.784789    0.767857    1800        10.768262   0.545642    0.155943    165.227446 
[37m[36mINFO[0m[0m 03/19 04:49:45 | 0.571843    0.573840    0.821792    0.810773    0.518926    0.571843    0.573840    0.860187    0.872111    0.813602    0.779597    0.791587    0.780612    2000        11.964736   0.512841    0.159809    165.510771 
[37m[36mINFO[0m[0m 03/19 04:52:59 | 0.509359    0.506329    0.820361    0.806826    0.522526    0.509359    0.506329    0.849275    0.850539    0.819584    0.783375    0.792224    0.786565    2200        13.161209   0.505371    0.152957    163.380691 
[37m[36mINFO[0m[0m 03/19 04:56:17 | 0.439230    0.446203    0.816131    0.806650    0.514444    0.439230    0.446203    0.859931    0.871084    0.817695    0.802267    0.770767    0.746599    2400        14.357683   0.491882    0.159159    166.141386 
[37m[36mINFO[0m[0m 03/19 04:59:36 | 0.573425    0.570675    0.826415    0.821996    0.504545    0.573425    0.570675    0.860316    0.874165    0.819270    0.801008    0.799660    0.790816    2600        15.554156   0.457192    0.163801    166.066942 
[37m[36mINFO[0m[0m 03/19 05:02:54 | 0.527287    0.530591    0.849555    0.853430    0.436157    0.527287    0.530591    0.873283    0.880329    0.850441    0.857683    0.824942    0.822279    2800        16.750630   0.442890    0.162226    165.049953 
[37m[36mINFO[0m[0m 03/19 05:06:13 | 0.541788    0.533755    0.848377    0.845505    0.447627    0.541788    0.533755    0.865451    0.887006    0.855164    0.845088    0.824517    0.804422    3000        17.947103   0.438534    0.173868    164.393117 
[37m[36mINFO[0m[0m 03/19 05:09:33 | 0.354864    0.383966    0.836252    0.820515    0.502422    0.354864    0.383966    0.845937    0.857730    0.835327    0.827456    0.827491    0.776361    3200        19.143577   0.429659    0.159058    168.709383 
[37m[36mINFO[0m[0m 03/19 05:12:51 | 0.414184    0.421941    0.845783    0.847418    0.428698    0.414184    0.421941    0.860701    0.875706    0.851071    0.842569    0.825579    0.823980    3400        20.340050   0.413312    0.161959    164.990595 
[37m[36mINFO[0m[0m 03/19 05:16:06 | 0.418930    0.429325    0.857843    0.848298    0.420048    0.418930    0.429325    0.878162    0.893683    0.866814    0.845088    0.828553    0.806122    3600        21.536524   0.412762    0.159572    162.962250 
[37m[36mINFO[0m[0m 03/19 05:19:23 | 0.468495    0.477848    0.875890    0.853441    0.393929    0.468495    0.477848    0.893953    0.901900    0.884131    0.846348    0.849586    0.812075    3800        22.732997   0.403533    0.162387    165.203910 
[37m[36mINFO[0m[0m 03/19 05:22:37 | 0.482204    0.490506    0.869284    0.854739    0.424399    0.482204    0.490506    0.879317    0.888033    0.873426    0.853904    0.855109    0.822279    4000        23.929471   0.373692    0.156360    162.430776 
[37m[36mINFO[0m[0m 03/19 05:25:57 | 0.443185    0.446203    0.866493    0.860315    0.389719    0.443185    0.446203    0.872769    0.896764    0.875000    0.860202    0.851710    0.823980    4200        25.125945   0.373884    0.158884    168.738707 
[37m[36mINFO[0m[0m 03/19 05:29:17 | 0.565515    0.590717    0.868045    0.866028    0.408540    0.565515    0.590717    0.890743    0.907036    0.878463    0.855164    0.834927    0.835884    4400        26.322418   0.366112    0.162007    166.662188 
[37m[36mINFO[0m[0m 03/19 05:32:33 | 0.594516    0.583333    0.877440    0.872092    0.364558    0.594516    0.583333    0.894210    0.903441    0.889798    0.880353    0.848311    0.832483    4600        27.518892   0.366460    0.162659    163.601082 
[37m[36mINFO[0m[0m 03/19 05:35:57 | 0.577116    0.564346    0.885612    0.873464    0.361359    0.577116    0.564346    0.890743    0.904468    0.894836    0.871537    0.871256    0.844388    4800        28.715365   0.363134    0.164367    171.814660 
[37m[36mINFO[0m[0m 03/19 05:39:20 | 0.386765    0.416667    0.877979    0.859245    0.415502    0.386765    0.416667    0.891514    0.893683    0.893262    0.870277    0.849161    0.813776    5000        29.911839   0.351426    0.167862    169.563751 
[37m[36mINFO[0m[0m 03/19 05:39:21 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0]/250319_04-13-34_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 05:39:22 | ---
[37m[36mINFO[0m[0m 03/19 05:39:22 | test-domain validation(oracle) = 56.552%
[37m[36mINFO[0m[0m 03/19 05:39:22 | training-domain validation(iid) = 57.712%
[37m[36mINFO[0m[0m 03/19 05:39:22 | last = 38.677%
[37m[36mINFO[0m[0m 03/19 05:39:22 | last (inD) = 85.925%
[37m[36mINFO[0m[0m 03/19 05:39:22 | training-domain validation (iid, inD) = 87.346%
[37m[36mINFO[0m[0m 03/19 05:39:22 | === Summary ===
[37m[36mINFO[0m[0m 03/19 05:39:22 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 6
[37m[36mINFO[0m[0m 03/19 05:39:22 | Unique name: 250319_04-13-34_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 05:39:22 | Out path: train_output/TerraIncognita/ERM/[0]/250319_04-13-34_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 05:39:22 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 05:39:22 | Dataset: TerraIncognita

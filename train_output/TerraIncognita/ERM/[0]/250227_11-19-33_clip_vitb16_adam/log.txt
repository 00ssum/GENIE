[37m[36mINFO[0m[0m 02/27 11:19:33 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_adam config/clip_vitb16_adam.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_adam.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_adam
	out_dir: train_output/TerraIncognita/ERM/[0]/250227_11-19-33_clip_vitb16_adam
	out_root: train_output/TerraIncognita/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250227_11-19-33_clip_vitb16_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: clip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/27 11:19:33 | n_steps = 5001
[37m[36mINFO[0m[0m 02/27 11:19:33 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/27 11:19:33 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/27 11:19:33 | 
[37m[36mINFO[0m[0m 02/27 11:19:33 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 02/27 11:19:33 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 02/27 11:19:33 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 02/27 11:19:33 | Batch sizes for each domain: [0, 32, 32, 32] (total=96)
[37m[36mINFO[0m[0m 02/27 11:19:33 | steps-per-epoch for each domain: 243.41, 99.25, 147.09 -> min = 99.25
[37m[36mINFO[0m[0m 02/27 11:19:36 | # of params = 86197770
[37m[36mINFO[0m[0m 02/27 11:22:43 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/27 11:22:43 | 0.200633    0.208861    0.316445    0.307675    2.027547    0.200633    0.208861    0.455514    0.481253    0.247166    0.231738    0.246654    0.210034    0           0.000000    2.252024    1.448081    185.795765 
[37m[36mINFO[0m[0m 02/27 11:27:22 | 0.596889    0.586498    0.700917    0.712215    0.786936    0.596889    0.586498    0.759148    0.773498    0.660579    0.662469    0.683025    0.700680    200         2.015113    1.066438    0.415550    195.861590 
[37m[36mINFO[0m[0m 02/27 11:32:04 | 0.537042    0.549578    0.762858    0.775647    0.646915    0.537042    0.549578    0.795481    0.823318    0.745907    0.749370    0.747185    0.754252    400         4.030227    0.733993    0.411659    199.331105 
[37m[36mINFO[0m[0m 02/27 11:36:25 | 0.397311    0.401899    0.770114    0.774347    0.611277    0.397311    0.401899    0.778277    0.798665    0.764484    0.755668    0.767580    0.768707    600         6.045340    0.641896    0.406446    179.936868 
[37m[36mINFO[0m[0m 02/27 11:40:57 | 0.346164    0.361814    0.797631    0.781781    0.609604    0.346164    0.361814    0.839260    0.848998    0.790302    0.753149    0.763331    0.743197    800         8.060453    0.594462    0.405760    190.303045 
[37m[36mINFO[0m[0m 02/27 11:45:23 | 0.577907    0.586498    0.826139    0.819253    0.515111    0.577907    0.586498    0.850302    0.853621    0.823992    0.802267    0.804122    0.801871    1000        10.075567   0.547545    0.406825    185.093139 
[37m[36mINFO[0m[0m 02/27 11:49:46 | 0.474822    0.494726    0.836954    0.820722    0.502244    0.474822    0.494726    0.858518    0.861839    0.831864    0.801008    0.820480    0.799320    1200        12.090680   0.503437    0.408232    181.101624 
[37m[36mINFO[0m[0m 02/27 11:54:05 | 0.456103    0.479958    0.834798    0.819562    0.505520    0.456103    0.479958    0.850173    0.842835    0.843514    0.817380    0.810707    0.798469    1400        14.105793   0.473635    0.409257    177.417484 
[37m[36mINFO[0m[0m 02/27 11:58:29 | 0.518060    0.525316    0.850923    0.841094    0.472729    0.518060    0.525316    0.869688    0.873138    0.855164    0.828715    0.827916    0.821429    1600        16.120907   0.435328    0.407907    182.499285 
[37m[36mINFO[0m[0m 02/27 12:02:46 | 0.475877    0.522152    0.869940    0.849070    0.415245    0.475877    0.522152    0.886763    0.889574    0.869647    0.841310    0.853410    0.816327    1800        18.136020   0.409329    0.407477    175.137625 
[37m[36mINFO[0m[0m 02/27 12:07:00 | 0.425257    0.465190    0.845327    0.835105    0.469359    0.425257    0.465190    0.866093    0.877247    0.847922    0.826196    0.821967    0.801871    2000        20.151134   0.393262    0.408671    172.628803 
[37m[36mINFO[0m[0m 02/27 12:11:25 | 0.520432    0.555907    0.869028    0.848536    0.427396    0.520432    0.555907    0.882141    0.878274    0.880668    0.847607    0.844274    0.819728    2200        22.166247   0.381044    0.410029    182.389727 
[37m[36mINFO[0m[0m 02/27 12:15:43 | 0.373583    0.392405    0.880910    0.855114    0.419871    0.373583    0.392405    0.890487    0.877761    0.897985    0.860202    0.854260    0.827381    2400        24.181360   0.361164    0.411210    175.791521 
[37m[36mINFO[0m[0m 02/27 12:19:57 | 0.450830    0.468354    0.883816    0.862040    0.395095    0.450830    0.468354    0.881756    0.880842    0.904597    0.872796    0.865095    0.832483    2600        26.196474   0.337936    0.410978    172.234479 
[37m[36mINFO[0m[0m 02/27 12:24:17 | 0.537833    0.563291    0.877482    0.863468    0.417951    0.537833    0.563291    0.891257    0.895737    0.880982    0.871537    0.860208    0.823129    2800        28.211587   0.320279    0.410660    177.549144 
[37m[36mINFO[0m[0m 02/27 12:28:39 | 0.339309    0.360759    0.884321    0.867042    0.367448    0.339309    0.360759    0.894723    0.886492    0.894207    0.872796    0.864032    0.841837    3000        30.226700   0.330243    0.406324    180.381147 
[37m[36mINFO[0m[0m 02/27 12:33:07 | 0.417611    0.447257    0.894649    0.874840    0.345452    0.417611    0.447257    0.905123    0.894710    0.896096    0.882872    0.882728    0.846939    3200        32.241814   0.304220    0.406429    186.880821 
[37m[36mINFO[0m[0m 02/27 12:37:23 | 0.369892    0.392405    0.896818    0.876316    0.351069    0.369892    0.392405    0.903197    0.895737    0.910264    0.882872    0.876992    0.850340    3400        34.256927   0.292608    0.408103    174.294047 
[37m[36mINFO[0m[0m 02/27 12:41:41 | 0.360137    0.372363    0.888833    0.862589    0.404306    0.360137    0.372363    0.896264    0.882897    0.903652    0.871537    0.866582    0.833333    3600        36.272040   0.280500    0.408299    176.593134 
[37m[36mINFO[0m[0m 02/27 12:46:12 | 0.274717    0.308017    0.905369    0.869639    0.389446    0.274717    0.308017    0.907947    0.892142    0.920970    0.871537    0.887189    0.845238    3800        38.287154   0.268678    0.406913    189.653248 
[37m[36mINFO[0m[0m 02/27 12:50:42 | 0.401265    0.447257    0.909621    0.880288    0.353245    0.401265    0.447257    0.913724    0.902928    0.923489    0.879093    0.891651    0.858844    4000        40.302267   0.257595    0.411246    187.465284 
[37m[36mINFO[0m[0m 02/27 12:55:03 | 0.368574    0.394515    0.909995    0.887110    0.333118    0.368574    0.394515    0.918090    0.904468    0.919395    0.895466    0.892501    0.861395    4200        42.317380   0.250963    0.410350    179.295693 
[37m[36mINFO[0m[0m 02/27 12:59:27 | 0.562352    0.588608    0.913419    0.883992    0.369457    0.562352    0.588608    0.913596    0.888033    0.928212    0.906801    0.898449    0.857143    4400        44.332494   0.248618    0.412590    181.102123 
[37m[36mINFO[0m[0m 02/27 13:03:57 | 0.416557    0.439873    0.915975    0.884186    0.326737    0.416557    0.439873    0.920401    0.900360    0.926952    0.894207    0.900574    0.857993    4600        46.347607   0.232860    0.410798    187.922633 
[37m[36mINFO[0m[0m 02/27 13:08:27 | 0.374901    0.413502    0.915746    0.889565    0.335838    0.374901    0.413502    0.924766    0.909091    0.923174    0.880353    0.899299    0.879252    4800        48.362720   0.236319    0.409624    188.400415 
[37m[36mINFO[0m[0m 02/27 13:12:49 | 0.494595    0.507384    0.915643    0.885862    0.341468    0.494595    0.507384    0.926691    0.911145    0.923489    0.879093    0.896750    0.867347    5000        50.377834   0.241608    0.407930    180.464221 
[37m[36mINFO[0m[0m 02/27 13:12:50 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0]/250227_11-19-33_clip_vitb16_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/27 13:12:52 | ---
[37m[36mINFO[0m[0m 02/27 13:12:52 | test-domain validation(oracle) = 56.235%
[37m[36mINFO[0m[0m 02/27 13:12:52 | training-domain validation(iid) = 37.490%
[37m[36mINFO[0m[0m 02/27 13:12:52 | last = 49.460%
[37m[36mINFO[0m[0m 02/27 13:12:52 | last (inD) = 88.586%
[37m[36mINFO[0m[0m 02/27 13:12:52 | training-domain validation (iid, inD) = 88.957%
[37m[36mINFO[0m[0m 02/27 13:12:52 | === Summary ===
[37m[36mINFO[0m[0m 02/27 13:12:52 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_adam config/clip_vitb16_adam.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita
[37m[36mINFO[0m[0m 02/27 13:12:52 | Unique name: 250227_11-19-33_clip_vitb16_adam
[37m[36mINFO[0m[0m 02/27 13:12:52 | Out path: train_output/TerraIncognita/ERM/[0]/250227_11-19-33_clip_vitb16_adam
[37m[36mINFO[0m[0m 02/27 13:12:52 | Algorithm: ERM
[37m[36mINFO[0m[0m 02/27 13:12:52 | Dataset: TerraIncognita

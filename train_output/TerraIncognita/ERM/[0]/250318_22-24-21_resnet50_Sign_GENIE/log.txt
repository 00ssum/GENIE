[37m[36mINFO[0m[0m 03/18 22:24:21 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 2
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 2
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[0]/250318_22-24-21_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250318_22-24-21_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 1.9041073434446342e-05
	batch_size: 9
	weight_decay: 0.0006566989842279891
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/18 22:24:21 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 22:24:21 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 22:24:21 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 22:24:21 | 
[37m[36mINFO[0m[0m 03/18 22:24:21 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 03/18 22:24:21 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 03/18 22:24:21 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/18 22:24:21 | Batch sizes for each domain: [0, 9, 9, 9] (total=27)
[37m[36mINFO[0m[0m 03/18 22:24:21 | steps-per-epoch for each domain: 865.44, 352.89, 523.00 -> min = 352.89
[37m[36mINFO[0m[0m 03/18 22:24:23 | # of params = 23528522
[37m[36mINFO[0m[0m 03/18 22:27:15 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 22:27:15 | 0.027683    0.043249    0.266184    0.241482    2.086993    0.027683    0.043249    0.318655    0.330765    0.282746    0.235516    0.197153    0.158163    0           0.000000    2.342708    0.924705    170.946270 
[37m[36mINFO[0m[0m 03/18 22:30:24 | 0.174268    0.184599    0.512289    0.537939    1.250717    0.174268    0.184599    0.609449    0.642527    0.441121    0.450882    0.486297    0.520408    200         0.566751    1.450570    0.118672    165.829607 
[37m[36mINFO[0m[0m 03/18 22:33:44 | 0.446612    0.457806    0.624900    0.643719    0.937537    0.446612    0.457806    0.747208    0.763225    0.568325    0.600756    0.559167    0.567177    400         1.133501    1.119521    0.136854    172.458942 
[37m[36mINFO[0m[0m 03/18 22:36:54 | 0.437385    0.446203    0.687375    0.704540    0.861842    0.437385    0.446203    0.738092    0.747304    0.671599    0.714106    0.652433    0.652211    600         1.700252    0.959467    0.119115    166.575490 
[37m[36mINFO[0m[0m 03/18 22:40:14 | 0.377801    0.388186    0.688547    0.690925    0.831779    0.377801    0.388186    0.770317    0.789420    0.638854    0.618388    0.656469    0.664966    800         2.267003    0.875669    0.144005    170.892549 
[37m[36mINFO[0m[0m 03/18 22:43:29 | 0.510678    0.520042    0.705965    0.718118    0.785556    0.510678    0.520042    0.765824    0.784284    0.680730    0.686398    0.671341    0.683673    1000        2.833753    0.791262    0.128569    169.212796 
[37m[36mINFO[0m[0m 03/18 22:46:56 | 0.600580    0.598101    0.732220    0.758267    0.695931    0.600580    0.598101    0.762614    0.796097    0.727015    0.769521    0.707032    0.709184    1200        3.400504    0.801676    0.156228    176.031611 
[37m[36mINFO[0m[0m 03/18 22:50:20 | 0.446612    0.453586    0.718325    0.723812    0.774195    0.446612    0.453586    0.748491    0.766821    0.704975    0.711587    0.701508    0.693027    1400        3.967254    0.776047    0.135888    176.660044 
[37m[36mINFO[0m[0m 03/18 22:53:34 | 0.490113    0.507384    0.738037    0.751396    0.668168    0.490113    0.507384    0.783669    0.784797    0.700252    0.732997    0.730189    0.736395    1600        4.534005    0.727619    0.126833    168.577611 
[37m[36mINFO[0m[0m 03/18 22:56:57 | 0.467440    0.496835    0.738310    0.743295    0.688014    0.467440    0.496835    0.763769    0.793529    0.726071    0.722922    0.725090    0.713435    1800        5.100756    0.715245    0.146270    173.592055 
[37m[36mINFO[0m[0m 03/18 23:00:07 | 0.567361    0.567511    0.744686    0.750704    0.627293    0.567361    0.567511    0.789061    0.783256    0.735202    0.741814    0.709794    0.727041    2000        5.667506    0.674857    0.117274    166.399781 
[37m[36mINFO[0m[0m 03/18 23:03:25 | 0.452149    0.469409    0.747454    0.749008    0.688981    0.452149    0.469409    0.795738    0.798665    0.732368    0.715365    0.714255    0.732993    2200        6.234257    0.663601    0.155027    167.394930 
[37m[36mINFO[0m[0m 03/18 23:06:42 | 0.522014    0.527426    0.753664    0.749340    0.680943    0.522014    0.527426    0.779689    0.765280    0.737091    0.753149    0.744211    0.729592    2400        6.801008    0.664026    0.118916    173.034362 
[37m[36mINFO[0m[0m 03/18 23:10:00 | 0.591352    0.598101    0.783690    0.773015    0.604504    0.591352    0.598101    0.815509    0.822291    0.773929    0.754408    0.761632    0.742347    2600        7.367758    0.633152    0.144403    169.609319 
[37m[36mINFO[0m[0m 03/18 23:13:14 | 0.380174    0.370253    0.776737    0.778690    0.601765    0.380174    0.370253    0.814610    0.824859    0.755668    0.754408    0.759932    0.756803    2800        7.934509    0.602680    0.129800    167.862830 
[37m[36mINFO[0m[0m 03/18 23:16:29 | 0.510941    0.523207    0.782022    0.773473    0.643749    0.510941    0.523207    0.829375    0.848485    0.770781    0.767003    0.745910    0.704932    3000        8.501259    0.588447    0.119036    170.590660 
[37m[36mINFO[0m[0m 03/18 23:19:46 | 0.627472    0.622363    0.792586    0.791453    0.592322    0.627472    0.622363    0.818334    0.826400    0.785894    0.773300    0.773529    0.774660    3200        9.068010    0.557039    0.119624    173.539789 
[37m[36mINFO[0m[0m 03/18 23:22:57 | 0.613499    0.605485    0.787596    0.794626    0.549399    0.613499    0.605485    0.806779    0.815100    0.787154    0.774559    0.768855    0.794218    3400        9.634761    0.578199    0.120537    166.524303 
[37m[36mINFO[0m[0m 03/18 23:26:12 | 0.538360    0.563291    0.790568    0.782766    0.581062    0.538360    0.563291    0.812043    0.832049    0.774874    0.759446    0.784789    0.756803    3600        10.201511   0.555354    0.117428    171.904102 
[37m[36mINFO[0m[0m 03/18 23:29:24 | 0.499077    0.528481    0.784951    0.776625    0.609084    0.499077    0.528481    0.812813    0.825886    0.782746    0.787154    0.759295    0.716837    3800        10.768262   0.569326    0.119047    168.297258 
[37m[36mINFO[0m[0m 03/18 23:32:35 | 0.556024    0.568565    0.808027    0.789697    0.570831    0.556024    0.568565    0.844396    0.854135    0.805730    0.760705    0.773954    0.754252    4000        11.335013   0.541678    0.114080    168.270038 
[37m[36mINFO[0m[0m 03/18 23:35:46 | 0.519641    0.533755    0.802210    0.798786    0.565465    0.519641    0.533755    0.837720    0.855675    0.783060    0.777078    0.785851    0.763605    4200        11.901763   0.530570    0.113477    167.666066 
[37m[36mINFO[0m[0m 03/18 23:39:05 | 0.489586    0.510549    0.811421    0.808343    0.530399    0.489586    0.510549    0.837848    0.856189    0.792506    0.769521    0.803909    0.799320    4400        12.468514   0.536783    0.124038    174.220417 
[37m[36mINFO[0m[0m 03/18 23:42:20 | 0.515423    0.514768    0.811292    0.816863    0.507895    0.515423    0.514768    0.836436    0.855675    0.795655    0.792191    0.801785    0.802721    4600        13.035264   0.538252    0.118504    171.629350 
[37m[36mINFO[0m[0m 03/18 23:45:32 | 0.496177    0.513713    0.821059    0.825649    0.489727    0.496177    0.513713    0.835024    0.852594    0.820844    0.817380    0.807308    0.806973    4800        13.602015   0.520308    0.117155    168.749389 
[37m[36mINFO[0m[0m 03/18 23:48:50 | 0.402320    0.425105    0.813552    0.817146    0.494137    0.402320    0.425105    0.837591    0.852594    0.813602    0.817380    0.789463    0.781463    5000        14.168766   0.496585    0.118184    174.140502 
[37m[36mINFO[0m[0m 03/18 23:48:50 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0]/250318_22-24-21_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 23:48:51 | ---
[37m[36mINFO[0m[0m 03/18 23:48:51 | test-domain validation(oracle) = 62.747%
[37m[36mINFO[0m[0m 03/18 23:48:51 | training-domain validation(iid) = 49.618%
[37m[36mINFO[0m[0m 03/18 23:48:51 | last = 40.232%
[37m[36mINFO[0m[0m 03/18 23:48:51 | last (inD) = 81.715%
[37m[36mINFO[0m[0m 03/18 23:48:51 | training-domain validation (iid, inD) = 82.565%
[37m[36mINFO[0m[0m 03/18 23:48:52 | === Summary ===
[37m[36mINFO[0m[0m 03/18 23:48:52 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 2
[37m[36mINFO[0m[0m 03/18 23:48:52 | Unique name: 250318_22-24-21_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 23:48:52 | Out path: train_output/TerraIncognita/ERM/[0]/250318_22-24-21_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 23:48:52 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 23:48:52 | Dataset: TerraIncognita

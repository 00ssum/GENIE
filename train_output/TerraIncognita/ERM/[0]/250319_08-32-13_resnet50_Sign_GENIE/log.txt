[37m[36mINFO[0m[0m 03/19 08:32:13 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 9
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 9
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[0]/250319_08-32-13_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250319_08-32-13_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5.5014200978340895e-05
	batch_size: 15
	weight_decay: 3.288190104805334e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/19 08:32:13 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 08:32:13 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 08:32:13 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 08:32:13 | 
[37m[36mINFO[0m[0m 03/19 08:32:13 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 03/19 08:32:13 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 03/19 08:32:13 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 08:32:13 | Batch sizes for each domain: [0, 15, 15, 15] (total=45)
[37m[36mINFO[0m[0m 03/19 08:32:13 | steps-per-epoch for each domain: 519.27, 211.73, 313.80 -> min = 211.73
[37m[36mINFO[0m[0m 03/19 08:32:14 | # of params = 23528522
[37m[36mINFO[0m[0m 03/19 08:35:03 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 08:35:03 | 0.211706    0.220464    0.282088    0.304883    2.024325    0.211706    0.220464    0.455514    0.481253    0.162154    0.221662    0.228596    0.211735    0           0.000000    2.351671    0.916111    167.769983 
[37m[36mINFO[0m[0m 03/19 08:38:13 | 0.128131    0.131857    0.606714    0.616939    1.041920    0.128131    0.131857    0.709462    0.719569    0.553212    0.576826    0.557468    0.554422    200         0.944584    1.400506    0.136411    162.708163 
[37m[36mINFO[0m[0m 03/19 08:41:29 | 0.201424    0.218354    0.685225    0.701081    0.851103    0.201424    0.218354    0.737322    0.754494    0.675693    0.691436    0.642660    0.657313    400         1.889169    0.968729    0.133911    169.219796 
[37m[36mINFO[0m[0m 03/19 08:44:43 | 0.541524    0.563291    0.720593    0.726956    0.739931    0.541524    0.563291    0.749390    0.762712    0.717254    0.716625    0.695135    0.701531    600         2.833753    0.835575    0.133626    167.591449 
[37m[36mINFO[0m[0m 03/19 08:47:56 | 0.413393    0.413502    0.740733    0.747102    0.670526    0.413393    0.413502    0.783156    0.787879    0.726700    0.717884    0.712343    0.735544    800         3.778338    0.731796    0.136144    165.336441 
[37m[36mINFO[0m[0m 03/19 08:51:12 | 0.541260    0.560127    0.765832    0.781465    0.606790    0.541260    0.560127    0.795352    0.822291    0.752834    0.767003    0.749310    0.755102    1000        4.722922    0.726893    0.137036    168.791545 
[37m[36mINFO[0m[0m 03/19 08:54:25 | 0.515687    0.529536    0.756013    0.750992    0.658706    0.515687    0.529536    0.781615    0.779147    0.761335    0.751889    0.725090    0.721939    1200        5.667506    0.666176    0.133079    166.760128 
[37m[36mINFO[0m[0m 03/19 08:57:36 | 0.450040    0.473629    0.772623    0.790358    0.610844    0.450040    0.473629    0.810374    0.839240    0.758186    0.770781    0.749310    0.761054    1400        6.612091    0.612645    0.134194    163.881639 
[37m[36mINFO[0m[0m 03/19 09:00:53 | 0.487477    0.493671    0.792816    0.797405    0.555793    0.487477    0.493671    0.823212    0.841294    0.780856    0.774559    0.774379    0.776361    1600        7.556675    0.607651    0.133907    169.734073 
[37m[36mINFO[0m[0m 03/19 09:04:09 | 0.388083    0.392405    0.771289    0.792336    0.575626    0.388083    0.392405    0.800745    0.831536    0.758501    0.768262    0.754621    0.777211    1800        8.501259    0.569417    0.140385    167.840686 
[37m[36mINFO[0m[0m 03/19 09:07:21 | 0.421039    0.421941    0.796628    0.791192    0.564110    0.421039    0.421941    0.820901    0.836672    0.785894    0.773300    0.783089    0.763605    2000        9.445844    0.569091    0.137127    165.116663 
[37m[36mINFO[0m[0m 03/19 09:10:37 | 0.424993    0.465190    0.786685    0.780223    0.610065    0.424993    0.465190    0.827834    0.835131    0.786524    0.765743    0.745698    0.739796    2200        10.390428   0.524117    0.132763    169.408273 
[37m[36mINFO[0m[0m 03/19 09:13:52 | 0.422357    0.449367    0.826552    0.823837    0.489142    0.422357    0.449367    0.845295    0.858243    0.825567    0.819899    0.808795    0.793367    2400        11.335013   0.519708    0.131814    168.225189 
[37m[36mINFO[0m[0m 03/19 09:17:04 | 0.597944    0.594937    0.807385    0.815262    0.520005    0.597944    0.594937    0.812428    0.820236    0.807305    0.823678    0.802422    0.801871    2600        12.279597   0.514303    0.135403    165.119486 
[37m[36mINFO[0m[0m 03/19 09:20:19 | 0.361455    0.383966    0.812841    0.809970    0.508661    0.361455    0.383966    0.841315    0.839753    0.806045    0.798489    0.791162    0.791667    2800        13.224181   0.493079    0.131855    168.629201 
[37m[36mINFO[0m[0m 03/19 09:23:33 | 0.404693    0.417722    0.829447    0.828124    0.483205    0.404693    0.417722    0.864553    0.881870    0.812657    0.797229    0.811132    0.805272    3000        14.168766   0.490505    0.142948    165.335526 
[37m[36mINFO[0m[0m 03/19 09:26:50 | 0.557342    0.542194    0.833235    0.828221    0.481005    0.557342    0.542194    0.861728    0.867488    0.816436    0.813602    0.821542    0.803571    3200        15.113350   0.464373    0.130463    170.713664 
[37m[36mINFO[0m[0m 03/19 09:30:04 | 0.433694    0.448312    0.826233    0.821954    0.504264    0.433694    0.448312    0.849146    0.854135    0.819270    0.807305    0.810283    0.804422    3400        16.057935   0.454896    0.135889    166.892350 
[37m[36mINFO[0m[0m 03/19 09:33:17 | 0.491432    0.498945    0.852393    0.834697    0.428412    0.491432    0.498945    0.874438    0.883924    0.856738    0.812343    0.826004    0.807823    3600        17.002519   0.449083    0.130084    167.547647 
[37m[36mINFO[0m[0m 03/19 09:36:34 | 0.417084    0.424051    0.852915    0.845101    0.432234    0.417084    0.424051    0.866350    0.885978    0.849181    0.826196    0.843212    0.823129    3800        17.947103   0.413996    0.131529    170.503110 
[37m[36mINFO[0m[0m 03/19 09:39:46 | 0.526496    0.525316    0.839309    0.827598    0.490474    0.526496    0.525316    0.866478    0.872111    0.835642    0.822418    0.815806    0.788265    4000        18.891688   0.414920    0.132919    165.688551 
[37m[36mINFO[0m[0m 03/19 09:43:01 | 0.487213    0.488397    0.849399    0.834962    0.473766    0.487213    0.488397    0.883425    0.889574    0.840680    0.826196    0.824092    0.789116    4200        19.836272   0.417491    0.134030    167.394702 
[37m[36mINFO[0m[0m 03/19 09:46:13 | 0.262589    0.284810    0.852858    0.845230    0.435666    0.262589    0.284810    0.873283    0.886492    0.856738    0.836272    0.828553    0.812925    4400        20.780856   0.406665    0.131530    165.659339 
[37m[36mINFO[0m[0m 03/19 09:49:27 | 0.510414    0.500000    0.850104    0.842445    0.459046    0.510414    0.500000    0.863911    0.877761    0.861461    0.840050    0.824942    0.809524    4600        21.725441   0.393602    0.133030    167.672859 
[37m[36mINFO[0m[0m 03/19 09:52:39 | 0.442921    0.439873    0.867429    0.847687    0.419398    0.442921    0.439873    0.882527    0.884951    0.869962    0.837531    0.849798    0.820578    4800        22.670025   0.391873    0.134018    165.459824 
[37m[36mINFO[0m[0m 03/19 09:55:50 | 0.523596    0.535865    0.865581    0.850415    0.422925    0.523596    0.535865    0.875465    0.871597    0.867443    0.848866    0.853835    0.830782    5000        23.614610   0.366872    0.133404    163.940255 
[37m[36mINFO[0m[0m 03/19 09:55:50 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0]/250319_08-32-13_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 09:55:51 | ---
[37m[36mINFO[0m[0m 03/19 09:55:51 | test-domain validation(oracle) = 59.794%
[37m[36mINFO[0m[0m 03/19 09:55:51 | training-domain validation(iid) = 52.360%
[37m[36mINFO[0m[0m 03/19 09:55:51 | last = 52.360%
[37m[36mINFO[0m[0m 03/19 09:55:51 | last (inD) = 85.042%
[37m[36mINFO[0m[0m 03/19 09:55:51 | training-domain validation (iid, inD) = 85.042%
[37m[36mINFO[0m[0m 03/19 09:55:51 | === Summary ===
[37m[36mINFO[0m[0m 03/19 09:55:51 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 9
[37m[36mINFO[0m[0m 03/19 09:55:51 | Unique name: 250319_08-32-13_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 09:55:51 | Out path: train_output/TerraIncognita/ERM/[0]/250319_08-32-13_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 09:55:51 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 09:55:51 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 03/19 11:23:35 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 11
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 11
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[0]/250319_11-23-35_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250319_11-23-35_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5.962562271631622e-05
	batch_size: 11
	weight_decay: 0.001114945719897867
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/19 11:23:35 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 11:23:35 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 11:23:35 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 11:23:35 | 
[37m[36mINFO[0m[0m 03/19 11:23:35 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 03/19 11:23:35 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 03/19 11:23:35 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 11:23:35 | Batch sizes for each domain: [0, 11, 11, 11] (total=33)
[37m[36mINFO[0m[0m 03/19 11:23:35 | steps-per-epoch for each domain: 708.09, 288.73, 427.91 -> min = 288.73
[37m[36mINFO[0m[0m 03/19 11:23:36 | # of params = 23528522
[37m[36mINFO[0m[0m 03/19 11:26:27 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 11:26:27 | 0.101239    0.107595    0.310518    0.316670    2.058695    0.101239    0.107595    0.446784    0.481767    0.266373    0.289673    0.218398    0.178571    0           0.000000    2.360061    0.955255    170.435000 
[37m[36mINFO[0m[0m 03/19 11:29:43 | 0.180069    0.191983    0.583898    0.609236    1.100905    0.180069    0.191983    0.704583    0.728300    0.513224    0.573048    0.533886    0.526361    200         0.692695    1.476011    0.132759    168.880286 
[37m[36mINFO[0m[0m 03/19 11:32:57 | 0.351437    0.371308    0.641530    0.656904    0.944644    0.351437    0.371308    0.698164    0.734977    0.635390    0.618388    0.591035    0.617347    400         1.385390    1.094036    0.124117    169.574704 
[37m[36mINFO[0m[0m 03/19 11:36:15 | 0.474822    0.479958    0.701735    0.718476    0.799891    0.474822    0.479958    0.756965    0.781202    0.663728    0.693955    0.684512    0.680272    600         2.078086    0.954497    0.130151    171.543719 
[37m[36mINFO[0m[0m 03/19 11:39:33 | 0.496704    0.508439    0.683096    0.698465    0.793305    0.496704    0.508439    0.741944    0.770930    0.672544    0.695214    0.634799    0.629252    800         2.770781    0.863417    0.126393    173.482754 
[37m[36mINFO[0m[0m 03/19 11:42:49 | 0.524651    0.526371    0.741214    0.745691    0.706207    0.524651    0.526371    0.778662    0.795583    0.718829    0.720403    0.726153    0.721088    1000        3.463476    0.766735    0.126973    169.923379 
[37m[36mINFO[0m[0m 03/19 11:46:09 | 0.416557    0.427215    0.717549    0.713018    0.768192    0.416557    0.427215    0.740018    0.736518    0.706234    0.707809    0.706395    0.694728    1200        4.156171    0.736651    0.123508    175.243140 
[37m[36mINFO[0m[0m 03/19 11:49:25 | 0.535987    0.539030    0.746177    0.745204    0.692302    0.535987    0.539030    0.781872    0.789933    0.719458    0.725441    0.737200    0.720238    1400        4.848866    0.700545    0.122175    171.743149 
[37m[36mINFO[0m[0m 03/19 11:52:45 | 0.459003    0.471519    0.752488    0.758070    0.651400    0.459003    0.471519    0.794839    0.817668    0.744332    0.740554    0.718292    0.715986    1600        5.541562    0.674522    0.126842    174.781867 
[37m[36mINFO[0m[0m 03/19 11:55:57 | 0.527551    0.542194    0.772184    0.784868    0.611787    0.527551    0.542194    0.810759    0.832563    0.749685    0.772040    0.756108    0.750000    1800        6.234257    0.657100    0.124676    166.666966 
[37m[36mINFO[0m[0m 03/19 11:59:08 | 0.529396    0.539030    0.775126    0.783525    0.617984    0.529396    0.539030    0.823597    0.825886    0.747796    0.764484    0.753983    0.760204    2000        6.926952    0.614106    0.128872    165.376567 
[37m[36mINFO[0m[0m 03/19 12:02:21 | 0.473240    0.501055    0.786623    0.779623    0.584430    0.473240    0.501055    0.822570    0.824859    0.770781    0.768262    0.766518    0.745748    2200        7.619647    0.630412    0.119462    168.919917 
[37m[36mINFO[0m[0m 03/19 12:05:36 | 0.554442    0.555907    0.790025    0.790481    0.570204    0.554442    0.555907    0.824624    0.837185    0.772985    0.780856    0.772467    0.753401    2400        8.312343    0.584005    0.128891    169.822213 
[37m[36mINFO[0m[0m 03/19 12:08:58 | 0.611389    0.612869    0.801591    0.798343    0.561013    0.611389    0.612869    0.817050    0.817155    0.799748    0.794710    0.787975    0.783163    2600        9.005038    0.590088    0.125103    176.850018 
[37m[36mINFO[0m[0m 03/19 12:12:15 | 0.444503    0.447257    0.793614    0.781125    0.612029    0.444503    0.447257    0.827321    0.838213    0.782116    0.761965    0.771404    0.743197    2800        9.697733    0.556715    0.122568    172.687314 
[37m[36mINFO[0m[0m 03/19 12:15:30 | 0.529924    0.526371    0.794182    0.787515    0.588989    0.529924    0.526371    0.827577    0.834617    0.785264    0.777078    0.769705    0.750850    3000        10.390428   0.550806    0.124048    170.286771 
[37m[36mINFO[0m[0m 03/19 12:18:45 | 0.489059    0.501055    0.803839    0.790911    0.575602    0.489059    0.501055    0.837848    0.850026    0.776134    0.753149    0.797536    0.769558    3200        11.083123   0.540230    0.134750    167.859898 
[37m[36mINFO[0m[0m 03/19 12:21:59 | 0.561561    0.570675    0.791540    0.772049    0.614993    0.561561    0.570675    0.819874    0.833590    0.777393    0.734257    0.777353    0.748299    3400        11.775819   0.530669    0.125477    168.831709 
[37m[36mINFO[0m[0m 03/19 12:25:12 | 0.494859    0.504219    0.820380    0.824937    0.508846    0.494859    0.504219    0.850045    0.871084    0.808249    0.801008    0.802847    0.802721    3600        12.468514   0.516965    0.130893    166.235739 
[37m[36mINFO[0m[0m 03/19 12:28:20 | 0.457685    0.447257    0.808124    0.805794    0.560987    0.457685    0.447257    0.825266    0.828454    0.807305    0.794710    0.791799    0.794218    3800        13.161209   0.501544    0.124884    163.784069 
[37m[36mINFO[0m[0m 03/19 12:31:37 | 0.528605    0.523207    0.807531    0.807101    0.539869    0.528605    0.523207    0.832841    0.845917    0.798804    0.789673    0.790950    0.785714    4000        13.853904   0.496643    0.118915    172.577871 
[37m[36mINFO[0m[0m 03/19 12:34:48 | 0.395993    0.429325    0.820429    0.811601    0.517881    0.395993    0.429325    0.850173    0.860298    0.815491    0.792191    0.795624    0.782313    4200        14.546599   0.502413    0.124670    166.253071 
[37m[36mINFO[0m[0m 03/19 12:38:01 | 0.494595    0.523207    0.825387    0.822254    0.501333    0.494595    0.523207    0.852998    0.863380    0.802897    0.794710    0.820268    0.808673    4400        15.239295   0.513137    0.126324    167.971647 
[37m[36mINFO[0m[0m 03/19 12:41:17 | 0.452676    0.470464    0.828969    0.824298    0.507083    0.452676    0.470464    0.843497    0.847971    0.823992    0.806045    0.819418    0.818878    4600        15.931990   0.469153    0.124519    170.728758 
[37m[36mINFO[0m[0m 03/19 12:44:29 | 0.374374    0.360759    0.824481    0.815656    0.510123    0.374374    0.360759    0.853383    0.854135    0.813602    0.788413    0.806458    0.804422    4800        16.624685   0.477217    0.123240    168.102653 
[37m[36mINFO[0m[0m 03/19 12:47:39 | 0.524914    0.526371    0.841072    0.829596    0.477790    0.524914    0.526371    0.863269    0.870570    0.835642    0.798489    0.824304    0.819728    5000        17.317380   0.479151    0.126260    164.524238 
[37m[36mINFO[0m[0m 03/19 12:47:39 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0]/250319_11-23-35_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 12:47:41 | ---
[37m[36mINFO[0m[0m 03/19 12:47:41 | test-domain validation(oracle) = 61.139%
[37m[36mINFO[0m[0m 03/19 12:47:41 | training-domain validation(iid) = 52.491%
[37m[36mINFO[0m[0m 03/19 12:47:41 | last = 52.491%
[37m[36mINFO[0m[0m 03/19 12:47:41 | last (inD) = 82.960%
[37m[36mINFO[0m[0m 03/19 12:47:41 | training-domain validation (iid, inD) = 82.960%
[37m[36mINFO[0m[0m 03/19 12:47:41 | === Summary ===
[37m[36mINFO[0m[0m 03/19 12:47:41 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 11
[37m[36mINFO[0m[0m 03/19 12:47:41 | Unique name: 250319_11-23-35_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 12:47:41 | Out path: train_output/TerraIncognita/ERM/[0]/250319_11-23-35_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 12:47:41 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 12:47:41 | Dataset: TerraIncognita

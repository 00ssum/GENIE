[37m[36mINFO[0m[0m 03/14 13:45:16 | Command :: /jsm0707/GENIE/train_all.py resnet50_signum config/resnet50_signum.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_signum.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_signum
	out_dir: train_output/TerraIncognita/ERM/[0]/250314_13-45-16_resnet50_signum
	out_root: train_output/TerraIncognita/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250314_13-45-16_resnet50_signum
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: signum
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/14 13:45:16 | n_steps = 5001
[37m[36mINFO[0m[0m 03/14 13:45:16 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/14 13:45:16 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/14 13:45:16 | 
[37m[36mINFO[0m[0m 03/14 13:45:17 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 03/14 13:45:17 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 03/14 13:45:17 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/14 13:45:17 | Batch sizes for each domain: [0, 32, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/14 13:45:17 | steps-per-epoch for each domain: 243.41, 99.25, 147.09 -> min = 99.25
[37m[36mINFO[0m[0m 03/14 13:45:18 | # of params = 23528522
[37m[36mINFO[0m[0m 03/14 13:48:06 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/14 13:48:06 | 0.292908    0.317511    0.262146    0.259997    2.098241    0.292908    0.317511    0.420465    0.415511    0.129093    0.124685    0.236881    0.239796    0           0.000000    2.387133    1.015220    167.700877 
[37m[36mINFO[0m[0m 03/14 13:51:51 | 0.487741    0.493671    0.680275    0.695439    0.894966    0.487741    0.493671    0.729747    0.758603    0.662469    0.673804    0.648608    0.653912    200         2.015113    1.116147    0.247180    174.868117 
[37m[36mINFO[0m[0m 03/14 13:55:33 | 0.504086    0.490506    0.738701    0.747206    0.771989    0.504086    0.490506    0.775709    0.807910    0.738035    0.730479    0.702358    0.703231    400         4.030227    0.800205    0.256543    170.672349 
[37m[36mINFO[0m[0m 03/14 13:59:07 | 0.462167    0.483122    0.719291    0.712281    0.802716    0.462167    0.483122    0.777250    0.800205    0.691436    0.641058    0.689186    0.695578    600         6.045340    0.750171    0.254856    163.624454 
[37m[36mINFO[0m[0m 03/14 14:02:44 | 0.417875    0.421941    0.748674    0.758554    0.697027    0.417875    0.421941    0.776351    0.779661    0.732683    0.746851    0.736987    0.749150    800         8.060453    0.781415    0.238199    168.908731 
[37m[36mINFO[0m[0m 03/14 14:06:22 | 0.445030    0.453586    0.634223    0.650488    0.950500    0.445030    0.453586    0.767236    0.790960    0.552897    0.583123    0.582537    0.577381    1000        10.075567   0.920238    0.235613    171.275098 
[37m[36mINFO[0m[0m 03/14 14:09:59 | 0.198524    0.220464    0.618825    0.632962    1.167979    0.198524    0.220464    0.706766    0.746790    0.575882    0.575567    0.573826    0.576531    1200        12.090680   1.060371    0.245694    167.993377 
[37m[36mINFO[0m[0m 03/14 14:13:42 | 0.550751    0.552743    0.624383    0.640740    1.679608    0.550751    0.552743    0.653614    0.696456    0.581549    0.566751    0.637986    0.659014    1400        14.105793   1.396312    0.262506    170.519149 
[37m[36mINFO[0m[0m 03/14 14:17:21 | 0.478249    0.496835    0.657210    0.673137    0.929054    0.478249    0.496835    0.695596    0.711351    0.652708    0.681360    0.623327    0.626701    1600        16.120907   1.254969    0.245758    169.317780 
[37m[36mINFO[0m[0m 03/14 14:21:05 | 0.496704    0.502110    0.583142    0.608291    1.275634    0.496704    0.502110    0.666709    0.696456    0.537783    0.565491    0.544933    0.562925    1800        18.136020   1.185805    0.253718    173.711134 
[37m[36mINFO[0m[0m 03/14 14:24:43 | 0.479831    0.491561    0.513759    0.532391    1.346622    0.479831    0.491561    0.596867    0.628146    0.406486    0.428212    0.537922    0.540816    2000        20.151134   1.484570    0.254528    166.693259 
[37m[36mINFO[0m[0m 03/14 14:28:21 | 0.404429    0.392405    0.480533    0.480306    2.525914    0.404429    0.392405    0.487996    0.496148    0.498111    0.463476    0.455492    0.481293    2200        22.166247   1.599799    0.246946    168.573888 
[37m[36mINFO[0m[0m 03/14 14:31:55 | 0.400211    0.409283    0.551460    0.569295    1.285711    0.400211    0.409283    0.664784    0.673344    0.482053    0.525189    0.507542    0.509354    2400        24.181360   1.640903    0.242626    165.783202 
[37m[36mINFO[0m[0m 03/14 14:35:28 | 0.205906    0.238397    0.515329    0.533571    1.810971    0.205906    0.238397    0.538965    0.569594    0.516688    0.493703    0.490334    0.537415    2600        26.196474   1.672758    0.230898    167.045001 
[37m[36mINFO[0m[0m 03/14 14:39:04 | 0.211706    0.221519    0.384777    0.378673    2.652617    0.211706    0.221519    0.251509    0.258860    0.463476    0.430730    0.439346    0.446429    2800        28.211587   1.621257    0.233627    169.377693 
[37m[36mINFO[0m[0m 03/14 14:42:36 | 0.351701    0.349156    0.483602    0.495899    1.773512    0.351701    0.349156    0.469508    0.506934    0.474181    0.474811    0.507117    0.505952    3000        30.226700   2.208838    0.238258    163.458750 
[37m[36mINFO[0m[0m 03/14 14:46:10 | 0.575798    0.574895    0.490959    0.482534    1.745105    0.575798    0.574895    0.536012    0.561890    0.415302    0.360202    0.521564    0.525510    3200        32.241814   2.000517    0.236481    167.292990 
[37m[36mINFO[0m[0m 03/14 14:49:47 | 0.131558    0.144515    0.393178    0.410726    1.763101    0.131558    0.144515    0.508538    0.522342    0.370592    0.415617    0.300404    0.294218    3400        34.256927   2.422725    0.236473    169.286474 
[37m[36mINFO[0m[0m 03/14 14:53:22 | 0.188241    0.185654    0.298673    0.306919    1.955646    0.188241    0.185654    0.344845    0.384181    0.326826    0.332494    0.224347    0.204082    3600        36.272040   2.076253    0.241390    167.346509 
[37m[36mINFO[0m[0m 03/14 14:57:00 | 0.210388    0.216245    0.437521    0.435166    1.616266    0.210388    0.216245    0.608422    0.621983    0.379093    0.379093    0.325048    0.304422    3800        38.287154   2.217288    0.249953    167.850794 
[37m[36mINFO[0m[0m 03/14 15:00:34 | 0.590298    0.601266    0.330687    0.364198    1.770503    0.590298    0.601266    0.356143    0.399076    0.267317    0.294710    0.368600    0.398810    4000        40.302267   2.196032    0.244151    165.294720 
[37m[36mINFO[0m[0m 03/14 15:04:20 | 0.564461    0.567511    0.304066    0.334210    4.080063    0.564461    0.567511    0.284119    0.305085    0.265428    0.312343    0.362651    0.385204    4200        42.317380   2.023955    0.252923    174.870861 
[37m[36mINFO[0m[0m 03/14 15:08:03 | 0.225152    0.235232    0.481131    0.482668    1.367541    0.225152    0.235232    0.582360    0.607601    0.449307    0.445844    0.411727    0.394558    4400        44.332494   1.982122    0.249957    173.282776 
[37m[36mINFO[0m[0m 03/14 15:11:43 | 0.381756    0.391350    0.420168    0.454716    1.611779    0.381756    0.391350    0.572988    0.584489    0.339736    0.408060    0.347780    0.371599    4600        46.347607   1.819546    0.246859    170.902186 
[37m[36mINFO[0m[0m 03/14 15:15:21 | 0.031901    0.041139    0.254757    0.227114    2.567018    0.031901    0.041139    0.234048    0.205444    0.337531    0.289673    0.192692    0.186224    4800        48.362720   2.044503    0.236370    170.632063 
[37m[36mINFO[0m[0m 03/14 15:19:05 | 0.213288    0.221519    0.473501    0.455599    1.639373    0.213288    0.221519    0.632045    0.627632    0.416247    0.382872    0.372212    0.356293    5000        50.377834   2.121083    0.237891    176.608020 
[37m[36mINFO[0m[0m 03/14 15:19:06 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0]/250314_13-45-16_resnet50_signum/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/14 15:19:07 | ---
[37m[36mINFO[0m[0m 03/14 15:19:07 | test-domain validation(oracle) = 59.030%
[37m[36mINFO[0m[0m 03/14 15:19:07 | training-domain validation(iid) = 41.788%
[37m[36mINFO[0m[0m 03/14 15:19:07 | last = 21.329%
[37m[36mINFO[0m[0m 03/14 15:19:07 | last (inD) = 45.560%
[37m[36mINFO[0m[0m 03/14 15:19:07 | training-domain validation (iid, inD) = 75.855%
[37m[36mINFO[0m[0m 03/14 15:19:07 | === Summary ===
[37m[36mINFO[0m[0m 03/14 15:19:07 | Command: /jsm0707/GENIE/train_all.py resnet50_signum config/resnet50_signum.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita
[37m[36mINFO[0m[0m 03/14 15:19:07 | Unique name: 250314_13-45-16_resnet50_signum
[37m[36mINFO[0m[0m 03/14 15:19:07 | Out path: train_output/TerraIncognita/ERM/[0]/250314_13-45-16_resnet50_signum
[37m[36mINFO[0m[0m 03/14 15:19:07 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/14 15:19:07 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 03/18 02:36:33 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[0]/250318_02-36-33_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250318_02-36-33_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/18 02:36:33 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 02:36:33 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 02:36:33 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 02:36:33 | 
[37m[36mINFO[0m[0m 03/18 02:36:33 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 03/18 02:36:33 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 03/18 02:36:33 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/18 02:36:33 | Batch sizes for each domain: [0, 32, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/18 02:36:33 | steps-per-epoch for each domain: 243.41, 99.25, 147.09 -> min = 99.25
[37m[36mINFO[0m[0m 03/18 02:36:34 | # of params = 23528522
[37m[36mINFO[0m[0m 03/18 02:39:27 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 02:39:27 | 0.200633    0.208861    0.288045    0.304317    2.037928    0.200633    0.208861    0.455514    0.481253    0.186398    0.221662    0.222222    0.210034    0           0.000000    2.387133    1.013992    172.085857 
[37m[36mINFO[0m[0m 03/18 02:43:19 | 0.380174    0.385021    0.682614    0.693146    0.854977    0.380174    0.385021    0.740018    0.743195    0.676637    0.705290    0.631188    0.630952    200         2.015113    1.292348    0.320472    167.164726 
[37m[36mINFO[0m[0m 03/18 02:47:25 | 0.445558    0.460970    0.725266    0.732820    0.759793    0.445558    0.460970    0.770060    0.801746    0.713791    0.697733    0.691948    0.698980    400         4.030227    0.835589    0.420280    162.487390 
[37m[36mINFO[0m[0m 03/18 02:51:12 | 0.494332    0.469409    0.751081    0.761979    0.647820    0.494332    0.469409    0.800231    0.816641    0.731108    0.740554    0.721904    0.728741    600         6.045340    0.709202    0.293206    168.608968 
[37m[36mINFO[0m[0m 03/18 02:54:52 | 0.509623    0.521097    0.788782    0.787929    0.587989    0.509623    0.521097    0.827963    0.846944    0.786524    0.779597    0.751859    0.737245    800         8.060453    0.614781    0.247802    169.801807 
[37m[36mINFO[0m[0m 03/18 02:58:31 | 0.519641    0.521097    0.804291    0.807525    0.533352    0.519641    0.521097    0.841315    0.858243    0.792506    0.789673    0.779052    0.774660    1000        10.075567   0.560591    0.251921    168.760276 
[37m[36mINFO[0m[0m 03/18 03:02:11 | 0.449776    0.454641    0.819699    0.820046    0.496279    0.449776    0.454641    0.842599    0.868002    0.818325    0.809824    0.798173    0.782313    1200        12.090680   0.526284    0.248024    170.530891 
[37m[36mINFO[0m[0m 03/18 03:05:52 | 0.535724    0.552743    0.824092    0.820382    0.503617    0.535724    0.552743    0.848761    0.861325    0.817695    0.807305    0.805821    0.792517    1400        14.105793   0.493745    0.275362    165.932646 
[37m[36mINFO[0m[0m 03/18 03:09:35 | 0.433957    0.449367    0.848872    0.840109    0.463754    0.433957    0.449367    0.870715    0.883410    0.851385    0.832494    0.824517    0.804422    1600        16.120907   0.466678    0.252387    172.095987 
[37m[36mINFO[0m[0m 03/18 03:13:21 | 0.459531    0.471519    0.845692    0.842354    0.451726    0.459531    0.471519    0.867634    0.878274    0.849811    0.835013    0.819630    0.813776    1800        18.136020   0.447787    0.287676    169.146357 
[37m[36mINFO[0m[0m 03/18 03:17:02 | 0.470867    0.476793    0.853014    0.841108    0.433279    0.470867    0.476793    0.862242    0.878788    0.853589    0.835013    0.843212    0.809524    2000        20.151134   0.430962    0.269808    166.754908 
[37m[36mINFO[0m[0m 03/18 03:20:38 | 0.486686    0.506329    0.853856    0.840369    0.454827    0.486686    0.506329    0.868147    0.888033    0.860831    0.833753    0.832590    0.799320    2200        22.166247   0.390327    0.242908    167.614259 
[37m[36mINFO[0m[0m 03/18 03:24:16 | 0.389402    0.407173    0.870202    0.860527    0.413421    0.389402    0.407173    0.879189    0.900360    0.880982    0.858942    0.850436    0.822279    2400        24.181360   0.382293    0.271958    163.475161 
[37m[36mINFO[0m[0m 03/18 03:27:52 | 0.467176    0.483122    0.863799    0.853998    0.405256    0.467176    0.483122    0.870330    0.887006    0.867443    0.847607    0.853622    0.827381    2600        26.196474   0.378509    0.249876    165.456733 
[37m[36mINFO[0m[0m 03/18 03:31:39 | 0.349064    0.361814    0.873532    0.856988    0.412753    0.349064    0.361814    0.875080    0.890087    0.892317    0.852645    0.853197    0.828231    2800        28.211587   0.350289    0.266003    174.138752 
[37m[36mINFO[0m[0m 03/18 03:35:29 | 0.369628    0.392405    0.883635    0.865931    0.389456    0.369628    0.392405    0.887020    0.896764    0.901763    0.872796    0.862120    0.828231    3000        30.226700   0.340839    0.288688    172.451494 
[37m[36mINFO[0m[0m 03/18 03:39:13 | 0.403111    0.419831    0.891779    0.872932    0.371810    0.403111    0.419831    0.894852    0.901387    0.899244    0.855164    0.881241    0.862245    3200        32.241814   0.326212    0.255078    173.278499 
[37m[36mINFO[0m[0m 03/18 03:42:53 | 0.400211    0.417722    0.885323    0.852771    0.421629    0.400211    0.417722    0.903582    0.910632    0.903652    0.855164    0.848736    0.792517    3400        34.256927   0.302364    0.269534    165.375096 
[37m[36mINFO[0m[0m 03/18 03:46:34 | 0.320063    0.350211    0.888582    0.861475    0.403701    0.320063    0.350211    0.893183    0.892655    0.904282    0.865239    0.868281    0.826531    3600        36.272040   0.307537    0.272603    167.115385 
[37m[36mINFO[0m[0m 03/18 03:50:10 | 0.532033    0.549578    0.903386    0.879161    0.353964    0.532033    0.549578    0.907690    0.910632    0.917191    0.881612    0.885277    0.845238    3800        38.287154   0.306357    0.240905    167.694155 
[37m[36mINFO[0m[0m 03/18 03:53:54 | 0.463485    0.478903    0.905943    0.885939    0.347593    0.463485    0.478903    0.909616    0.908577    0.916562    0.892947    0.891651    0.856293    4000        40.302267   0.273310    0.277790    168.569221 
[37m[36mINFO[0m[0m 03/18 03:57:31 | 0.432375    0.436709    0.892111    0.875347    0.400157    0.432375    0.436709    0.901528    0.910118    0.903338    0.871537    0.871468    0.844388    4200        42.317380   0.287021    0.247198    166.767466 
[37m[36mINFO[0m[0m 03/18 04:01:11 | 0.451885    0.478903    0.916806    0.888159    0.335791    0.451885    0.478903    0.921171    0.912686    0.925063    0.892947    0.904185    0.858844    4400        44.332494   0.271965    0.272268    165.871634 
[37m[36mINFO[0m[0m 03/18 04:04:53 | 0.456631    0.453586    0.902269    0.877469    0.365334    0.456631    0.453586    0.904866    0.898819    0.916877    0.886650    0.885065    0.846939    4600        46.347607   0.261461    0.270482    167.591180 
[37m[36mINFO[0m[0m 03/18 04:08:26 | 0.479040    0.477848    0.905805    0.880583    0.355459    0.479040    0.477848    0.911799    0.908064    0.920340    0.879093    0.885277    0.854592    4800        48.362720   0.263621    0.246212    164.394860 
[37m[36mINFO[0m[0m 03/18 04:12:09 | 0.560506    0.571730    0.920337    0.895648    0.332206    0.560506    0.571730    0.921428    0.925013    0.931360    0.897985    0.908222    0.863946    5000        50.377834   0.229154    0.278291    166.776343 
[37m[36mINFO[0m[0m 03/18 04:12:09 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0]/250318_02-36-33_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 04:12:10 | ---
[37m[36mINFO[0m[0m 03/18 04:12:10 | test-domain validation(oracle) = 56.051%
[37m[36mINFO[0m[0m 03/18 04:12:10 | training-domain validation(iid) = 56.051%
[37m[36mINFO[0m[0m 03/18 04:12:10 | last = 56.051%
[37m[36mINFO[0m[0m 03/18 04:12:10 | last (inD) = 89.565%
[37m[36mINFO[0m[0m 03/18 04:12:10 | training-domain validation (iid, inD) = 89.565%
[37m[36mINFO[0m[0m 03/18 04:12:10 | === Summary ===
[37m[36mINFO[0m[0m 03/18 04:12:10 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita
[37m[36mINFO[0m[0m 03/18 04:12:10 | Unique name: 250318_02-36-33_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 04:12:10 | Out path: train_output/TerraIncognita/ERM/[0]/250318_02-36-33_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 04:12:10 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 04:12:10 | Dataset: TerraIncognita

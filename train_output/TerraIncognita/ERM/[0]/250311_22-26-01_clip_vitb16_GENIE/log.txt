[37m[36mINFO[0m[0m 03/11 22:26:01 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 14
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 14
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/TerraIncognita/ERM/[0]/250311_22-26-01_clip_vitb16_GENIE
	out_root: train_output/TerraIncognita/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250311_22-26-01_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.1399727535070965e-05
	batch_size: 16
	weight_decay: 0.00022842646099519332
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: openclip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/11 22:26:01 | n_steps = 5001
[37m[36mINFO[0m[0m 03/11 22:26:01 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/11 22:26:01 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/11 22:26:01 | 
[37m[36mINFO[0m[0m 03/11 22:26:01 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 03/11 22:26:01 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 03/11 22:26:01 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/11 22:26:01 | Batch sizes for each domain: [0, 16, 16, 16] (total=48)
[37m[36mINFO[0m[0m 03/11 22:26:01 | steps-per-epoch for each domain: 486.81, 198.50, 294.19 -> min = 198.50
[37m[36mINFO[0m[0m 03/11 22:26:03 | # of params = 86197770
[37m[36mINFO[0m[0m 03/11 22:28:55 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/11 22:28:55 | 0.010546    0.020042    0.146326    0.130959    2.318121    0.010546    0.020042    0.005264    0.002568    0.272040    0.232997    0.161674    0.157313    0           0.000000    2.356208    1.019557    171.105792 
[37m[36mINFO[0m[0m 03/11 22:32:30 | 0.209333    0.226793    0.446740    0.470974    1.511789    0.209333    0.226793    0.562460    0.581921    0.361146    0.382872    0.416614    0.448129    200         1.007557    1.660778    0.234096    167.492921 
[37m[36mINFO[0m[0m 03/11 22:36:09 | 0.208542    0.218354    0.446911    0.473932    1.608678    0.208542    0.218354    0.569650    0.607088    0.368703    0.426952    0.402379    0.387755    400         2.015113    1.521369    0.248259    169.858852 
[37m[36mINFO[0m[0m 03/11 22:39:53 | 0.210124    0.217300    0.453944    0.460608    1.489011    0.210124    0.217300    0.572859    0.591166    0.364924    0.379093    0.424049    0.411565    600         3.022670    1.502221    0.284766    167.308016 
[37m[36mINFO[0m[0m 03/11 22:43:53 | 0.220142    0.229958    0.492358    0.517224    1.318924    0.220142    0.229958    0.589036    0.625578    0.429786    0.460957    0.458254    0.465136    800         4.030227    1.430406    0.339365    171.798185 
[37m[36mINFO[0m[0m 03/11 22:47:36 | 0.216451    0.219409    0.510922    0.519449    1.260439    0.216451    0.219409    0.613172    0.632255    0.455605    0.460957    0.463990    0.465136    1000        5.037783    1.326512    0.260558    170.322932 
[37m[36mINFO[0m[0m 03/11 22:51:05 | 0.212497    0.220464    0.484338    0.483334    1.317815    0.212497    0.220464    0.610091    0.625578    0.392317    0.365239    0.450605    0.459184    1200        6.045340    1.288421    0.218663    166.052125 
[37m[36mINFO[0m[0m 03/11 22:54:39 | 0.210915    0.220464    0.540355    0.557553    1.188298    0.210915    0.220464    0.644499    0.665639    0.487720    0.516373    0.488846    0.490646    1400        7.052897    1.255664    0.240164    166.124818 
[37m[36mINFO[0m[0m 03/11 22:58:25 | 0.137622    0.149789    0.564919    0.569329    1.144056    0.137622    0.149789    0.633714    0.662044    0.529282    0.531486    0.531761    0.514456    1600        8.060453    1.225161    0.248468    175.388367 
[37m[36mINFO[0m[0m 03/11 23:02:15 | 0.130767    0.151899    0.584357    0.602151    1.113728    0.130767    0.151899    0.676595    0.696970    0.553212    0.583123    0.523263    0.526361    1800        9.068010    1.124672    0.299415    170.827516 
[37m[36mINFO[0m[0m 03/11 23:06:05 | 0.158713    0.174051    0.623431    0.638313    0.990386    0.158713    0.174051    0.677494    0.706728    0.605164    0.609572    0.587635    0.598639    2000        10.075567   1.090481    0.318815    166.221913 
[37m[36mINFO[0m[0m 03/11 23:09:45 | 0.265489    0.273207    0.644736    0.653814    0.962439    0.265489    0.273207    0.678778    0.708269    0.643577    0.651134    0.611855    0.602041    2200        11.083123   1.031804    0.234476    172.767090 
[37m[36mINFO[0m[0m 03/11 23:13:19 | 0.172423    0.187764    0.664810    0.674423    0.927018    0.172423    0.187764    0.713185    0.725218    0.652393    0.666247    0.628851    0.631803    2400        12.090680   0.959938    0.228157    168.136796 
[37m[36mINFO[0m[0m 03/11 23:16:59 | 0.090693    0.101266    0.685656    0.692045    0.858789    0.090693    0.101266    0.712928    0.733436    0.686083    0.698992    0.657956    0.643707    2600        13.098237   0.909610    0.255470    169.455931 
[37m[36mINFO[0m[0m 03/11 23:20:47 | 0.224888    0.240506    0.671311    0.684801    0.874367    0.224888    0.240506    0.712287    0.731382    0.669395    0.675063    0.632250    0.647959    2800        14.105793   0.870493    0.266710    174.317459 
[37m[36mINFO[0m[0m 03/11 23:24:45 | 0.202478    0.213080    0.713944    0.715061    0.794578    0.202478    0.213080    0.737322    0.756035    0.727645    0.724181    0.676864    0.664966    3000        15.113350   0.822030    0.340365    169.514752 
[37m[36mINFO[0m[0m 03/11 23:28:34 | 0.212760    0.231013    0.709193    0.709246    0.810538    0.212760    0.231013    0.737193    0.747817    0.709698    0.714106    0.680688    0.665816    3200        16.120907   0.812943    0.283369    173.254652 
[37m[36mINFO[0m[0m 03/11 23:32:07 | 0.229106    0.252110    0.721092    0.708170    0.793581    0.229106    0.252110    0.749005    0.756549    0.719773    0.685139    0.694498    0.682823    3400        17.128463   0.770541    0.241078    164.476844 
[37m[36mINFO[0m[0m 03/11 23:35:41 | 0.253361    0.274262    0.742089    0.730217    0.714871    0.253361    0.274262    0.735653    0.753980    0.766373    0.731738    0.724240    0.704932    3600        18.136020   0.727026    0.237489    165.912833 
[37m[36mINFO[0m[0m 03/11 23:39:27 | 0.190351    0.205696    0.758555    0.747228    0.681306    0.190351    0.205696    0.780973    0.788392    0.771725    0.761965    0.722966    0.691327    3800        19.143577   0.702683    0.264709    173.338491 
[37m[36mINFO[0m[0m 03/11 23:43:19 | 0.272607    0.282700    0.759590    0.759315    0.645160    0.272607    0.282700    0.776736    0.790447    0.770781    0.746851    0.731251    0.740646    4000        20.151134   0.657674    0.310359    170.525382 
[37m[36mINFO[0m[0m 03/11 23:47:00 | 0.261534    0.266878    0.778545    0.762525    0.628123    0.261534    0.266878    0.781487    0.782229    0.800378    0.780856    0.753771    0.724490    4200        21.158690   0.653132    0.234267    173.399031 
[37m[36mINFO[0m[0m 03/11 23:50:33 | 0.181650    0.203586    0.754253    0.739965    0.688107    0.181650    0.203586    0.754397    0.764766    0.783060    0.717884    0.725303    0.737245    4400        22.166247   0.654492    0.228673    167.729854 
[37m[36mINFO[0m[0m 03/11 23:54:18 | 0.298972    0.318565    0.780265    0.756942    0.664585    0.298972    0.318565    0.786365    0.800205    0.794710    0.736776    0.759720    0.733844    4600        23.173804   0.607665    0.251657    174.163219 
[37m[36mINFO[0m[0m 03/11 23:58:08 | 0.187187    0.198312    0.769281    0.757189    0.665911    0.187187    0.198312    0.770702    0.791474    0.792506    0.760705    0.744636    0.719388    4800        24.181360   0.592713    0.257362    178.389537 
[37m[36mINFO[0m[0m 03/12 00:01:56 | 0.284208    0.299578    0.798452    0.782839    0.596039    0.284208    0.299578    0.795738    0.817155    0.817380    0.774559    0.782239    0.756803    5000        25.188917   0.583967    0.258663    176.484286 
[37m[36mINFO[0m[0m 03/12 00:01:56 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0]/250311_22-26-01_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/12 00:01:58 | ---
[37m[36mINFO[0m[0m 03/12 00:01:58 | test-domain validation(oracle) = 29.897%
[37m[36mINFO[0m[0m 03/12 00:01:58 | training-domain validation(iid) = 28.421%
[37m[36mINFO[0m[0m 03/12 00:01:58 | last = 28.421%
[37m[36mINFO[0m[0m 03/12 00:01:58 | last (inD) = 78.284%
[37m[36mINFO[0m[0m 03/12 00:01:58 | training-domain validation (iid, inD) = 78.284%
[37m[36mINFO[0m[0m 03/12 00:01:58 | === Summary ===
[37m[36mINFO[0m[0m 03/12 00:01:58 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 14
[37m[36mINFO[0m[0m 03/12 00:01:58 | Unique name: 250311_22-26-01_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 00:01:58 | Out path: train_output/TerraIncognita/ERM/[0]/250311_22-26-01_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/12 00:01:58 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/12 00:01:58 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 03/19 14:10:39 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 13
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 13
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[0]/250319_14-10-39_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250319_14-10-39_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00014596629881421895
	batch_size: 9
	weight_decay: 0.0009399117661702502
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/19 14:10:39 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 14:10:39 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 14:10:39 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 14:10:39 | 
[37m[36mINFO[0m[0m 03/19 14:10:39 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 03/19 14:10:39 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 03/19 14:10:39 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 14:10:39 | Batch sizes for each domain: [0, 9, 9, 9] (total=27)
[37m[36mINFO[0m[0m 03/19 14:10:39 | steps-per-epoch for each domain: 865.44, 352.89, 523.00 -> min = 352.89
[37m[36mINFO[0m[0m 03/19 14:10:40 | # of params = 23528522
[37m[36mINFO[0m[0m 03/19 14:13:37 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 14:13:37 | 0.035592    0.050633    0.274953    0.245826    2.084315    0.035592    0.050633    0.340609    0.347201    0.283060    0.235516    0.201190    0.154762    0           0.000000    2.342708    0.967414    175.807633 
[37m[36mINFO[0m[0m 03/19 14:16:53 | 0.137622    0.132911    0.533936    0.541921    1.248537    0.137622    0.132911    0.623957    0.630714    0.495592    0.521411    0.482260    0.473639    200         0.566751    1.491765    0.126045    170.550962 
[37m[36mINFO[0m[0m 03/19 14:20:10 | 0.498550    0.495781    0.608637    0.610696    1.021022    0.498550    0.495781    0.709334    0.726246    0.548489    0.535264    0.568090    0.570578    400         1.133501    1.183386    0.125360    171.957087 
[37m[36mINFO[0m[0m 03/19 14:23:30 | 0.553388    0.558017    0.689022    0.701746    0.827163    0.553388    0.558017    0.741944    0.764766    0.660579    0.673804    0.664542    0.666667    600         1.700252    1.001024    0.149023    170.102654 
[37m[36mINFO[0m[0m 03/19 14:26:45 | 0.310572    0.323840    0.668117    0.677942    0.912248    0.310572    0.323840    0.704327    0.709296    0.671599    0.690176    0.628426    0.634354    800         2.267003    0.896406    0.141000    167.328848 
[37m[36mINFO[0m[0m 03/19 14:30:06 | 0.522542    0.537975    0.729290    0.742498    0.700486    0.522542    0.537975    0.771344    0.791988    0.709068    0.722922    0.707457    0.712585    1000        2.833753    0.811707    0.135881    173.697098 
[37m[36mINFO[0m[0m 03/19 14:33:24 | 0.492750    0.493671    0.697533    0.711528    0.790658    0.492750    0.493671    0.772628    0.796097    0.647355    0.662469    0.672615    0.676020    1200        3.400504    0.803561    0.141357    169.398634 
[37m[36mINFO[0m[0m 03/19 14:36:40 | 0.441603    0.445148    0.734527    0.748461    0.710375    0.441603    0.445148    0.779047    0.790447    0.723237    0.732997    0.701296    0.721939    1400        3.967254    0.786742    0.137105    169.303557 
[37m[36mINFO[0m[0m 03/19 14:40:04 | 0.481940    0.488397    0.727848    0.735742    0.725291    0.481940    0.488397    0.753242    0.777607    0.729219    0.717884    0.701083    0.711735    1600        4.534005    0.747906    0.138053    176.171211 
[37m[36mINFO[0m[0m 03/19 14:43:18 | 0.553915    0.555907    0.745844    0.763013    0.631435    0.553915    0.555907    0.761587    0.789420    0.740869    0.763224    0.735075    0.736395    1800        5.100756    0.713972    0.124883    169.145113 
[37m[36mINFO[0m[0m 03/19 14:46:31 | 0.427366    0.447257    0.735248    0.755573    0.676112    0.427366    0.447257    0.777635    0.803287    0.752519    0.767003    0.675590    0.696429    2000        5.667506    0.664980    0.134286    165.667746 
[37m[36mINFO[0m[0m 03/19 14:49:43 | 0.382283    0.375527    0.735245    0.738996    0.719218    0.382283    0.375527    0.766209    0.779147    0.713161    0.706549    0.726365    0.731293    2200        6.234257    0.662406    0.119018    168.115072 
[37m[36mINFO[0m[0m 03/19 14:52:57 | 0.434485    0.443038    0.743947    0.763125    0.672507    0.434485    0.443038    0.764797    0.787365    0.738980    0.775819    0.728065    0.726190    2400        6.801008    0.648367    0.135088    166.881595 
[37m[36mINFO[0m[0m 03/19 14:56:10 | 0.623781    0.633966    0.782549    0.792591    0.573605    0.623781    0.633966    0.802414    0.817155    0.782116    0.780856    0.763119    0.779762    2600        7.367758    0.622643    0.145671    164.404708 
[37m[36mINFO[0m[0m 03/19 14:59:24 | 0.439230    0.440928    0.783868    0.794750    0.563864    0.439230    0.440928    0.821800    0.847971    0.758186    0.755668    0.771617    0.780612    2800        7.934509    0.607134    0.129358    167.690116 
[37m[36mINFO[0m[0m 03/19 15:02:41 | 0.561824    0.572785    0.798049    0.797999    0.569505    0.561824    0.572785    0.825523    0.825886    0.789358    0.793451    0.779265    0.774660    3000        8.501259    0.580441    0.129455    171.514800 
[37m[36mINFO[0m[0m 03/19 15:05:50 | 0.591352    0.579114    0.795426    0.800687    0.541388    0.591352    0.579114    0.820773    0.832563    0.783690    0.784635    0.781814    0.784864    3200        9.068010    0.562411    0.124222    164.107917 
[37m[36mINFO[0m[0m 03/19 15:09:03 | 0.552597    0.530591    0.796051    0.809721    0.522367    0.552597    0.530591    0.827834    0.860298    0.782116    0.801008    0.778203    0.767857    3400        9.634761    0.584859    0.138359    164.996312 
[37m[36mINFO[0m[0m 03/19 15:12:15 | 0.608489    0.619198    0.803178    0.806327    0.535216    0.608489    0.619198    0.820644    0.838213    0.800063    0.801008    0.788825    0.779762    3600        10.201511   0.540927    0.118164    168.295418 
[37m[36mINFO[0m[0m 03/19 15:15:31 | 0.570525    0.571730    0.800279    0.797741    0.557907    0.570525    0.571730    0.826807    0.839753    0.790302    0.774559    0.783726    0.778912    3800        10.768262   0.558033    0.128151    170.491253 
[37m[36mINFO[0m[0m 03/19 15:18:42 | 0.479040    0.486287    0.805609    0.811206    0.539005    0.479040    0.486287    0.847092    0.865948    0.794081    0.794710    0.775653    0.772959    4000        11.335013   0.524275    0.132612    164.040604 
[37m[36mINFO[0m[0m 03/19 15:22:02 | 0.413657    0.419831    0.802940    0.800679    0.537338    0.413657    0.419831    0.833612    0.849512    0.789358    0.782116    0.785851    0.770408    4200        11.901763   0.519253    0.147776    170.585845 
[37m[36mINFO[0m[0m 03/19 15:25:15 | 0.524123    0.524262    0.804632    0.815913    0.512231    0.524123    0.524262    0.831429    0.855162    0.795340    0.808564    0.787126    0.784014    4400        12.468514   0.524920    0.139503    165.811201 
[37m[36mINFO[0m[0m 03/19 15:28:29 | 0.610598    0.601266    0.810653    0.811106    0.521516    0.610598    0.601266    0.850173    0.858243    0.789987    0.780856    0.791799    0.794218    4600        13.035264   0.509247    0.126964    168.353629 
[37m[36mINFO[0m[0m 03/19 15:31:47 | 0.518060    0.525316    0.817347    0.810218    0.518792    0.518060    0.525316    0.854410    0.857730    0.806045    0.816121    0.791587    0.756803    4800        13.602015   0.522618    0.151869    167.135100 
[37m[36mINFO[0m[0m 03/19 15:35:01 | 0.511205    0.534810    0.790520    0.783449    0.588717    0.511205    0.534810    0.816279    0.820750    0.794710    0.779597    0.760569    0.750000    5000        14.168766   0.502943    0.132124    168.398015 
[37m[36mINFO[0m[0m 03/19 15:35:02 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0]/250319_14-10-39_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 15:35:03 | ---
[37m[36mINFO[0m[0m 03/19 15:35:03 | test-domain validation(oracle) = 62.378%
[37m[36mINFO[0m[0m 03/19 15:35:03 | training-domain validation(iid) = 52.412%
[37m[36mINFO[0m[0m 03/19 15:35:03 | last = 51.120%
[37m[36mINFO[0m[0m 03/19 15:35:03 | last (inD) = 78.345%
[37m[36mINFO[0m[0m 03/19 15:35:03 | training-domain validation (iid, inD) = 81.591%
[37m[36mINFO[0m[0m 03/19 15:35:03 | === Summary ===
[37m[36mINFO[0m[0m 03/19 15:35:03 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 13
[37m[36mINFO[0m[0m 03/19 15:35:03 | Unique name: 250319_14-10-39_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 15:35:03 | Out path: train_output/TerraIncognita/ERM/[0]/250319_14-10-39_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 15:35:03 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 15:35:03 | Dataset: TerraIncognita

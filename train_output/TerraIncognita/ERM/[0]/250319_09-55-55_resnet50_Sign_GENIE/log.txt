[37m[36mINFO[0m[0m 03/19 09:55:55 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 10
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 10
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[0]/250319_09-55-55_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250319_09-55-55_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.5980189819232268e-05
	batch_size: 22
	weight_decay: 1.2831747186887755e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/19 09:55:55 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 09:55:55 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 09:55:55 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 09:55:55 | 
[37m[36mINFO[0m[0m 03/19 09:55:55 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 03/19 09:55:55 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 03/19 09:55:55 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 09:55:55 | Batch sizes for each domain: [0, 22, 22, 22] (total=66)
[37m[36mINFO[0m[0m 03/19 09:55:55 | steps-per-epoch for each domain: 354.05, 144.36, 213.95 -> min = 144.36
[37m[36mINFO[0m[0m 03/19 09:55:56 | # of params = 23528522
[37m[36mINFO[0m[0m 03/19 09:58:45 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 09:58:45 | 0.200633    0.208861    0.287100    0.304317    2.063384    0.200633    0.208861    0.455514    0.481253    0.183564    0.221662    0.222222    0.210034    0           0.000000    2.377722    1.034544    167.345863 
[37m[36mINFO[0m[0m 03/19 10:02:05 | 0.259162    0.254219    0.536549    0.574257    1.172342    0.259162    0.254219    0.655283    0.681048    0.470403    0.528967    0.483960    0.512755    200         1.385390    1.490601    0.187609    162.493117 
[37m[36mINFO[0m[0m 03/19 10:05:26 | 0.419457    0.430380    0.684267    0.699410    0.816965    0.419457    0.430380    0.730646    0.756035    0.677582    0.705290    0.644572    0.636905    400         2.770781    1.058402    0.185070    164.733577 
[37m[36mINFO[0m[0m 03/19 10:08:50 | 0.472449    0.484177    0.724109    0.740295    0.700640    0.472449    0.484177    0.771986    0.794042    0.712217    0.735516    0.688124    0.691327    600         4.156171    0.857003    0.181293    167.430605 
[37m[36mINFO[0m[0m 03/19 10:12:10 | 0.548906    0.564346    0.736645    0.745944    0.687526    0.548906    0.564346    0.789703    0.803801    0.710013    0.705290    0.710219    0.728741    800         5.541562    0.744677    0.176709    164.179665 
[37m[36mINFO[0m[0m 03/19 10:15:30 | 0.457685    0.456751    0.773741    0.786084    0.587426    0.457685    0.456751    0.804083    0.828968    0.768892    0.770781    0.748247    0.758503    1000        6.926952    0.702588    0.185775    162.861985 
[37m[36mINFO[0m[0m 03/19 10:18:54 | 0.508305    0.501055    0.789681    0.798223    0.563545    0.508305    0.501055    0.815252    0.841294    0.786209    0.782116    0.767580    0.771259    1200        8.312343    0.653485    0.175800    169.557800 
[37m[36mINFO[0m[0m 03/19 10:22:20 | 0.433694    0.474684    0.786163    0.797939    0.557979    0.433694    0.474684    0.816665    0.836158    0.774244    0.779597    0.767580    0.778061    1400        9.697733    0.609077    0.182422    169.685417 
[37m[36mINFO[0m[0m 03/19 10:25:46 | 0.583443    0.597046    0.806899    0.810442    0.543036    0.583443    0.597046    0.831044    0.854648    0.806990    0.788413    0.782664    0.788265    1600        11.083123   0.586521    0.184655    168.742216 
[37m[36mINFO[0m[0m 03/19 10:29:10 | 0.452676    0.452532    0.774710    0.781750    0.588417    0.452676    0.452532    0.825138    0.852080    0.741184    0.735516    0.757808    0.757653    1800        12.468514   0.557062    0.180101    167.424230 
[37m[36mINFO[0m[0m 03/19 10:32:31 | 0.446349    0.460970    0.819945    0.806966    0.527194    0.446349    0.460970    0.846065    0.857730    0.806675    0.780856    0.807096    0.782313    2000        13.853904   0.558293    0.185208    163.972874 
[37m[36mINFO[0m[0m 03/19 10:35:56 | 0.546269    0.563291    0.826240    0.817464    0.509052    0.546269    0.563291    0.848633    0.854648    0.818955    0.803526    0.811132    0.794218    2200        15.239295   0.524100    0.183386    168.284567 
[37m[36mINFO[0m[0m 03/19 10:39:16 | 0.457422    0.456751    0.822678    0.824695    0.493134    0.457422    0.456751    0.852613    0.874165    0.819584    0.799748    0.795836    0.800170    2400        16.624685   0.484521    0.181893    164.308972 
[37m[36mINFO[0m[0m 03/19 10:42:44 | 0.518323    0.536920    0.813194    0.808004    0.537832    0.518323    0.536920    0.846579    0.857730    0.802267    0.803526    0.790737    0.762755    2600        18.010076   0.511944    0.187444    170.319251 
[37m[36mINFO[0m[0m 03/19 10:46:08 | 0.409438    0.437764    0.837704    0.833871    0.467802    0.409438    0.437764    0.854410    0.873138    0.850756    0.827456    0.807946    0.801020    2800        19.395466   0.464995    0.192318    165.577252 
[37m[36mINFO[0m[0m 03/19 10:49:36 | 0.550488    0.543249    0.852522    0.850514    0.417570    0.550488    0.543249    0.878162    0.892142    0.851700    0.836272    0.827703    0.823129    3000        20.780856   0.453706    0.189747    169.731790 
[37m[36mINFO[0m[0m 03/19 10:52:56 | 0.367519    0.394515    0.841231    0.846442    0.449849    0.367519    0.394515    0.840930    0.875706    0.854849    0.838791    0.827916    0.824830    3200        22.166247   0.427518    0.177090    164.335016 
[37m[36mINFO[0m[0m 03/19 10:56:23 | 0.398893    0.424051    0.853429    0.850082    0.446575    0.398893    0.424051    0.877776    0.896764    0.849496    0.833753    0.833015    0.819728    3400        23.551637   0.426560    0.181963    170.938203 
[37m[36mINFO[0m[0m 03/19 10:59:48 | 0.612971    0.613924    0.856429    0.845586    0.430394    0.612971    0.613924    0.881628    0.889574    0.854219    0.827456    0.833440    0.819728    3600        24.937028   0.413237    0.183886    168.749238 
[37m[36mINFO[0m[0m 03/19 11:03:11 | 0.485368    0.511603    0.863108    0.849335    0.437477    0.485368    0.511603    0.880216    0.890087    0.872481    0.852645    0.836626    0.805272    3800        26.322418   0.406843    0.189889    164.889396 
[37m[36mINFO[0m[0m 03/19 11:06:36 | 0.594516    0.607595    0.867283    0.848822    0.410648    0.594516    0.607595    0.873154    0.875193    0.877834    0.838791    0.850860    0.832483    4000        27.707809   0.399014    0.185901    167.251617 
[37m[36mINFO[0m[0m 03/19 11:09:58 | 0.420775    0.435654    0.860816    0.836254    0.480685    0.420775    0.435654    0.887919    0.889574    0.857053    0.822418    0.837476    0.796769    4200        29.093199   0.372892    0.181636    165.841887 
[37m[36mINFO[0m[0m 03/19 11:13:19 | 0.462694    0.486287    0.879270    0.869089    0.370127    0.462694    0.486287    0.890101    0.899846    0.886650    0.871537    0.861058    0.835884    4400        30.478589   0.373665    0.181518    165.149744 
[37m[36mINFO[0m[0m 03/19 11:16:45 | 0.520432    0.525316    0.874635    0.864709    0.423780    0.520432    0.525316    0.890487    0.899332    0.882557    0.861461    0.850860    0.833333    4600        31.863980   0.350636    0.182493    169.616009 
[37m[36mINFO[0m[0m 03/19 11:20:05 | 0.394411    0.424051    0.877220    0.857376    0.392857    0.394411    0.424051    0.890358    0.890087    0.880668    0.861461    0.860633    0.820578    4800        33.249370   0.351336    0.181223    162.996853 
[37m[36mINFO[0m[0m 03/19 11:23:29 | 0.569470    0.569620    0.887810    0.870921    0.406703    0.569470    0.569620    0.896264    0.902414    0.902708    0.875315    0.864457    0.835034    5000        34.634761   0.350443    0.185295    167.309167 
[37m[36mINFO[0m[0m 03/19 11:23:29 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0]/250319_09-55-55_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 11:23:31 | ---
[37m[36mINFO[0m[0m 03/19 11:23:31 | test-domain validation(oracle) = 61.297%
[37m[36mINFO[0m[0m 03/19 11:23:31 | training-domain validation(iid) = 56.947%
[37m[36mINFO[0m[0m 03/19 11:23:31 | last = 56.947%
[37m[36mINFO[0m[0m 03/19 11:23:31 | last (inD) = 87.092%
[37m[36mINFO[0m[0m 03/19 11:23:31 | training-domain validation (iid, inD) = 87.092%
[37m[36mINFO[0m[0m 03/19 11:23:31 | === Summary ===
[37m[36mINFO[0m[0m 03/19 11:23:31 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 10
[37m[36mINFO[0m[0m 03/19 11:23:31 | Unique name: 250319_09-55-55_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 11:23:31 | Out path: train_output/TerraIncognita/ERM/[0]/250319_09-55-55_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 11:23:31 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 11:23:31 | Dataset: TerraIncognita

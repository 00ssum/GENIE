[37m[36mINFO[0m[0m 03/19 15:35:07 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 14
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 14
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[0]/250319_15-35-07_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250319_15-35-07_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.1399727535070965e-05
	batch_size: 16
	weight_decay: 0.00022842646099519332
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/19 15:35:07 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 15:35:07 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 15:35:07 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 15:35:07 | 
[37m[36mINFO[0m[0m 03/19 15:35:07 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 03/19 15:35:07 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 03/19 15:35:07 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 15:35:07 | Batch sizes for each domain: [0, 16, 16, 16] (total=48)
[37m[36mINFO[0m[0m 03/19 15:35:07 | steps-per-epoch for each domain: 486.81, 198.50, 294.19 -> min = 198.50
[37m[36mINFO[0m[0m 03/19 15:35:08 | # of params = 23528522
[37m[36mINFO[0m[0m 03/19 15:38:01 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 15:38:01 | 0.204851    0.213080    0.287819    0.304894    2.008728    0.204851    0.213080    0.455514    0.481253    0.181045    0.219144    0.226896    0.214286    0           0.000000    2.359349    1.226822    172.342770 
[37m[36mINFO[0m[0m 03/19 15:41:24 | 0.196414    0.196203    0.569501    0.596523    1.077216    0.196414    0.196203    0.676852    0.697997    0.517947    0.554156    0.513703    0.537415    200         1.007557    1.433859    0.158354    171.319337 
[37m[36mINFO[0m[0m 03/19 15:44:54 | 0.368046    0.371308    0.665690    0.689589    0.843508    0.368046    0.371308    0.755296    0.777607    0.604849    0.639798    0.636924    0.651361    400         2.015113    0.987231    0.178641    173.751303 
[37m[36mINFO[0m[0m 03/19 15:48:18 | 0.418666    0.421941    0.718634    0.722699    0.746879    0.418666    0.421941    0.755424    0.765280    0.718514    0.719144    0.681963    0.683673    600         3.022670    0.839569    0.175147    169.479187 
[37m[36mINFO[0m[0m 03/19 15:51:41 | 0.557870    0.565401    0.712794    0.715358    0.758749    0.557870    0.565401    0.773784    0.802773    0.681360    0.685139    0.683238    0.658163    800         4.030227    0.750782    0.168019    169.070426 
[37m[36mINFO[0m[0m 03/19 15:55:10 | 0.520696    0.508439    0.751337    0.775939    0.632311    0.520696    0.508439    0.802799    0.827940    0.713161    0.743073    0.738050    0.756803    1000        5.037783    0.698534    0.170216    175.014182 
[37m[36mINFO[0m[0m 03/19 15:58:34 | 0.510150    0.508439    0.763200    0.763631    0.641340    0.510150    0.508439    0.796380    0.815614    0.752834    0.738035    0.740387    0.737245    1200        6.045340    0.647211    0.164855    170.737282 
[37m[36mINFO[0m[0m 03/19 16:02:04 | 0.532824    0.544304    0.779166    0.788426    0.586742    0.532824    0.544304    0.797150    0.805855    0.782116    0.774559    0.758232    0.784864    1400        7.052897    0.630690    0.165761    176.585163 
[37m[36mINFO[0m[0m 03/19 16:05:30 | 0.509623    0.508439    0.780719    0.785076    0.583801    0.509623    0.508439    0.820259    0.808937    0.761965    0.770781    0.759932    0.775510    1600        8.060453    0.575629    0.155379    175.717994 
[37m[36mINFO[0m[0m 03/19 16:08:49 | 0.401529    0.415612    0.795373    0.794608    0.562677    0.401529    0.415612    0.796636    0.804314    0.794710    0.799748    0.794774    0.779762    1800        9.068010    0.584081    0.165813    165.478927 
[37m[36mINFO[0m[0m 03/19 16:12:05 | 0.423148    0.436709    0.806818    0.804379    0.522053    0.423148    0.436709    0.833740    0.843862    0.795340    0.802267    0.791375    0.767007    2000        10.075567   0.546421    0.147057    166.558960 
[37m[36mINFO[0m[0m 03/19 16:15:28 | 0.495914    0.515823    0.767813    0.775699    0.614317    0.495914    0.515823    0.831814    0.856703    0.738035    0.754408    0.733588    0.715986    2200        11.083123   0.531754    0.174784    167.676691 
[37m[36mINFO[0m[0m 03/19 16:18:47 | 0.524914    0.544304    0.828339    0.821869    0.482607    0.524914    0.544304    0.850815    0.862352    0.821159    0.804786    0.813044    0.798469    2400        12.090680   0.528729    0.143966    170.222394 
[37m[36mINFO[0m[0m 03/19 16:22:11 | 0.496704    0.510549    0.808598    0.819538    0.496648    0.496704    0.510549    0.853255    0.866975    0.781801    0.782116    0.790737    0.809524    2600        13.098237   0.508144    0.169764    170.137362 
[37m[36mINFO[0m[0m 03/19 16:25:36 | 0.413129    0.427215    0.831165    0.827977    0.478057    0.413129    0.427215    0.860187    0.869029    0.824937    0.824937    0.808371    0.789966    2800        14.105793   0.511019    0.166294    171.639931 
[37m[36mINFO[0m[0m 03/19 16:29:00 | 0.496177    0.498945    0.836064    0.817299    0.511125    0.496177    0.498945    0.858262    0.861839    0.838161    0.806045    0.811770    0.784014    3000        15.113350   0.462322    0.177295    168.673210 
[37m[36mINFO[0m[0m 03/19 16:32:29 | 0.513314    0.514768    0.832731    0.831880    0.468175    0.513314    0.514768    0.860187    0.875193    0.823048    0.823678    0.814956    0.796769    3200        16.120907   0.448769    0.170842    174.910562 
[37m[36mINFO[0m[0m 03/19 16:35:49 | 0.389929    0.398734    0.840192    0.832868    0.468313    0.389929    0.398734    0.865580    0.887006    0.832179    0.817380    0.822817    0.794218    3400        17.128463   0.456764    0.170983    165.898825 
[37m[36mINFO[0m[0m 03/19 16:39:08 | 0.392302    0.408228    0.855680    0.843887    0.446261    0.392302    0.408228    0.879445    0.879815    0.850756    0.828715    0.836839    0.823129    3600        18.136020   0.424369    0.168079    165.322088 
[37m[36mINFO[0m[0m 03/19 16:42:31 | 0.444503    0.462025    0.843981    0.842019    0.456161    0.444503    0.462025    0.871357    0.875193    0.844144    0.838791    0.816444    0.812075    3800        19.143577   0.423253    0.153587    171.940101 
[37m[36mINFO[0m[0m 03/19 16:45:56 | 0.547851    0.551688    0.852594    0.851446    0.436296    0.547851    0.551688    0.867249    0.881870    0.862406    0.845088    0.828128    0.827381    4000        20.151134   0.413293    0.165323    172.101811 
[37m[36mINFO[0m[0m 03/19 16:49:14 | 0.389138    0.421941    0.851782    0.839937    0.456175    0.389138    0.421941    0.883811    0.895737    0.834698    0.806045    0.836839    0.818027    4200        21.158690   0.391350    0.151522    167.458676 
[37m[36mINFO[0m[0m 03/19 16:52:34 | 0.401265    0.408228    0.861494    0.851257    0.421150    0.401265    0.408228    0.882270    0.888546    0.863035    0.846348    0.839176    0.818878    4400        22.166247   0.387026    0.170436    166.229606 
[37m[36mINFO[0m[0m 03/19 16:55:55 | 0.323227    0.333333    0.864608    0.855012    0.416290    0.323227    0.333333    0.868019    0.873138    0.870907    0.855164    0.854897    0.836735    4600        23.173804   0.400032    0.154251    170.700629 
[37m[36mINFO[0m[0m 03/19 16:59:15 | 0.507250    0.504219    0.864977    0.847296    0.416322    0.507250    0.504219    0.868789    0.877761    0.869332    0.832494    0.856809    0.831633    4800        24.181360   0.374309    0.168469    165.482711 
[37m[36mINFO[0m[0m 03/19 17:02:40 | 0.480095    0.494726    0.859165    0.847461    0.438938    0.480095    0.494726    0.871871    0.877761    0.861776    0.860202    0.843850    0.804422    5000        25.188917   0.351569    0.163762    172.897520 
[37m[36mINFO[0m[0m 03/19 17:02:40 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0]/250319_15-35-07_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 17:02:42 | ---
[37m[36mINFO[0m[0m 03/19 17:02:42 | test-domain validation(oracle) = 55.787%
[37m[36mINFO[0m[0m 03/19 17:02:42 | training-domain validation(iid) = 32.323%
[37m[36mINFO[0m[0m 03/19 17:02:42 | last = 48.009%
[37m[36mINFO[0m[0m 03/19 17:02:42 | last (inD) = 84.746%
[37m[36mINFO[0m[0m 03/19 17:02:42 | training-domain validation (iid, inD) = 85.501%
[37m[36mINFO[0m[0m 03/19 17:02:42 | === Summary ===
[37m[36mINFO[0m[0m 03/19 17:02:42 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 14
[37m[36mINFO[0m[0m 03/19 17:02:42 | Unique name: 250319_15-35-07_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 17:02:42 | Out path: train_output/TerraIncognita/ERM/[0]/250319_15-35-07_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 17:02:42 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 17:02:42 | Dataset: TerraIncognita

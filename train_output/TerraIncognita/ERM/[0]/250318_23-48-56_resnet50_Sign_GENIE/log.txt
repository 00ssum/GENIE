[37m[36mINFO[0m[0m 03/18 23:48:56 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 3
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 3
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[0]/250318_23-48-56_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250318_23-48-56_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 6.166705009429313e-05
	batch_size: 14
	weight_decay: 3.4412812120883604e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/18 23:48:56 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 23:48:56 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 23:48:56 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 23:48:56 | 
[37m[36mINFO[0m[0m 03/18 23:48:56 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 03/18 23:48:56 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 03/18 23:48:56 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/18 23:48:56 | Batch sizes for each domain: [0, 14, 14, 14] (total=42)
[37m[36mINFO[0m[0m 03/18 23:48:56 | steps-per-epoch for each domain: 556.36, 226.86, 336.21 -> min = 226.86
[37m[36mINFO[0m[0m 03/18 23:48:57 | # of params = 23528522
[37m[36mINFO[0m[0m 03/18 23:51:47 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 23:51:47 | 0.345900    0.380802    0.255071    0.286628    2.035303    0.345900    0.380802    0.405572    0.480740    0.152078    0.175063    0.207563    0.204082    0           0.000000    2.355394    0.977194    169.004956 
[37m[36mINFO[0m[0m 03/18 23:55:02 | 0.220933    0.224684    0.517124    0.534668    1.252638    0.220933    0.224684    0.602645    0.620442    0.462217    0.488665    0.486509    0.494898    200         0.881612    1.523843    0.130283    168.916296 
[37m[36mINFO[0m[0m 03/18 23:58:15 | 0.220406    0.233122    0.649807    0.658154    0.923206    0.220406    0.233122    0.731930    0.748844    0.627519    0.644836    0.589972    0.580782    400         1.763224    1.172103    0.128269    167.067715 
[37m[36mINFO[0m[0m 03/19 00:01:33 | 0.463485    0.460970    0.689183    0.697510    0.855402    0.463485    0.460970    0.741944    0.767334    0.673174    0.671285    0.652433    0.653912    600         2.644836    0.944466    0.127581    172.177954 
[37m[36mINFO[0m[0m 03/19 00:04:46 | 0.485895    0.490506    0.728708    0.741548    0.716942    0.485895    0.490506    0.771087    0.787879    0.709068    0.724181    0.705970    0.712585    800         3.526448    0.855073    0.128327    167.734573 
[37m[36mINFO[0m[0m 03/19 00:08:03 | 0.550751    0.560127    0.725432    0.728682    0.713939    0.550751    0.560127    0.777635    0.796610    0.719458    0.701511    0.679201    0.687925    1000        4.408060    0.784027    0.127000    171.466299 
[37m[36mINFO[0m[0m 03/19 00:11:18 | 0.394411    0.393460    0.756532    0.765502    0.637595    0.394411    0.393460    0.800616    0.804314    0.737091    0.745592    0.731889    0.746599    1200        5.289673    0.731858    0.125746    169.649560 
[37m[36mINFO[0m[0m 03/19 00:14:36 | 0.542578    0.534810    0.704993    0.731580    0.726155    0.542578    0.534810    0.770831    0.791474    0.659635    0.683879    0.684512    0.719388    1400        6.171285    0.713147    0.142736    170.205539 
[37m[36mINFO[0m[0m 03/19 00:17:51 | 0.532824    0.534810    0.786560    0.794724    0.565196    0.532824    0.534810    0.814225    0.832563    0.781486    0.787154    0.763969    0.764456    1600        7.052897    0.661529    0.128930    168.418433 
[37m[36mINFO[0m[0m 03/19 00:21:09 | 0.492223    0.484177    0.769831    0.784657    0.599929    0.492223    0.484177    0.786751    0.812532    0.771096    0.784635    0.751646    0.756803    1800        7.934509    0.633145    0.127774    172.293126 
[37m[36mINFO[0m[0m 03/19 00:24:20 | 0.419721    0.407173    0.780504    0.792765    0.558295    0.419721    0.407173    0.823212    0.843349    0.778338    0.793451    0.739962    0.741497    2000        8.816121    0.613920    0.127420    165.960509 
[37m[36mINFO[0m[0m 03/19 00:27:40 | 0.543897    0.567511    0.777454    0.770022    0.623845    0.543897    0.567511    0.818334    0.817155    0.762594    0.755668    0.751434    0.737245    2200        9.697733    0.608125    0.129129    173.837573 
[37m[36mINFO[0m[0m 03/19 00:30:58 | 0.476668    0.467300    0.782224    0.787685    0.576825    0.476668    0.467300    0.814996    0.819723    0.778967    0.769521    0.752709    0.773810    2400        10.579345   0.590208    0.132370    171.578660 
[37m[36mINFO[0m[0m 03/19 00:34:17 | 0.540469    0.534810    0.798582    0.804447    0.561232    0.540469    0.534810    0.834639    0.856189    0.787154    0.785894    0.773954    0.771259    2600        11.460957   0.560347    0.132878    172.355060 
[37m[36mINFO[0m[0m 03/19 00:37:34 | 0.495386    0.505274    0.817609    0.806505    0.552877    0.495386    0.505274    0.842342    0.842835    0.814861    0.788413    0.795624    0.788265    2800        12.342569   0.535277    0.136830    170.420553 
[37m[36mINFO[0m[0m 03/19 00:40:50 | 0.367255    0.390295    0.816644    0.818485    0.512915    0.367255    0.390295    0.836436    0.848485    0.811713    0.813602    0.801785    0.793367    3000        13.224181   0.532894    0.135808    168.323911 
[37m[36mINFO[0m[0m 03/19 00:44:03 | 0.482731    0.485232    0.825813    0.831357    0.492703    0.482731    0.485232    0.848504    0.869029    0.826511    0.829975    0.802422    0.795068    3200        14.105793   0.490306    0.139070    165.591653 
[37m[36mINFO[0m[0m 03/19 00:47:15 | 0.495386    0.513713    0.817092    0.815031    0.548467    0.495386    0.513713    0.847606    0.856703    0.816121    0.803526    0.787550    0.784864    3400        14.987406   0.510036    0.137535    164.295074 
[37m[36mINFO[0m[0m 03/19 00:50:32 | 0.522278    0.536920    0.828010    0.819505    0.498292    0.522278    0.536920    0.848119    0.860298    0.820529    0.799748    0.815381    0.798469    3600        15.869018   0.502627    0.134829    169.806685 
[37m[36mINFO[0m[0m 03/19 00:53:46 | 0.466385    0.471519    0.813769    0.807860    0.533399    0.466385    0.471519    0.854410    0.864407    0.780227    0.760705    0.806671    0.798469    3800        16.750630   0.480679    0.136742    166.476167 
[37m[36mINFO[0m[0m 03/19 00:56:58 | 0.563934    0.560127    0.829142    0.823377    0.496812    0.563934    0.560127    0.851457    0.861839    0.833123    0.809824    0.802847    0.798469    4000        17.632242   0.473443    0.132175    165.561710 
[37m[36mINFO[0m[0m 03/19 01:00:09 | 0.540997    0.537975    0.834641    0.843015    0.461434    0.540997    0.537975    0.850302    0.878274    0.840365    0.846348    0.813257    0.804422    4200        18.513854   0.472453    0.130380    164.963882 
[37m[36mINFO[0m[0m 03/19 01:03:24 | 0.470867    0.470464    0.839567    0.838810    0.463405    0.470867    0.470464    0.850302    0.870570    0.839421    0.831234    0.828978    0.814626    4400        19.395466   0.464532    0.131634    168.868389 
[37m[36mINFO[0m[0m 03/19 01:06:46 | 0.270762    0.304852    0.842540    0.825415    0.503719    0.270762    0.304852    0.860573    0.865434    0.845718    0.812343    0.821330    0.798469    4600        20.277078   0.444802    0.130507    176.029336 
[37m[36mINFO[0m[0m 03/19 01:10:04 | 0.458740    0.464135    0.848503    0.835762    0.462823    0.458740    0.464135    0.863654    0.871597    0.859887    0.828715    0.821967    0.806973    4800        21.158690   0.438356    0.136779    170.194128 
[37m[36mINFO[0m[0m 03/19 01:13:20 | 0.548379    0.545359    0.847104    0.845620    0.444659    0.548379    0.545359    0.868918    0.883410    0.851700    0.836272    0.820693    0.817177    5000        22.040302   0.410150    0.133497    169.896992 
[37m[36mINFO[0m[0m 03/19 01:13:20 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0]/250318_23-48-56_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 01:13:22 | ---
[37m[36mINFO[0m[0m 03/19 01:13:22 | test-domain validation(oracle) = 54.390%
[37m[36mINFO[0m[0m 03/19 01:13:22 | training-domain validation(iid) = 54.838%
[37m[36mINFO[0m[0m 03/19 01:13:22 | last = 54.838%
[37m[36mINFO[0m[0m 03/19 01:13:22 | last (inD) = 84.562%
[37m[36mINFO[0m[0m 03/19 01:13:22 | training-domain validation (iid, inD) = 84.562%
[37m[36mINFO[0m[0m 03/19 01:13:22 | === Summary ===
[37m[36mINFO[0m[0m 03/19 01:13:22 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 3
[37m[36mINFO[0m[0m 03/19 01:13:22 | Unique name: 250318_23-48-56_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 01:13:22 | Out path: train_output/TerraIncognita/ERM/[0]/250318_23-48-56_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 01:13:22 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 01:13:22 | Dataset: TerraIncognita

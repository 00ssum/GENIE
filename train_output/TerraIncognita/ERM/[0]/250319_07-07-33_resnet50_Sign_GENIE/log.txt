[37m[36mINFO[0m[0m 03/19 07:07:33 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 8
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 8
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[0]/250319_07-07-33_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250319_07-07-33_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.9932388835350315e-05
	batch_size: 16
	weight_decay: 0.0025315391809104006
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/19 07:07:33 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 07:07:33 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 07:07:33 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 07:07:33 | 
[37m[36mINFO[0m[0m 03/19 07:07:33 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 03/19 07:07:33 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 03/19 07:07:33 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 07:07:33 | Batch sizes for each domain: [0, 16, 16, 16] (total=48)
[37m[36mINFO[0m[0m 03/19 07:07:33 | steps-per-epoch for each domain: 486.81, 198.50, 294.19 -> min = 198.50
[37m[36mINFO[0m[0m 03/19 07:07:34 | # of params = 23528522
[37m[36mINFO[0m[0m 03/19 07:10:20 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 07:10:20 | 0.220670    0.227848    0.278821    0.302060    1.994574    0.220670    0.227848    0.455001    0.481253    0.157116    0.219144    0.224347    0.205782    0           0.000000    2.326834    0.899152    165.393519 
[37m[36mINFO[0m[0m 03/19 07:13:37 | 0.205906    0.202532    0.549376    0.573179    1.106951    0.205906    0.202532    0.638079    0.656908    0.512280    0.556675    0.497769    0.505952    200         1.007557    1.432889    0.131671    170.709793 
[37m[36mINFO[0m[0m 03/19 07:16:52 | 0.256262    0.264768    0.690815    0.711602    0.798139    0.256262    0.264768    0.751958    0.782743    0.657431    0.664987    0.663055    0.687075    400         2.015113    1.003573    0.135588    167.722590 
[37m[36mINFO[0m[0m 03/19 07:20:09 | 0.316372    0.331224    0.707544    0.714087    0.773681    0.316372    0.331224    0.755168    0.769389    0.690176    0.700252    0.677289    0.672619    600         3.022670    0.860595    0.133211    170.143952 
[37m[36mINFO[0m[0m 03/19 07:23:24 | 0.492223    0.497890    0.698169    0.706537    0.815273    0.492223    0.497890    0.767878    0.780175    0.650189    0.654912    0.676439    0.684524    800         4.030227    0.765146    0.140789    166.284323 
[37m[36mINFO[0m[0m 03/19 07:26:41 | 0.437385    0.450422    0.705274    0.716814    0.784470    0.437385    0.450422    0.767749    0.785311    0.659950    0.673804    0.688124    0.691327    1000        5.037783    0.732275    0.136068    169.918947 
[37m[36mINFO[0m[0m 03/19 07:29:56 | 0.345109    0.355485    0.770443    0.784642    0.600016    0.345109    0.355485    0.801643    0.826913    0.761650    0.782116    0.748035    0.744898    1200        6.045340    0.661993    0.132669    168.379373 
[37m[36mINFO[0m[0m 03/19 07:33:12 | 0.448721    0.454641    0.755945    0.759135    0.624835    0.448721    0.454641    0.768006    0.781715    0.750945    0.738035    0.748885    0.757653    1400        7.052897    0.656441    0.135243    169.104484 
[37m[36mINFO[0m[0m 03/19 07:36:27 | 0.547060    0.554852    0.756091    0.753532    0.643018    0.547060    0.554852    0.775067    0.775552    0.754093    0.739295    0.739112    0.745748    1600        8.060453    0.574828    0.140380    167.390507 
[37m[36mINFO[0m[0m 03/19 07:39:44 | 0.432112    0.435654    0.788624    0.794632    0.567598    0.432112    0.435654    0.813583    0.845917    0.769836    0.755668    0.782452    0.782313    1800        9.068010    0.580514    0.141800    168.600710 
[37m[36mINFO[0m[0m 03/19 07:42:57 | 0.563934    0.561181    0.804193    0.799639    0.533946    0.563934    0.561181    0.817948    0.836158    0.799433    0.779597    0.795199    0.783163    2000        10.075567   0.553340    0.136464    165.751631 
[37m[36mINFO[0m[0m 03/19 07:46:15 | 0.438703    0.444093    0.815933    0.811163    0.529885    0.438703    0.444093    0.842599    0.865948    0.821474    0.804786    0.783726    0.762755    2200        11.083123   0.529477    0.136771    170.786306 
[37m[36mINFO[0m[0m 03/19 07:49:27 | 0.437121    0.436709    0.820084    0.824022    0.484779    0.437121    0.436709    0.846322    0.860812    0.811083    0.811083    0.802847    0.800170    2400        12.090680   0.533457    0.132334    164.769723 
[37m[36mINFO[0m[0m 03/19 07:52:48 | 0.610335    0.597046    0.781635    0.797933    0.557889    0.610335    0.597046    0.830530    0.850026    0.742758    0.768262    0.771617    0.775510    2600        13.098237   0.514346    0.148865    171.510531 
[37m[36mINFO[0m[0m 03/19 07:56:04 | 0.500659    0.483122    0.830678    0.822697    0.489973    0.500659    0.483122    0.855951    0.877247    0.823678    0.811083    0.812407    0.779762    2800        14.105793   0.539210    0.134242    168.816674 
[37m[36mINFO[0m[0m 03/19 07:59:15 | 0.497759    0.500000    0.833884    0.820291    0.484328    0.497759    0.500000    0.860829    0.855162    0.827141    0.812343    0.813682    0.793367    3000        15.113350   0.474344    0.129520    165.712802 
[37m[36mINFO[0m[0m 03/19 08:02:30 | 0.621144    0.624473    0.843112    0.847353    0.440146    0.621144    0.624473    0.865195    0.888546    0.840050    0.831234    0.824092    0.822279    3200        16.120907   0.471450    0.137957    166.920819 
[37m[36mINFO[0m[0m 03/19 08:05:49 | 0.378065    0.413502    0.836620    0.828537    0.473161    0.378065    0.413502    0.864039    0.871084    0.835327    0.821159    0.810495    0.793367    3400        17.128463   0.463508    0.135897    171.735682 
[37m[36mINFO[0m[0m 03/19 08:09:04 | 0.461640    0.454641    0.837520    0.819763    0.493613    0.461640    0.454641    0.859931    0.869543    0.834698    0.797229    0.817931    0.792517    3600        18.136020   0.454468    0.139308    167.776778 
[37m[36mINFO[0m[0m 03/19 08:12:21 | 0.529396    0.535865    0.843414    0.830513    0.454221    0.529396    0.535865    0.865965    0.873138    0.846348    0.817380    0.817931    0.801020    3800        19.143577   0.446095    0.138012    168.776408 
[37m[36mINFO[0m[0m 03/19 08:15:42 | 0.520960    0.505274    0.845640    0.835691    0.440657    0.520960    0.505274    0.867505    0.880329    0.843199    0.829975    0.826216    0.796769    4000        20.151134   0.467686    0.141697    173.032753 
[37m[36mINFO[0m[0m 03/19 08:19:03 | 0.440812    0.459916    0.832545    0.814910    0.528619    0.440812    0.459916    0.867762    0.872111    0.810453    0.773300    0.819418    0.799320    4200        21.158690   0.435974    0.139090    172.825373 
[37m[36mINFO[0m[0m 03/19 08:22:22 | 0.427630    0.435654    0.811703    0.793960    0.582151    0.427630    0.435654    0.868533    0.855675    0.765428    0.745592    0.801147    0.780612    4400        22.166247   0.419685    0.145283    170.718517 
[37m[36mINFO[0m[0m 03/19 08:25:36 | 0.483786    0.498945    0.856340    0.843173    0.439282    0.483786    0.498945    0.862113    0.863380    0.861146    0.841310    0.845762    0.824830    4600        23.173804   0.416441    0.138669    166.265488 
[37m[36mINFO[0m[0m 03/19 08:28:51 | 0.450567    0.464135    0.856359    0.842087    0.419889    0.450567    0.464135    0.874695    0.880842    0.860516    0.832494    0.833864    0.812925    4800        24.181360   0.422809    0.140718    166.735786 
[37m[36mINFO[0m[0m 03/19 08:32:07 | 0.431584    0.438819    0.848012    0.827666    0.497424    0.431584    0.438819    0.871100    0.877761    0.850756    0.816121    0.822180    0.789116    5000        25.188917   0.388715    0.139080    168.154674 
[37m[36mINFO[0m[0m 03/19 08:32:07 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0]/250319_07-07-33_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 08:32:09 | ---
[37m[36mINFO[0m[0m 03/19 08:32:09 | test-domain validation(oracle) = 62.114%
[37m[36mINFO[0m[0m 03/19 08:32:09 | training-domain validation(iid) = 62.114%
[37m[36mINFO[0m[0m 03/19 08:32:09 | last = 43.158%
[37m[36mINFO[0m[0m 03/19 08:32:09 | last (inD) = 82.767%
[37m[36mINFO[0m[0m 03/19 08:32:09 | training-domain validation (iid, inD) = 84.735%
[37m[36mINFO[0m[0m 03/19 08:32:09 | === Summary ===
[37m[36mINFO[0m[0m 03/19 08:32:09 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 8
[37m[36mINFO[0m[0m 03/19 08:32:09 | Unique name: 250319_07-07-33_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 08:32:09 | Out path: train_output/TerraIncognita/ERM/[0]/250319_07-07-33_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 08:32:09 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 08:32:09 | Dataset: TerraIncognita

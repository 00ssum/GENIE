[37m[36mINFO[0m[0m 03/19 01:13:26 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 4
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 4
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[0]/250319_01-13-26_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250319_01-13-26_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.0793009436922532e-05
	batch_size: 30
	weight_decay: 0.0007980067844361917
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/19 01:13:26 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 01:13:26 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 01:13:26 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 01:13:26 | 
[37m[36mINFO[0m[0m 03/19 01:13:26 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 03/19 01:13:26 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 03/19 01:13:26 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 01:13:26 | Batch sizes for each domain: [0, 30, 30, 30] (total=90)
[37m[36mINFO[0m[0m 03/19 01:13:26 | steps-per-epoch for each domain: 259.63, 105.87, 156.90 -> min = 105.87
[37m[36mINFO[0m[0m 03/19 01:13:27 | # of params = 23528522
[37m[36mINFO[0m[0m 03/19 01:16:17 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 01:16:17 | 0.200633    0.208861    0.288045    0.304317    2.048212    0.200633    0.208861    0.455514    0.481253    0.186398    0.221662    0.222222    0.210034    0           0.000000    2.414613    0.993896    169.465237 
[37m[36mINFO[0m[0m 03/19 01:19:53 | 0.215133    0.244726    0.633688    0.659303    0.939066    0.215133    0.244726    0.727436    0.739086    0.591940    0.609572    0.581687    0.629252    200         1.889169    1.394080    0.231246    169.006015 
[37m[36mINFO[0m[0m 03/19 01:23:28 | 0.456103    0.473629    0.714034    0.725945    0.746224    0.456103    0.473629    0.759404    0.782229    0.704345    0.717884    0.678351    0.677721    400         3.778338    0.910919    0.228393    169.144376 
[37m[36mINFO[0m[0m 03/19 01:26:56 | 0.502241    0.504219    0.755329    0.750604    0.674314    0.502241    0.504219    0.792143    0.800719    0.738980    0.734257    0.734863    0.716837    600         5.667506    0.745823    0.221093    163.983598 
[37m[36mINFO[0m[0m 03/19 01:30:28 | 0.532033    0.526371    0.768225    0.782906    0.594632    0.532033    0.526371    0.799974    0.822804    0.752204    0.768262    0.752496    0.757653    800         7.556675    0.674027    0.226064    167.168015 
[37m[36mINFO[0m[0m 03/19 01:34:04 | 0.384656    0.379747    0.774368    0.755074    0.644211    0.384656    0.379747    0.801387    0.810478    0.767947    0.748111    0.753771    0.706633    1000        9.445844    0.633540    0.233450    169.123547 
[37m[36mINFO[0m[0m 03/19 01:37:37 | 0.394411    0.410338    0.786778    0.790497    0.579164    0.394411    0.410338    0.820901    0.834617    0.778652    0.775819    0.760782    0.761054    1200        11.335013   0.587750    0.227405    167.233987 
[37m[36mINFO[0m[0m 03/19 01:41:12 | 0.441339    0.444093    0.809982    0.802431    0.545333    0.441339    0.444093    0.841058    0.852594    0.800063    0.778338    0.788825    0.776361    1400        13.224181   0.547616    0.225245    169.944757 
[37m[36mINFO[0m[0m 03/19 01:44:49 | 0.596362    0.592827    0.811968    0.824006    0.515932    0.596362    0.592827    0.845295    0.864920    0.798174    0.803526    0.792437    0.803571    1600        15.113350   0.535528    0.240518    169.670654 
[37m[36mINFO[0m[0m 03/19 01:48:22 | 0.499605    0.490506    0.837321    0.835040    0.465464    0.499605    0.490506    0.864167    0.875193    0.830290    0.813602    0.817506    0.816327    1800        17.002519   0.501990    0.232396    165.556656 
[37m[36mINFO[0m[0m 03/19 01:51:54 | 0.470604    0.467300    0.838801    0.835959    0.461516    0.470604    0.467300    0.863269    0.868002    0.836902    0.833753    0.816231    0.806122    2000        18.891688   0.469394    0.226190    167.715762 
[37m[36mINFO[0m[0m 03/19 01:55:30 | 0.514105    0.511603    0.842953    0.837623    0.464406    0.514105    0.511603    0.863654    0.873652    0.840050    0.818640    0.825154    0.820578    2200        20.780856   0.453513    0.233268    169.331667 
[37m[36mINFO[0m[0m 03/19 01:59:06 | 0.497232    0.512658    0.840219    0.831054    0.482454    0.497232    0.512658    0.861086    0.860812    0.840365    0.823678    0.819205    0.808673    2400        22.670025   0.442724    0.223961    170.700657 
[37m[36mINFO[0m[0m 03/19 02:02:42 | 0.378328    0.396624    0.850262    0.844330    0.455449    0.378328    0.396624    0.861471    0.878788    0.866499    0.843829    0.822817    0.810374    2600        24.559194   0.428748    0.221226    171.985997 
[37m[36mINFO[0m[0m 03/19 02:06:14 | 0.599789    0.589662    0.854884    0.848173    0.442606    0.599789    0.589662    0.875594    0.878788    0.852645    0.840050    0.836414    0.825680    2800        26.448363   0.402974    0.225185    166.746000 
[37m[36mINFO[0m[0m 03/19 02:09:52 | 0.488004    0.507384    0.866357    0.843758    0.422492    0.488004    0.507384    0.880087    0.877761    0.872796    0.831234    0.846187    0.822279    3000        28.337531   0.388181    0.227533    172.635923 
[37m[36mINFO[0m[0m 03/19 02:13:20 | 0.500132    0.500000    0.872965    0.846201    0.425111    0.500132    0.500000    0.891257    0.889060    0.877204    0.842569    0.850436    0.806973    3200        30.226700   0.384312    0.218009    164.278358 
[37m[36mINFO[0m[0m 03/19 02:16:52 | 0.419457    0.422996    0.862569    0.844663    0.449408    0.419457    0.422996    0.885480    0.886492    0.861776    0.836272    0.840450    0.811224    3400        32.115869   0.380115    0.223616    167.718470 
[37m[36mINFO[0m[0m 03/19 02:20:28 | 0.545742    0.556962    0.882139    0.865554    0.392966    0.545742    0.556962    0.892412    0.903441    0.892947    0.851385    0.861058    0.841837    3600        34.005038   0.349880    0.233151    168.979602 
[37m[36mINFO[0m[0m 03/19 02:24:00 | 0.465858    0.460970    0.885177    0.865294    0.380442    0.465858    0.460970    0.895365    0.897278    0.892947    0.862720    0.867219    0.835884    3800        35.894207   0.359151    0.230975    165.259077 
[37m[36mINFO[0m[0m 03/19 02:27:30 | 0.437648    0.448312    0.877783    0.856873    0.389603    0.437648    0.448312    0.875979    0.872111    0.886965    0.870277    0.870406    0.828231    4000        37.783375   0.345188    0.216979    167.142590 
[37m[36mINFO[0m[0m 03/19 02:31:03 | 0.597680    0.611814    0.885331    0.871830    0.390741    0.597680    0.611814    0.893439    0.898305    0.897670    0.872796    0.864882    0.844388    4200        39.672544   0.318585    0.219711    168.885737 
[37m[36mINFO[0m[0m 03/19 02:34:33 | 0.492223    0.503165    0.889442    0.874793    0.377294    0.492223    0.503165    0.901913    0.903955    0.894521    0.885390    0.871893    0.835034    4400        41.561713   0.317666    0.215293    166.775451 
[37m[36mINFO[0m[0m 03/19 02:38:02 | 0.518323    0.513713    0.899368    0.877680    0.367876    0.518323    0.513713    0.900116    0.892142    0.909950    0.880353    0.888039    0.860544    4600        43.450882   0.316129    0.223591    164.873233 
[37m[36mINFO[0m[0m 03/19 02:41:39 | 0.519641    0.520042    0.900725    0.883673    0.353554    0.519641    0.520042    0.902298    0.898819    0.911839    0.894207    0.888039    0.857993    4800        45.340050   0.300421    0.226829    171.611945 
[37m[36mINFO[0m[0m 03/19 02:45:11 | 0.503032    0.520042    0.905764    0.883804    0.354334    0.503032    0.520042    0.913468    0.917822    0.919395    0.886650    0.884427    0.846939    5000        47.229219   0.288386    0.227143    165.739959 
[37m[36mINFO[0m[0m 03/19 02:45:11 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0]/250319_01-13-26_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/19 02:45:12 | ---
[37m[36mINFO[0m[0m 03/19 02:45:12 | test-domain validation(oracle) = 59.768%
[37m[36mINFO[0m[0m 03/19 02:45:12 | training-domain validation(iid) = 50.303%
[37m[36mINFO[0m[0m 03/19 02:45:12 | last = 50.303%
[37m[36mINFO[0m[0m 03/19 02:45:12 | last (inD) = 88.380%
[37m[36mINFO[0m[0m 03/19 02:45:12 | training-domain validation (iid, inD) = 88.380%
[37m[36mINFO[0m[0m 03/19 02:45:12 | === Summary ===
[37m[36mINFO[0m[0m 03/19 02:45:12 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 4
[37m[36mINFO[0m[0m 03/19 02:45:12 | Unique name: 250319_01-13-26_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 02:45:12 | Out path: train_output/TerraIncognita/ERM/[0]/250319_01-13-26_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/19 02:45:12 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/19 02:45:12 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 03/19 22:48:51 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 19
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 19
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[0]/250319_22-48-51_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250319_22-48-51_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5.513854977685438e-05
	batch_size: 27
	weight_decay: 0.0014556716107047517
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/19 22:48:51 | n_steps = 5001
[37m[36mINFO[0m[0m 03/19 22:48:51 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/19 22:48:51 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/19 22:48:51 | 
[37m[36mINFO[0m[0m 03/19 22:48:51 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 03/19 22:48:51 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 03/19 22:48:51 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/19 22:48:51 | Batch sizes for each domain: [0, 27, 27, 27] (total=81)
[37m[36mINFO[0m[0m 03/19 22:48:51 | steps-per-epoch for each domain: 288.48, 117.63, 174.33 -> min = 117.63
[37m[36mINFO[0m[0m 03/19 22:48:52 | # of params = 23528522
[37m[36mINFO[0m[0m 03/19 22:51:44 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/19 22:51:44 | 0.200633    0.208861    0.288045    0.304317    2.047105    0.200633    0.208861    0.455514    0.481253    0.186398    0.221662    0.222222    0.210034    0           0.000000    2.371385    1.442887    171.031672 
[37m[36mINFO[0m[0m 03/19 22:55:14 | 0.245716    0.253165    0.636226    0.638126    0.983277    0.245716    0.253165    0.722686    0.730354    0.605793    0.605793    0.580200    0.578231    200         1.700252    1.350013    0.223272    164.598430 
[37m[36mINFO[0m[0m 03/19 22:58:45 | 0.491168    0.507384    0.715185    0.747994    0.688629    0.491168    0.507384    0.774682    0.799692    0.689547    0.734257    0.681326    0.710034    400         3.400504    0.860341    0.242822    163.023121 
[37m[36mINFO[0m[0m 03/19 23:02:20 | 0.567361    0.558017    0.761391    0.780459    0.630922    0.567361    0.558017    0.798562    0.819209    0.749685    0.761965    0.735925    0.760204    600         5.100756    0.704362    0.218891    170.800226 
[37m[36mINFO[0m[0m 03/19 23:05:48 | 0.554179    0.546414    0.759625    0.765214    0.645297    0.554179    0.546414    0.788548    0.795583    0.755038    0.761965    0.735288    0.738095    800         6.801008    0.638155    0.204815    167.477730 
[37m[36mINFO[0m[0m 03/19 23:09:25 | 0.505141    0.493671    0.791687    0.807493    0.557456    0.505141    0.493671    0.813712    0.836672    0.784635    0.806045    0.776716    0.779762    1000        8.501259    0.594481    0.239054    169.066848 
[37m[36mINFO[0m[0m 03/19 23:13:06 | 0.453731    0.456751    0.801209    0.803989    0.531090    0.453731    0.456751    0.823854    0.846944    0.789673    0.802267    0.790100    0.762755    1200        10.201511   0.570237    0.242653    172.257218 
[37m[36mINFO[0m[0m 03/19 23:16:38 | 0.477722    0.484177    0.809671    0.801644    0.527561    0.477722    0.484177    0.839389    0.845917    0.791877    0.773300    0.797748    0.785714    1400        11.901763   0.513926    0.219746    168.078764 
[37m[36mINFO[0m[0m 03/19 23:20:12 | 0.431848    0.434599    0.807747    0.810736    0.516014    0.431848    0.434599    0.842085    0.850026    0.806990    0.823678    0.774166    0.758503    1600        13.602015   0.485178    0.215572    170.660861 
[37m[36mINFO[0m[0m 03/19 23:23:51 | 0.540469    0.520042    0.831739    0.830722    0.478115    0.540469    0.520042    0.854667    0.874679    0.832179    0.822418    0.808371    0.795068    1800        15.302267   0.475207    0.254133    168.480413 
[37m[36mINFO[0m[0m 03/19 23:27:26 | 0.495386    0.502110    0.819709    0.821117    0.512214    0.495386    0.502110    0.844139    0.854648    0.820214    0.811083    0.794774    0.797619    2000        17.002519   0.468686    0.248733    165.305044 
[37m[36mINFO[0m[0m 03/19 23:31:00 | 0.553651    0.567511    0.836323    0.829070    0.485068    0.553651    0.567511    0.848889    0.860812    0.833438    0.823678    0.826641    0.802721    2200        18.702771   0.457497    0.216086    170.823057 
[37m[36mINFO[0m[0m 03/19 23:34:36 | 0.551279    0.561181    0.853330    0.847903    0.442978    0.551279    0.561181    0.869174    0.879301    0.856738    0.843829    0.834077    0.820578    2400        20.403023   0.427519    0.244438    167.114187 
[37m[36mINFO[0m[0m 03/19 23:38:14 | 0.430794    0.430380    0.863212    0.857236    0.396891    0.430794    0.430380    0.884324    0.889574    0.861461    0.853904    0.843850    0.828231    2600        22.103275   0.389202    0.243453    169.219140 
[37m[36mINFO[0m[0m 03/19 23:41:44 | 0.417348    0.416667    0.869875    0.861710    0.399475    0.417348    0.416667    0.884581    0.891628    0.880982    0.862720    0.844062    0.830782    2800        23.803526   0.387378    0.217036    166.307985 
[37m[36mINFO[0m[0m 03/19 23:45:17 | 0.513578    0.517932    0.867688    0.854276    0.430015    0.513578    0.517932    0.884838    0.889574    0.873741    0.850126    0.844487    0.823129    3000        25.503778   0.361774    0.217823    169.428567 
[37m[36mINFO[0m[0m 03/19 23:48:52 | 0.504877    0.515823    0.881082    0.856412    0.399811    0.504877    0.515823    0.883425    0.880329    0.895151    0.856423    0.864670    0.832483    3200        27.204030   0.369916    0.244379    166.433306 
[37m[36mINFO[0m[0m 03/19 23:52:33 | 0.546797    0.559072    0.874970    0.855959    0.426365    0.546797    0.559072    0.889203    0.895223    0.886335    0.863980    0.849373    0.808673    3400        28.904282   0.349006    0.238430    172.939139 
[37m[36mINFO[0m[0m 03/19 23:56:04 | 0.578434    0.590717    0.880204    0.858756    0.424863    0.578434    0.590717    0.899987    0.894196    0.883816    0.858942    0.856809    0.823129    3600        30.604534   0.330349    0.211505    168.994125 
[37m[36mINFO[0m[0m 03/19 23:59:33 | 0.517796    0.524262    0.882845    0.862077    0.389265    0.517796    0.524262    0.896136    0.893169    0.893892    0.863980    0.858509    0.829082    3800        32.304786   0.333266    0.226425    163.523601 
[37m[36mINFO[0m[0m 03/20 00:03:09 | 0.532824    0.534810    0.881916    0.857725    0.435821    0.532824    0.534810    0.882527    0.883924    0.895151    0.862720    0.868069    0.826531    4000        34.005038   0.311910    0.244552    167.343160 
[37m[36mINFO[0m[0m 03/20 00:06:40 | 0.575798    0.573840    0.876285    0.859045    0.413743    0.575798    0.573840    0.900116    0.899846    0.874055    0.833753    0.854685    0.843537    4200        35.705290   0.317670    0.222304    166.519606 
[37m[36mINFO[0m[0m 03/20 00:10:06 | 0.583970    0.582278    0.892769    0.864996    0.391770    0.583970    0.582278    0.907947    0.906523    0.902078    0.857683    0.868281    0.830782    4400        37.405542   0.308084    0.203719    165.042111 
[37m[36mINFO[0m[0m 03/20 00:13:41 | 0.583970    0.575949    0.896880    0.874370    0.370679    0.583970    0.575949    0.903582    0.898305    0.909005    0.875315    0.878054    0.849490    4600        39.105793   0.296164    0.238745    167.371871 
[37m[36mINFO[0m[0m 03/20 00:17:14 | 0.561033    0.555907    0.894558    0.874937    0.352670    0.561033    0.555907    0.902683    0.898305    0.901448    0.875315    0.879541    0.851190    4800        40.806045   0.288747    0.237674    165.189092 
[37m[36mINFO[0m[0m 03/20 00:20:47 | 0.624835    0.607595    0.909929    0.886146    0.336186    0.624835    0.607595    0.913724    0.914741    0.926322    0.894207    0.889739    0.849490    5000        42.506297   0.276491    0.208695    171.678695 
[37m[36mINFO[0m[0m 03/20 00:20:47 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0]/250319_22-48-51_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/20 00:20:49 | ---
[37m[36mINFO[0m[0m 03/20 00:20:49 | test-domain validation(oracle) = 62.484%
[37m[36mINFO[0m[0m 03/20 00:20:49 | training-domain validation(iid) = 62.484%
[37m[36mINFO[0m[0m 03/20 00:20:49 | last = 62.484%
[37m[36mINFO[0m[0m 03/20 00:20:49 | last (inD) = 88.615%
[37m[36mINFO[0m[0m 03/20 00:20:49 | training-domain validation (iid, inD) = 88.615%
[37m[36mINFO[0m[0m 03/20 00:20:49 | === Summary ===
[37m[36mINFO[0m[0m 03/20 00:20:49 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 19
[37m[36mINFO[0m[0m 03/20 00:20:49 | Unique name: 250319_22-48-51_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/20 00:20:49 | Out path: train_output/TerraIncognita/ERM/[0]/250319_22-48-51_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/20 00:20:49 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/20 00:20:49 | Dataset: TerraIncognita

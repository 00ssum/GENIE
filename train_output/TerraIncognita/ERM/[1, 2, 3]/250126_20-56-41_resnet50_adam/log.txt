[37m[36mINFO[0m[0m 01/26 20:56:41 | Command :: /jsm0707/Large-scale/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm ERM --test_envs 1 2 3 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_adam.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_adam
	out_dir: train_output/TerraIncognita/ERM/[1, 2, 3]/250126_20-56-41_resnet50_adam
	out_root: train_output/TerraIncognita/ERM/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 0
	unique_name: 250126_20-56-41_resnet50_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/26 20:56:41 | n_steps = 5001
[37m[36mINFO[0m[0m 01/26 20:56:41 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/26 20:56:41 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/26 20:56:41 | 
[37m[36mINFO[0m[0m 01/26 20:56:41 | Testenv name escaping te_L38_L43_L46 -> te_L38_L43_L46
[37m[36mINFO[0m[0m 01/26 20:56:41 | Test envs = [1, 2, 3], name = te_L38_L43_L46
[37m[36mINFO[0m[0m 01/26 20:56:41 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 01/26 20:56:41 | Batch sizes for each domain: [32, 0, 0, 0] (total=32)
[37m[36mINFO[0m[0m 01/26 20:56:41 | steps-per-epoch for each domain: 118.53 -> min = 118.53
[37m[36mINFO[0m[0m 01/26 20:56:42 | # of params = 23528522
[37m[36mINFO[0m[0m 01/26 20:59:16 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/26 20:59:16 | 0.275810    0.287557    0.214869    0.208861    2.157614    0.214869    0.208861    0.441905    0.464304    0.119962    0.134761    0.265562    0.263605    0           0.000000    2.953307    1.025517    152.194019 
[37m[36mINFO[0m[0m 01/26 21:02:34 | 0.171175    0.186210    0.820195    0.823840    0.513387    0.820195    0.823840    0.110926    0.123780    0.183564    0.207809    0.219035    0.227041    200         1.687319    0.748218    0.226788    152.583266 
[37m[36mINFO[0m[0m 01/26 21:05:58 | 0.258234    0.274814    0.864224    0.855485    0.430774    0.864224    0.855485    0.290410    0.315357    0.191751    0.187657    0.292543    0.321429    400         3.374637    0.467713    0.228090    158.260778 
[37m[36mINFO[0m[0m 01/26 21:09:13 | 0.263082    0.272363    0.891115    0.880802    0.299251    0.891115    0.880802    0.227885    0.236775    0.239924    0.236776    0.321436    0.343537    600         5.061956    0.351986    0.220485    150.372372 
[37m[36mINFO[0m[0m 01/26 21:12:32 | 0.274348    0.287069    0.899815    0.888186    0.335466    0.899815    0.888186    0.350751    0.375963    0.191436    0.190176    0.280858    0.295068    800         6.749275    0.329812    0.217087    155.815330 
[37m[36mINFO[0m[0m 01/26 21:15:55 | 0.213097    0.232367    0.915634    0.913502    0.264375    0.915634    0.913502    0.225831    0.251669    0.207809    0.211587    0.205651    0.233844    1000        8.436594    0.260034    0.222300    157.769170 
[37m[36mINFO[0m[0m 01/26 21:19:15 | 0.258657    0.271720    0.922752    0.914557    0.252781    0.922752    0.914557    0.326871    0.334874    0.238350    0.245592    0.210750    0.234694    1200        10.123912   0.242555    0.228436    154.475664 
[37m[36mINFO[0m[0m 01/26 21:22:36 | 0.274135    0.287900    0.906670    0.899789    0.277264    0.906670    0.899789    0.352677    0.371854    0.227960    0.239295    0.241768    0.252551    1400        11.811231   0.231631    0.217831    157.789943 
[37m[36mINFO[0m[0m 01/26 21:25:47 | 0.314178    0.327742    0.929871    0.898734    0.317928    0.929871    0.898734    0.399538    0.408834    0.221348    0.234257    0.321649    0.340136    1600        13.498550   0.209683    0.217538    147.618688 
[37m[36mINFO[0m[0m 01/26 21:29:08 | 0.240775    0.254326    0.932244    0.910338    0.296722    0.932244    0.910338    0.274361    0.280431    0.253149    0.268262    0.194816    0.214286    1800        15.185869   0.178275    0.221918    156.067180 
[37m[36mINFO[0m[0m 01/26 21:32:23 | 0.239688    0.252275    0.948590    0.930380    0.259939    0.948590    0.930380    0.339710    0.355932    0.217254    0.236776    0.162099    0.164116    2000        16.873187   0.159401    0.226770    149.310838 
[37m[36mINFO[0m[0m 01/26 21:35:38 | 0.244546    0.248081    0.959399    0.941983    0.211207    0.959399    0.941983    0.317499    0.330252    0.240869    0.243073    0.175271    0.170918    2200        18.560506   0.143536    0.226815    150.277605 
[37m[36mINFO[0m[0m 01/26 21:38:56 | 0.229359    0.229049    0.962563    0.941983    0.173153    0.962563    0.941983    0.334318    0.343092    0.199307    0.192695    0.154451    0.151361    2400        20.247825   0.157632    0.216191    154.405869 
[37m[36mINFO[0m[0m 01/26 21:42:12 | 0.244015    0.254424    0.967835    0.940928    0.171389    0.967835    0.940928    0.335216    0.350796    0.256612    0.261965    0.140217    0.150510    2600        21.935144   0.137717    0.224625    150.573993 
[37m[36mINFO[0m[0m 01/26 21:45:24 | 0.234297    0.244251    0.961508    0.936709    0.188381    0.961508    0.936709    0.296444    0.304058    0.243073    0.256927    0.163374    0.171769    2800        23.622462   0.119578    0.214869    149.584291 
[37m[36mINFO[0m[0m 01/26 21:48:34 | 0.273517    0.285983    0.962299    0.930380    0.249141    0.962299    0.930380    0.413917    0.434001    0.218829    0.229219    0.187805    0.194728    3000        25.309781   0.103821    0.214313    146.791871 
[37m[36mINFO[0m[0m 01/26 21:51:45 | 0.258947    0.259074    0.957817    0.932489    0.211147    0.957817    0.932489    0.364617    0.371854    0.230793    0.219144    0.181432    0.186224    3200        26.997100   0.121199    0.215261    148.190479 
[37m[36mINFO[0m[0m 01/26 21:55:09 | 0.269402    0.279144    0.962563    0.944093    0.171406    0.962563    0.944093    0.346514    0.360041    0.242443    0.239295    0.219248    0.238095    3400        28.684419   0.121193    0.221894    159.244365 
[37m[36mINFO[0m[0m 01/26 21:58:33 | 0.247934    0.246769    0.971263    0.945148    0.162268    0.971263    0.945148    0.349467    0.354905    0.234572    0.217884    0.159762    0.167517    3600        30.371737   0.088748    0.229550    158.044803 
[37m[36mINFO[0m[0m 01/26 22:01:54 | 0.283203    0.296246    0.964672    0.948312    0.172866    0.964672    0.948312    0.405957    0.418593    0.232053    0.240554    0.211600    0.229592    3800        32.059056   0.079554    0.226266    156.491989 
[37m[36mINFO[0m[0m 01/26 22:05:17 | 0.249489    0.269251    0.967835    0.956751    0.147655    0.967835    0.956751    0.268841    0.286595    0.252519    0.274559    0.227109    0.246599    4000        33.746375   0.101875    0.225501    157.119791 
[37m[36mINFO[0m[0m 01/26 22:08:30 | 0.228528    0.236676    0.957817    0.933544    0.203781    0.957817    0.933544    0.278470    0.304571    0.240554    0.245592    0.166560    0.159864    4200        35.433694   0.102795    0.222342    148.589294 
[37m[36mINFO[0m[0m 01/26 22:11:43 | 0.265045    0.265450    0.973372    0.958861    0.137440    0.973372    0.958861    0.321736    0.335901    0.240554    0.234257    0.232845    0.226190    4400        37.121012   0.088059    0.231597    147.006621 
[37m[36mINFO[0m[0m 01/26 22:15:07 | 0.202191    0.208590    0.974690    0.950422    0.136559    0.974690    0.950422    0.272821    0.278891    0.228589    0.238035    0.105163    0.108844    4600        38.808331   0.073132    0.223015    158.806976 
[37m[36mINFO[0m[0m 01/26 22:18:24 | 0.272443    0.283780    0.969681    0.950422    0.157625    0.969681    0.950422    0.344075    0.357473    0.208753    0.214106    0.264500    0.279762    4800        40.495650   0.086154    0.228820    151.794270 
[37m[36mINFO[0m[0m 01/26 22:21:48 | 0.269477    0.288704    0.980227    0.960970    0.120206    0.980227    0.960970    0.334574    0.364664    0.246537    0.253149    0.227321    0.248299    5000        42.182969   0.076114    0.228331    157.868583 
[37m[36mINFO[0m[0m 01/26 22:21:48 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[1, 2, 3]/250126_20-56-41_resnet50_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/26 22:21:49 | ---
[37m[36mINFO[0m[0m 01/26 22:21:49 | test-domain validation(oracle) = 31.418%
[37m[36mINFO[0m[0m 01/26 22:21:49 | training-domain validation(iid) = 26.948%
[37m[36mINFO[0m[0m 01/26 22:21:49 | last = 26.948%
[37m[36mINFO[0m[0m 01/26 22:21:49 | last (inD) = 96.097%
[37m[36mINFO[0m[0m 01/26 22:21:49 | training-domain validation (iid, inD) = 96.097%
[37m[36mINFO[0m[0m 01/26 22:21:49 | === Summary ===
[37m[36mINFO[0m[0m 01/26 22:21:49 | Command: /jsm0707/Large-scale/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm ERM --test_envs 1 2 3 --dataset TerraIncognita
[37m[36mINFO[0m[0m 01/26 22:21:49 | Unique name: 250126_20-56-41_resnet50_adam
[37m[36mINFO[0m[0m 01/26 22:21:49 | Out path: train_output/TerraIncognita/ERM/[1, 2, 3]/250126_20-56-41_resnet50_adam
[37m[36mINFO[0m[0m 01/26 22:21:49 | Algorithm: ERM
[37m[36mINFO[0m[0m 01/26 22:21:49 | Dataset: TerraIncognita

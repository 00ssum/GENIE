[37m[36mINFO[0m[0m 03/20 05:39:52 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 2 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 7
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 7
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[1, 2, 3]/250320_05-39-52_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 2
	unique_name: 250320_05-39-52_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00023761560100715143
	batch_size: 20
	weight_decay: 4.1733891298839565e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/20 05:39:52 | n_steps = 5001
[37m[36mINFO[0m[0m 03/20 05:39:52 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/20 05:39:52 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/20 05:39:52 | 
[37m[36mINFO[0m[0m 03/20 05:39:52 | Testenv name escaping te_L38_L43_L46 -> te_L38_L43_L46
[37m[36mINFO[0m[0m 03/20 05:39:52 | Test envs = [1, 2, 3], name = te_L38_L43_L46
[37m[36mINFO[0m[0m 03/20 05:39:52 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 03/20 05:39:52 | Batch sizes for each domain: [20, 0, 0, 0] (total=20)
[37m[36mINFO[0m[0m 03/20 05:39:52 | steps-per-epoch for each domain: 189.65 -> min = 189.65
[37m[36mINFO[0m[0m 03/20 05:39:53 | # of params = 23528522
[37m[36mINFO[0m[0m 03/20 05:42:27 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/20 05:42:27 | 0.306149    0.294199    0.392038    0.358650    1.771227    0.392038    0.358650    0.443574    0.422702    0.188917    0.177582    0.285957    0.282313    0           0.000000    2.890041    0.977867    153.439486 
[37m[36mINFO[0m[0m 03/20 05:45:29 | 0.144115    0.150257    0.594780    0.608650    1.061361    0.594780    0.608650    0.050071    0.053416    0.142632    0.147355    0.239643    0.250000    200         1.054574    1.158061    0.160395    150.051323 
[37m[36mINFO[0m[0m 03/20 05:48:25 | 0.138963    0.145592    0.629054    0.657173    1.029557    0.629054    0.657173    0.058031    0.064201    0.120277    0.123426    0.238581    0.249150    400         2.109148    1.097332    0.147301    145.850761 
[37m[36mINFO[0m[0m 03/20 05:51:24 | 0.191719    0.198972    0.643818    0.657173    0.954953    0.643818    0.657173    0.279497    0.298408    0.102330    0.096977    0.193329    0.201531    600         3.163723    1.016105    0.148321    149.650550 
[37m[36mINFO[0m[0m 03/20 05:54:26 | 0.133239    0.139484    0.662009    0.697257    0.919660    0.662009    0.697257    0.038002    0.039548    0.121222    0.127204    0.240493    0.251701    800         4.218297    0.954080    0.167749    148.635050 
[37m[36mINFO[0m[0m 03/20 05:57:29 | 0.178274    0.177896    0.730820    0.735232    0.787076    0.730820    0.735232    0.237771    0.224448    0.119018    0.122166    0.178033    0.187075    1000        5.272871    0.870965    0.146336    153.166139 
[37m[36mINFO[0m[0m 03/20 06:00:30 | 0.163405    0.159452    0.766412    0.762658    0.725264    0.766412    0.762658    0.135704    0.131484    0.128463    0.138539    0.226046    0.208333    1200        6.327445    0.766035    0.151768    151.377079 
[37m[36mINFO[0m[0m 03/20 06:03:30 | 0.196245    0.192944    0.804640    0.800633    0.564543    0.804640    0.800633    0.187701    0.192090    0.146096    0.146096    0.254939    0.240646    1400        7.382020    0.698636    0.164926    147.036118 
[37m[36mINFO[0m[0m 03/20 06:06:30 | 0.197125    0.196630    0.835486    0.830169    0.502355    0.835486    0.830169    0.137116    0.139702    0.189547    0.205290    0.264712    0.244898    1600        8.436594    0.567221    0.143609    151.149047 
[37m[36mINFO[0m[0m 03/20 06:09:28 | 0.146684    0.144073    0.822832    0.815401    0.553658    0.822832    0.815401    0.077417    0.079610    0.124055    0.122166    0.238581    0.230442    1800        9.491168    0.543979    0.163783    144.764703 
[37m[36mINFO[0m[0m 03/20 06:12:30 | 0.174895    0.175894    0.842341    0.836498    0.477250    0.842341    0.836498    0.067274    0.065742    0.183564    0.183879    0.273847    0.278061    2000        10.545742   0.440153    0.152384    151.593008 
[37m[36mINFO[0m[0m 03/20 06:15:33 | 0.200394    0.200478    0.868706    0.839662    0.436155    0.868706    0.839662    0.152009    0.158192    0.144521    0.149874    0.304653    0.293367    2200        11.600316   0.470128    0.147236    154.177708 
[37m[36mINFO[0m[0m 03/20 06:18:41 | 0.182739    0.184573    0.875297    0.860759    0.388301    0.875297    0.860759    0.140711    0.138161    0.155542    0.153652    0.251965    0.261905    2400        12.654891   0.405256    0.166786    154.223794 
[37m[36mINFO[0m[0m 03/20 06:21:43 | 0.231658    0.225268    0.868178    0.851266    0.417070    0.868178    0.851266    0.117345    0.114535    0.212217    0.196474    0.365413    0.364796    2600        13.709465   0.392185    0.143740    153.459982 
[37m[36mINFO[0m[0m 03/20 06:24:39 | 0.247772    0.248451    0.889006    0.866034    0.354331    0.889006    0.866034    0.206445    0.208526    0.209698    0.212846    0.327172    0.323980    2800        14.764039   0.357282    0.155055    144.683476 
[37m[36mINFO[0m[0m 03/20 06:27:37 | 0.255869    0.244760    0.877142    0.861814    0.378119    0.877142    0.861814    0.235075    0.225989    0.225756    0.216625    0.306777    0.291667    3000        15.818613   0.319688    0.149411    148.349935 
[37m[36mINFO[0m[0m 03/20 06:30:35 | 0.276002    0.269872    0.852887    0.847046    0.455367    0.852887    0.847046    0.329182    0.327170    0.184824    0.176322    0.314000    0.306122    3200        16.873187   0.326963    0.144456    148.874386 
[37m[36mINFO[0m[0m 03/20 06:33:36 | 0.256377    0.252718    0.907988    0.861814    0.336206    0.907988    0.861814    0.267942    0.263996    0.199937    0.191436    0.301253    0.302721    3400        17.927762   0.307953    0.165419    148.461370 
[37m[36mINFO[0m[0m 03/20 06:36:39 | 0.229064    0.230164    0.897179    0.871308    0.353604    0.897179    0.871308    0.195404    0.193118    0.178212    0.172544    0.313576    0.324830    3600        18.982336   0.279909    0.148440    153.191820 
[37m[36mINFO[0m[0m 03/20 06:39:39 | 0.237519    0.235708    0.912734    0.880802    0.311668    0.912734    0.880802    0.194120    0.183873    0.214421    0.210327    0.304015    0.312925    3800        20.036910   0.282489    0.148177    149.507588 
[37m[36mINFO[0m[0m 03/20 06:42:40 | 0.238425    0.238972    0.925125    0.892405    0.297050    0.925125    0.892405    0.196431    0.192090    0.215680    0.220403    0.303165    0.304422    4000        21.091484   0.299747    0.176080    146.492825 
[37m[36mINFO[0m[0m 03/20 06:45:40 | 0.268800    0.261825    0.906143    0.863924    0.361622    0.906143    0.863924    0.266016    0.258346    0.217884    0.206549    0.322498    0.320578    4200        22.146059   0.230044    0.150467    149.479125 
[37m[36mINFO[0m[0m 03/20 06:48:39 | 0.269814    0.273020    0.920907    0.881857    0.313579    0.920907    0.881857    0.247529    0.254751    0.264484    0.258186    0.297429    0.306122    4400        23.200633   0.239318    0.143000    150.309498 
[37m[36mINFO[0m[0m 03/20 06:51:42 | 0.262324    0.252690    0.918007    0.877637    0.322588    0.918007    0.877637    0.295417    0.276323    0.206234    0.197733    0.285320    0.284014    4600        24.255207   0.258247    0.174503    148.887789 
[37m[36mINFO[0m[0m 03/20 06:54:39 | 0.307392    0.300522    0.934616    0.916667    0.246775    0.934616    0.916667    0.330723    0.316384    0.289987    0.288413    0.301466    0.296769    4800        25.309781   0.199468    0.153709    145.861684 
[37m[36mINFO[0m[0m 03/20 06:57:33 | 0.265141    0.269817    0.924334    0.897679    0.297655    0.924334    0.897679    0.311465    0.302517    0.219458    0.222922    0.264500    0.284014    5000        26.364355   0.203644    0.142760    145.193828 
[37m[36mINFO[0m[0m 03/20 06:57:33 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[1, 2, 3]/250320_05-39-52_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/20 06:57:34 | ---
[37m[36mINFO[0m[0m 03/20 06:57:34 | test-domain validation(oracle) = 30.739%
[37m[36mINFO[0m[0m 03/20 06:57:34 | training-domain validation(iid) = 30.739%
[37m[36mINFO[0m[0m 03/20 06:57:34 | last = 26.514%
[37m[36mINFO[0m[0m 03/20 06:57:34 | last (inD) = 89.768%
[37m[36mINFO[0m[0m 03/20 06:57:34 | training-domain validation (iid, inD) = 91.667%
[37m[36mINFO[0m[0m 03/20 06:57:34 | === Summary ===
[37m[36mINFO[0m[0m 03/20 06:57:34 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 2 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 7
[37m[36mINFO[0m[0m 03/20 06:57:34 | Unique name: 250320_05-39-52_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/20 06:57:34 | Out path: train_output/TerraIncognita/ERM/[1, 2, 3]/250320_05-39-52_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/20 06:57:34 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/20 06:57:34 | Dataset: TerraIncognita

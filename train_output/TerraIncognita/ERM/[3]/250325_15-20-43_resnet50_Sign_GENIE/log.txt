[37m[36mINFO[0m[0m 03/25 15:20:43 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 19
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 19
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250325_15-20-43_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250325_15-20-43_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 3.7692486045276154e-05
	batch_size: 10
	weight_decay: 0.0003178970604685295
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/25 15:20:43 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 15:20:43 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 15:20:43 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 15:20:43 | 
[37m[36mINFO[0m[0m 03/25 15:20:43 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/25 15:20:43 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/25 15:20:43 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/25 15:20:43 | Batch sizes for each domain: [10, 10, 10, 0] (total=30)
[37m[36mINFO[0m[0m 03/25 15:20:43 | steps-per-epoch for each domain: 379.30, 778.90, 317.60 -> min = 317.60
[37m[36mINFO[0m[0m 03/25 15:20:45 | # of params = 23528522
[37m[36mINFO[0m[0m 03/25 15:23:48 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 15:23:48 | 0.217336    0.229592    0.286078    0.283001    2.029442    0.208015    0.179325    0.461933    0.455573    0.188287    0.214106    0.217336    0.229592    0           0.000000    2.494153    0.987955    182.793957 
[37m[36mINFO[0m[0m 03/25 15:27:10 | 0.222860    0.233844    0.419119    0.408417    1.397310    0.341155    0.283755    0.563872    0.562404    0.352330    0.379093    0.222860    0.233844    200         0.629723    1.493140    0.166936    168.323923 
[37m[36mINFO[0m[0m 03/25 15:30:35 | 0.277034    0.287415    0.590473    0.598447    1.110493    0.723174    0.731013    0.616254    0.623523    0.431990    0.440806    0.277034    0.287415    400         1.259446    1.250484    0.196905    165.223956 
[37m[36mINFO[0m[0m 03/25 15:33:54 | 0.291693    0.298469    0.652271    0.657566    0.960489    0.789612    0.782700    0.669406    0.674884    0.497796    0.515113    0.291693    0.298469    600         1.889169    1.069895    0.146853    169.958541 
[37m[36mINFO[0m[0m 03/25 15:37:12 | 0.306777    0.300170    0.712550    0.732609    0.791166    0.800422    0.814346    0.712543    0.715973    0.624685    0.667506    0.306777    0.300170    800         2.518892    0.970423    0.167475    164.903367 
[37m[36mINFO[0m[0m 03/25 15:40:31 | 0.309751    0.324830    0.738232    0.743180    0.711642    0.833641    0.803797    0.755424    0.765794    0.625630    0.659950    0.309751    0.324830    1000        3.148615    0.806257    0.166053    164.997604 
[37m[36mINFO[0m[0m 03/25 15:43:51 | 0.309327    0.322279    0.734412    0.746673    0.745623    0.833641    0.839662    0.732315    0.755521    0.637280    0.644836    0.309327    0.322279    1200        3.778338    0.719894    0.145375    171.051112 
[37m[36mINFO[0m[0m 03/25 15:47:12 | 0.294668    0.297619    0.765497    0.768478    0.643615    0.839705    0.810127    0.770702    0.781202    0.686083    0.714106    0.294668    0.297619    1400        4.408060    0.732253    0.139347    173.467957 
[37m[36mINFO[0m[0m 03/25 15:50:30 | 0.359890    0.365646    0.769103    0.776515    0.615351    0.869496    0.868143    0.769675    0.786338    0.668136    0.675063    0.359890    0.365646    1600        5.037783    0.645108    0.153371    167.597021 
[37m[36mINFO[0m[0m 03/25 15:53:50 | 0.360952    0.369898    0.777567    0.780650    0.602423    0.872924    0.866034    0.779047    0.794556    0.680730    0.681360    0.360952    0.369898    1800        5.667506    0.637387    0.166111    166.811331 
[37m[36mINFO[0m[0m 03/25 15:57:14 | 0.318887    0.330782    0.780873    0.788799    0.627072    0.864751    0.856540    0.770060    0.778120    0.707809    0.731738    0.318887    0.330782    2000        6.297229    0.614346    0.143469    174.528189 
[37m[36mINFO[0m[0m 03/25 16:00:25 | 0.369875    0.375850    0.815445    0.824631    0.515060    0.891642    0.871308    0.793041    0.819209    0.761650    0.783375    0.369875    0.375850    2200        6.926952    0.588043    0.133406    164.811033 
[37m[36mINFO[0m[0m 03/25 16:03:54 | 0.334396    0.314626    0.740951    0.750214    0.674077    0.791722    0.790084    0.746309    0.781715    0.684824    0.678841    0.334396    0.314626    2400        7.556675    0.558319    0.158827    177.564700 
[37m[36mINFO[0m[0m 03/25 16:07:11 | 0.361164    0.353741    0.793191    0.795581    0.592702    0.855260    0.831224    0.791629    0.821263    0.732683    0.734257    0.361164    0.353741    2600        8.186398    0.560698    0.139081    169.111297 
[37m[36mINFO[0m[0m 03/25 16:10:42 | 0.279371    0.303571    0.810181    0.806533    0.533435    0.880569    0.878692    0.799974    0.807910    0.750000    0.732997    0.279371    0.303571    2800        8.816121    0.567643    0.163908    177.645898 
[37m[36mINFO[0m[0m 03/25 16:14:01 | 0.304228    0.315476    0.827990    0.822160    0.501046    0.880569    0.878692    0.817820    0.809450    0.785579    0.778338    0.304228    0.315476    3000        9.445844    0.530046    0.168570    165.626817 
[37m[36mINFO[0m[0m 03/25 16:17:30 | 0.376461    0.380952    0.819277    0.812554    0.508163    0.904825    0.892405    0.787264    0.771957    0.765743    0.773300    0.376461    0.380952    3200        10.075567   0.478538    0.157292    177.197396 
[37m[36mINFO[0m[0m 03/25 16:20:46 | 0.331209    0.335034    0.832496    0.824286    0.470030    0.899552    0.885021    0.812043    0.812018    0.785894    0.775819    0.331209    0.335034    3400        10.705290   0.477046    0.136159    169.169002 
[37m[36mINFO[0m[0m 03/25 16:24:09 | 0.361802    0.361395    0.841937    0.841003    0.465675    0.904034    0.886076    0.830530    0.837185    0.791247    0.799748    0.361802    0.361395    3600        11.335013   0.439721    0.167140    168.958982 
[37m[36mINFO[0m[0m 03/25 16:27:32 | 0.389845    0.412415    0.831535    0.837909    0.445632    0.899025    0.889241    0.823854    0.844890    0.771725    0.779597    0.389845    0.412415    3800        11.964736   0.463837    0.153058    172.811715 
[37m[36mINFO[0m[0m 03/25 16:30:55 | 0.367750    0.383503    0.849994    0.856613    0.418090    0.906670    0.904008    0.827192    0.859784    0.816121    0.806045    0.367750    0.383503    4000        12.594458   0.467264    0.162201    170.580400 
[37m[36mINFO[0m[0m 03/25 16:34:06 | 0.378160    0.386054    0.841720    0.837002    0.454622    0.910361    0.887131    0.824496    0.839240    0.790302    0.784635    0.378160    0.386054    4200        13.224181   0.433656    0.140545    162.375506 
[37m[36mINFO[0m[0m 03/25 16:37:26 | 0.316975    0.317177    0.856140    0.850614    0.427678    0.913525    0.889241    0.843497    0.848998    0.811398    0.813602    0.316975    0.317177    4400        13.853904   0.421163    0.188981    162.905432 
[37m[36mINFO[0m[0m 03/25 16:40:48 | 0.362439    0.358844    0.848050    0.847504    0.447277    0.925125    0.916667    0.831557    0.850026    0.787469    0.775819    0.362439    0.358844    4600        14.483627   0.412244    0.125515    176.930175 
[37m[36mINFO[0m[0m 03/25 16:44:12 | 0.391757    0.401361    0.862400    0.854439    0.390998    0.932507    0.915612    0.839517    0.834104    0.815176    0.813602    0.391757    0.401361    4800        15.113350   0.409001    0.167665    170.580657 
[37m[36mINFO[0m[0m 03/25 16:47:30 | 0.370724    0.375850    0.865286    0.847612    0.419845    0.926443    0.899789    0.845423    0.840781    0.823992    0.802267    0.370724    0.375850    5000        15.743073   0.386052    0.141346    169.321719 
[37m[36mINFO[0m[0m 03/25 16:47:30 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250325_15-20-43_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 16:47:32 | ---
[37m[36mINFO[0m[0m 03/25 16:47:32 | test-domain validation(oracle) = 38.984%
[37m[36mINFO[0m[0m 03/25 16:47:32 | training-domain validation(iid) = 36.775%
[37m[36mINFO[0m[0m 03/25 16:47:32 | last = 37.072%
[37m[36mINFO[0m[0m 03/25 16:47:32 | last (inD) = 84.761%
[37m[36mINFO[0m[0m 03/25 16:47:32 | training-domain validation (iid, inD) = 85.661%
[37m[36mINFO[0m[0m 03/25 16:47:32 | === Summary ===
[37m[36mINFO[0m[0m 03/25 16:47:32 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 19
[37m[36mINFO[0m[0m 03/25 16:47:32 | Unique name: 250325_15-20-43_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 16:47:32 | Out path: train_output/TerraIncognita/ERM/[3]/250325_15-20-43_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 16:47:32 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 16:47:32 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 03/25 06:54:32 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 13
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 13
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250325_06-54-32_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250325_06-54-32_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 6.984990754803203e-05
	batch_size: 13
	weight_decay: 2.888048423418205e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/25 06:54:32 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 06:54:32 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 06:54:32 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 06:54:32 | 
[37m[36mINFO[0m[0m 03/25 06:54:32 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/25 06:54:32 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/25 06:54:32 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/25 06:54:32 | Batch sizes for each domain: [13, 13, 13, 0] (total=39)
[37m[36mINFO[0m[0m 03/25 06:54:32 | steps-per-epoch for each domain: 291.77, 599.15, 244.31 -> min = 244.31
[37m[36mINFO[0m[0m 03/25 06:54:33 | # of params = 23528522
[37m[36mINFO[0m[0m 03/25 06:57:48 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 06:57:48 | 0.215636    0.231293    0.343802    0.296164    2.022731    0.381756    0.216245    0.461677    0.458141    0.187972    0.214106    0.215636    0.231293    0           0.000000    2.426247    1.015730    193.852295 
[37m[36mINFO[0m[0m 03/25 07:01:46 | 0.195878    0.190476    0.539917    0.545693    1.137186    0.641708    0.652954    0.616896    0.605033    0.361146    0.379093    0.195878    0.190476    200         0.818640    1.357679    0.171446    203.791467 
[37m[36mINFO[0m[0m 03/25 07:05:38 | 0.255577    0.253401    0.647403    0.625417    0.945645    0.688901    0.654008    0.693799    0.688238    0.559509    0.534005    0.255577    0.253401    400         1.637280    1.027879    0.170735    197.673326 
[37m[36mINFO[0m[0m 03/25 07:09:30 | 0.282133    0.289966    0.695981    0.681483    0.855558    0.757712    0.717300    0.738606    0.733950    0.591625    0.593199    0.282133    0.289966    600         2.455919    0.899440    0.174010    196.893287 
[37m[36mINFO[0m[0m 03/25 07:13:24 | 0.314638    0.318878    0.759887    0.755715    0.674517    0.856051    0.836498    0.757992    0.771957    0.665617    0.658690    0.314638    0.318878    800         3.274559    0.765529    0.204266    193.092267 
[37m[36mINFO[0m[0m 03/25 07:17:13 | 0.265987    0.266156    0.785902    0.789837    0.594997    0.858687    0.850211    0.792785    0.797637    0.706234    0.721662    0.265987    0.266156    1000        4.093199    0.653176    0.154273    198.186050 
[37m[36mINFO[0m[0m 03/25 07:21:01 | 0.345231    0.375000    0.796635    0.801601    0.554663    0.878724    0.879747    0.776608    0.769389    0.734572    0.755668    0.345231    0.375000    1200        4.911839    0.611968    0.158092    196.361217 
[37m[36mINFO[0m[0m 03/25 07:24:58 | 0.285320    0.293367    0.793335    0.791009    0.572517    0.875824    0.854430    0.759533    0.747817    0.744647    0.770781    0.285320    0.293367    1400        5.730479    0.564072    0.197942    197.810171 
[37m[36mINFO[0m[0m 03/25 07:28:49 | 0.274060    0.296769    0.825006    0.827432    0.477268    0.884260    0.876582    0.815252    0.824859    0.775504    0.780856    0.274060    0.296769    1600        6.549118    0.527028    0.145858    201.798592 
[37m[36mINFO[0m[0m 03/25 07:32:34 | 0.357340    0.354592    0.806416    0.815520    0.515772    0.884260    0.881857    0.796636    0.814073    0.738350    0.750630    0.357340    0.354592    1800        7.367758    0.521312    0.153171    193.709006 
[37m[36mINFO[0m[0m 03/25 07:36:21 | 0.305290    0.321429    0.836975    0.840700    0.432677    0.909570    0.900844    0.812941    0.834104    0.788413    0.787154    0.305290    0.321429    2000        8.186398    0.468027    0.185091    190.694147 
[37m[36mINFO[0m[0m 03/25 07:40:19 | 0.328235    0.314626    0.829993    0.830535    0.479944    0.886897    0.889241    0.827577    0.834104    0.775504    0.768262    0.328235    0.314626    2200        9.005038    0.455731    0.202159    197.353399 
[37m[36mINFO[0m[0m 03/25 07:44:15 | 0.389632    0.403912    0.850614    0.860470    0.411219    0.911943    0.909283    0.842984    0.859784    0.796914    0.812343    0.389632    0.403912    2400        9.823678    0.453500    0.168745    202.496581 
[37m[36mINFO[0m[0m 03/25 07:47:56 | 0.348630    0.363095    0.856145    0.838497    0.452344    0.916161    0.878692    0.844653    0.843349    0.807620    0.793451    0.348630    0.363095    2600        10.642317   0.447964    0.153916    189.806731 
[37m[36mINFO[0m[0m 03/25 07:52:11 | 0.363926    0.380102    0.858107    0.857514    0.409921    0.917480    0.912447    0.843240    0.862866    0.813602    0.797229    0.363926    0.380102    2800        11.460957   0.446986    0.219524    210.953383 
[37m[36mINFO[0m[0m 03/25 07:55:58 | 0.306990    0.331633    0.843182    0.843032    0.445566    0.889797    0.885021    0.831814    0.841808    0.807935    0.802267    0.306990    0.331633    3000        12.279597   0.424355    0.145513    198.512481 
[37m[36mINFO[0m[0m 03/25 07:59:54 | 0.366688    0.360544    0.850021    0.842267    0.438983    0.897706    0.889241    0.849146    0.856703    0.803212    0.780856    0.366688    0.360544    3200        13.098237   0.393038    0.170941    201.130539 
[37m[36mINFO[0m[0m 03/25 08:03:50 | 0.371362    0.378401    0.858712    0.865984    0.403122    0.919325    0.905063    0.835024    0.865434    0.821788    0.827456    0.371362    0.378401    3400        13.916877   0.389505    0.194826    197.322710 
[37m[36mINFO[0m[0m 03/25 08:07:38 | 0.342469    0.360544    0.865940    0.855616    0.395286    0.923543    0.906118    0.842727    0.843349    0.831549    0.817380    0.342469    0.360544    3600        14.735516   0.366564    0.151494    197.810856 
[37m[36mINFO[0m[0m 03/25 08:11:26 | 0.306990    0.319728    0.878390    0.876354    0.357521    0.924598    0.913502    0.850687    0.865434    0.859887    0.850126    0.306990    0.319728    3800        15.554156   0.365597    0.170675    193.786203 
[37m[36mINFO[0m[0m 03/25 08:15:21 | 0.301253    0.308673    0.872665    0.861882    0.414365    0.936989    0.922996    0.858904    0.851567    0.822103    0.811083    0.301253    0.308673    4000        16.372796   0.360989    0.155794    203.843864 
[37m[36mINFO[0m[0m 03/25 08:19:24 | 0.380497    0.380952    0.883987    0.869614    0.373729    0.936989    0.922996    0.866735    0.865948    0.848237    0.819899    0.380497    0.380952    4200        17.191436   0.328033    0.215271    199.440662 
[37m[36mINFO[0m[0m 03/25 08:23:19 | 0.301253    0.315476    0.868790    0.859896    0.392942    0.924334    0.918776    0.833483    0.839753    0.848552    0.821159    0.301253    0.315476    4400        18.010076   0.336894    0.166537    202.226716 
[37m[36mINFO[0m[0m 03/25 08:27:07 | 0.316762    0.333333    0.878850    0.865277    0.401543    0.924334    0.902954    0.860829    0.851567    0.851385    0.841310    0.316762    0.333333    4600        18.828715   0.325039    0.154516    196.614698 
[37m[36mINFO[0m[0m 03/25 08:31:07 | 0.333546    0.342687    0.893646    0.871820    0.359525    0.931453    0.904008    0.873540    0.861325    0.875945    0.850126    0.333546    0.342687    4800        19.647355   0.305712    0.219284    196.187171 
[37m[36mINFO[0m[0m 03/25 08:34:58 | 0.322286    0.330782    0.888258    0.870858    0.378222    0.920380    0.879747    0.867505    0.872625    0.876889    0.860202    0.322286    0.330782    5000        20.465995   0.302140    0.153040    200.779509 
[37m[36mINFO[0m[0m 03/25 08:34:58 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250325_06-54-32_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 08:34:59 | ---
[37m[36mINFO[0m[0m 03/25 08:34:59 | test-domain validation(oracle) = 38.963%
[37m[36mINFO[0m[0m 03/25 08:34:59 | training-domain validation(iid) = 30.699%
[37m[36mINFO[0m[0m 03/25 08:34:59 | last = 32.229%
[37m[36mINFO[0m[0m 03/25 08:34:59 | last (inD) = 87.086%
[37m[36mINFO[0m[0m 03/25 08:34:59 | training-domain validation (iid, inD) = 87.635%
[37m[36mINFO[0m[0m 03/25 08:34:59 | === Summary ===
[37m[36mINFO[0m[0m 03/25 08:34:59 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 13
[37m[36mINFO[0m[0m 03/25 08:34:59 | Unique name: 250325_06-54-32_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 08:34:59 | Out path: train_output/TerraIncognita/ERM/[3]/250325_06-54-32_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 08:34:59 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 08:34:59 | Dataset: TerraIncognita

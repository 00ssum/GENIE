[37m[36mINFO[0m[0m 03/25 00:02:54 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 9
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 9
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250325_00-02-54_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250325_00-02-54_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.7532223448653515e-05
	batch_size: 36
	weight_decay: 0.007511403320794324
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/25 00:02:54 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 00:02:54 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 00:02:54 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 00:02:54 | 
[37m[36mINFO[0m[0m 03/25 00:02:54 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/25 00:02:54 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/25 00:02:54 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/25 00:02:54 | Batch sizes for each domain: [36, 36, 36, 0] (total=108)
[37m[36mINFO[0m[0m 03/25 00:02:54 | steps-per-epoch for each domain: 105.36, 216.36, 88.22 -> min = 88.22
[37m[36mINFO[0m[0m 03/25 00:02:55 | # of params = 23528522
[37m[36mINFO[0m[0m 03/25 00:05:49 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 00:05:49 | 0.217336    0.231293    0.304433    0.282650    2.032950    0.263907    0.178270    0.461420    0.455573    0.187972    0.214106    0.217336    0.231293    0           0.000000    2.448111    1.321428    172.387461 
[37m[36mINFO[0m[0m 03/25 00:09:32 | 0.238368    0.235544    0.615312    0.628286    1.013971    0.762721    0.762658    0.627295    0.607088    0.455919    0.515113    0.238368    0.235544    200         2.267003    1.289829    0.304990    162.008436 
[37m[36mINFO[0m[0m 03/25 00:13:32 | 0.280221    0.275510    0.745720    0.739143    0.730308    0.853151    0.827004    0.718706    0.710324    0.665302    0.680101    0.280221    0.275510    400         4.534005    0.917711    0.382504    164.283200 
[37m[36mINFO[0m[0m 03/25 00:17:19 | 0.293393    0.306973    0.784708    0.802099    0.577377    0.869496    0.859705    0.777764    0.802260    0.706864    0.744332    0.293393    0.306973    600         6.801008    0.691720    0.314853    163.929378 
[37m[36mINFO[0m[0m 03/25 00:21:19 | 0.330996    0.340136    0.797359    0.812077    0.541896    0.881360    0.882911    0.795352    0.811505    0.715365    0.741814    0.330996    0.340136    800         9.068010    0.602543    0.352757    168.794462 
[37m[36mINFO[0m[0m 03/25 00:25:25 | 0.334396    0.341837    0.804244    0.809692    0.550393    0.884260    0.879747    0.788548    0.787365    0.739924    0.761965    0.334396    0.341837    1000        11.335013   0.561885    0.339980    178.701610 
[37m[36mINFO[0m[0m 03/25 00:29:10 | 0.326322    0.323980    0.814058    0.817010    0.513032    0.878724    0.876582    0.806522    0.809964    0.756927    0.764484    0.326322    0.323980    1200        13.602015   0.506059    0.272740    169.626544 
[37m[36mINFO[0m[0m 03/25 00:33:24 | 0.345018    0.355442    0.834718    0.836323    0.464134    0.893488    0.893460    0.819104    0.823318    0.791562    0.792191    0.345018    0.355442    1400        15.869018   0.497752    0.331260    188.083120 
[37m[36mINFO[0m[0m 03/25 00:37:19 | 0.359890    0.354592    0.851823    0.840691    0.449731    0.914316    0.887131    0.839517    0.851567    0.801637    0.783375    0.359890    0.354592    1600        18.136020   0.480302    0.283442    178.298853 
[37m[36mINFO[0m[0m 03/25 00:41:19 | 0.357765    0.361395    0.856232    0.851176    0.425699    0.912734    0.889241    0.836693    0.858243    0.819270    0.806045    0.357765    0.361395    1800        20.403023   0.439342    0.299612    180.423026 
[37m[36mINFO[0m[0m 03/25 00:45:19 | 0.359890    0.365646    0.844577    0.850420    0.422919    0.906934    0.898734    0.836179    0.848998    0.790617    0.803526    0.359890    0.365646    2000        22.670025   0.451568    0.305018    179.201435 
[37m[36mINFO[0m[0m 03/25 00:49:21 | 0.325473    0.329082    0.824518    0.819057    0.488552    0.900343    0.876582    0.836436    0.841294    0.736776    0.739295    0.325473    0.329082    2200        24.937028   0.429244    0.304818    181.035141 
[37m[36mINFO[0m[0m 03/25 00:53:28 | 0.326747    0.321429    0.837383    0.832542    0.466765    0.880833    0.870253    0.828733    0.837699    0.802582    0.789673    0.326747    0.321429    2400        27.204030   0.421862    0.341509    178.227557 
[37m[36mINFO[0m[0m 03/25 00:57:29 | 0.319737    0.321429    0.846400    0.840730    0.443231    0.910098    0.881857    0.805110    0.830508    0.823992    0.809824    0.319737    0.321429    2600        29.471033   0.409872    0.313274    178.043301 
[37m[36mINFO[0m[0m 03/25 01:01:59 | 0.333546    0.334184    0.869663    0.862588    0.403750    0.923280    0.892405    0.861086    0.862866    0.824622    0.832494    0.333546    0.334184    2800        31.738035   0.396785    0.346968    201.078716 
[37m[36mINFO[0m[0m 03/25 01:06:18 | 0.351179    0.360544    0.872670    0.868124    0.387190    0.928289    0.900844    0.863525    0.868516    0.826196    0.835013    0.351179    0.360544    3000        34.005038   0.381888    0.345592    189.919193 
[37m[36mINFO[0m[0m 03/25 01:10:37 | 0.341406    0.350340    0.867434    0.856159    0.409003    0.931189    0.911392    0.838619    0.837185    0.832494    0.819899    0.341406    0.350340    3200        36.272040   0.386587    0.344076    189.746188 
[37m[36mINFO[0m[0m 03/25 01:14:44 | 0.348842    0.354592    0.857854    0.862588    0.396352    0.895070    0.904008    0.862370    0.875193    0.816121    0.808564    0.348842    0.354592    3400        38.539043   0.384965    0.329790    181.638130 
[37m[36mINFO[0m[0m 03/25 01:18:42 | 0.325048    0.318027    0.862868    0.859763    0.418171    0.908252    0.899789    0.844396    0.863380    0.835957    0.816121    0.325048    0.318027    3600        40.806045   0.377992    0.340263    169.573248 
[37m[36mINFO[0m[0m 03/25 01:22:49 | 0.310176    0.314626    0.873241    0.871428    0.372369    0.929871    0.915612    0.850430    0.864920    0.839421    0.833753    0.310176    0.314626    3800        43.073048   0.374727    0.338537    179.296142 
[37m[36mINFO[0m[0m 03/25 01:26:58 | 0.294880    0.308673    0.864513    0.863645    0.399080    0.915898    0.900844    0.850815    0.863893    0.826826    0.826196    0.294880    0.308673    4000        45.340050   0.371950    0.344857    180.337808 
[37m[36mINFO[0m[0m 03/25 01:31:13 | 0.322074    0.323129    0.872100    0.873147    0.376523    0.916425    0.906118    0.857620    0.866975    0.842254    0.846348    0.322074    0.323129    4200        47.607053   0.372916    0.346151    185.305103 
[37m[36mINFO[0m[0m 03/25 01:35:20 | 0.299341    0.289966    0.867625    0.860612    0.406285    0.928025    0.900844    0.846450    0.862352    0.828401    0.818640    0.299341    0.289966    4400        49.874055   0.391322    0.345503    177.539030 
[37m[36mINFO[0m[0m 03/25 01:39:50 | 0.321861    0.311224    0.852857    0.854610    0.415697    0.913525    0.902954    0.835537    0.851053    0.809509    0.809824    0.321861    0.311224    4600        52.141058   0.366376    0.386397    193.339226 
[37m[36mINFO[0m[0m 03/25 01:44:18 | 0.339919    0.338435    0.863833    0.847193    0.423063    0.931453    0.909283    0.826293    0.818695    0.833753    0.813602    0.339919    0.338435    4800        54.408060   0.371102    0.359170    195.784416 
[37m[36mINFO[0m[0m 03/25 01:48:41 | 0.366051    0.356293    0.884460    0.873262    0.359621    0.917743    0.902954    0.867249    0.879301    0.868388    0.837531    0.366051    0.356293    5000        56.675063   0.359403    0.385650    185.996923 
[37m[36mINFO[0m[0m 03/25 01:48:41 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250325_00-02-54_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 01:48:42 | ---
[37m[36mINFO[0m[0m 03/25 01:48:42 | test-domain validation(oracle) = 35.989%
[37m[36mINFO[0m[0m 03/25 01:48:42 | training-domain validation(iid) = 36.605%
[37m[36mINFO[0m[0m 03/25 01:48:42 | last = 36.605%
[37m[36mINFO[0m[0m 03/25 01:48:42 | last (inD) = 87.326%
[37m[36mINFO[0m[0m 03/25 01:48:42 | training-domain validation (iid, inD) = 87.326%
[37m[36mINFO[0m[0m 03/25 01:48:42 | === Summary ===
[37m[36mINFO[0m[0m 03/25 01:48:42 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 9
[37m[36mINFO[0m[0m 03/25 01:48:42 | Unique name: 250325_00-02-54_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 01:48:42 | Out path: train_output/TerraIncognita/ERM/[3]/250325_00-02-54_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 01:48:42 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 01:48:42 | Dataset: TerraIncognita

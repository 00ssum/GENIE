[37m[36mINFO[0m[0m 03/26 06:00:24 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 10
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 10
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250326_06-00-24_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250326_06-00-24_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 7.494887873901297e-05
	batch_size: 23
	weight_decay: 0.000495139494108363
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/26 06:00:24 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 06:00:24 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 06:00:24 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 06:00:24 | 
[37m[36mINFO[0m[0m 03/26 06:00:24 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/26 06:00:24 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/26 06:00:24 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/26 06:00:24 | Batch sizes for each domain: [23, 23, 23, 0] (total=69)
[37m[36mINFO[0m[0m 03/26 06:00:24 | steps-per-epoch for each domain: 164.91, 338.65, 138.09 -> min = 138.09
[37m[36mINFO[0m[0m 03/26 06:00:25 | # of params = 23528522
[37m[36mINFO[0m[0m 03/26 06:03:13 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 06:03:13 | 0.222860    0.207483    0.288403    0.273706    2.082638    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.222860    0.207483    0           0.000000    2.438095    1.009066    166.393086 
[37m[36mINFO[0m[0m 03/26 06:06:47 | 0.194179    0.186224    0.552352    0.556978    1.196336    0.711838    0.719409    0.579664    0.559836    0.365554    0.391688    0.194179    0.186224    200         1.448363    1.411004    0.237644    166.607579 
[37m[36mINFO[0m[0m 03/26 06:10:10 | 0.229233    0.210034    0.635159    0.615364    1.026755    0.777748    0.777426    0.603800    0.573703    0.523929    0.494962    0.229233    0.210034    400         2.896725    1.133400    0.185833    165.809316 
[37m[36mINFO[0m[0m 03/26 06:13:33 | 0.287657    0.271259    0.693005    0.672797    0.893033    0.778539    0.737342    0.730261    0.720596    0.570214    0.560453    0.287657    0.271259    600         4.345088    0.895881    0.189675    165.083448 
[37m[36mINFO[0m[0m 03/26 06:16:57 | 0.388995    0.388605    0.778112    0.775576    0.642558    0.864487    0.844937    0.758891    0.746276    0.710957    0.735516    0.388995    0.388605    800         5.793451    0.730211    0.201266    163.960488 
[37m[36mINFO[0m[0m 03/26 06:20:18 | 0.344593    0.330782    0.790290    0.790717    0.605466    0.876878    0.861814    0.776736    0.789933    0.717254    0.720403    0.344593    0.330782    1000        7.241814    0.624774    0.182591    164.595106 
[37m[36mINFO[0m[0m 03/26 06:23:41 | 0.318037    0.301020    0.799783    0.779288    0.569457    0.885051    0.861814    0.808063    0.788392    0.706234    0.687657    0.318037    0.301020    1200        8.690176    0.547346    0.185818    165.877112 
[37m[36mINFO[0m[0m 03/26 06:27:06 | 0.356065    0.353741    0.829111    0.820260    0.487216    0.896388    0.877637    0.818590    0.829995    0.772355    0.753149    0.356065    0.353741    1400        10.138539   0.527959    0.200975    164.595541 
[37m[36mINFO[0m[0m 03/26 06:30:29 | 0.365626    0.341837    0.840451    0.819913    0.482338    0.908779    0.880802    0.826679    0.820750    0.785894    0.758186    0.365626    0.341837    1600        11.586902   0.497144    0.195086    163.833236 
[37m[36mINFO[0m[0m 03/26 06:33:53 | 0.333546    0.330782    0.846582    0.842046    0.444123    0.909570    0.889241    0.831686    0.848485    0.798489    0.788413    0.333546    0.330782    1800        13.035264   0.445730    0.195125    165.530331 
[37m[36mINFO[0m[0m 03/26 06:37:22 | 0.324410    0.297619    0.852621    0.844347    0.450164    0.912734    0.888186    0.836564    0.829995    0.808564    0.814861    0.324410    0.297619    2000        14.483627   0.456207    0.241966    160.622475 
[37m[36mINFO[0m[0m 03/26 06:41:00 | 0.322074    0.313776    0.836201    0.816854    0.501646    0.889533    0.870253    0.840416    0.839753    0.778652    0.740554    0.322074    0.313776    2200        15.931990   0.425394    0.244606    168.338795 
[37m[36mINFO[0m[0m 03/26 06:44:43 | 0.335033    0.310374    0.868102    0.854415    0.410038    0.926707    0.907173    0.855180    0.850026    0.822418    0.806045    0.335033    0.310374    2400        17.380353   0.411418    0.301522    163.361480 
[37m[36mINFO[0m[0m 03/26 06:48:16 | 0.308477    0.307823    0.864751    0.854156    0.426476    0.906407    0.881857    0.850944    0.855675    0.836902    0.824937    0.308477    0.307823    2600        18.828715   0.378193    0.242835    163.950710 
[37m[36mINFO[0m[0m 03/26 06:51:51 | 0.357553    0.341837    0.870755    0.863429    0.388745    0.930134    0.897679    0.851842    0.863893    0.830290    0.828715    0.357553    0.341837    2800        20.277078   0.370253    0.237350    167.162785 
[37m[36mINFO[0m[0m 03/26 06:55:20 | 0.363289    0.350340    0.880125    0.863599    0.386532    0.936989    0.908228    0.860187    0.852594    0.843199    0.829975    0.363289    0.350340    3000        21.725441   0.359488    0.221713    165.164536 
[37m[36mINFO[0m[0m 03/26 06:58:55 | 0.364351    0.347789    0.867984    0.850914    0.415271    0.933298    0.902954    0.860829    0.863893    0.809824    0.785894    0.364351    0.347789    3200        23.173804   0.351128    0.220728    170.720642 
[37m[36mINFO[0m[0m 03/26 07:02:27 | 0.434034    0.419218    0.883046    0.869400    0.371715    0.947799    0.916667    0.865066    0.860298    0.836272    0.831234    0.434034    0.419218    3400        24.622166   0.329217    0.253148    161.006658 
[37m[36mINFO[0m[0m 03/26 07:05:57 | 0.372424    0.369048    0.892005    0.878062    0.350117    0.945953    0.921941    0.865451    0.863380    0.864610    0.848866    0.372424    0.369048    3600        26.070529   0.321089    0.212296    167.549315 
[37m[36mINFO[0m[0m 03/26 07:09:16 | 0.335883    0.328231    0.887672    0.855643    0.398093    0.945162    0.896624    0.856079    0.856703    0.861776    0.813602    0.335883    0.328231    3800        27.518892   0.307040    0.185957    162.445026 
[37m[36mINFO[0m[0m 03/26 07:12:45 | 0.365413    0.345238    0.905366    0.887931    0.315928    0.956762    0.926160    0.884966    0.873652    0.874370    0.863980    0.365413    0.345238    4000        28.967254   0.294341    0.195450    169.868821 
[37m[36mINFO[0m[0m 03/26 07:16:24 | 0.354791    0.352891    0.892533    0.874974    0.364823    0.950171    0.930380    0.882655    0.885978    0.844773    0.808564    0.354791    0.352891    4200        30.415617   0.282841    0.263378    166.364028 
[37m[36mINFO[0m[0m 03/26 07:19:53 | 0.316975    0.302721    0.898795    0.868347    0.380811    0.951490    0.915612    0.867377    0.855675    0.877519    0.833753    0.316975    0.302721    4400        31.863980   0.270833    0.185298    172.099749 
[37m[36mINFO[0m[0m 03/26 07:23:20 | 0.341406    0.328231    0.907989    0.885338    0.340933    0.951226    0.917722    0.891129    0.881870    0.881612    0.856423    0.341406    0.328231    4600        33.312343   0.279314    0.200389    166.194654 
[37m[36mINFO[0m[0m 03/26 07:26:47 | 0.357977    0.347789    0.907599    0.873519    0.356095    0.954917    0.910338    0.893825    0.889060    0.874055    0.821159    0.357977    0.347789    4800        34.760705   0.249623    0.213367    164.420798 
[37m[36mINFO[0m[0m 03/26 07:30:23 | 0.377310    0.366497    0.906440    0.880150    0.353729    0.955972    0.921941    0.887405    0.874679    0.875945    0.843829    0.377310    0.366497    5000        36.209068   0.248080    0.258895    164.808030 
[37m[36mINFO[0m[0m 03/26 07:30:23 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250326_06-00-24_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 07:30:25 | ---
[37m[36mINFO[0m[0m 03/26 07:30:25 | test-domain validation(oracle) = 43.403%
[37m[36mINFO[0m[0m 03/26 07:30:25 | training-domain validation(iid) = 36.541%
[37m[36mINFO[0m[0m 03/26 07:30:25 | last = 37.731%
[37m[36mINFO[0m[0m 03/26 07:30:25 | last (inD) = 88.015%
[37m[36mINFO[0m[0m 03/26 07:30:25 | training-domain validation (iid, inD) = 88.793%
[37m[36mINFO[0m[0m 03/26 07:30:25 | === Summary ===
[37m[36mINFO[0m[0m 03/26 07:30:25 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 10
[37m[36mINFO[0m[0m 03/26 07:30:25 | Unique name: 250326_06-00-24_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 07:30:25 | Out path: train_output/TerraIncognita/ERM/[3]/250326_06-00-24_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 07:30:25 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 07:30:25 | Dataset: TerraIncognita

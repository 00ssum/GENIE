[37m[36mINFO[0m[0m 03/26 07:30:29 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 11
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 11
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250326_07-30-29_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250326_07-30-29_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00030079935666912124
	batch_size: 16
	weight_decay: 6.276702207693199e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/26 07:30:29 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 07:30:29 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 07:30:29 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 07:30:29 | 
[37m[36mINFO[0m[0m 03/26 07:30:29 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/26 07:30:29 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/26 07:30:29 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/26 07:30:29 | Batch sizes for each domain: [16, 16, 16, 0] (total=48)
[37m[36mINFO[0m[0m 03/26 07:30:29 | steps-per-epoch for each domain: 237.06, 486.81, 198.50 -> min = 198.50
[37m[36mINFO[0m[0m 03/26 07:30:30 | # of params = 23528522
[37m[36mINFO[0m[0m 03/26 07:33:16 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 07:33:16 | 0.222860    0.207483    0.288403    0.273706    2.112519    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.222860    0.207483    0           0.000000    2.471108    1.144863    164.819382 
[37m[36mINFO[0m[0m 03/26 07:36:32 | 0.172721    0.147109    0.567092    0.560221    1.189950    0.707092    0.718354    0.591475    0.570621    0.402708    0.391688    0.172721    0.147109    200         1.007557    1.383435    0.147677    165.929524 
[37m[36mINFO[0m[0m 03/26 07:39:52 | 0.312088    0.296769    0.658706    0.671394    0.963929    0.767730    0.781646    0.679420    0.673344    0.528967    0.559194    0.312088    0.296769    400         2.015113    1.119895    0.153483    169.514996 
[37m[36mINFO[0m[0m 03/26 07:43:07 | 0.288082    0.270408    0.739175    0.721236    0.780561    0.827313    0.797468    0.746951    0.736518    0.643262    0.629723    0.288082    0.270408    600         3.022670    0.800082    0.148458    165.717467 
[37m[36mINFO[0m[0m 03/26 07:46:36 | 0.293393    0.281463    0.760066    0.756253    0.666455    0.875560    0.856540    0.773655    0.769902    0.630982    0.642317    0.293393    0.281463    800         4.030227    0.700140    0.228652    163.195669 
[37m[36mINFO[0m[0m 03/26 07:49:52 | 0.417251    0.427721    0.772197    0.765132    0.643622    0.851832    0.845992    0.779304    0.778120    0.685453    0.671285    0.417251    0.427721    1000        5.037783    0.657560    0.144841    167.270924 
[37m[36mINFO[0m[0m 03/26 07:53:09 | 0.422775    0.416667    0.787399    0.775439    0.617015    0.858951    0.836498    0.786622    0.797124    0.716625    0.692695    0.422775    0.416667    1200        6.045340    0.593902    0.142069    168.386625 
[37m[36mINFO[0m[0m 03/26 07:56:28 | 0.393669    0.388605    0.820768    0.814186    0.518096    0.893488    0.876582    0.810630    0.827940    0.758186    0.738035    0.393669    0.388605    1400        7.052897    0.555669    0.160068    167.318396 
[37m[36mINFO[0m[0m 03/26 07:59:50 | 0.412152    0.408163    0.820185    0.825833    0.483453    0.890061    0.878692    0.809475    0.819209    0.761020    0.779597    0.412152    0.408163    1600        8.060453    0.514814    0.181766    165.519312 
[37m[36mINFO[0m[0m 03/26 08:03:21 | 0.380710    0.373299    0.840118    0.814558    0.503403    0.911416    0.870253    0.830915    0.808937    0.778023    0.764484    0.380710    0.373299    1800        9.068010    0.496600    0.201947    170.438396 
[37m[36mINFO[0m[0m 03/26 08:06:44 | 0.326110    0.307823    0.826652    0.821247    0.492799    0.888742    0.870253    0.819489    0.817668    0.771725    0.775819    0.326110    0.307823    2000        10.075567   0.479033    0.195293    163.677987 
[37m[36mINFO[0m[0m 03/26 08:10:02 | 0.330147    0.321429    0.842139    0.830732    0.473125    0.901397    0.890295    0.845423    0.836158    0.779597    0.765743    0.330147    0.321429    2200        11.083123   0.457128    0.175440    162.608076 
[37m[36mINFO[0m[0m 03/26 08:13:26 | 0.370724    0.362245    0.846118    0.837728    0.445008    0.893752    0.879747    0.835409    0.838726    0.809194    0.794710    0.370724    0.362245    2400        12.090680   0.437546    0.167990    170.851928 
[37m[36mINFO[0m[0m 03/26 08:16:46 | 0.350542    0.352891    0.853696    0.839330    0.438778    0.916952    0.892405    0.833997    0.823318    0.810139    0.802267    0.350542    0.352891    2600        13.098237   0.404846    0.182921    163.158388 
[37m[36mINFO[0m[0m 03/26 08:20:13 | 0.365201    0.347789    0.868510    0.848488    0.415423    0.916689    0.891350    0.856978    0.853107    0.831864    0.801008    0.365201    0.347789    2800        14.105793   0.376407    0.205889    165.990954 
[37m[36mINFO[0m[0m 03/26 08:23:28 | 0.316550    0.310374    0.864917    0.858390    0.403542    0.930398    0.908228    0.857363    0.852080    0.806990    0.814861    0.316550    0.310374    3000        15.113350   0.378009    0.167523    161.415700 
[37m[36mINFO[0m[0m 03/26 08:26:42 | 0.356490    0.345238    0.882704    0.861023    0.391283    0.937253    0.912447    0.859160    0.846944    0.851700    0.823678    0.356490    0.345238    3200        16.120907   0.357080    0.156264    162.427860 
[37m[36mINFO[0m[0m 03/26 08:30:10 | 0.336308    0.322279    0.878656    0.859606    0.396521    0.942262    0.913502    0.857748    0.859271    0.835957    0.806045    0.336308    0.322279    3400        17.128463   0.350878    0.182851    171.676768 
[37m[36mINFO[0m[0m 03/26 08:33:27 | 0.277247    0.253401    0.881712    0.859282    0.404190    0.929080    0.899789    0.867505    0.866975    0.848552    0.811083    0.277247    0.253401    3600        18.136020   0.332301    0.143782    168.218834 
[37m[36mINFO[0m[0m 03/26 08:36:48 | 0.383684    0.386905    0.863055    0.842290    0.429392    0.920643    0.889241    0.838233    0.834104    0.830290    0.803526    0.383684    0.386905    3800        19.143577   0.337850    0.179544    164.863421 
[37m[36mINFO[0m[0m 03/26 08:40:08 | 0.320586    0.320578    0.883401    0.857336    0.395681    0.940153    0.910338    0.852998    0.853107    0.857053    0.808564    0.320586    0.320578    4000        20.151134   0.338068    0.172697    166.166677 
[37m[36mINFO[0m[0m 03/26 08:43:25 | 0.324623    0.313776    0.874345    0.849408    0.418596    0.917480    0.889241    0.874952    0.870570    0.830605    0.788413    0.324623    0.313776    4200        21.158690   0.299507    0.172568    162.454953 
[37m[36mINFO[0m[0m 03/26 08:46:45 | 0.354791    0.345238    0.886149    0.867296    0.379573    0.938571    0.912447    0.872898    0.869543    0.846977    0.819899    0.354791    0.345238    4400        22.166247   0.289480    0.165790    166.526061 
[37m[36mINFO[0m[0m 03/26 08:50:09 | 0.332908    0.329932    0.886433    0.868843    0.372340    0.944108    0.918776    0.865066    0.860298    0.850126    0.827456    0.332908    0.329932    4600        23.173804   0.291727    0.210954    161.363011 
[37m[36mINFO[0m[0m 03/26 08:53:21 | 0.370937    0.363946    0.905707    0.876971    0.341602    0.955444    0.922996    0.882270    0.874165    0.879408    0.833753    0.370937    0.363946    4800        24.181360   0.281353    0.159311    160.158556 
[37m[36mINFO[0m[0m 03/26 08:56:40 | 0.305078    0.306973    0.897086    0.872456    0.351168    0.953862    0.915612    0.880344    0.868002    0.857053    0.833753    0.305078    0.306973    5000        25.188917   0.271427    0.175797    163.787262 
[37m[36mINFO[0m[0m 03/26 08:56:40 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250326_07-30-29_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 08:56:41 | ---
[37m[36mINFO[0m[0m 03/26 08:56:41 | test-domain validation(oracle) = 41.725%
[37m[36mINFO[0m[0m 03/26 08:56:41 | training-domain validation(iid) = 37.094%
[37m[36mINFO[0m[0m 03/26 08:56:41 | last = 30.508%
[37m[36mINFO[0m[0m 03/26 08:56:41 | last (inD) = 87.246%
[37m[36mINFO[0m[0m 03/26 08:56:41 | training-domain validation (iid, inD) = 87.697%
[37m[36mINFO[0m[0m 03/26 08:56:41 | === Summary ===
[37m[36mINFO[0m[0m 03/26 08:56:41 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 11
[37m[36mINFO[0m[0m 03/26 08:56:41 | Unique name: 250326_07-30-29_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 08:56:41 | Out path: train_output/TerraIncognita/ERM/[3]/250326_07-30-29_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 08:56:41 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 08:56:41 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 03/25 18:16:25 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 2
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 2
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250325_18-16-25_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250325_18-16-25_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 7.73819221686661e-05
	batch_size: 10
	weight_decay: 8.231814847964724e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/25 18:16:25 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 18:16:25 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 18:16:25 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 18:16:25 | 
[37m[36mINFO[0m[0m 03/25 18:16:25 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/25 18:16:25 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/25 18:16:25 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/25 18:16:25 | Batch sizes for each domain: [10, 10, 10, 0] (total=30)
[37m[36mINFO[0m[0m 03/25 18:16:25 | steps-per-epoch for each domain: 379.30, 778.90, 317.60 -> min = 317.60
[37m[36mINFO[0m[0m 03/25 18:16:26 | # of params = 23528522
[37m[36mINFO[0m[0m 03/25 18:19:20 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 18:19:20 | 0.222860    0.207483    0.288403    0.273706    2.161020    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.222860    0.207483    0           0.000000    2.389971    1.046252    173.484627 
[37m[36mINFO[0m[0m 03/25 18:22:46 | 0.252815    0.230442    0.490718    0.526581    1.295722    0.554179    0.681435    0.577609    0.569594    0.340365    0.328715    0.252815    0.230442    200         0.629723    1.517951    0.150049    175.560331 
[37m[36mINFO[0m[0m 03/25 18:26:10 | 0.268961    0.259354    0.570640    0.574445    1.148639    0.703665    0.732068    0.629477    0.609656    0.378778    0.381612    0.268961    0.259354    400         1.259446    1.245077    0.130193    177.828662 
[37m[36mINFO[0m[0m 03/25 18:29:32 | 0.276822    0.262755    0.631935    0.625175    1.032852    0.722383    0.715190    0.688535    0.677966    0.484887    0.482368    0.276822    0.262755    600         1.889169    1.139341    0.142524    173.429414 
[37m[36mINFO[0m[0m 03/25 18:33:04 | 0.295092    0.295918    0.730562    0.718009    0.791854    0.821777    0.811181    0.732315    0.711864    0.637594    0.630982    0.295092    0.295918    800         2.518892    0.912421    0.178622    176.716738 
[37m[36mINFO[0m[0m 03/25 18:36:24 | 0.304440    0.295918    0.751752    0.755550    0.707884    0.854469    0.839662    0.743356    0.751926    0.657431    0.675063    0.304440    0.295918    1000        3.148615    0.784398    0.149430    170.269515 
[37m[36mINFO[0m[0m 03/25 18:39:43 | 0.355641    0.354592    0.732075    0.736996    0.730534    0.835223    0.828059    0.734112    0.726759    0.626889    0.656171    0.355641    0.354592    1200        3.778338    0.754904    0.164147    165.566682 
[37m[36mINFO[0m[0m 03/25 18:43:05 | 0.355853    0.351190    0.780034    0.770177    0.624427    0.854469    0.817511    0.780973    0.780175    0.704660    0.712846    0.355853    0.351190    1400        4.408060    0.677973    0.167343    169.303357 
[37m[36mINFO[0m[0m 03/25 18:46:46 | 0.390057    0.392857    0.793224    0.782734    0.596869    0.869760    0.843882    0.792656    0.791474    0.717254    0.712846    0.390057    0.392857    1600        5.037783    0.645161    0.219625    177.040739 
[37m[36mINFO[0m[0m 03/25 18:50:03 | 0.402167    0.401361    0.791825    0.782991    0.606964    0.863696    0.849156    0.781615    0.766821    0.730164    0.732997    0.402167    0.401361    1800        5.667506    0.646141    0.140867    168.556175 
[37m[36mINFO[0m[0m 03/25 18:53:24 | 0.338645    0.338435    0.799276    0.793636    0.592959    0.875560    0.866034    0.799974    0.803287    0.722292    0.711587    0.338645    0.338435    2000        6.297229    0.591578    0.146826    171.404667 
[37m[36mINFO[0m[0m 03/25 18:56:37 | 0.367113    0.361395    0.809609    0.787346    0.592170    0.882151    0.822785    0.802029    0.787365    0.744647    0.751889    0.367113    0.361395    2200        6.926952    0.570434    0.137887    165.950912 
[37m[36mINFO[0m[0m 03/25 18:59:58 | 0.309751    0.291667    0.802164    0.793946    0.554822    0.886633    0.866034    0.805752    0.799178    0.714106    0.716625    0.309751    0.291667    2400        7.556675    0.547221    0.185352    163.478622 
[37m[36mINFO[0m[0m 03/25 19:03:16 | 0.394944    0.397109    0.806675    0.793927    0.565363    0.865805    0.836498    0.801387    0.799692    0.752834    0.745592    0.394944    0.397109    2600        8.186398    0.539557    0.129244    172.021803 
[37m[36mINFO[0m[0m 03/25 19:06:36 | 0.362439    0.341837    0.823460    0.827232    0.486440    0.895070    0.883966    0.807677    0.815614    0.767632    0.782116    0.362439    0.341837    2800        8.816121    0.525441    0.162124    167.622303 
[37m[36mINFO[0m[0m 03/25 19:09:53 | 0.322074    0.300170    0.828629    0.819137    0.496730    0.888479    0.863924    0.820644    0.817668    0.776763    0.775819    0.322074    0.300170    3000        9.445844    0.495266    0.159762    164.865690 
[37m[36mINFO[0m[0m 03/25 19:13:19 | 0.341194    0.323129    0.824908    0.813418    0.499426    0.887161    0.859705    0.802927    0.799692    0.784635    0.780856    0.341194    0.323129    3200        10.075567   0.487148    0.217147    162.648145 
[37m[36mINFO[0m[0m 03/25 19:16:33 | 0.360314    0.345238    0.835573    0.828092    0.466782    0.900606    0.875527    0.828091    0.825372    0.778023    0.783375    0.360314    0.345238    3400        10.705290   0.467789    0.142478    165.375944 
[37m[36mINFO[0m[0m 03/25 19:19:45 | 0.379435    0.374150    0.831792    0.828418    0.497058    0.891379    0.871308    0.836051    0.846944    0.767947    0.767003    0.379435    0.374150    3600        11.335013   0.467862    0.141803    163.928591 
[37m[36mINFO[0m[0m 03/25 19:23:02 | 0.313576    0.300170    0.801060    0.785529    0.611536    0.887424    0.858650    0.821800    0.800205    0.693955    0.697733    0.313576    0.300170    3800        11.964736   0.444748    0.131460    170.358500 
[37m[36mINFO[0m[0m 03/25 19:26:23 | 0.364776    0.342687    0.842632    0.823894    0.470335    0.913525    0.883966    0.828476    0.832049    0.785894    0.755668    0.364776    0.342687    4000        12.594458   0.446373    0.186278    163.766089 
[37m[36mINFO[0m[0m 03/25 19:29:37 | 0.344806    0.336735    0.852856    0.846808    0.446456    0.907461    0.886076    0.846322    0.852080    0.804786    0.802267    0.344806    0.336735    4200        13.224181   0.441113    0.129513    168.563105 
[37m[36mINFO[0m[0m 03/25 19:32:59 | 0.340982    0.321429    0.842032    0.833939    0.468773    0.906670    0.885021    0.836051    0.851053    0.783375    0.765743    0.340982    0.321429    4400        13.853904   0.431942    0.168226    168.064349 
[37m[36mINFO[0m[0m 03/25 19:36:20 | 0.289994    0.279762    0.843439    0.837501    0.472077    0.909307    0.889241    0.833226    0.833590    0.787783    0.789673    0.289994    0.279762    4600        14.483627   0.434167    0.193616    162.380790 
[37m[36mINFO[0m[0m 03/25 19:39:45 | 0.333546    0.319728    0.848760    0.840463    0.452829    0.912998    0.888186    0.839517    0.839753    0.793766    0.793451    0.333546    0.319728    4800        15.113350   0.426592    0.197017    165.675736 
[37m[36mINFO[0m[0m 03/25 19:43:00 | 0.311026    0.293367    0.867919    0.856263    0.407324    0.924862    0.889241    0.857106    0.865948    0.821788    0.813602    0.311026    0.293367    5000        15.743073   0.418864    0.133652    168.431244 
[37m[36mINFO[0m[0m 03/25 19:43:00 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250325_18-16-25_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 19:43:02 | ---
[37m[36mINFO[0m[0m 03/25 19:43:02 | test-domain validation(oracle) = 40.217%
[37m[36mINFO[0m[0m 03/25 19:43:02 | training-domain validation(iid) = 31.103%
[37m[36mINFO[0m[0m 03/25 19:43:02 | last = 31.103%
[37m[36mINFO[0m[0m 03/25 19:43:02 | last (inD) = 85.626%
[37m[36mINFO[0m[0m 03/25 19:43:02 | training-domain validation (iid, inD) = 85.626%
[37m[36mINFO[0m[0m 03/25 19:43:02 | === Summary ===
[37m[36mINFO[0m[0m 03/25 19:43:02 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 2
[37m[36mINFO[0m[0m 03/25 19:43:02 | Unique name: 250325_18-16-25_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 19:43:02 | Out path: train_output/TerraIncognita/ERM/[3]/250325_18-16-25_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 19:43:02 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 19:43:02 | Dataset: TerraIncognita

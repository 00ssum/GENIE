[37m[36mINFO[0m[0m 03/24 16:27:15 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 4
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 4
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250324_16-27-15_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250324_16-27-15_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 7.71168362195819e-05
	batch_size: 8
	weight_decay: 0.0007466379205516084
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/24 16:27:15 | n_steps = 5001
[37m[36mINFO[0m[0m 03/24 16:27:15 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/24 16:27:15 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/24 16:27:15 | 
[37m[36mINFO[0m[0m 03/24 16:27:15 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/24 16:27:15 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/24 16:27:15 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/24 16:27:15 | Batch sizes for each domain: [8, 8, 8, 0] (total=24)
[37m[36mINFO[0m[0m 03/24 16:27:15 | steps-per-epoch for each domain: 474.12, 973.62, 397.00 -> min = 397.00
[37m[36mINFO[0m[0m 03/24 16:27:16 | # of params = 23528522
[37m[36mINFO[0m[0m 03/24 16:30:06 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/24 16:30:06 | 0.217336    0.229592    0.286257    0.283001    2.029953    0.208806    0.179325    0.461677    0.455573    0.188287    0.214106    0.217336    0.229592    0           0.000000    2.380816    0.900195    168.130857 
[37m[36mINFO[0m[0m 03/24 16:33:17 | 0.217761    0.227891    0.507553    0.562534    1.288765    0.570261    0.703586    0.576454    0.586030    0.375945    0.397985    0.217761    0.227891    200         0.503778    1.540151    0.114366    168.645782 
[37m[36mINFO[0m[0m 03/24 16:36:32 | 0.231995    0.250000    0.563335    0.583861    1.174125    0.679409    0.713080    0.583644    0.590139    0.426952    0.448363    0.231995    0.250000    400         1.007557    1.305462    0.137834    167.825032 
[37m[36mINFO[0m[0m 03/24 16:39:47 | 0.171659    0.172619    0.542213    0.537863    1.250218    0.641445    0.649789    0.579022    0.569594    0.406171    0.394207    0.171659    0.172619    600         1.511335    1.210915    0.116740    170.724564 
[37m[36mINFO[0m[0m 03/24 16:43:03 | 0.262163    0.279762    0.604010    0.608983    1.079213    0.700765    0.743671    0.605598    0.587057    0.505668    0.496222    0.262163    0.279762    800         2.015113    1.123604    0.135299    168.961339 
[37m[36mINFO[0m[0m 03/24 16:46:21 | 0.316125    0.326531    0.666732    0.691314    0.907412    0.774848    0.774262    0.683785    0.693888    0.541562    0.605793    0.316125    0.326531    1000        2.518892    1.043710    0.149192    168.124915 
[37m[36mINFO[0m[0m 03/24 16:49:27 | 0.319524    0.324830    0.708056    0.726463    0.810031    0.795676    0.791139    0.723328    0.728300    0.605164    0.659950    0.319524    0.324830    1200        3.022670    0.869260    0.114442    163.868023 
[37m[36mINFO[0m[0m 03/24 16:52:43 | 0.299341    0.320578    0.730699    0.736291    0.767745    0.832850    0.822785    0.741173    0.760144    0.618073    0.625945    0.299341    0.320578    1400        3.526448    0.843649    0.119247    172.091931 
[37m[36mINFO[0m[0m 03/24 16:55:59 | 0.319949    0.317177    0.738900    0.751240    0.728208    0.824941    0.813291    0.728977    0.756549    0.662783    0.683879    0.319949    0.317177    1600        4.030227    0.774004    0.138743    167.662597 
[37m[36mINFO[0m[0m 03/24 16:59:14 | 0.320586    0.325680    0.730228    0.742783    0.720772    0.801740    0.778481    0.749775    0.776066    0.639169    0.673804    0.320586    0.325680    1800        4.534005    0.749391    0.123491    170.491677 
[37m[36mINFO[0m[0m 03/24 17:02:20 | 0.283195    0.297619    0.772664    0.778278    0.616648    0.862905    0.854430    0.774040    0.805342    0.681045    0.675063    0.283195    0.297619    2000        5.037783    0.686675    0.104774    165.206249 
[37m[36mINFO[0m[0m 03/24 17:05:38 | 0.329297    0.336735    0.751464    0.769214    0.630039    0.852096    0.855485    0.763127    0.777093    0.639169    0.675063    0.329297    0.336735    2200        5.541562    0.711013    0.141622    169.433421 
[37m[36mINFO[0m[0m 03/24 17:08:54 | 0.351392    0.345238    0.786043    0.794531    0.596885    0.865542    0.860759    0.772500    0.784797    0.720088    0.738035    0.351392    0.345238    2400        6.045340    0.634061    0.114601    173.695845 
[37m[36mINFO[0m[0m 03/24 17:12:05 | 0.373911    0.378401    0.781920    0.778656    0.604575    0.880042    0.854430    0.783413    0.772470    0.682305    0.709068    0.373911    0.378401    2600        6.549118    0.629521    0.112226    168.112623 
[37m[36mINFO[0m[0m 03/24 17:15:28 | 0.329509    0.317177    0.796730    0.801172    0.562039    0.866333    0.874473    0.790859    0.793529    0.732997    0.735516    0.329509    0.317177    2800        7.052897    0.610725    0.146007    173.399640 
[37m[36mINFO[0m[0m 03/24 17:18:38 | 0.311026    0.314626    0.784619    0.786406    0.609837    0.863433    0.862869    0.791116    0.796097    0.699307    0.700252    0.311026    0.314626    3000        7.556675    0.597333    0.115724    166.866572 
[37m[36mINFO[0m[0m 03/24 17:21:48 | 0.374761    0.369048    0.800925    0.808272    0.549364    0.890324    0.885021    0.803698    0.815614    0.708753    0.724181    0.374761    0.369048    3200        8.060453    0.549567    0.115979    166.994249 
[37m[36mINFO[0m[0m 03/24 17:25:09 | 0.312938    0.326531    0.801311    0.799369    0.542620    0.891642    0.873418    0.778662    0.776579    0.733627    0.748111    0.312938    0.326531    3400        8.564232    0.583723    0.153395    170.710824 
[37m[36mINFO[0m[0m 03/24 17:28:24 | 0.311663    0.320578    0.802373    0.806851    0.532914    0.885315    0.887131    0.775581    0.785311    0.746222    0.748111    0.311663    0.320578    3600        9.068010    0.546101    0.111482    172.666540 
[37m[36mINFO[0m[0m 03/24 17:31:35 | 0.368812    0.354592    0.802700    0.813019    0.514119    0.869233    0.859705    0.778791    0.816127    0.760076    0.763224    0.368812    0.354592    3800        9.571788    0.529594    0.120472    166.394341 
[37m[36mINFO[0m[0m 03/24 17:34:57 | 0.369875    0.368197    0.828267    0.840546    0.461884    0.899025    0.886076    0.801772    0.818182    0.784005    0.817380    0.369875    0.368197    4000        10.075567   0.516510    0.157333    171.312069 
[37m[36mINFO[0m[0m 03/24 17:38:16 | 0.405991    0.402211    0.827189    0.836390    0.457387    0.884788    0.871308    0.820644    0.833077    0.776134    0.804786    0.405991    0.402211    4200        10.579345   0.511526    0.134136    171.758446 
[37m[36mINFO[0m[0m 03/24 17:41:31 | 0.316337    0.325680    0.825272    0.827163    0.484803    0.898497    0.888186    0.797407    0.821263    0.779912    0.772040    0.316337    0.325680    4400        11.083123   0.513223    0.120422    171.062818 
[37m[36mINFO[0m[0m 03/24 17:44:51 | 0.341619    0.349490    0.829088    0.830409    0.467238    0.898761    0.886076    0.812685    0.821777    0.775819    0.783375    0.341619    0.349490    4600        11.586902   0.479583    0.150274    170.287625 
[37m[36mINFO[0m[0m 03/24 17:48:11 | 0.385383    0.385204    0.838166    0.848947    0.440290    0.906143    0.898734    0.803569    0.815614    0.804786    0.832494    0.385383    0.385204    4800        12.090680   0.473031    0.139221    171.334516 
[37m[36mINFO[0m[0m 03/24 17:51:20 | 0.380710    0.391156    0.830750    0.838413    0.451965    0.885051    0.876582    0.828861    0.835131    0.778338    0.803526    0.380710    0.391156    5000        12.594458   0.469254    0.116484    165.579251 
[37m[36mINFO[0m[0m 03/24 17:51:20 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250324_16-27-15_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/24 17:51:21 | ---
[37m[36mINFO[0m[0m 03/24 17:51:21 | test-domain validation(oracle) = 40.599%
[37m[36mINFO[0m[0m 03/24 17:51:21 | training-domain validation(iid) = 38.538%
[37m[36mINFO[0m[0m 03/24 17:51:21 | last = 38.071%
[37m[36mINFO[0m[0m 03/24 17:51:21 | last (inD) = 83.841%
[37m[36mINFO[0m[0m 03/24 17:51:21 | training-domain validation (iid, inD) = 84.895%
[37m[36mINFO[0m[0m 03/24 17:51:21 | === Summary ===
[37m[36mINFO[0m[0m 03/24 17:51:21 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 4
[37m[36mINFO[0m[0m 03/24 17:51:21 | Unique name: 250324_16-27-15_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 17:51:21 | Out path: train_output/TerraIncognita/ERM/[3]/250324_16-27-15_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 17:51:21 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/24 17:51:21 | Dataset: TerraIncognita

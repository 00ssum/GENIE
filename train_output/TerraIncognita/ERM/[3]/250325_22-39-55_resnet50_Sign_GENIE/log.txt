[37m[36mINFO[0m[0m 03/25 22:39:55 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 5
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 5
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250325_22-39-55_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250325_22-39-55_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.0002982828768978312
	batch_size: 9
	weight_decay: 0.0003180957897867641
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/25 22:39:56 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 22:39:56 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 22:39:56 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 22:39:56 | 
[37m[36mINFO[0m[0m 03/25 22:39:56 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/25 22:39:56 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/25 22:39:56 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/25 22:39:56 | Batch sizes for each domain: [9, 9, 9, 0] (total=27)
[37m[36mINFO[0m[0m 03/25 22:39:56 | steps-per-epoch for each domain: 421.44, 865.44, 352.89 -> min = 352.89
[37m[36mINFO[0m[0m 03/25 22:39:57 | # of params = 23528522
[37m[36mINFO[0m[0m 03/25 22:42:47 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 22:42:47 | 0.222860    0.207483    0.288403    0.273706    2.121794    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.222860    0.207483    0           0.000000    2.397418    1.003199    169.038165 
[37m[36mINFO[0m[0m 03/25 22:45:58 | 0.253240    0.235544    0.520760    0.506056    1.264659    0.644872    0.619198    0.597509    0.577812    0.319899    0.321159    0.253240    0.235544    200         0.566751    1.483599    0.124098    166.803444 
[37m[36mINFO[0m[0m 03/25 22:49:27 | 0.218823    0.203231    0.565154    0.569053    1.173281    0.718429    0.709916    0.583772    0.566513    0.393262    0.430730    0.218823    0.203231    400         1.133501    1.256079    0.201573    168.217043 
[37m[36mINFO[0m[0m 03/25 22:52:44 | 0.214149    0.204932    0.609695    0.590092    1.133828    0.722911    0.727848    0.639235    0.597843    0.466940    0.444584    0.214149    0.204932    600         1.700252    1.194481    0.146835    167.819593 
[37m[36mINFO[0m[0m 03/25 22:56:00 | 0.268111    0.265306    0.650920    0.649115    0.936813    0.780912    0.787975    0.701759    0.693374    0.470088    0.465995    0.268111    0.265306    800         2.267003    1.013414    0.140278    167.808237 
[37m[36mINFO[0m[0m 03/25 22:59:23 | 0.314850    0.315476    0.704082    0.700803    0.838861    0.793303    0.761603    0.724483    0.723677    0.594458    0.617128    0.314850    0.315476    1000        2.833753    0.912143    0.200992    162.826316 
[37m[36mINFO[0m[0m 03/25 23:02:32 | 0.321436    0.304422    0.720494    0.714236    0.775378    0.814922    0.811181    0.742971    0.725732    0.603589    0.605793    0.321436    0.304422    1200        3.400504    0.852536    0.116620    165.426961 
[37m[36mINFO[0m[0m 03/25 23:05:50 | 0.295517    0.284014    0.743956    0.743764    0.719776    0.823622    0.820675    0.751444    0.751926    0.656801    0.658690    0.295517    0.284014    1400        3.967254    0.724911    0.143587    169.077846 
[37m[36mINFO[0m[0m 03/25 23:09:10 | 0.324623    0.327381    0.749620    0.743362    0.685085    0.858951    0.850211    0.774040    0.751412    0.615869    0.628463    0.324623    0.327381    1600        4.534005    0.689288    0.156086    169.384016 
[37m[36mINFO[0m[0m 03/25 23:12:26 | 0.319312    0.326531    0.786882    0.785657    0.592670    0.873451    0.856540    0.767107    0.772470    0.720088    0.727960    0.319312    0.326531    1800        5.100756    0.660335    0.138436    168.254169 
[37m[36mINFO[0m[0m 03/25 23:15:47 | 0.321436    0.313776    0.782773    0.783164    0.598004    0.874242    0.854430    0.769418    0.768362    0.704660    0.726700    0.321436    0.313776    2000        5.667506    0.624553    0.167937    167.426600 
[37m[36mINFO[0m[0m 03/25 23:19:15 | 0.331209    0.325680    0.805594    0.792628    0.566618    0.880306    0.849156    0.792143    0.803287    0.744332    0.725441    0.331209    0.325680    2200        6.234257    0.599554    0.176558    172.983875 
[37m[36mINFO[0m[0m 03/25 23:22:34 | 0.345018    0.326531    0.801868    0.799181    0.542417    0.883997    0.863924    0.791758    0.795583    0.729849    0.738035    0.345018    0.326531    2400        6.801008    0.598434    0.155352    167.898091 
[37m[36mINFO[0m[0m 03/25 23:25:53 | 0.302528    0.287415    0.812057    0.807820    0.543609    0.883733    0.857595    0.803698    0.808937    0.748741    0.756927    0.302528    0.287415    2600        7.367758    0.568577    0.159347    167.090648 
[37m[36mINFO[0m[0m 03/25 23:29:02 | 0.285957    0.272109    0.822659    0.811618    0.503935    0.892961    0.864979    0.805495    0.807910    0.769521    0.761965    0.285957    0.272109    2800        7.934509    0.557179    0.121245    164.229033 
[37m[36mINFO[0m[0m 03/25 23:32:18 | 0.315912    0.301020    0.822397    0.802666    0.526313    0.894806    0.863924    0.809475    0.802260    0.762909    0.741814    0.315912    0.301020    3000        8.501259    0.550998    0.149334    166.107128 
[37m[36mINFO[0m[0m 03/25 23:35:46 | 0.267262    0.275510    0.828292    0.814243    0.501356    0.900606    0.873418    0.811914    0.804828    0.772355    0.764484    0.267262    0.275510    3200        9.068010    0.544295    0.208442    166.021155 
[37m[36mINFO[0m[0m 03/25 23:39:07 | 0.298704    0.287415    0.815293    0.804362    0.544891    0.895597    0.872363    0.806265    0.811505    0.744018    0.729219    0.298704    0.287415    3400        9.634761    0.488250    0.144256    173.066454 
[37m[36mINFO[0m[0m 03/25 23:42:31 | 0.320161    0.323129    0.823327    0.811627    0.506133    0.906143    0.881857    0.797150    0.796097    0.766688    0.756927    0.320161    0.323129    3600        10.201511   0.506250    0.161915    171.292500 
[37m[36mINFO[0m[0m 03/25 23:45:45 | 0.329509    0.332483    0.840038    0.825410    0.470135    0.900343    0.879747    0.831044    0.829481    0.788728    0.767003    0.329509    0.332483    3800        10.768262   0.492521    0.132285    167.861917 
[37m[36mINFO[0m[0m 03/25 23:49:01 | 0.352879    0.339286    0.838590    0.825936    0.486759    0.911943    0.879747    0.827064    0.819723    0.776763    0.778338    0.352879    0.339286    4000        11.335013   0.471453    0.141300    166.945684 
[37m[36mINFO[0m[0m 03/25 23:52:28 | 0.344168    0.329932    0.843154    0.824901    0.475108    0.899025    0.883966    0.825652    0.818695    0.804786    0.772040    0.344168    0.329932    4200        11.901763   0.474402    0.197862    167.420588 
[37m[36mINFO[0m[0m 03/25 23:55:40 | 0.329509    0.331633    0.833488    0.824256    0.494186    0.904825    0.894515    0.827064    0.837699    0.768577    0.740554    0.329509    0.331633    4400        12.468514   0.455284    0.135773    164.682454 
[37m[36mINFO[0m[0m 03/25 23:58:53 | 0.297217    0.286565    0.837346    0.830065    0.458342    0.912998    0.883966    0.820388    0.825372    0.778652    0.780856    0.297217    0.286565    4600        13.035264   0.443202    0.133950    166.775608 
[37m[36mINFO[0m[0m 03/26 00:02:09 | 0.366051    0.352041    0.846969    0.832180    0.468186    0.912207    0.875527    0.840288    0.821263    0.788413    0.799748    0.366051    0.352041    4800        13.602015   0.406070    0.148689    166.400423 
[37m[36mINFO[0m[0m 03/26 00:05:20 | 0.336308    0.317177    0.821668    0.812611    0.541894    0.878724    0.855485    0.818334    0.827940    0.767947    0.754408    0.336308    0.317177    5000        14.168766   0.448882    0.131778    164.195830 
[37m[36mINFO[0m[0m 03/26 00:05:20 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250325_22-39-55_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 00:05:21 | ---
[37m[36mINFO[0m[0m 03/26 00:05:21 | test-domain validation(oracle) = 36.605%
[37m[36mINFO[0m[0m 03/26 00:05:21 | training-domain validation(iid) = 36.605%
[37m[36mINFO[0m[0m 03/26 00:05:21 | last = 33.631%
[37m[36mINFO[0m[0m 03/26 00:05:21 | last (inD) = 81.261%
[37m[36mINFO[0m[0m 03/26 00:05:21 | training-domain validation (iid, inD) = 83.218%
[37m[36mINFO[0m[0m 03/26 00:05:21 | === Summary ===
[37m[36mINFO[0m[0m 03/26 00:05:21 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 5
[37m[36mINFO[0m[0m 03/26 00:05:21 | Unique name: 250325_22-39-55_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 00:05:21 | Out path: train_output/TerraIncognita/ERM/[3]/250325_22-39-55_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 00:05:21 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 00:05:21 | Dataset: TerraIncognita

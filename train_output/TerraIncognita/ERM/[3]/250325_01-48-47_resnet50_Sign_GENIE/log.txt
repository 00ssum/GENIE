[37m[36mINFO[0m[0m 03/25 01:48:47 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 10
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 10
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250325_01-48-47_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250325_01-48-47_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.2128485336217652e-05
	batch_size: 9
	weight_decay: 0.00030907441430549757
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/25 01:48:47 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 01:48:47 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 01:48:47 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 01:48:47 | 
[37m[36mINFO[0m[0m 03/25 01:48:47 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/25 01:48:47 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/25 01:48:47 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/25 01:48:47 | Batch sizes for each domain: [9, 9, 9, 0] (total=27)
[37m[36mINFO[0m[0m 03/25 01:48:47 | steps-per-epoch for each domain: 421.44, 865.44, 352.89 -> min = 352.89
[37m[36mINFO[0m[0m 03/25 01:48:48 | # of params = 23528522
[37m[36mINFO[0m[0m 03/25 01:51:54 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 01:51:54 | 0.215211    0.230442    0.299257    0.282230    2.013192    0.248880    0.178270    0.461548    0.455573    0.187343    0.212846    0.215211    0.230442    0           0.000000    2.510132    1.109451    184.978254 
[37m[36mINFO[0m[0m 03/25 01:55:16 | 0.243680    0.253401    0.489148    0.540113    1.310005    0.546533    0.685654    0.576454    0.561890    0.344458    0.372796    0.243680    0.253401    200         0.566751    1.535306    0.139793    173.892732 
[37m[36mINFO[0m[0m 03/25 01:58:36 | 0.247291    0.246599    0.562277    0.565697    1.170984    0.685737    0.704641    0.587367    0.579353    0.413728    0.413098    0.247291    0.246599    400         1.133501    1.298762    0.133857    173.222404 
[37m[36mINFO[0m[0m 03/25 02:02:04 | 0.303803    0.307823    0.595553    0.605302    1.064357    0.704719    0.689873    0.649634    0.662558    0.432305    0.463476    0.303803    0.307823    600         1.700252    1.168451    0.177343    172.910949 
[37m[36mINFO[0m[0m 03/25 02:05:37 | 0.248991    0.262755    0.673890    0.692226    0.854884    0.792776    0.799578    0.701502    0.738059    0.527393    0.539043    0.248991    0.262755    800         2.267003    1.030368    0.138403    184.557064 
[37m[36mINFO[0m[0m 03/25 02:09:35 | 0.335245    0.346939    0.714418    0.743174    0.758465    0.825468    0.829114    0.723328    0.758089    0.594458    0.642317    0.335245    0.346939    1000        2.833753    0.903050    0.158736    206.750623 
[37m[36mINFO[0m[0m 03/25 02:13:26 | 0.288506    0.291667    0.761922    0.776408    0.667398    0.855523    0.848101    0.755809    0.777093    0.674433    0.704030    0.288506    0.291667    1200        3.400504    0.812183    0.167223    197.253568 
[37m[36mINFO[0m[0m 03/25 02:17:03 | 0.346080    0.369898    0.756328    0.768201    0.685821    0.849987    0.825949    0.763769    0.779661    0.655227    0.698992    0.346080    0.369898    1400        3.967254    0.761831    0.139141    189.545650 
[37m[36mINFO[0m[0m 03/25 02:20:43 | 0.291693    0.293367    0.747715    0.744945    0.672051    0.849723    0.840717    0.723713    0.719055    0.669710    0.675063    0.291693    0.293367    1600        4.534005    0.719611    0.156011    188.670862 
[37m[36mINFO[0m[0m 03/25 02:24:28 | 0.341194    0.337585    0.758836    0.763225    0.673966    0.854732    0.819620    0.754269    0.764766    0.667506    0.705290    0.341194    0.337585    1800        5.100756    0.687495    0.168524    190.730824 
[37m[36mINFO[0m[0m 03/25 02:28:00 | 0.305078    0.305272    0.766995    0.768998    0.650555    0.859742    0.860759    0.731544    0.730868    0.709698    0.715365    0.305078    0.305272    2000        5.667506    0.669883    0.122485    187.941416 
[37m[36mINFO[0m[0m 03/25 02:31:38 | 0.285532    0.306973    0.798189    0.802535    0.547406    0.878724    0.859705    0.790089    0.804828    0.725756    0.743073    0.285532    0.306973    2200        6.234257    0.628221    0.135945    190.944021 
[37m[36mINFO[0m[0m 03/25 02:35:08 | 0.273210    0.287415    0.794706    0.801013    0.556421    0.878724    0.874473    0.773655    0.781715    0.731738    0.746851    0.273210    0.287415    2400        6.801008    0.594689    0.187906    172.478962 
[37m[36mINFO[0m[0m 03/25 02:38:54 | 0.326110    0.312925    0.801522    0.798283    0.562647    0.880306    0.870253    0.798819    0.824345    0.725441    0.700252    0.326110    0.312925    2600        7.367758    0.584831    0.152338    195.151782 
[37m[36mINFO[0m[0m 03/25 02:42:35 | 0.362226    0.376701    0.805699    0.830115    0.507160    0.880306    0.880802    0.792143    0.827427    0.744647    0.782116    0.362226    0.376701    2800        7.934509    0.537906    0.143256    192.932965 
[37m[36mINFO[0m[0m 03/25 02:46:28 | 0.315912    0.324830    0.780363    0.792883    0.589991    0.860005    0.843882    0.750289    0.776579    0.730793    0.758186    0.315912    0.324830    3000        8.501259    0.559731    0.132388    206.516690 
[37m[36mINFO[0m[0m 03/25 02:50:13 | 0.377948    0.388605    0.806799    0.814433    0.542685    0.876351    0.871308    0.796251    0.826400    0.747796    0.745592    0.377948    0.388605    3200        9.068010    0.519815    0.179785    189.117553 
[37m[36mINFO[0m[0m 03/25 02:53:40 | 0.262800    0.261054    0.799765    0.808144    0.537127    0.859742    0.868143    0.778534    0.795583    0.761020    0.760705    0.262800    0.261054    3400        9.634761    0.539810    0.151364    175.904491 
[37m[36mINFO[0m[0m 03/25 02:57:12 | 0.384534    0.381803    0.821002    0.824805    0.504019    0.888215    0.878692    0.800231    0.816127    0.774559    0.779597    0.384534    0.381803    3600        10.201511   0.532613    0.147367    182.701197 
[37m[36mINFO[0m[0m 03/25 03:00:25 | 0.309964    0.307823    0.832147    0.825217    0.499324    0.904825    0.898734    0.797535    0.807396    0.794081    0.769521    0.309964    0.307823    3800        10.768262   0.502338    0.125987    167.672072 
[37m[36mINFO[0m[0m 03/25 03:03:52 | 0.359040    0.347789    0.831683    0.831639    0.492463    0.903243    0.880802    0.817563    0.829481    0.774244    0.784635    0.359040    0.347789    4000        11.335013   0.470877    0.171003    172.837993 
[37m[36mINFO[0m[0m 03/25 03:07:39 | 0.332271    0.326531    0.840050    0.839897    0.433904    0.909834    0.896624    0.820644    0.823318    0.789673    0.799748    0.332271    0.326531    4200        11.901763   0.474370    0.154869    196.197002 
[37m[36mINFO[0m[0m 03/25 03:11:31 | 0.300404    0.314626    0.832462    0.820059    0.482248    0.908252    0.860759    0.812685    0.824859    0.776448    0.774559    0.300404    0.314626    4400        12.468514   0.486152    0.151774    201.701136 
[37m[36mINFO[0m[0m 03/25 03:15:09 | 0.399193    0.401361    0.851119    0.848932    0.404085    0.916161    0.890295    0.846579    0.859271    0.790617    0.797229    0.399193    0.401361    4600        13.035264   0.466570    0.181171    181.683470 
[37m[36mINFO[0m[0m 03/25 03:18:51 | 0.271298    0.278061    0.843268    0.842484    0.437185    0.902979    0.882911    0.827706    0.839753    0.799118    0.804786    0.271298    0.278061    4800        13.602015   0.463749    0.132048    195.711018 
[37m[36mINFO[0m[0m 03/25 03:22:38 | 0.298067    0.293367    0.849113    0.850371    0.422450    0.919325    0.894515    0.840544    0.864407    0.787469    0.792191    0.298067    0.293367    5000        14.168766   0.463644    0.160307    195.049088 
[37m[36mINFO[0m[0m 03/25 03:22:38 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250325_01-48-47_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 03:22:40 | ---
[37m[36mINFO[0m[0m 03/25 03:22:40 | test-domain validation(oracle) = 39.919%
[37m[36mINFO[0m[0m 03/25 03:22:40 | training-domain validation(iid) = 29.807%
[37m[36mINFO[0m[0m 03/25 03:22:40 | last = 29.807%
[37m[36mINFO[0m[0m 03/25 03:22:40 | last (inD) = 85.037%
[37m[36mINFO[0m[0m 03/25 03:22:40 | training-domain validation (iid, inD) = 85.037%
[37m[36mINFO[0m[0m 03/25 03:22:40 | === Summary ===
[37m[36mINFO[0m[0m 03/25 03:22:40 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 10
[37m[36mINFO[0m[0m 03/25 03:22:40 | Unique name: 250325_01-48-47_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 03:22:40 | Out path: train_output/TerraIncognita/ERM/[3]/250325_01-48-47_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 03:22:40 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 03:22:40 | Dataset: TerraIncognita

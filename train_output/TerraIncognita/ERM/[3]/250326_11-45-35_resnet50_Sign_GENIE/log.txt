[37m[36mINFO[0m[0m 03/26 11:45:35 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 16
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 16
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250326_11-45-35_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250326_11-45-35_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 1.15290264354828e-05
	batch_size: 18
	weight_decay: 0.008257233595621347
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/26 11:45:35 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 11:45:35 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 11:45:35 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 11:45:35 | 
[37m[36mINFO[0m[0m 03/26 11:45:36 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/26 11:45:36 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/26 11:45:36 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/26 11:45:36 | Batch sizes for each domain: [18, 18, 18, 0] (total=54)
[37m[36mINFO[0m[0m 03/26 11:45:36 | steps-per-epoch for each domain: 210.72, 432.72, 176.44 -> min = 176.44
[37m[36mINFO[0m[0m 03/26 11:45:37 | # of params = 23528522
[37m[36mINFO[0m[0m 03/26 11:48:20 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 11:48:20 | 0.222860    0.207483    0.288403    0.273706    2.125069    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.222860    0.207483    0           0.000000    2.470819    1.035429    162.778841 
[37m[36mINFO[0m[0m 03/26 11:51:48 | 0.181432    0.178571    0.556769    0.555148    1.194916    0.697601    0.707806    0.581333    0.563431    0.391373    0.394207    0.181432    0.178571    200         1.133501    1.374494    0.214615    165.067182 
[37m[36mINFO[0m[0m 03/26 11:55:11 | 0.202464    0.192177    0.622773    0.637820    0.982584    0.754548    0.760549    0.671075    0.671803    0.442695    0.481108    0.202464    0.192177    400         2.267003    1.118514    0.187514    164.960948 
[37m[36mINFO[0m[0m 03/26 11:58:39 | 0.263013    0.245748    0.714040    0.700327    0.830488    0.753493    0.758439    0.746309    0.735490    0.642317    0.607053    0.263013    0.245748    600         3.400504    0.854124    0.203470    167.228873 
[37m[36mINFO[0m[0m 03/26 12:02:10 | 0.305078    0.285714    0.775070    0.770591    0.655665    0.863169    0.855485    0.765567    0.756035    0.696474    0.700252    0.305078    0.285714    800         4.534005    0.726481    0.253987    160.429771 
[37m[36mINFO[0m[0m 03/26 12:05:35 | 0.356065    0.351190    0.780663    0.779266    0.639453    0.869760    0.853376    0.774811    0.765280    0.697418    0.719144    0.356065    0.351190    1000        5.667506    0.670949    0.192494    166.840255 
[37m[36mINFO[0m[0m 03/26 12:08:56 | 0.326747    0.321429    0.789894    0.790789    0.577634    0.880042    0.868143    0.776480    0.786338    0.713161    0.717884    0.326747    0.321429    1200        6.801008    0.609983    0.185153    163.597498 
[37m[36mINFO[0m[0m 03/26 12:12:23 | 0.338857    0.324830    0.781659    0.773081    0.627609    0.865805    0.856540    0.752471    0.736004    0.726700    0.726700    0.338857    0.324830    1400        7.934509    0.598060    0.208602    165.603993 
[37m[36mINFO[0m[0m 03/26 12:15:48 | 0.265562    0.250850    0.805055    0.780899    0.591487    0.863960    0.839662    0.795224    0.763739    0.755982    0.739295    0.265562    0.250850    1600        9.068010    0.575551    0.188372    166.630495 
[37m[36mINFO[0m[0m 03/26 12:19:13 | 0.347567    0.340986    0.797475    0.798502    0.556824    0.868178    0.857595    0.798177    0.796097    0.726071    0.741814    0.347567    0.340986    1800        10.201511   0.559736    0.196512    166.382768 
[37m[36mINFO[0m[0m 03/26 12:22:43 | 0.321861    0.321429    0.814562    0.813001    0.515977    0.886106    0.870253    0.789318    0.801746    0.768262    0.767003    0.321861    0.321429    2000        11.335013   0.552120    0.237498    161.925316 
[37m[36mINFO[0m[0m 03/26 12:26:08 | 0.350117    0.346939    0.801785    0.788773    0.545078    0.855260    0.831224    0.793170    0.780688    0.756927    0.754408    0.350117    0.346939    2200        12.468514   0.507004    0.189515    166.868102 
[37m[36mINFO[0m[0m 03/26 12:29:34 | 0.348417    0.341837    0.796745    0.784240    0.552469    0.862905    0.845992    0.788034    0.772470    0.739295    0.734257    0.348417    0.341837    2400        13.602015   0.513131    0.211197    164.096136 
[37m[36mINFO[0m[0m 03/26 12:32:50 | 0.289144    0.294218    0.799886    0.786580    0.585603    0.877933    0.857595    0.807934    0.809450    0.713791    0.692695    0.289144    0.294218    2600        14.735516   0.541236    0.160496    164.470273 
[37m[36mINFO[0m[0m 03/26 12:36:10 | 0.363289    0.357143    0.820324    0.806865    0.523245    0.894543    0.872363    0.814225    0.808937    0.752204    0.739295    0.363289    0.357143    2800        15.869018   0.529336    0.161180    167.181264 
[37m[36mINFO[0m[0m 03/26 12:39:35 | 0.270023    0.254252    0.811604    0.808837    0.544343    0.876351    0.871308    0.822314    0.831022    0.736146    0.724181    0.270023    0.254252    3000        17.002519   0.475705    0.182738    168.963307 
[37m[36mINFO[0m[0m 03/26 12:42:58 | 0.283833    0.275510    0.813147    0.802980    0.523805    0.884788    0.868143    0.787649    0.788906    0.767003    0.751889    0.283833    0.275510    3200        18.136020   0.526913    0.157874    170.862294 
[37m[36mINFO[0m[0m 03/26 12:46:18 | 0.305715    0.287415    0.821306    0.807204    0.520840    0.890588    0.877637    0.796251    0.797124    0.777078    0.746851    0.305715    0.287415    3400        19.269521   0.501574    0.173679    165.630758 
[37m[36mINFO[0m[0m 03/26 12:49:45 | 0.340344    0.341837    0.819217    0.820195    0.506632    0.897706    0.889241    0.827577    0.832049    0.732368    0.739295    0.340344    0.341837    3600        20.403023   0.503718    0.201804    166.009646 
[37m[36mINFO[0m[0m 03/26 12:52:55 | 0.303378    0.293367    0.833103    0.821230    0.484631    0.897970    0.881857    0.822057    0.827427    0.779282    0.754408    0.303378    0.293367    3800        21.536524   0.492743    0.155580    158.912400 
[37m[36mINFO[0m[0m 03/26 12:56:13 | 0.333971    0.336735    0.802740    0.793631    0.600902    0.882942    0.857595    0.776223    0.782743    0.749055    0.740554    0.333971    0.336735    4000        22.670025   0.480207    0.178506    162.730262 
[37m[36mINFO[0m[0m 03/26 12:59:44 | 0.318249    0.306973    0.827255    0.822392    0.486042    0.897443    0.890295    0.817948    0.818695    0.766373    0.758186    0.318249    0.306973    4200        23.803526   0.521813    0.230614    164.493036 
[37m[36mINFO[0m[0m 03/26 13:03:07 | 0.318674    0.308673    0.802783    0.798104    0.563697    0.880833    0.878692    0.801130    0.802773    0.726385    0.712846    0.318674    0.308673    4400        24.937028   0.501972    0.188435    165.533020 
[37m[36mINFO[0m[0m 03/26 13:06:32 | 0.336095    0.328231    0.831522    0.834229    0.474442    0.907988    0.893460    0.823983    0.837185    0.762594    0.772040    0.336095    0.328231    4600        26.070529   0.525054    0.200015    165.274663 
[37m[36mINFO[0m[0m 03/26 13:09:57 | 0.360739    0.358844    0.782003    0.790781    0.593749    0.832323    0.829114    0.802414    0.797637    0.711272    0.745592    0.360739    0.358844    4800        27.204030   0.508375    0.208739    163.402141 
[37m[36mINFO[0m[0m 03/26 13:13:24 | 0.320161    0.322279    0.817407    0.801894    0.546057    0.893488    0.877637    0.826679    0.820236    0.732053    0.707809    0.320161    0.322279    5000        28.337531   0.511662    0.201437    166.617022 
[37m[36mINFO[0m[0m 03/26 13:13:24 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250326_11-45-35_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 13:13:26 | ---
[37m[36mINFO[0m[0m 03/26 13:13:26 | test-domain validation(oracle) = 36.074%
[37m[36mINFO[0m[0m 03/26 13:13:26 | training-domain validation(iid) = 33.610%
[37m[36mINFO[0m[0m 03/26 13:13:26 | last = 32.016%
[37m[36mINFO[0m[0m 03/26 13:13:26 | last (inD) = 80.189%
[37m[36mINFO[0m[0m 03/26 13:13:26 | training-domain validation (iid, inD) = 83.423%
[37m[36mINFO[0m[0m 03/26 13:13:26 | === Summary ===
[37m[36mINFO[0m[0m 03/26 13:13:26 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 16
[37m[36mINFO[0m[0m 03/26 13:13:26 | Unique name: 250326_11-45-35_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 13:13:26 | Out path: train_output/TerraIncognita/ERM/[3]/250326_11-45-35_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 13:13:26 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 13:13:26 | Dataset: TerraIncognita

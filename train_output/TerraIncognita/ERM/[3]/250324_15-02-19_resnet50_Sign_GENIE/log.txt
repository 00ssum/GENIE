[37m[36mINFO[0m[0m 03/24 15:02:19 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 3
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 3
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250324_15-02-19_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250324_15-02-19_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00018664964766736356
	batch_size: 13
	weight_decay: 0.0001969969539389593
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/24 15:02:19 | n_steps = 5001
[37m[36mINFO[0m[0m 03/24 15:02:19 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/24 15:02:19 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/24 15:02:19 | 
[37m[36mINFO[0m[0m 03/24 15:02:19 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/24 15:02:19 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/24 15:02:19 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/24 15:02:19 | Batch sizes for each domain: [13, 13, 13, 0] (total=39)
[37m[36mINFO[0m[0m 03/24 15:02:19 | steps-per-epoch for each domain: 291.77, 599.15, 244.31 -> min = 244.31
[37m[36mINFO[0m[0m 03/24 15:02:21 | # of params = 23528522
[37m[36mINFO[0m[0m 03/24 15:05:08 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/24 15:05:08 | 0.212237    0.223639    0.354116    0.357192    2.032424    0.419721    0.401899    0.460008    0.455573    0.182620    0.214106    0.212237    0.223639    0           0.000000    2.423626    1.331146    166.636858 
[37m[36mINFO[0m[0m 03/24 15:08:30 | 0.246441    0.263605    0.495724    0.523452    1.237379    0.607171    0.618143    0.587495    0.595788    0.292506    0.356423    0.246441    0.263605    200         0.818640    1.466229    0.149406    171.331616 
[37m[36mINFO[0m[0m 03/24 15:11:43 | 0.242617    0.248299    0.608244    0.627460    1.066774    0.725283    0.743671    0.600077    0.600924    0.499370    0.537783    0.242617    0.248299    400         1.637280    1.216549    0.134823    166.818423 
[37m[36mINFO[0m[0m 03/24 15:14:54 | 0.259401    0.266156    0.667737    0.684178    0.900650    0.791722    0.798523    0.693542    0.689779    0.517947    0.564232    0.259401    0.266156    600         2.455919    1.012958    0.134155    163.656014 
[37m[36mINFO[0m[0m 03/24 15:18:11 | 0.324623    0.327381    0.712226    0.726651    0.774824    0.807013    0.815401    0.718834    0.727273    0.610831    0.637280    0.324623    0.327381    800         3.274559    0.850041    0.143187    168.606895 
[37m[36mINFO[0m[0m 03/24 15:21:34 | 0.294243    0.292517    0.765240    0.775736    0.655629    0.853941    0.856540    0.759789    0.770416    0.681990    0.700252    0.294243    0.292517    1000        4.093199    0.725915    0.154181    172.292107 
[37m[36mINFO[0m[0m 03/24 15:24:54 | 0.362651    0.361395    0.791029    0.780735    0.586397    0.878724    0.867089    0.763256    0.739599    0.731108    0.735516    0.362651    0.361395    1200        4.911839    0.673696    0.159372    167.930172 
[37m[36mINFO[0m[0m 03/24 15:28:08 | 0.343531    0.352041    0.797427    0.805559    0.537242    0.870024    0.867089    0.789575    0.814073    0.732683    0.735516    0.343531    0.352041    1400        5.730479    0.620343    0.131645    167.314480 
[37m[36mINFO[0m[0m 03/24 15:31:29 | 0.355428    0.356293    0.811532    0.803194    0.535690    0.882679    0.861814    0.796251    0.810991    0.755668    0.736776    0.355428    0.356293    1600        6.549118    0.583259    0.130147    175.158288 
[37m[36mINFO[0m[0m 03/24 15:34:41 | 0.346930    0.346088    0.803846    0.810687    0.536648    0.879515    0.878692    0.796508    0.814073    0.735516    0.739295    0.346930    0.346088    1800        7.367758    0.577256    0.124729    166.708458 
[37m[36mINFO[0m[0m 03/24 15:37:55 | 0.367963    0.380952    0.817587    0.827522    0.489357    0.889533    0.872363    0.808191    0.835645    0.755038    0.774559    0.367963    0.380952    2000        8.186398    0.539528    0.152554    163.917113 
[37m[36mINFO[0m[0m 03/24 15:41:16 | 0.288719    0.300170    0.808365    0.805800    0.545606    0.867387    0.843882    0.802670    0.814073    0.755038    0.759446    0.288719    0.300170    2200        9.005038    0.519480    0.155455    170.273473 
[37m[36mINFO[0m[0m 03/24 15:44:36 | 0.322711    0.338435    0.829210    0.838253    0.486032    0.891379    0.891350    0.819489    0.841294    0.776763    0.782116    0.322711    0.338435    2400        9.823678    0.522399    0.137021    171.843063 
[37m[36mINFO[0m[0m 03/24 15:47:54 | 0.343956    0.348639    0.830194    0.829564    0.479590    0.891379    0.879747    0.818975    0.835645    0.780227    0.773300    0.343956    0.348639    2600        10.642317   0.499237    0.134361    171.226969 
[37m[36mINFO[0m[0m 03/24 15:51:08 | 0.321861    0.322279    0.828028    0.827296    0.488629    0.900079    0.890295    0.817948    0.837185    0.766058    0.754408    0.321861    0.322279    2800        11.460957   0.480557    0.133452    167.874385 
[37m[36mINFO[0m[0m 03/24 15:54:26 | 0.319312    0.346088    0.853731    0.842028    0.432233    0.913261    0.887131    0.841571    0.850539    0.806360    0.788413    0.319312    0.346088    3000        12.279597   0.466457    0.148217    167.500169 
[37m[36mINFO[0m[0m 03/24 15:57:44 | 0.340132    0.344388    0.855529    0.847683    0.419887    0.914316    0.896624    0.844653    0.859271    0.807620    0.787154    0.340132    0.344388    3200        13.098237   0.423666    0.153351    168.172698 
[37m[36mINFO[0m[0m 03/24 16:01:00 | 0.412577    0.424320    0.840399    0.845911    0.447912    0.908779    0.902954    0.808576    0.829995    0.803841    0.804786    0.412577    0.424320    3400        13.916877   0.422294    0.161629    163.529243 
[37m[36mINFO[0m[0m 03/24 16:04:17 | 0.350117    0.364796    0.840089    0.817951    0.496541    0.907197    0.860759    0.806394    0.797124    0.806675    0.795970    0.350117    0.364796    3600        14.735516   0.413371    0.131607    170.871789 
[37m[36mINFO[0m[0m 03/24 16:07:34 | 0.380072    0.368197    0.863412    0.866028    0.388810    0.915370    0.911392    0.850558    0.870570    0.824307    0.816121    0.380072    0.368197    3800        15.554156   0.402787    0.135797    169.114167 
[37m[36mINFO[0m[0m 03/24 16:10:51 | 0.364563    0.370748    0.861496    0.847572    0.419483    0.919852    0.912447    0.845680    0.844376    0.818955    0.785894    0.364563    0.370748    4000        16.372796   0.385261    0.135458    170.465404 
[37m[36mINFO[0m[0m 03/24 16:14:04 | 0.360102    0.357143    0.877607    0.874342    0.364047    0.924862    0.914557    0.862242    0.863380    0.845718    0.845088    0.360102    0.357143    4200        17.191436   0.374520    0.129843    166.544081 
[37m[36mINFO[0m[0m 03/24 16:17:16 | 0.345231    0.333333    0.868241    0.862571    0.395156    0.916689    0.907173    0.867505    0.878274    0.820529    0.802267    0.345231    0.333333    4400        18.010076   0.368879    0.159614    160.608912 
[37m[36mINFO[0m[0m 03/24 16:20:35 | 0.327597    0.335034    0.876778    0.868873    0.386966    0.924071    0.908228    0.855822    0.863380    0.850441    0.835013    0.327597    0.335034    4600        18.828715   0.360823    0.138987    171.070454 
[37m[36mINFO[0m[0m 03/24 16:23:49 | 0.360952    0.366497    0.880578    0.872537    0.373035    0.928025    0.919831    0.850045    0.857730    0.863665    0.840050    0.360952    0.366497    4800        19.647355   0.339832    0.130322    167.601465 
[37m[36mINFO[0m[0m 03/24 16:27:10 | 0.356703    0.372449    0.892991    0.876825    0.340009    0.939098    0.911392    0.871485    0.891628    0.868388    0.827456    0.356703    0.372449    5000        20.465995   0.344694    0.159557    168.879512 
[37m[36mINFO[0m[0m 03/24 16:27:10 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250324_15-02-19_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/24 16:27:11 | ---
[37m[36mINFO[0m[0m 03/24 16:27:11 | test-domain validation(oracle) = 41.258%
[37m[36mINFO[0m[0m 03/24 16:27:11 | training-domain validation(iid) = 35.670%
[37m[36mINFO[0m[0m 03/24 16:27:11 | last = 35.670%
[37m[36mINFO[0m[0m 03/24 16:27:11 | last (inD) = 87.683%
[37m[36mINFO[0m[0m 03/24 16:27:11 | training-domain validation (iid, inD) = 87.683%
[37m[36mINFO[0m[0m 03/24 16:27:11 | === Summary ===
[37m[36mINFO[0m[0m 03/24 16:27:11 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 3
[37m[36mINFO[0m[0m 03/24 16:27:11 | Unique name: 250324_15-02-19_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 16:27:11 | Out path: train_output/TerraIncognita/ERM/[3]/250324_15-02-19_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 16:27:11 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/24 16:27:11 | Dataset: TerraIncognita

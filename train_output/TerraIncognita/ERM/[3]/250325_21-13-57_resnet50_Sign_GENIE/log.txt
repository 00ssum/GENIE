[37m[36mINFO[0m[0m 03/25 21:13:57 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 4
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 4
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250325_21-13-57_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250325_21-13-57_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 6.164076981615215e-05
	batch_size: 11
	weight_decay: 3.184710792983041e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/25 21:13:57 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 21:13:57 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 21:13:57 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 21:13:57 | 
[37m[36mINFO[0m[0m 03/25 21:13:57 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/25 21:13:57 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/25 21:13:57 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/25 21:13:57 | Batch sizes for each domain: [11, 11, 11, 0] (total=33)
[37m[36mINFO[0m[0m 03/25 21:13:57 | steps-per-epoch for each domain: 344.82, 708.09, 288.73 -> min = 288.73
[37m[36mINFO[0m[0m 03/25 21:13:58 | # of params = 23528522
[37m[36mINFO[0m[0m 03/25 21:16:51 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 21:16:51 | 0.222860    0.207483    0.288403    0.273706    2.116753    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.222860    0.207483    0           0.000000    2.430523    1.156544    171.507224 
[37m[36mINFO[0m[0m 03/25 21:20:17 | 0.276822    0.250000    0.546670    0.535095    1.251779    0.646454    0.641350    0.594942    0.563431    0.398615    0.400504    0.276822    0.250000    200         0.692695    1.451864    0.156311    174.616099 
[37m[36mINFO[0m[0m 03/25 21:23:47 | 0.212874    0.206633    0.570854    0.576757    1.153359    0.715265    0.732068    0.510207    0.498202    0.487091    0.500000    0.212874    0.206633    400         1.385390    1.194195    0.158853    178.259894 
[37m[36mINFO[0m[0m 03/25 21:27:12 | 0.312726    0.288265    0.669673    0.652881    1.033750    0.790931    0.787975    0.719348    0.704674    0.498741    0.465995    0.312726    0.288265    600         2.078086    1.033807    0.165171    172.364100 
[37m[36mINFO[0m[0m 03/25 21:30:35 | 0.324410    0.309524    0.737723    0.730313    0.758098    0.841287    0.824895    0.736808    0.726246    0.635076    0.639798    0.324410    0.309524    800         2.770781    0.908149    0.128493    176.610993 
[37m[36mINFO[0m[0m 03/25 21:33:56 | 0.272785    0.262755    0.753584    0.752856    0.720981    0.848141    0.839662    0.769033    0.737545    0.643577    0.681360    0.272785    0.262755    1000        3.463476    0.758491    0.141534    172.516550 
[37m[36mINFO[0m[0m 03/25 21:37:17 | 0.324623    0.307823    0.751434    0.739358    0.696027    0.848669    0.824895    0.766466    0.762198    0.639169    0.630982    0.324623    0.307823    1200        4.156171    0.669671    0.129986    175.730539 
[37m[36mINFO[0m[0m 03/25 21:40:44 | 0.310389    0.295068    0.790813    0.794382    0.573454    0.866860    0.854430    0.786751    0.789420    0.718829    0.739295    0.310389    0.295068    1400        4.848866    0.634647    0.198510    166.944287 
[37m[36mINFO[0m[0m 03/25 21:43:56 | 0.293180    0.288265    0.787424    0.786817    0.597780    0.873715    0.858650    0.792400    0.791474    0.696159    0.710327    0.293180    0.288265    1600        5.541562    0.599510    0.127482    166.316279 
[37m[36mINFO[0m[0m 03/25 21:47:09 | 0.310601    0.300170    0.799344    0.796753    0.567419    0.878724    0.877637    0.790089    0.790960    0.729219    0.721662    0.310601    0.300170    1800        6.234257    0.566735    0.121585    169.052145 
[37m[36mINFO[0m[0m 03/25 21:50:21 | 0.344806    0.346088    0.815646    0.811091    0.513375    0.878724    0.875527    0.802157    0.805855    0.766058    0.751889    0.344806    0.346088    2000        6.926952    0.533755    0.131322    166.052447 
[37m[36mINFO[0m[0m 03/25 21:53:41 | 0.311239    0.303571    0.822226    0.815001    0.525426    0.895861    0.872363    0.816408    0.820750    0.754408    0.751889    0.311239    0.303571    2200        7.619647    0.508154    0.166384    166.247871 
[37m[36mINFO[0m[0m 03/25 21:56:51 | 0.353304    0.341837    0.815061    0.783843    0.602427    0.889533    0.860759    0.797150    0.767848    0.758501    0.722922    0.353304    0.341837    2400        8.312343    0.468951    0.124470    164.895547 
[37m[36mINFO[0m[0m 03/25 22:00:09 | 0.324623    0.309524    0.830960    0.821708    0.493451    0.899552    0.871308    0.821286    0.821777    0.772040    0.772040    0.324623    0.309524    2600        9.005038    0.494072    0.150057    167.800306 
[37m[36mINFO[0m[0m 03/25 22:03:32 | 0.282770    0.265306    0.841191    0.828694    0.465235    0.911416    0.878692    0.831301    0.820236    0.780856    0.787154    0.282770    0.265306    2800        9.697733    0.475299    0.176668    167.714335 
[37m[36mINFO[0m[0m 03/25 22:06:45 | 0.317612    0.313776    0.846239    0.833372    0.442918    0.904297    0.885021    0.833098    0.827940    0.801322    0.787154    0.317612    0.313776    3000        10.390428   0.428192    0.154337    162.935552 
[37m[36mINFO[0m[0m 03/25 22:09:59 | 0.357553    0.359694    0.850133    0.844304    0.443388    0.919852    0.893460    0.831429    0.837185    0.799118    0.802267    0.357553    0.359694    3200        11.083123   0.425465    0.162381    160.799160 
[37m[36mINFO[0m[0m 03/25 22:13:22 | 0.448693    0.446429    0.851510    0.835558    0.464277    0.905088    0.878692    0.848119    0.843349    0.801322    0.784635    0.448693    0.446429    3400        11.775819   0.427574    0.181035    166.894545 
[37m[36mINFO[0m[0m 03/25 22:16:40 | 0.352879    0.351190    0.853241    0.851690    0.414569    0.917216    0.905063    0.837720    0.848998    0.804786    0.801008    0.352879    0.351190    3600        12.468514   0.388556    0.155570    166.783025 
[37m[36mINFO[0m[0m 03/25 22:20:05 | 0.364988    0.353741    0.864658    0.855160    0.424046    0.919325    0.894515    0.855694    0.864920    0.818955    0.806045    0.364988    0.353741    3800        13.161209   0.407042    0.169181    171.131563 
[37m[36mINFO[0m[0m 03/25 22:23:30 | 0.324623    0.336735    0.862012    0.850486    0.434175    0.926971    0.911392    0.837591    0.842835    0.821474    0.797229    0.324623    0.336735    4000        13.853904   0.392857    0.187030    167.504500 
[37m[36mINFO[0m[0m 03/25 22:26:45 | 0.351604    0.345238    0.866557    0.853559    0.405935    0.931716    0.907173    0.841443    0.847458    0.826511    0.806045    0.351604    0.345238    4200        14.546599   0.361966    0.158008    163.376044 
[37m[36mINFO[0m[0m 03/25 22:29:58 | 0.337795    0.329082    0.864864    0.852245    0.423280    0.935144    0.909283    0.864424    0.860298    0.795025    0.787154    0.337795    0.329082    4400        15.239295   0.360649    0.146533    164.333421 
[37m[36mINFO[0m[0m 03/25 22:33:09 | 0.283195    0.294218    0.851226    0.834744    0.475686    0.924071    0.895570    0.838362    0.834104    0.791247    0.774559    0.283195    0.294218    4600        15.931990   0.377078    0.130127    164.498902 
[37m[36mINFO[0m[0m 03/25 22:36:31 | 0.384959    0.369898    0.875617    0.855983    0.406421    0.934616    0.910338    0.856593    0.851567    0.835642    0.806045    0.384959    0.369898    4800        16.624685   0.367674    0.172853    167.113441 
[37m[36mINFO[0m[0m 03/25 22:39:50 | 0.297004    0.290816    0.874369    0.852591    0.428853    0.943317    0.913502    0.867762    0.852080    0.812028    0.792191    0.297004    0.290816    5000        17.317380   0.361821    0.155050    168.360237 
[37m[36mINFO[0m[0m 03/25 22:39:50 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250325_21-13-57_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 22:39:51 | ---
[37m[36mINFO[0m[0m 03/25 22:39:51 | test-domain validation(oracle) = 44.869%
[37m[36mINFO[0m[0m 03/25 22:39:51 | training-domain validation(iid) = 38.496%
[37m[36mINFO[0m[0m 03/25 22:39:51 | last = 29.700%
[37m[36mINFO[0m[0m 03/25 22:39:51 | last (inD) = 85.259%
[37m[36mINFO[0m[0m 03/25 22:39:51 | training-domain validation (iid, inD) = 85.598%
[37m[36mINFO[0m[0m 03/25 22:39:51 | === Summary ===
[37m[36mINFO[0m[0m 03/25 22:39:51 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 4
[37m[36mINFO[0m[0m 03/25 22:39:51 | Unique name: 250325_21-13-57_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 22:39:51 | Out path: train_output/TerraIncognita/ERM/[3]/250325_21-13-57_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 22:39:51 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 22:39:51 | Dataset: TerraIncognita

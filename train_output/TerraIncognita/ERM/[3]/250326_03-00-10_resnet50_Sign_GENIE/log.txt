[37m[36mINFO[0m[0m 03/26 03:00:10 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 8
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 8
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250326_03-00-10_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250326_03-00-10_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 3.019123985218396e-05
	batch_size: 9
	weight_decay: 0.0020603523571546007
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/26 03:00:10 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 03:00:10 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 03:00:10 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 03:00:10 | 
[37m[36mINFO[0m[0m 03/26 03:00:10 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/26 03:00:10 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/26 03:00:10 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/26 03:00:10 | Batch sizes for each domain: [9, 9, 9, 0] (total=27)
[37m[36mINFO[0m[0m 03/26 03:00:10 | steps-per-epoch for each domain: 421.44, 865.44, 352.89 -> min = 352.89
[37m[36mINFO[0m[0m 03/26 03:00:11 | # of params = 23528522
[37m[36mINFO[0m[0m 03/26 03:03:03 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 03:03:03 | 0.222860    0.207483    0.288403    0.273706    2.109555    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.222860    0.207483    0           0.000000    2.463258    1.138809    170.563775 
[37m[36mINFO[0m[0m 03/26 03:06:31 | 0.167623    0.152211    0.527365    0.518786    1.318387    0.615608    0.639241    0.605341    0.578326    0.361146    0.338791    0.167623    0.152211    200         0.566751    1.481268    0.181950    171.744631 
[37m[36mINFO[0m[0m 03/26 03:09:47 | 0.241555    0.232993    0.589291    0.580181    1.187172    0.714738    0.710970    0.595327    0.571135    0.457809    0.458438    0.241555    0.232993    400         1.133501    1.201376    0.139165    167.724247 
[37m[36mINFO[0m[0m 03/26 03:13:04 | 0.254302    0.232143    0.636280    0.623625    1.052935    0.716056    0.710970    0.680190    0.668721    0.512594    0.491184    0.254302    0.232143    600         1.700252    1.091366    0.168545    163.764260 
[37m[36mINFO[0m[0m 03/26 03:16:14 | 0.287657    0.284014    0.695317    0.696541    0.857570    0.790667    0.792194    0.715625    0.681561    0.579660    0.615869    0.287657    0.284014    800         2.267003    0.907276    0.132576    163.886962 
[37m[36mINFO[0m[0m 03/26 03:19:35 | 0.355428    0.336735    0.742936    0.736806    0.720110    0.838123    0.832278    0.755296    0.739599    0.635390    0.638539    0.355428    0.336735    1000        2.833753    0.797495    0.166138    167.320176 
[37m[36mINFO[0m[0m 03/26 03:22:46 | 0.343743    0.336735    0.721597    0.704116    0.766580    0.814922    0.796414    0.724868    0.713919    0.625000    0.602015    0.343743    0.336735    1200        3.400504    0.698190    0.124858    165.604508 
[37m[36mINFO[0m[0m 03/26 03:25:55 | 0.301041    0.278912    0.741464    0.740912    0.728005    0.817295    0.821730    0.757222    0.749872    0.649874    0.651134    0.301041    0.278912    1400        3.967254    0.667814    0.121976    164.797096 
[37m[36mINFO[0m[0m 03/26 03:29:07 | 0.382409    0.385204    0.763844    0.756802    0.707402    0.851832    0.843882    0.769675    0.753980    0.670025    0.672544    0.382409    0.385204    1600        4.534005    0.607084    0.147925    162.299222 
[37m[36mINFO[0m[0m 03/26 03:32:26 | 0.387296    0.388605    0.757350    0.762809    0.631653    0.854205    0.854430    0.766080    0.762712    0.651763    0.671285    0.387296    0.388605    1800        5.100756    0.614761    0.144923    170.248307 
[37m[36mINFO[0m[0m 03/26 03:35:38 | 0.326960    0.332483    0.807261    0.806445    0.556152    0.882942    0.860759    0.803954    0.796610    0.734887    0.761965    0.326960    0.332483    2000        5.667506    0.564546    0.140691    164.337831 
[37m[36mINFO[0m[0m 03/26 03:38:56 | 0.384959    0.380102    0.800248    0.796523    0.587313    0.883997    0.867089    0.811144    0.805855    0.705605    0.716625    0.384959    0.380102    2200        6.234257    0.538936    0.150004    167.251866 
[37m[36mINFO[0m[0m 03/26 03:42:06 | 0.317187    0.316327    0.809974    0.807096    0.535007    0.889006    0.867089    0.803826    0.804828    0.737091    0.749370    0.317187    0.316327    2400        6.801008    0.527786    0.141144    162.152925 
[37m[36mINFO[0m[0m 03/26 03:45:20 | 0.380072    0.374150    0.808614    0.805967    0.551271    0.884260    0.871308    0.789061    0.802260    0.752519    0.744332    0.380072    0.374150    2600        7.367758    0.519692    0.140058    165.786837 
[37m[36mINFO[0m[0m 03/26 03:48:26 | 0.283195    0.278912    0.829481    0.826740    0.474734    0.883997    0.864979    0.829888    0.835645    0.774559    0.779597    0.283195    0.278912    2800        7.934509    0.510097    0.127095    161.049263 
[37m[36mINFO[0m[0m 03/26 03:51:54 | 0.343318    0.335884    0.821153    0.808134    0.532426    0.891115    0.881857    0.817306    0.814587    0.755038    0.727960    0.343318    0.335884    3000        8.501259    0.550052    0.183947    170.856406 
[37m[36mINFO[0m[0m 03/26 03:55:10 | 0.322711    0.329932    0.819092    0.809786    0.538087    0.880833    0.863924    0.797792    0.799692    0.778652    0.765743    0.322711    0.329932    3200        9.068010    0.495784    0.142380    167.708795 
[37m[36mINFO[0m[0m 03/26 03:58:21 | 0.312088    0.313776    0.834582    0.822967    0.489203    0.895070    0.878692    0.823726    0.804314    0.784950    0.785894    0.312088    0.313776    3400        9.634761    0.463143    0.140744    162.846409 
[37m[36mINFO[0m[0m 03/26 04:01:47 | 0.312726    0.323129    0.824731    0.814121    0.473059    0.890588    0.874473    0.783541    0.783256    0.800063    0.784635    0.312726    0.323129    3600        10.201511   0.466068    0.141426    178.003688 
[37m[36mINFO[0m[0m 03/26 04:05:02 | 0.349055    0.363095    0.837749    0.834809    0.456116    0.908252    0.887131    0.828861    0.837699    0.776134    0.779597    0.349055    0.363095    3800        10.768262   0.467879    0.143233    166.158034 
[37m[36mINFO[0m[0m 03/26 04:08:21 | 0.348205    0.334184    0.803798    0.788919    0.610279    0.829950    0.789030    0.809090    0.823318    0.772355    0.754408    0.348205    0.334184    4000        11.335013   0.487915    0.145421    169.544477 
[37m[36mINFO[0m[0m 03/26 04:11:39 | 0.361802    0.378401    0.839959    0.827726    0.487622    0.899288    0.876582    0.817692    0.818182    0.802897    0.788413    0.361802    0.378401    4200        11.901763   0.447135    0.127768    172.140712 
[37m[36mINFO[0m[0m 03/26 04:14:47 | 0.329297    0.339286    0.839041    0.825306    0.479873    0.892961    0.873418    0.836693    0.827940    0.787469    0.774559    0.329297    0.339286    4400        12.468514   0.434461    0.128476    163.035662 
[37m[36mINFO[0m[0m 03/26 04:18:07 | 0.354366    0.353741    0.842584    0.833161    0.444826    0.909043    0.886076    0.814867    0.818695    0.803841    0.794710    0.354366    0.353741    4600        13.035264   0.437306    0.151082    169.266344 
[37m[36mINFO[0m[0m 03/26 04:21:30 | 0.397493    0.396259    0.856220    0.852967    0.413915    0.915107    0.894515    0.855694    0.863380    0.797859    0.801008    0.397493    0.396259    4800        13.602015   0.413187    0.160023    170.688168 
[37m[36mINFO[0m[0m 03/26 04:24:54 | 0.383259    0.373299    0.847279    0.834532    0.456677    0.916952    0.887131    0.838362    0.846944    0.786524    0.769521    0.383259    0.373299    5000        14.168766   0.427005    0.159185    172.133008 
[37m[36mINFO[0m[0m 03/26 04:24:54 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250326_03-00-10_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 04:24:55 | ---
[37m[36mINFO[0m[0m 03/26 04:24:55 | test-domain validation(oracle) = 39.749%
[37m[36mINFO[0m[0m 03/26 04:24:55 | training-domain validation(iid) = 39.749%
[37m[36mINFO[0m[0m 03/26 04:24:55 | last = 38.326%
[37m[36mINFO[0m[0m 03/26 04:24:55 | last (inD) = 83.453%
[37m[36mINFO[0m[0m 03/26 04:24:55 | training-domain validation (iid, inD) = 85.297%
[37m[36mINFO[0m[0m 03/26 04:24:55 | === Summary ===
[37m[36mINFO[0m[0m 03/26 04:24:55 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 8
[37m[36mINFO[0m[0m 03/26 04:24:55 | Unique name: 250326_03-00-10_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 04:24:55 | Out path: train_output/TerraIncognita/ERM/[3]/250326_03-00-10_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 04:24:55 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 04:24:55 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 03/25 19:43:06 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 3
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 3
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250325_19-43-06_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250325_19-43-06_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.0002649077542048787
	batch_size: 21
	weight_decay: 0.0023111806563778695
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/25 19:43:06 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 19:43:06 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 19:43:06 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 19:43:06 | 
[37m[36mINFO[0m[0m 03/25 19:43:06 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/25 19:43:06 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/25 19:43:06 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/25 19:43:06 | Batch sizes for each domain: [21, 21, 21, 0] (total=63)
[37m[36mINFO[0m[0m 03/25 19:43:06 | steps-per-epoch for each domain: 180.62, 370.90, 151.24 -> min = 151.24
[37m[36mINFO[0m[0m 03/25 19:43:07 | # of params = 23528522
[37m[36mINFO[0m[0m 03/25 19:45:57 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 19:45:57 | 0.222860    0.207483    0.288403    0.273706    2.111156    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.222860    0.207483    0           0.000000    2.465693    1.151260    168.806735 
[37m[36mINFO[0m[0m 03/25 19:49:28 | 0.206076    0.196429    0.584044    0.594742    1.158669    0.712101    0.747890    0.598280    0.569081    0.441751    0.467254    0.206076    0.196429    200         1.322418    1.344470    0.221674    166.403466 
[37m[36mINFO[0m[0m 03/25 19:53:04 | 0.270236    0.255102    0.702265    0.694134    0.858837    0.797258    0.783755    0.729875    0.731895    0.579660    0.566751    0.270236    0.255102    400         2.644836    1.019146    0.269100    162.333531 
[37m[36mINFO[0m[0m 03/25 19:56:24 | 0.288082    0.292517    0.761338    0.771260    0.662030    0.844450    0.848101    0.772371    0.772984    0.667191    0.692695    0.288082    0.292517    600         3.967254    0.761783    0.176078    164.382345 
[37m[36mINFO[0m[0m 03/25 19:59:47 | 0.316337    0.311224    0.782491    0.770861    0.599354    0.866069    0.840717    0.770446    0.753980    0.710957    0.717884    0.316337    0.311224    800         5.289673    0.642948    0.170892    169.419724 
[37m[36mINFO[0m[0m 03/25 20:03:04 | 0.345018    0.329932    0.819400    0.806843    0.518922    0.892433    0.875527    0.802542    0.798151    0.763224    0.746851    0.345018    0.329932    1000        6.612091    0.572977    0.169364    163.164186 
[37m[36mINFO[0m[0m 03/25 20:06:33 | 0.338007    0.326531    0.803061    0.793860    0.554850    0.892433    0.873418    0.797920    0.807910    0.718829    0.700252    0.338007    0.326531    1200        7.934509    0.513535    0.245002    159.908176 
[37m[36mINFO[0m[0m 03/25 20:09:59 | 0.373699    0.372449    0.816490    0.806604    0.519188    0.882942    0.863924    0.819361    0.814073    0.747166    0.741814    0.373699    0.372449    1400        9.256927    0.489915    0.180270    169.741869 
[37m[36mINFO[0m[0m 03/25 20:13:23 | 0.375398    0.366497    0.832179    0.820617    0.476536    0.897970    0.876582    0.812043    0.809450    0.786524    0.775819    0.375398    0.366497    1600        10.579345   0.482885    0.173217    169.609154 
[37m[36mINFO[0m[0m 03/25 20:16:46 | 0.294880    0.280612    0.831467    0.813803    0.492231    0.889006    0.866034    0.806907    0.805855    0.798489    0.769521    0.294880    0.280612    1800        11.901763   0.448921    0.183272    166.270524 
[37m[36mINFO[0m[0m 03/25 20:20:27 | 0.353516    0.351190    0.872079    0.862884    0.384228    0.921962    0.906118    0.858005    0.863893    0.836272    0.818640    0.353516    0.351190    2000        13.224181   0.419771    0.247477    171.616105 
[37m[36mINFO[0m[0m 03/25 20:23:57 | 0.330359    0.337585    0.851825    0.838779    0.446780    0.909834    0.878692    0.850302    0.847971    0.795340    0.789673    0.330359    0.337585    2200        14.546599   0.385465    0.184676    172.358807 
[37m[36mINFO[0m[0m 03/25 20:27:20 | 0.318462    0.298469    0.869007    0.855680    0.411139    0.925389    0.900844    0.851971    0.852594    0.829660    0.813602    0.318462    0.298469    2400        15.869018   0.372919    0.197595    163.765769 
[37m[36mINFO[0m[0m 03/25 20:30:45 | 0.329934    0.308673    0.881975    0.856852    0.387776    0.933035    0.902954    0.859931    0.860298    0.852960    0.807305    0.329934    0.308673    2600        17.191436   0.348798    0.189942    167.260840 
[37m[36mINFO[0m[0m 03/25 20:34:33 | 0.277884    0.268707    0.863828    0.826693    0.457278    0.911679    0.862869    0.858647    0.846430    0.821159    0.770781    0.277884    0.268707    2800        18.513854   0.330360    0.279810    172.154316 
[37m[36mINFO[0m[0m 03/25 20:38:13 | 0.381559    0.381803    0.860057    0.834129    0.443367    0.922752    0.899789    0.846964    0.833077    0.810453    0.769521    0.381559    0.381803    3000        19.836272   0.325539    0.226410    174.194964 
[37m[36mINFO[0m[0m 03/25 20:41:51 | 0.347992    0.360544    0.879811    0.860133    0.373643    0.933825    0.902954    0.867762    0.861325    0.837846    0.816121    0.347992    0.360544    3200        21.158690   0.323010    0.231812    171.838317 
[37m[36mINFO[0m[0m 03/25 20:45:30 | 0.343743    0.333333    0.896172    0.873641    0.346804    0.947799    0.907173    0.876107    0.876220    0.864610    0.837531    0.343743    0.333333    3400        22.481108   0.300888    0.247640    169.226347 
[37m[36mINFO[0m[0m 03/25 20:48:52 | 0.351179    0.338435    0.879426    0.847591    0.416559    0.920907    0.886076    0.863782    0.869543    0.853589    0.787154    0.351179    0.338435    3600        23.803526   0.308950    0.173155    167.429314 
[37m[36mINFO[0m[0m 03/25 20:52:23 | 0.330571    0.326531    0.871954    0.842847    0.443922    0.903770    0.855485    0.854410    0.855675    0.857683    0.817380    0.330571    0.326531    3800        25.125945   0.285597    0.189645    172.888120 
[37m[36mINFO[0m[0m 03/25 20:55:58 | 0.342256    0.330782    0.901609    0.875814    0.353561    0.952017    0.927215    0.889459    0.880329    0.863350    0.819899    0.342256    0.330782    4000        26.448363   0.286384    0.223462    170.268906 
[37m[36mINFO[0m[0m 03/25 20:59:33 | 0.362226    0.370748    0.903298    0.882247    0.330635    0.950435    0.919831    0.891385    0.879301    0.868073    0.847607    0.362226    0.370748    4200        27.770781   0.283100    0.215188    172.303770 
[37m[36mINFO[0m[0m 03/25 21:02:57 | 0.384746    0.374150    0.913544    0.884809    0.324490    0.958081    0.922996    0.893696    0.878788    0.888854    0.852645    0.384746    0.374150    4400        29.093199   0.256447    0.185056    167.441287 
[37m[36mINFO[0m[0m 03/25 21:06:28 | 0.386021    0.363946    0.904784    0.878218    0.343266    0.947271    0.917722    0.884838    0.884438    0.882242    0.832494    0.386021    0.363946    4600        30.415617   0.272058    0.201314    170.037502 
[37m[36mINFO[0m[0m 03/25 21:10:14 | 0.311026    0.318027    0.910206    0.884030    0.337536    0.954917    0.926160    0.887790    0.880842    0.887909    0.845088    0.311026    0.318027    4800        31.738035   0.235413    0.292483    167.420668 
[37m[36mINFO[0m[0m 03/25 21:13:51 | 0.376461    0.366497    0.918128    0.899152    0.298151    0.954917    0.933544    0.902426    0.891115    0.897040    0.872796    0.376461    0.366497    5000        33.060453   0.244786    0.230115    171.732203 
[37m[36mINFO[0m[0m 03/25 21:13:52 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250325_19-43-06_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 21:13:53 | ---
[37m[36mINFO[0m[0m 03/25 21:13:53 | test-domain validation(oracle) = 38.156%
[37m[36mINFO[0m[0m 03/25 21:13:53 | training-domain validation(iid) = 37.646%
[37m[36mINFO[0m[0m 03/25 21:13:53 | last = 37.646%
[37m[36mINFO[0m[0m 03/25 21:13:53 | last (inD) = 89.915%
[37m[36mINFO[0m[0m 03/25 21:13:53 | training-domain validation (iid, inD) = 89.915%
[37m[36mINFO[0m[0m 03/25 21:13:53 | === Summary ===
[37m[36mINFO[0m[0m 03/25 21:13:53 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 3
[37m[36mINFO[0m[0m 03/25 21:13:53 | Unique name: 250325_19-43-06_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 21:13:53 | Out path: train_output/TerraIncognita/ERM/[3]/250325_19-43-06_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 21:13:53 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 21:13:53 | Dataset: TerraIncognita

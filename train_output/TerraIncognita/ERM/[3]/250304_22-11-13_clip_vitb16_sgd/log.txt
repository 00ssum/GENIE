[37m[36mINFO[0m[0m 03/04 22:11:13 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_sgd config/clip_vitb16_sgd.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_sgd.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_sgd
	out_dir: train_output/TerraIncognita/ERM/[3]/250304_22-11-13_clip_vitb16_sgd
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250304_22-11-13_clip_vitb16_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: clip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/04 22:11:14 | n_steps = 5001
[37m[36mINFO[0m[0m 03/04 22:11:14 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/04 22:11:14 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/04 22:11:14 | 
[37m[36mINFO[0m[0m 03/04 22:11:14 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/04 22:11:14 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/04 22:11:14 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/04 22:11:14 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 03/04 22:11:14 | steps-per-epoch for each domain: 118.53, 243.41, 99.25 -> min = 99.25
[37m[36mINFO[0m[0m 03/04 22:11:16 | # of params = 86197770
[37m[36mINFO[0m[0m 03/04 22:14:01 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/04 22:14:01 | 0.279159    0.270408    0.200843    0.249080    2.233096    0.100185    0.143460    0.371678    0.421161    0.130668    0.182620    0.279159    0.270408    0           0.000000    2.218522    1.070852    164.047525 
[37m[36mINFO[0m[0m 03/04 22:18:13 | 0.237519    0.221088    0.411743    0.430386    1.838773    0.553124    0.585443    0.476184    0.482794    0.205919    0.222922    0.237519    0.221088    200         2.015113    1.984660    0.407055    170.092798 
[37m[36mINFO[0m[0m 03/04 22:22:20 | 0.253452    0.226190    0.466398    0.471128    1.662366    0.561033    0.550633    0.546283    0.554186    0.291877    0.308564    0.253452    0.226190    400         4.030227    1.759491    0.405546    166.105027 
[37m[36mINFO[0m[0m 03/04 22:26:24 | 0.285107    0.260204    0.504171    0.519806    1.537082    0.595307    0.608650    0.576839    0.599384    0.340365    0.351385    0.285107    0.260204    600         6.045340    1.644529    0.407486    162.923887 
[37m[36mINFO[0m[0m 03/04 22:30:27 | 0.282558    0.261905    0.521779    0.543249    1.450674    0.623781    0.657173    0.592374    0.619928    0.349181    0.352645    0.282558    0.261905    800         8.060453    1.530283    0.407000    161.722243 
[37m[36mINFO[0m[0m 03/04 22:34:29 | 0.284045    0.261905    0.536222    0.558424    1.381529    0.657791    0.677215    0.595712    0.635336    0.355164    0.362720    0.284045    0.261905    1000        10.075567   1.458575    0.409784    159.443601 
[37m[36mINFO[0m[0m 03/04 22:38:34 | 0.281071    0.256803    0.556144    0.579744    1.327036    0.686528    0.715190    0.604699    0.637391    0.377204    0.386650    0.281071    0.256803    1200        12.090680   1.393093    0.407091    163.420857 
[37m[36mINFO[0m[0m 03/04 22:42:40 | 0.284895    0.262755    0.571958    0.593306    1.276854    0.717638    0.728903    0.612530    0.651772    0.385705    0.399244    0.284895    0.262755    1400        14.105793   1.332686    0.411429    164.417365 
[37m[36mINFO[0m[0m 03/04 22:46:48 | 0.281283    0.261905    0.589998    0.604362    1.226147    0.738993    0.745781    0.623572    0.660503    0.407431    0.406801    0.281283    0.261905    1600        16.120907   1.290996    0.406515    166.122612 
[37m[36mINFO[0m[0m 03/04 22:50:54 | 0.297217    0.270408    0.601214    0.606070    1.185829    0.746111    0.738397    0.634356    0.669235    0.423174    0.410579    0.297217    0.270408    1800        18.136020   1.241217    0.408233    164.772477 
[37m[36mINFO[0m[0m 03/04 22:54:57 | 0.284470    0.257653    0.617945    0.631524    1.149547    0.765094    0.741561    0.652972    0.676939    0.435768    0.476071    0.284470    0.257653    2000        20.151134   1.186907    0.404463    162.007988 
[37m[36mINFO[0m[0m 03/04 22:59:06 | 0.312938    0.292517    0.649880    0.664787    1.068534    0.793567    0.780591    0.693542    0.706215    0.462531    0.507557    0.312938    0.292517    2200        22.166247   1.127502    0.407614    167.736149 
[37m[36mINFO[0m[0m 03/04 23:03:13 | 0.328447    0.300170    0.680446    0.680106    1.017318    0.818613    0.800633    0.728078    0.730868    0.494647    0.508816    0.328447    0.300170    2400        24.181360   1.066011    0.408703    164.813715 
[37m[36mINFO[0m[0m 03/04 23:07:25 | 0.311876    0.289116    0.684374    0.690908    0.983790    0.817031    0.785865    0.728848    0.747817    0.507242    0.539043    0.311876    0.289116    2600        26.196474   1.034393    0.409687    170.214193 
[37m[36mINFO[0m[0m 03/04 23:11:31 | 0.343318    0.310374    0.708851    0.714765    0.935417    0.841550    0.829114    0.747850    0.753467    0.537154    0.561713    0.343318    0.310374    2800        28.211587   0.987650    0.405908    164.275857 
[37m[36mINFO[0m[0m 03/04 23:15:40 | 0.340557    0.326531    0.721121    0.722628    0.907255    0.849723    0.830169    0.756965    0.759630    0.556675    0.578086    0.340557    0.326531    3000        30.226700   0.950560    0.407824    167.726094 
[37m[36mINFO[0m[0m 03/04 23:19:51 | 0.349904    0.328231    0.728131    0.735402    0.881532    0.842605    0.834388    0.753627    0.764766    0.588161    0.607053    0.349904    0.328231    3200        32.241814   0.924699    0.405007    170.087627 
[37m[36mINFO[0m[0m 03/04 23:24:04 | 0.341194    0.317177    0.735684    0.742378    0.840760    0.854469    0.843882    0.761587    0.769902    0.590995    0.613350    0.341194    0.317177    3400        34.256927   0.892490    0.408292    171.469843 
[37m[36mINFO[0m[0m 03/04 23:28:13 | 0.343956    0.312075    0.744741    0.759174    0.816326    0.863169    0.854430    0.762742    0.771957    0.608312    0.651134    0.343956    0.312075    3600        36.272040   0.882019    0.405880    167.751420 
[37m[36mINFO[0m[0m 03/04 23:32:19 | 0.349055    0.321429    0.757077    0.762714    0.797739    0.865805    0.860759    0.768776    0.772470    0.636650    0.654912    0.349055    0.321429    3800        38.287154   0.848200    0.407442    164.310243 
[37m[36mINFO[0m[0m 03/04 23:36:27 | 0.348842    0.323980    0.757378    0.771881    0.772357    0.868178    0.864979    0.767621    0.778120    0.636335    0.672544    0.348842    0.323980    4000        40.302267   0.816997    0.406705    167.241221 
[37m[36mINFO[0m[0m 03/04 23:40:38 | 0.366051    0.336735    0.765027    0.778852    0.756164    0.863696    0.861814    0.769547    0.785824    0.661839    0.688917    0.366051    0.336735    4200        42.317380   0.797792    0.404822    169.231340 
[37m[36mINFO[0m[0m 03/04 23:44:46 | 0.350967    0.324830    0.766639    0.785862    0.752268    0.862905    0.864979    0.777378    0.784797    0.659635    0.707809    0.350967    0.324830    4400        44.332494   0.771340    0.405358    167.365213 
[37m[36mINFO[0m[0m 03/04 23:48:52 | 0.351816    0.326531    0.775163    0.790026    0.720309    0.874506    0.868143    0.776865    0.785311    0.674118    0.716625    0.351816    0.326531    4600        46.347607   0.772164    0.408096    164.165607 
[37m[36mINFO[0m[0m 03/04 23:53:03 | 0.341406    0.316327    0.779892    0.790043    0.717292    0.873451    0.868143    0.776993    0.787879    0.689232    0.714106    0.341406    0.316327    4800        48.362720   0.754992    0.406887    169.881683 
[37m[36mINFO[0m[0m 03/04 23:57:17 | 0.352666    0.324830    0.782776    0.787078    0.702316    0.871606    0.867089    0.779304    0.786338    0.697418    0.707809    0.352666    0.324830    5000        50.377834   0.721978    0.403487    173.538714 
[37m[36mINFO[0m[0m 03/04 23:57:18 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250304_22-11-13_clip_vitb16_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/04 23:57:19 | ---
[37m[36mINFO[0m[0m 03/04 23:57:19 | test-domain validation(oracle) = 36.605%
[37m[36mINFO[0m[0m 03/04 23:57:19 | training-domain validation(iid) = 34.141%
[37m[36mINFO[0m[0m 03/04 23:57:19 | last = 35.267%
[37m[36mINFO[0m[0m 03/04 23:57:19 | last (inD) = 78.708%
[37m[36mINFO[0m[0m 03/04 23:57:19 | training-domain validation (iid, inD) = 79.004%
[37m[36mINFO[0m[0m 03/04 23:57:20 | === Summary ===
[37m[36mINFO[0m[0m 03/04 23:57:20 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_sgd config/clip_vitb16_sgd.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita
[37m[36mINFO[0m[0m 03/04 23:57:20 | Unique name: 250304_22-11-13_clip_vitb16_sgd
[37m[36mINFO[0m[0m 03/04 23:57:20 | Out path: train_output/TerraIncognita/ERM/[3]/250304_22-11-13_clip_vitb16_sgd
[37m[36mINFO[0m[0m 03/04 23:57:20 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/04 23:57:20 | Dataset: TerraIncognita

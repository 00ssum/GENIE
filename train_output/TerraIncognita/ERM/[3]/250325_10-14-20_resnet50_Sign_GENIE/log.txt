[37m[36mINFO[0m[0m 03/25 10:14:20 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 15
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 15
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250325_10-14-20_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250325_10-14-20_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 1.7812453400894684e-05
	batch_size: 36
	weight_decay: 3.1651536009272826e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/25 10:14:20 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 10:14:20 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 10:14:20 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 10:14:20 | 
[37m[36mINFO[0m[0m 03/25 10:14:20 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/25 10:14:20 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/25 10:14:20 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/25 10:14:20 | Batch sizes for each domain: [36, 36, 36, 0] (total=108)
[37m[36mINFO[0m[0m 03/25 10:14:20 | steps-per-epoch for each domain: 105.36, 216.36, 88.22 -> min = 88.22
[37m[36mINFO[0m[0m 03/25 10:14:21 | # of params = 23528522
[37m[36mINFO[0m[0m 03/25 10:17:44 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 10:17:44 | 0.217336    0.229592    0.291351    0.283001    2.021455    0.223833    0.179325    0.461933    0.455573    0.188287    0.214106    0.217336    0.229592    0           0.000000    2.443429    1.476007    200.989523 
[37m[36mINFO[0m[0m 03/25 10:22:13 | 0.191205    0.201531    0.671735    0.683755    0.908286    0.781439    0.776371    0.695982    0.675398    0.537783    0.599496    0.191205    0.201531    200         2.267003    1.213306    0.358327    197.136537 
[37m[36mINFO[0m[0m 03/25 10:26:36 | 0.268324    0.284864    0.760994    0.764291    0.680483    0.842605    0.845992    0.742329    0.725218    0.698048    0.721662    0.268324    0.284864    400         4.534005    0.775203    0.321596    199.215569 
[37m[36mINFO[0m[0m 03/25 10:30:34 | 0.281921    0.285714    0.792079    0.797011    0.573253    0.872924    0.854430    0.783541    0.793529    0.719773    0.743073    0.281921    0.285714    600         6.801008    0.601898    0.330129    172.082673 
[37m[36mINFO[0m[0m 03/25 10:34:16 | 0.346930    0.357993    0.837026    0.829578    0.458172    0.900606    0.890295    0.825523    0.826400    0.784950    0.772040    0.346930    0.357993    800         9.068010    0.519423    0.274069    167.389328 
[37m[36mINFO[0m[0m 03/25 10:38:12 | 0.345018    0.356293    0.842002    0.829833    0.471082    0.898761    0.880802    0.830017    0.822804    0.797229    0.785894    0.345018    0.356293    1000        11.335013   0.451024    0.345145    166.403879 
[37m[36mINFO[0m[0m 03/25 10:42:06 | 0.351816    0.364796    0.859411    0.841517    0.458721    0.909307    0.881857    0.846193    0.861839    0.822733    0.780856    0.351816    0.364796    1200        13.602015   0.402652    0.322436    169.199698 
[37m[36mINFO[0m[0m 03/25 10:45:58 | 0.324835    0.331633    0.856171    0.849350    0.415774    0.917743    0.896624    0.861728    0.870570    0.789043    0.780856    0.324835    0.331633    1400        15.869018   0.383714    0.320048    168.240784 
[37m[36mINFO[0m[0m 03/25 10:49:46 | 0.346718    0.363946    0.862206    0.845958    0.432317    0.916425    0.888186    0.853126    0.858757    0.817065    0.790932    0.346718    0.363946    1600        18.136020   0.370347    0.317353    164.873847 
[37m[36mINFO[0m[0m 03/25 10:54:12 | 0.353091    0.375000    0.890523    0.872565    0.364918    0.943844    0.918776    0.861856    0.877761    0.865869    0.821159    0.353091    0.375000    1800        20.403023   0.312174    0.329846    200.033844 
[37m[36mINFO[0m[0m 03/25 10:58:40 | 0.365626    0.388605    0.898380    0.883996    0.342803    0.947799    0.920886    0.876749    0.874679    0.870592    0.856423    0.365626    0.388605    2000        22.670025   0.309871    0.349726    197.886434 
[37m[36mINFO[0m[0m 03/25 11:03:09 | 0.375611    0.389456    0.912320    0.893644    0.315931    0.957026    0.912447    0.888561    0.893169    0.891373    0.875315    0.375611    0.389456    2200        24.937028   0.281938    0.364376    195.672296 
[37m[36mINFO[0m[0m 03/25 11:07:38 | 0.345868    0.365646    0.909868    0.889000    0.307563    0.952281    0.938819    0.890358    0.893169    0.886965    0.835013    0.345868    0.365646    2400        27.204030   0.275239    0.351701    199.310711 
[37m[36mINFO[0m[0m 03/25 11:12:02 | 0.331421    0.354592    0.917473    0.896676    0.297268    0.953599    0.928270    0.894852    0.883924    0.903967    0.877834    0.331421    0.354592    2600        29.471033   0.246213    0.353966    193.412840 
[37m[36mINFO[0m[0m 03/25 11:16:34 | 0.335458    0.352041    0.924159    0.909859    0.286104    0.954653    0.940928    0.904096    0.907036    0.913728    0.881612    0.335458    0.352041    2800        31.738035   0.242556    0.349347    201.879151 
[37m[36mINFO[0m[0m 03/25 11:21:02 | 0.337582    0.352041    0.925524    0.903833    0.275866    0.968626    0.935654    0.891385    0.882897    0.916562    0.892947    0.337582    0.352041    3000        34.005038   0.221046    0.350696    197.996475 
[37m[36mINFO[0m[0m 03/25 11:25:30 | 0.324410    0.340136    0.909055    0.890501    0.325467    0.953599    0.928270    0.874952    0.876733    0.898615    0.866499    0.324410    0.340136    3200        36.272040   0.220510    0.346316    198.641128 
[37m[36mINFO[0m[0m 03/25 11:29:56 | 0.317400    0.344388    0.923224    0.895636    0.297826    0.963090    0.919831    0.889074    0.885465    0.917506    0.881612    0.317400    0.344388    3400        38.539043   0.214527    0.357377    193.845495 
[37m[36mINFO[0m[0m 03/25 11:34:16 | 0.293180    0.301871    0.916283    0.903000    0.294710    0.950171    0.918776    0.894081    0.897278    0.904597    0.892947    0.293180    0.301871    3600        40.806045   0.196794    0.336937    192.811832 
[37m[36mINFO[0m[0m 03/25 11:38:41 | 0.372424    0.380952    0.928936    0.901357    0.280604    0.964408    0.926160    0.909616    0.898819    0.912783    0.879093    0.372424    0.380952    3800        43.073048   0.195953    0.354300    194.263546 
[37m[36mINFO[0m[0m 03/25 11:43:08 | 0.333971    0.340136    0.941845    0.920206    0.240069    0.970208    0.943038    0.919245    0.918336    0.936083    0.899244    0.333971    0.340136    4000        45.340050   0.181452    0.350147    197.391225 
[37m[36mINFO[0m[0m 03/25 11:47:27 | 0.299979    0.317177    0.923300    0.893789    0.334852    0.947799    0.914557    0.917191    0.897791    0.904912    0.869018    0.299979    0.317177    4200        47.607053   0.176682    0.332453    191.830374 
[37m[36mINFO[0m[0m 03/25 11:52:01 | 0.326110    0.340136    0.947508    0.916117    0.251946    0.977854    0.950422    0.920401    0.904982    0.944270    0.892947    0.326110    0.340136    4400        49.874055   0.176586    0.358366    202.279353 
[37m[36mINFO[0m[0m 03/25 11:56:23 | 0.323561    0.322279    0.946546    0.918775    0.231267    0.972581    0.943038    0.930030    0.917822    0.937028    0.895466    0.323561    0.322279    4600        52.141058   0.157452    0.350505    192.197204 
[37m[36mINFO[0m[0m 03/25 12:00:51 | 0.346080    0.353741    0.942544    0.912755    0.275824    0.969154    0.931435    0.919245    0.896251    0.939232    0.910579    0.346080    0.353741    4800        54.408060   0.154189    0.345476    199.094126 
[37m[36mINFO[0m[0m 03/25 12:05:11 | 0.398343    0.399660    0.945894    0.918106    0.266995    0.976008    0.950422    0.921813    0.900873    0.939861    0.903023    0.398343    0.399660    5000        56.675063   0.152995    0.348827    190.397960 
[37m[36mINFO[0m[0m 03/25 12:05:11 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250325_10-14-20_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 12:05:13 | ---
[37m[36mINFO[0m[0m 03/25 12:05:13 | test-domain validation(oracle) = 39.834%
[37m[36mINFO[0m[0m 03/25 12:05:13 | training-domain validation(iid) = 33.397%
[37m[36mINFO[0m[0m 03/25 12:05:13 | last = 39.834%
[37m[36mINFO[0m[0m 03/25 12:05:13 | last (inD) = 91.811%
[37m[36mINFO[0m[0m 03/25 12:05:13 | training-domain validation (iid, inD) = 92.021%
[37m[36mINFO[0m[0m 03/25 12:05:13 | === Summary ===
[37m[36mINFO[0m[0m 03/25 12:05:13 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 15
[37m[36mINFO[0m[0m 03/25 12:05:13 | Unique name: 250325_10-14-20_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 12:05:13 | Out path: train_output/TerraIncognita/ERM/[3]/250325_10-14-20_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 12:05:13 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 12:05:13 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 03/24 12:00:34 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250324_12-00-34_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250324_12-00-34_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 1.2332416678311953e-05
	batch_size: 13
	weight_decay: 0.0018634819595667504
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/24 12:00:34 | n_steps = 5001
[37m[36mINFO[0m[0m 03/24 12:00:34 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/24 12:00:34 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/24 12:00:34 | 
[37m[36mINFO[0m[0m 03/24 12:00:34 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/24 12:00:34 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/24 12:00:34 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/24 12:00:34 | Batch sizes for each domain: [13, 13, 13, 0] (total=39)
[37m[36mINFO[0m[0m 03/24 12:00:34 | steps-per-epoch for each domain: 291.77, 599.15, 244.31 -> min = 244.31
[37m[36mINFO[0m[0m 03/24 12:00:35 | # of params = 23528522
[37m[36mINFO[0m[0m 03/24 12:03:23 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/24 12:03:23 | 0.215636    0.231293    0.338188    0.294415    2.020250    0.365674    0.212025    0.461548    0.457114    0.187343    0.214106    0.215636    0.231293    0           0.000000    2.426247    1.156255    167.178447 
[37m[36mINFO[0m[0m 03/24 12:06:35 | 0.227958    0.232143    0.597124    0.613464    1.077553    0.715792    0.736287    0.633201    0.609142    0.442380    0.494962    0.227958    0.232143    200         0.818640    1.341484    0.126648    165.962439 
[37m[36mINFO[0m[0m 03/24 12:09:47 | 0.302103    0.277211    0.676340    0.683811    0.859392    0.727920    0.706751    0.710104    0.728814    0.590995    0.615869    0.302103    0.277211    400         1.637280    1.001782    0.141059    164.589027 
[37m[36mINFO[0m[0m 03/24 12:13:02 | 0.284257    0.286565    0.684656    0.677764    0.888161    0.773530    0.755274    0.739504    0.720082    0.540932    0.557935    0.284257    0.286565    600         2.455919    0.822690    0.154073    163.869754 
[37m[36mINFO[0m[0m 03/24 12:16:13 | 0.294455    0.306122    0.776870    0.794161    0.593542    0.860796    0.857595    0.773655    0.786852    0.696159    0.738035    0.294455    0.306122    800         3.274559    0.737970    0.136435    163.374014 
[37m[36mINFO[0m[0m 03/24 12:19:25 | 0.306565    0.308673    0.778942    0.777313    0.613882    0.868178    0.868143    0.775324    0.753467    0.693325    0.710327    0.306565    0.308673    1000        4.093199    0.624742    0.151227    161.863216 
[37m[36mINFO[0m[0m 03/24 12:22:44 | 0.390695    0.397109    0.797827    0.803353    0.542807    0.873978    0.878692    0.787136    0.783256    0.732368    0.748111    0.390695    0.397109    1200        4.911839    0.583107    0.150067    168.982550 
[37m[36mINFO[0m[0m 03/24 12:25:51 | 0.256427    0.265306    0.780720    0.780654    0.620989    0.855260    0.860759    0.748235    0.715460    0.738665    0.765743    0.256427    0.265306    1400        5.730479    0.566957    0.125024    161.945863 
[37m[36mINFO[0m[0m 03/24 12:29:04 | 0.333758    0.348639    0.802573    0.809616    0.549355    0.860269    0.856540    0.793041    0.816641    0.754408    0.755668    0.333758    0.348639    1600        6.549118    0.549438    0.143734    164.414537 
[37m[36mINFO[0m[0m 03/24 12:32:25 | 0.367325    0.350340    0.818139    0.817671    0.497887    0.891642    0.880802    0.807421    0.811505    0.755353    0.760705    0.367325    0.350340    1800        7.367758    0.521612    0.143344    172.302713 
[37m[36mINFO[0m[0m 03/24 12:35:35 | 0.390270    0.375850    0.826430    0.843917    0.443515    0.882679    0.893460    0.815124    0.842322    0.781486    0.795970    0.390270    0.375850    2000        8.186398    0.483330    0.138400    162.385231 
[37m[36mINFO[0m[0m 03/24 12:38:54 | 0.280008    0.286565    0.841832    0.835484    0.455677    0.898234    0.889241    0.834125    0.846430    0.793136    0.770781    0.280008    0.286565    2200        9.005038    0.441413    0.150415    168.946312 
[37m[36mINFO[0m[0m 03/24 12:42:12 | 0.408328    0.408163    0.845270    0.850967    0.431843    0.918798    0.907173    0.834895    0.862352    0.782116    0.783375    0.408328    0.408163    2400        9.823678    0.445438    0.139602    169.762877 
[37m[36mINFO[0m[0m 03/24 12:45:29 | 0.349904    0.342687    0.850399    0.839504    0.449384    0.906407    0.887131    0.835281    0.836672    0.809509    0.794710    0.349904    0.342687    2600        10.642317   0.428145    0.162846    164.634481 
[37m[36mINFO[0m[0m 03/24 12:48:46 | 0.358402    0.360544    0.843219    0.841848    0.447921    0.912998    0.895570    0.819746    0.828968    0.796914    0.801008    0.358402    0.360544    2800        11.460957   0.440089    0.158785    164.957613 
[37m[36mINFO[0m[0m 03/24 12:52:05 | 0.336733    0.343537    0.852911    0.856099    0.409983    0.915370    0.904008    0.842984    0.858243    0.800378    0.806045    0.336733    0.343537    3000        12.279597   0.413037    0.138897    171.716244 
[37m[36mINFO[0m[0m 03/24 12:55:25 | 0.333758    0.328231    0.834606    0.839820    0.443192    0.871606    0.864979    0.829632    0.845917    0.802582    0.808564    0.333758    0.328231    3200        13.098237   0.411464    0.129984    173.753848 
[37m[36mINFO[0m[0m 03/24 12:58:39 | 0.396643    0.406463    0.854456    0.850316    0.406433    0.924334    0.900844    0.827321    0.854135    0.811713    0.795970    0.396643    0.406463    3400        13.916877   0.387930    0.136092    166.795157 
[37m[36mINFO[0m[0m 03/24 13:01:58 | 0.328022    0.325680    0.856981    0.845292    0.428561    0.921171    0.895570    0.812556    0.802773    0.837217    0.837531    0.328022    0.325680    3600        14.735516   0.375234    0.165447    165.587427 
[37m[36mINFO[0m[0m 03/24 13:05:16 | 0.290631    0.306973    0.861998    0.859620    0.404152    0.918270    0.899789    0.842470    0.854135    0.825252    0.824937    0.290631    0.306973    3800        15.554156   0.368523    0.161034    166.044501 
[37m[36mINFO[0m[0m 03/24 13:08:28 | 0.336520    0.346939    0.866695    0.867498    0.382402    0.930662    0.914557    0.842599    0.856703    0.826826    0.831234    0.336520    0.346939    4000        16.372796   0.351779    0.151801    161.236962 
[37m[36mINFO[0m[0m 03/24 13:11:42 | 0.322074    0.322279    0.886148    0.875825    0.344784    0.939098    0.921941    0.868276    0.868002    0.851071    0.837531    0.322074    0.322279    4200        17.191436   0.343052    0.137795    166.507570 
[37m[36mINFO[0m[0m 03/24 13:14:51 | 0.321011    0.336735    0.890411    0.877202    0.351368    0.944371    0.929325    0.876107    0.882383    0.850756    0.819899    0.321011    0.336735    4400        18.010076   0.341392    0.124209    164.243673 
[37m[36mINFO[0m[0m 03/24 13:18:08 | 0.312938    0.328231    0.864370    0.842759    0.447670    0.899552    0.864979    0.850045    0.845917    0.843514    0.817380    0.312938    0.328231    4600        18.828715   0.345293    0.155741    166.202032 
[37m[36mINFO[0m[0m 03/24 13:21:20 | 0.334183    0.337585    0.890217    0.868353    0.371117    0.943053    0.917722    0.861728    0.864920    0.865869    0.822418    0.334183    0.337585    4800        19.647355   0.323477    0.160580    160.289053 
[37m[36mINFO[0m[0m 03/24 13:24:32 | 0.299766    0.314626    0.878870    0.851088    0.407865    0.917480    0.874473    0.860187    0.852594    0.858942    0.826196    0.299766    0.314626    5000        20.465995   0.324417    0.133805    164.739621 
[37m[36mINFO[0m[0m 03/24 13:24:32 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250324_12-00-34_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/24 13:24:33 | ---
[37m[36mINFO[0m[0m 03/24 13:24:33 | test-domain validation(oracle) = 40.833%
[37m[36mINFO[0m[0m 03/24 13:24:33 | training-domain validation(iid) = 32.101%
[37m[36mINFO[0m[0m 03/24 13:24:33 | last = 29.977%
[37m[36mINFO[0m[0m 03/24 13:24:33 | last (inD) = 85.109%
[37m[36mINFO[0m[0m 03/24 13:24:33 | training-domain validation (iid, inD) = 87.720%
[37m[36mINFO[0m[0m 03/24 13:24:34 | === Summary ===
[37m[36mINFO[0m[0m 03/24 13:24:34 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 1
[37m[36mINFO[0m[0m 03/24 13:24:34 | Unique name: 250324_12-00-34_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 13:24:34 | Out path: train_output/TerraIncognita/ERM/[3]/250324_12-00-34_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 13:24:34 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/24 13:24:34 | Dataset: TerraIncognita

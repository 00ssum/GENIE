[37m[36mINFO[0m[0m 03/26 10:21:31 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 15
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 15
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250326_10-21-31_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250326_10-21-31_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00023237243746776078
	batch_size: 13
	weight_decay: 1.8132449266758068e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/26 10:21:31 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 10:21:31 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 10:21:31 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 10:21:31 | 
[37m[36mINFO[0m[0m 03/26 10:21:31 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/26 10:21:31 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/26 10:21:31 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/26 10:21:31 | Batch sizes for each domain: [13, 13, 13, 0] (total=39)
[37m[36mINFO[0m[0m 03/26 10:21:31 | steps-per-epoch for each domain: 291.77, 599.15, 244.31 -> min = 244.31
[37m[36mINFO[0m[0m 03/26 10:21:32 | # of params = 23528522
[37m[36mINFO[0m[0m 03/26 10:24:14 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 10:24:14 | 0.222860    0.207483    0.288403    0.273706    2.105993    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.222860    0.207483    0           0.000000    2.441758    1.431236    160.719541 
[37m[36mINFO[0m[0m 03/26 10:27:31 | 0.199278    0.183673    0.547003    0.539061    1.244602    0.655945    0.693038    0.592117    0.563945    0.392947    0.360202    0.199278    0.183673    200         0.818640    1.432152    0.152616    166.126098 
[37m[36mINFO[0m[0m 03/26 10:30:41 | 0.240705    0.244898    0.608326    0.616273    1.094053    0.733193    0.725738    0.601233    0.600411    0.490554    0.522670    0.240705    0.244898    400         1.637280    1.196453    0.149760    160.383274 
[37m[36mINFO[0m[0m 03/26 10:33:55 | 0.328022    0.311224    0.691481    0.683309    0.918587    0.773003    0.765823    0.701631    0.695942    0.599811    0.588161    0.328022    0.311224    600         2.455919    1.050389    0.147321    164.384275 
[37m[36mINFO[0m[0m 03/26 10:37:20 | 0.336945    0.318878    0.748987    0.741287    0.715160    0.839441    0.822785    0.749775    0.727273    0.657746    0.673804    0.336945    0.318878    800         3.274559    0.806577    0.209831    163.175792 
[37m[36mINFO[0m[0m 03/26 10:40:34 | 0.278734    0.270408    0.744194    0.732992    0.733371    0.828895    0.830169    0.753499    0.739086    0.650189    0.629723    0.278734    0.270408    1000        4.093199    0.686227    0.144738    164.858117 
[37m[36mINFO[0m[0m 03/26 10:43:55 | 0.378798    0.369048    0.776689    0.764003    0.639831    0.870551    0.866034    0.785082    0.764766    0.674433    0.661209    0.378798    0.369048    1200        4.911839    0.652014    0.161622    169.218976 
[37m[36mINFO[0m[0m 03/26 10:47:09 | 0.298067    0.290816    0.797931    0.789499    0.580917    0.880042    0.862869    0.795866    0.794042    0.717884    0.711587    0.298067    0.290816    1400        5.730479    0.598785    0.152123    163.378962 
[37m[36mINFO[0m[0m 03/26 10:50:42 | 0.382409    0.368197    0.803484    0.794271    0.572051    0.889270    0.869198    0.799204    0.803287    0.721977    0.710327    0.382409    0.368197    1600        6.549118    0.585012    0.240863    164.734748 
[37m[36mINFO[0m[0m 03/26 10:53:52 | 0.348205    0.335034    0.812254    0.807874    0.540313    0.889533    0.870253    0.794710    0.814073    0.752519    0.739295    0.348205    0.335034    1800        7.367758    0.546597    0.128280    164.340835 
[37m[36mINFO[0m[0m 03/26 10:57:01 | 0.312513    0.284864    0.815514    0.811438    0.532433    0.890588    0.856540    0.809732    0.825886    0.746222    0.751889    0.312513    0.284864    2000        8.186398    0.527055    0.133378    162.258064 
[37m[36mINFO[0m[0m 03/26 11:00:15 | 0.321011    0.314626    0.834247    0.814113    0.506352    0.906670    0.880802    0.826550    0.819723    0.769521    0.741814    0.321011    0.314626    2200        9.005038    0.484286    0.135127    166.935208 
[37m[36mINFO[0m[0m 03/26 11:03:24 | 0.298067    0.271259    0.828798    0.824547    0.501492    0.900870    0.880802    0.818205    0.823318    0.767317    0.769521    0.298067    0.271259    2400        9.823678    0.471561    0.153271    157.962887 
[37m[36mINFO[0m[0m 03/26 11:06:53 | 0.338220    0.315476    0.838878    0.830334    0.489832    0.905879    0.872363    0.827064    0.828968    0.783690    0.789673    0.338220    0.315476    2600        10.642317   0.442225    0.216169    166.265578 
[37m[36mINFO[0m[0m 03/26 11:10:09 | 0.381134    0.351190    0.832367    0.819570    0.498876    0.902979    0.883966    0.823341    0.825372    0.770781    0.749370    0.381134    0.351190    2800        11.460957   0.454212    0.153200    165.309547 
[37m[36mINFO[0m[0m 03/26 11:13:23 | 0.351179    0.331633    0.855085    0.837660    0.450270    0.921434    0.893460    0.833997    0.822291    0.809824    0.797229    0.351179    0.331633    3000        12.279597   0.424542    0.163023    161.448812 
[37m[36mINFO[0m[0m 03/26 11:16:32 | 0.365201    0.349490    0.853828    0.843114    0.449468    0.928553    0.909283    0.837591    0.850539    0.795340    0.769521    0.365201    0.349490    3200        13.098237   0.401877    0.156237    157.458056 
[37m[36mINFO[0m[0m 03/26 11:19:53 | 0.330784    0.310374    0.842053    0.828240    0.497910    0.927234    0.899789    0.834125    0.844376    0.764798    0.740554    0.330784    0.310374    3400        13.916877   0.404631    0.211494    158.354423 
[37m[36mINFO[0m[0m 03/26 11:23:00 | 0.347143    0.308673    0.873304    0.864431    0.390351    0.931716    0.896624    0.852869    0.865434    0.835327    0.831234    0.347143    0.308673    3600        14.735516   0.392383    0.126872    162.155680 
[37m[36mINFO[0m[0m 03/26 11:26:08 | 0.370512    0.355442    0.856168    0.841221    0.425795    0.935935    0.900844    0.821800    0.810478    0.810768    0.812343    0.370512    0.355442    3800        15.554156   0.353205    0.135768    160.359535 
[37m[36mINFO[0m[0m 03/26 11:29:27 | 0.371574    0.354592    0.859157    0.835059    0.470935    0.914579    0.892405    0.840159    0.838213    0.822733    0.774559    0.371574    0.354592    4000        16.372796   0.368777    0.187008    161.588746 
[37m[36mINFO[0m[0m 03/26 11:32:40 | 0.342044    0.323129    0.863031    0.841066    0.439294    0.909834    0.872363    0.846450    0.839753    0.832809    0.811083    0.342044    0.323129    4200        17.191436   0.362923    0.154825    162.345005 
[37m[36mINFO[0m[0m 03/26 11:35:53 | 0.351392    0.323980    0.877664    0.864843    0.373576    0.938307    0.925105    0.856207    0.863380    0.838476    0.806045    0.351392    0.323980    4400        18.010076   0.349478    0.159902    160.704883 
[37m[36mINFO[0m[0m 03/26 11:39:10 | 0.359252    0.348639    0.874904    0.855990    0.411801    0.925653    0.909283    0.861215    0.855162    0.837846    0.803526    0.359252    0.348639    4600        18.828715   0.358221    0.175778    161.856252 
[37m[36mINFO[0m[0m 03/26 11:42:20 | 0.343106    0.325680    0.878538    0.861082    0.395029    0.939098    0.910338    0.856464    0.847971    0.840050    0.824937    0.343106    0.325680    4800        19.647355   0.341426    0.129121    164.336730 
[37m[36mINFO[0m[0m 03/26 11:45:30 | 0.391545    0.375000    0.858538    0.832386    0.477024    0.894543    0.873418    0.865580    0.845403    0.815491    0.778338    0.391545    0.375000    5000        20.465995   0.316464    0.126913    164.808300 
[37m[36mINFO[0m[0m 03/26 11:45:30 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250326_10-21-31_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 11:45:32 | ---
[37m[36mINFO[0m[0m 03/26 11:45:32 | test-domain validation(oracle) = 39.154%
[37m[36mINFO[0m[0m 03/26 11:45:32 | training-domain validation(iid) = 35.139%
[37m[36mINFO[0m[0m 03/26 11:45:32 | last = 39.154%
[37m[36mINFO[0m[0m 03/26 11:45:32 | last (inD) = 83.239%
[37m[36mINFO[0m[0m 03/26 11:45:32 | training-domain validation (iid, inD) = 86.484%
[37m[36mINFO[0m[0m 03/26 11:45:32 | === Summary ===
[37m[36mINFO[0m[0m 03/26 11:45:32 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 15
[37m[36mINFO[0m[0m 03/26 11:45:32 | Unique name: 250326_10-21-31_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 11:45:32 | Out path: train_output/TerraIncognita/ERM/[3]/250326_10-21-31_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 11:45:32 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 11:45:32 | Dataset: TerraIncognita

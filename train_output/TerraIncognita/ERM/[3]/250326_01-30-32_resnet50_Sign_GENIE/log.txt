[37m[36mINFO[0m[0m 03/26 01:30:32 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 7
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 7
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250326_01-30-32_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250326_01-30-32_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00023761560100715143
	batch_size: 20
	weight_decay: 4.1733891298839565e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/26 01:30:32 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 01:30:32 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 01:30:32 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 01:30:32 | 
[37m[36mINFO[0m[0m 03/26 01:30:32 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/26 01:30:32 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/26 01:30:32 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/26 01:30:32 | Batch sizes for each domain: [20, 20, 20, 0] (total=60)
[37m[36mINFO[0m[0m 03/26 01:30:32 | steps-per-epoch for each domain: 189.65, 389.45, 158.80 -> min = 158.80
[37m[36mINFO[0m[0m 03/26 01:30:33 | # of params = 23528522
[37m[36mINFO[0m[0m 03/26 01:33:27 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 01:33:27 | 0.222860    0.207483    0.288403    0.273706    2.122510    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.222860    0.207483    0           0.000000    2.469016    1.183870    172.546515 
[37m[36mINFO[0m[0m 03/26 01:36:55 | 0.202677    0.197279    0.572890    0.578624    1.205983    0.703928    0.722574    0.602902    0.576271    0.411839    0.437028    0.202677    0.197279    200         1.259446    1.366188    0.192735    168.826607 
[37m[36mINFO[0m[0m 03/26 01:40:14 | 0.283195    0.262755    0.686864    0.682297    0.874927    0.784867    0.789030    0.697009    0.667180    0.578715    0.590680    0.283195    0.262755    400         2.518892    1.066136    0.185555    162.723350 
[37m[36mINFO[0m[0m 03/26 01:43:54 | 0.319737    0.317177    0.738574    0.728376    0.762707    0.833641    0.812236    0.730004    0.715460    0.652078    0.657431    0.319737    0.317177    600         3.778338    0.783300    0.226525    174.361994 
[37m[36mINFO[0m[0m 03/26 01:47:22 | 0.318462    0.286565    0.772308    0.759309    0.656851    0.853678    0.836498    0.756066    0.729841    0.707179    0.711587    0.318462    0.286565    800         5.037783    0.688416    0.178689    172.528842 
[37m[36mINFO[0m[0m 03/26 01:50:51 | 0.344168    0.333333    0.798147    0.786374    0.586466    0.877933    0.859705    0.775324    0.785311    0.741184    0.714106    0.344168    0.333333    1000        6.297229    0.601838    0.204945    167.857362 
[37m[36mINFO[0m[0m 03/26 01:54:21 | 0.318462    0.306122    0.806620    0.795309    0.549556    0.892697    0.864979    0.785980    0.765280    0.741184    0.755668    0.318462    0.306122    1200        7.556675    0.511664    0.215632    166.618973 
[37m[36mINFO[0m[0m 03/26 01:57:51 | 0.374336    0.347789    0.825372    0.811761    0.516689    0.882679    0.864979    0.827064    0.817155    0.766373    0.753149    0.374336    0.347789    1400        8.816121    0.501423    0.192414    171.184599 
[37m[36mINFO[0m[0m 03/26 02:01:17 | 0.324198    0.314626    0.833867    0.816271    0.501404    0.903243    0.875527    0.827577    0.815100    0.770781    0.758186    0.324198    0.314626    1600        10.075567   0.457801    0.183104    170.093561 
[37m[36mINFO[0m[0m 03/26 02:04:50 | 0.321011    0.303571    0.849024    0.842507    0.442070    0.916689    0.881857    0.829375    0.845917    0.801008    0.799748    0.321011    0.303571    1800        11.335013   0.445818    0.239441    165.251251 
[37m[36mINFO[0m[0m 03/26 02:08:16 | 0.387933    0.386054    0.846431    0.821752    0.471584    0.895861    0.877637    0.843369    0.826913    0.800063    0.760705    0.387933    0.386054    2000        12.594458   0.423927    0.185898    168.529039 
[37m[36mINFO[0m[0m 03/26 02:11:41 | 0.313151    0.289116    0.860259    0.840089    0.428339    0.919852    0.897679    0.829375    0.811505    0.831549    0.811083    0.313151    0.289116    2200        13.853904   0.400865    0.201912    164.799860 
[37m[36mINFO[0m[0m 03/26 02:15:12 | 0.319949    0.299320    0.872003    0.857567    0.398952    0.923280    0.893460    0.849531    0.836672    0.843199    0.842569    0.319949    0.299320    2400        15.113350   0.397266    0.220624    166.198536 
[37m[36mINFO[0m[0m 03/26 02:18:43 | 0.292755    0.277211    0.869866    0.851497    0.417411    0.930925    0.883966    0.842085    0.841808    0.836587    0.828715    0.292755    0.277211    2600        16.372796   0.364223    0.196343    171.629086 
[37m[36mINFO[0m[0m 03/26 02:22:11 | 0.332059    0.309524    0.878350    0.856011    0.390919    0.934616    0.901899    0.844011    0.836158    0.856423    0.829975    0.332059    0.309524    2800        17.632242   0.357704    0.193705    169.407429 
[37m[36mINFO[0m[0m 03/26 02:25:43 | 0.370937    0.365646    0.877841    0.846723    0.422126    0.941735    0.914557    0.866222    0.851053    0.825567    0.774559    0.370937    0.365646    3000        18.891688   0.335050    0.228130    166.841971 
[37m[36mINFO[0m[0m 03/26 02:29:07 | 0.338007    0.318878    0.894419    0.879239    0.368978    0.936462    0.909283    0.877776    0.866975    0.869018    0.861461    0.338007    0.318878    3200        20.151134   0.320508    0.192626    165.615235 
[37m[36mINFO[0m[0m 03/26 02:32:30 | 0.391332    0.372449    0.882376    0.868651    0.390881    0.941471    0.906118    0.857106    0.859784    0.848552    0.840050    0.391332    0.372449    3400        21.410579   0.300671    0.197042    163.689014 
[37m[36mINFO[0m[0m 03/26 02:36:02 | 0.329509    0.316327    0.889438    0.871442    0.355710    0.934880    0.905063    0.867249    0.865434    0.866184    0.843829    0.329509    0.316327    3600        22.670025   0.281565    0.221215    167.611981 
[37m[36mINFO[0m[0m 03/26 02:39:26 | 0.399618    0.371599    0.899168    0.883538    0.334586    0.946744    0.927215    0.877648    0.866975    0.873111    0.856423    0.399618    0.371599    3800        23.929471   0.303624    0.192441    165.493278 
[37m[36mINFO[0m[0m 03/26 02:42:53 | 0.331634    0.321429    0.902524    0.888657    0.328103    0.945953    0.927215    0.882527    0.879815    0.879093    0.858942    0.331634    0.321429    4000        25.188917   0.285735    0.201348    166.046863 
[37m[36mINFO[0m[0m 03/26 02:46:24 | 0.330784    0.306973    0.897620    0.878279    0.356131    0.938044    0.914557    0.875722    0.875193    0.879093    0.845088    0.330784    0.306973    4200        26.448363   0.269672    0.214738    168.782368 
[37m[36mINFO[0m[0m 03/26 02:49:50 | 0.332696    0.316327    0.911223    0.886026    0.321699    0.961772    0.928270    0.886507    0.885978    0.885390    0.843829    0.332696    0.316327    4400        27.707809   0.279434    0.194919    166.493396 
[37m[36mINFO[0m[0m 03/26 02:53:14 | 0.325685    0.314626    0.905718    0.884344    0.351503    0.947271    0.914557    0.876621    0.878274    0.893262    0.860202    0.325685    0.314626    4600        28.967254   0.256834    0.206366    162.559702 
[37m[36mINFO[0m[0m 03/26 02:56:42 | 0.376673    0.370748    0.905692    0.876177    0.392824    0.948590    0.907173    0.892541    0.878788    0.875945    0.842569    0.376673    0.370748    4800        30.226700   0.258434    0.206952    166.560206 
[37m[36mINFO[0m[0m 03/26 03:00:04 | 0.369025    0.355442    0.927069    0.901672    0.284581    0.970208    0.938819    0.899474    0.892142    0.911524    0.874055    0.369025    0.355442    5000        31.486146   0.229765    0.186300    165.247120 
[37m[36mINFO[0m[0m 03/26 03:00:04 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250326_01-30-32_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 03:00:06 | ---
[37m[36mINFO[0m[0m 03/26 03:00:06 | test-domain validation(oracle) = 38.793%
[37m[36mINFO[0m[0m 03/26 03:00:06 | training-domain validation(iid) = 36.902%
[37m[36mINFO[0m[0m 03/26 03:00:06 | last = 36.902%
[37m[36mINFO[0m[0m 03/26 03:00:06 | last (inD) = 90.167%
[37m[36mINFO[0m[0m 03/26 03:00:06 | training-domain validation (iid, inD) = 90.167%
[37m[36mINFO[0m[0m 03/26 03:00:06 | === Summary ===
[37m[36mINFO[0m[0m 03/26 03:00:06 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 7
[37m[36mINFO[0m[0m 03/26 03:00:06 | Unique name: 250326_01-30-32_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 03:00:06 | Out path: train_output/TerraIncognita/ERM/[3]/250326_01-30-32_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 03:00:06 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 03:00:06 | Dataset: TerraIncognita

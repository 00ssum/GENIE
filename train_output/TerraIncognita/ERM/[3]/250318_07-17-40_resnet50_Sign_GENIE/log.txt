[37m[36mINFO[0m[0m 03/18 07:17:40 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250318_07-17-40_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250318_07-17-40_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/18 07:17:41 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 07:17:41 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 07:17:41 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 07:17:41 | 
[37m[36mINFO[0m[0m 03/18 07:17:41 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/18 07:17:41 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/18 07:17:41 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/18 07:17:41 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 03/18 07:17:41 | steps-per-epoch for each domain: 118.53, 243.41, 99.25 -> min = 99.25
[37m[36mINFO[0m[0m 03/18 07:17:42 | # of params = 23528522
[37m[36mINFO[0m[0m 03/18 07:20:25 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 07:20:25 | 0.211600    0.200680    0.357352    0.390072    1.961203    0.444767    0.467300    0.454744    0.481253    0.172544    0.221662    0.211600    0.200680    0           0.000000    2.440448    1.095860    161.855224 
[37m[36mINFO[0m[0m 03/18 07:23:59 | 0.249841    0.262755    0.684343    0.680249    0.909232    0.794358    0.775316    0.677751    0.681048    0.580919    0.584383    0.249841    0.262755    200         2.015113    1.227010    0.248865    164.183195 
[37m[36mINFO[0m[0m 03/18 07:27:35 | 0.352029    0.357143    0.760304    0.747470    0.704017    0.842868    0.829114    0.768648    0.773498    0.669395    0.639798    0.352029    0.357143    400         4.030227    0.770400    0.269398    161.952444 
[37m[36mINFO[0m[0m 03/18 07:31:13 | 0.357977    0.361395    0.792388    0.789107    0.603280    0.870815    0.841772    0.774297    0.795069    0.732053    0.730479    0.357977    0.361395    600         6.045340    0.628176    0.275355    163.156419 
[37m[36mINFO[0m[0m 03/18 07:34:43 | 0.321224    0.318878    0.827053    0.827874    0.493136    0.887161    0.873418    0.816921    0.835645    0.777078    0.774559    0.321224    0.318878    800         8.060453    0.531613    0.243398    161.822453 
[37m[36mINFO[0m[0m 03/18 07:38:27 | 0.340344    0.340136    0.842053    0.822140    0.490994    0.901661    0.858650    0.821286    0.826913    0.803212    0.780856    0.340344    0.340136    1000        10.075567   0.478607    0.276603    168.052291 
[37m[36mINFO[0m[0m 03/18 07:42:08 | 0.361377    0.353741    0.846359    0.831214    0.468324    0.902188    0.898734    0.843754    0.839240    0.793136    0.755668    0.361377    0.353741    1200        12.090680   0.421018    0.273535    166.525081 
[37m[36mINFO[0m[0m 03/18 07:45:42 | 0.364776    0.351190    0.842902    0.829381    0.468364    0.900079    0.880802    0.809988    0.817668    0.818640    0.789673    0.364776    0.351190    1400        14.105793   0.396208    0.239387    165.927497 
[37m[36mINFO[0m[0m 03/18 07:49:22 | 0.395369    0.404762    0.861416    0.845783    0.420067    0.914316    0.896624    0.836179    0.851053    0.833753    0.789673    0.395369    0.404762    1600        16.120907   0.379698    0.272089    165.645169 
[37m[36mINFO[0m[0m 03/18 07:52:59 | 0.343743    0.347789    0.888240    0.865000    0.374448    0.928553    0.902954    0.862113    0.860812    0.874055    0.831234    0.343743    0.347789    1800        18.136020   0.355620    0.255446    165.804691 
[37m[36mINFO[0m[0m 03/18 07:56:43 | 0.374761    0.377551    0.883557    0.863275    0.390043    0.931716    0.906118    0.860958    0.872625    0.857997    0.811083    0.374761    0.377551    2000        20.151134   0.316053    0.273090    169.213945 
[37m[36mINFO[0m[0m 03/18 08:00:12 | 0.346505    0.331633    0.894987    0.881931    0.343949    0.947008    0.926160    0.863269    0.880842    0.874685    0.838791    0.346505    0.331633    2200        22.166247   0.304628    0.242743    160.268972 
[37m[36mINFO[0m[0m 03/18 08:03:39 | 0.366263    0.350340    0.897085    0.877686    0.346594    0.953862    0.928270    0.876878    0.868516    0.860516    0.836272    0.366263    0.350340    2400        24.181360   0.278198    0.236696    160.199450 
[37m[36mINFO[0m[0m 03/18 08:07:10 | 0.335458    0.348639    0.909578    0.879268    0.347276    0.949380    0.932489    0.891129    0.882897    0.888224    0.822418    0.335458    0.348639    2600        26.196474   0.272452    0.234632    164.464722 
[37m[36mINFO[0m[0m 03/18 08:10:44 | 0.371574    0.354592    0.899090    0.871729    0.363585    0.929607    0.898734    0.885736    0.872625    0.881927    0.843829    0.371574    0.354592    2800        28.211587   0.256600    0.239060    165.962892 
[37m[36mINFO[0m[0m 03/18 08:14:16 | 0.349267    0.344388    0.916847    0.892174    0.323378    0.955444    0.934599    0.891129    0.874165    0.903967    0.867758    0.349267    0.344388    3000        30.226700   0.231369    0.239377    163.521052 
[37m[36mINFO[0m[0m 03/18 08:17:44 | 0.382409    0.396259    0.907703    0.887132    0.330478    0.953071    0.930380    0.881500    0.883410    0.888539    0.847607    0.382409    0.396259    3200        32.241814   0.231979    0.235154    161.074360 
[37m[36mINFO[0m[0m 03/18 08:21:18 | 0.360952    0.360544    0.912430    0.886081    0.317338    0.956235    0.934599    0.891257    0.879815    0.889798    0.843829    0.360952    0.360544    3400        34.256927   0.242432    0.232194    167.921705 
[37m[36mINFO[0m[0m 03/18 08:24:46 | 0.363501    0.357143    0.922425    0.902789    0.297737    0.962563    0.934599    0.900116    0.906009    0.904597    0.867758    0.363501    0.357143    3600        36.272040   0.220905    0.230955    161.786256 
[37m[36mINFO[0m[0m 03/18 08:28:13 | 0.369237    0.376701    0.931706    0.905229    0.280981    0.967045    0.945148    0.903325    0.895223    0.924748    0.875315    0.369237    0.376701    3800        38.287154   0.212376    0.232622    160.668824 
[37m[36mINFO[0m[0m 03/18 08:31:42 | 0.352029    0.335884    0.925789    0.898087    0.293114    0.965199    0.932489    0.904737    0.897791    0.907431    0.863980    0.352029    0.335884    4000        40.302267   0.202124    0.235259    161.847450 
[37m[36mINFO[0m[0m 03/18 08:35:09 | 0.391969    0.375850    0.932922    0.905688    0.271772    0.972317    0.944093    0.913981    0.903955    0.912469    0.869018    0.391969    0.375850    4200        42.317380   0.202021    0.233016    160.578471 
[37m[36mINFO[0m[0m 03/18 08:38:38 | 0.368175    0.364796    0.940731    0.914345    0.283123    0.975745    0.947257    0.912569    0.897791    0.933879    0.897985    0.368175    0.364796    4400        44.332494   0.182614    0.231739    162.630513 
[37m[36mINFO[0m[0m 03/18 08:42:08 | 0.350542    0.337585    0.942018    0.920782    0.248817    0.972054    0.948312    0.922326    0.917309    0.931675    0.896725    0.350542    0.337585    4600        46.347607   0.168984    0.234879    162.400606 
[37m[36mINFO[0m[0m 03/18 08:45:36 | 0.349055    0.341837    0.931699    0.903376    0.295043    0.968363    0.943038    0.918988    0.899332    0.907746    0.867758    0.349055    0.341837    4800        48.362720   0.166108    0.227992    162.831553 
[37m[36mINFO[0m[0m 03/18 08:49:06 | 0.393244    0.389456    0.941517    0.910276    0.273136    0.966781    0.941983    0.925151    0.917309    0.932620    0.871537    0.393244    0.389456    5000        50.377834   0.162352    0.230734    163.852641 
[37m[36mINFO[0m[0m 03/18 08:49:06 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250318_07-17-40_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 08:49:08 | ---
[37m[36mINFO[0m[0m 03/18 08:49:08 | test-domain validation(oracle) = 39.537%
[37m[36mINFO[0m[0m 03/18 08:49:08 | training-domain validation(iid) = 35.054%
[37m[36mINFO[0m[0m 03/18 08:49:08 | last = 39.324%
[37m[36mINFO[0m[0m 03/18 08:49:08 | last (inD) = 91.028%
[37m[36mINFO[0m[0m 03/18 08:49:08 | training-domain validation (iid, inD) = 92.078%
[37m[36mINFO[0m[0m 03/18 08:49:08 | === Summary ===
[37m[36mINFO[0m[0m 03/18 08:49:08 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita
[37m[36mINFO[0m[0m 03/18 08:49:08 | Unique name: 250318_07-17-40_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 08:49:08 | Out path: train_output/TerraIncognita/ERM/[3]/250318_07-17-40_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 08:49:08 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 08:49:08 | Dataset: TerraIncognita

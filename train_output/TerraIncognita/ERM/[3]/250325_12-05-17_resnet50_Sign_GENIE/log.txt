[37m[36mINFO[0m[0m 03/25 12:05:17 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 16
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 16
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250325_12-05-17_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250325_12-05-17_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 1.3198033474735314e-05
	batch_size: 10
	weight_decay: 0.001844990356992375
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/25 12:05:17 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 12:05:17 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 12:05:17 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 12:05:17 | 
[37m[36mINFO[0m[0m 03/25 12:05:18 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/25 12:05:18 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/25 12:05:18 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/25 12:05:18 | Batch sizes for each domain: [10, 10, 10, 0] (total=30)
[37m[36mINFO[0m[0m 03/25 12:05:18 | steps-per-epoch for each domain: 379.30, 778.90, 317.60 -> min = 317.60
[37m[36mINFO[0m[0m 03/25 12:05:19 | # of params = 23528522
[37m[36mINFO[0m[0m 03/25 12:08:30 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 12:08:30 | 0.217336    0.229592    0.287221    0.283001    2.020737    0.211442    0.179325    0.461933    0.455573    0.188287    0.214106    0.217336    0.229592    0           0.000000    2.465577    1.002145    189.994953 
[37m[36mINFO[0m[0m 03/25 12:12:13 | 0.234757    0.244048    0.470553    0.487604    1.279397    0.517796    0.548523    0.554757    0.549050    0.339106    0.365239    0.234757    0.244048    200         0.629723    1.389862    0.162427    190.747949 
[37m[36mINFO[0m[0m 03/25 12:16:01 | 0.304015    0.315476    0.625322    0.659582    0.985240    0.760348    0.776371    0.665682    0.689779    0.449937    0.512594    0.304015    0.315476    400         1.259446    1.155445    0.153845    197.258388 
[37m[36mINFO[0m[0m 03/25 12:19:58 | 0.328659    0.334184    0.686757    0.689793    0.845532    0.798576    0.783755    0.711003    0.722650    0.550693    0.562972    0.328659    0.334184    600         1.889169    0.969819    0.200579    197.068389 
[37m[36mINFO[0m[0m 03/25 12:23:56 | 0.334820    0.337585    0.715566    0.735789    0.748762    0.785658    0.783755    0.726281    0.733436    0.634761    0.690176    0.334820    0.337585    800         2.518892    0.834687    0.160184    205.303489 
[37m[36mINFO[0m[0m 03/25 12:27:40 | 0.333546    0.350340    0.746503    0.760145    0.694548    0.843659    0.839662    0.751958    0.774525    0.643892    0.666247    0.333546    0.350340    1000        3.148615    0.734390    0.156062    192.936301 
[37m[36mINFO[0m[0m 03/25 12:31:36 | 0.380072    0.388605    0.763910    0.783627    0.620552    0.845769    0.848101    0.767749    0.789933    0.678212    0.712846    0.380072    0.388605    1200        3.778338    0.701058    0.184992    199.117447 
[37m[36mINFO[0m[0m 03/25 12:35:23 | 0.346930    0.356293    0.780457    0.781468    0.589767    0.854469    0.825949    0.778149    0.793015    0.708753    0.725441    0.346930    0.356293    1400        4.408060    0.654712    0.140008    199.081488 
[37m[36mINFO[0m[0m 03/25 12:39:06 | 0.326747    0.340986    0.780411    0.785180    0.603642    0.882679    0.875527    0.767749    0.784797    0.690806    0.695214    0.326747    0.340986    1600        5.037783    0.618282    0.161692    191.019292 
[37m[36mINFO[0m[0m 03/25 12:42:53 | 0.323986    0.339286    0.793844    0.795492    0.549119    0.866069    0.848101    0.779946    0.794042    0.735516    0.744332    0.323986    0.339286    1800        5.667506    0.590565    0.168641    192.731732 
[37m[36mINFO[0m[0m 03/25 12:46:38 | 0.330571    0.335884    0.807902    0.819517    0.530249    0.891642    0.892405    0.788676    0.810478    0.743388    0.755668    0.330571    0.335884    2000        6.297229    0.554350    0.156285    193.964147 
[37m[36mINFO[0m[0m 03/25 12:50:32 | 0.413427    0.417517    0.812997    0.818323    0.513842    0.903770    0.889241    0.799076    0.815100    0.736146    0.750630    0.413427    0.417517    2200        6.926952    0.565918    0.161420    201.683238 
[37m[36mINFO[0m[0m 03/25 12:54:32 | 0.398980    0.404762    0.817117    0.821780    0.500291    0.900343    0.893460    0.781487    0.807396    0.769521    0.764484    0.398980    0.404762    2400        7.556675    0.545452    0.201007    200.094742 
[37m[36mINFO[0m[0m 03/25 12:58:22 | 0.313788    0.318027    0.785432    0.789714    0.624082    0.855787    0.854430    0.775067    0.781715    0.725441    0.732997    0.313788    0.318027    2600        8.186398    0.516162    0.152554    199.585783 
[37m[36mINFO[0m[0m 03/25 13:02:15 | 0.409178    0.382653    0.807378    0.819745    0.525109    0.881097    0.876582    0.793555    0.804314    0.747481    0.778338    0.409178    0.382653    2800        8.816121    0.520759    0.179820    197.050872 
[37m[36mINFO[0m[0m 03/25 13:06:17 | 0.358615    0.361395    0.811702    0.819699    0.513591    0.895334    0.895570    0.803312    0.805342    0.736461    0.758186    0.358615    0.361395    3000        9.445844    0.494616    0.195306    202.102124 
[37m[36mINFO[0m[0m 03/25 13:10:06 | 0.349055    0.354592    0.821245    0.839745    0.482274    0.904297    0.891350    0.807549    0.838213    0.751889    0.789673    0.349055    0.354592    3200        10.075567   0.465822    0.144816    200.097834 
[37m[36mINFO[0m[0m 03/25 13:13:49 | 0.315912    0.340986    0.839663    0.836149    0.451590    0.916425    0.898734    0.810374    0.809964    0.792191    0.799748    0.315912    0.340986    3400        10.705290   0.458335    0.183893    186.892851 
[37m[36mINFO[0m[0m 03/25 13:17:31 | 0.368600    0.380102    0.844123    0.852243    0.423702    0.904825    0.895570    0.839132    0.852594    0.788413    0.808564    0.368600    0.380102    3600        11.335013   0.431867    0.160844    189.872375 
[37m[36mINFO[0m[0m 03/25 13:21:15 | 0.335458    0.347789    0.846890    0.860063    0.411947    0.915634    0.906118    0.823084    0.842835    0.801952    0.831234    0.335458    0.347789    3800        11.964736   0.446102    0.147613    194.291926 
[37m[36mINFO[0m[0m 03/25 13:25:00 | 0.414064    0.424320    0.847282    0.853940    0.410467    0.905879    0.897679    0.828348    0.850539    0.807620    0.813602    0.414064    0.424320    4000        12.594458   0.405066    0.148015    195.366799 
[37m[36mINFO[0m[0m 03/25 13:28:46 | 0.422350    0.422619    0.839094    0.844449    0.463663    0.915634    0.907173    0.841571    0.854135    0.760076    0.772040    0.422350    0.422619    4200        13.224181   0.414174    0.133242    199.257131 
[37m[36mINFO[0m[0m 03/25 13:32:41 | 0.293818    0.313776    0.853273    0.854033    0.427340    0.911152    0.900844    0.843882    0.857730    0.804786    0.803526    0.293818    0.313776    4400        13.853904   0.403950    0.154738    204.548129 
[37m[36mINFO[0m[0m 03/25 13:36:45 | 0.304228    0.305272    0.856015    0.849586    0.412146    0.926707    0.908228    0.835922    0.840781    0.805416    0.799748    0.304228    0.305272    4600        14.483627   0.389144    0.163727    210.800147 
[37m[36mINFO[0m[0m 03/25 13:40:33 | 0.300829    0.308673    0.833430    0.826289    0.456097    0.905088    0.898734    0.817178    0.804314    0.778023    0.775819    0.300829    0.308673    4800        15.113350   0.388136    0.162584    195.784418 
[37m[36mINFO[0m[0m 03/25 13:44:21 | 0.383047    0.385204    0.867728    0.860293    0.417694    0.927762    0.915612    0.846707    0.856703    0.828715    0.808564    0.383047    0.385204    5000        15.743073   0.396754    0.157715    195.680435 
[37m[36mINFO[0m[0m 03/25 13:44:21 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250325_12-05-17_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 13:44:22 | ---
[37m[36mINFO[0m[0m 03/25 13:44:22 | test-domain validation(oracle) = 41.406%
[37m[36mINFO[0m[0m 03/25 13:44:22 | training-domain validation(iid) = 38.305%
[37m[36mINFO[0m[0m 03/25 13:44:22 | last = 38.305%
[37m[36mINFO[0m[0m 03/25 13:44:22 | last (inD) = 86.029%
[37m[36mINFO[0m[0m 03/25 13:44:22 | training-domain validation (iid, inD) = 86.029%
[37m[36mINFO[0m[0m 03/25 13:44:22 | === Summary ===
[37m[36mINFO[0m[0m 03/25 13:44:22 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 16
[37m[36mINFO[0m[0m 03/25 13:44:22 | Unique name: 250325_12-05-17_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 13:44:22 | Out path: train_output/TerraIncognita/ERM/[3]/250325_12-05-17_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 13:44:22 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 13:44:22 | Dataset: TerraIncognita

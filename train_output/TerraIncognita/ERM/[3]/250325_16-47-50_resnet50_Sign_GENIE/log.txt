[37m[36mINFO[0m[0m 03/25 16:47:50 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250325_16-47-50_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250325_16-47-50_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 3.1159521264763664e-05
	batch_size: 11
	weight_decay: 1.4650833494643601e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/25 16:47:50 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 16:47:50 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 16:47:50 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 16:47:50 | 
[37m[36mINFO[0m[0m 03/25 16:47:50 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/25 16:47:50 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/25 16:47:50 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/25 16:47:50 | Batch sizes for each domain: [11, 11, 11, 0] (total=33)
[37m[36mINFO[0m[0m 03/25 16:47:50 | steps-per-epoch for each domain: 344.82, 708.09, 288.73 -> min = 288.73
[37m[36mINFO[0m[0m 03/25 16:47:52 | # of params = 23528522
[37m[36mINFO[0m[0m 03/25 16:50:42 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 16:50:42 | 0.222860    0.207483    0.288403    0.273706    2.132088    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.222860    0.207483    0           0.000000    2.453027    1.179975    168.826827 
[37m[36mINFO[0m[0m 03/25 16:54:04 | 0.279796    0.263605    0.534971    0.537214    1.217745    0.644081    0.703586    0.592759    0.565485    0.368073    0.342569    0.279796    0.263605    200         0.692695    1.461664    0.144370    173.359617 
[37m[36mINFO[0m[0m 03/25 16:57:35 | 0.248354    0.226190    0.583872    0.580257    1.128002    0.727656    0.736287    0.597638    0.576271    0.426322    0.428212    0.248354    0.226190    400         1.385390    1.232554    0.162526    178.861094 
[37m[36mINFO[0m[0m 03/25 17:01:04 | 0.307414    0.276361    0.641277    0.626497    1.009865    0.759030    0.745781    0.672358    0.642527    0.492443    0.491184    0.307414    0.276361    600         2.078086    1.095706    0.173272    174.516783 
[37m[36mINFO[0m[0m 03/25 17:04:27 | 0.277247    0.272959    0.708776    0.712069    0.819776    0.779330    0.777426    0.736166    0.741654    0.610831    0.617128    0.277247    0.272959    800         2.770781    0.955560    0.152749    171.827666 
[37m[36mINFO[0m[0m 03/25 17:07:44 | 0.308689    0.299320    0.763181    0.763387    0.682441    0.845769    0.837553    0.762100    0.761171    0.681675    0.691436    0.308689    0.299320    1000        3.463476    0.816831    0.134449    170.899738 
[37m[36mINFO[0m[0m 03/25 17:11:04 | 0.343743    0.321429    0.776844    0.766546    0.641189    0.852096    0.833333    0.780074    0.792501    0.698363    0.673804    0.343743    0.321429    1200        4.156171    0.727801    0.152191    168.790146 
[37m[36mINFO[0m[0m 03/25 17:14:22 | 0.375611    0.363946    0.751405    0.761249    0.659899    0.804904    0.787975    0.771729    0.779147    0.677582    0.716625    0.375611    0.363946    1400        4.848866    0.687392    0.140623    170.397517 
[37m[36mINFO[0m[0m 03/25 17:17:50 | 0.346505    0.347789    0.792222    0.795311    0.596743    0.873715    0.866034    0.780973    0.789420    0.721977    0.730479    0.346505    0.347789    1600        5.541562    0.654357    0.174725    173.204392 
[37m[36mINFO[0m[0m 03/25 17:21:15 | 0.373699    0.363946    0.798054    0.793477    0.585505    0.868178    0.850211    0.796765    0.802260    0.729219    0.727960    0.373699    0.363946    1800        6.234257    0.584062    0.151165    174.158152 
[37m[36mINFO[0m[0m 03/25 17:24:46 | 0.360952    0.352041    0.788183    0.769590    0.653177    0.864224    0.820675    0.791886    0.799178    0.708438    0.688917    0.360952    0.352041    2000        6.926952    0.592597    0.184711    173.872467 
[37m[36mINFO[0m[0m 03/25 17:28:04 | 0.356065    0.352891    0.808665    0.788874    0.567791    0.889006    0.860759    0.792656    0.793015    0.744332    0.712846    0.356065    0.352891    2200        7.619647    0.577221    0.152385    167.965066 
[37m[36mINFO[0m[0m 03/25 17:31:28 | 0.348842    0.349490    0.795077    0.777646    0.639837    0.881624    0.855485    0.759276    0.743195    0.744332    0.734257    0.348842    0.349490    2400        8.312343    0.537790    0.178036    168.733971 
[37m[36mINFO[0m[0m 03/25 17:34:54 | 0.333121    0.307823    0.827278    0.815605    0.516305    0.899025    0.877637    0.807934    0.810991    0.774874    0.758186    0.333121    0.307823    2600        9.005038    0.510200    0.193428    166.805216 
[37m[36mINFO[0m[0m 03/25 17:38:17 | 0.324410    0.325680    0.837038    0.828027    0.483481    0.908252    0.883966    0.816023    0.821777    0.786839    0.778338    0.324410    0.325680    2800        9.697733    0.510868    0.153612    171.938413 
[37m[36mINFO[0m[0m 03/25 17:41:46 | 0.363926    0.353741    0.845050    0.836072    0.480772    0.900343    0.882911    0.820259    0.821777    0.814547    0.803526    0.363926    0.353741    3000        10.390428   0.459645    0.162110    176.949217 
[37m[36mINFO[0m[0m 03/25 17:45:11 | 0.370512    0.352041    0.839552    0.828766    0.460716    0.896915    0.869198    0.815381    0.827427    0.806360    0.789673    0.370512    0.352041    3200        11.083123   0.468025    0.177519    169.542236 
[37m[36mINFO[0m[0m 03/25 17:48:38 | 0.384959    0.392857    0.844742    0.840177    0.462315    0.901661    0.891350    0.831557    0.826913    0.801008    0.802267    0.384959    0.392857    3400        11.775819   0.447496    0.183361    170.444967 
[37m[36mINFO[0m[0m 03/25 17:51:53 | 0.373699    0.386054    0.847653    0.844145    0.455760    0.900606    0.889241    0.836308    0.848485    0.806045    0.794710    0.373699    0.386054    3600        12.468514   0.433329    0.159745    163.397730 
[37m[36mINFO[0m[0m 03/25 17:55:21 | 0.377735    0.391156    0.851329    0.843789    0.452252    0.908252    0.888186    0.822057    0.834617    0.823678    0.808564    0.377735    0.391156    3800        13.161209   0.438205    0.159731    175.159237 
[37m[36mINFO[0m[0m 03/25 17:59:01 | 0.377098    0.376701    0.859297    0.839887    0.427451    0.926707    0.902954    0.827192    0.806882    0.823992    0.809824    0.377098    0.376701    4000        13.853904   0.433647    0.215445    176.990913 
[37m[36mINFO[0m[0m 03/25 18:02:31 | 0.377523    0.363946    0.861690    0.844916    0.466142    0.908516    0.866034    0.846579    0.852594    0.829975    0.816121    0.377523    0.363946    4200        14.546599   0.401848    0.172126    175.733993 
[37m[36mINFO[0m[0m 03/25 18:05:55 | 0.355641    0.363095    0.860356    0.846716    0.461291    0.908779    0.872363    0.850815    0.856703    0.821474    0.811083    0.355641    0.363095    4400        15.239295   0.403381    0.146318    175.257528 
[37m[36mINFO[0m[0m 03/25 18:09:22 | 0.336733    0.336735    0.852436    0.838208    0.452483    0.918798    0.895570    0.816408    0.824345    0.822103    0.794710    0.336733    0.336735    4600        15.931990   0.423081    0.187069    168.932741 
[37m[36mINFO[0m[0m 03/25 18:12:51 | 0.393244    0.402211    0.872965    0.855818    0.424110    0.926180    0.904008    0.845423    0.853621    0.847292    0.809824    0.393244    0.402211    4800        16.624685   0.409130    0.163990    176.252331 
[37m[36mINFO[0m[0m 03/25 18:16:19 | 0.257701    0.262755    0.846738    0.826309    0.505342    0.914843    0.877637    0.820901    0.830508    0.804471    0.770781    0.257701    0.262755    5000        17.317380   0.385897    0.176640    172.685178 
[37m[36mINFO[0m[0m 03/25 18:16:19 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250325_16-47-50_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 18:16:20 | ---
[37m[36mINFO[0m[0m 03/25 18:16:20 | test-domain validation(oracle) = 39.324%
[37m[36mINFO[0m[0m 03/25 18:16:20 | training-domain validation(iid) = 39.324%
[37m[36mINFO[0m[0m 03/25 18:16:20 | last = 25.770%
[37m[36mINFO[0m[0m 03/25 18:16:20 | last (inD) = 82.631%
[37m[36mINFO[0m[0m 03/25 18:16:20 | training-domain validation (iid, inD) = 85.582%
[37m[36mINFO[0m[0m 03/25 18:16:20 | === Summary ===
[37m[36mINFO[0m[0m 03/25 18:16:20 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 1
[37m[36mINFO[0m[0m 03/25 18:16:20 | Unique name: 250325_16-47-50_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 18:16:20 | Out path: train_output/TerraIncognita/ERM/[3]/250325_16-47-50_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 18:16:20 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 18:16:20 | Dataset: TerraIncognita

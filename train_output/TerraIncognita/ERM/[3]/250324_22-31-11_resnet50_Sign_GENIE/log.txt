[37m[36mINFO[0m[0m 03/24 22:31:11 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 8
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 8
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250324_22-31-11_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250324_22-31-11_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 3.335053008064847e-05
	batch_size: 18
	weight_decay: 0.00011109601170966198
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/24 22:31:11 | n_steps = 5001
[37m[36mINFO[0m[0m 03/24 22:31:11 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/24 22:31:11 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/24 22:31:11 | 
[37m[36mINFO[0m[0m 03/24 22:31:11 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/24 22:31:11 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/24 22:31:11 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/24 22:31:11 | Batch sizes for each domain: [18, 18, 18, 0] (total=54)
[37m[36mINFO[0m[0m 03/24 22:31:11 | steps-per-epoch for each domain: 210.72, 432.72, 176.44 -> min = 176.44
[37m[36mINFO[0m[0m 03/24 22:31:12 | # of params = 23528522
[37m[36mINFO[0m[0m 03/24 22:34:05 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/24 22:34:05 | 0.199065    0.202381    0.371882    0.407271    2.032300    0.490904    0.558017    0.449994    0.450950    0.174748    0.212846    0.199065    0.202381    0           0.000000    2.429768    0.955882    171.825671 
[37m[36mINFO[0m[0m 03/24 22:37:35 | 0.201402    0.201531    0.613591    0.619238    1.023879    0.750857    0.759494    0.678393    0.696456    0.411524    0.401763    0.201402    0.201531    200         1.133501    1.263724    0.185848    173.256052 
[37m[36mINFO[0m[0m 03/24 22:41:21 | 0.339282    0.345238    0.744465    0.763143    0.709459    0.837068    0.834388    0.750546    0.769902    0.645781    0.685139    0.339282    0.345238    400         2.267003    0.890171    0.169922    191.408144 
[37m[36mINFO[0m[0m 03/24 22:44:59 | 0.301891    0.297619    0.775687    0.771465    0.627666    0.858951    0.844937    0.786751    0.772984    0.681360    0.696474    0.301891    0.297619    600         3.400504    0.689242    0.183314    181.559241 
[37m[36mINFO[0m[0m 03/24 22:48:49 | 0.356703    0.371599    0.793326    0.800069    0.562633    0.857105    0.855485    0.798690    0.796610    0.724181    0.748111    0.356703    0.371599    800         4.534005    0.618496    0.218061    186.802250 
[37m[36mINFO[0m[0m 03/24 22:52:19 | 0.377310    0.380102    0.805717    0.807545    0.539990    0.881888    0.856540    0.794710    0.807910    0.740554    0.758186    0.377310    0.380102    1000        5.667506    0.575396    0.173392    175.429111 
[37m[36mINFO[0m[0m 03/24 22:55:48 | 0.386233    0.377551    0.822604    0.845684    0.474913    0.897970    0.888186    0.808191    0.828968    0.761650    0.819899    0.386233    0.377551    1200        6.801008    0.512200    0.197751    169.552548 
[37m[36mINFO[0m[0m 03/24 22:59:27 | 0.357553    0.349490    0.809575    0.817693    0.525197    0.892961    0.886076    0.807806    0.828968    0.727960    0.738035    0.357553    0.349490    1400        7.934509    0.498916    0.231975    172.423659 
[37m[36mINFO[0m[0m 03/24 23:02:57 | 0.400680    0.381803    0.845295    0.848848    0.421766    0.899552    0.885021    0.834382    0.845403    0.801952    0.816121    0.400680    0.381803    1600        9.068010    0.445899    0.192336    171.050765 
[37m[36mINFO[0m[0m 03/24 23:06:27 | 0.388145    0.385204    0.853664    0.856251    0.410307    0.909307    0.893460    0.840288    0.854135    0.811398    0.821159    0.388145    0.385204    1800        10.201511   0.431348    0.185094    173.298845 
[37m[36mINFO[0m[0m 03/24 23:10:07 | 0.390907    0.393707    0.855765    0.854317    0.406485    0.922225    0.899789    0.850045    0.852080    0.795025    0.811083    0.390907    0.393707    2000        11.335013   0.416704    0.227432    174.358377 
[37m[36mINFO[0m[0m 03/24 23:13:29 | 0.388570    0.390306    0.871988    0.865332    0.384567    0.929871    0.896624    0.848248    0.861839    0.837846    0.837531    0.388570    0.390306    2200        12.468514   0.384159    0.152720    171.630002 
[37m[36mINFO[0m[0m 03/24 23:16:53 | 0.374761    0.368197    0.856571    0.856878    0.411882    0.917480    0.912447    0.852484    0.868516    0.799748    0.789673    0.374761    0.368197    2400        13.602015   0.382197    0.163386    171.377768 
[37m[36mINFO[0m[0m 03/24 23:20:35 | 0.339494    0.354592    0.856009    0.859785    0.394278    0.906670    0.893460    0.845551    0.868516    0.815806    0.817380    0.339494    0.354592    2600        14.735516   0.378469    0.238126    174.242045 
[37m[36mINFO[0m[0m 03/24 23:24:01 | 0.418526    0.409014    0.871826    0.868663    0.382050    0.921171    0.901899    0.866222    0.871597    0.828086    0.832494    0.418526    0.409014    2800        15.869018   0.333386    0.196414    166.349366 
[37m[36mINFO[0m[0m 03/24 23:27:35 | 0.362226    0.369898    0.881398    0.871101    0.369143    0.929607    0.910338    0.866350    0.865434    0.848237    0.837531    0.362226    0.369898    3000        17.002519   0.344777    0.205508    173.046749 
[37m[36mINFO[0m[0m 03/24 23:31:18 | 0.328447    0.329932    0.877801    0.858337    0.382111    0.934353    0.904008    0.864039    0.853621    0.835013    0.817380    0.328447    0.329932    3200        18.136020   0.320062    0.243549    174.877340 
[37m[36mINFO[0m[0m 03/24 23:34:38 | 0.363289    0.376701    0.896114    0.883761    0.332870    0.939889    0.921941    0.882270    0.888033    0.866184    0.841310    0.363289    0.376701    3400        19.269521   0.311127    0.161702    167.181519 
[37m[36mINFO[0m[0m 03/24 23:38:04 | 0.349904    0.356293    0.876777    0.871631    0.344317    0.934089    0.922996    0.838875    0.853107    0.857368    0.838791    0.349904    0.356293    3600        20.403023   0.300651    0.171463    172.158027 
[37m[36mINFO[0m[0m 03/24 23:41:41 | 0.392607    0.399660    0.903068    0.890664    0.303624    0.951753    0.935654    0.875209    0.884951    0.882242    0.851385    0.392607    0.399660    3800        21.536524   0.299031    0.215323    173.449157 
[37m[36mINFO[0m[0m 03/24 23:45:14 | 0.355853    0.362245    0.904844    0.890063    0.310403    0.952808    0.934599    0.881371    0.885465    0.880353    0.850126    0.355853    0.362245    4000        22.670025   0.284658    0.179291    176.997132 
[37m[36mINFO[0m[0m 03/24 23:48:45 | 0.371574    0.379252    0.904918    0.889055    0.323146    0.957026    0.936709    0.886507    0.880329    0.871222    0.850126    0.371574    0.379252    4200        23.803526   0.276460    0.198958    171.701842 
[37m[36mINFO[0m[0m 03/24 23:52:16 | 0.404504    0.402211    0.911066    0.896359    0.302131    0.956235    0.929325    0.891257    0.884438    0.885705    0.875315    0.404504    0.402211    4400        24.937028   0.261690    0.193270    172.037683 
[37m[36mINFO[0m[0m 03/24 23:55:47 | 0.412152    0.397959    0.919502    0.903608    0.279504    0.961772    0.931435    0.897805    0.883924    0.898929    0.895466    0.412152    0.397959    4600        26.070529   0.243029    0.205901    170.275790 
[37m[36mINFO[0m[0m 03/24 23:59:21 | 0.375186    0.376701    0.901321    0.890287    0.310148    0.938835    0.917722    0.894852    0.894196    0.870277    0.858942    0.375186    0.376701    4800        27.204030   0.228211    0.216893    169.724630 
[37m[36mINFO[0m[0m 03/25 00:02:48 | 0.425961    0.423469    0.922425    0.899112    0.289376    0.964672    0.943038    0.901785    0.889060    0.900819    0.865239    0.425961    0.423469    5000        28.337531   0.244157    0.182028    170.768279 
[37m[36mINFO[0m[0m 03/25 00:02:48 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250324_22-31-11_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 00:02:49 | ---
[37m[36mINFO[0m[0m 03/25 00:02:49 | test-domain validation(oracle) = 42.596%
[37m[36mINFO[0m[0m 03/25 00:02:49 | training-domain validation(iid) = 41.215%
[37m[36mINFO[0m[0m 03/25 00:02:49 | last = 42.596%
[37m[36mINFO[0m[0m 03/25 00:02:49 | last (inD) = 89.911%
[37m[36mINFO[0m[0m 03/25 00:02:49 | training-domain validation (iid, inD) = 90.361%
[37m[36mINFO[0m[0m 03/25 00:02:49 | === Summary ===
[37m[36mINFO[0m[0m 03/25 00:02:49 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 8
[37m[36mINFO[0m[0m 03/25 00:02:49 | Unique name: 250324_22-31-11_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 00:02:49 | Out path: train_output/TerraIncognita/ERM/[3]/250324_22-31-11_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 00:02:49 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 00:02:49 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 03/25 05:01:39 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 12
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 12
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250325_05-01-39_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250325_05-01-39_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 3.0065625733392338e-05
	batch_size: 34
	weight_decay: 4.89485556145273e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/25 05:01:39 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 05:01:39 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 05:01:39 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 05:01:39 | 
[37m[36mINFO[0m[0m 03/25 05:01:39 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/25 05:01:39 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/25 05:01:39 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/25 05:01:39 | Batch sizes for each domain: [34, 34, 34, 0] (total=102)
[37m[36mINFO[0m[0m 03/25 05:01:39 | steps-per-epoch for each domain: 111.56, 229.09, 93.41 -> min = 93.41
[37m[36mINFO[0m[0m 03/25 05:01:40 | # of params = 23528522
[37m[36mINFO[0m[0m 03/25 05:05:00 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 05:05:00 | 0.217336    0.229592    0.286078    0.283001    2.024196    0.208015    0.179325    0.461933    0.455573    0.188287    0.214106    0.217336    0.229592    0           0.000000    2.466315    1.136678    198.513308 
[37m[36mINFO[0m[0m 03/25 05:09:22 | 0.277247    0.287415    0.666747    0.680200    0.929491    0.781967    0.772152    0.676082    0.667694    0.542191    0.600756    0.277247    0.287415    200         2.141058    1.234443    0.325329    196.955624 
[37m[36mINFO[0m[0m 03/25 05:13:42 | 0.302528    0.321429    0.748269    0.754084    0.690647    0.846823    0.828059    0.751573    0.772984    0.646411    0.661209    0.302528    0.321429    400         4.282116    0.808351    0.315960    196.644792 
[37m[36mINFO[0m[0m 03/25 05:18:00 | 0.342256    0.358844    0.798722    0.806880    0.554050    0.875033    0.867089    0.796636    0.810478    0.724496    0.743073    0.342256    0.358844    600         6.423174    0.639763    0.325017    192.543528 
[37m[36mINFO[0m[0m 03/25 05:22:23 | 0.350967    0.340136    0.823893    0.829370    0.504723    0.897970    0.890295    0.802927    0.806882    0.770781    0.790932    0.350967    0.340136    800         8.564232    0.550484    0.343376    194.314474 
[37m[36mINFO[0m[0m 03/25 05:26:49 | 0.350117    0.376701    0.847239    0.840380    0.452140    0.914579    0.897679    0.840930    0.843862    0.786209    0.779597    0.350117    0.376701    1000        10.705290   0.475512    0.339430    198.417842 
[37m[36mINFO[0m[0m 03/25 05:31:08 | 0.310601    0.315476    0.842785    0.839126    0.464988    0.891642    0.879747    0.827834    0.834104    0.808879    0.803526    0.310601    0.315476    1200        12.846348   0.430972    0.332273    192.893924 
[37m[36mINFO[0m[0m 03/25 05:35:34 | 0.336520    0.340986    0.868978    0.854784    0.399606    0.918270    0.900844    0.854282    0.870056    0.834383    0.793451    0.336520    0.340986    1400        14.987406   0.397601    0.331406    199.199945 
[37m[36mINFO[0m[0m 03/25 05:40:07 | 0.366688    0.369048    0.862067    0.853363    0.405107    0.922489    0.910338    0.856721    0.875193    0.806990    0.774559    0.366688    0.369048    1600        17.128463   0.373980    0.339664    205.309062 
[37m[36mINFO[0m[0m 03/25 05:44:32 | 0.352454    0.355442    0.893509    0.875957    0.371217    0.940944    0.915612    0.872769    0.877247    0.866814    0.835013    0.352454    0.355442    1800        19.269521   0.330603    0.333095    198.720619 
[37m[36mINFO[0m[0m 03/25 05:49:05 | 0.345231    0.352891    0.895330    0.882281    0.334695    0.943317    0.921941    0.873026    0.879815    0.869647    0.845088    0.345231    0.352891    2000        21.410579   0.315219    0.372031    197.875240 
[37m[36mINFO[0m[0m 03/25 05:53:24 | 0.433610    0.414116    0.902882    0.891336    0.330818    0.942789    0.927215    0.886763    0.891628    0.879093    0.855164    0.433610    0.414116    2200        23.551637   0.306540    0.320174    195.272017 
[37m[36mINFO[0m[0m 03/25 05:57:42 | 0.321649    0.339286    0.908707    0.886157    0.325871    0.957290    0.929325    0.887534    0.877761    0.881297    0.851385    0.321649    0.339286    2400        25.692695   0.268466    0.322036    193.209039 
[37m[36mINFO[0m[0m 03/25 06:02:04 | 0.332484    0.362245    0.911791    0.891314    0.332863    0.945953    0.917722    0.893953    0.897278    0.895466    0.858942    0.332484    0.362245    2600        27.833753   0.257826    0.315781    199.470871 
[37m[36mINFO[0m[0m 03/25 06:06:31 | 0.345655    0.346939    0.907540    0.888585    0.314831    0.949380    0.924051    0.887534    0.889060    0.885705    0.852645    0.345655    0.346939    2800        29.974811   0.262969    0.325665    201.321429 
[37m[36mINFO[0m[0m 03/25 06:10:48 | 0.338220    0.348639    0.911993    0.896826    0.305037    0.950171    0.927215    0.899474    0.896764    0.886335    0.866499    0.338220    0.348639    3000        32.115869   0.236737    0.320456    193.671552 
[37m[36mINFO[0m[0m 03/25 06:15:09 | 0.375823    0.377551    0.916917    0.889318    0.334510    0.955708    0.931435    0.898318    0.881356    0.896725    0.855164    0.375823    0.377551    3200        34.256927   0.226345    0.328899    194.953918 
[37m[36mINFO[0m[0m 03/25 06:19:28 | 0.340982    0.375000    0.925891    0.906063    0.279720    0.960981    0.935654    0.904224    0.903441    0.912469    0.879093    0.340982    0.375000    3400        36.397985   0.221976    0.327022    193.226170 
[37m[36mINFO[0m[0m 03/25 06:23:52 | 0.322286    0.320578    0.927478    0.893893    0.308413    0.968099    0.933544    0.902812    0.882897    0.911524    0.865239    0.322286    0.320578    3600        38.539043   0.202324    0.327919    198.464834 
[37m[36mINFO[0m[0m 03/25 06:28:15 | 0.359890    0.374150    0.926536    0.904882    0.285375    0.962563    0.941983    0.892926    0.874679    0.924118    0.897985    0.359890    0.374150    3800        40.680101   0.205402    0.329755    197.189010 
[37m[36mINFO[0m[0m 03/25 06:32:36 | 0.329084    0.345238    0.933406    0.906836    0.269523    0.969417    0.938819    0.914238    0.898819    0.916562    0.882872    0.329084    0.345238    4000        42.821159   0.206587    0.332154    194.577397 
[37m[36mINFO[0m[0m 03/25 06:36:58 | 0.396643    0.408163    0.928964    0.905553    0.287042    0.972581    0.943038    0.914752    0.898305    0.899559    0.875315    0.396643    0.408163    4200        44.962217   0.193744    0.322606    197.543298 
[37m[36mINFO[0m[0m 03/25 06:41:22 | 0.398130    0.409014    0.926526    0.904380    0.277642    0.951490    0.928270    0.907434    0.907036    0.920655    0.877834    0.398130    0.409014    4400        47.103275   0.185793    0.330488    197.748271 
[37m[36mINFO[0m[0m 03/25 06:45:41 | 0.387508    0.382653    0.930862    0.898468    0.311103    0.962299    0.926160    0.913724    0.906523    0.916562    0.862720    0.387508    0.382653    4600        49.244332   0.178555    0.321228    195.171217 
[37m[36mINFO[0m[0m 03/25 06:49:59 | 0.364776    0.361395    0.941078    0.919490    0.268285    0.965463    0.948312    0.925151    0.912173    0.932620    0.897985    0.364776    0.361395    4800        51.385390   0.168825    0.328100    192.081493 
[37m[36mINFO[0m[0m 03/25 06:54:26 | 0.397918    0.396259    0.947237    0.922180    0.239850    0.970736    0.948312    0.930800    0.912686    0.940176    0.905542    0.397918    0.396259    5000        53.526448   0.151986    0.328222    201.257208 
[37m[36mINFO[0m[0m 03/25 06:54:26 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250325_05-01-39_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 06:54:27 | ---
[37m[36mINFO[0m[0m 03/25 06:54:27 | test-domain validation(oracle) = 43.361%
[37m[36mINFO[0m[0m 03/25 06:54:27 | training-domain validation(iid) = 39.792%
[37m[36mINFO[0m[0m 03/25 06:54:27 | last = 39.792%
[37m[36mINFO[0m[0m 03/25 06:54:27 | last (inD) = 92.218%
[37m[36mINFO[0m[0m 03/25 06:54:27 | training-domain validation (iid, inD) = 92.218%
[37m[36mINFO[0m[0m 03/25 06:54:27 | === Summary ===
[37m[36mINFO[0m[0m 03/25 06:54:27 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 12
[37m[36mINFO[0m[0m 03/25 06:54:27 | Unique name: 250325_05-01-39_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 06:54:27 | Out path: train_output/TerraIncognita/ERM/[3]/250325_05-01-39_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 06:54:27 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 06:54:27 | Dataset: TerraIncognita

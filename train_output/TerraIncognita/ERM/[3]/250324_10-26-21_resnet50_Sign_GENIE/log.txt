[37m[36mINFO[0m[0m 03/24 10:26:21 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 0
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250324_10-26-21_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250324_10-26-21_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/24 10:26:21 | n_steps = 5001
[37m[36mINFO[0m[0m 03/24 10:26:21 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/24 10:26:21 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/24 10:26:21 | 
[37m[36mINFO[0m[0m 03/24 10:26:21 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/24 10:26:21 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/24 10:26:21 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/24 10:26:21 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 03/24 10:26:21 | steps-per-epoch for each domain: 118.53, 243.41, 99.25 -> min = 99.25
[37m[36mINFO[0m[0m 03/24 10:26:22 | # of params = 23528522
[37m[36mINFO[0m[0m 03/24 10:29:11 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/24 10:29:11 | 0.217336    0.229592    0.302776    0.283001    2.022007    0.258107    0.179325    0.461933    0.455573    0.188287    0.214106    0.217336    0.229592    0           0.000000    2.451033    1.105061    167.843474 
[37m[36mINFO[0m[0m 03/24 10:32:44 | 0.285532    0.307823    0.644146    0.659040    0.951217    0.747429    0.745781    0.681859    0.689779    0.503149    0.541562    0.285532    0.307823    200         2.015113    1.227321    0.248820    162.603017 
[37m[36mINFO[0m[0m 03/24 10:36:23 | 0.349055    0.349490    0.756485    0.760437    0.669966    0.862378    0.858650    0.762871    0.762712    0.644207    0.659950    0.349055    0.349490    400         4.030227    0.822832    0.251593    168.908312 
[37m[36mINFO[0m[0m 03/24 10:39:59 | 0.346080    0.353741    0.799286    0.796340    0.572413    0.874506    0.852321    0.787521    0.798665    0.735831    0.738035    0.346080    0.353741    600         6.045340    0.616077    0.261591    164.082664 
[37m[36mINFO[0m[0m 03/24 10:43:41 | 0.386446    0.392857    0.826598    0.829502    0.487533    0.895861    0.887131    0.814097    0.821777    0.769836    0.779597    0.386446    0.392857    800         8.060453    0.526038    0.276674    166.555929 
[37m[36mINFO[0m[0m 03/24 10:47:20 | 0.423624    0.421769    0.834862    0.832572    0.483361    0.901397    0.883966    0.816665    0.836672    0.786524    0.777078    0.423624    0.421769    1000        10.075567   0.483597    0.283580    162.018390 
[37m[36mINFO[0m[0m 03/24 10:50:58 | 0.374761    0.367347    0.848620    0.855377    0.423831    0.906670    0.902954    0.832199    0.865948    0.806990    0.797229    0.374761    0.367347    1200        12.090680   0.445805    0.252233    167.133195 
[37m[36mINFO[0m[0m 03/24 10:54:44 | 0.331421    0.340986    0.867829    0.857358    0.397482    0.921698    0.907173    0.847092    0.863893    0.834698    0.801008    0.331421    0.340986    1400        14.105793   0.417026    0.276641    171.359726 
[37m[36mINFO[0m[0m 03/24 10:58:27 | 0.370937    0.386054    0.860546    0.864846    0.394636    0.915370    0.911392    0.845423    0.869543    0.820844    0.813602    0.370937    0.386054    1600        16.120907   0.366473    0.280831    166.606399 
[37m[36mINFO[0m[0m 03/24 11:02:05 | 0.359465    0.368197    0.871225    0.857349    0.403621    0.907725    0.878692    0.846065    0.863380    0.859887    0.829975    0.359465    0.368197    1800        18.136020   0.343301    0.262613    165.682102 
[37m[36mINFO[0m[0m 03/24 11:05:42 | 0.349692    0.360544    0.879905    0.863026    0.374495    0.930925    0.910338    0.849531    0.850026    0.859257    0.828715    0.349692    0.360544    2000        20.151134   0.327583    0.241774    168.873450 
[37m[36mINFO[0m[0m 03/24 11:09:25 | 0.349692    0.363946    0.897414    0.887508    0.316271    0.945953    0.927215    0.874438    0.883924    0.871851    0.851385    0.349692    0.363946    2200        22.166247   0.302856    0.273466    167.677432 
[37m[36mINFO[0m[0m 03/24 11:13:06 | 0.346505    0.363095    0.892117    0.877905    0.346977    0.927498    0.911392    0.870073    0.863380    0.878778    0.858942    0.346505    0.363095    2400        24.181360   0.290661    0.274511    166.038277 
[37m[36mINFO[0m[0m 03/24 11:16:52 | 0.334608    0.358844    0.908533    0.888732    0.321904    0.957553    0.928270    0.882655    0.889060    0.885390    0.848866    0.334608    0.358844    2600        26.196474   0.263056    0.264157    173.436492 
[37m[36mINFO[0m[0m 03/24 11:20:22 | 0.363926    0.388605    0.911401    0.889881    0.319921    0.956762    0.931435    0.889845    0.890601    0.887594    0.847607    0.363926    0.388605    2800        28.211587   0.255284    0.240872    162.230515 
[37m[36mINFO[0m[0m 03/24 11:24:03 | 0.398343    0.399660    0.909556    0.892513    0.310046    0.960190    0.941983    0.898832    0.896764    0.869647    0.838791    0.398343    0.399660    3000        30.226700   0.233205    0.269347    166.646616 
[37m[36mINFO[0m[0m 03/24 11:27:46 | 0.336945    0.349490    0.916710    0.898588    0.290762    0.957553    0.936709    0.891129    0.887519    0.901448    0.871537    0.336945    0.349490    3200        32.241814   0.235933    0.268378    169.347641 
[37m[36mINFO[0m[0m 03/24 11:31:22 | 0.355216    0.373299    0.928756    0.911094    0.250400    0.964408    0.945148    0.904352    0.906523    0.917506    0.881612    0.355216    0.373299    3400        34.256927   0.235563    0.248481    166.728847 
[37m[36mINFO[0m[0m 03/24 11:35:02 | 0.352879    0.366497    0.925290    0.908970    0.272518    0.967308    0.940928    0.900501    0.899332    0.908060    0.886650    0.352879    0.366497    3600        36.272040   0.200247    0.259320    167.774764 
[37m[36mINFO[0m[0m 03/24 11:38:38 | 0.385171    0.388605    0.921787    0.906980    0.284903    0.955181    0.935654    0.899602    0.902414    0.910579    0.882872    0.385171    0.388605    3800        38.287154   0.194890    0.277511    160.627700 
[37m[36mINFO[0m[0m 03/24 11:42:14 | 0.384109    0.405612    0.935379    0.912707    0.264679    0.969417    0.948312    0.911028    0.901900    0.925693    0.887909    0.384109    0.405612    4000        40.302267   0.192286    0.272835    161.710586 
[37m[36mINFO[0m[0m 03/24 11:45:51 | 0.364776    0.386905    0.934509    0.912124    0.244709    0.968890    0.928270    0.913981    0.910118    0.920655    0.897985    0.364776    0.386905    4200        42.317380   0.186347    0.240122    168.209694 
[37m[36mINFO[0m[0m 03/24 11:49:32 | 0.360952    0.378401    0.932246    0.912001    0.259261    0.972581    0.950422    0.906021    0.917822    0.918136    0.867758    0.360952    0.378401    4400        44.332494   0.178471    0.271878    167.171799 
[37m[36mINFO[0m[0m 03/24 11:53:14 | 0.358402    0.375000    0.942069    0.919860    0.237872    0.967308    0.951477    0.921556    0.910118    0.937343    0.897985    0.358402    0.375000    4600        46.347607   0.175863    0.273991    167.038372 
[37m[36mINFO[0m[0m 03/24 11:56:54 | 0.371574    0.380952    0.940035    0.912070    0.264967    0.972054    0.943038    0.917319    0.906523    0.930730    0.886650    0.371574    0.380952    4800        48.362720   0.182792    0.260667    167.747366 
[37m[36mINFO[0m[0m 03/24 12:00:28 | 0.359465    0.385204    0.931352    0.891754    0.320657    0.952281    0.909283    0.915137    0.907036    0.926637    0.858942    0.359465    0.385204    5000        50.377834   0.160446    0.244854    165.203131 
[37m[36mINFO[0m[0m 03/24 12:00:28 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250324_10-26-21_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/24 12:00:30 | ---
[37m[36mINFO[0m[0m 03/24 12:00:30 | test-domain validation(oracle) = 42.362%
[37m[36mINFO[0m[0m 03/24 12:00:30 | training-domain validation(iid) = 35.840%
[37m[36mINFO[0m[0m 03/24 12:00:30 | last = 35.946%
[37m[36mINFO[0m[0m 03/24 12:00:30 | last (inD) = 89.175%
[37m[36mINFO[0m[0m 03/24 12:00:30 | training-domain validation (iid, inD) = 91.986%
[37m[36mINFO[0m[0m 03/24 12:00:30 | === Summary ===
[37m[36mINFO[0m[0m 03/24 12:00:30 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 0
[37m[36mINFO[0m[0m 03/24 12:00:30 | Unique name: 250324_10-26-21_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 12:00:30 | Out path: train_output/TerraIncognita/ERM/[3]/250324_10-26-21_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 12:00:30 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/24 12:00:30 | Dataset: TerraIncognita

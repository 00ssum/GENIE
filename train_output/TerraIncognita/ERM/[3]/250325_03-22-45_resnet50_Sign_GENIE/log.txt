[37m[36mINFO[0m[0m 03/25 03:22:45 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 11
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 11
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250325_03-22-45_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250325_03-22-45_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5.340583028754034e-05
	batch_size: 10
	weight_decay: 2.5000172438864113e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/25 03:22:45 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 03:22:45 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 03:22:45 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 03:22:45 | 
[37m[36mINFO[0m[0m 03/25 03:22:45 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/25 03:22:45 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/25 03:22:45 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/25 03:22:45 | Batch sizes for each domain: [10, 10, 10, 0] (total=30)
[37m[36mINFO[0m[0m 03/25 03:22:45 | steps-per-epoch for each domain: 379.30, 778.90, 317.60 -> min = 317.60
[37m[36mINFO[0m[0m 03/25 03:22:46 | # of params = 23528522
[37m[36mINFO[0m[0m 03/25 03:26:09 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 03:26:09 | 0.217336    0.229592    0.287748    0.283001    2.010755    0.213024    0.179325    0.461933    0.455573    0.188287    0.214106    0.217336    0.229592    0           0.000000    2.442356    1.470131    201.351697 
[37m[36mINFO[0m[0m 03/25 03:30:14 | 0.214362    0.221939    0.537522    0.571358    1.166338    0.683891    0.739451    0.570677    0.569081    0.357997    0.405542    0.214362    0.221939    200         0.629723    1.376412    0.195835    205.435944 
[37m[36mINFO[0m[0m 03/25 03:33:55 | 0.277459    0.289116    0.638846    0.660674    0.979184    0.756921    0.748945    0.677879    0.701592    0.481738    0.531486    0.277459    0.289116    400         1.259446    1.099273    0.134001    194.626153 
[37m[36mINFO[0m[0m 03/25 03:37:45 | 0.340344    0.336735    0.691256    0.703883    0.837956    0.789085    0.771097    0.727693    0.749872    0.556990    0.590680    0.340344    0.336735    600         1.889169    0.933211    0.159218    197.808794 
[37m[36mINFO[0m[0m 03/25 03:41:44 | 0.377098    0.365646    0.712008    0.734346    0.765164    0.770630    0.771097    0.743228    0.760657    0.622166    0.671285    0.377098    0.365646    800         2.518892    0.831791    0.215830    195.801358 
[37m[36mINFO[0m[0m 03/25 03:45:22 | 0.319312    0.335034    0.761741    0.767935    0.665479    0.858423    0.859705    0.766851    0.790447    0.659950    0.653652    0.319312    0.335034    1000        3.148615    0.705039    0.130506    192.340140 
[37m[36mINFO[0m[0m 03/25 03:49:06 | 0.273847    0.281463    0.762053    0.760210    0.649110    0.851832    0.855485    0.771858    0.774011    0.662469    0.651134    0.273847    0.281463    1200        3.778338    0.660356    0.139031    196.250932 
[37m[36mINFO[0m[0m 03/25 03:52:52 | 0.323773    0.330782    0.797371    0.797179    0.574546    0.869233    0.839662    0.795866    0.815100    0.727015    0.736776    0.323773    0.330782    1400        4.408060    0.627046    0.153209    194.878049 
[37m[36mINFO[0m[0m 03/25 03:56:45 | 0.359677    0.357993    0.783775    0.797296    0.582981    0.861323    0.858650    0.775581    0.788906    0.714421    0.744332    0.359677    0.357993    1600        5.037783    0.636953    0.206533    191.686553 
[37m[36mINFO[0m[0m 03/25 04:00:32 | 0.319524    0.331633    0.782646    0.786799    0.591919    0.852887    0.825949    0.776223    0.786338    0.718829    0.748111    0.319524    0.331633    1800        5.667506    0.561376    0.145971    198.185300 
[37m[36mINFO[0m[0m 03/25 04:04:20 | 0.342469    0.335884    0.805609    0.814204    0.548845    0.879779    0.870253    0.795866    0.819209    0.741184    0.753149    0.342469    0.335884    2000        6.297229    0.544517    0.153543    196.869433 
[37m[36mINFO[0m[0m 03/25 04:08:15 | 0.414064    0.427721    0.814486    0.821993    0.502415    0.890852    0.890295    0.809218    0.835131    0.743388    0.740554    0.414064    0.427721    2200        6.926952    0.553416    0.161855    202.711615 
[37m[36mINFO[0m[0m 03/25 04:11:59 | 0.342894    0.353741    0.798891    0.809801    0.546106    0.855523    0.845992    0.789575    0.817668    0.751574    0.765743    0.342894    0.353741    2400        7.556675    0.531244    0.150407    193.690567 
[37m[36mINFO[0m[0m 03/25 04:15:44 | 0.336520    0.352891    0.814469    0.840532    0.524674    0.875033    0.871308    0.810502    0.850539    0.757872    0.799748    0.336520    0.352891    2600        8.186398    0.503655    0.151845    194.473349 
[37m[36mINFO[0m[0m 03/25 04:19:33 | 0.389845    0.392007    0.836381    0.844207    0.453651    0.904034    0.898734    0.811657    0.822804    0.793451    0.811083    0.389845    0.392007    2800        8.816121    0.492160    0.147562    199.827526 
[37m[36mINFO[0m[0m 03/25 04:23:26 | 0.279371    0.293367    0.814597    0.818512    0.518658    0.894543    0.882911    0.794839    0.806882    0.754408    0.765743    0.279371    0.293367    3000        9.445844    0.479112    0.200987    192.897065 
[37m[36mINFO[0m[0m 03/25 04:27:16 | 0.302316    0.304422    0.846160    0.850020    0.434701    0.912470    0.906118    0.831301    0.847971    0.794710    0.795970    0.302316    0.304422    3200        10.075567   0.433233    0.171191    196.039937 
[37m[36mINFO[0m[0m 03/25 04:31:15 | 0.347567    0.351190    0.844851    0.843718    0.430215    0.911416    0.906118    0.825908    0.834104    0.797229    0.790932    0.347567    0.351190    3400        10.705290   0.425552    0.184094    202.067568 
[37m[36mINFO[0m[0m 03/25 04:35:12 | 0.405779    0.410714    0.842730    0.850811    0.439924    0.910361    0.898734    0.834767    0.857730    0.783060    0.795970    0.405779    0.410714    3600        11.335013   0.407987    0.218018    193.400826 
[37m[36mINFO[0m[0m 03/25 04:39:02 | 0.332271    0.344388    0.853694    0.858062    0.419596    0.912734    0.906118    0.836950    0.858243    0.811398    0.809824    0.332271    0.344388    3800        11.964736   0.434266    0.151320    199.032633 
[37m[36mINFO[0m[0m 03/25 04:42:51 | 0.354366    0.366497    0.868299    0.873201    0.383949    0.924598    0.918776    0.848119    0.872111    0.832179    0.828715    0.354366    0.366497    4000        12.594458   0.403311    0.156037    198.354391 
[37m[36mINFO[0m[0m 03/25 04:46:36 | 0.382622    0.377551    0.861317    0.848111    0.422802    0.925125    0.901899    0.844909    0.835131    0.813917    0.807305    0.382622    0.377551    4200        13.224181   0.388013    0.136742    197.401032 
[37m[36mINFO[0m[0m 03/25 04:50:16 | 0.353941    0.356293    0.861128    0.864215    0.394177    0.917480    0.909283    0.842855    0.854648    0.823048    0.828715    0.353941    0.356293    4400        13.853904   0.383156    0.139597    192.192706 
[37m[36mINFO[0m[0m 03/25 04:54:02 | 0.349904    0.342687    0.855210    0.841399    0.443856    0.924598    0.914557    0.833098    0.832563    0.807935    0.777078    0.349904    0.342687    4600        14.483627   0.357237    0.140541    197.662109 
[37m[36mINFO[0m[0m 03/25 04:57:43 | 0.388570    0.386905    0.844343    0.847129    0.429800    0.904561    0.889241    0.841315    0.842322    0.787154    0.809824    0.388570    0.386905    4800        15.113350   0.379170    0.137913    193.539507 
[37m[36mINFO[0m[0m 03/25 05:01:33 | 0.321649    0.316327    0.862541    0.862672    0.393369    0.923280    0.910338    0.846964    0.860298    0.817380    0.817380    0.321649    0.316327    5000        15.743073   0.367585    0.163920    197.579286 
[37m[36mINFO[0m[0m 03/25 05:01:33 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250325_03-22-45_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 05:01:35 | ---
[37m[36mINFO[0m[0m 03/25 05:01:35 | test-domain validation(oracle) = 41.406%
[37m[36mINFO[0m[0m 03/25 05:01:35 | training-domain validation(iid) = 35.437%
[37m[36mINFO[0m[0m 03/25 05:01:35 | last = 32.165%
[37m[36mINFO[0m[0m 03/25 05:01:35 | last (inD) = 86.267%
[37m[36mINFO[0m[0m 03/25 05:01:35 | training-domain validation (iid, inD) = 87.320%
[37m[36mINFO[0m[0m 03/25 05:01:35 | === Summary ===
[37m[36mINFO[0m[0m 03/25 05:01:35 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 11
[37m[36mINFO[0m[0m 03/25 05:01:35 | Unique name: 250325_03-22-45_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 05:01:35 | Out path: train_output/TerraIncognita/ERM/[3]/250325_03-22-45_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 05:01:35 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 05:01:35 | Dataset: TerraIncognita

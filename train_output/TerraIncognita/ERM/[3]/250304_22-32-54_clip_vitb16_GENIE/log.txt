[37m[36mINFO[0m[0m 03/04 22:32:54 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250304_22-32-54_clip_vitb16_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250304_22-32-54_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: clip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/04 22:32:54 | n_steps = 5001
[37m[36mINFO[0m[0m 03/04 22:32:54 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/04 22:32:54 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/04 22:32:54 | 
[37m[36mINFO[0m[0m 03/04 22:32:54 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/04 22:32:54 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/04 22:32:54 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/04 22:32:54 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 03/04 22:32:54 | steps-per-epoch for each domain: 118.53, 243.41, 99.25 -> min = 99.25
[37m[36mINFO[0m[0m 03/04 22:32:57 | # of params = 86197770
[37m[36mINFO[0m[0m 03/04 22:35:43 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/04 22:35:43 | 0.105800    0.104592    0.070949    0.053386    2.238127    0.054838    0.043249    0.037104    0.014895    0.120907    0.102015    0.105800    0.104592    0           0.000000    2.218522    1.106122    164.868345 
[37m[36mINFO[0m[0m 03/04 22:39:58 | 0.254727    0.245748    0.495106    0.557960    1.275032    0.560506    0.636076    0.552959    0.593220    0.371851    0.444584    0.254727    0.245748    200         2.015113    1.502510    0.436145    167.753990 
[37m[36mINFO[0m[0m 03/04 22:44:11 | 0.194604    0.199830    0.564843    0.568616    1.168030    0.701292    0.697257    0.591475    0.580380    0.401763    0.428212    0.194604    0.199830    400         4.030227    1.263447    0.434727    166.574920 
[37m[36mINFO[0m[0m 03/04 22:48:23 | 0.152964    0.132653    0.623224    0.631703    1.031216    0.725547    0.722574    0.644755    0.657422    0.499370    0.515113    0.152964    0.132653    600         6.045340    1.136685    0.438373    164.400132 
[37m[36mINFO[0m[0m 03/04 22:52:32 | 0.143403    0.158163    0.652214    0.661171    0.969498    0.755866    0.756329    0.656695    0.683102    0.544081    0.544081    0.143403    0.158163    800         8.060453    1.021749    0.433448    162.125959 
[37m[36mINFO[0m[0m 03/04 22:56:48 | 0.182282    0.178571    0.706269    0.711169    0.808216    0.815450    0.818565    0.693157    0.701592    0.610202    0.613350    0.182282    0.178571    1000        10.075567   0.886622    0.433087    168.948369 
[37m[36mINFO[0m[0m 03/04 23:01:05 | 0.278096    0.275510    0.743966    0.744185    0.714674    0.828632    0.825949    0.737964    0.752953    0.665302    0.653652    0.278096    0.275510    1200        12.090680   0.764810    0.439804    169.431425 
[37m[36mINFO[0m[0m 03/04 23:05:18 | 0.228383    0.232993    0.771202    0.772572    0.639305    0.842078    0.858650    0.761202    0.782743    0.710327    0.676322    0.228383    0.232993    1400        14.105793   0.694179    0.436014    165.989207 
[37m[36mINFO[0m[0m 03/04 23:09:31 | 0.272998    0.273810    0.778822    0.774795    0.614882    0.861060    0.857595    0.753113    0.765280    0.722292    0.701511    0.272998    0.273810    1600        16.120907   0.626464    0.442540    164.646186 
[37m[36mINFO[0m[0m 03/04 23:13:47 | 0.260888    0.284014    0.796899    0.803695    0.556068    0.868969    0.881857    0.768263    0.789933    0.753463    0.739295    0.260888    0.284014    1800        18.136020   0.594824    0.436421    168.591680 
[37m[36mINFO[0m[0m 03/04 23:18:00 | 0.299554    0.277211    0.800724    0.797216    0.564027    0.880042    0.875527    0.776223    0.789420    0.745907    0.726700    0.299554    0.277211    2000        20.151134   0.540215    0.443156    164.339354 
[37m[36mINFO[0m[0m 03/04 23:22:17 | 0.296580    0.294218    0.830714    0.829599    0.490672    0.902452    0.891350    0.795609    0.814073    0.794081    0.783375    0.296580    0.294218    2200        22.166247   0.505613    0.438605    168.891241 
[37m[36mINFO[0m[0m 03/04 23:26:36 | 0.291056    0.295918    0.838674    0.828997    0.471583    0.907725    0.904008    0.803826    0.808423    0.804471    0.774559    0.291056    0.295918    2400        24.181360   0.449367    0.437562    172.053673 
[37m[36mINFO[0m[0m 03/04 23:30:47 | 0.264287    0.268707    0.847239    0.842830    0.434640    0.915370    0.902954    0.815894    0.820750    0.810453    0.804786    0.264287    0.268707    2600        26.196474   0.437391    0.434516    163.558247 
[37m[36mINFO[0m[0m 03/04 23:35:05 | 0.289994    0.304422    0.854703    0.852003    0.406816    0.914316    0.912447    0.823597    0.841294    0.826196    0.802267    0.289994    0.304422    2800        28.211587   0.401999    0.437050    170.966222 
[37m[36mINFO[0m[0m 03/04 23:39:24 | 0.292968    0.310374    0.864348    0.844758    0.426040    0.922225    0.911392    0.823212    0.826913    0.847607    0.795970    0.292968    0.310374    3000        30.226700   0.381465    0.439667    170.670051 
[37m[36mINFO[0m[0m 03/04 23:43:37 | 0.294668    0.315476    0.869493    0.849796    0.412983    0.916425    0.898734    0.837206    0.843349    0.854849    0.807305    0.294668    0.315476    3200        32.241814   0.373919    0.434340    166.313644 
[37m[36mINFO[0m[0m 03/04 23:47:48 | 0.275547    0.262755    0.871548    0.859005    0.392913    0.929080    0.919831    0.826935    0.842322    0.858627    0.814861    0.275547    0.262755    3400        34.256927   0.355025    0.435872    163.600744 
[37m[36mINFO[0m[0m 03/04 23:52:06 | 0.283620    0.298469    0.884461    0.870248    0.372034    0.929607    0.921941    0.839646    0.836158    0.884131    0.852645    0.283620    0.298469    3600        36.272040   0.328429    0.433479    171.375656 
[37m[36mINFO[0m[0m 03/04 23:56:25 | 0.294243    0.301020    0.888868    0.864010    0.372517    0.940417    0.919831    0.850558    0.837185    0.875630    0.835013    0.294243    0.301020    3800        38.287154   0.312054    0.437030    171.444931 
[37m[36mINFO[0m[0m 03/05 00:00:40 | 0.310389    0.320578    0.893864    0.873696    0.338571    0.937516    0.917722    0.864039    0.846944    0.880038    0.856423    0.310389    0.320578    4000        40.302267   0.291441    0.440572    167.235793 
[37m[36mINFO[0m[0m 03/05 00:04:57 | 0.311663    0.309524    0.897470    0.884632    0.336009    0.933825    0.920886    0.865323    0.869029    0.893262    0.863980    0.311663    0.309524    4200        42.317380   0.287163    0.437344    169.361404 
[37m[36mINFO[0m[0m 03/05 00:09:09 | 0.305715    0.316327    0.901612    0.882446    0.348144    0.945689    0.935654    0.868404    0.860298    0.890743    0.851385    0.305715    0.316327    4400        44.332494   0.267382    0.437188    164.214473 
[37m[36mINFO[0m[0m 03/05 00:13:23 | 0.283195    0.299320    0.907656    0.880795    0.331863    0.950171    0.935654    0.874182    0.851567    0.898615    0.855164    0.283195    0.299320    4600        46.347607   0.264920    0.438975    166.390677 
[37m[36mINFO[0m[0m 03/05 00:17:35 | 0.300404    0.314626    0.907166    0.878711    0.355985    0.954126    0.930380    0.873796    0.853107    0.893577    0.852645    0.300404    0.314626    4800        48.362720   0.261717    0.437252    164.873921 
[37m[36mINFO[0m[0m 03/05 00:21:48 | 0.263862    0.274660    0.907064    0.887979    0.334490    0.947535    0.933544    0.873154    0.863893    0.900504    0.866499    0.263862    0.274660    5000        50.377834   0.256211    0.446542    164.092602 
[37m[36mINFO[0m[0m 03/05 00:21:49 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250304_22-32-54_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/05 00:21:51 | ---
[37m[36mINFO[0m[0m 03/05 00:21:51 | test-domain validation(oracle) = 31.039%
[37m[36mINFO[0m[0m 03/05 00:21:51 | training-domain validation(iid) = 26.386%
[37m[36mINFO[0m[0m 03/05 00:21:51 | last = 26.386%
[37m[36mINFO[0m[0m 03/05 00:21:51 | last (inD) = 88.798%
[37m[36mINFO[0m[0m 03/05 00:21:51 | training-domain validation (iid, inD) = 88.798%
[37m[36mINFO[0m[0m 03/05 00:21:51 | === Summary ===
[37m[36mINFO[0m[0m 03/05 00:21:51 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita
[37m[36mINFO[0m[0m 03/05 00:21:51 | Unique name: 250304_22-32-54_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/05 00:21:51 | Out path: train_output/TerraIncognita/ERM/[3]/250304_22-32-54_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/05 00:21:51 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/05 00:21:51 | Dataset: TerraIncognita

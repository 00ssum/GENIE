[37m[36mINFO[0m[0m 03/26 08:56:50 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 13
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 13
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250326_08-56-50_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250326_08-56-50_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00010514591448387436
	batch_size: 9
	weight_decay: 2.4366015497066046e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/26 08:56:50 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 08:56:50 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 08:56:50 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 08:56:50 | 
[37m[36mINFO[0m[0m 03/26 08:56:50 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/26 08:56:50 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/26 08:56:50 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/26 08:56:50 | Batch sizes for each domain: [9, 9, 9, 0] (total=27)
[37m[36mINFO[0m[0m 03/26 08:56:50 | steps-per-epoch for each domain: 421.44, 865.44, 352.89 -> min = 352.89
[37m[36mINFO[0m[0m 03/26 08:56:52 | # of params = 23528522
[37m[36mINFO[0m[0m 03/26 08:59:42 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 08:59:42 | 0.222860    0.207483    0.288403    0.273706    2.111636    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.222860    0.207483    0           0.000000    2.463258    1.111938    169.164225 
[37m[36mINFO[0m[0m 03/26 09:03:02 | 0.209475    0.208333    0.509553    0.499767    1.287512    0.605326    0.630802    0.597766    0.564972    0.325567    0.303526    0.209475    0.208333    200         0.566751    1.493474    0.169583    165.998893 
[37m[36mINFO[0m[0m 03/26 09:06:15 | 0.257701    0.245748    0.601296    0.593359    1.149853    0.711574    0.714135    0.619078    0.602465    0.473237    0.463476    0.257701    0.245748    400         1.133501    1.195663    0.143252    164.779041 
[37m[36mINFO[0m[0m 03/26 09:09:28 | 0.274272    0.250850    0.647517    0.635222    0.976646    0.758503    0.755274    0.690974    0.671803    0.493073    0.478589    0.274272    0.250850    600         1.700252    1.066163    0.139226    164.902437 
[37m[36mINFO[0m[0m 03/26 09:12:47 | 0.313576    0.306973    0.706161    0.701352    0.817560    0.830214    0.811181    0.750802    0.746276    0.537469    0.546599    0.313576    0.306973    800         2.267003    0.862206    0.146740    169.516007 
[37m[36mINFO[0m[0m 03/26 09:15:59 | 0.336308    0.326531    0.735965    0.727712    0.761172    0.837859    0.820675    0.745667    0.736518    0.624370    0.625945    0.336308    0.326531    1000        2.833753    0.817270    0.123857    166.989818 
[37m[36mINFO[0m[0m 03/26 09:19:15 | 0.385171    0.378401    0.726725    0.708112    0.792525    0.842868    0.814346    0.706638    0.692861    0.630668    0.617128    0.385171    0.378401    1200        3.400504    0.722834    0.162691    163.618952 
[37m[36mINFO[0m[0m 03/26 09:22:22 | 0.369875    0.364796    0.770694    0.771372    0.640153    0.842341    0.853376    0.783027    0.778120    0.686713    0.682620    0.369875    0.364796    1400        3.967254    0.632370    0.122661    162.545740 
[37m[36mINFO[0m[0m 03/26 09:25:40 | 0.375611    0.372449    0.768951    0.763430    0.661134    0.849987    0.844937    0.755039    0.737545    0.701826    0.707809    0.375611    0.372449    1600        4.534005    0.618865    0.141769    169.832615 
[37m[36mINFO[0m[0m 03/26 09:28:54 | 0.394944    0.397109    0.752275    0.756659    0.681789    0.866069    0.844937    0.725767    0.715973    0.664987    0.709068    0.394944    0.397109    1800        5.100756    0.623242    0.138938    166.311726 
[37m[36mINFO[0m[0m 03/26 09:32:13 | 0.334183    0.318027    0.791729    0.780468    0.592643    0.879251    0.864979    0.759789    0.742167    0.736146    0.734257    0.334183    0.318027    2000        5.667506    0.581551    0.166067    165.146269 
[37m[36mINFO[0m[0m 03/26 09:35:27 | 0.355641    0.353741    0.813179    0.806014    0.540985    0.893224    0.882911    0.786237    0.769389    0.760076    0.765743    0.355641    0.353741    2200        6.234257    0.560696    0.130325    168.668879 
[37m[36mINFO[0m[0m 03/26 09:38:44 | 0.325473    0.319728    0.812533    0.815463    0.519085    0.890061    0.882911    0.801001    0.802773    0.746537    0.760705    0.325473    0.319728    2400        6.801008    0.534207    0.150086    166.806648 
[37m[36mINFO[0m[0m 03/26 09:42:07 | 0.361589    0.363946    0.818719    0.804556    0.529705    0.885579    0.862869    0.810502    0.811505    0.760076    0.739295    0.361589    0.363946    2600        7.367758    0.519997    0.172458    167.805436 
[37m[36mINFO[0m[0m 03/26 09:45:25 | 0.301041    0.304422    0.831271    0.822617    0.497209    0.901661    0.879747    0.812556    0.799692    0.779597    0.788413    0.301041    0.304422    2800        7.934509    0.504683    0.146682    169.048198 
[37m[36mINFO[0m[0m 03/26 09:48:40 | 0.355216    0.347789    0.825443    0.800484    0.526401    0.890324    0.867089    0.810502    0.795069    0.775504    0.739295    0.355216    0.347789    3000        8.501259    0.515143    0.158425    162.976802 
[37m[36mINFO[0m[0m 03/26 09:51:58 | 0.363714    0.346939    0.827270    0.822640    0.511646    0.900870    0.881857    0.805752    0.811505    0.775189    0.774559    0.363714    0.346939    3200        9.068010    0.472878    0.147394    168.765421 
[37m[36mINFO[0m[0m 03/26 09:55:10 | 0.363076    0.349490    0.836865    0.823362    0.472818    0.901397    0.886076    0.821415    0.809450    0.787783    0.774559    0.363076    0.349490    3400        9.634761    0.444665    0.139170    164.678974 
[37m[36mINFO[0m[0m 03/26 09:58:20 | 0.334183    0.310374    0.817601    0.810212    0.510628    0.900606    0.886076    0.781102    0.775039    0.771096    0.769521    0.334183    0.310374    3600        10.201511   0.465209    0.125697    164.443290 
[37m[36mINFO[0m[0m 03/26 10:01:42 | 0.359465    0.363946    0.837693    0.829100    0.475046    0.915634    0.889241    0.809347    0.819723    0.788098    0.778338    0.359465    0.363946    3800        10.768262   0.452654    0.178129    166.362860 
[37m[36mINFO[0m[0m 03/26 10:04:51 | 0.363714    0.365646    0.836342    0.819857    0.504060    0.894806    0.866034    0.817306    0.820236    0.796914    0.773300    0.363714    0.365646    4000        11.335013   0.437790    0.122447    164.907918 
[37m[36mINFO[0m[0m 03/26 10:08:07 | 0.319524    0.311224    0.852276    0.840451    0.464845    0.920116    0.904008    0.841058    0.840267    0.795655    0.777078    0.319524    0.311224    4200        11.901763   0.453913    0.161535    163.701511 
[37m[36mINFO[0m[0m 03/26 10:11:30 | 0.279796    0.278061    0.850416    0.843334    0.460723    0.906407    0.889241    0.841315    0.839753    0.803526    0.801008    0.279796    0.278061    4400        12.468514   0.420665    0.166661    168.940762 
[37m[36mINFO[0m[0m 03/26 10:14:37 | 0.329297    0.323980    0.852811    0.841144    0.434623    0.925125    0.912447    0.840801    0.823832    0.792506    0.787154    0.329297    0.323980    4600        13.035264   0.415627    0.142117    158.775003 
[37m[36mINFO[0m[0m 03/26 10:17:54 | 0.340769    0.332483    0.848042    0.828738    0.470232    0.901397    0.869198    0.839517    0.836158    0.803212    0.780856    0.340769    0.332483    4800        13.602015   0.375988    0.147489    167.558420 
[37m[36mINFO[0m[0m 03/26 10:21:19 | 0.340344    0.340986    0.860377    0.835959    0.461043    0.918007    0.879747    0.839132    0.851053    0.823992    0.777078    0.340344    0.340986    5000        14.168766   0.420940    0.215906    162.225518 
[37m[36mINFO[0m[0m 03/26 10:21:19 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250326_08-56-50_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 10:21:21 | ---
[37m[36mINFO[0m[0m 03/26 10:21:21 | test-domain validation(oracle) = 39.494%
[37m[36mINFO[0m[0m 03/26 10:21:21 | training-domain validation(iid) = 27.980%
[37m[36mINFO[0m[0m 03/26 10:21:21 | last = 34.034%
[37m[36mINFO[0m[0m 03/26 10:21:21 | last (inD) = 83.596%
[37m[36mINFO[0m[0m 03/26 10:21:21 | training-domain validation (iid, inD) = 84.333%
[37m[36mINFO[0m[0m 03/26 10:21:21 | === Summary ===
[37m[36mINFO[0m[0m 03/26 10:21:21 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 13
[37m[36mINFO[0m[0m 03/26 10:21:21 | Unique name: 250326_08-56-50_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 10:21:21 | Out path: train_output/TerraIncognita/ERM/[3]/250326_08-56-50_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 10:21:21 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 10:21:21 | Dataset: TerraIncognita

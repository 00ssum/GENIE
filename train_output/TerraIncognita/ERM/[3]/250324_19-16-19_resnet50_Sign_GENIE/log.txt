[37m[36mINFO[0m[0m 03/24 19:16:19 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 6
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 6
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250324_19-16-19_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250324_19-16-19_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00016409882498047177
	batch_size: 16
	weight_decay: 0.00012909833738066306
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/24 19:16:19 | n_steps = 5001
[37m[36mINFO[0m[0m 03/24 19:16:19 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/24 19:16:19 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/24 19:16:19 | 
[37m[36mINFO[0m[0m 03/24 19:16:19 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/24 19:16:19 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/24 19:16:19 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/24 19:16:19 | Batch sizes for each domain: [16, 16, 16, 0] (total=48)
[37m[36mINFO[0m[0m 03/24 19:16:19 | steps-per-epoch for each domain: 237.06, 486.81, 198.50 -> min = 198.50
[37m[36mINFO[0m[0m 03/24 19:16:20 | # of params = 23528522
[37m[36mINFO[0m[0m 03/24 19:19:12 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/24 19:19:12 | 0.217761    0.229592    0.321848    0.286337    2.037731    0.315581    0.188819    0.461677    0.456086    0.188287    0.214106    0.217761    0.229592    0           0.000000    2.431343    1.089162    170.469855 
[37m[36mINFO[0m[0m 03/24 19:22:52 | 0.271935    0.288265    0.627836    0.635933    1.020150    0.740838    0.757384    0.647708    0.646636    0.494962    0.503778    0.271935    0.288265    200         1.007557    1.301302    0.257052    168.564982 
[37m[36mINFO[0m[0m 03/24 19:26:18 | 0.301678    0.316327    0.714317    0.731375    0.797901    0.810704    0.795359    0.725510    0.751412    0.606738    0.647355    0.301678    0.316327    400         2.015113    0.963343    0.180410    170.518130 
[37m[36mINFO[0m[0m 03/24 19:29:48 | 0.338007    0.342687    0.750650    0.758045    0.672187    0.860269    0.855485    0.757864    0.763739    0.633816    0.654912    0.338007    0.342687    600         3.022670    0.767568    0.188421    171.642705 
[37m[36mINFO[0m[0m 03/24 19:33:19 | 0.340557    0.328231    0.751095    0.749351    0.690199    0.839968    0.841772    0.776351    0.801746    0.636965    0.604534    0.340557    0.328231    800         4.030227    0.648317    0.201634    171.105043 
[37m[36mINFO[0m[0m 03/24 19:36:44 | 0.392819    0.392857    0.777976    0.793418    0.593272    0.829686    0.840717    0.789190    0.788906    0.715050    0.750630    0.392819    0.392857    1000        5.037783    0.603241    0.191637    166.939591 
[37m[36mINFO[0m[0m 03/24 19:40:10 | 0.372424    0.376701    0.780411    0.788210    0.593606    0.872133    0.858650    0.769162    0.772984    0.699937    0.732997    0.372424    0.376701    1200        6.045340    0.553136    0.153169    175.150151 
[37m[36mINFO[0m[0m 03/24 19:43:29 | 0.364351    0.363095    0.814565    0.829131    0.496088    0.900606    0.887131    0.808833    0.829481    0.734257    0.770781    0.364351    0.363095    1400        7.052897    0.534116    0.159263    167.088509 
[37m[36mINFO[0m[0m 03/24 19:47:15 | 0.371149    0.377551    0.835290    0.837388    0.474105    0.905088    0.890295    0.825908    0.839753    0.774874    0.782116    0.371149    0.377551    1600        8.060453    0.493194    0.270921    171.932017 
[37m[36mINFO[0m[0m 03/24 19:50:45 | 0.393669    0.403912    0.842887    0.834245    0.469997    0.909307    0.893460    0.832199    0.839753    0.787154    0.769521    0.393669    0.403912    1800        9.068010    0.479401    0.188573    171.754914 
[37m[36mINFO[0m[0m 03/24 19:54:05 | 0.385171    0.394558    0.806420    0.824196    0.548103    0.872924    0.863924    0.813968    0.834104    0.732368    0.774559    0.385171    0.394558    2000        10.075567   0.464933    0.188195    163.058382 
[37m[36mINFO[0m[0m 03/24 19:57:45 | 0.362014    0.373299    0.835523    0.832774    0.464590    0.886106    0.866034    0.834253    0.857730    0.786209    0.774559    0.362014    0.373299    2200        11.083123   0.468683    0.205381    178.971600 
[37m[36mINFO[0m[0m 03/24 20:01:23 | 0.326535    0.345238    0.850164    0.849567    0.435456    0.916425    0.906118    0.840930    0.842835    0.793136    0.799748    0.326535    0.345238    2400        12.090680   0.410634    0.226716    172.528469 
[37m[36mINFO[0m[0m 03/24 20:05:07 | 0.378798    0.364796    0.852022    0.850847    0.432009    0.903506    0.897679    0.839902    0.852594    0.812657    0.802267    0.378798    0.364796    2600        13.098237   0.402087    0.171233    189.136050 
[37m[36mINFO[0m[0m 03/24 20:08:38 | 0.330784    0.346088    0.856824    0.849306    0.429205    0.925125    0.894515    0.831429    0.842322    0.813917    0.811083    0.330784    0.346088    2800        14.105793   0.378904    0.172487    176.285397 
[37m[36mINFO[0m[0m 03/24 20:12:08 | 0.329297    0.329082    0.869010    0.866001    0.402737    0.921171    0.916667    0.859032    0.880329    0.826826    0.801008    0.329297    0.329082    3000        15.113350   0.371644    0.170910    176.172746 
[37m[36mINFO[0m[0m 03/24 20:15:51 | 0.368175    0.376701    0.874127    0.874426    0.357424    0.921698    0.913502    0.850558    0.865948    0.850126    0.843829    0.368175    0.376701    3200        16.120907   0.378045    0.176225    187.461352 
[37m[36mINFO[0m[0m 03/24 20:19:23 | 0.267049    0.271259    0.870323    0.869053    0.389954    0.920380    0.912447    0.856207    0.868516    0.834383    0.826196    0.267049    0.271259    3400        17.128463   0.333705    0.173974    177.715307 
[37m[36mINFO[0m[0m 03/24 20:22:55 | 0.360739    0.374150    0.871337    0.869941    0.379301    0.917743    0.888186    0.853383    0.880329    0.842884    0.841310    0.360739    0.374150    3600        18.136020   0.340423    0.180762    175.531555 
[37m[36mINFO[0m[0m 03/24 20:26:21 | 0.377098    0.380952    0.897053    0.884576    0.331847    0.949117    0.929325    0.873026    0.893169    0.869018    0.831234    0.377098    0.380952    3800        19.143577   0.347997    0.174231    171.360214 
[37m[36mINFO[0m[0m 03/24 20:30:00 | 0.331634    0.340986    0.859801    0.853507    0.396082    0.936198    0.904008    0.864553    0.873138    0.778652    0.783375    0.331634    0.340986    4000        20.151134   0.313288    0.260609    166.702709 
[37m[36mINFO[0m[0m 03/24 20:33:25 | 0.309539    0.317177    0.896148    0.885260    0.317418    0.949380    0.920886    0.878547    0.888546    0.860516    0.846348    0.309539    0.317177    4200        21.158690   0.313333    0.196781    165.371418 
[37m[36mINFO[0m[0m 03/24 20:36:45 | 0.299554    0.307823    0.905757    0.888318    0.322489    0.950699    0.921941    0.891257    0.891628    0.875315    0.851385    0.299554    0.307823    4400        22.166247   0.288868    0.158148    168.907646 
[37m[36mINFO[0m[0m 03/24 20:40:11 | 0.400467    0.411565    0.898604    0.878319    0.345888    0.944898    0.929325    0.882527    0.873138    0.868388    0.832494    0.400467    0.411565    4600        23.173804   0.297484    0.165484    172.773527 
[37m[36mINFO[0m[0m 03/24 20:43:34 | 0.329297    0.351190    0.902060    0.879781    0.341618    0.947535    0.924051    0.881756    0.877761    0.876889    0.837531    0.329297    0.351190    4800        24.181360   0.285948    0.157465    171.829876 
[37m[36mINFO[0m[0m 03/24 20:46:55 | 0.377948    0.391156    0.895767    0.875360    0.352951    0.947008    0.921941    0.870330    0.874165    0.869962    0.829975    0.377948    0.391156    5000        25.188917   0.283956    0.159773    168.258100 
[37m[36mINFO[0m[0m 03/24 20:46:55 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250324_19-16-19_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/24 20:46:56 | ---
[37m[36mINFO[0m[0m 03/24 20:46:56 | test-domain validation(oracle) = 40.047%
[37m[36mINFO[0m[0m 03/24 20:46:56 | training-domain validation(iid) = 29.955%
[37m[36mINFO[0m[0m 03/24 20:46:56 | last = 37.795%
[37m[36mINFO[0m[0m 03/24 20:46:56 | last (inD) = 87.536%
[37m[36mINFO[0m[0m 03/24 20:46:56 | training-domain validation (iid, inD) = 88.832%
[37m[36mINFO[0m[0m 03/24 20:46:56 | === Summary ===
[37m[36mINFO[0m[0m 03/24 20:46:56 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 6
[37m[36mINFO[0m[0m 03/24 20:46:56 | Unique name: 250324_19-16-19_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 20:46:56 | Out path: train_output/TerraIncognita/ERM/[3]/250324_19-16-19_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 20:46:56 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/24 20:46:56 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 03/26 04:24:59 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 9
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 9
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250326_04-24-59_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250326_04-24-59_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.716671579524612e-05
	batch_size: 29
	weight_decay: 1.71368232883332e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/26 04:25:00 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 04:25:00 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 04:25:00 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 04:25:00 | 
[37m[36mINFO[0m[0m 03/26 04:25:00 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/26 04:25:00 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/26 04:25:00 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/26 04:25:00 | Batch sizes for each domain: [29, 29, 29, 0] (total=87)
[37m[36mINFO[0m[0m 03/26 04:25:00 | steps-per-epoch for each domain: 130.79, 268.59, 109.52 -> min = 109.52
[37m[36mINFO[0m[0m 03/26 04:25:01 | # of params = 23528522
[37m[36mINFO[0m[0m 03/26 04:27:49 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 04:27:49 | 0.222860    0.207483    0.288403    0.273706    2.064700    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.222860    0.207483    0           0.000000    2.458118    1.115481    167.562289 
[37m[36mINFO[0m[0m 03/26 04:31:26 | 0.248141    0.255102    0.616051    0.623589    1.052969    0.734775    0.736287    0.620619    0.616846    0.492758    0.517632    0.248141    0.255102    200         1.826196    1.275121    0.268365    163.108835 
[37m[36mINFO[0m[0m 03/26 04:35:05 | 0.265137    0.258503    0.710712    0.718444    0.796393    0.803058    0.804852    0.740917    0.742167    0.588161    0.608312    0.265137    0.258503    400         3.652393    0.895847    0.273900    164.182570 
[37m[36mINFO[0m[0m 03/26 04:38:41 | 0.334396    0.341837    0.769573    0.777812    0.634358    0.851569    0.841772    0.773270    0.775039    0.683879    0.716625    0.334396    0.341837    600         5.478589    0.688257    0.245656    166.738666 
[37m[36mINFO[0m[0m 03/26 04:42:20 | 0.318249    0.314626    0.815923    0.804517    0.539801    0.893488    0.872363    0.817820    0.809450    0.736461    0.731738    0.318249    0.314626    800         7.304786    0.579854    0.246476    170.058812 
[37m[36mINFO[0m[0m 03/26 04:46:09 | 0.336945    0.332483    0.809093    0.796282    0.579039    0.896124    0.878692    0.803826    0.793529    0.727330    0.716625    0.336945    0.332483    1000        9.130982    0.511092    0.290466    170.204285 
[37m[36mINFO[0m[0m 03/26 04:49:53 | 0.352454    0.350340    0.838652    0.822215    0.497305    0.883206    0.856540    0.831429    0.830508    0.801322    0.779597    0.352454    0.350340    1200        10.957179   0.458927    0.275664    168.741198 
[37m[36mINFO[0m[0m 03/26 04:53:32 | 0.315488    0.301871    0.822550    0.803843    0.557453    0.890852    0.867089    0.803184    0.795069    0.773615    0.749370    0.315488    0.301871    1400        12.783375   0.433536    0.274510    164.810828 
[37m[36mINFO[0m[0m 03/26 04:57:23 | 0.388358    0.367347    0.851263    0.839162    0.462926    0.905088    0.898734    0.842342    0.847971    0.806360    0.770781    0.388358    0.367347    1600        14.609572   0.412954    0.313278    167.955679 
[37m[36mINFO[0m[0m 03/26 05:01:09 | 0.303378    0.289966    0.873297    0.859690    0.397876    0.929871    0.904008    0.855951    0.855162    0.834068    0.819899    0.303378    0.289966    1800        16.435768   0.373586    0.310308    163.681823 
[37m[36mINFO[0m[0m 03/26 05:04:45 | 0.307839    0.305272    0.879989    0.848759    0.403843    0.938571    0.900844    0.864809    0.846944    0.836587    0.798489    0.307839    0.305272    2000        18.261965   0.353749    0.247750    166.496842 
[37m[36mINFO[0m[0m 03/26 05:08:20 | 0.349479    0.346088    0.875538    0.851851    0.421141    0.942262    0.919831    0.855951    0.839753    0.828401    0.795970    0.349479    0.346088    2200        20.088161   0.341668    0.247841    165.963451 
[37m[36mINFO[0m[0m 03/26 05:12:19 | 0.406841    0.380952    0.890117    0.875042    0.364460    0.937253    0.930380    0.859674    0.857216    0.873426    0.837531    0.406841    0.380952    2400        21.914358   0.306268    0.324554    174.028076 
[37m[36mINFO[0m[0m 03/26 05:15:58 | 0.337370    0.324830    0.882075    0.860645    0.413058    0.936989    0.913502    0.853126    0.851053    0.856108    0.817380    0.337370    0.324830    2600        23.740554   0.300911    0.285558    161.945442 
[37m[36mINFO[0m[0m 03/26 05:19:44 | 0.355641    0.334184    0.906762    0.881834    0.338711    0.945689    0.918776    0.892669    0.882897    0.881927    0.843829    0.355641    0.334184    2800        25.566751   0.285985    0.299320    166.045582 
[37m[36mINFO[0m[0m 03/26 05:23:38 | 0.342894    0.326531    0.908695    0.887028    0.330323    0.957290    0.924051    0.885608    0.881870    0.883186    0.855164    0.342894    0.326531    3000        27.392947   0.264595    0.337295    166.026825 
[37m[36mINFO[0m[0m 03/26 05:27:19 | 0.296792    0.288265    0.909564    0.883237    0.328263    0.961244    0.939873    0.894338    0.882383    0.873111    0.827456    0.296792    0.288265    3200        29.219144   0.241631    0.247426    172.168157 
[37m[36mINFO[0m[0m 03/26 05:30:53 | 0.285107    0.278061    0.912683    0.888728    0.307410    0.947799    0.912447    0.884709    0.885978    0.905542    0.867758    0.285107    0.278061    3400        31.045340   0.244967    0.235311    167.017341 
[37m[36mINFO[0m[0m 03/26 05:34:27 | 0.378160    0.368197    0.914348    0.886998    0.327309    0.961772    0.934599    0.886121    0.878788    0.895151    0.847607    0.378160    0.368197    3600        32.871537   0.235925    0.237120    166.193345 
[37m[36mINFO[0m[0m 03/26 05:38:17 | 0.297642    0.284014    0.916048    0.893007    0.332578    0.967045    0.934599    0.903582    0.899332    0.877519    0.845088    0.297642    0.284014    3800        34.697733   0.240558    0.304284    169.454035 
[37m[36mINFO[0m[0m 03/26 05:41:52 | 0.362014    0.357993    0.929457    0.907265    0.285233    0.969417    0.939873    0.903967    0.897791    0.914987    0.884131    0.362014    0.357993    4000        36.523929   0.229008    0.239548    167.191483 
[37m[36mINFO[0m[0m 03/26 05:45:36 | 0.338432    0.319728    0.927445    0.890433    0.312623    0.959663    0.913502    0.900757    0.887519    0.921914    0.870277    0.338432    0.319728    4200        38.350126   0.208623    0.259205    172.024926 
[37m[36mINFO[0m[0m 03/26 05:49:19 | 0.289994    0.273810    0.908472    0.886685    0.321573    0.942789    0.911392    0.901014    0.897278    0.881612    0.851385    0.289994    0.273810    4400        40.176322   0.199636    0.277592    166.736416 
[37m[36mINFO[0m[0m 03/26 05:53:03 | 0.349267    0.327381    0.937712    0.914531    0.292736    0.976536    0.953586    0.921299    0.912173    0.915302    0.877834    0.349267    0.327381    4600        42.002519   0.198205    0.305560    163.084876 
[37m[36mINFO[0m[0m 03/26 05:56:38 | 0.374336    0.363946    0.934967    0.908364    0.274141    0.967045    0.946203    0.914366    0.897278    0.923489    0.881612    0.374336    0.363946    4800        43.828715   0.190356    0.265379    162.418633 
[37m[36mINFO[0m[0m 03/26 06:00:18 | 0.331421    0.318027    0.934320    0.900241    0.309624    0.968890    0.938819    0.907434    0.891628    0.926637    0.870277    0.331421    0.318027    5000        45.654912   0.180119    0.227336    174.407274 
[37m[36mINFO[0m[0m 03/26 06:00:18 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250326_04-24-59_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 06:00:20 | ---
[37m[36mINFO[0m[0m 03/26 06:00:20 | test-domain validation(oracle) = 40.684%
[37m[36mINFO[0m[0m 03/26 06:00:20 | training-domain validation(iid) = 34.927%
[37m[36mINFO[0m[0m 03/26 06:00:20 | last = 33.142%
[37m[36mINFO[0m[0m 03/26 06:00:20 | last (inD) = 90.024%
[37m[36mINFO[0m[0m 03/26 06:00:20 | training-domain validation (iid, inD) = 91.453%
[37m[36mINFO[0m[0m 03/26 06:00:20 | === Summary ===
[37m[36mINFO[0m[0m 03/26 06:00:20 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 9
[37m[36mINFO[0m[0m 03/26 06:00:20 | Unique name: 250326_04-24-59_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 06:00:20 | Out path: train_output/TerraIncognita/ERM/[3]/250326_04-24-59_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 06:00:20 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 06:00:20 | Dataset: TerraIncognita

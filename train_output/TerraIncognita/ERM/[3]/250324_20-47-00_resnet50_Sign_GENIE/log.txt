[37m[36mINFO[0m[0m 03/24 20:47:00 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 7
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 7
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250324_20-47-00_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250324_20-47-00_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00025471109765784857
	batch_size: 39
	weight_decay: 9.10622179414602e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/24 20:47:00 | n_steps = 5001
[37m[36mINFO[0m[0m 03/24 20:47:00 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/24 20:47:00 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/24 20:47:00 | 
[37m[36mINFO[0m[0m 03/24 20:47:00 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/24 20:47:00 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/24 20:47:00 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/24 20:47:00 | Batch sizes for each domain: [39, 39, 39, 0] (total=117)
[37m[36mINFO[0m[0m 03/24 20:47:00 | steps-per-epoch for each domain: 97.26, 199.72, 81.44 -> min = 81.44
[37m[36mINFO[0m[0m 03/24 20:47:01 | # of params = 23528522
[37m[36mINFO[0m[0m 03/24 20:50:07 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/24 20:50:07 | 0.217336    0.229592    0.297837    0.283001    2.028079    0.243607    0.179325    0.461933    0.455573    0.187972    0.214106    0.217336    0.229592    0           0.000000    2.451335    1.292289    184.720377 
[37m[36mINFO[0m[0m 03/24 20:54:16 | 0.223709    0.228741    0.624854    0.616703    1.027572    0.765621    0.750000    0.642316    0.624037    0.466625    0.476071    0.223709    0.228741    200         2.455919    1.279014    0.402711    168.654584 
[37m[36mINFO[0m[0m 03/24 20:58:03 | 0.278096    0.286565    0.741967    0.759309    0.718773    0.844978    0.843882    0.738606    0.765280    0.642317    0.668766    0.278096    0.286565    400         4.911839    0.916911    0.297268    166.677680 
[37m[36mINFO[0m[0m 03/24 21:01:54 | 0.261100    0.262755    0.787416    0.789944    0.604644    0.869496    0.851266    0.787778    0.812018    0.704975    0.706549    0.261100    0.262755    600         7.367758    0.698210    0.303574    170.977018 
[37m[36mINFO[0m[0m 03/24 21:06:04 | 0.312938    0.317177    0.804953    0.806966    0.535864    0.873715    0.882911    0.812556    0.826400    0.728589    0.711587    0.312938    0.317177    800         9.823678    0.584154    0.371085    175.853775 
[37m[36mINFO[0m[0m 03/24 21:09:59 | 0.354791    0.357993    0.816454    0.814531    0.563599    0.896652    0.879747    0.781615    0.795583    0.771096    0.768262    0.354791    0.357993    1000        12.279597   0.514676    0.343933    165.547448 
[37m[36mINFO[0m[0m 03/24 21:13:44 | 0.290843    0.313776    0.836988    0.842415    0.454644    0.899815    0.887131    0.824624    0.845403    0.786524    0.794710    0.290843    0.313776    1200        14.735516   0.495282    0.298291    165.459270 
[37m[36mINFO[0m[0m 03/24 21:17:53 | 0.334183    0.332483    0.853539    0.847669    0.426277    0.916161    0.898734    0.840930    0.852080    0.803526    0.792191    0.334183    0.332483    1400        17.191436   0.443653    0.346532    180.155135 
[37m[36mINFO[0m[0m 03/24 21:22:14 | 0.349055    0.359694    0.855363    0.844961    0.423938    0.912734    0.877637    0.841957    0.858757    0.811398    0.798489    0.349055    0.359694    1600        19.647355   0.409672    0.373798    185.783784 
[37m[36mINFO[0m[0m 03/24 21:26:24 | 0.364776    0.365646    0.890084    0.880729    0.347674    0.938044    0.921941    0.865708    0.886492    0.866499    0.833753    0.364776    0.365646    1800        22.103275   0.366299    0.342524    181.720371 
[37m[36mINFO[0m[0m 03/24 21:30:50 | 0.336095    0.348639    0.887881    0.890033    0.323084    0.941735    0.936709    0.863911    0.875706    0.857997    0.857683    0.336095    0.348639    2000        24.559194   0.341446    0.418877    182.550952 
[37m[36mINFO[0m[0m 03/24 21:34:43 | 0.367963    0.372449    0.894799    0.884589    0.332699    0.939626    0.907173    0.870715    0.881356    0.874055    0.865239    0.367963    0.372449    2200        27.015113   0.318489    0.328595    166.619256 
[37m[36mINFO[0m[0m 03/24 21:38:34 | 0.336308    0.355442    0.897000    0.881818    0.327375    0.932507    0.918776    0.880344    0.880329    0.878149    0.846348    0.336308    0.355442    2400        29.471033   0.319796    0.313720    168.071067 
[37m[36mINFO[0m[0m 03/24 21:42:21 | 0.330784    0.330782    0.907532    0.886703    0.341930    0.949117    0.920886    0.883682    0.877761    0.889798    0.861461    0.330784    0.330782    2600        31.926952   0.288463    0.307673    165.651066 
[37m[36mINFO[0m[0m 03/24 21:46:16 | 0.366051    0.374150    0.908548    0.900153    0.308948    0.946480    0.932489    0.887790    0.892655    0.891373    0.875315    0.366051    0.374150    2800        34.382872   0.271653    0.319278    171.481844 
[37m[36mINFO[0m[0m 03/24 21:50:07 | 0.376248    0.385204    0.911468    0.894045    0.303034    0.955972    0.937764    0.892412    0.896764    0.886020    0.847607    0.376248    0.385204    3000        36.838791   0.265128    0.324888    166.256345 
[37m[36mINFO[0m[0m 03/24 21:54:21 | 0.331846    0.334184    0.920146    0.903169    0.291022    0.955972    0.935654    0.897034    0.897278    0.907431    0.876574    0.331846    0.334184    3200        39.294710   0.250136    0.373610    178.934803 
[37m[36mINFO[0m[0m 03/24 21:58:39 | 0.374761    0.383503    0.919707    0.901310    0.283665    0.957817    0.931435    0.896392    0.892142    0.904912    0.880353    0.374761    0.383503    3400        41.750630   0.238159    0.358317    186.663959 
[37m[36mINFO[0m[0m 03/24 22:02:45 | 0.349055    0.352041    0.925417    0.904891    0.303074    0.963881    0.941983    0.908717    0.902414    0.903652    0.870277    0.349055    0.352041    3600        44.206549   0.225731    0.337964    177.879033 
[37m[36mINFO[0m[0m 03/24 22:06:35 | 0.356703    0.367347    0.934217    0.906514    0.292100    0.964935    0.930380    0.913596    0.907550    0.924118    0.881612    0.356703    0.367347    3800        46.662469   0.216539    0.312718    167.728851 
[37m[36mINFO[0m[0m 03/24 22:10:34 | 0.366475    0.365646    0.922164    0.894033    0.321241    0.961772    0.926160    0.897291    0.895737    0.907431    0.860202    0.366475    0.365646    4000        49.118388   0.203159    0.334161    172.152601 
[37m[36mINFO[0m[0m 03/24 22:14:45 | 0.355853    0.357993    0.941055    0.922747    0.228150    0.973108    0.952532    0.920272    0.912686    0.929786    0.903023    0.355853    0.357993    4200        51.574307   0.194705    0.331540    184.619130 
[37m[36mINFO[0m[0m 03/24 22:18:59 | 0.369662    0.374150    0.944219    0.920219    0.239604    0.978118    0.951477    0.924124    0.913713    0.930416    0.895466    0.369662    0.374150    4400        54.030227   0.192711    0.368497    180.164027 
[37m[36mINFO[0m[0m 03/24 22:23:14 | 0.353728    0.365646    0.933990    0.907612    0.272058    0.968890    0.944093    0.908332    0.889574    0.924748    0.889169    0.353728    0.365646    4600        56.486146   0.188946    0.349571    184.870058 
[37m[36mINFO[0m[0m 03/24 22:27:19 | 0.350754    0.348639    0.927226    0.904258    0.260949    0.974954    0.945148    0.880087    0.874679    0.926637    0.892947    0.350754    0.348639    4800        58.942065   0.183610    0.348603    175.357247 
[37m[36mINFO[0m[0m 03/24 22:31:05 | 0.348842    0.357143    0.943604    0.924217    0.218660    0.973636    0.951477    0.927077    0.921931    0.930101    0.899244    0.348842    0.357143    5000        61.397985   0.179570    0.314840    163.122149 
[37m[36mINFO[0m[0m 03/24 22:31:05 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250324_20-47-00_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/24 22:31:06 | ---
[37m[36mINFO[0m[0m 03/24 22:31:06 | test-domain validation(oracle) = 37.625%
[37m[36mINFO[0m[0m 03/24 22:31:06 | training-domain validation(iid) = 34.884%
[37m[36mINFO[0m[0m 03/24 22:31:06 | last = 34.884%
[37m[36mINFO[0m[0m 03/24 22:31:06 | last (inD) = 92.422%
[37m[36mINFO[0m[0m 03/24 22:31:06 | training-domain validation (iid, inD) = 92.422%
[37m[36mINFO[0m[0m 03/24 22:31:06 | === Summary ===
[37m[36mINFO[0m[0m 03/24 22:31:06 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 7
[37m[36mINFO[0m[0m 03/24 22:31:06 | Unique name: 250324_20-47-00_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 22:31:06 | Out path: train_output/TerraIncognita/ERM/[3]/250324_20-47-00_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 22:31:06 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/24 22:31:06 | Dataset: TerraIncognita

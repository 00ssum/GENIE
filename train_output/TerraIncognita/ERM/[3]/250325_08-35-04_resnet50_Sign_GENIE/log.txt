[37m[36mINFO[0m[0m 03/25 08:35:04 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 14
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 14
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250325_08-35-04_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250325_08-35-04_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00011127987942826837
	batch_size: 12
	weight_decay: 3.236767350601091e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/25 08:35:04 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 08:35:04 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 08:35:04 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 08:35:04 | 
[37m[36mINFO[0m[0m 03/25 08:35:04 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/25 08:35:04 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/25 08:35:04 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/25 08:35:04 | Batch sizes for each domain: [12, 12, 12, 0] (total=36)
[37m[36mINFO[0m[0m 03/25 08:35:04 | steps-per-epoch for each domain: 316.08, 649.08, 264.67 -> min = 264.67
[37m[36mINFO[0m[0m 03/25 08:35:06 | # of params = 23528522
[37m[36mINFO[0m[0m 03/25 08:38:26 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 08:38:26 | 0.215849    0.229592    0.329076    0.290409    2.031568    0.334300    0.184599    0.465272    0.472522    0.187657    0.214106    0.215849    0.229592    0           0.000000    2.443512    1.327271    199.048284 
[37m[36mINFO[0m[0m 03/25 08:42:17 | 0.286807    0.300170    0.534174    0.545637    1.185190    0.624835    0.639241    0.585056    0.575758    0.392632    0.421914    0.286807    0.300170    200         0.755668    1.379947    0.163680    198.401345 
[37m[36mINFO[0m[0m 03/25 08:46:04 | 0.284257    0.290816    0.659195    0.676002    0.912400    0.785131    0.786920    0.676082    0.685670    0.516373    0.555416    0.284257    0.290816    400         1.511335    1.091590    0.152865    195.753746 
[37m[36mINFO[0m[0m 03/25 08:49:49 | 0.317825    0.327381    0.723044    0.738554    0.773226    0.818877    0.828059    0.728720    0.733950    0.621537    0.653652    0.317825    0.327381    600         2.267003    0.893762    0.159800    193.115145 
[37m[36mINFO[0m[0m 03/25 08:53:38 | 0.260676    0.249150    0.726370    0.726900    0.758568    0.824941    0.823840    0.735781    0.733436    0.618388    0.623426    0.260676    0.249150    800         3.022670    0.810846    0.147771    200.064672 
[37m[36mINFO[0m[0m 03/25 08:57:28 | 0.349055    0.363946    0.753293    0.767686    0.641211    0.827577    0.832278    0.778020    0.789420    0.654282    0.681360    0.349055    0.363946    1000        3.778338    0.683687    0.182046    193.587553 
[37m[36mINFO[0m[0m 03/25 09:01:06 | 0.324198    0.328231    0.769308    0.766887    0.642777    0.847878    0.832278    0.766722    0.769389    0.693325    0.698992    0.324198    0.328231    1200        4.534005    0.631355    0.158279    185.687931 
[37m[36mINFO[0m[0m 03/25 09:04:55 | 0.315912    0.324830    0.795273    0.800672    0.538874    0.866333    0.862869    0.792785    0.821263    0.726700    0.717884    0.315912    0.324830    1400        5.289673    0.602743    0.146683    199.596204 
[37m[36mINFO[0m[0m 03/25 09:08:54 | 0.329509    0.329082    0.809050    0.825619    0.540523    0.888215    0.877637    0.792400    0.814587    0.746537    0.784635    0.329509    0.329082    1600        6.045340    0.587810    0.205307    197.910917 
[37m[36mINFO[0m[0m 03/25 09:12:46 | 0.369237    0.375000    0.819648    0.828613    0.500310    0.893224    0.886076    0.816665    0.842835    0.749055    0.756927    0.369237    0.375000    1800        6.801008    0.528793    0.150170    202.036825 
[37m[36mINFO[0m[0m 03/25 09:16:38 | 0.344381    0.347789    0.822451    0.816135    0.511127    0.890852    0.866034    0.797535    0.802773    0.778967    0.779597    0.344381    0.347789    2000        7.556675    0.536012    0.160449    199.940865 
[37m[36mINFO[0m[0m 03/25 09:20:29 | 0.359465    0.377551    0.813800    0.816014    0.524141    0.899552    0.883966    0.789960    0.794556    0.751889    0.769521    0.359465    0.377551    2200        8.312343    0.486259    0.197822    191.576313 
[37m[36mINFO[0m[0m 03/25 09:24:18 | 0.313151    0.332483    0.819710    0.814529    0.520605    0.895861    0.857595    0.813583    0.834104    0.749685    0.751889    0.313151    0.332483    2400        9.068010    0.490971    0.138005    201.770326 
[37m[36mINFO[0m[0m 03/25 09:28:03 | 0.386446    0.380952    0.826800    0.824874    0.497146    0.899288    0.886076    0.814739    0.822804    0.766373    0.765743    0.386446    0.380952    2600        9.823678    0.463451    0.169032    190.850899 
[37m[36mINFO[0m[0m 03/25 09:31:56 | 0.319524    0.327381    0.845093    0.844408    0.421868    0.904297    0.890295    0.834382    0.860812    0.796599    0.782116    0.319524    0.327381    2800        10.579345   0.437990    0.171348    198.456119 
[37m[36mINFO[0m[0m 03/25 09:35:49 | 0.332484    0.341837    0.851692    0.843296    0.431390    0.917216    0.891350    0.831814    0.855162    0.806045    0.783375    0.332484    0.341837    3000        11.335013   0.452626    0.143397    204.359672 
[37m[36mINFO[0m[0m 03/25 09:39:29 | 0.342469    0.348639    0.835621    0.827291    0.476029    0.898234    0.893460    0.824624    0.828968    0.784005    0.759446    0.342469    0.348639    3200        12.090680   0.427466    0.160084    188.396279 
[37m[36mINFO[0m[0m 03/25 09:43:16 | 0.371574    0.378401    0.850453    0.848651    0.440073    0.916952    0.899789    0.802542    0.832563    0.831864    0.813602    0.371574    0.378401    3400        12.846348   0.414672    0.155252    195.546872 
[37m[36mINFO[0m[0m 03/25 09:47:20 | 0.365626    0.373299    0.861569    0.866455    0.404257    0.925389    0.922996    0.834382    0.857730    0.824937    0.818640    0.365626    0.373299    3600        13.602015   0.382503    0.197076    204.562750 
[37m[36mINFO[0m[0m 03/25 09:51:10 | 0.311876    0.325680    0.834987    0.823913    0.510039    0.905352    0.886076    0.817178    0.829995    0.782431    0.755668    0.311876    0.325680    3800        14.357683   0.378033    0.157759    198.698569 
[37m[36mINFO[0m[0m 03/25 09:54:49 | 0.328235    0.335884    0.866085    0.864970    0.393790    0.930925    0.910338    0.848376    0.852080    0.818955    0.832494    0.328235    0.335884    4000        15.113350   0.373496    0.136166    191.626215 
[37m[36mINFO[0m[0m 03/25 09:58:42 | 0.353304    0.352891    0.868978    0.868628    0.378081    0.934880    0.915612    0.835152    0.860298    0.836902    0.829975    0.353304    0.352891    4200        15.869018   0.357984    0.177694    197.467087 
[37m[36mINFO[0m[0m 03/25 10:02:27 | 0.352241    0.346088    0.864371    0.853014    0.406845    0.914052    0.897679    0.819489    0.823832    0.859572    0.837531    0.352241    0.346088    4400        16.624685   0.357484    0.145106    196.732084 
[37m[36mINFO[0m[0m 03/25 10:06:20 | 0.317825    0.316327    0.879369    0.864349    0.393357    0.937253    0.911392    0.859546    0.870570    0.841310    0.811083    0.317825    0.316327    4600        17.380353   0.355976    0.161655    199.903588 
[37m[36mINFO[0m[0m 03/25 10:10:20 | 0.340344    0.335884    0.887592    0.879189    0.344285    0.939362    0.927215    0.866992    0.882897    0.856423    0.827456    0.340344    0.335884    4800        18.136020   0.334690    0.166871    206.904673 
[37m[36mINFO[0m[0m 03/25 10:14:13 | 0.379010    0.374150    0.887518    0.879216    0.341024    0.932771    0.925105    0.867377    0.878788    0.862406    0.833753    0.379010    0.374150    5000        18.891688   0.330706    0.153763    201.839026 
[37m[36mINFO[0m[0m 03/25 10:14:13 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250325_08-35-04_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 10:14:15 | ---
[37m[36mINFO[0m[0m 03/25 10:14:15 | test-domain validation(oracle) = 38.645%
[37m[36mINFO[0m[0m 03/25 10:14:15 | training-domain validation(iid) = 37.901%
[37m[36mINFO[0m[0m 03/25 10:14:15 | last = 37.901%
[37m[36mINFO[0m[0m 03/25 10:14:15 | last (inD) = 87.922%
[37m[36mINFO[0m[0m 03/25 10:14:15 | training-domain validation (iid, inD) = 87.922%
[37m[36mINFO[0m[0m 03/25 10:14:15 | === Summary ===
[37m[36mINFO[0m[0m 03/25 10:14:15 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 14
[37m[36mINFO[0m[0m 03/25 10:14:15 | Unique name: 250325_08-35-04_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 10:14:15 | Out path: train_output/TerraIncognita/ERM/[3]/250325_08-35-04_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 10:14:15 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 10:14:15 | Dataset: TerraIncognita

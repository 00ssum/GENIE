[37m[36mINFO[0m[0m 02/27 16:54:34 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_adam config/clip_vitb16_adam.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_adam.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_adam
	out_dir: train_output/TerraIncognita/ERM/[3]/250227_16-54-34_clip_vitb16_adam
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250227_16-54-34_clip_vitb16_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: clip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/27 16:54:34 | n_steps = 5001
[37m[36mINFO[0m[0m 02/27 16:54:34 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/27 16:54:34 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/27 16:54:34 | 
[37m[36mINFO[0m[0m 02/27 16:54:34 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 02/27 16:54:34 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 02/27 16:54:34 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/27 16:54:34 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 02/27 16:54:34 | steps-per-epoch for each domain: 118.53, 243.41, 99.25 -> min = 99.25
[37m[36mINFO[0m[0m 02/27 16:54:38 | # of params = 86197770
[37m[36mINFO[0m[0m 02/27 16:57:39 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/27 16:57:39 | 0.222222    0.210034    0.280848    0.303925    2.033134    0.200633    0.208861    0.455514    0.481253    0.186398    0.221662    0.222222    0.210034    0           0.000000    2.218522    1.162606    179.790267 
[37m[36mINFO[0m[0m 02/27 17:01:59 | 0.331209    0.330782    0.750590    0.758729    0.671825    0.843923    0.847046    0.750417    0.759117    0.657431    0.670025    0.331209    0.330782    200         2.015113    1.029389    0.406206    178.923591 
[37m[36mINFO[0m[0m 02/27 17:06:18 | 0.304015    0.302721    0.785959    0.780980    0.617949    0.870551    0.858650    0.770702    0.771443    0.716625    0.712846    0.304015    0.302721    400         4.030227    0.645743    0.410307    177.270512 
[37m[36mINFO[0m[0m 02/27 17:10:36 | 0.384321    0.382653    0.822166    0.824704    0.507981    0.896652    0.882911    0.815124    0.816641    0.754723    0.774559    0.384321    0.382653    600         6.045340    0.552106    0.414929    175.089772 
[37m[36mINFO[0m[0m 02/27 17:14:55 | 0.316762    0.343537    0.826302    0.831177    0.515629    0.894279    0.882911    0.820773    0.831022    0.763854    0.779597    0.316762    0.343537    800         8.060453    0.488284    0.419462    174.771366 
[37m[36mINFO[0m[0m 02/27 17:19:20 | 0.346505    0.361395    0.843028    0.842069    0.452206    0.910888    0.904008    0.827577    0.843862    0.790617    0.778338    0.346505    0.361395    1000        10.075567   0.446882    0.408277    183.069864 
[37m[36mINFO[0m[0m 02/27 17:23:36 | 0.345868    0.357143    0.853007    0.847852    0.412082    0.917743    0.907173    0.845937    0.847971    0.795340    0.788413    0.345868    0.357143    1200        12.090680   0.408176    0.407970    174.916696 
[37m[36mINFO[0m[0m 02/27 17:27:57 | 0.383684    0.373299    0.858556    0.864478    0.398179    0.902452    0.910338    0.843240    0.866975    0.829975    0.816121    0.383684    0.373299    1400        14.105793   0.386976    0.409115    178.625082 
[37m[36mINFO[0m[0m 02/27 17:32:14 | 0.274910    0.296769    0.874879    0.866661    0.379727    0.937780    0.928270    0.855309    0.864407    0.831549    0.807305    0.274910    0.296769    1600        16.120907   0.367597    0.406755    176.508440 
[37m[36mINFO[0m[0m 02/27 17:36:35 | 0.364776    0.382653    0.877468    0.880659    0.360423    0.939889    0.933544    0.858133    0.874679    0.834383    0.833753    0.364776    0.382653    1800        18.136020   0.327023    0.407776    178.687129 
[37m[36mINFO[0m[0m 02/27 17:41:09 | 0.326960    0.354592    0.892291    0.870603    0.368536    0.936989    0.913502    0.868661    0.872111    0.871222    0.826196    0.326960    0.354592    2000        20.151134   0.309843    0.408635    192.954159 
[37m[36mINFO[0m[0m 02/27 17:45:38 | 0.272573    0.313776    0.903965    0.890058    0.326408    0.953599    0.937764    0.883297    0.877247    0.875000    0.855164    0.272573    0.313776    2200        22.166247   0.291774    0.415171    185.658828 
[37m[36mINFO[0m[0m 02/27 17:50:03 | 0.326960    0.336735    0.901681    0.879750    0.346296    0.949644    0.929325    0.876621    0.873652    0.878778    0.836272    0.326960    0.336735    2400        24.181360   0.285744    0.408371    182.839907 
[37m[36mINFO[0m[0m 02/27 17:54:31 | 0.312726    0.317177    0.908074    0.897963    0.317624    0.951226    0.943038    0.891385    0.893169    0.881612    0.857683    0.312726    0.317177    2600        26.196474   0.267165    0.411438    185.680058 
[37m[36mINFO[0m[0m 02/27 17:59:00 | 0.290843    0.303571    0.916098    0.903141    0.296675    0.957817    0.948312    0.889973    0.889574    0.900504    0.871537    0.290843    0.303571    2800        28.211587   0.257093    0.406862    187.919455 
[37m[36mINFO[0m[0m 02/27 18:03:36 | 0.290843    0.306973    0.896104    0.886513    0.334202    0.956762    0.946203    0.860958    0.880842    0.870592    0.832494    0.290843    0.306973    3000        30.226700   0.233900    0.410370    193.530963 
[37m[36mINFO[0m[0m 02/27 18:08:07 | 0.347355    0.352891    0.928549    0.905951    0.274542    0.958081    0.933544    0.909745    0.903955    0.917821    0.880353    0.347355    0.352891    3200        32.241814   0.250100    0.409379    189.509208 
[37m[36mINFO[0m[0m 02/27 18:12:33 | 0.345868    0.354592    0.916002    0.890822    0.315094    0.957026    0.939873    0.893311    0.873652    0.897670    0.858942    0.345868    0.354592    3400        34.256927   0.219075    0.434392    179.615057 
[37m[36mINFO[0m[0m 02/27 18:17:07 | 0.313151    0.303571    0.919912    0.891051    0.319937    0.963881    0.935654    0.891257    0.879815    0.904597    0.857683    0.313151    0.303571    3600        36.272040   0.223925    0.408381    191.909148 
[37m[36mINFO[0m[0m 02/27 18:21:34 | 0.283833    0.311224    0.921126    0.900801    0.283929    0.963881    0.944093    0.897419    0.888033    0.902078    0.870277    0.283833    0.311224    3800        38.287154   0.223713    0.405686    186.010014 
[37m[36mINFO[0m[0m 02/27 18:26:08 | 0.313151    0.335034    0.919207    0.898782    0.308158    0.962826    0.930380    0.895237    0.893169    0.899559    0.872796    0.313151    0.335034    4000        40.302267   0.205034    0.409947    191.723089 
[37m[36mINFO[0m[0m 02/27 18:30:33 | 0.322711    0.332483    0.939358    0.926165    0.240087    0.971526    0.958861    0.921171    0.920390    0.925378    0.899244    0.322711    0.332483    4200        42.317380   0.193947    0.419373    181.381577 
[37m[36mINFO[0m[0m 02/27 18:35:03 | 0.315488    0.315476    0.932752    0.907406    0.278557    0.959135    0.926160    0.921299    0.899332    0.917821    0.896725    0.315488    0.315476    4400        44.332494   0.194346    0.411835    187.452173 
[37m[36mINFO[0m[0m 02/27 18:39:31 | 0.357128    0.361395    0.934108    0.914120    0.248349    0.967045    0.946203    0.914623    0.904468    0.920655    0.891688    0.357128    0.361395    4600        46.347607   0.189837    0.406990    186.450947 
[37m[36mINFO[0m[0m 02/27 18:43:54 | 0.328235    0.340136    0.935702    0.912753    0.257003    0.967835    0.953586    0.919245    0.896764    0.920025    0.887909    0.328235    0.340136    4800        48.362720   0.189841    0.411816    181.074035 
[37m[36mINFO[0m[0m 02/27 18:48:15 | 0.367750    0.373299    0.932901    0.918802    0.264375    0.963617    0.949367    0.921042    0.920390    0.914043    0.886650    0.367750    0.373299    5000        50.377834   0.184140    0.410609    178.758182 
[37m[36mINFO[0m[0m 02/27 18:48:15 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250227_16-54-34_clip_vitb16_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/27 18:48:20 | ---
[37m[36mINFO[0m[0m 02/27 18:48:20 | test-domain validation(oracle) = 38.432%
[37m[36mINFO[0m[0m 02/27 18:48:20 | training-domain validation(iid) = 32.271%
[37m[36mINFO[0m[0m 02/27 18:48:20 | last = 36.775%
[37m[36mINFO[0m[0m 02/27 18:48:20 | last (inD) = 91.880%
[37m[36mINFO[0m[0m 02/27 18:48:20 | training-domain validation (iid, inD) = 92.617%
[37m[36mINFO[0m[0m 02/27 18:48:20 | === Summary ===
[37m[36mINFO[0m[0m 02/27 18:48:20 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_adam config/clip_vitb16_adam.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita
[37m[36mINFO[0m[0m 02/27 18:48:20 | Unique name: 250227_16-54-34_clip_vitb16_adam
[37m[36mINFO[0m[0m 02/27 18:48:20 | Out path: train_output/TerraIncognita/ERM/[3]/250227_16-54-34_clip_vitb16_adam
[37m[36mINFO[0m[0m 02/27 18:48:20 | Algorithm: ERM
[37m[36mINFO[0m[0m 02/27 18:48:20 | Dataset: TerraIncognita

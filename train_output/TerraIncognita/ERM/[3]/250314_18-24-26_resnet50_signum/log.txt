[37m[36mINFO[0m[0m 03/14 18:24:26 | Command :: /jsm0707/GENIE/train_all.py resnet50_signum config/resnet50_signum.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_signum.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_signum
	out_dir: train_output/TerraIncognita/ERM/[3]/250314_18-24-26_resnet50_signum
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 0
	unique_name: 250314_18-24-26_resnet50_signum
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: signum
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/14 18:24:26 | n_steps = 5001
[37m[36mINFO[0m[0m 03/14 18:24:26 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/14 18:24:26 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/14 18:24:26 | 
[37m[36mINFO[0m[0m 03/14 18:24:26 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/14 18:24:26 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/14 18:24:26 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/14 18:24:26 | Batch sizes for each domain: [32, 32, 32, 0] (total=96)
[37m[36mINFO[0m[0m 03/14 18:24:26 | steps-per-epoch for each domain: 118.53, 243.41, 99.25 -> min = 99.25
[37m[36mINFO[0m[0m 03/14 18:24:28 | # of params = 23528522
[37m[36mINFO[0m[0m 03/14 18:27:14 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/14 18:27:14 | 0.194604    0.198129    0.250094    0.226761    2.092798    0.519114    0.522152    0.125690    0.049820    0.105479    0.108312    0.194604    0.198129    0           0.000000    2.440448    1.183364    165.392631 
[37m[36mINFO[0m[0m 03/14 18:30:54 | 0.360314    0.356293    0.736193    0.741586    0.716400    0.829159    0.800633    0.712543    0.733950    0.666877    0.690176    0.360314    0.356293    200         2.015113    0.992684    0.235043    172.428905 
[37m[36mINFO[0m[0m 03/14 18:34:34 | 0.302953    0.310374    0.788904    0.791315    0.657423    0.872924    0.860759    0.785980    0.794042    0.707809    0.719144    0.302953    0.310374    400         4.030227    0.675086    0.245500    171.548577 
[37m[36mINFO[0m[0m 03/14 18:38:19 | 0.407691    0.412415    0.790468    0.793378    0.601470    0.863169    0.849156    0.784054    0.815614    0.724181    0.715365    0.407691    0.412415    600         6.045340    0.662142    0.254894    173.270500 
[37m[36mINFO[0m[0m 03/14 18:41:57 | 0.349267    0.332483    0.772852    0.774833    0.701660    0.837068    0.814346    0.774939    0.793529    0.706549    0.716625    0.349267    0.332483    800         8.060453    0.770281    0.245408    168.863590 
[37m[36mINFO[0m[0m 03/14 18:45:39 | 0.288931    0.272959    0.727913    0.742702    0.796532    0.815186    0.830169    0.757093    0.760657    0.611461    0.637280    0.288931    0.272959    1000        10.075567   0.931890    0.248843    172.939101 
[37m[36mINFO[0m[0m 03/14 18:49:18 | 0.367113    0.362245    0.736597    0.739225    2.537571    0.778539    0.766878    0.762486    0.771957    0.668766    0.678841    0.367113    0.362245    1200        12.090680   0.945165    0.252660    168.208268 
[37m[36mINFO[0m[0m 03/14 18:53:03 | 0.361589    0.351190    0.731155    0.749143    0.912666    0.789612    0.783755    0.742329    0.773498    0.661524    0.690176    0.361589    0.351190    1400        14.105793   0.858099    0.245076    175.965267 
[37m[36mINFO[0m[0m 03/14 18:56:52 | 0.333546    0.342687    0.735149    0.741449    0.735563    0.804640    0.820675    0.724483    0.757576    0.676322    0.646096    0.333546    0.342687    1600        16.120907   1.017148    0.285277    171.629438 
[37m[36mINFO[0m[0m 03/14 19:00:44 | 0.342894    0.346088    0.636802    0.649459    1.311320    0.735302    0.715190    0.555142    0.575758    0.619962    0.657431    0.342894    0.346088    1800        18.136020   1.055816    0.282857    175.803274 
[37m[36mINFO[0m[0m 03/14 19:04:41 | 0.396856    0.386054    0.725132    0.729384    2.392756    0.825732    0.824895    0.704198    0.738572    0.645466    0.624685    0.396856    0.386054    2000        20.151134   1.266428    0.274707    182.209196 
[37m[36mINFO[0m[0m 03/14 19:08:33 | 0.339282    0.353741    0.642305    0.654589    1.243410    0.789612    0.774262    0.617152    0.649204    0.520151    0.540302    0.339282    0.353741    2200        22.166247   1.481371    0.276399    176.137686 
[37m[36mINFO[0m[0m 03/14 19:12:13 | 0.287019    0.292517    0.595896    0.610166    1.439108    0.713683    0.740506    0.550392    0.582435    0.523615    0.507557    0.287019    0.292517    2400        24.181360   1.700905    0.266962    167.326070 
[37m[36mINFO[0m[0m 03/14 19:15:45 | 0.306777    0.312075    0.607362    0.613236    1.091416    0.758503    0.746835    0.647965    0.667180    0.415617    0.425693    0.306777    0.312075    2600        26.196474   1.695418    0.248189    161.919386 
[37m[36mINFO[0m[0m 03/14 19:19:21 | 0.259826    0.269558    0.523790    0.528131    1.201077    0.722647    0.693038    0.449480    0.469440    0.399244    0.421914    0.259826    0.269558    2800        28.211587   1.894889    0.250837    166.148534 
[37m[36mINFO[0m[0m 03/14 19:22:55 | 0.196091    0.216837    0.431739    0.434640    1.418553    0.495386    0.465190    0.481191    0.510015    0.318640    0.328715    0.196091    0.216837    3000        30.226700   1.677618    0.253566    162.934453 
[37m[36mINFO[0m[0m 03/14 19:26:32 | 0.301466    0.319728    0.526769    0.526982    3.123049    0.701292    0.708861    0.346899    0.370827    0.532116    0.501259    0.301466    0.319728    3200        32.241814   1.942673    0.254621    166.306375 
[37m[36mINFO[0m[0m 03/14 19:30:12 | 0.163374    0.159864    0.452205    0.463709    1.760828    0.588980    0.601266    0.387598    0.430919    0.380038    0.358942    0.163374    0.159864    3400        34.256927   1.939155    0.248297    170.662624 
[37m[36mINFO[0m[0m 03/14 19:33:57 | 0.287869    0.266156    0.458160    0.445585    6.682541    0.626153    0.633966    0.322634    0.303544    0.425693    0.399244    0.287869    0.266156    3600        36.272040   1.904009    0.265677    171.523341 
[37m[36mINFO[0m[0m 03/14 19:37:37 | 0.245379    0.250000    0.413928    0.440146    1.731231    0.635908    0.645570    0.328797    0.371341    0.277078    0.303526    0.245379    0.250000    3800        38.287154   2.331537    0.253780    168.692293 
[37m[36mINFO[0m[0m 03/14 19:41:18 | 0.117909    0.119898    0.380087    0.388558    2.786045    0.574743    0.580169    0.455001    0.479712    0.110516    0.105793    0.117909    0.119898    4000        40.302267   2.001115    0.252166    170.474863 
[37m[36mINFO[0m[0m 03/14 19:44:54 | 0.245804    0.232143    0.506574    0.534766    1.408000    0.648563    0.657173    0.543074    0.593220    0.328086    0.353904    0.245804    0.232143    4200        42.317380   2.040436    0.240110    168.551351 
[37m[36mINFO[0m[0m 03/14 19:48:30 | 0.190567    0.202381    0.395321    0.430525    1.424461    0.631426    0.637131    0.268327    0.330765    0.286209    0.323678    0.190567    0.202381    4400        44.332494   2.099371    0.241953    167.704405 
[37m[36mINFO[0m[0m 03/14 19:52:05 | 0.185256    0.198129    0.417836    0.442784    1.518912    0.604271    0.602321    0.347285    0.412429    0.301952    0.313602    0.185256    0.198129    4600        46.347607   1.995841    0.237385    167.588559 
[37m[36mINFO[0m[0m 03/14 19:55:46 | 0.199278    0.204082    0.472729    0.485283    1.626560    0.671764    0.681435    0.470921    0.518747    0.275504    0.255668    0.199278    0.204082    4800        48.362720   1.782223    0.245082    171.870684 
[37m[36mINFO[0m[0m 03/14 19:59:28 | 0.280433    0.264456    0.466392    0.482845    1.670132    0.571579    0.592827    0.507382    0.554700    0.320214    0.301008    0.280433    0.264456    5000        50.377834   1.731844    0.254465    170.544456 
[37m[36mINFO[0m[0m 03/14 19:59:28 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250314_18-24-26_resnet50_signum/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/14 19:59:29 | ---
[37m[36mINFO[0m[0m 03/14 19:59:29 | test-domain validation(oracle) = 40.769%
[37m[36mINFO[0m[0m 03/14 19:59:29 | training-domain validation(iid) = 40.769%
[37m[36mINFO[0m[0m 03/14 19:59:29 | last = 28.043%
[37m[36mINFO[0m[0m 03/14 19:59:29 | last (inD) = 48.284%
[37m[36mINFO[0m[0m 03/14 19:59:29 | training-domain validation (iid, inD) = 79.338%
[37m[36mINFO[0m[0m 03/14 19:59:29 | === Summary ===
[37m[36mINFO[0m[0m 03/14 19:59:29 | Command: /jsm0707/GENIE/train_all.py resnet50_signum config/resnet50_signum.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita
[37m[36mINFO[0m[0m 03/14 19:59:29 | Unique name: 250314_18-24-26_resnet50_signum
[37m[36mINFO[0m[0m 03/14 19:59:29 | Out path: train_output/TerraIncognita/ERM/[3]/250314_18-24-26_resnet50_signum
[37m[36mINFO[0m[0m 03/14 19:59:29 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/14 19:59:29 | Dataset: TerraIncognita

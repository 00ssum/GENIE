[37m[36mINFO[0m[0m 03/25 13:44:27 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 17
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 17
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250325_13-44-27_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250325_13-44-27_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.0002990700776954947
	batch_size: 8
	weight_decay: 4.0966675521600606e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/25 13:44:27 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 13:44:27 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 13:44:27 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 13:44:27 | 
[37m[36mINFO[0m[0m 03/25 13:44:27 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/25 13:44:27 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/25 13:44:27 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/25 13:44:27 | Batch sizes for each domain: [8, 8, 8, 0] (total=24)
[37m[36mINFO[0m[0m 03/25 13:44:27 | steps-per-epoch for each domain: 474.12, 973.62, 397.00 -> min = 397.00
[37m[36mINFO[0m[0m 03/25 13:44:29 | # of params = 23528522
[37m[36mINFO[0m[0m 03/25 13:47:55 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 13:47:55 | 0.217336    0.229592    0.286078    0.283001    2.036274    0.208015    0.179325    0.461933    0.455573    0.188287    0.214106    0.217336    0.229592    0           0.000000    2.380816    1.363844    204.820486 
[37m[36mINFO[0m[0m 03/25 13:51:53 | 0.227958    0.246599    0.487065    0.536548    1.330501    0.569734    0.690928    0.541019    0.543400    0.350441    0.375315    0.227958    0.246599    200         0.503778    1.535829    0.135970    210.406286 
[37m[36mINFO[0m[0m 03/25 13:55:39 | 0.220523    0.237245    0.559674    0.590244    1.161778    0.654627    0.718354    0.574143    0.564972    0.450252    0.487406    0.220523    0.237245    400         1.007557    1.309365    0.135783    199.614815 
[37m[36mINFO[0m[0m 03/25 13:59:21 | 0.177820    0.193027    0.584754    0.606552    1.151680    0.704983    0.722574    0.584542    0.584489    0.464736    0.512594    0.177820    0.193027    600         1.511335    1.179971    0.130021    195.880538 
[37m[36mINFO[0m[0m 03/25 14:03:17 | 0.272998    0.278061    0.626977    0.638740    1.067209    0.742684    0.744726    0.630376    0.642527    0.507872    0.528967    0.272998    0.278061    800         2.015113    1.086595    0.154463    204.487104 
[37m[36mINFO[0m[0m 03/25 14:07:07 | 0.296580    0.306973    0.703830    0.714316    0.797033    0.787503    0.754219    0.718192    0.740113    0.605793    0.648615    0.296580    0.306973    1000        2.518892    0.966092    0.184443    193.798516 
[37m[36mINFO[0m[0m 03/25 14:10:56 | 0.290631    0.291667    0.717305    0.745151    0.764304    0.814131    0.825949    0.735139    0.759630    0.602645    0.649874    0.290631    0.291667    1200        3.022670    0.850744    0.151874    198.295718 
[37m[36mINFO[0m[0m 03/25 14:14:35 | 0.265774    0.273810    0.738330    0.756181    0.734414    0.838387    0.829114    0.746566    0.783256    0.630038    0.656171    0.265774    0.273810    1400        3.526448    0.815328    0.139877    190.815320 
[37m[36mINFO[0m[0m 03/25 14:18:32 | 0.347992    0.358844    0.763522    0.777267    0.675368    0.864224    0.858650    0.762614    0.781715    0.663728    0.691436    0.347992    0.358844    1600        4.030227    0.738286    0.152667    206.733387 
[37m[36mINFO[0m[0m 03/25 14:22:24 | 0.230933    0.247449    0.759281    0.763894    0.676842    0.852887    0.842827    0.765952    0.788906    0.659005    0.659950    0.230933    0.247449    1800        4.534005    0.771377    0.127748    206.002957 
[37m[36mINFO[0m[0m 03/25 14:26:01 | 0.297004    0.305272    0.750852    0.759128    0.644406    0.850250    0.857595    0.760303    0.783770    0.642003    0.636020    0.297004    0.305272    2000        5.037783    0.685011    0.138284    189.692560 
[37m[36mINFO[0m[0m 03/25 14:29:45 | 0.348630    0.354592    0.773746    0.780585    0.578686    0.867124    0.877637    0.782514    0.796610    0.671599    0.667506    0.348630    0.354592    2200        5.541562    0.714723    0.150384    194.274595 
[37m[36mINFO[0m[0m 03/25 14:33:25 | 0.379222    0.364796    0.773333    0.787936    0.613949    0.857632    0.856540    0.779433    0.800719    0.682935    0.706549    0.379222    0.364796    2400        6.045340    0.632826    0.168693    186.200591 
[37m[36mINFO[0m[0m 03/25 14:36:52 | 0.374336    0.375000    0.772353    0.775382    0.625344    0.876615    0.869198    0.765695    0.764253    0.674748    0.692695    0.374336    0.375000    2600        6.549118    0.632055    0.152210    176.174393 
[37m[36mINFO[0m[0m 03/25 14:40:30 | 0.307202    0.314626    0.807714    0.805315    0.545379    0.870815    0.883966    0.811144    0.788906    0.741184    0.743073    0.307202    0.314626    2800        7.052897    0.611789    0.145450    188.733959 
[37m[36mINFO[0m[0m 03/25 14:44:15 | 0.298704    0.308673    0.798742    0.809254    0.550913    0.868442    0.860759    0.802029    0.828968    0.725756    0.738035    0.298704    0.308673    3000        7.556675    0.589113    0.168554    191.713385 
[37m[36mINFO[0m[0m 03/25 14:47:52 | 0.322923    0.328231    0.798943    0.800485    0.578166    0.884260    0.875527    0.806650    0.801746    0.705919    0.724181    0.322923    0.328231    3200        8.060453    0.569574    0.136097    189.645274 
[37m[36mINFO[0m[0m 03/25 14:51:24 | 0.370087    0.383503    0.802489    0.800822    0.535123    0.878988    0.867089    0.782257    0.782229    0.746222    0.753149    0.370087    0.383503    3400        8.564232    0.569429    0.138489    184.791908 
[37m[36mINFO[0m[0m 03/25 14:55:01 | 0.363926    0.358844    0.821974    0.818115    0.489254    0.881888    0.888186    0.809475    0.824345    0.774559    0.741814    0.363926    0.358844    3600        9.068010    0.555742    0.141602    188.470227 
[37m[36mINFO[0m[0m 03/25 14:58:34 | 0.352241    0.367347    0.812275    0.820402    0.510474    0.879779    0.873418    0.790987    0.809450    0.766058    0.778338    0.352241    0.367347    3800        9.571788    0.516603    0.146250    183.975955 
[37m[36mINFO[0m[0m 03/25 15:02:13 | 0.431060    0.419218    0.808071    0.815255    0.584417    0.870024    0.854430    0.793170    0.810478    0.761020    0.780856    0.431060    0.419218    4000        10.075567   0.524952    0.163548    185.772861 
[37m[36mINFO[0m[0m 03/25 15:05:59 | 0.363714    0.368197    0.827971    0.837167    0.461573    0.900606    0.893460    0.817563    0.837185    0.765743    0.780856    0.363714    0.368197    4200        10.579345   0.510517    0.190366    187.688751 
[37m[36mINFO[0m[0m 03/25 15:09:34 | 0.294668    0.303571    0.809755    0.806701    0.501159    0.885842    0.859705    0.789960    0.799692    0.753463    0.760705    0.294668    0.303571    4400        11.083123   0.529964    0.136312    188.020782 
[37m[36mINFO[0m[0m 03/25 15:13:13 | 0.322286    0.330782    0.831390    0.834293    0.460010    0.899552    0.900844    0.816279    0.829995    0.778338    0.772040    0.322286    0.330782    4600        11.586902   0.490156    0.163748    186.458673 
[37m[36mINFO[0m[0m 03/25 15:16:57 | 0.432122    0.422619    0.840557    0.845834    0.437750    0.899815    0.902954    0.828091    0.831022    0.793766    0.803526    0.432122    0.422619    4800        12.090680   0.476669    0.189451    185.826488 
[37m[36mINFO[0m[0m 03/25 15:20:30 | 0.375611    0.380102    0.840699    0.843735    0.445401    0.919589    0.902954    0.810630    0.831022    0.791877    0.797229    0.375611    0.380102    5000        12.594458   0.458382    0.144490    184.457141 
[37m[36mINFO[0m[0m 03/25 15:20:30 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250325_13-44-27_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 15:20:32 | ---
[37m[36mINFO[0m[0m 03/25 15:20:32 | test-domain validation(oracle) = 43.212%
[37m[36mINFO[0m[0m 03/25 15:20:32 | training-domain validation(iid) = 43.212%
[37m[36mINFO[0m[0m 03/25 15:20:32 | last = 37.561%
[37m[36mINFO[0m[0m 03/25 15:20:32 | last (inD) = 84.373%
[37m[36mINFO[0m[0m 03/25 15:20:32 | training-domain validation (iid, inD) = 84.583%
[37m[36mINFO[0m[0m 03/25 15:20:32 | === Summary ===
[37m[36mINFO[0m[0m 03/25 15:20:32 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 17
[37m[36mINFO[0m[0m 03/25 15:20:32 | Unique name: 250325_13-44-27_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 15:20:32 | Out path: train_output/TerraIncognita/ERM/[3]/250325_13-44-27_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 15:20:32 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 15:20:32 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 03/24 17:51:26 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 5
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 5
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250324_17-51-26_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 1
	unique_name: 250324_17-51-26_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.0002591339485391279
	batch_size: 10
	weight_decay: 0.00020150290684242954
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/24 17:51:26 | n_steps = 5001
[37m[36mINFO[0m[0m 03/24 17:51:26 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/24 17:51:26 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/24 17:51:26 | 
[37m[36mINFO[0m[0m 03/24 17:51:26 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/24 17:51:26 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/24 17:51:26 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/24 17:51:26 | Batch sizes for each domain: [10, 10, 10, 0] (total=30)
[37m[36mINFO[0m[0m 03/24 17:51:26 | steps-per-epoch for each domain: 379.30, 778.90, 317.60 -> min = 317.60
[37m[36mINFO[0m[0m 03/24 17:51:27 | # of params = 23528522
[37m[36mINFO[0m[0m 03/24 17:54:15 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/24 17:54:15 | 0.217336    0.229592    0.287660    0.283001    2.017984    0.212760    0.179325    0.461933    0.455573    0.188287    0.214106    0.217336    0.229592    0           0.000000    2.465577    1.294812    166.315714 
[37m[36mINFO[0m[0m 03/24 17:57:23 | 0.232632    0.241497    0.534677    0.548862    1.199084    0.709992    0.726793    0.544229    0.546995    0.349811    0.372796    0.232632    0.241497    200         0.629723    1.394657    0.120234    164.572873 
[37m[36mINFO[0m[0m 03/24 18:00:37 | 0.212662    0.240646    0.552603    0.573437    1.106558    0.665700    0.670886    0.634741    0.647663    0.357368    0.401763    0.212662    0.240646    400         1.259446    1.156751    0.135298    166.871616 
[37m[36mINFO[0m[0m 03/24 18:03:54 | 0.325260    0.328231    0.702646    0.717631    0.844956    0.785394    0.787975    0.708563    0.720082    0.613980    0.644836    0.325260    0.328231    600         1.889169    0.971852    0.155871    165.623803 
[37m[36mINFO[0m[0m 03/24 18:07:05 | 0.336308    0.347789    0.730167    0.738358    0.730500    0.819141    0.819620    0.739119    0.749358    0.632242    0.646096    0.336308    0.347789    800         2.518892    0.838920    0.129312    165.135493 
[37m[36mINFO[0m[0m 03/24 18:10:21 | 0.276184    0.291667    0.749183    0.761301    0.687574    0.828368    0.838608    0.760175    0.774011    0.659005    0.671285    0.276184    0.291667    1000        3.148615    0.712311    0.143697    167.647491 
[37m[36mINFO[0m[0m 03/24 18:13:38 | 0.327385    0.318878    0.751221    0.745994    0.708180    0.849987    0.834388    0.726409    0.727273    0.677267    0.676322    0.327385    0.318878    1200        3.778338    0.676219    0.125630    171.295879 
[37m[36mINFO[0m[0m 03/24 18:16:50 | 0.298067    0.311224    0.783684    0.785006    0.572929    0.856578    0.833333    0.782257    0.803801    0.712217    0.717884    0.298067    0.311224    1400        4.408060    0.664676    0.127046    166.230162 
[37m[36mINFO[0m[0m 03/24 18:20:05 | 0.357977    0.347789    0.779465    0.797666    0.588352    0.868706    0.864979    0.776993    0.792501    0.692695    0.735516    0.357977    0.347789    1600        5.037783    0.608161    0.124910    170.211473 
[37m[36mINFO[0m[0m 03/24 18:23:22 | 0.322286    0.337585    0.785147    0.793810    0.561149    0.862642    0.834388    0.773655    0.786338    0.719144    0.760705    0.322286    0.337585    1800        5.667506    0.585039    0.146534    168.410798 
[37m[36mINFO[0m[0m 03/24 18:26:41 | 0.352454    0.357993    0.809784    0.814928    0.510847    0.886633    0.869198    0.812556    0.829995    0.730164    0.745592    0.352454    0.357993    2000        6.297229    0.540228    0.154139    167.917300 
[37m[36mINFO[0m[0m 03/24 18:30:04 | 0.416401    0.411565    0.812965    0.812575    0.529433    0.881624    0.860759    0.796251    0.809964    0.761020    0.767003    0.416401    0.411565    2200        6.926952    0.535354    0.157026    170.904361 
[37m[36mINFO[0m[0m 03/24 18:33:26 | 0.407478    0.407313    0.818057    0.828697    0.482440    0.896124    0.889241    0.803954    0.822291    0.754093    0.774559    0.407478    0.407313    2400        7.556675    0.524688    0.160434    170.331453 
[37m[36mINFO[0m[0m 03/24 18:36:40 | 0.312088    0.328231    0.813938    0.821761    0.520188    0.881624    0.867089    0.800745    0.813559    0.759446    0.784635    0.312088    0.328231    2600        8.186398    0.526336    0.142771    165.813144 
[37m[36mINFO[0m[0m 03/24 18:39:58 | 0.362864    0.367347    0.826536    0.818835    0.495459    0.898234    0.862869    0.808705    0.825372    0.772670    0.768262    0.362864    0.367347    2800        8.816121    0.493020    0.136795    170.275676 
[37m[36mINFO[0m[0m 03/24 18:43:11 | 0.287444    0.299320    0.798301    0.799734    0.591340    0.882942    0.866034    0.791244    0.811505    0.720718    0.721662    0.287444    0.299320    3000        9.445844    0.499242    0.122494    168.815742 
[37m[36mINFO[0m[0m 03/24 18:46:24 | 0.322286    0.331633    0.831134    0.842703    0.457301    0.902979    0.901899    0.820901    0.842835    0.769521    0.783375    0.322286    0.331633    3200        10.075567   0.459633    0.140648    164.638719 
[37m[36mINFO[0m[0m 03/24 18:49:43 | 0.318249    0.329082    0.851236    0.856002    0.422732    0.911943    0.896624    0.845166    0.860298    0.796599    0.811083    0.318249    0.329082    3400        10.705290   0.441898    0.119148    175.110380 
[37m[36mINFO[0m[0m 03/24 18:52:51 | 0.384746    0.401361    0.845645    0.849687    0.425664    0.908779    0.891350    0.844781    0.856703    0.783375    0.801008    0.384746    0.401361    3600        11.335013   0.421400    0.115824    164.401002 
[37m[36mINFO[0m[0m 03/24 18:56:00 | 0.404504    0.410714    0.845248    0.849580    0.431934    0.922489    0.902954    0.806265    0.825886    0.806990    0.819899    0.404504    0.410714    3800        11.964736   0.430942    0.116135    165.698315 
[37m[36mINFO[0m[0m 03/24 18:59:16 | 0.377735    0.362245    0.851820    0.855108    0.428087    0.907988    0.899789    0.833868    0.844376    0.813602    0.821159    0.377735    0.362245    4000        12.594458   0.413310    0.120022    172.373724 
[37m[36mINFO[0m[0m 03/24 19:02:34 | 0.410028    0.413265    0.864696    0.860642    0.418899    0.914316    0.902954    0.846964    0.848998    0.832809    0.829975    0.410028    0.413265    4200        13.224181   0.394400    0.128158    172.511737 
[37m[36mINFO[0m[0m 03/24 19:05:53 | 0.316550    0.319728    0.850635    0.856902    0.414883    0.915370    0.896624    0.825138    0.856703    0.811398    0.817380    0.316550    0.319728    4400        13.853904   0.396345    0.148833    169.324338 
[37m[36mINFO[0m[0m 03/24 19:09:26 | 0.309539    0.325680    0.855272    0.861810    0.390621    0.920116    0.900844    0.836821    0.865948    0.808879    0.818640    0.309539    0.325680    4600        14.483627   0.407178    0.220892    168.173882 
[37m[36mINFO[0m[0m 03/24 19:12:48 | 0.366900    0.364796    0.849618    0.844759    0.417781    0.907461    0.895570    0.832199    0.837699    0.809194    0.801008    0.366900    0.364796    4800        15.113350   0.381381    0.154685    171.294565 
[37m[36mINFO[0m[0m 03/24 19:16:14 | 0.315275    0.317177    0.872800    0.865644    0.367671    0.936198    0.918776    0.852228    0.872111    0.829975    0.806045    0.315275    0.317177    5000        15.743073   0.369252    0.177434    170.776132 
[37m[36mINFO[0m[0m 03/24 19:16:14 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250324_17-51-26_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/24 19:16:15 | ---
[37m[36mINFO[0m[0m 03/24 19:16:15 | test-domain validation(oracle) = 41.003%
[37m[36mINFO[0m[0m 03/24 19:16:15 | training-domain validation(iid) = 31.528%
[37m[36mINFO[0m[0m 03/24 19:16:15 | last = 31.528%
[37m[36mINFO[0m[0m 03/24 19:16:15 | last (inD) = 86.564%
[37m[36mINFO[0m[0m 03/24 19:16:15 | training-domain validation (iid, inD) = 86.564%
[37m[36mINFO[0m[0m 03/24 19:16:15 | === Summary ===
[37m[36mINFO[0m[0m 03/24 19:16:15 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 5
[37m[36mINFO[0m[0m 03/24 19:16:15 | Unique name: 250324_17-51-26_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 19:16:15 | Out path: train_output/TerraIncognita/ERM/[3]/250324_17-51-26_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 19:16:15 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/24 19:16:15 | Dataset: TerraIncognita

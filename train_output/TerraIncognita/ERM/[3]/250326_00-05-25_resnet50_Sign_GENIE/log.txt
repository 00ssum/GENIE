[37m[36mINFO[0m[0m 03/26 00:05:25 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 6
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 6
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[3]/250326_00-05-25_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250326_00-05-25_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00020671063342821416
	batch_size: 9
	weight_decay: 0.00021810605040355685
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/26 00:05:25 | n_steps = 5001
[37m[36mINFO[0m[0m 03/26 00:05:25 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/26 00:05:25 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/26 00:05:25 | 
[37m[36mINFO[0m[0m 03/26 00:05:25 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 03/26 00:05:25 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 03/26 00:05:25 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 03/26 00:05:25 | Batch sizes for each domain: [9, 9, 9, 0] (total=27)
[37m[36mINFO[0m[0m 03/26 00:05:25 | steps-per-epoch for each domain: 421.44, 865.44, 352.89 -> min = 352.89
[37m[36mINFO[0m[0m 03/26 00:05:27 | # of params = 23528522
[37m[36mINFO[0m[0m 03/26 00:08:14 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/26 00:08:14 | 0.222860    0.207483    0.288403    0.273706    2.126436    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.222860    0.207483    0           0.000000    2.454851    0.994239    166.047785 
[37m[36mINFO[0m[0m 03/26 00:11:26 | 0.211175    0.197279    0.533665    0.517031    1.276583    0.609808    0.625527    0.606111    0.585516    0.385076    0.340050    0.211175    0.197279    200         0.566751    1.479490    0.124365    167.088333 
[37m[36mINFO[0m[0m 03/26 00:14:43 | 0.230083    0.225340    0.573937    0.575477    1.178688    0.737938    0.750000    0.575812    0.558295    0.408060    0.418136    0.230083    0.225340    400         1.133501    1.223233    0.118039    173.577273 
[37m[36mINFO[0m[0m 03/26 00:17:57 | 0.301466    0.283163    0.640678    0.637033    1.032058    0.744002    0.756329    0.679291    0.663585    0.498741    0.491184    0.301466    0.283163    600         1.700252    1.099011    0.125065    169.268910 
[37m[36mINFO[0m[0m 03/26 00:21:24 | 0.254515    0.239796    0.705737    0.719079    0.807586    0.803322    0.792194    0.746822    0.752953    0.567065    0.612091    0.254515    0.239796    800         2.267003    0.917667    0.174058    171.757378 
[37m[36mINFO[0m[0m 03/26 00:24:32 | 0.316550    0.305272    0.728928    0.732555    0.754788    0.843659    0.821730    0.734497    0.729841    0.608627    0.646096    0.316550    0.305272    1000        2.833753    0.811693    0.114400    165.356790 
[37m[36mINFO[0m[0m 03/26 00:27:53 | 0.315912    0.302721    0.704294    0.703938    0.783734    0.796731    0.778481    0.720118    0.714946    0.596033    0.618388    0.315912    0.302721    1200        3.400504    0.727888    0.150643    171.461465 
[37m[36mINFO[0m[0m 03/26 00:31:10 | 0.306990    0.295918    0.758993    0.769681    0.681272    0.867387    0.866034    0.772628    0.772984    0.636965    0.670025    0.306990    0.295918    1400        3.967254    0.662677    0.154997    165.101777 
[37m[36mINFO[0m[0m 03/26 00:34:28 | 0.395793    0.397109    0.766881    0.759900    0.691797    0.850778    0.836498    0.764411    0.730354    0.685453    0.712846    0.395793    0.397109    1600        4.534005    0.622225    0.146326    169.563162 
[37m[36mINFO[0m[0m 03/26 00:37:42 | 0.318037    0.313776    0.756706    0.756145    0.667228    0.837068    0.835443    0.737835    0.736518    0.695214    0.696474    0.318037    0.313776    1800        5.100756    0.616372    0.144392    165.176922 
[37m[36mINFO[0m[0m 03/26 00:41:00 | 0.292755    0.262755    0.779860    0.775770    0.592805    0.872924    0.851266    0.736808    0.735490    0.729849    0.740554    0.292755    0.262755    2000        5.667506    0.582788    0.162530    165.377136 
[37m[36mINFO[0m[0m 03/26 00:44:27 | 0.352029    0.343537    0.807841    0.805967    0.543407    0.871342    0.859705    0.803441    0.789933    0.748741    0.768262    0.352029    0.343537    2200        6.234257    0.553202    0.185671    169.533062 
[37m[36mINFO[0m[0m 03/26 00:47:47 | 0.336308    0.321429    0.813515    0.807522    0.523749    0.883470    0.869198    0.812428    0.814073    0.744647    0.739295    0.336308    0.321429    2400        6.801008    0.520594    0.162700    167.451335 
[37m[36mINFO[0m[0m 03/26 00:50:59 | 0.343743    0.339286    0.807911    0.801882    0.549592    0.875560    0.842827    0.794710    0.794556    0.753463    0.768262    0.343743    0.339286    2600        7.367758    0.526784    0.140793    163.694398 
[37m[36mINFO[0m[0m 03/26 00:54:17 | 0.287657    0.299320    0.827158    0.822057    0.503181    0.896652    0.877637    0.817820    0.808937    0.767003    0.779597    0.287657    0.299320    2800        7.934509    0.522712    0.142671    169.787865 
[37m[36mINFO[0m[0m 03/26 00:57:36 | 0.326535    0.319728    0.822098    0.800337    0.557166    0.885579    0.847046    0.813712    0.805855    0.767003    0.748111    0.326535    0.319728    3000        8.501259    0.517485    0.188000    161.504029 
[37m[36mINFO[0m[0m 03/26 01:00:52 | 0.346505    0.362245    0.828708    0.816319    0.497242    0.906143    0.886076    0.814867    0.810991    0.765113    0.751889    0.346505    0.362245    3200        9.068010    0.495311    0.133061    169.225473 
[37m[36mINFO[0m[0m 03/26 01:04:08 | 0.301891    0.305272    0.831709    0.813520    0.500940    0.900870    0.863924    0.803954    0.805855    0.790302    0.770781    0.301891    0.305272    3400        9.634761    0.459848    0.153867    165.505190 
[37m[36mINFO[0m[0m 03/26 01:07:33 | 0.341194    0.340986    0.837634    0.826683    0.451196    0.910888    0.885021    0.821158    0.819209    0.780856    0.775819    0.341194    0.340986    3600        10.201511   0.457369    0.155552    173.397407 
[37m[36mINFO[0m[0m 03/26 01:10:54 | 0.320161    0.308673    0.835338    0.823718    0.489349    0.905088    0.875527    0.816921    0.810991    0.784005    0.784635    0.320161    0.308673    3800        10.768262   0.460114    0.176480    165.459019 
[37m[36mINFO[0m[0m 03/26 01:14:10 | 0.365201    0.353741    0.833209    0.820550    0.500128    0.910361    0.882911    0.803056    0.810478    0.786209    0.768262    0.365201    0.353741    4000        11.335013   0.451168    0.145224    167.731980 
[37m[36mINFO[0m[0m 03/26 01:17:20 | 0.311663    0.309524    0.835222    0.817134    0.533950    0.904825    0.890295    0.825652    0.810478    0.775189    0.750630    0.311663    0.309524    4200        11.901763   0.432794    0.142367    161.421986 
[37m[36mINFO[0m[0m 03/26 01:20:39 | 0.259188    0.247449    0.827663    0.812524    0.518016    0.883206    0.871308    0.816408    0.790447    0.783375    0.775819    0.259188    0.247449    4400        12.468514   0.442328    0.166055    165.605201 
[37m[36mINFO[0m[0m 03/26 01:23:56 | 0.311663    0.312075    0.851352    0.837273    0.432926    0.921171    0.906118    0.825266    0.810991    0.807620    0.794710    0.311663    0.312075    4600        13.035264   0.421845    0.134989    169.615330 
[37m[36mINFO[0m[0m 03/26 01:27:04 | 0.385171    0.377551    0.856441    0.842988    0.434670    0.927234    0.909283    0.855566    0.843862    0.786524    0.775819    0.385171    0.377551    4800        13.602015   0.382807    0.133052    161.180211 
[37m[36mINFO[0m[0m 03/26 01:30:27 | 0.305715    0.294218    0.862967    0.843493    0.444268    0.921434    0.892405    0.858904    0.857216    0.808564    0.780856    0.305715    0.294218    5000        14.168766   0.396724    0.147892    173.369513 
[37m[36mINFO[0m[0m 03/26 01:30:27 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[3]/250326_00-05-25_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/26 01:30:28 | ---
[37m[36mINFO[0m[0m 03/26 01:30:28 | test-domain validation(oracle) = 39.579%
[37m[36mINFO[0m[0m 03/26 01:30:28 | training-domain validation(iid) = 30.571%
[37m[36mINFO[0m[0m 03/26 01:30:28 | last = 30.571%
[37m[36mINFO[0m[0m 03/26 01:30:28 | last (inD) = 84.349%
[37m[36mINFO[0m[0m 03/26 01:30:28 | training-domain validation (iid, inD) = 84.349%
[37m[36mINFO[0m[0m 03/26 01:30:28 | === Summary ===
[37m[36mINFO[0m[0m 03/26 01:30:28 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 6
[37m[36mINFO[0m[0m 03/26 01:30:28 | Unique name: 250326_00-05-25_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 01:30:28 | Out path: train_output/TerraIncognita/ERM/[3]/250326_00-05-25_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/26 01:30:28 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/26 01:30:28 | Dataset: TerraIncognita

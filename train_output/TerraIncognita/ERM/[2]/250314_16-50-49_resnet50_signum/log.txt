[37m[36mINFO[0m[0m 03/14 16:50:49 | Command :: /jsm0707/GENIE/train_all.py resnet50_signum config/resnet50_signum.yaml --algorithm ERM --test_envs 2 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_signum.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_signum
	out_dir: train_output/TerraIncognita/ERM/[2]/250314_16-50-49_resnet50_signum
	out_root: train_output/TerraIncognita/ERM/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250314_16-50-49_resnet50_signum
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: signum
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/14 16:50:49 | n_steps = 5001
[37m[36mINFO[0m[0m 03/14 16:50:49 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/14 16:50:49 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/14 16:50:49 | 
[37m[36mINFO[0m[0m 03/14 16:50:49 | Testenv name escaping te_L43 -> te_L43
[37m[36mINFO[0m[0m 03/14 16:50:49 | Test envs = [2], name = te_L43
[37m[36mINFO[0m[0m 03/14 16:50:49 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 03/14 16:50:49 | Batch sizes for each domain: [32, 32, 0, 32] (total=96)
[37m[36mINFO[0m[0m 03/14 16:50:49 | steps-per-epoch for each domain: 118.53, 243.41, 147.09 -> min = 118.53
[37m[36mINFO[0m[0m 03/14 16:50:50 | # of params = 23528522
[37m[36mINFO[0m[0m 03/14 16:53:42 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/14 16:53:42 | 0.097292    0.104534    0.264393    0.267260    2.057006    0.521487    0.522152    0.037360    0.031330    0.097292    0.104534    0.234332    0.248299    0           0.000000    2.404373    1.050998    170.491624 
[37m[36mINFO[0m[0m 03/14 16:57:28 | 0.400504    0.375315    0.733933    0.749013    0.725263    0.813340    0.815401    0.764283    0.795583    0.400504    0.375315    0.624177    0.636054    200         1.687319    1.024918    0.257106    175.247720 
[37m[36mINFO[0m[0m 03/14 17:01:10 | 0.453401    0.464736    0.759949    0.761292    0.676593    0.843396    0.835443    0.767236    0.789420    0.453401    0.464736    0.669216    0.659014    400         3.374637    0.720277    0.243745    172.873121 
[37m[36mINFO[0m[0m 03/14 17:04:50 | 0.446474    0.454660    0.751888    0.761695    0.771423    0.864224    0.842827    0.723713    0.756035    0.446474    0.454660    0.667729    0.686224    600         5.061956    0.725544    0.246163    170.719390 
[37m[36mINFO[0m[0m 03/14 17:08:31 | 0.476071    0.483627    0.762196    0.772019    0.775408    0.856578    0.855485    0.757607    0.773498    0.476071    0.483627    0.672403    0.687075    800         6.749275    0.799121    0.249179    171.266651 
[37m[36mINFO[0m[0m 03/14 17:12:07 | 0.388539    0.408060    0.740803    0.736670    0.782510    0.846823    0.823840    0.746309    0.761171    0.388539    0.408060    0.629276    0.625000    1000        8.436594    0.825285    0.238667    168.641928 
[37m[36mINFO[0m[0m 03/14 17:15:48 | 0.482053    0.488665    0.757600    0.763923    0.656849    0.848669    0.848101    0.779561    0.788906    0.482053    0.488665    0.644572    0.654762    1200        10.123912   0.986654    0.245179    171.681074 
[37m[36mINFO[0m[0m 03/14 17:19:32 | 0.507242    0.550378    0.704311    0.687947    0.962021    0.782758    0.777426    0.718321    0.695429    0.507242    0.550378    0.611855    0.590986    1400        11.811231   1.011973    0.245965    174.564170 
[37m[36mINFO[0m[0m 03/14 17:23:14 | 0.399559    0.380353    0.663276    0.665262    10.097374   0.800158    0.779536    0.564642    0.604006    0.399559    0.380353    0.625027    0.612245    1600        13.498550   1.182753    0.253489    171.476941 
[37m[36mINFO[0m[0m 03/14 17:26:49 | 0.317065    0.321159    0.594118    0.608960    1.260562    0.737938    0.739451    0.549621    0.591680    0.317065    0.321159    0.494795    0.495748    1800        15.185869   1.507631    0.236689    168.014012 
[37m[36mINFO[0m[0m 03/14 17:30:27 | 0.371222    0.327456    0.625862    0.636576    1.150473    0.757712    0.775316    0.620619    0.649718    0.371222    0.327456    0.499256    0.484694    2000        16.873187   1.547160    0.242765    169.182036 
[37m[36mINFO[0m[0m 03/14 17:34:00 | 0.231738    0.243073    0.587592    0.606035    1.512827    0.820459    0.808017    0.532289    0.572162    0.231738    0.243073    0.410028    0.437925    2200        18.560506   1.628487    0.229754    167.032523 
[37m[36mINFO[0m[0m 03/14 17:37:39 | 0.145151    0.118388    0.476694    0.481830    2.471755    0.570788    0.555907    0.556554    0.583462    0.145151    0.118388    0.302741    0.306122    2400        20.247825   1.798782    0.249541    168.921893 
[37m[36mINFO[0m[0m 03/14 17:41:20 | 0.157746    0.166247    0.450073    0.422827    5.625852    0.535196    0.475738    0.527154    0.546995    0.157746    0.166247    0.287869    0.245748    2600        21.935144   1.895240    0.245558    171.680150 
[37m[36mINFO[0m[0m 03/14 17:44:58 | 0.279912    0.293451    0.620336    0.628082    1.910447    0.791722    0.793249    0.664784    0.693888    0.279912    0.293451    0.404504    0.397109    2800        23.622462   2.090917    0.249031    168.253792 
[37m[36mINFO[0m[0m 03/14 17:48:29 | 0.298804    0.294710    0.493337    0.486425    1.528568    0.678619    0.682489    0.391578    0.397535    0.298804    0.294710    0.409815    0.379252    3000        25.309781   2.279194    0.233062    164.287716 
[37m[36mINFO[0m[0m 03/14 17:52:10 | 0.218199    0.259446    0.542970    0.575099    1.445008    0.678619    0.712025    0.542175    0.590652    0.218199    0.259446    0.408116    0.422619    3200        26.997100   2.132295    0.251534    171.317488 
[37m[36mINFO[0m[0m 03/14 17:55:44 | 0.286209    0.235516    0.209424    0.219197    3.051918    0.199578    0.199367    0.186288    0.214176    0.286209    0.235516    0.242405    0.244048    3400        28.684419   2.341120    0.235747    166.592329 
[37m[36mINFO[0m[0m 03/14 17:59:19 | 0.193325    0.224181    0.524886    0.538765    1.504586    0.634326    0.645570    0.611247    0.637391    0.193325    0.224181    0.329084    0.333333    3600        30.371737   2.386429    0.249608    165.372401 
[37m[36mINFO[0m[0m 03/14 18:02:50 | 0.231423    0.273300    0.417719    0.446545    1.555658    0.442394    0.468354    0.537553    0.593220    0.231423    0.273300    0.273210    0.278061    3800        32.059056   2.254812    0.239700    162.926679 
[37m[36mINFO[0m[0m 03/14 18:06:19 | 0.192695    0.220403    0.445439    0.453088    1.704168    0.486686    0.509494    0.589806    0.606574    0.192695    0.220403    0.259826    0.243197    4000        33.746375   2.066178    0.238732    160.908090 
[37m[36mINFO[0m[0m 03/14 18:09:55 | 0.255353    0.264484    0.447175    0.497642    1.499566    0.414975    0.520042    0.561561    0.578326    0.255353    0.264484    0.364988    0.394558    4200        35.433694   2.014844    0.240387    168.090873 
[37m[36mINFO[0m[0m 03/14 18:13:33 | 0.205919    0.241814    0.456720    0.481148    1.563350    0.515950    0.540084    0.540634    0.609142    0.205919    0.241814    0.313576    0.294218    4400        37.121012   2.437017    0.238028    169.912671 
[37m[36mINFO[0m[0m 03/14 18:17:12 | 0.201511    0.236776    0.506711    0.500729    1.635146    0.606380    0.594937    0.524971    0.503338    0.201511    0.236776    0.388783    0.403912    4600        38.808331   2.135715    0.238477    171.825059 
[37m[36mINFO[0m[0m 03/14 18:20:46 | 0.343199    0.326196    0.286134    0.242843    2.366174    0.235434    0.220464    0.420080    0.318439    0.343199    0.326196    0.202889    0.189626    4800        40.495650   2.022475    0.234981    166.626716 
[37m[36mINFO[0m[0m 03/14 18:24:20 | 0.236461    0.275819    0.498772    0.509109    2.377151    0.587925    0.590717    0.600976    0.621983    0.236461    0.275819    0.307414    0.314626    5000        42.182969   1.900269    0.229989    168.002687 
[37m[36mINFO[0m[0m 03/14 18:24:20 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[2]/250314_16-50-49_resnet50_signum/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/14 18:24:21 | ---
[37m[36mINFO[0m[0m 03/14 18:24:21 | test-domain validation(oracle) = 50.724%
[37m[36mINFO[0m[0m 03/14 18:24:21 | training-domain validation(iid) = 47.607%
[37m[36mINFO[0m[0m 03/14 18:24:21 | last = 23.646%
[37m[36mINFO[0m[0m 03/14 18:24:21 | last (inD) = 50.911%
[37m[36mINFO[0m[0m 03/14 18:24:21 | training-domain validation (iid, inD) = 77.202%
[37m[36mINFO[0m[0m 03/14 18:24:21 | === Summary ===
[37m[36mINFO[0m[0m 03/14 18:24:21 | Command: /jsm0707/GENIE/train_all.py resnet50_signum config/resnet50_signum.yaml --algorithm ERM --test_envs 2 --dataset TerraIncognita
[37m[36mINFO[0m[0m 03/14 18:24:21 | Unique name: 250314_16-50-49_resnet50_signum
[37m[36mINFO[0m[0m 03/14 18:24:21 | Out path: train_output/TerraIncognita/ERM/[2]/250314_16-50-49_resnet50_signum
[37m[36mINFO[0m[0m 03/14 18:24:21 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/14 18:24:21 | Dataset: TerraIncognita

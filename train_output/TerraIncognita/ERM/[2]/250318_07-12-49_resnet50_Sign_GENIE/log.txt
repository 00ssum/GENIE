[37m[36mINFO[0m[0m 03/18 07:12:49 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --trial_seed 1 --hparams_seed 10 --algorithm ERM --test_envs 2 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 10
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[2]/250318_07-12-49_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 1
	unique_name: 250318_07-12-49_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.2128485336217652e-05
	batch_size: 9
	weight_decay: 0.00030907441430549757
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/18 07:12:49 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 07:12:49 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 07:12:49 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 07:12:49 | 
[37m[36mINFO[0m[0m 03/18 07:12:49 | Testenv name escaping te_L43 -> te_L43
[37m[36mINFO[0m[0m 03/18 07:12:49 | Test envs = [2], name = te_L43
[37m[36mINFO[0m[0m 03/18 07:12:49 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 03/18 07:12:49 | Batch sizes for each domain: [9, 9, 0, 9] (total=27)
[37m[36mINFO[0m[0m 03/18 07:12:49 | steps-per-epoch for each domain: 421.44, 865.44, 523.00 -> min = 421.44
[37m[36mINFO[0m[0m 03/18 07:12:50 | # of params = 23528522
[37m[36mINFO[0m[0m 03/18 07:15:37 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 07:15:37 | 0.098237    0.094458    0.259925    0.260020    2.014594    0.517005    0.541139    0.019515    0.022085    0.098237    0.094458    0.243255    0.216837    0           0.000000    2.496683    0.974404    166.163239 
[37m[36mINFO[0m[0m 03/18 07:18:46 | 0.247166    0.251889    0.502312    0.527325    1.337325    0.583443    0.617089    0.591860    0.603493    0.247166    0.251889    0.331634    0.361395    200         0.474558    1.552365    0.114596    165.815217 
[37m[36mINFO[0m[0m 03/18 07:21:57 | 0.252204    0.269521    0.545593    0.566532    1.249787    0.641708    0.648734    0.589293    0.591680    0.252204    0.269521    0.405779    0.459184    400         0.949117    1.340684    0.122373    166.889761 
[37m[36mINFO[0m[0m 03/18 07:25:08 | 0.305101    0.342569    0.549380    0.568506    1.277607    0.644345    0.679325    0.573373    0.564458    0.305101    0.342569    0.430423    0.461735    600         1.423675    1.237029    0.122228    166.129722 
[37m[36mINFO[0m[0m 03/18 07:28:18 | 0.308879    0.346348    0.596453    0.613236    1.120521    0.696019    0.726793    0.611503    0.613765    0.308879    0.346348    0.481836    0.499150    800         1.898234    1.192886    0.120035    166.253984 
[37m[36mINFO[0m[0m 03/18 07:31:30 | 0.307935    0.351385    0.608217    0.606964    1.106890    0.730556    0.731013    0.622031    0.628146    0.307935    0.351385    0.472063    0.461735    1000        2.372792    1.132308    0.119687    168.011979 
[37m[36mINFO[0m[0m 03/18 07:34:39 | 0.378463    0.410579    0.665530    0.661031    0.920197    0.793567    0.789030    0.679548    0.694915    0.378463    0.410579    0.523476    0.499150    1200        2.847350    1.046800    0.117123    165.795411 
[37m[36mINFO[0m[0m 03/18 07:37:50 | 0.381927    0.400504    0.696152    0.687137    0.840886    0.800949    0.776371    0.735139    0.744222    0.381927    0.400504    0.552369    0.540816    1400        3.321909    0.914292    0.118904    167.503469 
[37m[36mINFO[0m[0m 03/18 07:41:05 | 0.302897    0.327456    0.724926    0.727451    0.762389    0.841814    0.845992    0.740018    0.738572    0.302897    0.327456    0.592947    0.597789    1600        3.796467    0.822617    0.116969    170.867921 
[37m[36mINFO[0m[0m 03/18 07:44:14 | 0.391058    0.418136    0.715879    0.724112    0.771726    0.804376    0.806962    0.723970    0.753980    0.391058    0.418136    0.619290    0.611395    1800        4.271026    0.816384    0.119062    165.132149 
[37m[36mINFO[0m[0m 03/18 07:47:26 | 0.436398    0.438287    0.746727    0.735119    0.708363    0.856051    0.847046    0.747208    0.740113    0.436398    0.438287    0.636924    0.618197    2000        4.745584    0.747901    0.118898    168.330212 
[37m[36mINFO[0m[0m 03/18 07:50:30 | 0.428526    0.464736    0.759648    0.752751    0.694815    0.851832    0.828059    0.744511    0.757576    0.428526    0.464736    0.682600    0.672619    2200        5.220142    0.708484    0.118595    160.237984 
[37m[36mINFO[0m[0m 03/18 07:53:36 | 0.429471    0.439547    0.768877    0.773684    0.648592    0.850514    0.852321    0.772243    0.798665    0.429471    0.439547    0.683875    0.670068    2400        5.694701    0.679273    0.116767    163.123343 
[37m[36mINFO[0m[0m 03/18 07:56:44 | 0.425378    0.438287    0.767429    0.763339    0.655085    0.865015    0.861814    0.775067    0.790447    0.425378    0.438287    0.662205    0.637755    2600        6.169259    0.654265    0.120440    163.691069 
[37m[36mINFO[0m[0m 03/18 07:59:52 | 0.459383    0.482368    0.779572    0.769966    0.667728    0.866860    0.844937    0.768648    0.794042    0.459383    0.482368    0.703208    0.670918    2800        6.643818    0.664024    0.111373    165.763039 
[37m[36mINFO[0m[0m 03/18 08:03:02 | 0.441751    0.467254    0.793790    0.778655    0.595690    0.889006    0.871308    0.790217    0.799692    0.441751    0.467254    0.702146    0.664966    3000        7.118376    0.597366    0.122539    165.215788 
[37m[36mINFO[0m[0m 03/18 08:06:10 | 0.449937    0.442065    0.788127    0.779172    0.599781    0.887688    0.872363    0.779433    0.797637    0.449937    0.442065    0.697259    0.667517    3200        7.592934    0.614460    0.117247    165.149298 
[37m[36mINFO[0m[0m 03/18 08:09:15 | 0.481423    0.493703    0.818458    0.815555    0.573597    0.893752    0.887131    0.808063    0.822291    0.481423    0.493703    0.753559    0.737245    3400        8.067493    0.593665    0.123566    159.599802 
[37m[36mINFO[0m[0m 03/18 08:12:24 | 0.498741    0.517632    0.815391    0.810669    0.537241    0.878197    0.864979    0.805495    0.823832    0.498741    0.517632    0.762481    0.743197    3600        8.542051    0.569338    0.119906    165.340652 
[37m[36mINFO[0m[0m 03/18 08:15:35 | 0.415932    0.413098    0.806149    0.796591    0.567711    0.883206    0.867089    0.802927    0.830508    0.415932    0.413098    0.732314    0.692177    3800        9.016610    0.538693    0.125044    165.914266 
[37m[36mINFO[0m[0m 03/18 08:18:44 | 0.434509    0.426952    0.820479    0.799703    0.547051    0.886370    0.862869    0.822570    0.822804    0.434509    0.426952    0.752496    0.713435    4000        9.491168    0.535385    0.122035    164.230748 
[37m[36mINFO[0m[0m 03/18 08:21:52 | 0.464421    0.454660    0.802815    0.784934    0.600108    0.894806    0.875527    0.794710    0.798151    0.464421    0.454660    0.718929    0.681122    4200        9.965726    0.540691    0.119297    164.253412 
[37m[36mINFO[0m[0m 03/18 08:24:59 | 0.487406    0.502519    0.823524    0.810836    0.525860    0.897970    0.880802    0.810759    0.821263    0.487406    0.502519    0.761844    0.730442    4400        10.440285   0.525896    0.115644    163.899392 
[37m[36mINFO[0m[0m 03/18 08:28:07 | 0.477015    0.479849    0.830503    0.824351    0.527114    0.903506    0.887131    0.831044    0.852080    0.477015    0.479849    0.756958    0.733844    4600        10.914843   0.509105    0.117171    165.172513 
[37m[36mINFO[0m[0m 03/18 08:31:14 | 0.472922    0.478589    0.821801    0.810429    0.520700    0.896388    0.886076    0.796123    0.790960    0.472922    0.478589    0.772891    0.754252    4800        11.389402   0.489209    0.125177    161.865036 
[37m[36mINFO[0m[0m 03/18 08:34:23 | 0.483627    0.503778    0.825897    0.817079    0.554656    0.899025    0.893460    0.826807    0.839240    0.483627    0.503778    0.751859    0.718537    5000        11.863960   0.503461    0.120824    164.964147 
[37m[36mINFO[0m[0m 03/18 08:34:23 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[2]/250318_07-12-49_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 08:34:24 | ---
[37m[36mINFO[0m[0m 03/18 08:34:24 | test-domain validation(oracle) = 49.874%
[37m[36mINFO[0m[0m 03/18 08:34:24 | training-domain validation(iid) = 47.702%
[37m[36mINFO[0m[0m 03/18 08:34:24 | last = 48.363%
[37m[36mINFO[0m[0m 03/18 08:34:24 | last (inD) = 81.708%
[37m[36mINFO[0m[0m 03/18 08:34:24 | training-domain validation (iid, inD) = 82.435%
[37m[36mINFO[0m[0m 03/18 08:34:24 | === Summary ===
[37m[36mINFO[0m[0m 03/18 08:34:24 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --trial_seed 1 --hparams_seed 10 --algorithm ERM --test_envs 2 --dataset TerraIncognita
[37m[36mINFO[0m[0m 03/18 08:34:24 | Unique name: 250318_07-12-49_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 08:34:24 | Out path: train_output/TerraIncognita/ERM/[2]/250318_07-12-49_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 08:34:24 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 08:34:24 | Dataset: TerraIncognita

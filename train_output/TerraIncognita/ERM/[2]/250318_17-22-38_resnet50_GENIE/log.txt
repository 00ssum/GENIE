[37m[36mINFO[0m[0m 03/18 17:22:38 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm ERM --test_envs 2 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/ERM/[2]/250318_17-22-38_resnet50_GENIE
	out_root: train_output/TerraIncognita/ERM/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250318_17-22-38_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/18 17:22:38 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 17:22:38 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 17:22:38 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 17:22:38 | 
[37m[36mINFO[0m[0m 03/18 17:22:38 | Testenv name escaping te_L43 -> te_L43
[37m[36mINFO[0m[0m 03/18 17:22:38 | Test envs = [2], name = te_L43
[37m[36mINFO[0m[0m 03/18 17:22:38 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 03/18 17:22:38 | Batch sizes for each domain: [32, 32, 0, 32] (total=96)
[37m[36mINFO[0m[0m 03/18 17:22:38 | steps-per-epoch for each domain: 118.53, 243.41, 147.09 -> min = 118.53
[37m[36mINFO[0m[0m 03/18 17:22:39 | # of params = 23528522
[37m[36mINFO[0m[0m 03/18 17:25:31 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 17:25:31 | 0.096977    0.104534    0.256697    0.261482    1.938409    0.519641    0.518987    0.025677    0.023112    0.096977    0.104534    0.224772    0.242347    0           0.000000    2.404373    1.030890    171.163589 
[37m[36mINFO[0m[0m 03/18 17:29:27 | 0.301322    0.321159    0.611193    0.626536    1.027703    0.742157    0.738397    0.575170    0.597843    0.301322    0.321159    0.516252    0.543367    200         1.687319    1.288359    0.316677    172.604656 
[37m[36mINFO[0m[0m 03/18 17:33:30 | 0.403023    0.433249    0.722109    0.724006    0.764947    0.832059    0.818565    0.732186    0.751412    0.403023    0.433249    0.602082    0.602041    400         3.374637    0.915042    0.353601    172.386533 
[37m[36mINFO[0m[0m 03/18 17:37:29 | 0.472607    0.494962    0.773224    0.782941    0.611622    0.862642    0.853376    0.786751    0.800719    0.472607    0.494962    0.670278    0.694728    600         5.061956    0.694848    0.290303    180.957732 
[37m[36mINFO[0m[0m 03/18 17:41:14 | 0.467884    0.423174    0.802979    0.803665    0.551684    0.885315    0.872363    0.806394    0.824345    0.467884    0.423174    0.717230    0.714286    800         6.749275    0.595060    0.260863    172.986621 
[37m[36mINFO[0m[0m 03/18 17:45:02 | 0.446788    0.454660    0.796315    0.792612    0.573323    0.885051    0.860759    0.792400    0.805342    0.446788    0.454660    0.711494    0.711735    1000        8.436594    0.563758    0.259446    175.940568 
[37m[36mINFO[0m[0m 03/18 17:48:58 | 0.544395    0.527708    0.824990    0.825299    0.485349    0.912734    0.900844    0.811016    0.828454    0.544395    0.527708    0.751222    0.746599    1200        10.123912   0.526679    0.330627    170.093685 
[37m[36mINFO[0m[0m 03/18 17:52:51 | 0.513224    0.497481    0.836440    0.828482    0.475531    0.915634    0.891350    0.806137    0.827940    0.513224    0.497481    0.787550    0.766156    1400        11.811231   0.460133    0.318040    169.428254 
[37m[36mINFO[0m[0m 03/18 17:56:25 | 0.511020    0.496222    0.855890    0.852858    0.439750    0.937253    0.918776    0.838619    0.846430    0.511020    0.496222    0.791799    0.793367    1600        13.498550   0.437802    0.245974    164.009288 
[37m[36mINFO[0m[0m 03/18 17:59:59 | 0.529282    0.523929    0.858001    0.852721    0.427721    0.928553    0.897679    0.849403    0.862866    0.529282    0.523929    0.796048    0.797619    1800        15.185869   0.394308    0.242327    165.944506 
[37m[36mINFO[0m[0m 03/18 18:03:37 | 0.489610    0.471033    0.853144    0.847003    0.462009    0.920643    0.898734    0.844653    0.860812    0.489610    0.471033    0.794136    0.781463    2000        16.873187   0.378025    0.242408    169.412577 
[37m[36mINFO[0m[0m 03/18 18:07:28 | 0.491184    0.517632    0.878120    0.866037    0.395142    0.949117    0.932489    0.858390    0.868002    0.491184    0.517632    0.826854    0.797619    2200        18.560506   0.366183    0.288240    173.842720 
[37m[36mINFO[0m[0m 03/18 18:11:12 | 0.526763    0.535264    0.883371    0.865988    0.383854    0.947535    0.916667    0.870202    0.872625    0.526763    0.535264    0.832377    0.808673    2400        20.247825   0.340912    0.258196    171.566096 
[37m[36mINFO[0m[0m 03/18 18:14:53 | 0.513224    0.501259    0.885122    0.863351    0.394319    0.943580    0.917722    0.874310    0.879815    0.513224    0.501259    0.837476    0.792517    2600        21.935144   0.322501    0.259087    169.352122 
[37m[36mINFO[0m[0m 03/18 18:18:26 | 0.525504    0.520151    0.890119    0.877265    0.373510    0.949380    0.924051    0.870330    0.885465    0.525504    0.520151    0.850648    0.822279    2800        23.622462   0.310536    0.242794    164.315431 
[37m[36mINFO[0m[0m 03/18 18:22:09 | 0.514484    0.512594    0.876984    0.868688    0.401794    0.943844    0.913502    0.863654    0.878788    0.514484    0.512594    0.823454    0.813776    3000        25.309781   0.298803    0.261367    170.714358 
[37m[36mINFO[0m[0m 03/18 18:25:50 | 0.512280    0.526448    0.897903    0.880737    0.373275    0.954917    0.935654    0.883682    0.885978    0.512280    0.526448    0.855109    0.820578    3200        26.997100   0.298843    0.251250    171.223364 
[37m[36mINFO[0m[0m 03/18 18:29:24 | 0.482053    0.486146    0.908540    0.884054    0.357076    0.965726    0.943038    0.899474    0.888546    0.482053    0.486146    0.860421    0.820578    3400        28.684419   0.289152    0.238762    166.477128 
[37m[36mINFO[0m[0m 03/18 18:33:05 | 0.541877    0.539043    0.906991    0.891322    0.344656    0.964672    0.938819    0.884196    0.889060    0.541877    0.539043    0.872105    0.846088    3600        30.371737   0.276763    0.257102    169.357476 
[37m[36mINFO[0m[0m 03/18 18:36:41 | 0.509446    0.506297    0.905745    0.886034    0.364987    0.957026    0.926160    0.895750    0.892655    0.509446    0.506297    0.864457    0.839286    3800        32.059056   0.259744    0.245362    166.211060 
[37m[36mINFO[0m[0m 03/18 18:40:25 | 0.534950    0.521411    0.890070    0.879990    0.359949    0.954126    0.927215    0.893054    0.897278    0.534950    0.521411    0.823030    0.815476    4000        33.746375   0.254403    0.264464    171.900288 
[37m[36mINFO[0m[0m 03/18 18:44:02 | 0.545025    0.551637    0.908344    0.882618    0.357309    0.956499    0.936709    0.901528    0.885465    0.545025    0.551637    0.867007    0.825680    4200        35.433694   0.250445    0.255767    165.261406 
[37m[36mINFO[0m[0m 03/18 18:47:41 | 0.541877    0.555416    0.922702    0.896262    0.319432    0.970999    0.941983    0.910130    0.902414    0.541877    0.555416    0.886977    0.844388    4400        37.121012   0.236832    0.241517    171.242304 
[37m[36mINFO[0m[0m 03/18 18:51:20 | 0.522355    0.560453    0.916080    0.891413    0.339367    0.964144    0.935654    0.903068    0.894196    0.522355    0.560453    0.881028    0.844388    4600        38.808331   0.220960    0.264297    165.607478 
[37m[36mINFO[0m[0m 03/18 18:54:55 | 0.550378    0.537783    0.922739    0.891553    0.362281    0.973372    0.935654    0.908717    0.906523    0.550378    0.537783    0.886127    0.832483    4800        40.495650   0.225549    0.262486    162.749651 
[37m[36mINFO[0m[0m 03/18 18:58:37 | 0.508186    0.518892    0.924131    0.895418    0.343740    0.975745    0.944093    0.905636    0.895223    0.508186    0.518892    0.891013    0.846939    5000        42.182969   0.222915    0.252486    170.980619 
[37m[36mINFO[0m[0m 03/18 18:58:37 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[2]/250318_17-22-38_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 18:58:38 | ---
[37m[36mINFO[0m[0m 03/18 18:58:38 | test-domain validation(oracle) = 52.236%
[37m[36mINFO[0m[0m 03/18 18:58:38 | training-domain validation(iid) = 54.188%
[37m[36mINFO[0m[0m 03/18 18:58:38 | last = 50.819%
[37m[36mINFO[0m[0m 03/18 18:58:38 | last (inD) = 89.542%
[37m[36mINFO[0m[0m 03/18 18:58:38 | training-domain validation (iid, inD) = 89.626%
[37m[36mINFO[0m[0m 03/18 18:58:38 | === Summary ===
[37m[36mINFO[0m[0m 03/18 18:58:38 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm ERM --test_envs 2 --dataset TerraIncognita
[37m[36mINFO[0m[0m 03/18 18:58:38 | Unique name: 250318_17-22-38_resnet50_GENIE
[37m[36mINFO[0m[0m 03/18 18:58:38 | Out path: train_output/TerraIncognita/ERM/[2]/250318_17-22-38_resnet50_GENIE
[37m[36mINFO[0m[0m 03/18 18:58:38 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 18:58:38 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 03/04 20:44:39 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 2 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/TerraIncognita/ERM/[2]/250304_20-44-39_clip_vitb16_GENIE
	out_root: train_output/TerraIncognita/ERM/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250304_20-44-39_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: clip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/04 20:44:39 | n_steps = 5001
[37m[36mINFO[0m[0m 03/04 20:44:39 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/04 20:44:39 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/04 20:44:39 | 
[37m[36mINFO[0m[0m 03/04 20:44:39 | Testenv name escaping te_L43 -> te_L43
[37m[36mINFO[0m[0m 03/04 20:44:39 | Test envs = [2], name = te_L43
[37m[36mINFO[0m[0m 03/04 20:44:39 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 03/04 20:44:39 | Batch sizes for each domain: [32, 32, 0, 32] (total=96)
[37m[36mINFO[0m[0m 03/04 20:44:39 | steps-per-epoch for each domain: 118.53, 243.41, 147.09 -> min = 118.53
[37m[36mINFO[0m[0m 03/04 20:44:42 | # of params = 86197770
[37m[36mINFO[0m[0m 03/04 20:47:32 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/04 20:47:32 | 0.186398    0.220403    0.293516    0.296375    2.214559    0.203533    0.204641    0.455643    0.481253    0.186398    0.220403    0.221372    0.203231    0           0.000000    2.158533    1.107807    169.172983 
[37m[36mINFO[0m[0m 03/04 20:51:49 | 0.218829    0.255668    0.454537    0.511033    1.399257    0.496968    0.607595    0.508666    0.537750    0.218829    0.255668    0.357977    0.387755    200         1.687319    1.562079    0.434250    170.263471 
[37m[36mINFO[0m[0m 03/04 20:56:02 | 0.252204    0.294710    0.530293    0.544419    1.288618    0.634590    0.651899    0.543074    0.548536    0.252204    0.294710    0.413214    0.432823    400         3.374637    1.374555    0.438702    165.256864 
[37m[36mINFO[0m[0m 03/04 21:00:15 | 0.254093    0.239295    0.585501    0.591981    1.158730    0.679146    0.650844    0.610605    0.630200    0.254093    0.239295    0.466752    0.494898    600         5.061956    1.264716    0.436137    165.745096 
[37m[36mINFO[0m[0m 03/04 21:04:31 | 0.265428    0.280856    0.579728    0.603198    1.135911    0.677828    0.719409    0.607138    0.622496    0.265428    0.280856    0.454217    0.467687    800         6.749275    1.170446    0.436634    168.391027 
[37m[36mINFO[0m[0m 03/04 21:08:50 | 0.273300    0.250630    0.609820    0.630491    1.048215    0.725811    0.734177    0.633072    0.664099    0.273300    0.250630    0.470576    0.493197    1000        8.436594    1.097790    0.435845    172.307109 
[37m[36mINFO[0m[0m 03/04 21:13:04 | 0.291877    0.251889    0.642462    0.647254    0.984320    0.764303    0.755274    0.661702    0.680534    0.291877    0.251889    0.501381    0.505952    1200        10.123912   1.024363    0.432879    167.333343 
[37m[36mINFO[0m[0m 03/04 21:17:16 | 0.289673    0.317380    0.702664    0.714229    0.820484    0.813077    0.816456    0.707279    0.724191    0.289673    0.317380    0.587635    0.602041    1400        11.811231   0.908102    0.432775    165.144800 
[37m[36mINFO[0m[0m 03/04 21:21:27 | 0.403652    0.381612    0.750230    0.759614    0.684588    0.855787    0.857595    0.744383    0.767334    0.403652    0.381612    0.650521    0.653912    1600        13.498550   0.781232    0.436383    163.769970 
[37m[36mINFO[0m[0m 03/04 21:25:35 | 0.386020    0.369018    0.764273    0.773316    0.644657    0.860005    0.870253    0.751701    0.774525    0.386020    0.369018    0.681113    0.675170    1800        15.185869   0.694289    0.435231    161.401614 
[37m[36mINFO[0m[0m 03/04 21:29:44 | 0.388224    0.358942    0.779966    0.786786    0.586219    0.872924    0.869198    0.780973    0.795583    0.388224    0.358942    0.686000    0.695578    2000        16.873187   0.646915    0.435301    161.346472 
[37m[36mINFO[0m[0m 03/04 21:33:54 | 0.354219    0.356423    0.787874    0.800811    0.562836    0.890324    0.892405    0.768391    0.794042    0.354219    0.356423    0.704908    0.715986    2200        18.560506   0.607491    0.433148    163.359367 
[37m[36mINFO[0m[0m 03/04 21:38:07 | 0.387280    0.375315    0.792659    0.797867    0.554358    0.881888    0.877637    0.776736    0.791474    0.387280    0.375315    0.719354    0.724490    2400        20.247825   0.566061    0.435322    166.491146 
[37m[36mINFO[0m[0m 03/04 21:42:17 | 0.428841    0.455919    0.822486    0.808410    0.532554    0.907725    0.894515    0.811272    0.810478    0.428841    0.455919    0.748460    0.720238    2600        21.935144   0.542587    0.432541    163.032317 
[37m[36mINFO[0m[0m 03/04 21:46:29 | 0.451196    0.448363    0.833034    0.829268    0.474640    0.904034    0.912447    0.820901    0.822804    0.451196    0.448363    0.774166    0.752551    2800        23.622462   0.513835    0.432276    165.384897 
[37m[36mINFO[0m[0m 03/04 21:50:41 | 0.376889    0.342569    0.828510    0.821870    0.480949    0.911416    0.905063    0.813968    0.820750    0.376889    0.342569    0.760144    0.739796    3000        25.309781   0.478345    0.432489    166.197327 
[37m[36mINFO[0m[0m 03/04 21:54:51 | 0.413728    0.400504    0.831566    0.835541    0.451325    0.909570    0.899789    0.809475    0.825372    0.413728    0.400504    0.775653    0.781463    3200        26.997100   0.478283    0.432113    163.121268 
[37m[36mINFO[0m[0m 03/04 21:59:05 | 0.430101    0.454660    0.847888    0.844910    0.436707    0.924071    0.914557    0.828219    0.836158    0.430101    0.454660    0.791375    0.784014    3400        28.684419   0.441397    0.432133    167.677763 
[37m[36mINFO[0m[0m 03/04 22:03:20 | 0.394836    0.420655    0.859255    0.853064    0.422394    0.928816    0.912447    0.833355    0.842322    0.394836    0.420655    0.815594    0.804422    3600        30.371737   0.417998    0.433094    168.053338 
[37m[36mINFO[0m[0m 03/04 22:07:31 | 0.439547    0.445844    0.865119    0.858112    0.401336    0.928553    0.918776    0.852484    0.863893    0.439547    0.445844    0.814319    0.791667    3800        32.059056   0.396001    0.432808    165.056638 
[37m[36mINFO[0m[0m 03/04 22:11:44 | 0.419395    0.454660    0.862276    0.841817    0.436045    0.939626    0.918776    0.826935    0.826913    0.419395    0.454660    0.820268    0.779762    4000        33.746375   0.372505    0.433243    166.305778 
[37m[36mINFO[0m[0m 03/04 22:16:00 | 0.412783    0.425693    0.881584    0.861608    0.394414    0.935144    0.914557    0.861086    0.850539    0.412783    0.425693    0.848523    0.819728    4200        35.433694   0.353704    0.432815    169.016435 
[37m[36mINFO[0m[0m 03/04 22:20:12 | 0.418136    0.437028    0.880413    0.864337    0.383024    0.948326    0.918776    0.855437    0.858757    0.418136    0.437028    0.837476    0.815476    4400        37.121012   0.359782    0.433423    165.272153 
[37m[36mINFO[0m[0m 03/04 22:24:21 | 0.426637    0.414358    0.890723    0.874393    0.362956    0.950699    0.927215    0.873796    0.878788    0.426637    0.414358    0.847674    0.817177    4600        38.808331   0.331983    0.433674    162.408662 
[37m[36mINFO[0m[0m 03/04 22:28:34 | 0.386335    0.392947    0.886967    0.872706    0.366346    0.950435    0.927215    0.856207    0.859271    0.386335    0.392947    0.854260    0.831633    4800        40.495650   0.315978    0.434006    166.489251 
[37m[36mINFO[0m[0m 03/04 22:32:47 | 0.410579    0.408060    0.895518    0.867720    0.375591    0.950171    0.932489    0.873411    0.860298    0.410579    0.408060    0.862970    0.810374    5000        42.182969   0.311389    0.437018    165.774866 
[37m[36mINFO[0m[0m 03/04 22:32:48 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[2]/250304_20-44-39_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/04 22:32:50 | ---
[37m[36mINFO[0m[0m 03/04 22:32:50 | test-domain validation(oracle) = 42.884%
[37m[36mINFO[0m[0m 03/04 22:32:50 | training-domain validation(iid) = 42.664%
[37m[36mINFO[0m[0m 03/04 22:32:50 | last = 41.058%
[37m[36mINFO[0m[0m 03/04 22:32:50 | last (inD) = 86.772%
[37m[36mINFO[0m[0m 03/04 22:32:50 | training-domain validation (iid, inD) = 87.439%
[37m[36mINFO[0m[0m 03/04 22:32:50 | === Summary ===
[37m[36mINFO[0m[0m 03/04 22:32:50 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 2 --dataset TerraIncognita
[37m[36mINFO[0m[0m 03/04 22:32:50 | Unique name: 250304_20-44-39_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/04 22:32:50 | Out path: train_output/TerraIncognita/ERM/[2]/250304_20-44-39_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/04 22:32:50 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/04 22:32:50 | Dataset: TerraIncognita

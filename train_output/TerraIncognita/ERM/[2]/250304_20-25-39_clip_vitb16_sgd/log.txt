[37m[36mINFO[0m[0m 03/04 20:25:39 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_sgd config/clip_vitb16_sgd.yaml --algorithm ERM --test_envs 2 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_sgd.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_sgd
	out_dir: train_output/TerraIncognita/ERM/[2]/250304_20-25-39_clip_vitb16_sgd
	out_root: train_output/TerraIncognita/ERM/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250304_20-25-39_clip_vitb16_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: clip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/04 20:25:39 | n_steps = 5001
[37m[36mINFO[0m[0m 03/04 20:25:39 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/04 20:25:39 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/04 20:25:39 | 
[37m[36mINFO[0m[0m 03/04 20:25:39 | Testenv name escaping te_L43 -> te_L43
[37m[36mINFO[0m[0m 03/04 20:25:39 | Test envs = [2], name = te_L43
[37m[36mINFO[0m[0m 03/04 20:25:39 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 03/04 20:25:39 | Batch sizes for each domain: [32, 32, 0, 32] (total=96)
[37m[36mINFO[0m[0m 03/04 20:25:39 | steps-per-epoch for each domain: 118.53, 243.41, 147.09 -> min = 118.53
[37m[36mINFO[0m[0m 03/04 20:25:41 | # of params = 86197770
[37m[36mINFO[0m[0m 03/04 20:28:28 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/04 20:28:28 | 0.155227    0.183879    0.232486    0.277677    2.200507    0.104139    0.145570    0.367698    0.417052    0.155227    0.183879    0.225621    0.270408    0           0.000000    2.158533    1.086039    165.903115 
[37m[36mINFO[0m[0m 03/04 20:32:33 | 0.177897    0.214106    0.441344    0.456212    1.789782    0.556024    0.592827    0.464630    0.480740    0.177897    0.214106    0.303378    0.295068    200         1.687319    1.944532    0.411641    161.931886 
[37m[36mINFO[0m[0m 03/04 20:36:41 | 0.175693    0.212846    0.467311    0.478799    1.625714    0.563406    0.579114    0.527924    0.534155    0.175693    0.212846    0.310601    0.323129    400         3.374637    1.712107    0.414175    165.122026 
[37m[36mINFO[0m[0m 03/04 20:40:58 | 0.175378    0.212846    0.506710    0.519671    1.515557    0.596889    0.614979    0.586083    0.613251    0.175378    0.212846    0.337157    0.330782    600         5.061956    1.581743    0.408495    175.323129 
[37m[36mINFO[0m[0m 03/04 20:45:01 | 0.176952    0.212846    0.530493    0.530965    1.440763    0.619035    0.620253    0.597894    0.618901    0.176952    0.212846    0.374549    0.353741    800         6.749275    1.506606    0.409172    161.794974 
[37m[36mINFO[0m[0m 03/04 20:49:09 | 0.187972    0.225441    0.551378    0.550639    1.384206    0.630108    0.631857    0.609963    0.639959    0.187972    0.225441    0.414064    0.380102    1000        8.436594    1.409355    0.408821    166.473668 
[37m[36mINFO[0m[0m 03/04 20:53:18 | 0.205919    0.243073    0.571142    0.569794    1.335368    0.663064    0.662447    0.608679    0.640473    0.205919    0.243073    0.441683    0.406463    1200        10.123912   1.371281    0.408805    166.837968 
[37m[36mINFO[0m[0m 03/04 20:57:29 | 0.229534    0.260705    0.593595    0.592227    1.294980    0.694701    0.710970    0.624856    0.650745    0.229534    0.260705    0.461228    0.414966    1400        11.811231   1.323180    0.406600    169.731039 
[37m[36mINFO[0m[0m 03/04 21:01:39 | 0.252204    0.278338    0.612179    0.608529    1.243056    0.726602    0.727848    0.620876    0.658963    0.252204    0.278338    0.489059    0.438776    1600        13.498550   1.272452    0.408902    168.474936 
[37m[36mINFO[0m[0m 03/04 21:05:47 | 0.308249    0.345088    0.624409    0.629566    1.197389    0.744002    0.754219    0.632944    0.659990    0.308249    0.345088    0.496282    0.474490    1800        15.185869   1.227415    0.406734    166.616759 
[37m[36mINFO[0m[0m 03/04 21:09:51 | 0.341625    0.386650    0.651957    0.643827    1.144641    0.777485    0.762658    0.668507    0.684129    0.341625    0.386650    0.509879    0.484694    2000        16.873187   1.179393    0.405883    162.885808 
[37m[36mINFO[0m[0m 03/04 21:13:53 | 0.361146    0.390428    0.671632    0.663345    1.092910    0.777221    0.767932    0.712287    0.717001    0.361146    0.390428    0.525388    0.505102    2200        18.560506   1.131279    0.406595    160.375237 
[37m[36mINFO[0m[0m 03/04 21:17:57 | 0.379408    0.420655    0.687525    0.690622    1.039304    0.802795    0.794304    0.725895    0.745249    0.379408    0.420655    0.533886    0.532313    2400        20.247825   1.085596    0.406384    162.124089 
[37m[36mINFO[0m[0m 03/04 21:21:58 | 0.412783    0.450882    0.704616    0.701169    1.014462    0.820722    0.805907    0.736295    0.740627    0.412783    0.450882    0.556830    0.556973    2600        21.935144   1.044755    0.410901    158.874578 
[37m[36mINFO[0m[0m 03/04 21:26:05 | 0.388224    0.425693    0.710061    0.705922    0.974279    0.828895    0.815401    0.736808    0.741140    0.388224    0.425693    0.564478    0.561224    2800        23.622462   1.001672    0.411761    164.648947 
[37m[36mINFO[0m[0m 03/04 21:30:11 | 0.429471    0.462217    0.718718    0.719052    0.939373    0.828632    0.820675    0.745410    0.756549    0.429471    0.462217    0.582112    0.579932    3000        25.309781   0.957772    0.412701    163.764106 
[37m[36mINFO[0m[0m 03/04 21:34:15 | 0.427582    0.448363    0.733247    0.741073    0.888690    0.853678    0.852321    0.753755    0.766307    0.427582    0.448363    0.592309    0.604592    3200        26.997100   0.930636    0.411201    161.567858 
[37m[36mINFO[0m[0m 03/04 21:38:24 | 0.410894    0.453401    0.734761    0.736521    0.883483    0.848669    0.844937    0.752471    0.769389    0.410894    0.453401    0.603144    0.595238    3400        28.684419   0.900541    0.410062    167.175696 
[37m[36mINFO[0m[0m 03/04 21:42:30 | 0.434509    0.458438    0.741349    0.746166    0.838782    0.856842    0.851266    0.762999    0.767334    0.434509    0.458438    0.604207    0.619898    3600        30.371737   0.869210    0.406635    164.584293 
[37m[36mINFO[0m[0m 03/04 21:46:30 | 0.427897    0.439547    0.734880    0.744448    0.823957    0.850250    0.853376    0.765053    0.774525    0.427897    0.439547    0.589335    0.605442    3800        32.059056   0.858413    0.406712    158.639066 
[37m[36mINFO[0m[0m 03/04 21:50:32 | 0.431360    0.460957    0.754939    0.747082    0.807060    0.867651    0.855485    0.769804    0.776066    0.431360    0.460957    0.627364    0.609694    4000        33.746375   0.843775    0.403409    161.343462 
[37m[36mINFO[0m[0m 03/04 21:54:40 | 0.448048    0.468514    0.760361    0.764314    0.783603    0.870815    0.863924    0.771858    0.785311    0.448048    0.468514    0.638411    0.643707    4200        35.433694   0.832930    0.410291    166.590170 
[37m[36mINFO[0m[0m 03/04 21:58:46 | 0.455290    0.478589    0.759956    0.761781    0.769362    0.872924    0.861814    0.770446    0.778120    0.455290    0.478589    0.636499    0.645408    4400        37.121012   0.797448    0.406523    164.196435 
[37m[36mINFO[0m[0m 03/04 22:02:49 | 0.462531    0.482368    0.769747    0.768415    0.745424    0.873451    0.864979    0.775709    0.788906    0.462531    0.482368    0.660081    0.651361    4600        38.808331   0.791246    0.406543    161.344101 
[37m[36mINFO[0m[0m 03/04 22:06:56 | 0.463161    0.488665    0.767636    0.768354    0.737030    0.874506    0.866034    0.776608    0.781715    0.463161    0.488665    0.651795    0.657313    4800        40.495650   0.759841    0.407747    166.201053 
[37m[36mINFO[0m[0m 03/04 22:11:06 | 0.460327    0.481108    0.768374    0.773970    0.717538    0.872133    0.870253    0.776094    0.788392    0.460327    0.481108    0.656894    0.663265    5000        42.182969   0.748545    0.408621    167.441024 
[37m[36mINFO[0m[0m 03/04 22:11:06 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[2]/250304_20-25-39_clip_vitb16_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/04 22:11:09 | ---
[37m[36mINFO[0m[0m 03/04 22:11:09 | test-domain validation(oracle) = 46.316%
[37m[36mINFO[0m[0m 03/04 22:11:09 | training-domain validation(iid) = 46.033%
[37m[36mINFO[0m[0m 03/04 22:11:09 | last = 46.033%
[37m[36mINFO[0m[0m 03/04 22:11:09 | last (inD) = 77.397%
[37m[36mINFO[0m[0m 03/04 22:11:09 | training-domain validation (iid, inD) = 77.397%
[37m[36mINFO[0m[0m 03/04 22:11:09 | === Summary ===
[37m[36mINFO[0m[0m 03/04 22:11:09 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_sgd config/clip_vitb16_sgd.yaml --algorithm ERM --test_envs 2 --dataset TerraIncognita
[37m[36mINFO[0m[0m 03/04 22:11:09 | Unique name: 250304_20-25-39_clip_vitb16_sgd
[37m[36mINFO[0m[0m 03/04 22:11:09 | Out path: train_output/TerraIncognita/ERM/[2]/250304_20-25-39_clip_vitb16_sgd
[37m[36mINFO[0m[0m 03/04 22:11:09 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/04 22:11:09 | Dataset: TerraIncognita

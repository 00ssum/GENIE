[37m[36mINFO[0m[0m 02/27 15:03:26 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_adam config/clip_vitb16_adam.yaml --algorithm ERM --test_envs 2 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_adam.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_adam
	out_dir: train_output/TerraIncognita/ERM/[2]/250227_15-03-26_clip_vitb16_adam
	out_root: train_output/TerraIncognita/ERM/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250227_15-03-26_clip_vitb16_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: clip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/27 15:03:26 | n_steps = 5001
[37m[36mINFO[0m[0m 02/27 15:03:26 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/27 15:03:26 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/27 15:03:26 | 
[37m[36mINFO[0m[0m 02/27 15:03:26 | Testenv name escaping te_L43 -> te_L43
[37m[36mINFO[0m[0m 02/27 15:03:26 | Test envs = [2], name = te_L43
[37m[36mINFO[0m[0m 02/27 15:03:26 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 02/27 15:03:26 | Batch sizes for each domain: [32, 32, 0, 32] (total=96)
[37m[36mINFO[0m[0m 02/27 15:03:26 | steps-per-epoch for each domain: 118.53, 243.41, 147.09 -> min = 118.53
[37m[36mINFO[0m[0m 02/27 15:03:29 | # of params = 86197770
[37m[36mINFO[0m[0m 02/27 15:06:28 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/27 15:06:28 | 0.186398    0.221662    0.304263    0.300616    1.965139    0.208015    0.208861    0.451534    0.481253    0.186398    0.221662    0.253240    0.211735    0           0.000000    2.158533    1.083586    178.311568 
[37m[36mINFO[0m[0m 02/27 15:10:42 | 0.455919    0.469773    0.755776    0.775491    0.655937    0.845241    0.867089    0.760945    0.774011    0.455919    0.469773    0.661143    0.685374    200         1.687319    0.949584    0.410360    172.031089 
[37m[36mINFO[0m[0m 02/27 15:15:01 | 0.472607    0.437028    0.787892    0.804415    0.580725    0.867915    0.870253    0.790217    0.815100    0.472607    0.437028    0.705545    0.727891    400         3.374637    0.664402    0.409994    176.338369 
[37m[36mINFO[0m[0m 02/27 15:19:26 | 0.491499    0.500000    0.811977    0.807153    0.534767    0.901397    0.894515    0.793298    0.805855    0.491499    0.500000    0.741236    0.721088    600         5.061956    0.565587    0.408574    183.887230 
[37m[36mINFO[0m[0m 02/27 15:23:44 | 0.496222    0.532746    0.815861    0.823213    0.501921    0.900870    0.896624    0.802927    0.828968    0.496222    0.532746    0.743786    0.744048    800         6.749275    0.519395    0.407174    176.621585 
[37m[36mINFO[0m[0m 02/27 15:27:58 | 0.479219    0.493703    0.833823    0.833799    0.475936    0.906143    0.899789    0.827321    0.832049    0.479219    0.493703    0.768005    0.769558    1000        8.436594    0.466654    0.405684    172.637840 
[37m[36mINFO[0m[0m 02/27 15:32:13 | 0.509131    0.515113    0.856147    0.845557    0.426563    0.926707    0.916667    0.852484    0.862352    0.509131    0.515113    0.789250    0.757653    1200        10.123912   0.434687    0.405442    174.130129 
[37m[36mINFO[0m[0m 02/27 15:36:38 | 0.476700    0.488665    0.863580    0.843984    0.441882    0.932771    0.911392    0.852998    0.843349    0.476700    0.488665    0.804971    0.777211    1400        11.811231   0.407808    0.410573    182.382157 
[37m[36mINFO[0m[0m 02/27 15:40:55 | 0.468199    0.463476    0.862161    0.853735    0.423195    0.927498    0.912447    0.858262    0.863893    0.468199    0.463476    0.800722    0.784864    1600        13.498550   0.375019    0.414536    174.154906 
[37m[36mINFO[0m[0m 02/27 15:45:18 | 0.471348    0.449622    0.877694    0.871571    0.401731    0.931453    0.917722    0.880087    0.879815    0.471348    0.449622    0.821542    0.817177    1800        15.185869   0.361470    0.410090    180.735725 
[37m[36mINFO[0m[0m 02/27 15:49:37 | 0.459383    0.449622    0.888695    0.872819    0.370635    0.944108    0.931435    0.879189    0.863893    0.459383    0.449622    0.842787    0.823129    2000        16.873187   0.347801    0.409265    177.513735 
[37m[36mINFO[0m[0m 02/27 15:54:05 | 0.457179    0.452141    0.884934    0.867124    0.400034    0.941207    0.915612    0.871871    0.878788    0.457179    0.452141    0.841725    0.806973    2200        18.560506   0.331695    0.407594    186.317865 
[37m[36mINFO[0m[0m 02/27 15:58:18 | 0.446159    0.420655    0.878784    0.862740    0.415418    0.945953    0.926160    0.854410    0.869543    0.446159    0.420655    0.835989    0.792517    2400        20.247825   0.316378    0.408036    171.956914 
[37m[36mINFO[0m[0m 02/27 16:02:35 | 0.444270    0.465995    0.892697    0.881811    0.350291    0.956762    0.937764    0.889588    0.899846    0.444270    0.465995    0.831740    0.807823    2600        21.935144   0.310338    0.409520    174.464527 
[37m[36mINFO[0m[0m 02/27 16:06:46 | 0.420655    0.409320    0.889322    0.870172    0.394106    0.963090    0.948312    0.876749    0.865434    0.420655    0.409320    0.828128    0.796769    2800        23.622462   0.297174    0.408140    169.822041 
[37m[36mINFO[0m[0m 02/27 16:11:09 | 0.458123    0.452141    0.906499    0.891566    0.323874    0.957553    0.949367    0.894723    0.896251    0.458123    0.452141    0.867219    0.829082    3000        25.309781   0.276215    0.405379    181.351910 
[37m[36mINFO[0m[0m 02/27 16:15:30 | 0.449937    0.455919    0.896712    0.886688    0.352348    0.960717    0.945148    0.892156    0.890087    0.449937    0.455919    0.837264    0.824830    3200        26.997100   0.270748    0.407355    180.099273 
[37m[36mINFO[0m[0m 02/27 16:19:53 | 0.500000    0.510076    0.902558    0.877783    0.359264    0.954917    0.919831    0.893825    0.884438    0.500000    0.510076    0.858934    0.829082    3400        28.684419   0.267773    0.410529    180.392039 
[37m[36mINFO[0m[0m 02/27 16:24:14 | 0.442380    0.442065    0.916939    0.899779    0.309832    0.969154    0.947257    0.907434    0.903441    0.442380    0.442065    0.874230    0.848639    3600        30.371737   0.254649    0.407069    179.946994 
[37m[36mINFO[0m[0m 02/27 16:28:36 | 0.433249    0.428212    0.911173    0.881363    0.340245    0.961772    0.940928    0.887534    0.861325    0.433249    0.428212    0.884215    0.841837    3800        32.059056   0.250396    0.411944    180.023441 
[37m[36mINFO[0m[0m 02/27 16:32:53 | 0.442380    0.431990    0.920638    0.900995    0.307031    0.965726    0.947257    0.912184    0.914741    0.442380    0.431990    0.884003    0.840986    4000        33.746375   0.240896    0.411223    174.160037 
[37m[36mINFO[0m[0m 02/27 16:37:14 | 0.503463    0.492443    0.915099    0.886960    0.339660    0.959135    0.926160    0.912569    0.901387    0.503463    0.492443    0.873593    0.833333    4200        35.433694   0.235553    0.411281    178.550537 
[37m[36mINFO[0m[0m 02/27 16:41:28 | 0.412469    0.434509    0.920127    0.898963    0.309298    0.963354    0.940928    0.917063    0.898819    0.412469    0.434509    0.879966    0.857143    4400        37.121012   0.227567    0.411162    172.366928 
[37m[36mINFO[0m[0m 02/27 16:45:46 | 0.471348    0.457179    0.922991    0.887722    0.322239    0.967572    0.935654    0.910386    0.891628    0.471348    0.457179    0.891013    0.835884    4600        38.808331   0.223894    0.409308    176.336929 
[37m[36mINFO[0m[0m 02/27 16:50:11 | 0.446788    0.442065    0.909799    0.881007    0.339902    0.963090    0.941983    0.881243    0.848998    0.446788    0.442065    0.885065    0.852041    4800        40.495650   0.224726    0.405244    183.500409 
[37m[36mINFO[0m[0m 02/27 16:54:27 | 0.414043    0.396725    0.925706    0.894480    0.318841    0.960981    0.938819    0.921299    0.907036    0.414043    0.396725    0.894837    0.837585    5000        42.182969   0.215355    0.406722    174.414713 
[37m[36mINFO[0m[0m 02/27 16:54:27 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[2]/250227_15-03-26_clip_vitb16_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/27 16:54:29 | ---
[37m[36mINFO[0m[0m 02/27 16:54:29 | test-domain validation(oracle) = 49.622%
[37m[36mINFO[0m[0m 02/27 16:54:29 | training-domain validation(iid) = 44.238%
[37m[36mINFO[0m[0m 02/27 16:54:29 | last = 41.404%
[37m[36mINFO[0m[0m 02/27 16:54:29 | last (inD) = 89.448%
[37m[36mINFO[0m[0m 02/27 16:54:29 | training-domain validation (iid, inD) = 90.099%
[37m[36mINFO[0m[0m 02/27 16:54:29 | === Summary ===
[37m[36mINFO[0m[0m 02/27 16:54:29 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_adam config/clip_vitb16_adam.yaml --algorithm ERM --test_envs 2 --dataset TerraIncognita
[37m[36mINFO[0m[0m 02/27 16:54:29 | Unique name: 250227_15-03-26_clip_vitb16_adam
[37m[36mINFO[0m[0m 02/27 16:54:29 | Out path: train_output/TerraIncognita/ERM/[2]/250227_15-03-26_clip_vitb16_adam
[37m[36mINFO[0m[0m 02/27 16:54:29 | Algorithm: ERM
[37m[36mINFO[0m[0m 02/27 16:54:29 | Dataset: TerraIncognita

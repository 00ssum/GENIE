[37m[36mINFO[0m[0m 03/18 05:43:17 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 2 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[2]/250318_05-43-17_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250318_05-43-17_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/18 05:43:18 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 05:43:18 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 05:43:18 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 05:43:18 | 
[37m[36mINFO[0m[0m 03/18 05:43:18 | Testenv name escaping te_L43 -> te_L43
[37m[36mINFO[0m[0m 03/18 05:43:18 | Test envs = [2], name = te_L43
[37m[36mINFO[0m[0m 03/18 05:43:18 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 03/18 05:43:18 | Batch sizes for each domain: [32, 32, 0, 32] (total=96)
[37m[36mINFO[0m[0m 03/18 05:43:18 | steps-per-epoch for each domain: 118.53, 243.41, 147.09 -> min = 118.53
[37m[36mINFO[0m[0m 03/18 05:43:19 | # of params = 23528522
[37m[36mINFO[0m[0m 03/18 05:46:06 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 05:46:06 | 0.096348    0.104534    0.259122    0.260236    1.930258    0.519641    0.518987    0.038901    0.023626    0.096348    0.104534    0.218823    0.238095    0           0.000000    2.404373    1.195058    165.857423 
[37m[36mINFO[0m[0m 03/18 05:49:40 | 0.307305    0.357683    0.590677    0.599068    1.087931    0.710519    0.704641    0.581589    0.596816    0.307305    0.357683    0.479924    0.495748    200         1.687319    1.278001    0.238854    166.779954 
[37m[36mINFO[0m[0m 03/18 05:53:18 | 0.413413    0.414358    0.733047    0.743120    0.743590    0.850514    0.839662    0.737835    0.754494    0.413413    0.414358    0.610792    0.635204    400         3.374637    0.915461    0.271083    163.777959 
[37m[36mINFO[0m[0m 03/18 05:56:57 | 0.431675    0.455919    0.770291    0.772829    0.624926    0.860796    0.857595    0.777250    0.770416    0.431675    0.455919    0.672828    0.690476    600         5.061956    0.699991    0.241839    170.688516 
[37m[36mINFO[0m[0m 03/18 06:00:38 | 0.444270    0.421914    0.797785    0.814531    0.547042    0.877933    0.876582    0.806265    0.821263    0.444270    0.421914    0.709157    0.745748    800         6.749275    0.596660    0.267652    166.862162 
[37m[36mINFO[0m[0m 03/18 06:04:21 | 0.511965    0.502519    0.796335    0.788841    0.585470    0.880569    0.862869    0.773784    0.781715    0.511965    0.502519    0.734651    0.721939    1000        8.436594    0.561049    0.271587    169.106084 
[37m[36mINFO[0m[0m 03/18 06:07:57 | 0.501889    0.532746    0.814263    0.803120    0.533777    0.883470    0.847046    0.813198    0.831022    0.501889    0.532746    0.746123    0.731293    1200        10.123912   0.511890    0.237420    168.184014 
[37m[36mINFO[0m[0m 03/18 06:11:39 | 0.515113    0.515113    0.843439    0.832019    0.481121    0.916952    0.883966    0.836436    0.848485    0.515113    0.515113    0.776928    0.763605    1400        11.811231   0.472175    0.274033    167.131100 
[37m[36mINFO[0m[0m 03/18 06:15:25 | 0.529912    0.502519    0.859331    0.857199    0.442487    0.938307    0.917722    0.851072    0.866461    0.529912    0.502519    0.788613    0.787415    1600        13.498550   0.427326    0.265980    173.367555 
[37m[36mINFO[0m[0m 03/18 06:19:05 | 0.537469    0.568010    0.855776    0.844057    0.457002    0.925125    0.889241    0.846579    0.857216    0.537469    0.568010    0.795624    0.785714    1800        15.185869   0.400579    0.245997    170.665423 
[37m[36mINFO[0m[0m 03/18 06:22:44 | 0.500315    0.507557    0.869095    0.859428    0.400171    0.925916    0.907173    0.863012    0.875193    0.500315    0.507557    0.818356    0.795918    2000        16.873187   0.381732    0.270699    164.972808 
[37m[36mINFO[0m[0m 03/18 06:26:22 | 0.512909    0.545340    0.875551    0.858785    0.404073    0.939626    0.907173    0.864424    0.866461    0.512909    0.545340    0.822605    0.802721    2200        18.560506   0.373067    0.250387    167.374847 
[37m[36mINFO[0m[0m 03/18 06:30:05 | 0.494332    0.496222    0.886828    0.861341    0.418952    0.947008    0.924051    0.873026    0.862352    0.494332    0.496222    0.840450    0.797619    2400        20.247825   0.348757    0.273590    168.408977 
[37m[36mINFO[0m[0m 03/18 06:33:45 | 0.503463    0.510076    0.891218    0.872303    0.383495    0.950435    0.927215    0.880858    0.881870    0.503463    0.510076    0.842362    0.807823    2600        21.935144   0.328554    0.275103    164.701379 
[37m[36mINFO[0m[0m 03/18 06:37:19 | 0.511020    0.502519    0.878523    0.858531    0.400469    0.939098    0.890295    0.865580    0.885978    0.511020    0.502519    0.830890    0.799320    2800        23.622462   0.309943    0.249780    164.693046 
[37m[36mINFO[0m[0m 03/18 06:41:01 | 0.532746    0.535264    0.885487    0.875886    0.360399    0.947008    0.922996    0.868789    0.882383    0.532746    0.535264    0.840663    0.822279    3000        25.309781   0.305770    0.271705    167.382426 
[37m[36mINFO[0m[0m 03/18 06:44:42 | 0.502834    0.521411    0.893767    0.886968    0.341279    0.953599    0.932489    0.889588    0.899332    0.502834    0.521411    0.838113    0.829082    3200        26.997100   0.293306    0.276302    166.124360 
[37m[36mINFO[0m[0m 03/18 06:48:19 | 0.520151    0.510076    0.908779    0.884093    0.343396    0.963090    0.934599    0.893054    0.896251    0.520151    0.510076    0.870193    0.821429    3400        28.684419   0.297733    0.237488    168.678086 
[37m[36mINFO[0m[0m 03/18 06:52:02 | 0.520781    0.527708    0.904435    0.892447    0.322363    0.954917    0.930380    0.890743    0.900873    0.520781    0.527708    0.867644    0.846088    3600        30.371737   0.267077    0.280790    167.166654 
[37m[36mINFO[0m[0m 03/18 06:55:47 | 0.534950    0.522670    0.897845    0.869745    0.387374    0.955972    0.918776    0.878418    0.869029    0.534950    0.522670    0.859146    0.821429    3800        32.059056   0.263558    0.267049    171.718115 
[37m[36mINFO[0m[0m 03/18 06:59:21 | 0.522040    0.540302    0.908135    0.888373    0.329338    0.960981    0.916667    0.894081    0.894710    0.522040    0.540302    0.869344    0.853741    4000        33.746375   0.260338    0.248524    164.544873 
[37m[36mINFO[0m[0m 03/18 07:03:00 | 0.517003    0.525189    0.910401    0.883968    0.353235    0.960190    0.939873    0.903582    0.890601    0.517003    0.525189    0.867431    0.821429    4200        35.433694   0.246016    0.272448    164.630023 
[37m[36mINFO[0m[0m 03/18 07:06:42 | 0.512594    0.515113    0.918600    0.892135    0.336447    0.972054    0.948312    0.901656    0.902414    0.512594    0.515113    0.882091    0.825680    4400        37.121012   0.236128    0.245886    172.302300 
[37m[36mINFO[0m[0m 03/18 07:10:22 | 0.527078    0.549118    0.919222    0.895216    0.320252    0.959399    0.939873    0.911927    0.901387    0.527078    0.549118    0.886339    0.844388    4600        38.808331   0.225226    0.272073    165.721632 
[37m[36mINFO[0m[0m 03/18 07:13:59 | 0.544081    0.531486    0.931347    0.904582    0.324573    0.974690    0.948312    0.918988    0.916795    0.544081    0.531486    0.900361    0.848639    4800        40.495650   0.220537    0.272694    162.566008 
[37m[36mINFO[0m[0m 03/18 07:17:34 | 0.518262    0.521411    0.917690    0.895821    0.323966    0.964935    0.938819    0.909231    0.898305    0.518262    0.521411    0.878904    0.850340    5000        42.182969   0.219523    0.242906    166.638224 
[37m[36mINFO[0m[0m 03/18 07:17:34 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[2]/250318_05-43-17_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 07:17:36 | ---
[37m[36mINFO[0m[0m 03/18 07:17:36 | test-domain validation(oracle) = 53.747%
[37m[36mINFO[0m[0m 03/18 07:17:36 | training-domain validation(iid) = 54.408%
[37m[36mINFO[0m[0m 03/18 07:17:36 | last = 51.826%
[37m[36mINFO[0m[0m 03/18 07:17:36 | last (inD) = 89.582%
[37m[36mINFO[0m[0m 03/18 07:17:36 | training-domain validation (iid, inD) = 90.458%
[37m[36mINFO[0m[0m 03/18 07:17:36 | === Summary ===
[37m[36mINFO[0m[0m 03/18 07:17:36 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 2 --dataset TerraIncognita
[37m[36mINFO[0m[0m 03/18 07:17:36 | Unique name: 250318_05-43-17_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 07:17:36 | Out path: train_output/TerraIncognita/ERM/[2]/250318_05-43-17_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 07:17:36 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 07:17:36 | Dataset: TerraIncognita

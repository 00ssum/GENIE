[37m[36mINFO[0m[0m 03/04 18:58:24 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_GENIE
	out_dir: train_output/TerraIncognita/ERM/[1]/250304_18-58-24_clip_vitb16_GENIE
	out_root: train_output/TerraIncognita/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250304_18-58-24_clip_vitb16_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: clip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/04 18:58:24 | n_steps = 5001
[37m[36mINFO[0m[0m 03/04 18:58:24 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/04 18:58:24 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/04 18:58:24 | 
[37m[36mINFO[0m[0m 03/04 18:58:24 | Testenv name escaping te_L38 -> te_L38
[37m[36mINFO[0m[0m 03/04 18:58:24 | Test envs = [1], name = te_L38
[37m[36mINFO[0m[0m 03/04 18:58:24 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/04 18:58:24 | Batch sizes for each domain: [32, 0, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/04 18:58:24 | steps-per-epoch for each domain: 118.53, 99.25, 147.09 -> min = 99.25
[37m[36mINFO[0m[0m 03/04 18:58:27 | # of params = 86197770
[37m[36mINFO[0m[0m 03/04 19:01:15 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/04 19:01:15 | 0.051098    0.052902    0.249781    0.257087    2.265566    0.511732    0.520042    0.051098    0.052902    0.053841    0.037783    0.183769    0.213435    0           0.000000    2.261928    1.342868    166.043595 
[37m[36mINFO[0m[0m 03/04 19:05:21 | 0.433047    0.462250    0.352459    0.345285    1.634272    0.339309    0.284810    0.433047    0.462250    0.334383    0.351385    0.383684    0.399660    200         2.015113    1.665580    0.431128    160.258539 
[37m[36mINFO[0m[0m 03/04 19:09:25 | 0.019258    0.023112    0.362893    0.357883    1.548085    0.520169    0.520042    0.019258    0.023112    0.254723    0.230479    0.313788    0.323129    400         4.030227    1.609105    0.429522    157.898790 
[37m[36mINFO[0m[0m 03/04 19:13:36 | 0.024008    0.026194    0.369156    0.388059    1.527726    0.534669    0.545359    0.024008    0.026194    0.251574    0.284635    0.321224    0.334184    600         6.045340    1.589316    0.429204    165.136597 
[37m[36mINFO[0m[0m 03/04 19:17:42 | 0.416870    0.440164    0.433088    0.453340    1.413087    0.574216    0.609705    0.416870    0.440164    0.336902    0.375315    0.388145    0.375000    800         8.060453    1.528382    0.430396    159.617996 
[37m[36mINFO[0m[0m 03/04 19:21:50 | 0.418411    0.430406    0.475320    0.490977    1.347762    0.644608    0.657173    0.418411    0.430406    0.353904    0.377834    0.427448    0.437925    1000        10.075567   1.428762    0.432308    161.983121 
[37m[36mINFO[0m[0m 03/04 19:25:57 | 0.106432    0.112994    0.506860    0.517345    1.278417    0.682573    0.688819    0.106432    0.112994    0.394836    0.390428    0.443170    0.472789    1200        12.090680   1.323974    0.430286    161.138289 
[37m[36mINFO[0m[0m 03/04 19:30:07 | 0.384773    0.411916    0.530309    0.545635    1.217924    0.697601    0.696203    0.384773    0.411916    0.449307    0.482368    0.444020    0.458333    1400        14.105793   1.258224    0.429957    163.966012 
[37m[36mINFO[0m[0m 03/04 19:34:18 | 0.406086    0.429379    0.563661    0.576736    1.145234    0.722911    0.723629    0.406086    0.429379    0.496222    0.517632    0.471850    0.488946    1600        16.120907   1.205740    0.429377    164.668071 
[37m[36mINFO[0m[0m 03/04 19:38:29 | 0.405058    0.441192    0.577678    0.587841    1.095472    0.715529    0.710970    0.405058    0.441192    0.528023    0.546599    0.489484    0.505952    1800        18.136020   1.157725    0.431877    164.978631 
[37m[36mINFO[0m[0m 03/04 19:42:42 | 0.174990    0.196199    0.583175    0.601443    1.082997    0.729765    0.748945    0.174990    0.196199    0.534950    0.557935    0.484810    0.497449    2000        20.151134   1.103327    0.434569    165.544861 
[37m[36mINFO[0m[0m 03/04 19:46:53 | 0.323276    0.343092    0.637489    0.637466    0.958015    0.805958    0.801688    0.323276    0.343092    0.573048    0.586902    0.533461    0.523810    2200        22.166247   1.024028    0.430216    164.897480 
[37m[36mINFO[0m[0m 03/04 19:51:01 | 0.288355    0.318952    0.695080    0.706127    0.820304    0.812813    0.812236    0.288355    0.318952    0.661209    0.664987    0.611217    0.641156    2400        24.181360   0.907867    0.430310    162.152685 
[37m[36mINFO[0m[0m 03/04 19:55:07 | 0.241623    0.255265    0.731072    0.714881    0.737293    0.844187    0.833333    0.241623    0.255265    0.686398    0.659950    0.662630    0.651361    2600        26.196474   0.797728    0.429526    160.022287 
[37m[36mINFO[0m[0m 03/04 19:59:10 | 0.359866    0.386235    0.759214    0.752616    0.667896    0.867915    0.852321    0.359866    0.386235    0.709068    0.706549    0.700659    0.698980    2800        28.211587   0.707635    0.435421    156.439177 
[37m[36mINFO[0m[0m 03/04 20:03:13 | 0.258056    0.279918    0.781916    0.786283    0.577313    0.882942    0.882911    0.258056    0.279918    0.746851    0.753149    0.715955    0.722789    3000        30.226700   0.631719    0.430576    157.084625 
[37m[36mINFO[0m[0m 03/04 20:07:19 | 0.255617    0.276836    0.782252    0.772569    0.619049    0.884788    0.879747    0.255617    0.276836    0.754723    0.730479    0.707245    0.707483    3200        32.241814   0.601194    0.430324    159.402761 
[37m[36mINFO[0m[0m 03/04 20:11:23 | 0.320580    0.343092    0.803963    0.775125    0.592898    0.892170    0.872363    0.320580    0.343092    0.784005    0.750630    0.735713    0.702381    3400        34.256927   0.556416    0.429280    158.025524 
[37m[36mINFO[0m[0m 03/04 20:15:24 | 0.272307    0.305598    0.804152    0.787696    0.568138    0.894543    0.890295    0.272307    0.305598    0.775189    0.732997    0.742724    0.739796    3600        36.272040   0.509271    0.429464    155.354384 
[37m[36mINFO[0m[0m 03/04 20:19:38 | 0.272821    0.309194    0.825582    0.809444    0.504108    0.905088    0.888186    0.272821    0.309194    0.801952    0.785894    0.769705    0.754252    3800        38.287154   0.483700    0.437198    166.923209 
[37m[36mINFO[0m[0m 03/04 20:23:48 | 0.203620    0.228043    0.842619    0.833796    0.455061    0.906407    0.909283    0.203620    0.228043    0.830290    0.812343    0.791162    0.779762    4000        40.302267   0.448410    0.432057    163.459906 
[37m[36mINFO[0m[0m 03/04 20:27:54 | 0.298626    0.316384    0.849207    0.832189    0.468083    0.921171    0.909283    0.298626    0.316384    0.838476    0.823678    0.787975    0.763605    4200        42.317380   0.413901    0.441386    157.235302 
[37m[36mINFO[0m[0m 03/04 20:31:59 | 0.177815    0.213662    0.856601    0.835428    0.453885    0.924862    0.920886    0.177815    0.213662    0.837846    0.804786    0.807096    0.780612    4400        44.332494   0.396043    0.436834    157.621836 
[37m[36mINFO[0m[0m 03/04 20:36:09 | 0.352420    0.386235    0.874623    0.857749    0.409186    0.937780    0.924051    0.352420    0.386235    0.861146    0.836272    0.824942    0.812925    4600        46.347607   0.371445    0.436739    163.085651 
[37m[36mINFO[0m[0m 03/04 20:40:23 | 0.272050    0.299949    0.860190    0.836146    0.447982    0.927762    0.909283    0.272050    0.299949    0.854849    0.826196    0.797960    0.772959    4800        48.362720   0.346245    0.441066    165.706785 
[37m[36mINFO[0m[0m 03/04 20:44:33 | 0.247143    0.274782    0.878050    0.851818    0.412567    0.936462    0.913502    0.247143    0.274782    0.868073    0.837531    0.829615    0.804422    5000        50.377834   0.319092    0.435753    162.718210 
[37m[36mINFO[0m[0m 03/04 20:44:33 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[1]/250304_18-58-24_clip_vitb16_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/04 20:44:35 | ---
[37m[36mINFO[0m[0m 03/04 20:44:35 | test-domain validation(oracle) = 43.305%
[37m[36mINFO[0m[0m 03/04 20:44:35 | training-domain validation(iid) = 35.242%
[37m[36mINFO[0m[0m 03/04 20:44:35 | last = 24.714%
[37m[36mINFO[0m[0m 03/04 20:44:35 | last (inD) = 85.182%
[37m[36mINFO[0m[0m 03/04 20:44:35 | training-domain validation (iid, inD) = 85.775%
[37m[36mINFO[0m[0m 03/04 20:44:35 | === Summary ===
[37m[36mINFO[0m[0m 03/04 20:44:35 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_GENIE config/clip_vitb16_GENIE.yaml --algorithm ERM --test_envs 1 --dataset TerraIncognita
[37m[36mINFO[0m[0m 03/04 20:44:35 | Unique name: 250304_18-58-24_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/04 20:44:35 | Out path: train_output/TerraIncognita/ERM/[1]/250304_18-58-24_clip_vitb16_GENIE
[37m[36mINFO[0m[0m 03/04 20:44:35 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/04 20:44:35 | Dataset: TerraIncognita

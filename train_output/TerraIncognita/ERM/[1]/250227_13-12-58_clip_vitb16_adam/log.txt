[37m[36mINFO[0m[0m 02/27 13:12:58 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_adam config/clip_vitb16_adam.yaml --algorithm ERM --test_envs 1 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_adam.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_adam
	out_dir: train_output/TerraIncognita/ERM/[1]/250227_13-12-58_clip_vitb16_adam
	out_root: train_output/TerraIncognita/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250227_13-12-58_clip_vitb16_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: clip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/27 13:12:58 | n_steps = 5001
[37m[36mINFO[0m[0m 02/27 13:12:58 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/27 13:12:58 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/27 13:12:58 | 
[37m[36mINFO[0m[0m 02/27 13:12:58 | Testenv name escaping te_L38 -> te_L38
[37m[36mINFO[0m[0m 02/27 13:12:58 | Test envs = [1], name = te_L38
[37m[36mINFO[0m[0m 02/27 13:12:58 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 02/27 13:12:58 | Batch sizes for each domain: [32, 0, 32, 32] (total=96)
[37m[36mINFO[0m[0m 02/27 13:12:58 | steps-per-epoch for each domain: 118.53, 99.25, 147.09 -> min = 99.25
[37m[36mINFO[0m[0m 02/27 13:13:01 | # of params = 86197770
[37m[36mINFO[0m[0m 02/27 13:15:59 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/27 13:15:59 | 0.019258    0.023112    0.293946    0.289972    1.998704    0.522278    0.520042    0.019258    0.023112    0.123741    0.103275    0.235819    0.246599    0           0.000000    2.261928    1.530807    175.819735 
[37m[36mINFO[0m[0m 02/27 13:20:17 | 0.154962    0.167951    0.685584    0.690637    0.872701    0.808067    0.789030    0.154962    0.167951    0.613035    0.622166    0.635649    0.660714    200         2.015113    1.200712    0.411506    175.838869 
[37m[36mINFO[0m[0m 02/27 13:24:36 | 0.315573    0.321520    0.772359    0.781712    0.626629    0.877142    0.877637    0.315573    0.321520    0.732053    0.748111    0.707882    0.719388    400         4.030227    0.737429    0.407012    177.726544 
[37m[36mINFO[0m[0m 02/27 13:28:55 | 0.420722    0.438624    0.778357    0.778009    0.625360    0.846032    0.841772    0.420722    0.438624    0.747166    0.740554    0.741874    0.751701    600         6.045340    0.620450    0.407143    177.920267 
[37m[36mINFO[0m[0m 02/27 13:33:05 | 0.217615    0.225475    0.823854    0.818335    0.506535    0.913789    0.892405    0.217615    0.225475    0.790617    0.792191    0.767155    0.770408    800         8.060453    0.539421    0.408988    168.347282 
[37m[36mINFO[0m[0m 02/27 13:37:25 | 0.144563    0.154083    0.827706    0.811403    0.519427    0.910361    0.897679    0.144563    0.154083    0.798804    0.769521    0.773954    0.767007    1000        10.075567   0.484503    0.411491    177.678760 
[37m[36mINFO[0m[0m 02/27 13:41:50 | 0.101040    0.110426    0.848367    0.827305    0.488022    0.919852    0.897679    0.101040    0.110426    0.823678    0.795970    0.801572    0.788265    1200        12.090680   0.447525    0.407676    183.585054 
[37m[36mINFO[0m[0m 02/27 13:46:06 | 0.322378    0.338983    0.868570    0.852632    0.421384    0.942262    0.933544    0.322378    0.338983    0.835957    0.817380    0.827491    0.806973    1400        14.105793   0.410128    0.409356    173.947483 
[37m[36mINFO[0m[0m 02/27 13:50:34 | 0.377327    0.392912    0.875344    0.841044    0.405954    0.935671    0.899789    0.377327    0.392912    0.859257    0.829975    0.831103    0.793367    1600        16.120907   0.372618    0.407918    186.386814 
[37m[36mINFO[0m[0m 02/27 13:55:09 | 0.344075    0.363636    0.881583    0.854510    0.416140    0.940944    0.920886    0.344075    0.363636    0.871851    0.850126    0.831952    0.792517    1800        18.136020   0.341932    0.407055    193.755403 
[37m[36mINFO[0m[0m 02/27 13:59:30 | 0.336243    0.365177    0.882785    0.862284    0.411474    0.948062    0.919831    0.336243    0.365177    0.863665    0.838791    0.836626    0.828231    2000        20.151134   0.317372    0.411904    178.572534 
[37m[36mINFO[0m[0m 02/27 14:03:45 | 0.251123    0.271186    0.887625    0.851535    0.413073    0.949644    0.928270    0.251123    0.271186    0.874055    0.828715    0.839176    0.797619    2200        22.166247   0.321081    0.408538    172.479332 
[37m[36mINFO[0m[0m 02/27 14:08:01 | 0.353062    0.381613    0.891261    0.858460    0.401219    0.944108    0.908228    0.353062    0.381613    0.875630    0.828715    0.854047    0.838435    2400        24.181360   0.287696    0.405806    174.818278 
[37m[36mINFO[0m[0m 02/27 14:12:24 | 0.240852    0.269646    0.887203    0.858563    0.388876    0.950962    0.929325    0.240852    0.269646    0.868073    0.824937    0.842575    0.821429    2600        26.196474   0.289039    0.411049    181.170196 
[37m[36mINFO[0m[0m 02/27 14:16:37 | 0.220311    0.243965    0.894486    0.850552    0.412275    0.950435    0.922996    0.220311    0.243965    0.880038    0.846348    0.852985    0.782313    2800        28.211587   0.275361    0.410081    171.329508 
[37m[36mINFO[0m[0m 02/27 14:20:53 | 0.251123    0.267078    0.913139    0.878628    0.352403    0.965990    0.938819    0.251123    0.267078    0.903023    0.850126    0.870406    0.846939    3000        30.226700   0.248990    0.408985    174.329860 
[37m[36mINFO[0m[0m 02/27 14:25:08 | 0.366157    0.400616    0.915633    0.878459    0.345804    0.963881    0.932489    0.366157    0.400616    0.900504    0.860202    0.882515    0.842687    3200        32.241814   0.243351    0.407155    173.205451 
[37m[36mINFO[0m[0m 02/27 14:29:26 | 0.371550    0.400103    0.912199    0.876134    0.371947    0.958872    0.927215    0.371550    0.400103    0.907746    0.860202    0.869981    0.840986    3400        34.256927   0.241472    0.409482    175.841692 
[37m[36mINFO[0m[0m 02/27 14:33:47 | 0.325331    0.338469    0.923200    0.890508    0.307634    0.965990    0.949367    0.325331    0.338469    0.919395    0.882872    0.884215    0.839286    3600        36.272040   0.233374    0.409643    179.385668 
[37m[36mINFO[0m[0m 02/27 14:38:07 | 0.276287    0.305085    0.918205    0.880939    0.340451    0.963617    0.937764    0.276287    0.305085    0.917191    0.890428    0.873805    0.814626    3800        38.287154   0.224002    0.408453    177.770481 
[37m[36mINFO[0m[0m 02/27 14:42:17 | 0.326358    0.340010    0.912377    0.877534    0.356462    0.949117    0.917722    0.326358    0.340010    0.917821    0.886650    0.870193    0.828231    4000        40.302267   0.215425    0.408372    168.387313 
[37m[36mINFO[0m[0m 02/27 14:46:35 | 0.293619    0.319979    0.922681    0.885471    0.344535    0.956762    0.928270    0.293619    0.319979    0.917506    0.880353    0.893775    0.847789    4200        42.317380   0.211707    0.408097    176.306524 
[37m[36mINFO[0m[0m 02/27 14:50:40 | 0.161895    0.192090    0.926858    0.890088    0.341437    0.962563    0.936709    0.161895    0.192090    0.923174    0.889169    0.894837    0.844388    4400        44.332494   0.208550    0.408846    163.595028 
[37m[36mINFO[0m[0m 02/27 14:54:47 | 0.252150    0.280431    0.931242    0.890634    0.325969    0.969417    0.940928    0.252150    0.280431    0.929471    0.891688    0.894837    0.839286    4600        46.347607   0.192441    0.403056    166.304244 
[37m[36mINFO[0m[0m 02/27 14:59:02 | 0.297342    0.319466    0.927216    0.889317    0.321532    0.968626    0.935654    0.297342    0.319466    0.922859    0.887909    0.890164    0.844388    4800        48.362720   0.204454    0.404226    174.115339 
[37m[36mINFO[0m[0m 02/27 15:03:16 | 0.194505    0.200308    0.930854    0.891391    0.330885    0.965199    0.928270    0.194505    0.200308    0.931675    0.887909    0.895687    0.857993    5000        50.377834   0.195405    0.406818    172.800455 
[37m[36mINFO[0m[0m 02/27 15:03:16 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[1]/250227_13-12-58_clip_vitb16_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/27 15:03:21 | ---
[37m[36mINFO[0m[0m 02/27 15:03:21 | test-domain validation(oracle) = 42.072%
[37m[36mINFO[0m[0m 02/27 15:03:21 | training-domain validation(iid) = 19.451%
[37m[36mINFO[0m[0m 02/27 15:03:21 | last = 19.451%
[37m[36mINFO[0m[0m 02/27 15:03:21 | last (inD) = 89.139%
[37m[36mINFO[0m[0m 02/27 15:03:21 | training-domain validation (iid, inD) = 89.139%
[37m[36mINFO[0m[0m 02/27 15:03:21 | === Summary ===
[37m[36mINFO[0m[0m 02/27 15:03:21 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_adam config/clip_vitb16_adam.yaml --algorithm ERM --test_envs 1 --dataset TerraIncognita
[37m[36mINFO[0m[0m 02/27 15:03:21 | Unique name: 250227_13-12-58_clip_vitb16_adam
[37m[36mINFO[0m[0m 02/27 15:03:21 | Out path: train_output/TerraIncognita/ERM/[1]/250227_13-12-58_clip_vitb16_adam
[37m[36mINFO[0m[0m 02/27 15:03:21 | Algorithm: ERM
[37m[36mINFO[0m[0m 02/27 15:03:21 | Dataset: TerraIncognita

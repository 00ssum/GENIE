[37m[36mINFO[0m[0m 03/18 05:46:13 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --trial_seed 2 --hparams_seed 14 --algorithm ERM --test_envs 1 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 14
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[1]/250318_05-46-13_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 2
	unique_name: 250318_05-46-13_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 4.223376545632674e-05
	batch_size: 27
	weight_decay: 1.4009530778122364e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/18 05:46:13 | n_steps = 5001
[37m[36mINFO[0m[0m 03/18 05:46:13 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/18 05:46:13 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/18 05:46:13 | 
[37m[36mINFO[0m[0m 03/18 05:46:13 | Testenv name escaping te_L38 -> te_L38
[37m[36mINFO[0m[0m 03/18 05:46:13 | Test envs = [1], name = te_L38
[37m[36mINFO[0m[0m 03/18 05:46:13 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/18 05:46:13 | Batch sizes for each domain: [27, 0, 27, 27] (total=81)
[37m[36mINFO[0m[0m 03/18 05:46:13 | steps-per-epoch for each domain: 140.48, 117.63, 174.33 -> min = 117.63
[37m[36mINFO[0m[0m 03/18 05:46:14 | # of params = 23528522
[37m[36mINFO[0m[0m 03/18 05:48:55 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/18 05:48:55 | 0.021184    0.015408    0.284322    0.291525    2.040978    0.518587    0.534810    0.021184    0.015408    0.097922    0.095718    0.236456    0.244048    0           0.000000    2.439070    0.987159    160.157628 
[37m[36mINFO[0m[0m 03/18 05:52:18 | 0.172936    0.169492    0.505289    0.519333    1.281918    0.656472    0.681435    0.172936    0.169492    0.418136    0.410579    0.441258    0.465986    200         1.700252    1.488916    0.201139    163.129277 
[37m[36mINFO[0m[0m 03/18 05:55:39 | 0.094107    0.077555    0.655499    0.664251    0.941863    0.800685    0.809072    0.094107    0.077555    0.605793    0.599496    0.560017    0.584184    400         3.400504    1.163232    0.204435    159.571150 
[37m[36mINFO[0m[0m 03/18 05:59:06 | 0.242008    0.225475    0.673820    0.650491    0.906825    0.768785    0.752110    0.242008    0.225475    0.660579    0.603275    0.592097    0.596088    600         5.100756    0.903269    0.206652    166.204320 
[37m[36mINFO[0m[0m 03/18 06:02:26 | 0.181153    0.182845    0.760947    0.767363    0.652574    0.875824    0.860759    0.181153    0.182845    0.704660    0.732997    0.702358    0.708333    800         6.801008    0.718814    0.203222    158.912261 
[37m[36mINFO[0m[0m 03/18 06:05:44 | 0.196688    0.193118    0.770168    0.777704    0.625130    0.877933    0.862869    0.196688    0.193118    0.717254    0.732997    0.715318    0.737245    1000        8.501259    0.644343    0.203149    157.931798 
[37m[36mINFO[0m[0m 03/18 06:09:04 | 0.285402    0.272727    0.807492    0.812228    0.532813    0.892961    0.877637    0.285402    0.272727    0.764484    0.770781    0.765031    0.788265    1200        10.201511   0.598404    0.203480    159.315251 
[37m[36mINFO[0m[0m 03/18 06:12:29 | 0.334703    0.313816    0.815818    0.811682    0.530364    0.905088    0.879747    0.334703    0.313816    0.773300    0.764484    0.769067    0.790816    1400        11.901763   0.533828    0.207438    163.222774 
[37m[36mINFO[0m[0m 03/18 06:15:54 | 0.261908    0.249101    0.838756    0.814934    0.501691    0.910625    0.879747    0.261908    0.249101    0.828715    0.799748    0.776928    0.765306    1600        13.602015   0.501598    0.201855    164.636758 
[37m[36mINFO[0m[0m 03/18 06:19:17 | 0.182437    0.164869    0.825658    0.815874    0.511734    0.882415    0.876582    0.182437    0.164869    0.814232    0.797229    0.780327    0.773810    1800        15.302267   0.470720    0.204086    161.599559 
[37m[36mINFO[0m[0m 03/18 06:22:35 | 0.421620    0.405752    0.840300    0.819982    0.514554    0.925653    0.892405    0.421620    0.405752    0.827456    0.804786    0.767793    0.762755    2000        17.002519   0.435482    0.206270    156.695694 
[37m[36mINFO[0m[0m 03/18 06:25:55 | 0.425343    0.412429    0.867391    0.836526    0.435298    0.931453    0.890295    0.425343    0.412429    0.858312    0.814861    0.812407    0.804422    2200        18.702771   0.425146    0.207218    159.158147 
[37m[36mINFO[0m[0m 03/18 06:29:13 | 0.342920    0.327684    0.863720    0.841905    0.449361    0.928289    0.899789    0.342920    0.327684    0.848552    0.827456    0.814319    0.798469    2400        20.403023   0.400098    0.209177    155.982723 
[37m[36mINFO[0m[0m 03/18 06:32:35 | 0.352163    0.329224    0.874059    0.855084    0.429773    0.938835    0.898734    0.352163    0.329224    0.859887    0.845088    0.823454    0.821429    2600        22.103275   0.367053    0.206099    161.108168 
[37m[36mINFO[0m[0m 03/18 06:35:52 | 0.352548    0.340524    0.869992    0.838331    0.463244    0.926180    0.886076    0.352548    0.340524    0.857368    0.826196    0.826429    0.802721    2800        23.803526   0.360908    0.204382    155.415397 
[37m[36mINFO[0m[0m 03/18 06:39:15 | 0.320965    0.303544    0.878484    0.850842    0.440349    0.944108    0.913502    0.320965    0.303544    0.865554    0.833753    0.825791    0.805272    3000        25.503778   0.361170    0.205495    162.273148 
[37m[36mINFO[0m[0m 03/18 06:42:35 | 0.354346    0.347714    0.886081    0.859687    0.396896    0.948590    0.910338    0.354346    0.347714    0.880038    0.838791    0.829615    0.829932    3200        27.204030   0.331107    0.203519    159.545010 
[37m[36mINFO[0m[0m 03/18 06:45:53 | 0.395044    0.386235    0.880238    0.850616    0.440569    0.944108    0.918776    0.395044    0.386235    0.860831    0.833753    0.835777    0.799320    3400        28.904282   0.325262    0.203539    156.577183 
[37m[36mINFO[0m[0m 03/18 06:49:11 | 0.354859    0.333333    0.886211    0.866210    0.403158    0.941207    0.909283    0.354859    0.333333    0.878463    0.855164    0.838963    0.834184    3600        30.604534   0.306606    0.202961    157.719168 
[37m[36mINFO[0m[0m 03/18 06:52:36 | 0.321607    0.312275    0.896135    0.865180    0.405240    0.947799    0.917722    0.321607    0.312275    0.894207    0.858942    0.846399    0.818878    3800        32.304786   0.311998    0.207576    163.357536 
[37m[36mINFO[0m[0m 03/18 06:56:01 | 0.339196    0.324088    0.888850    0.855833    0.408960    0.953599    0.922996    0.339196    0.324088    0.879723    0.837531    0.833227    0.806973    4000        34.005038   0.284846    0.202862    165.176527 
[37m[36mINFO[0m[0m 03/18 06:59:22 | 0.385159    0.373909    0.897110    0.878040    0.371042    0.953335    0.917722    0.385159    0.373909    0.881612    0.867758    0.856384    0.848639    4200        35.705290   0.281233    0.206331    158.872151 
[37m[36mINFO[0m[0m 03/18 07:02:46 | 0.378097    0.363123    0.909540    0.883691    0.361245    0.964144    0.941983    0.378097    0.363123    0.905542    0.874055    0.858934    0.835034    4400        37.405542   0.258003    0.211442    161.751436 
[37m[36mINFO[0m[0m 03/18 07:06:11 | 0.396328    0.377504    0.917947    0.887580    0.333292    0.957817    0.924051    0.396328    0.377504    0.914358    0.886650    0.881666    0.852041    4600        39.105793   0.256145    0.208593    163.471473 
[37m[36mINFO[0m[0m 03/18 07:09:29 | 0.347028    0.341037    0.904854    0.874251    0.374149    0.954917    0.913502    0.347028    0.341037    0.892003    0.861461    0.867644    0.847789    4800        40.806045   0.248272    0.210054    156.353533 
[37m[36mINFO[0m[0m 03/18 07:12:43 | 0.312364    0.289676    0.907111    0.878643    0.404781    0.965463    0.929325    0.312364    0.289676    0.896725    0.869018    0.859146    0.837585    5000        42.506297   0.251905    0.202352    153.337116 
[37m[36mINFO[0m[0m 03/18 07:12:43 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[1]/250318_05-46-13_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/18 07:12:45 | ---
[37m[36mINFO[0m[0m 03/18 07:12:45 | test-domain validation(oracle) = 42.534%
[37m[36mINFO[0m[0m 03/18 07:12:45 | training-domain validation(iid) = 39.633%
[37m[36mINFO[0m[0m 03/18 07:12:45 | last = 31.236%
[37m[36mINFO[0m[0m 03/18 07:12:45 | last (inD) = 87.864%
[37m[36mINFO[0m[0m 03/18 07:12:45 | training-domain validation (iid, inD) = 88.758%
[37m[36mINFO[0m[0m 03/18 07:12:45 | === Summary ===
[37m[36mINFO[0m[0m 03/18 07:12:45 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --trial_seed 2 --hparams_seed 14 --algorithm ERM --test_envs 1 --dataset TerraIncognita
[37m[36mINFO[0m[0m 03/18 07:12:45 | Unique name: 250318_05-46-13_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 07:12:45 | Out path: train_output/TerraIncognita/ERM/[1]/250318_05-46-13_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/18 07:12:45 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/18 07:12:45 | Dataset: TerraIncognita

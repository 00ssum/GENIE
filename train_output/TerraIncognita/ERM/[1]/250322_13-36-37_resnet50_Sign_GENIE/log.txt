[37m[36mINFO[0m[0m 03/22 13:36:37 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset TerraIncognita --trial_seed 0 --hparams_seed 2
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 2
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[1]/250322_13-36-37_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250322_13-36-37_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 1.9041073434446342e-05
	batch_size: 9
	weight_decay: 0.0006566989842279891
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/22 13:36:37 | n_steps = 5001
[37m[36mINFO[0m[0m 03/22 13:36:37 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/22 13:36:37 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/22 13:36:37 | 
[37m[36mINFO[0m[0m 03/22 13:36:37 | Testenv name escaping te_L38 -> te_L38
[37m[36mINFO[0m[0m 03/22 13:36:37 | Test envs = [1], name = te_L38
[37m[36mINFO[0m[0m 03/22 13:36:37 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/22 13:36:37 | Batch sizes for each domain: [9, 0, 9, 9] (total=27)
[37m[36mINFO[0m[0m 03/22 13:36:37 | steps-per-epoch for each domain: 421.44, 352.89, 523.00 -> min = 352.89
[37m[36mINFO[0m[0m 03/22 13:36:38 | # of params = 23528522
[37m[36mINFO[0m[0m 03/22 13:39:20 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/22 13:39:20 | 0.019258    0.023112    0.284710    0.289972    2.340494    0.522278    0.520042    0.019258    0.023112    0.096033    0.103275    0.235819    0.246599    0           0.000000    2.335099    0.905351    160.173383 
[37m[36mINFO[0m[0m 03/22 13:42:25 | 0.223264    0.237802    0.480781    0.498072    1.379361    0.620090    0.638186    0.223264    0.237802    0.397355    0.420655    0.424899    0.435374    200         0.566751    1.560685    0.131275    159.003737 
[37m[36mINFO[0m[0m 03/22 13:45:30 | 0.136603    0.151002    0.526812    0.536250    1.241759    0.641708    0.624473    0.136603    0.151002    0.489610    0.532746    0.449118    0.451531    400         1.133501    1.299006    0.147084    156.123537 
[37m[36mINFO[0m[0m 03/22 13:48:44 | 0.129927    0.131484    0.620297    0.610403    1.029869    0.752966    0.709916    0.129927    0.131484    0.570214    0.590680    0.537710    0.530612    600         1.700252    1.202344    0.134673    166.684817 
[37m[36mINFO[0m[0m 03/22 13:51:53 | 0.126204    0.131998    0.625201    0.627647    1.075323    0.743211    0.690928    0.126204    0.131998    0.602330    0.646096    0.530062    0.545918    800         2.267003    1.037559    0.142470    160.674712 
[37m[36mINFO[0m[0m 03/22 13:55:00 | 0.236359    0.246020    0.689649    0.672716    0.824303    0.783285    0.751055    0.236359    0.246020    0.664673    0.659950    0.620990    0.607143    1000        2.833753    0.851142    0.123979    162.220928 
[37m[36mINFO[0m[0m 03/22 13:58:09 | 0.305944    0.325629    0.698674    0.680787    0.831636    0.847350    0.848101    0.305944    0.325629    0.640428    0.603275    0.608243    0.590986    1200        3.400504    0.816120    0.137262    161.087008 
[37m[36mINFO[0m[0m 03/22 14:01:17 | 0.328797    0.348742    0.738973    0.734261    0.747820    0.862378    0.855485    0.328797    0.348742    0.696159    0.705290    0.658381    0.642007    1400        3.967254    0.733781    0.123720    163.353626 
[37m[36mINFO[0m[0m 03/22 14:04:29 | 0.355501    0.366718    0.758166    0.755936    0.687441    0.866860    0.855485    0.355501    0.366718    0.723552    0.740554    0.684088    0.671769    1600        4.534005    0.706092    0.142835    163.097735 
[37m[36mINFO[0m[0m 03/22 14:07:31 | 0.341379    0.361582    0.774948    0.772286    0.618120    0.853414    0.845992    0.341379    0.361582    0.745277    0.750630    0.726153    0.720238    1800        5.100756    0.678757    0.114239    159.540291 
[37m[36mINFO[0m[0m 03/22 14:10:34 | 0.309282    0.318439    0.756038    0.764730    0.656379    0.858160    0.860759    0.309282    0.318439    0.690176    0.719144    0.719779    0.714286    2000        5.667506    0.625982    0.137510    155.756385 
[37m[36mINFO[0m[0m 03/22 14:13:43 | 0.098215    0.104777    0.719599    0.708075    0.769068    0.824150    0.806962    0.098215    0.104777    0.689861    0.659950    0.644784    0.657313    2200        6.234257    0.634007    0.115480    166.105778 
[37m[36mINFO[0m[0m 03/22 14:16:54 | 0.279240    0.283513    0.794062    0.800894    0.566834    0.877669    0.887131    0.279240    0.283513    0.767317    0.780856    0.737200    0.734694    2400        6.801008    0.622437    0.152104    160.286235 
[37m[36mINFO[0m[0m 03/22 14:20:02 | 0.363076    0.376477    0.780495    0.779624    0.597791    0.874242    0.873418    0.363076    0.376477    0.740239    0.741814    0.727002    0.723639    2600        7.367758    0.587466    0.138168    160.419539 
[37m[36mINFO[0m[0m 03/22 14:23:18 | 0.396071    0.414997    0.797529    0.792871    0.573511    0.882415    0.871308    0.396071    0.414997    0.756612    0.760705    0.753559    0.746599    2800        7.934509    0.555437    0.141354    167.557328 
[37m[36mINFO[0m[0m 03/22 14:26:32 | 0.309667    0.323575    0.815752    0.795967    0.556860    0.901134    0.888186    0.309667    0.323575    0.778967    0.755668    0.767155    0.744048    3000        8.501259    0.541455    0.149275    164.013945 
[37m[36mINFO[0m[0m 03/22 14:29:43 | 0.365387    0.384181    0.813503    0.815202    0.527543    0.898761    0.893460    0.365387    0.384181    0.780542    0.778338    0.761207    0.773810    3200        9.068010    0.520532    0.135130    163.713604 
[37m[36mINFO[0m[0m 03/22 14:32:54 | 0.336629    0.348742    0.810807    0.794740    0.589025    0.873715    0.867089    0.336629    0.348742    0.783690    0.756927    0.775016    0.760204    3400        9.634761    0.514177    0.137545    163.796679 
[37m[36mINFO[0m[0m 03/22 14:35:59 | 0.248170    0.267591    0.822840    0.821133    0.489005    0.897443    0.897679    0.248170    0.267591    0.788413    0.780856    0.782664    0.784864    3600        10.201511   0.524308    0.125426    160.155409 
[37m[36mINFO[0m[0m 03/22 14:39:09 | 0.339068    0.337956    0.829070    0.827467    0.493507    0.901925    0.892405    0.339068    0.337956    0.799433    0.811083    0.785851    0.778912    3800        10.768262   0.488319    0.152720    159.779706 
[37m[36mINFO[0m[0m 03/22 14:42:14 | 0.398896    0.404212    0.833655    0.825138    0.492615    0.902979    0.898734    0.398896    0.404212    0.803212    0.788413    0.794774    0.788265    4000        11.335013   0.513790    0.122411    159.842471 
[37m[36mINFO[0m[0m 03/22 14:45:33 | 0.256002    0.263996    0.812067    0.788956    0.589176    0.900079    0.894515    0.256002    0.263996    0.780227    0.734257    0.755895    0.738095    4200        11.901763   0.481817    0.140041    170.796076 
[37m[36mINFO[0m[0m 03/22 14:48:39 | 0.377712    0.385208    0.837367    0.831004    0.480125    0.912470    0.892405    0.377712    0.385208    0.807620    0.812343    0.792012    0.788265    4400        12.468514   0.482282    0.116057    163.032130 
[37m[36mINFO[0m[0m 03/22 14:51:58 | 0.352934    0.370313    0.836878    0.824061    0.502004    0.914579    0.895570    0.352934    0.370313    0.795970    0.793451    0.800085    0.783163    4600        13.035264   0.447570    0.133489    172.097382 
[37m[36mINFO[0m[0m 03/22 14:55:04 | 0.376557    0.393426    0.844745    0.819594    0.492896    0.919589    0.896624    0.376557    0.393426    0.813287    0.793451    0.801360    0.768707    4800        13.602015   0.441199    0.122173    162.096850 
[37m[36mINFO[0m[0m 03/22 14:58:13 | 0.177558    0.187468    0.852105    0.836935    0.463542    0.903243    0.902954    0.177558    0.187468    0.841940    0.811083    0.811132    0.796769    5000        14.168766   0.449576    0.133176    162.232293 
[37m[36mINFO[0m[0m 03/22 14:58:13 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[1]/250322_13-36-37_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/22 14:58:15 | ---
[37m[36mINFO[0m[0m 03/22 14:58:15 | test-domain validation(oracle) = 39.607%
[37m[36mINFO[0m[0m 03/22 14:58:15 | training-domain validation(iid) = 17.756%
[37m[36mINFO[0m[0m 03/22 14:58:15 | last = 17.756%
[37m[36mINFO[0m[0m 03/22 14:58:15 | last (inD) = 83.694%
[37m[36mINFO[0m[0m 03/22 14:58:15 | training-domain validation (iid, inD) = 83.694%
[37m[36mINFO[0m[0m 03/22 14:58:15 | === Summary ===
[37m[36mINFO[0m[0m 03/22 14:58:15 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 1 --dataset TerraIncognita --trial_seed 0 --hparams_seed 2
[37m[36mINFO[0m[0m 03/22 14:58:15 | Unique name: 250322_13-36-37_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/22 14:58:15 | Out path: train_output/TerraIncognita/ERM/[1]/250322_13-36-37_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/22 14:58:15 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/22 14:58:15 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 03/04 18:41:47 | Command :: /jsm0707/GENIE/train_all.py clip_vitb16_sgd config/clip_vitb16_sgd.yaml --algorithm ERM --test_envs 1 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/clip_vitb16_sgd.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: clip_vitb16_sgd
	out_dir: train_output/TerraIncognita/ERM/[1]/250304_18-41-47_clip_vitb16_sgd
	out_root: train_output/TerraIncognita/ERM/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250304_18-41-47_clip_vitb16_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: clip_vit-b16
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/04 18:41:47 | n_steps = 5001
[37m[36mINFO[0m[0m 03/04 18:41:47 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/04 18:41:47 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/04 18:41:47 | 
[37m[36mINFO[0m[0m 03/04 18:41:47 | Testenv name escaping te_L38 -> te_L38
[37m[36mINFO[0m[0m 03/04 18:41:47 | Test envs = [1], name = te_L38
[37m[36mINFO[0m[0m 03/04 18:41:47 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/04 18:41:48 | Batch sizes for each domain: [32, 0, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/04 18:41:48 | steps-per-epoch for each domain: 118.53, 99.25, 147.09 -> min = 99.25
[37m[36mINFO[0m[0m 03/04 18:41:51 | # of params = 86197770
[37m[36mINFO[0m[0m 03/04 18:44:36 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/04 18:44:36 | 0.400180    0.406780    0.151735    0.201789    2.268479    0.103876    0.151899    0.400180    0.406780    0.127834    0.181360    0.223497    0.272109    0           0.000000    2.261928    1.097027    163.875360 
[37m[36mINFO[0m[0m 03/04 18:48:38 | 0.145590    0.163842    0.372718    0.367654    1.859042    0.529660    0.522152    0.145590    0.163842    0.271096    0.264484    0.317400    0.316327    200         2.015113    2.015504    0.407133    160.962820 
[37m[36mINFO[0m[0m 03/04 18:52:40 | 0.021826    0.026708    0.417890    0.422250    1.707032    0.526496    0.518987    0.021826    0.026708    0.345403    0.375315    0.381772    0.372449    400         4.030227    1.787222    0.409502    160.315781 
[37m[36mINFO[0m[0m 03/04 18:56:48 | 0.035435    0.044171    0.451504    0.465754    1.601803    0.582916    0.612869    0.035435    0.044171    0.352645    0.370277    0.418950    0.414116    600         6.045340    1.669031    0.407818    166.092278 
[37m[36mINFO[0m[0m 03/04 19:00:53 | 0.032225    0.035439    0.459394    0.475600    1.529483    0.593462    0.612869    0.032225    0.035439    0.356423    0.387909    0.428298    0.426020    800         8.060453    1.574522    0.406810    163.941650 
[37m[36mINFO[0m[0m 03/04 19:04:57 | 0.025806    0.030303    0.484787    0.503410    1.503080    0.643290    0.660338    0.025806    0.030303    0.373426    0.401763    0.437646    0.448129    1000        10.075567   1.511454    0.405379    162.306136 
[37m[36mINFO[0m[0m 03/04 19:08:58 | 0.021826    0.028249    0.507766    0.522519    1.437802    0.681255    0.695148    0.021826    0.028249    0.394836    0.403023    0.447206    0.469388    1200        12.090680   1.465013    0.402965    160.960734 
[37m[36mINFO[0m[0m 03/04 19:13:04 | 0.150083    0.157678    0.516361    0.512194    1.407420    0.693646    0.681435    0.150083    0.157678    0.402708    0.423174    0.452730    0.431973    1400        14.105793   1.422446    0.408335    163.999585 
[37m[36mINFO[0m[0m 03/04 19:17:04 | 0.084606    0.087827    0.549384    0.542204    1.353459    0.705510    0.704641    0.084606    0.087827    0.455919    0.450882    0.486722    0.471088    1600        16.120907   1.386746    0.406335    159.109009 
[37m[36mINFO[0m[0m 03/04 19:21:13 | 0.032995    0.038007    0.568194    0.560148    1.314619    0.713683    0.699367    0.032995    0.038007    0.479534    0.483627    0.511366    0.497449    1800        18.136020   1.347292    0.407200    167.409536 
[37m[36mINFO[0m[0m 03/04 19:25:17 | 0.034279    0.034926    0.587634    0.586484    1.268156    0.722911    0.718354    0.034279    0.034926    0.495907    0.511335    0.544083    0.529762    2000        20.151134   1.294404    0.406557    162.632818 
[37m[36mINFO[0m[0m 03/04 19:29:22 | 0.123764    0.132512    0.602052    0.584689    1.232177    0.748484    0.743671    0.123764    0.132512    0.500630    0.484887    0.557043    0.525510    2200        22.166247   1.252012    0.407573    163.877583 
[37m[36mINFO[0m[0m 03/04 19:33:25 | 0.314161    0.340010    0.630078    0.628159    1.167496    0.768257    0.761603    0.314161    0.340010    0.550063    0.566751    0.571914    0.556122    2400        24.181360   1.206734    0.407632    160.879990 
[37m[36mINFO[0m[0m 03/04 19:37:27 | 0.103222    0.109913    0.639881    0.633835    1.128529    0.760875    0.750000    0.103222    0.109913    0.564547    0.555416    0.594221    0.596088    2600        26.196474   1.154765    0.406201    160.505674 
[37m[36mINFO[0m[0m 03/04 19:41:32 | 0.315830    0.329738    0.654794    0.657204    1.070188    0.781176    0.782700    0.315830    0.329738    0.581549    0.589421    0.601657    0.599490    2800        28.211587   1.108312    0.408966    163.814745 
[37m[36mINFO[0m[0m 03/04 19:45:33 | 0.167030    0.178737    0.644575    0.651111    1.086905    0.788294    0.785865    0.167030    0.178737    0.560768    0.570529    0.584661    0.596939    3000        30.226700   1.062923    0.408215    159.127804 
[37m[36mINFO[0m[0m 03/04 19:49:35 | 0.175504    0.177196    0.679723    0.683859    0.999733    0.797785    0.794304    0.175504    0.177196    0.619332    0.629723    0.622052    0.627551    3200        32.241814   1.031892    0.406453    160.963255 
[37m[36mINFO[0m[0m 03/04 19:53:32 | 0.350494    0.362096    0.691153    0.695137    0.974564    0.815977    0.799578    0.350494    0.362096    0.632242    0.657431    0.625239    0.628401    3400        34.256927   1.000213    0.404125    156.396072 
[37m[36mINFO[0m[0m 03/04 19:57:32 | 0.157530    0.162301    0.684531    0.683235    0.975997    0.775112    0.765823    0.157530    0.162301    0.652393    0.643577    0.626089    0.640306    3600        36.272040   0.976183    0.405123    158.328238 
[37m[36mINFO[0m[0m 03/04 20:01:28 | 0.319553    0.328711    0.717986    0.711448    0.907563    0.833377    0.818565    0.319553    0.328711    0.676008    0.676322    0.644572    0.639456    3800        38.287154   0.948230    0.408193    154.740427 
[37m[36mINFO[0m[0m 03/04 20:05:26 | 0.384131    0.402671    0.730411    0.724961    0.881226    0.838123    0.828059    0.384131    0.402671    0.700252    0.709068    0.652857    0.637755    4000        40.302267   0.924253    0.404073    157.256340 
[37m[36mINFO[0m[0m 03/04 20:09:25 | 0.410194    0.430919    0.729021    0.734465    0.862665    0.832323    0.827004    0.410194    0.430919    0.705919    0.724181    0.648821    0.652211    4200        42.317380   0.904906    0.402143    158.417669 
[37m[36mINFO[0m[0m 03/04 20:13:26 | 0.324175    0.340524    0.378640    0.389783    1.649974    0.512787    0.518987    0.324175    0.340524    0.296599    0.345088    0.326535    0.305272    4400        44.332494   1.669889    0.405213    159.454129 
[37m[36mINFO[0m[0m 03/04 20:17:28 | 0.395044    0.404212    0.734923    0.730670    0.846400    0.842078    0.830169    0.395044    0.404212    0.698363    0.731738    0.664330    0.630102    4600        46.347607   1.366462    0.405096    161.450974 
[37m[36mINFO[0m[0m 03/04 20:21:31 | 0.363333    0.374936    0.745202    0.741588    0.818402    0.848141    0.832278    0.363333    0.374936    0.722922    0.729219    0.664542    0.663265    4800        48.362720   0.844588    0.406710    162.002039 
[37m[36mINFO[0m[0m 03/04 20:25:33 | 0.322634    0.332306    0.748461    0.743310    0.811215    0.842605    0.834388    0.322634    0.332306    0.730164    0.722922    0.672615    0.672619    5000        50.377834   0.826310    0.409199    159.751648 
[37m[36mINFO[0m[0m 03/04 20:25:33 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[1]/250304_18-41-47_clip_vitb16_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/04 20:25:35 | ---
[37m[36mINFO[0m[0m 03/04 20:25:35 | test-domain validation(oracle) = 41.019%
[37m[36mINFO[0m[0m 03/04 20:25:35 | training-domain validation(iid) = 32.263%
[37m[36mINFO[0m[0m 03/04 20:25:35 | last = 32.263%
[37m[36mINFO[0m[0m 03/04 20:25:35 | last (inD) = 74.331%
[37m[36mINFO[0m[0m 03/04 20:25:35 | training-domain validation (iid, inD) = 74.331%
[37m[36mINFO[0m[0m 03/04 20:25:35 | === Summary ===
[37m[36mINFO[0m[0m 03/04 20:25:35 | Command: /jsm0707/GENIE/train_all.py clip_vitb16_sgd config/clip_vitb16_sgd.yaml --algorithm ERM --test_envs 1 --dataset TerraIncognita
[37m[36mINFO[0m[0m 03/04 20:25:35 | Unique name: 250304_18-41-47_clip_vitb16_sgd
[37m[36mINFO[0m[0m 03/04 20:25:35 | Out path: train_output/TerraIncognita/ERM/[1]/250304_18-41-47_clip_vitb16_sgd
[37m[36mINFO[0m[0m 03/04 20:25:35 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/04 20:25:35 | Dataset: TerraIncognita

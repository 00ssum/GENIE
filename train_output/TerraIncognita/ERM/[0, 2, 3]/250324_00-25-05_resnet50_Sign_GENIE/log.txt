[37m[36mINFO[0m[0m 03/24 00:25:05 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 2 3 --dataset TerraIncognita --trial_seed 0 --hparams_seed 11
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 11
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[0, 2, 3]/250324_00-25-05_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[0, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 2, 3]
	trial_seed: 0
	unique_name: 250324_00-25-05_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 5.962562271631622e-05
	batch_size: 11
	weight_decay: 0.001114945719897867
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/24 00:25:05 | n_steps = 5001
[37m[36mINFO[0m[0m 03/24 00:25:05 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/24 00:25:05 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/24 00:25:05 | 
[37m[36mINFO[0m[0m 03/24 00:25:05 | Testenv name escaping te_L100_L43_L46 -> te_L100_L43_L46
[37m[36mINFO[0m[0m 03/24 00:25:05 | Test envs = [0, 2, 3], name = te_L100_L43_L46
[37m[36mINFO[0m[0m 03/24 00:25:05 | Train environments: [1], Test environments: [0, 2, 3]
[37m[36mINFO[0m[0m 03/24 00:25:05 | Batch sizes for each domain: [0, 11, 0, 0] (total=11)
[37m[36mINFO[0m[0m 03/24 00:25:05 | steps-per-epoch for each domain: 708.09 -> min = 708.09
[37m[36mINFO[0m[0m 03/24 00:25:06 | # of params = 23528522
[37m[36mINFO[0m[0m 03/24 00:27:44 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/24 00:27:44 | 0.203084    0.213519    0.455514    0.481253    2.035405    0.200633    0.208861    0.455514    0.481253    0.186398    0.221662    0.222222    0.210034    0           0.000000    2.270448    0.985638    156.731780 
[37m[36mINFO[0m[0m 03/24 00:30:46 | 0.201463    0.209357    0.594813    0.617360    1.083438    0.203796    0.207806    0.594813    0.617360    0.182620    0.217884    0.217973    0.202381    200         0.282450    1.263194    0.126397    156.855808 
[37m[36mINFO[0m[0m 03/24 00:33:51 | 0.201676    0.209924    0.581333    0.605033    1.066433    0.203796    0.207806    0.581333    0.605033    0.182620    0.217884    0.218611    0.204082    400         0.564899    1.171443    0.132522    158.762889 
[37m[36mINFO[0m[0m 03/24 00:37:00 | 0.172751    0.188515    0.661574    0.653826    1.050223    0.166359    0.187764    0.661574    0.653826    0.177897    0.215365    0.173996    0.162415    600         0.847349    1.098450    0.130437    162.186914 
[37m[36mINFO[0m[0m 03/24 00:40:07 | 0.222947    0.230120    0.631788    0.651258    1.011765    0.217770    0.231013    0.631788    0.651258    0.189547    0.220403    0.261525    0.238946    800         1.129798    1.014814    0.154221    156.282660 
[37m[36mINFO[0m[0m 03/24 00:43:19 | 0.123194    0.130181    0.709205    0.725732    0.888742    0.073293    0.077004    0.709205    0.725732    0.146725    0.185139    0.149564    0.128401    1000        1.412248    1.006239    0.161886    160.029181 
[37m[36mINFO[0m[0m 03/24 00:46:31 | 0.109014    0.111782    0.664527    0.707756    0.873957    0.075929    0.077004    0.664527    0.707756    0.114295    0.146096    0.136818    0.112245    1200        1.694698    0.921212    0.182733    155.527521 
[37m[36mINFO[0m[0m 03/24 00:49:49 | 0.217924    0.223554    0.624599    0.653313    1.016103    0.218561    0.223629    0.624599    0.653313    0.192380    0.219144    0.242830    0.227891    1400        1.977147    0.898993    0.178448    162.076401 
[37m[36mINFO[0m[0m 03/24 00:53:04 | 0.140610    0.152911    0.706766    0.733950    0.810149    0.094912    0.101266    0.706766    0.733950    0.161209    0.207809    0.165711    0.149660    1600        2.259597    0.924276    0.195670    156.265655 
[37m[36mINFO[0m[0m 03/24 00:56:18 | 0.177997    0.185917    0.732700    0.754494    0.760124    0.202215    0.201477    0.732700    0.754494    0.163728    0.201511    0.168048    0.154762    1800        2.542046    0.857898    0.206206    152.645011 
[37m[36mINFO[0m[0m 03/24 00:59:36 | 0.167665    0.184804    0.748106    0.779661    0.728592    0.189296    0.207806    0.748106    0.779661    0.156486    0.192695    0.157213    0.153912    2000        2.824496    0.833740    0.197351    158.574528 
[37m[36mINFO[0m[0m 03/24 01:02:54 | 0.219853    0.229772    0.725895    0.726759    0.801991    0.244925    0.260549    0.725895    0.726759    0.189861    0.217884    0.224772    0.210884    2200        3.106946    0.811044    0.190861    159.046525 
[37m[36mINFO[0m[0m 03/24 01:06:11 | 0.217648    0.227383    0.738477    0.755008    0.760117    0.272871    0.276371    0.738477    0.755008    0.184194    0.220403    0.195878    0.185374    2400        3.389395    0.780600    0.174877    162.101455 
[37m[36mINFO[0m[0m 03/24 01:09:19 | 0.178905    0.194797    0.776223    0.764253    0.650615    0.194569    0.214135    0.776223    0.764253    0.166877    0.205290    0.175271    0.164966    2600        3.671845    0.732175    0.165421    155.536397 
[37m[36mINFO[0m[0m 03/24 01:12:35 | 0.153161    0.165644    0.758120    0.770416    0.680243    0.139467    0.154008    0.758120    0.770416    0.152393    0.181360    0.167623    0.161565    2800        3.954295    0.705743    0.163405    163.393108 
[37m[36mINFO[0m[0m 03/24 01:15:41 | 0.108735    0.119977    0.763513    0.782743    0.660117    0.186396    0.181435    0.763513    0.782743    0.130038    0.172544    0.009773    0.005952    3000        4.236744    0.684538    0.158560    153.732809 
[37m[36mINFO[0m[0m 03/24 01:18:53 | 0.148997    0.156065    0.773142    0.791474    0.618635    0.121012    0.129747    0.773142    0.791474    0.168766    0.198992    0.157213    0.139456    3200        4.519194    0.663432    0.147059    162.963658 
[37m[36mINFO[0m[0m 03/24 01:22:04 | 0.168736    0.162467    0.777250    0.752953    0.682024    0.326127    0.323840    0.777250    0.752953    0.085327    0.076826    0.094752    0.086735    3400        4.801643    0.636859    0.154542    160.254431 
[37m[36mINFO[0m[0m 03/24 01:25:09 | 0.185407    0.196928    0.780716    0.794042    0.609374    0.211178    0.226793    0.780716    0.794042    0.164673    0.196474    0.180370    0.167517    3600        5.084093    0.692209    0.158028    152.668156 
[37m[36mINFO[0m[0m 03/24 01:28:18 | 0.220972    0.227472    0.797920    0.813046    0.528853    0.329554    0.340717    0.797920    0.813046    0.155542    0.177582    0.177820    0.164116    3800        5.366543    0.629329    0.155840    158.195009 
[37m[36mINFO[0m[0m 03/24 01:31:28 | 0.168546    0.184290    0.774811    0.795583    0.623936    0.250725    0.290084    0.774811    0.795583    0.116184    0.130982    0.138730    0.131803    4000        5.648992    0.668645    0.146444    160.508728 
[37m[36mINFO[0m[0m 03/24 01:34:32 | 0.175763    0.182293    0.774425    0.776579    0.639705    0.126549    0.132911    0.774425    0.776579    0.179156    0.211587    0.221585    0.202381    4200        5.931442    0.586160    0.144213    154.944230 
[37m[36mINFO[0m[0m 03/24 01:37:34 | 0.183790    0.190315    0.807549    0.815100    0.535648    0.226206    0.241561    0.807549    0.815100    0.157116    0.176322    0.168048    0.153061    4400        6.213891    0.573145    0.143192    153.476783 
[37m[36mINFO[0m[0m 03/24 01:40:35 | 0.214187    0.223141    0.824881    0.826913    0.500049    0.339573    0.343882    0.824881    0.826913    0.154912    0.177582    0.148077    0.147959    4600        6.496341    0.611478    0.138137    153.994940 
[37m[36mINFO[0m[0m 03/24 01:43:40 | 0.268719    0.270370    0.804211    0.832563    0.510698    0.435803    0.425105    0.804211    0.832563    0.179786    0.204030    0.190567    0.181973    4800        6.778791    0.557842    0.130727    158.250523 
[37m[36mINFO[0m[0m 03/24 01:46:50 | 0.238109    0.254779    0.808576    0.801746    0.625058    0.350646    0.381857    0.808576    0.801746    0.160579    0.180101    0.203102    0.202381    5000        7.061240    0.558554    0.146273    161.400230 
[37m[36mINFO[0m[0m 03/24 01:46:50 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0, 2, 3]/250324_00-25-05_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/24 01:46:52 | ---
[37m[36mINFO[0m[0m 03/24 01:46:52 | test-domain validation(oracle) = 26.872%
[37m[36mINFO[0m[0m 03/24 01:46:52 | training-domain validation(iid) = 26.872%
[37m[36mINFO[0m[0m 03/24 01:46:52 | last = 23.811%
[37m[36mINFO[0m[0m 03/24 01:46:52 | last (inD) = 80.175%
[37m[36mINFO[0m[0m 03/24 01:46:52 | training-domain validation (iid, inD) = 83.256%
[37m[36mINFO[0m[0m 03/24 01:46:52 | === Summary ===
[37m[36mINFO[0m[0m 03/24 01:46:52 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 2 3 --dataset TerraIncognita --trial_seed 0 --hparams_seed 11
[37m[36mINFO[0m[0m 03/24 01:46:52 | Unique name: 250324_00-25-05_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 01:46:52 | Out path: train_output/TerraIncognita/ERM/[0, 2, 3]/250324_00-25-05_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 01:46:52 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/24 01:46:52 | Dataset: TerraIncognita

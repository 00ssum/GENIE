[37m[36mINFO[0m[0m 03/25 09:46:06 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 2 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 14
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 14
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[0, 2, 3]/250325_09-46-06_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[0, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 2, 3]
	trial_seed: 1
	unique_name: 250325_09-46-06_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00011127987942826837
	batch_size: 12
	weight_decay: 3.236767350601091e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/25 09:46:06 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 09:46:06 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 09:46:06 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 09:46:06 | 
[37m[36mINFO[0m[0m 03/25 09:46:06 | Testenv name escaping te_L100_L43_L46 -> te_L100_L43_L46
[37m[36mINFO[0m[0m 03/25 09:46:06 | Test envs = [0, 2, 3], name = te_L100_L43_L46
[37m[36mINFO[0m[0m 03/25 09:46:06 | Train environments: [1], Test environments: [0, 2, 3]
[37m[36mINFO[0m[0m 03/25 09:46:06 | Batch sizes for each domain: [0, 12, 0, 0] (total=12)
[37m[36mINFO[0m[0m 03/25 09:46:06 | steps-per-epoch for each domain: 649.08 -> min = 649.08
[37m[36mINFO[0m[0m 03/25 09:46:07 | # of params = 23528522
[37m[36mINFO[0m[0m 03/25 09:48:41 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 09:48:41 | 0.204546    0.207674    0.461933    0.455573    2.948579    0.208015    0.179325    0.461933    0.455573    0.188287    0.214106    0.217336    0.229592    0           0.000000    2.226941    1.255507    152.686218 
[37m[36mINFO[0m[0m 03/25 09:51:42 | 0.220378    0.224616    0.569521    0.573190    1.155257    0.215397    0.198312    0.569521    0.573190    0.191436    0.217884    0.254302    0.257653    200         0.308127    1.250278    0.134350    154.603818 
[37m[36mINFO[0m[0m 03/25 09:54:46 | 0.203040    0.206199    0.584927    0.572676    1.129030    0.207487    0.180380    0.584927    0.572676    0.184509    0.210327    0.217123    0.227891    400         0.616254    1.169919    0.175950    148.685881 
[37m[36mINFO[0m[0m 03/25 09:57:55 | 0.204420    0.208036    0.598922    0.596816    1.121083    0.211178    0.184599    0.598922    0.596816    0.182620    0.209068    0.219460    0.230442    600         0.924381    1.146095    0.180663    152.344877 
[37m[36mINFO[0m[0m 03/25 10:00:58 | 0.202432    0.205485    0.588907    0.579866    1.153381    0.210124    0.182489    0.588907    0.579866    0.184509    0.210327    0.212662    0.223639    800         1.232507    1.119248    0.160566    151.146523 
[37m[36mINFO[0m[0m 03/25 10:03:58 | 0.202432    0.205485    0.596097    0.616333    1.107922    0.210124    0.182489    0.596097    0.616333    0.184509    0.210327    0.212662    0.223639    1000        1.540634    1.129527    0.133124    153.220899 
[37m[36mINFO[0m[0m 03/25 10:06:57 | 0.200659    0.203308    0.595584    0.583975    1.117273    0.208806    0.179325    0.595584    0.583975    0.181360    0.207809    0.211812    0.222789    1200        1.848761    1.119782    0.135717    152.481849 
[37m[36mINFO[0m[0m 03/25 10:09:59 | 0.201099    0.204362    0.590833    0.581921    1.129187    0.210124    0.182489    0.590833    0.581921    0.181360    0.207809    0.211812    0.222789    1400        2.156888    1.126822    0.130225    155.673711 
[37m[36mINFO[0m[0m 03/25 10:13:02 | 0.203079    0.207050    0.608936    0.605547    1.105780    0.211178    0.184599    0.608936    0.605547    0.181360    0.207809    0.216699    0.228741    1600        2.465015    1.079734    0.133924    156.072417 
[37m[36mINFO[0m[0m 03/25 10:16:02 | 0.129993    0.144322    0.595327    0.586543    1.106517    0.044819    0.051688    0.595327    0.586543    0.181360    0.207809    0.163799    0.173469    1800        2.773142    1.100638    0.135126    152.624923 
[37m[36mINFO[0m[0m 03/25 10:19:01 | 0.128062    0.141939    0.615869    0.619414    1.073522    0.044819    0.051688    0.615869    0.619414    0.177267    0.201511    0.162099    0.172619    2000        3.081268    1.041167    0.134110    152.289894 
[37m[36mINFO[0m[0m 03/25 10:22:09 | 0.199246    0.202594    0.619463    0.625064    1.065349    0.207751    0.181435    0.619463    0.625064    0.181360    0.207809    0.208625    0.218537    2200        3.389395    1.101032    0.163236    155.110071 
[37m[36mINFO[0m[0m 03/25 10:25:13 | 0.181360    0.193814    0.619849    0.625064    1.082754    0.151331    0.150844    0.619849    0.625064    0.181360    0.207809    0.211387    0.222789    2400        3.697522    1.077438    0.174747    149.018427 
[37m[36mINFO[0m[0m 03/25 10:28:28 | 0.133835    0.148039    0.627808    0.642013    1.055374    0.044819    0.051688    0.627808    0.642013    0.176952    0.200252    0.179732    0.192177    2600        4.005649    1.063828    0.206970    154.047624 
[37m[36mINFO[0m[0m 03/25 10:31:47 | 0.202856    0.206619    0.623058    0.623010    1.133270    0.210124    0.182489    0.623058    0.623010    0.184509    0.210327    0.213937    0.227041    2800        4.313776    1.043116    0.221289    154.989926 
[37m[36mINFO[0m[0m 03/25 10:34:57 | 0.196648    0.198873    0.608679    0.615819    1.059685    0.198260    0.167722    0.608679    0.615819    0.181360    0.207809    0.210325    0.221088    3000        4.621903    1.028005    0.198156    149.888904 
[37m[36mINFO[0m[0m 03/25 10:38:07 | 0.171779    0.187531    0.630248    0.628659    1.028993    0.136831    0.139241    0.630248    0.628659    0.181990    0.209068    0.196516    0.214286    3200        4.930030    1.035055    0.170526    155.684335 
[37m[36mINFO[0m[0m 03/25 10:41:10 | 0.083470    0.096024    0.656952    0.656908    1.004492    0.045083    0.051688    0.656952    0.656908    0.140743    0.167506    0.064585    0.068878    3400        5.238156    1.036783    0.163976    151.112898 
[37m[36mINFO[0m[0m 03/25 10:44:18 | 0.182103    0.187872    0.603672    0.596302    1.057601    0.165041    0.144515    0.603672    0.596302    0.181990    0.209068    0.199278    0.210034    3600        5.546283    1.069666    0.168683    153.580701 
[37m[36mINFO[0m[0m 03/25 10:47:25 | 0.048199    0.061421    0.608422    0.626091    1.070130    0.045874    0.052743    0.608422    0.626091    0.093199    0.122166    0.005524    0.009354    3800        5.854410    1.006356    0.169696    153.341135 
[37m[36mINFO[0m[0m 03/25 10:50:33 | 0.070632    0.081698    0.660675    0.647663    1.017230    0.046138    0.052743    0.660675    0.647663    0.162783    0.186398    0.002974    0.005952    4000        6.162537    0.991322    0.167873    153.945078 
[37m[36mINFO[0m[0m 03/25 10:53:37 | 0.076046    0.084873    0.714854    0.710837    0.877815    0.063011    0.068565    0.714854    0.710837    0.162154    0.180101    0.002974    0.005952    4200        6.470664    0.938639    0.160837    151.906170 
[37m[36mINFO[0m[0m 03/25 10:56:41 | 0.185100    0.190872    0.694441    0.700565    0.949864    0.211178    0.182489    0.694441    0.700565    0.187972    0.214106    0.156150    0.176020    4400        6.778791    0.890512    0.160336    152.497962 
[37m[36mINFO[0m[0m 03/25 10:59:42 | 0.162942    0.172408    0.685325    0.695942    0.934341    0.176378    0.163502    0.685325    0.695942    0.180730    0.201511    0.131719    0.152211    4600        7.086917    0.868178    0.152806    150.314856 
[37m[36mINFO[0m[0m 03/25 11:02:53 | 0.095319    0.100423    0.756066    0.767848    0.770122    0.125758    0.120253    0.756066    0.767848    0.156801    0.175063    0.003399    0.005952    4800        7.395044    0.804538    0.180361    154.322786 
[37m[36mINFO[0m[0m 03/25 11:06:04 | 0.065355    0.078902    0.748491    0.764253    0.820935    0.048774    0.051688    0.748491    0.764253    0.126259    0.161209    0.021033    0.023810    5000        7.703171    0.840987    0.196389    151.768992 
[37m[36mINFO[0m[0m 03/25 11:06:04 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0, 2, 3]/250325_09-46-06_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 11:06:05 | ---
[37m[36mINFO[0m[0m 03/25 11:06:05 | test-domain validation(oracle) = 22.038%
[37m[36mINFO[0m[0m 03/25 11:06:05 | training-domain validation(iid) = 9.532%
[37m[36mINFO[0m[0m 03/25 11:06:05 | last = 6.536%
[37m[36mINFO[0m[0m 03/25 11:06:05 | last (inD) = 76.425%
[37m[36mINFO[0m[0m 03/25 11:06:05 | training-domain validation (iid, inD) = 76.785%
[37m[36mINFO[0m[0m 03/25 11:06:05 | === Summary ===
[37m[36mINFO[0m[0m 03/25 11:06:05 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 2 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 14
[37m[36mINFO[0m[0m 03/25 11:06:05 | Unique name: 250325_09-46-06_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 11:06:05 | Out path: train_output/TerraIncognita/ERM/[0, 2, 3]/250325_09-46-06_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 11:06:05 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 11:06:05 | Dataset: TerraIncognita

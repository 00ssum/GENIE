[37m[36mINFO[0m[0m 03/24 05:59:57 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 15
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 15
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[0, 1, 3]/250324_05-59-57_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 2
	unique_name: 250324_05-59-57_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00023237243746776078
	batch_size: 13
	weight_decay: 1.8132449266758068e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/24 05:59:57 | n_steps = 5001
[37m[36mINFO[0m[0m 03/24 05:59:57 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/24 05:59:57 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/24 05:59:57 | 
[37m[36mINFO[0m[0m 03/24 05:59:57 | Testenv name escaping te_L100_L38_L46 -> te_L100_L38_L46
[37m[36mINFO[0m[0m 03/24 05:59:57 | Test envs = [0, 1, 3], name = te_L100_L38_L46
[37m[36mINFO[0m[0m 03/24 05:59:57 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 03/24 05:59:57 | Batch sizes for each domain: [0, 0, 13, 0] (total=13)
[37m[36mINFO[0m[0m 03/24 05:59:57 | steps-per-epoch for each domain: 244.31 -> min = 244.31
[37m[36mINFO[0m[0m 03/24 05:59:59 | # of params = 23528522
[37m[36mINFO[0m[0m 03/24 06:02:32 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/24 06:02:32 | 0.297264    0.283176    0.198992    0.180101    2.202013    0.203533    0.197257    0.465400    0.444787    0.198992    0.180101    0.222860    0.207483    0           0.000000    2.416217    1.667527    152.197313 
[37m[36mINFO[0m[0m 03/24 06:05:37 | 0.248519    0.241661    0.428526    0.411839    1.489226    0.039019    0.052743    0.442676    0.429892    0.428526    0.411839    0.263862    0.242347    200         0.818640    1.574201    0.148711    154.446063 
[37m[36mINFO[0m[0m 03/24 06:08:35 | 0.281869    0.270288    0.523615    0.556675    1.277000    0.212233    0.207806    0.455129    0.435542    0.523615    0.556675    0.178245    0.167517    400         1.637280    1.401106    0.147929    148.701890 
[37m[36mINFO[0m[0m 03/24 06:11:35 | 0.308966    0.296564    0.563602    0.554156    1.180649    0.142631    0.146624    0.438824    0.416538    0.563602    0.554156    0.345443    0.326531    600         2.455919    1.270873    0.144719    150.758456 
[37m[36mINFO[0m[0m 03/24 06:14:35 | 0.281154    0.269592    0.612406    0.613350    1.102328    0.182969    0.179325    0.325459    0.312275    0.612406    0.613350    0.335033    0.317177    800         3.274559    1.184891    0.150543    149.894354 
[37m[36mINFO[0m[0m 03/24 06:17:30 | 0.321863    0.310041    0.585642    0.574307    1.112743    0.192723    0.194093    0.454615    0.432460    0.585642    0.574307    0.318249    0.303571    1000        4.093199    1.106607    0.134152    148.941806 
[37m[36mINFO[0m[0m 03/24 06:20:31 | 0.372906    0.366782    0.631612    0.638539    0.998989    0.367783    0.374473    0.400180    0.388290    0.631612    0.638539    0.350754    0.337585    1200        4.911839    0.947158    0.154816    150.060957 
[37m[36mINFO[0m[0m 03/24 06:23:32 | 0.335559    0.330049    0.685768    0.685139    0.828281    0.431584    0.456751    0.201181    0.189009    0.685768    0.685139    0.373911    0.344388    1400        5.730479    0.869977    0.147052    151.278640 
[37m[36mINFO[0m[0m 03/24 06:26:31 | 0.350921    0.334367    0.699622    0.651134    0.937054    0.321645    0.311181    0.391835    0.371341    0.699622    0.651134    0.339282    0.320578    1600        6.549118    0.806006    0.142222    150.118163 
[37m[36mINFO[0m[0m 03/24 06:29:29 | 0.392393    0.380101    0.755982    0.731738    0.652766    0.429212    0.445148    0.341764    0.321007    0.755982    0.731738    0.406204    0.374150    1800        7.367758    0.791180    0.138760    150.075035 
[37m[36mINFO[0m[0m 03/24 06:32:22 | 0.290746    0.282726    0.742128    0.734257    0.683310    0.223570    0.231013    0.300039    0.280431    0.742128    0.734257    0.348630    0.336735    2000        8.186398    0.745714    0.139627    145.521874 
[37m[36mINFO[0m[0m 03/24 06:35:23 | 0.285216    0.275085    0.672229    0.668766    0.936959    0.148959    0.149789    0.368468    0.352337    0.672229    0.668766    0.338220    0.323129    2200        9.005038    0.718044    0.156563    149.924991 
[37m[36mINFO[0m[0m 03/24 06:38:25 | 0.382683    0.370217    0.764484    0.770781    0.699033    0.350646    0.352321    0.397997    0.384181    0.764484    0.770781    0.399405    0.374150    2400        9.823678    0.683804    0.150976    151.450763 
[37m[36mINFO[0m[0m 03/24 06:41:19 | 0.250774    0.237089    0.716940    0.719144    0.786261    0.075138    0.089662    0.330466    0.308680    0.716940    0.719144    0.346718    0.312925    2600        10.642317   0.700097    0.144833    145.650461 
[37m[36mINFO[0m[0m 03/24 06:44:21 | 0.396302    0.384055    0.780856    0.783375    0.637164    0.361455    0.361814    0.434844    0.417052    0.780856    0.783375    0.392607    0.373299    2800        11.460957   0.588434    0.148945    151.353144 
[37m[36mINFO[0m[0m 03/24 06:47:19 | 0.384278    0.365348    0.799748    0.797229    0.537941    0.321118    0.309072    0.413404    0.394967    0.799748    0.797229    0.418313    0.392007    3000        12.279597   0.611021    0.159263    146.801800 
[37m[36mINFO[0m[0m 03/24 06:50:27 | 0.322255    0.314468    0.800693    0.768262    0.637290    0.254943    0.271097    0.331750    0.311762    0.800693    0.768262    0.380072    0.360544    3200        13.098237   0.562582    0.203504    146.980931 
[37m[36mINFO[0m[0m 03/24 06:53:33 | 0.424324    0.419916    0.761650    0.770781    0.633197    0.427630    0.449367    0.459109    0.437083    0.761650    0.770781    0.386233    0.373299    3400        13.916877   0.590469    0.188777    148.501246 
[37m[36mINFO[0m[0m 03/24 06:56:43 | 0.399771    0.389894    0.801637    0.783375    0.586070    0.410229    0.417722    0.447041    0.423729    0.801637    0.783375    0.342044    0.328231    3600        14.735516   0.541579    0.184800    153.153780 
[37m[36mINFO[0m[0m 03/24 06:59:51 | 0.340176    0.320892    0.801952    0.802267    0.582285    0.331664    0.339662    0.365515    0.341551    0.801952    0.802267    0.323348    0.281463    3800        15.554156   0.523493    0.183064    150.568714 
[37m[36mINFO[0m[0m 03/24 07:02:56 | 0.367885    0.349607    0.802582    0.782116    0.682405    0.308727    0.308017    0.432276    0.408320    0.802582    0.782116    0.362651    0.332483    4000        16.372796   0.500102    0.174838    150.236700 
[37m[36mINFO[0m[0m 03/24 07:05:56 | 0.360299    0.359566    0.778338    0.750630    0.726976    0.465331    0.497890    0.252279    0.234720    0.778338    0.750630    0.363289    0.346088    4200        17.191436   0.490863    0.170568    146.374383 
[37m[36mINFO[0m[0m 03/24 07:09:02 | 0.403850    0.389867    0.795025    0.780856    0.603557    0.420775    0.414557    0.368212    0.350282    0.795025    0.780856    0.422562    0.404762    4400        18.010076   0.544563    0.195551    146.928034 
[37m[36mINFO[0m[0m 03/24 07:12:07 | 0.403951    0.393553    0.836272    0.806045    0.524222    0.397838    0.407173    0.427783    0.412943    0.836272    0.806045    0.386233    0.360544    4600        18.828715   0.528110    0.192706    146.021192 
[37m[36mINFO[0m[0m 03/24 07:15:11 | 0.421539    0.412925    0.819899    0.833753    0.490607    0.516478    0.531646    0.353832    0.331279    0.819899    0.833753    0.394306    0.375850    4800        19.647355   0.448811    0.189178    146.746085 
[37m[36mINFO[0m[0m 03/24 07:18:18 | 0.381004    0.369082    0.842569    0.812343    0.518284    0.372265    0.383966    0.378354    0.355932    0.842569    0.812343    0.392394    0.367347    5000        20.465995   0.430372    0.189525    149.117197 
[37m[36mINFO[0m[0m 03/24 07:18:19 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0, 1, 3]/250324_05-59-57_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/24 07:18:20 | ---
[37m[36mINFO[0m[0m 03/24 07:18:20 | test-domain validation(oracle) = 42.432%
[37m[36mINFO[0m[0m 03/24 07:18:20 | training-domain validation(iid) = 42.154%
[37m[36mINFO[0m[0m 03/24 07:18:20 | last = 38.100%
[37m[36mINFO[0m[0m 03/24 07:18:20 | last (inD) = 81.234%
[37m[36mINFO[0m[0m 03/24 07:18:20 | training-domain validation (iid, inD) = 83.375%
[37m[36mINFO[0m[0m 03/24 07:18:20 | === Summary ===
[37m[36mINFO[0m[0m 03/24 07:18:20 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 15
[37m[36mINFO[0m[0m 03/24 07:18:20 | Unique name: 250324_05-59-57_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 07:18:20 | Out path: train_output/TerraIncognita/ERM/[0, 1, 3]/250324_05-59-57_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/24 07:18:20 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/24 07:18:20 | Dataset: TerraIncognita

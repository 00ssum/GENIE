[37m[36mINFO[0m[0m 01/26 23:51:03 | Command :: /jsm0707/Large-scale/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm ERM --test_envs 0 1 3 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_adam.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_adam
	out_dir: train_output/TerraIncognita/ERM/[0, 1, 3]/250126_23-51-03_resnet50_adam
	out_root: train_output/TerraIncognita/ERM/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 0
	unique_name: 250126_23-51-03_resnet50_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/26 23:51:03 | n_steps = 5001
[37m[36mINFO[0m[0m 01/26 23:51:03 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/26 23:51:03 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/26 23:51:03 | 
[37m[36mINFO[0m[0m 01/26 23:51:03 | Testenv name escaping te_L100_L38_L46 -> te_L100_L38_L46
[37m[36mINFO[0m[0m 01/26 23:51:03 | Test envs = [0, 1, 3], name = te_L100_L38_L46
[37m[36mINFO[0m[0m 01/26 23:51:03 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 01/26 23:51:03 | Batch sizes for each domain: [0, 0, 32, 0] (total=32)
[37m[36mINFO[0m[0m 01/26 23:51:03 | steps-per-epoch for each domain: 99.25 -> min = 99.25
[37m[36mINFO[0m[0m 01/26 23:51:04 | # of params = 23528522
[37m[36mINFO[0m[0m 01/26 23:53:40 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/26 23:53:40 | 0.299658    0.303833    0.347607    0.362720    2.140601    0.201687    0.209916    0.444473    0.469440    0.347607    0.362720    0.252815    0.232143    0           0.000000    2.445203    1.038303    154.751598 
[37m[36mINFO[0m[0m 01/26 23:57:00 | 0.365329    0.377712    0.715680    0.716625    0.776121    0.259162    0.264768    0.456541    0.487417    0.715680    0.716625    0.380285    0.380952    200         2.015113    1.105050    0.244719    150.353906 
[37m[36mINFO[0m[0m 01/27 00:00:23 | 0.351854    0.367530    0.769521    0.793451    0.606302    0.317690    0.336498    0.355887    0.374936    0.769521    0.793451    0.381984    0.391156    400         4.030227    0.686712    0.238203    154.986460 
[37m[36mINFO[0m[0m 01/27 00:03:53 | 0.421452    0.430003    0.761335    0.736776    0.742819    0.432375    0.441983    0.426627    0.445814    0.761335    0.736776    0.405354    0.402211    600         6.045340    0.566342    0.232499    163.831990 
[37m[36mINFO[0m[0m 01/27 00:07:15 | 0.389576    0.393818    0.828715    0.808564    0.526570    0.306881    0.302743    0.419951    0.431433    0.828715    0.808564    0.441895    0.447279    800         8.060453    0.525915    0.224855    156.515984 
[37m[36mINFO[0m[0m 01/27 00:10:30 | 0.453815    0.457273    0.833438    0.812343    0.539420    0.557870    0.563291    0.393760    0.413970    0.833438    0.812343    0.409815    0.394558    1000        10.075567   0.460468    0.230606    148.610093 
[37m[36mINFO[0m[0m 01/27 00:13:56 | 0.448910    0.455822    0.856108    0.826196    0.473682    0.511732    0.534810    0.396713    0.410889    0.856108    0.826196    0.438283    0.421769    1200        12.090680   0.403397    0.236527    158.819930 
[37m[36mINFO[0m[0m 01/27 00:17:26 | 0.339466    0.336604    0.836587    0.817380    0.515350    0.405747    0.400844    0.183079    0.198254    0.836587    0.817380    0.429573    0.410714    1400        14.105793   0.379733    0.229390    164.620253 
[37m[36mINFO[0m[0m 01/27 00:20:56 | 0.412286    0.419731    0.884131    0.840050    0.420041    0.431321    0.434599    0.394659    0.425783    0.884131    0.840050    0.410877    0.398810    1600        16.120907   0.353043    0.232580    163.019254 
[37m[36mINFO[0m[0m 01/27 00:24:21 | 0.410038    0.413980    0.901448    0.866499    0.437892    0.457685    0.456751    0.351778    0.382126    0.901448    0.866499    0.420650    0.403061    1800        18.136020   0.319338    0.234678    157.721279 
[37m[36mINFO[0m[0m 01/27 00:27:38 | 0.391285    0.405046    0.894521    0.858942    0.425946    0.341155    0.366034    0.432020    0.454545    0.894521    0.858942    0.400680    0.394558    2000        20.151134   0.293657    0.232348    150.924253 
[37m[36mINFO[0m[0m 01/27 00:30:49 | 0.404186    0.411197    0.903967    0.867758    0.337146    0.460058    0.473629    0.357556    0.373909    0.903967    0.867758    0.394944    0.386054    2200        22.166247   0.276437    0.226639    145.409682 
[37m[36mINFO[0m[0m 01/27 00:34:08 | 0.374535    0.386675    0.922859    0.871537    0.365655    0.327182    0.355485    0.409552    0.427838    0.922859    0.871537    0.386871    0.376701    2400        24.181360   0.271749    0.226684    154.035835 
[37m[36mINFO[0m[0m 01/27 00:37:23 | 0.418952    0.418531    0.903338    0.852645    0.427711    0.558661    0.555907    0.315573    0.337442    0.903338    0.852645    0.382622    0.362245    2600        26.196474   0.240510    0.243009    146.081760 
[37m[36mINFO[0m[0m 01/27 00:40:37 | 0.420663    0.423713    0.923174    0.877834    0.334066    0.525178    0.524262    0.332520    0.349769    0.923174    0.877834    0.404291    0.397109    2800        28.211587   0.228731    0.225447    149.237527 
[37m[36mINFO[0m[0m 01/27 00:43:57 | 0.471195    0.469978    0.922859    0.858942    0.389474    0.565515    0.558017    0.448453    0.468413    0.922859    0.858942    0.399618    0.383503    3000        30.226700   0.213259    0.240808    151.680047 
[37m[36mINFO[0m[0m 01/27 00:47:26 | 0.418352    0.430124    0.923804    0.871537    0.374142    0.475877    0.487342    0.410579    0.431433    0.923804    0.871537    0.368600    0.371599    3200        32.241814   0.213263    0.247689    158.758947 
[37m[36mINFO[0m[0m 01/27 00:50:48 | 0.348442    0.363267    0.935768    0.887909    0.305998    0.435803    0.445148    0.220953    0.244992    0.935768    0.887909    0.388570    0.399660    3400        34.256927   0.183777    0.236125    154.812682 
[37m[36mINFO[0m[0m 01/27 00:54:16 | 0.444834    0.455612    0.907746    0.860202    0.446295    0.499868    0.523207    0.435229    0.449923    0.907746    0.860202    0.399405    0.393707    3600        36.272040   0.165946    0.235316    160.820320 
[37m[36mINFO[0m[0m 01/27 00:57:39 | 0.366789    0.376761    0.924748    0.891688    0.312453    0.399684    0.399789    0.318911    0.341037    0.924748    0.891688    0.381772    0.389456    3800        38.287154   0.172356    0.227212    157.944541 
[37m[36mINFO[0m[0m 01/27 01:01:00 | 0.397562    0.406789    0.911524    0.867758    0.430079    0.356710    0.369198    0.462704    0.483821    0.911524    0.867758    0.373274    0.367347    4000        40.302267   0.185741    0.229781    155.096464 
[37m[36mINFO[0m[0m 01/27 01:04:24 | 0.326562    0.338984    0.942695    0.887909    0.337507    0.257580    0.279536    0.326101    0.359014    0.942695    0.887909    0.396006    0.378401    4200        42.317380   0.176281    0.231695    157.628075 
[37m[36mINFO[0m[0m 01/27 01:07:47 | 0.409237    0.422117    0.955919    0.895466    0.298808    0.424993    0.443038    0.410322    0.438110    0.955919    0.895466    0.392394    0.385204    4400        44.332494   0.154113    0.229255    156.712865 
[37m[36mINFO[0m[0m 01/27 01:11:11 | 0.389044    0.400599    0.941751    0.886650    0.322656    0.423939    0.429325    0.333804    0.362609    0.941751    0.886650    0.409390    0.409864    4600        46.347607   0.159941    0.241080    156.010998 
[37m[36mINFO[0m[0m 01/27 01:14:34 | 0.381187    0.393028    0.946788    0.897985    0.321003    0.364619    0.361814    0.419053    0.449923    0.946788    0.897985    0.359890    0.367347    4800        48.362720   0.157469    0.231150    156.061874 
[37m[36mINFO[0m[0m 01/27 01:17:52 | 0.429117    0.436657    0.955290    0.908060    0.297032    0.478513    0.493671    0.416870    0.431947    0.955290    0.908060    0.391969    0.384354    5000        50.377834   0.133431    0.230302    152.064758 
[37m[36mINFO[0m[0m 01/27 01:17:52 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0, 1, 3]/250126_23-51-03_resnet50_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/27 01:17:53 | ---
[37m[36mINFO[0m[0m 01/27 01:17:53 | test-domain validation(oracle) = 47.120%
[37m[36mINFO[0m[0m 01/27 01:17:53 | training-domain validation(iid) = 42.912%
[37m[36mINFO[0m[0m 01/27 01:17:53 | last = 42.912%
[37m[36mINFO[0m[0m 01/27 01:17:53 | last (inD) = 90.806%
[37m[36mINFO[0m[0m 01/27 01:17:53 | training-domain validation (iid, inD) = 90.806%
[37m[36mINFO[0m[0m 01/27 01:17:53 | === Summary ===
[37m[36mINFO[0m[0m 01/27 01:17:53 | Command: /jsm0707/Large-scale/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm ERM --test_envs 0 1 3 --dataset TerraIncognita
[37m[36mINFO[0m[0m 01/27 01:17:53 | Unique name: 250126_23-51-03_resnet50_adam
[37m[36mINFO[0m[0m 01/27 01:17:53 | Out path: train_output/TerraIncognita/ERM/[0, 1, 3]/250126_23-51-03_resnet50_adam
[37m[36mINFO[0m[0m 01/27 01:17:53 | Algorithm: ERM
[37m[36mINFO[0m[0m 01/27 01:17:53 | Dataset: TerraIncognita

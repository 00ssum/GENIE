[37m[36mINFO[0m[0m 03/25 09:48:54 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 7
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 7
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[0, 1, 3]/250325_09-48-54_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 1
	unique_name: 250325_09-48-54_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00025471109765784857
	batch_size: 39
	weight_decay: 9.10622179414602e-05
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/25 09:48:54 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 09:48:54 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 09:48:54 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 09:48:54 | 
[37m[36mINFO[0m[0m 03/25 09:48:54 | Testenv name escaping te_L100_L38_L46 -> te_L100_L38_L46
[37m[36mINFO[0m[0m 03/25 09:48:54 | Test envs = [0, 1, 3], name = te_L100_L38_L46
[37m[36mINFO[0m[0m 03/25 09:48:54 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 03/25 09:48:54 | Batch sizes for each domain: [0, 0, 39, 0] (total=39)
[37m[36mINFO[0m[0m 03/25 09:48:54 | steps-per-epoch for each domain: 81.44 -> min = 81.44
[37m[36mINFO[0m[0m 03/25 09:48:55 | # of params = 23528522
[37m[36mINFO[0m[0m 03/25 09:51:26 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 09:51:26 | 0.066420    0.073704    0.113665    0.168766    2.121517    0.043765    0.055907    0.033124    0.035953    0.113665    0.168766    0.122371    0.129252    0           0.000000    2.647420    1.239073    149.873459 
[37m[36mINFO[0m[0m 03/25 09:54:49 | 0.234184    0.232513    0.470088    0.527708    1.283869    0.092539    0.084388    0.402876    0.392912    0.470088    0.527708    0.207138    0.220238    200         2.455919    1.561456    0.287635    144.995758 
[37m[36mINFO[0m[0m 03/25 09:58:10 | 0.186994    0.184255    0.562343    0.613350    1.128642    0.101766    0.101266    0.259725    0.251669    0.562343    0.613350    0.199490    0.199830    400         4.911839    1.206399    0.278511    145.683210 
[37m[36mINFO[0m[0m 03/25 10:01:31 | 0.219281    0.229247    0.688602    0.748111    0.730177    0.091748    0.101266    0.244447    0.242938    0.688602    0.748111    0.321649    0.343537    600         7.367758    0.943074    0.273807    146.282814 
[37m[36mINFO[0m[0m 03/25 10:04:54 | 0.283800    0.296204    0.746851    0.792191    0.578946    0.320063    0.337553    0.178457    0.185413    0.746851    0.792191    0.352879    0.365646    800         9.823678    0.754302    0.275880    147.974476 
[37m[36mINFO[0m[0m 03/25 10:08:14 | 0.337981    0.355070    0.764484    0.799748    0.570562    0.232797    0.271097    0.400437    0.394453    0.764484    0.799748    0.380710    0.399660    1000        12.279597   0.675794    0.279762    143.867835 
[37m[36mINFO[0m[0m 03/25 10:11:33 | 0.306777    0.313514    0.784635    0.818640    0.511857    0.161613    0.177215    0.448966    0.445300    0.784635    0.818640    0.309751    0.318027    1200        14.735516   0.595953    0.273131    143.985432 
[37m[36mINFO[0m[0m 03/25 10:14:58 | 0.304275    0.312500    0.791562    0.777078    0.574328    0.259689    0.278481    0.384388    0.385208    0.791562    0.777078    0.268749    0.273810    1400        17.191436   0.517267    0.274381    150.670826 
[37m[36mINFO[0m[0m 03/25 10:18:24 | 0.295680    0.310942    0.814547    0.823678    0.504336    0.200633    0.239451    0.360508    0.360041    0.814547    0.823678    0.325898    0.333333    1600        19.647355   0.465221    0.272459    151.520665 
[37m[36mINFO[0m[0m 03/25 10:21:44 | 0.250993    0.250692    0.835957    0.828715    0.479357    0.130767    0.148734    0.314161    0.298921    0.835957    0.828715    0.308052    0.304422    1800        22.103275   0.443201    0.272570    144.944824 
[37m[36mINFO[0m[0m 03/25 10:25:07 | 0.369141    0.378031    0.871851    0.856423    0.447554    0.399684    0.433544    0.372705    0.364664    0.871851    0.856423    0.335033    0.335884    2000        24.559194   0.421906    0.282322    146.675458 
[37m[36mINFO[0m[0m 03/25 10:28:33 | 0.281630    0.278579    0.867758    0.874055    0.358262    0.238597    0.243671    0.274233    0.265537    0.867758    0.874055    0.332059    0.326531    2200        27.015113   0.400150    0.274625    151.355863 
[37m[36mINFO[0m[0m 03/25 10:31:57 | 0.406200    0.411033    0.875000    0.861461    0.414668    0.376747    0.400844    0.452433    0.453005    0.875000    0.861461    0.389420    0.379252    2400        29.471033   0.351744    0.275016    148.658157 
[37m[36mINFO[0m[0m 03/25 10:35:18 | 0.355279    0.367472    0.878778    0.847607    0.406642    0.432639    0.478903    0.263962    0.262969    0.878778    0.847607    0.369237    0.360544    2600        31.926952   0.338024    0.277964    145.742999 
[37m[36mINFO[0m[0m 03/25 10:38:43 | 0.390494    0.400974    0.886020    0.860202    0.381085    0.456894    0.500000    0.368083    0.363636    0.886020    0.860202    0.346505    0.339286    2800        34.382872   0.322167    0.283780    148.467874 
[37m[36mINFO[0m[0m 03/25 10:42:05 | 0.450841    0.461889    0.863665    0.858942    0.389808    0.523860    0.548523    0.396328    0.394967    0.863665    0.858942    0.432335    0.442177    3000        36.838791   0.303490    0.277948    145.744495 
[37m[36mINFO[0m[0m 03/25 10:45:31 | 0.336744    0.347878    0.913413    0.863980    0.389806    0.232006    0.267932    0.419823    0.413457    0.913413    0.863980    0.358402    0.362245    3200        39.294710   0.278927    0.279953    150.833412 
[37m[36mINFO[0m[0m 03/25 10:48:50 | 0.356463    0.363769    0.915617    0.885390    0.341250    0.388347    0.415612    0.365130    0.361068    0.915617    0.885390    0.315912    0.314626    3400        41.750630   0.240797    0.276008    143.118618 
[37m[36mINFO[0m[0m 03/25 10:52:13 | 0.377035    0.391074    0.895151    0.870277    0.381485    0.328500    0.371308    0.442290    0.442219    0.895151    0.870277    0.360314    0.359694    3600        44.206549   0.238842    0.272505    148.897529 
[37m[36mINFO[0m[0m 03/25 10:55:38 | 0.331790    0.341938    0.924433    0.899244    0.269793    0.293963    0.330169    0.426499    0.420134    0.924433    0.899244    0.274910    0.275510    3800        46.662469   0.246862    0.277444    148.836975 
[37m[36mINFO[0m[0m 03/25 10:59:03 | 0.329431    0.337586    0.932620    0.905542    0.269137    0.253889    0.281646    0.412120    0.408834    0.932620    0.905542    0.322286    0.322279    4000        49.118388   0.233794    0.290398    147.422711 
[37m[36mINFO[0m[0m 03/25 11:02:32 | 0.416903    0.418703    0.914673    0.879093    0.356505    0.529396    0.547468    0.387341    0.379558    0.914673    0.879093    0.333971    0.329082    4200        51.574307   0.222301    0.278336    153.617652 
[37m[36mINFO[0m[0m 03/25 11:05:56 | 0.309016    0.311485    0.941751    0.903023    0.282621    0.264698    0.287975    0.371293    0.366718    0.941751    0.903023    0.291056    0.279762    4400        54.030227   0.219554    0.283229    147.469528 
[37m[36mINFO[0m[0m 03/25 11:09:20 | 0.302079    0.305397    0.911839    0.882872    0.275769    0.253889    0.272152    0.363205    0.357473    0.911839    0.882872    0.289144    0.286565    4600        56.486146   0.202132    0.275098    148.295028 
[37m[36mINFO[0m[0m 03/25 11:12:41 | 0.398113    0.408168    0.940491    0.910579    0.251788    0.440285    0.468354    0.396713    0.388803    0.940491    0.910579    0.357340    0.367347    4800        58.942065   0.208168    0.284333    143.965014 
[37m[36mINFO[0m[0m 03/25 11:16:10 | 0.404551    0.403422    0.942695    0.909320    0.241828    0.448458    0.452532    0.421877    0.422702    0.942695    0.909320    0.343318    0.335034    5000        61.397985   0.172048    0.286612    151.789743 
[37m[36mINFO[0m[0m 03/25 11:16:10 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0, 1, 3]/250325_09-48-54_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 11:16:11 | ---
[37m[36mINFO[0m[0m 03/25 11:16:11 | test-domain validation(oracle) = 45.084%
[37m[36mINFO[0m[0m 03/25 11:16:11 | training-domain validation(iid) = 39.811%
[37m[36mINFO[0m[0m 03/25 11:16:11 | last = 40.455%
[37m[36mINFO[0m[0m 03/25 11:16:11 | last (inD) = 90.932%
[37m[36mINFO[0m[0m 03/25 11:16:11 | training-domain validation (iid, inD) = 91.058%
[37m[36mINFO[0m[0m 03/25 11:16:11 | === Summary ===
[37m[36mINFO[0m[0m 03/25 11:16:11 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 7
[37m[36mINFO[0m[0m 03/25 11:16:11 | Unique name: 250325_09-48-54_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 11:16:11 | Out path: train_output/TerraIncognita/ERM/[0, 1, 3]/250325_09-48-54_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 11:16:11 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 11:16:11 | Dataset: TerraIncognita

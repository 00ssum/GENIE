[37m[36mINFO[0m[0m 01/26 18:02:06 | Command :: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm ERM --test_envs 0 1 3 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/TerraIncognita/ERM/[0, 1, 3]/250126_18-02-06_resnet50_sgd
	out_root: train_output/TerraIncognita/ERM/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 0
	unique_name: 250126_18-02-06_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/26 18:02:06 | n_steps = 5001
[37m[36mINFO[0m[0m 01/26 18:02:06 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/26 18:02:06 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/26 18:02:06 | 
[37m[36mINFO[0m[0m 01/26 18:02:06 | Testenv name escaping te_L100_L38_L46 -> te_L100_L38_L46
[37m[36mINFO[0m[0m 01/26 18:02:06 | Test envs = [0, 1, 3], name = te_L100_L38_L46
[37m[36mINFO[0m[0m 01/26 18:02:06 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 01/26 18:02:06 | Batch sizes for each domain: [0, 0, 32, 0] (total=32)
[37m[36mINFO[0m[0m 01/26 18:02:06 | steps-per-epoch for each domain: 99.25 -> min = 99.25
[37m[36mINFO[0m[0m 01/26 18:02:08 | # of params = 23528522
[37m[36mINFO[0m[0m 01/26 18:04:38 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/26 18:04:38 | 0.040072    0.038119    0.042506    0.035264    2.409764    0.069338    0.060127    0.044293    0.048279    0.042506    0.035264    0.006586    0.005952    0           0.000000    2.445203    0.932591    149.729754 
[37m[36mINFO[0m[0m 01/26 18:08:05 | 0.220006    0.224833    0.346977    0.331234    1.887099    0.016610    0.030591    0.420336    0.440678    0.346977    0.331234    0.223072    0.203231    200         2.015113    2.113566    0.247301    156.982877 
[37m[36mINFO[0m[0m 01/26 18:11:27 | 0.211259    0.216796    0.352015    0.357683    1.645854    0.012391    0.024262    0.406599    0.426297    0.352015    0.357683    0.214786    0.199830    400         4.030227    1.762781    0.237386    153.992200 
[37m[36mINFO[0m[0m 01/26 18:14:48 | 0.217199    0.223285    0.367758    0.396725    1.549600    0.013973    0.028481    0.419438    0.443246    0.367758    0.396725    0.218186    0.198129    600         6.045340    1.611115    0.249932    150.678253 
[37m[36mINFO[0m[0m 01/26 18:18:13 | 0.211698    0.218233    0.389484    0.428212    1.493670    0.013446    0.023207    0.413660    0.440164    0.389484    0.428212    0.207988    0.191327    800         8.060453    1.558924    0.239480    157.533057 
[37m[36mINFO[0m[0m 01/26 18:21:35 | 0.211319    0.215983    0.418451    0.452141    1.450948    0.020828    0.032700    0.404930    0.427324    0.418451    0.452141    0.208201    0.187925    1000        10.075567   1.532803    0.234159    154.359426 
[37m[36mINFO[0m[0m 01/26 18:25:00 | 0.227453    0.227999    0.431675    0.458438    1.411410    0.044292    0.048523    0.428168    0.450950    0.431675    0.458438    0.209900    0.184524    1200        12.090680   1.473066    0.248258    154.937553 
[37m[36mINFO[0m[0m 01/26 18:28:23 | 0.187226    0.182089    0.471977    0.497481    1.370649    0.015028    0.023207    0.347798    0.348742    0.471977    0.497481    0.198853    0.174320    1400        14.105793   1.461503    0.235334    155.384673 
[37m[36mINFO[0m[0m 01/26 18:31:50 | 0.195025    0.191307    0.489610    0.506297    1.335197    0.021619    0.027426    0.362691    0.368772    0.489610    0.506297    0.200765    0.177721    1600        16.120907   1.406797    0.240259    159.272813 
[37m[36mINFO[0m[0m 01/26 18:35:15 | 0.174239    0.171948    0.495277    0.525189    1.304711    0.015555    0.025316    0.315958    0.315357    0.495277    0.525189    0.191205    0.175170    1800        18.136020   1.364401    0.240340    157.422056 
[37m[36mINFO[0m[0m 01/26 18:38:41 | 0.101029    0.100886    0.533375    0.532746    1.279976    0.011337    0.020042    0.120940    0.122753    0.533375    0.532746    0.170809    0.159864    2000        20.151134   1.317543    0.238964    157.957208 
[37m[36mINFO[0m[0m 01/26 18:42:09 | 0.122071    0.119749    0.546285    0.544081    1.238336    0.014764    0.020042    0.168956    0.167437    0.546285    0.544081    0.182494    0.171769    2200        22.166247   1.281565    0.244789    158.760279 
[37m[36mINFO[0m[0m 01/26 18:45:39 | 0.164807    0.159429    0.565806    0.555416    1.208120    0.034274    0.031646    0.265117    0.262969    0.565806    0.555416    0.195029    0.183673    2400        24.181360   1.245986    0.241944    162.047377 
[37m[36mINFO[0m[0m 01/26 18:49:04 | 0.169414    0.165533    0.580605    0.566751    1.171053    0.029264    0.027426    0.272050    0.275295    0.580605    0.566751    0.206926    0.193878    2600        26.196474   1.207600    0.239291    157.002963 
[37m[36mINFO[0m[0m 01/26 18:52:32 | 0.184448    0.186794    0.598866    0.596977    1.147433    0.075402    0.084388    0.264219    0.277863    0.598866    0.596977    0.213724    0.198129    2800        28.211587   1.180762    0.262058    155.536579 
[37m[36mINFO[0m[0m 01/26 18:56:03 | 0.192912    0.190930    0.611146    0.618388    1.118974    0.054047    0.049578    0.312877    0.319979    0.611146    0.618388    0.211812    0.203231    3000        30.226700   1.148610    0.272213    155.984714 
[37m[36mINFO[0m[0m 01/26 18:59:30 | 0.233401    0.235172    0.622796    0.619647    1.103100    0.114158    0.119198    0.360637    0.372881    0.622796    0.619647    0.225409    0.213435    3200        32.241814   1.115523    0.237335    159.156523 
[37m[36mINFO[0m[0m 01/26 19:02:54 | 0.229184    0.228606    0.626889    0.641058    1.054430    0.094912    0.103376    0.344075    0.352851    0.626889    0.641058    0.248566    0.229592    3400        34.256927   1.081560    0.249736    154.214422 
[37m[36mINFO[0m[0m 01/26 19:06:14 | 0.170117    0.168172    0.613350    0.644836    1.050023    0.037965    0.040084    0.241880    0.252696    0.613350    0.644836    0.230508    0.211735    3600        36.272040   1.045905    0.232221    153.188239 
[37m[36mINFO[0m[0m 01/26 19:09:37 | 0.200357    0.197994    0.626574    0.638539    1.030077    0.073293    0.072785    0.287072    0.298408    0.626574    0.638539    0.240705    0.222789    3800        38.287154   1.041617    0.251924    152.978673 
[37m[36mINFO[0m[0m 01/26 19:12:58 | 0.206664    0.206479    0.647355    0.652393    1.009969    0.070393    0.069620    0.314418    0.331279    0.647355    0.652393    0.235182    0.218537    4000        40.302267   1.017561    0.237718    153.200932 
[37m[36mINFO[0m[0m 01/26 19:16:20 | 0.170311    0.173059    0.629408    0.630982    1.004149    0.044292    0.045359    0.240596    0.257833    0.629408    0.630982    0.226046    0.215986    4200        42.317380   0.968383    0.236054    154.774889 
[37m[36mINFO[0m[0m 01/26 19:19:39 | 0.233163    0.237140    0.677582    0.654912    0.960792    0.110994    0.121308    0.334831    0.355419    0.677582    0.654912    0.253665    0.234694    4400        44.332494   0.929697    0.229484    152.783682 
[37m[36mINFO[0m[0m 01/26 19:23:01 | 0.226705    0.228639    0.678526    0.676322    0.922701    0.122594    0.128692    0.304917    0.319979    0.678526    0.676322    0.252603    0.237245    4600        46.347607   0.921818    0.237219    154.760595 
[37m[36mINFO[0m[0m 01/26 19:26:26 | 0.222469    0.223928    0.672544    0.681360    0.920580    0.121803    0.130802    0.296187    0.307139    0.672544    0.681360    0.249416    0.233844    4800        48.362720   0.911548    0.238959    156.669689 
[37m[36mINFO[0m[0m 01/26 19:29:51 | 0.283124    0.286895    0.701826    0.663728    0.915814    0.176114    0.184599    0.399409    0.420134    0.701826    0.663728    0.273847    0.255952    5000        50.377834   0.879171    0.248049    155.910330 
[37m[36mINFO[0m[0m 01/26 19:29:52 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0, 1, 3]/250126_18-02-06_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/26 19:29:53 | ---
[37m[36mINFO[0m[0m 01/26 19:29:53 | test-domain validation(oracle) = 28.312%
[37m[36mINFO[0m[0m 01/26 19:29:53 | training-domain validation(iid) = 22.247%
[37m[36mINFO[0m[0m 01/26 19:29:53 | last = 28.312%
[37m[36mINFO[0m[0m 01/26 19:29:53 | last (inD) = 66.373%
[37m[36mINFO[0m[0m 01/26 19:29:53 | training-domain validation (iid, inD) = 68.136%
[37m[36mINFO[0m[0m 01/26 19:29:53 | === Summary ===
[37m[36mINFO[0m[0m 01/26 19:29:53 | Command: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm ERM --test_envs 0 1 3 --dataset TerraIncognita
[37m[36mINFO[0m[0m 01/26 19:29:53 | Unique name: 250126_18-02-06_resnet50_sgd
[37m[36mINFO[0m[0m 01/26 19:29:53 | Out path: train_output/TerraIncognita/ERM/[0, 1, 3]/250126_18-02-06_resnet50_sgd
[37m[36mINFO[0m[0m 01/26 19:29:53 | Algorithm: ERM
[37m[36mINFO[0m[0m 01/26 19:29:53 | Dataset: TerraIncognita

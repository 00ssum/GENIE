[37m[36mINFO[0m[0m 03/25 10:11:19 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 0 --hparams_seed 15
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 15
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[0, 1, 2]/250325_10-11-19_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 0
	unique_name: 250325_10-11-19_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 0.00010661763546249327
	batch_size: 14
	weight_decay: 9.086452814323981e-06
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/25 10:11:19 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 10:11:19 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 10:11:19 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 10:11:19 | 
[37m[36mINFO[0m[0m 03/25 10:11:19 | Testenv name escaping te_L100_L38_L43 -> te_L100_L38_L43
[37m[36mINFO[0m[0m 03/25 10:11:19 | Test envs = [0, 1, 2], name = te_L100_L38_L43
[37m[36mINFO[0m[0m 03/25 10:11:19 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 03/25 10:11:19 | Batch sizes for each domain: [0, 0, 0, 14] (total=14)
[37m[36mINFO[0m[0m 03/25 10:11:19 | steps-per-epoch for each domain: 336.21 -> min = 336.21
[37m[36mINFO[0m[0m 03/25 10:11:20 | # of params = 23528522
[37m[36mINFO[0m[0m 03/25 10:13:52 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 10:13:52 | 0.280848    0.303925    0.222647    0.210034    2.165777    0.200633    0.208861    0.455514    0.481253    0.186398    0.221662    0.222647    0.210034    0           0.000000    2.650235    1.087861    151.174160 
[37m[36mINFO[0m[0m 03/25 10:16:50 | 0.162107    0.172681    0.441895    0.460034    1.454296    0.226470    0.234177    0.024650    0.025681    0.235202    0.258186    0.441895    0.460034    200         0.594859    1.651552    0.144944    148.518340 
[37m[36mINFO[0m[0m 03/25 10:19:50 | 0.228115    0.251416    0.473550    0.487245    1.371781    0.223306    0.231013    0.136731    0.147920    0.324307    0.375315    0.473550    0.487245    400         1.189717    1.503714    0.136900    152.364791 
[37m[36mINFO[0m[0m 03/25 10:22:44 | 0.328670    0.360031    0.470363    0.477891    1.375931    0.228315    0.237342    0.451021    0.469954    0.306675    0.372796    0.470363    0.477891    600         1.784576    1.436403    0.137297    147.274963 
[37m[36mINFO[0m[0m 03/25 10:25:41 | 0.268151    0.290666    0.466539    0.499150    1.297715    0.421830    0.456751    0.079728    0.099127    0.302897    0.316121    0.466539    0.499150    800         2.379435    1.382453    0.137340    149.028711 
[37m[36mINFO[0m[0m 03/25 10:28:41 | 0.349702    0.362580    0.604207    0.639456    1.008848    0.491432    0.515823    0.175119    0.177709    0.382557    0.394207    0.604207    0.639456    1000        2.974294    1.208581    0.174381    145.482802 
[37m[36mINFO[0m[0m 03/25 10:31:57 | 0.432789    0.455418    0.629913    0.650510    0.981885    0.391511    0.413502    0.463217    0.479199    0.443640    0.473552    0.629913    0.650510    1200        3.569152    1.119779    0.218161    151.833779 
[37m[36mINFO[0m[0m 03/25 10:35:07 | 0.357437    0.367383    0.670066    0.653912    0.945583    0.303454    0.316456    0.302863    0.318439    0.465995    0.467254    0.670066    0.653912    1400        4.164011    1.072361    0.213095    147.720459 
[37m[36mINFO[0m[0m 03/25 10:38:12 | 0.321754    0.332704    0.657744    0.666667    0.969266    0.435803    0.450422    0.151624    0.162301    0.377834    0.385390    0.657744    0.666667    1600        4.758870    0.966520    0.194584    146.029758 
[37m[36mINFO[0m[0m 03/25 10:41:14 | 0.414679    0.422566    0.715743    0.730442    0.738620    0.431848    0.449367    0.352805    0.352337    0.459383    0.465995    0.715743    0.730442    1800        5.353728    0.915304    0.165934    148.411845 
[37m[36mINFO[0m[0m 03/25 10:44:17 | 0.333033    0.342933    0.659231    0.693027    0.885696    0.346955    0.347046    0.241880    0.257319    0.410264    0.424433    0.659231    0.693027    2000        5.948587    0.918522    0.166569    150.307943 
[37m[36mINFO[0m[0m 03/25 10:47:23 | 0.303931    0.306800    0.665817    0.705782    0.848451    0.257580    0.268987    0.234818    0.238315    0.419395    0.413098    0.665817    0.705782    2200        6.543446    0.959293    0.169182    152.226229 
[37m[36mINFO[0m[0m 03/25 10:50:27 | 0.268395    0.281770    0.659018    0.698129    0.815430    0.287635    0.295359    0.134677    0.135593    0.382872    0.414358    0.659018    0.698129    2400        7.138305    0.836246    0.167009    150.025026 
[37m[36mINFO[0m[0m 03/25 10:53:27 | 0.413055    0.422478    0.722753    0.731293    0.732276    0.501714    0.527426    0.287200    0.300462    0.450252    0.439547    0.722753    0.731293    2600        7.733163    0.822444    0.164010    147.756608 
[37m[36mINFO[0m[0m 03/25 10:56:28 | 0.370046    0.378483    0.722328    0.731293    0.716054    0.355919    0.369198    0.324432    0.329224    0.429786    0.437028    0.722328    0.731293    2800        8.328022    0.810786    0.163126    147.904723 
[37m[36mINFO[0m[0m 03/25 10:59:30 | 0.335685    0.346876    0.722328    0.725340    0.722696    0.195096    0.210970    0.383746    0.391371    0.428212    0.438287    0.722328    0.725340    3000        8.922881    0.759143    0.165556    148.712471 
[37m[36mINFO[0m[0m 03/25 11:02:37 | 0.368400    0.380215    0.733376    0.747449    0.737363    0.288690    0.310127    0.305174    0.317925    0.511335    0.512594    0.733376    0.747449    3200        9.517740    0.741611    0.197888    147.958644 
[37m[36mINFO[0m[0m 03/25 11:05:51 | 0.346598    0.346819    0.747822    0.728741    0.771057    0.225152    0.236287    0.319682    0.323061    0.494962    0.481108    0.747822    0.728741    3400        10.112598   0.743905    0.216010    150.506202 
[37m[36mINFO[0m[0m 03/25 11:08:53 | 0.423910    0.445120    0.765881    0.760204    0.706432    0.390192    0.399789    0.350366    0.371341    0.531171    0.564232    0.765881    0.760204    3600        10.707457   0.661563    0.183385    145.711922 
[37m[36mINFO[0m[0m 03/25 11:12:06 | 0.392524    0.396930    0.767155    0.773810    0.667813    0.408648    0.425105    0.269868    0.273241    0.499055    0.492443    0.767155    0.773810    3800        11.302316   0.733756    0.216947    149.401893 
[37m[36mINFO[0m[0m 03/25 11:15:14 | 0.351814    0.353385    0.760994    0.780612    0.645883    0.271817    0.283755    0.294646    0.306626    0.488980    0.469773    0.760994    0.780612    4000        11.897174   0.665964    0.191727    149.532405 
[37m[36mINFO[0m[0m 03/25 11:18:20 | 0.376770    0.385980    0.766306    0.765306    0.669299    0.385974    0.407173    0.265117    0.283513    0.479219    0.467254    0.766306    0.765306    4200        12.492033   0.712154    0.163013    153.008440 
[37m[36mINFO[0m[0m 03/25 11:21:18 | 0.377051    0.393167    0.754196    0.763605    0.699924    0.301345    0.315401    0.338940    0.361582    0.490869    0.502519    0.754196    0.763605    4400        13.086892   0.721305    0.152331    147.974207 
[37m[36mINFO[0m[0m 03/25 11:24:16 | 0.413081    0.432347    0.803484    0.794218    0.583140    0.341155    0.359705    0.382976    0.410889    0.515113    0.526448    0.803484    0.794218    4600        13.681751   0.670316    0.146364    148.986144 
[37m[36mINFO[0m[0m 03/25 11:27:10 | 0.355917    0.371253    0.786063    0.784014    0.592475    0.248352    0.275316    0.301451    0.310734    0.517947    0.527708    0.786063    0.784014    4800        14.276609   0.627565    0.147891    144.097703 
[37m[36mINFO[0m[0m 03/25 11:30:06 | 0.339183    0.356211    0.798598    0.799320    0.585244    0.238070    0.258439    0.271922    0.282486    0.507557    0.527708    0.798598    0.799320    5000        14.871468   0.607058    0.152047    145.938105 
[37m[36mINFO[0m[0m 03/25 11:30:06 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0, 1, 2]/250325_10-11-19_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 11:30:08 | ---
[37m[36mINFO[0m[0m 03/25 11:30:08 | test-domain validation(oracle) = 43.279%
[37m[36mINFO[0m[0m 03/25 11:30:08 | training-domain validation(iid) = 33.918%
[37m[36mINFO[0m[0m 03/25 11:30:08 | last = 33.918%
[37m[36mINFO[0m[0m 03/25 11:30:08 | last (inD) = 79.932%
[37m[36mINFO[0m[0m 03/25 11:30:08 | training-domain validation (iid, inD) = 79.932%
[37m[36mINFO[0m[0m 03/25 11:30:08 | === Summary ===
[37m[36mINFO[0m[0m 03/25 11:30:08 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 0 --hparams_seed 15
[37m[36mINFO[0m[0m 03/25 11:30:08 | Unique name: 250325_10-11-19_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 11:30:08 | Out path: train_output/TerraIncognita/ERM/[0, 1, 2]/250325_10-11-19_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 11:30:08 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 11:30:08 | Dataset: TerraIncognita

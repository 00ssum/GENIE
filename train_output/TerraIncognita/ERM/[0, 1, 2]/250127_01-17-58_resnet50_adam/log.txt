[37m[36mINFO[0m[0m 01/27 01:17:58 | Command :: /jsm0707/Large-scale/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm ERM --test_envs 0 1 2 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_adam.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_adam
	out_dir: train_output/TerraIncognita/ERM/[0, 1, 2]/250127_01-17-58_resnet50_adam
	out_root: train_output/TerraIncognita/ERM/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 0
	unique_name: 250127_01-17-58_resnet50_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/27 01:17:58 | n_steps = 5001
[37m[36mINFO[0m[0m 01/27 01:17:58 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/27 01:17:58 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/27 01:17:58 | 
[37m[36mINFO[0m[0m 01/27 01:17:58 | Testenv name escaping te_L100_L38_L43 -> te_L100_L38_L43
[37m[36mINFO[0m[0m 01/27 01:17:58 | Test envs = [0, 1, 2], name = te_L100_L38_L43
[37m[36mINFO[0m[0m 01/27 01:17:58 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 01/27 01:17:58 | Batch sizes for each domain: [0, 0, 0, 32] (total=32)
[37m[36mINFO[0m[0m 01/27 01:17:58 | steps-per-epoch for each domain: 147.09 -> min = 147.09
[37m[36mINFO[0m[0m 01/27 01:17:59 | # of params = 23528522
[37m[36mINFO[0m[0m 01/27 01:20:40 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/27 01:20:40 | 0.280953    0.303925    0.225197    0.212585    2.242604    0.200633    0.208861    0.455514    0.481253    0.186713    0.221662    0.225197    0.212585    0           0.000000    2.490531    1.306627    159.664998 
[37m[36mINFO[0m[0m 01/27 01:24:00 | 0.335173    0.343470    0.650733    0.640306    0.981120    0.344055    0.358650    0.245218    0.248588    0.416247    0.423174    0.650733    0.640306    200         1.359677    1.249561    0.223852    154.731402 
[37m[36mINFO[0m[0m 01/27 01:27:21 | 0.348370    0.344504    0.729552    0.733844    0.805043    0.279726    0.320675    0.288997    0.275809    0.476385    0.437028    0.729552    0.733844    400         2.719354    0.819476    0.224696    155.602455 
[37m[36mINFO[0m[0m 01/27 01:30:33 | 0.301815    0.296079    0.762481    0.771259    0.659362    0.155550    0.163502    0.276030    0.278891    0.473866    0.445844    0.762481    0.771259    600         4.079031    0.722931    0.219430    148.347589 
[37m[36mINFO[0m[0m 01/27 01:33:58 | 0.466308    0.487450    0.784789    0.792517    0.637606    0.477458    0.486287    0.390294    0.420647    0.531171    0.555416    0.784789    0.792517    800         5.438708    0.636227    0.230868    158.203733 
[37m[36mINFO[0m[0m 01/27 01:37:30 | 0.461933    0.486302    0.801572    0.805272    0.562996    0.506723    0.537975    0.306971    0.330252    0.572103    0.590680    0.801572    0.805272    1000        6.798385    0.568120    0.218945    167.353839 
[37m[36mINFO[0m[0m 01/27 01:40:50 | 0.487634    0.500180    0.809645    0.795068    0.650274    0.496968    0.530591    0.407369    0.417052    0.558564    0.552897    0.809645    0.795068    1200        8.158062    0.552695    0.221200    155.927851 
[37m[36mINFO[0m[0m 01/27 01:44:07 | 0.425320    0.434838    0.832802    0.826531    0.488539    0.400475    0.417722    0.336757    0.336415    0.538728    0.550378    0.832802    0.826531    1400        9.517740    0.483191    0.226345    151.616447 
[37m[36mINFO[0m[0m 01/27 01:47:22 | 0.457358    0.457937    0.841513    0.832483    0.497675    0.475086    0.473629    0.321736    0.338469    0.575252    0.561713    0.841513    0.832483    1600        10.877417   0.479054    0.227922    149.737082 
[37m[36mINFO[0m[0m 01/27 01:50:35 | 0.475683    0.491100    0.850648    0.835884    0.490649    0.504086    0.540084    0.369752    0.392912    0.553212    0.540302    0.850648    0.835884    1800        12.237094   0.464405    0.218823    149.064018 
[37m[36mINFO[0m[0m 01/27 01:53:57 | 0.449493    0.465827    0.851073    0.829932    0.496070    0.359083    0.382911    0.419181    0.445300    0.570214    0.569270    0.851073    0.829932    2000        13.596771   0.438910    0.223766    157.349062 
[37m[36mINFO[0m[0m 01/27 01:57:20 | 0.419349    0.436339    0.867219    0.834184    0.498503    0.360137    0.390295    0.337142    0.359527    0.560768    0.559194    0.867219    0.834184    2200        14.956448   0.412704    0.221899    157.677112 
[37m[36mINFO[0m[0m 01/27 02:00:44 | 0.360756    0.368164    0.845549    0.815476    0.581758    0.351173    0.373418    0.217871    0.228557    0.513224    0.502519    0.845549    0.815476    2400        16.316125   0.381807    0.223481    159.704458 
[37m[36mINFO[0m[0m 01/27 02:04:00 | 0.374521    0.368573    0.835352    0.816327    0.573017    0.392829    0.402954    0.192323    0.183873    0.538413    0.518892    0.835352    0.816327    2600        17.675802   0.375891    0.217938    152.100498 
[37m[36mINFO[0m[0m 01/27 02:07:13 | 0.490562    0.505725    0.873168    0.842687    0.526940    0.507514    0.528481    0.394274    0.409348    0.569899    0.579345    0.873168    0.842687    2800        19.035479   0.360972    0.223450    148.721350 
[37m[36mINFO[0m[0m 01/27 02:10:39 | 0.414180    0.439812    0.877842    0.847789    0.465102    0.323491    0.366034    0.359225    0.381613    0.559824    0.571788    0.877842    0.847789    3000        20.395156   0.350723    0.225117    160.768535 
[37m[36mINFO[0m[0m 01/27 02:13:56 | 0.419553    0.432492    0.880178    0.857993    0.442938    0.307145    0.334388    0.400822    0.413970    0.550693    0.549118    0.880178    0.857993    3200        21.754833   0.348573    0.221330    152.796056 
[37m[36mINFO[0m[0m 01/27 02:17:16 | 0.394640    0.398933    0.895050    0.858844    0.441395    0.380965    0.396624    0.248170    0.246020    0.554786    0.554156    0.895050    0.858844    3400        23.114510   0.326510    0.219536    156.242829 
[37m[36mINFO[0m[0m 01/27 02:20:38 | 0.379459    0.385714    0.892076    0.852891    0.485187    0.414975    0.444093    0.194120    0.208012    0.529282    0.505038    0.892076    0.852891    3600        24.474187   0.312528    0.226271    156.500129 
[37m[36mINFO[0m[0m 01/27 02:23:50 | 0.491765    0.498911    0.885277    0.852041    0.451403    0.513050    0.542194    0.402106    0.401644    0.560139    0.552897    0.885277    0.852041    3800        25.833864   0.300628    0.221533    147.378771 
[37m[36mINFO[0m[0m 01/27 02:27:04 | 0.447677    0.456441    0.898874    0.867347    0.403495    0.358819    0.369198    0.385030    0.414484    0.599181    0.585642    0.898874    0.867347    4000        27.193542   0.296408    0.227884    149.013656 
[37m[36mINFO[0m[0m 01/27 02:30:25 | 0.390350    0.403333    0.900361    0.863095    0.446239    0.280517    0.309072    0.330081    0.337956    0.560453    0.562972    0.900361    0.863095    4200        28.553219   0.276679    0.224053    155.374815 
[37m[36mINFO[0m[0m 01/27 02:33:39 | 0.497603    0.509712    0.888676    0.856293    0.498322    0.518323    0.513713    0.383490    0.410889    0.590995    0.604534    0.888676    0.856293    4400        29.912896   0.287733    0.217941    150.471751 
[37m[36mINFO[0m[0m 01/27 02:37:03 | 0.473172    0.484520    0.901423    0.869898    0.416825    0.437385    0.459916    0.394916    0.418079    0.587217    0.575567    0.901423    0.869898    4600        31.272573   0.279999    0.226638    158.166778 
[37m[36mINFO[0m[0m 01/27 02:40:27 | 0.393559    0.407759    0.903123    0.848639    0.524078    0.289217    0.308017    0.335730    0.349769    0.555730    0.565491    0.903123    0.848639    4800        32.632250   0.261675    0.223680    160.024774 
[37m[36mINFO[0m[0m 01/27 02:43:55 | 0.386222    0.395909    0.912258    0.881803    0.387471    0.168205    0.184599    0.465272    0.479199    0.525189    0.523929    0.912258    0.881803    5000        33.991927   0.271789    0.224562    162.288106 
[37m[36mINFO[0m[0m 01/27 02:43:55 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0, 1, 2]/250127_01-17-58_resnet50_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/27 02:43:56 | ---
[37m[36mINFO[0m[0m 01/27 02:43:56 | test-domain validation(oracle) = 49.760%
[37m[36mINFO[0m[0m 01/27 02:43:56 | training-domain validation(iid) = 38.622%
[37m[36mINFO[0m[0m 01/27 02:43:56 | last = 38.622%
[37m[36mINFO[0m[0m 01/27 02:43:56 | last (inD) = 88.180%
[37m[36mINFO[0m[0m 01/27 02:43:56 | training-domain validation (iid, inD) = 88.180%
[37m[36mINFO[0m[0m 01/27 02:43:56 | === Summary ===
[37m[36mINFO[0m[0m 01/27 02:43:56 | Command: /jsm0707/Large-scale/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm ERM --test_envs 0 1 2 --dataset TerraIncognita
[37m[36mINFO[0m[0m 01/27 02:43:56 | Unique name: 250127_01-17-58_resnet50_adam
[37m[36mINFO[0m[0m 01/27 02:43:56 | Out path: train_output/TerraIncognita/ERM/[0, 1, 2]/250127_01-17-58_resnet50_adam
[37m[36mINFO[0m[0m 01/27 02:43:56 | Algorithm: ERM
[37m[36mINFO[0m[0m 01/27 02:43:56 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 03/25 01:03:16 | Command :: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 0 --hparams_seed 8
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: ERM
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_Sign_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 8
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_Sign_GENIE
	out_dir: train_output/TerraIncognita/ERM/[0, 1, 2]/250325_01-03-16_resnet50_Sign_GENIE
	out_root: train_output/TerraIncognita/ERM/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 0
	unique_name: 250325_01-03-16_resnet50_Sign_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: sign_genie
	freeze_bn: False
	pretrained: True
	lr: 2.9932388835350315e-05
	batch_size: 16
	weight_decay: 0.0025315391809104006
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/25 01:03:16 | n_steps = 5001
[37m[36mINFO[0m[0m 03/25 01:03:16 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/25 01:03:16 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/25 01:03:16 | 
[37m[36mINFO[0m[0m 03/25 01:03:16 | Testenv name escaping te_L100_L38_L43 -> te_L100_L38_L43
[37m[36mINFO[0m[0m 03/25 01:03:16 | Test envs = [0, 1, 2], name = te_L100_L38_L43
[37m[36mINFO[0m[0m 03/25 01:03:16 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 03/25 01:03:16 | Batch sizes for each domain: [0, 0, 0, 16] (total=16)
[37m[36mINFO[0m[0m 03/25 01:03:16 | steps-per-epoch for each domain: 294.19 -> min = 294.19
[37m[36mINFO[0m[0m 03/25 01:03:17 | # of params = 23528522
[37m[36mINFO[0m[0m 03/25 01:05:51 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/25 01:05:51 | 0.280848    0.303925    0.222222    0.210034    2.176327    0.200633    0.208861    0.455514    0.481253    0.186398    0.221662    0.222222    0.210034    0           0.000000    2.541629    1.490908    152.943866 
[37m[36mINFO[0m[0m 03/25 01:08:51 | 0.162005    0.174338    0.420863    0.436224    1.521258    0.191142    0.199367    0.054949    0.064201    0.239924    0.259446    0.420863    0.436224    200         0.679839    1.555802    0.139610    151.833622 
[37m[36mINFO[0m[0m 03/25 01:11:48 | 0.128002    0.140412    0.449968    0.481293    1.418044    0.042710    0.069620    0.078701    0.090909    0.262594    0.260705    0.449968    0.481293    400         1.359677    1.453576    0.132238    150.419622 
[37m[36mINFO[0m[0m 03/25 01:14:46 | 0.329464    0.355258    0.469938    0.482993    1.386930    0.224888    0.234177    0.438567    0.466359    0.324937    0.365239    0.469938    0.482993    600         2.039516    1.419669    0.138598    150.193354 
[37m[36mINFO[0m[0m 03/25 01:17:47 | 0.331896    0.358167    0.487784    0.486395    1.331670    0.222515    0.233122    0.427141    0.450950    0.346033    0.390428    0.487784    0.486395    800         2.719354    1.386763    0.148670    151.059869 
[37m[36mINFO[0m[0m 03/25 01:20:54 | 0.334518    0.353255    0.500319    0.497449    1.288159    0.209597    0.220464    0.443831    0.474063    0.350126    0.365239    0.500319    0.497449    1000        3.399193    1.343654    0.177502    151.936127 
[37m[36mINFO[0m[0m 03/25 01:23:56 | 0.301543    0.296265    0.595709    0.606293    1.070096    0.254152    0.252110    0.296572    0.297894    0.353904    0.338791    0.595709    0.606293    1200        4.079031    1.210089    0.147535    152.309573 
[37m[36mINFO[0m[0m 03/25 01:26:55 | 0.324928    0.336399    0.641173    0.636905    0.973766    0.193251    0.212025    0.396457    0.418079    0.385076    0.379093    0.641173    0.636905    1400        4.758870    1.102741    0.135104    152.455997 
[37m[36mINFO[0m[0m 03/25 01:30:01 | 0.357062    0.373795    0.665604    0.688776    0.902019    0.303717    0.313291    0.329182    0.330765    0.438287    0.477330    0.665604    0.688776    1600        5.438708    1.064835    0.142919    157.613136 
[37m[36mINFO[0m[0m 03/25 01:32:56 | 0.287710    0.307220    0.691736    0.696429    0.845052    0.202215    0.229958    0.216331    0.224448    0.444584    0.467254    0.691736    0.696429    1800        6.118547    0.960645    0.132796    148.074891 
[37m[36mINFO[0m[0m 03/25 01:35:59 | 0.323801    0.330273    0.702996    0.715136    0.771831    0.257843    0.251055    0.275902    0.287622    0.437657    0.452141    0.702996    0.715136    2000        6.798385    0.907188    0.156386    151.467202 
[37m[36mINFO[0m[0m 03/25 01:39:05 | 0.365961    0.375494    0.683663    0.715136    0.835707    0.544951    0.564346    0.190525    0.193118    0.362406    0.369018    0.683663    0.715136    2200        7.478224    0.860107    0.175668    150.891231 
[37m[36mINFO[0m[0m 03/25 01:42:10 | 0.309552    0.314072    0.725728    0.740646    0.726364    0.166886    0.176160    0.304275    0.318952    0.457494    0.447103    0.725728    0.740646    2400        8.158062    0.804838    0.183709    148.813041 
[37m[36mINFO[0m[0m 03/25 01:45:15 | 0.400374    0.414927    0.738687    0.742347    0.741988    0.397574    0.412447    0.338811    0.360041    0.464736    0.472292    0.738687    0.742347    2600        8.837901    0.788650    0.174834    149.408491 
[37m[36mINFO[0m[0m 03/25 01:48:23 | 0.387506    0.412234    0.724665    0.738095    0.745293    0.354337    0.374473    0.330851    0.355932    0.477330    0.506297    0.724665    0.738095    2800        9.517740    0.777003    0.148935    158.698692 
[37m[36mINFO[0m[0m 03/25 01:51:24 | 0.387195    0.406008    0.716380    0.734694    0.803205    0.277353    0.287975    0.379510    0.398562    0.504723    0.531486    0.716380    0.734694    3000        10.197578   0.750407    0.139198    153.320010 
[37m[36mINFO[0m[0m 03/25 01:54:27 | 0.406408    0.414192    0.751009    0.755952    0.694407    0.407066    0.415612    0.344589    0.355932    0.467569    0.471033    0.751009    0.755952    3200        10.877417   0.707779    0.130309    156.116896 
[37m[36mINFO[0m[0m 03/25 01:57:31 | 0.345851    0.346633    0.720841    0.726190    0.814347    0.331136    0.335443    0.337399    0.337956    0.369018    0.366499    0.720841    0.726190    3400        11.557255   0.658584    0.138739    156.773319 
[37m[36mINFO[0m[0m 03/25 02:00:28 | 0.423249    0.440644    0.766093    0.759354    0.667142    0.450040    0.462025    0.350879    0.366204    0.468829    0.493703    0.766093    0.759354    3600        12.237094   0.655221    0.140150    148.447446 
[37m[36mINFO[0m[0m 03/25 02:03:26 | 0.437688    0.440806    0.755046    0.764456    0.659027    0.426575    0.436709    0.359096    0.371854    0.527393    0.513854    0.755046    0.764456    3800        12.916932   0.674059    0.137501    150.669563 
[37m[36mINFO[0m[0m 03/25 02:06:22 | 0.395525    0.413555    0.783514    0.770408    0.628963    0.237806    0.242616    0.422005    0.437596    0.526763    0.560453    0.783514    0.770408    4000        13.596771   0.615734    0.132864    149.638535 
[37m[36mINFO[0m[0m 03/25 02:09:24 | 0.456406    0.464342    0.789463    0.797619    0.601007    0.463222    0.468354    0.424573    0.433487    0.481423    0.491184    0.789463    0.797619    4200        14.276609   0.633896    0.146794    152.683455 
[37m[36mINFO[0m[0m 03/25 02:12:22 | 0.350901    0.376993    0.792437    0.789116    0.561190    0.286844    0.308017    0.300809    0.317925    0.465050    0.505038    0.792437    0.789116    4400        14.956448   0.657007    0.139470    150.159421 
[37m[36mINFO[0m[0m 03/25 02:15:26 | 0.374728    0.387021    0.788613    0.789966    0.602475    0.429739    0.443038    0.178072    0.191577    0.516373    0.526448    0.788613    0.789966    4600        15.636286   0.581387    0.151524    153.033737 
[37m[36mINFO[0m[0m 03/25 02:18:20 | 0.379195    0.393974    0.787975    0.793367    0.602258    0.347482    0.347046    0.300809    0.334874    0.489295    0.500000    0.787975    0.793367    4800        16.316125   0.609781    0.151164    144.411383 
[37m[36mINFO[0m[0m 03/25 02:21:24 | 0.381885    0.410329    0.783301    0.776361    0.611005    0.205378    0.220464    0.432405    0.457627    0.507872    0.552897    0.783301    0.776361    5000        16.995963   0.620012    0.152298    153.371088 
[37m[36mINFO[0m[0m 03/25 02:21:24 | Cumulative gradient change saved at train_output/TerraIncognita/ERM/[0, 1, 2]/250325_01-03-16_resnet50_Sign_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/25 02:21:25 | ---
[37m[36mINFO[0m[0m 03/25 02:21:25 | test-domain validation(oracle) = 45.641%
[37m[36mINFO[0m[0m 03/25 02:21:25 | training-domain validation(iid) = 45.641%
[37m[36mINFO[0m[0m 03/25 02:21:25 | last = 38.188%
[37m[36mINFO[0m[0m 03/25 02:21:25 | last (inD) = 77.636%
[37m[36mINFO[0m[0m 03/25 02:21:25 | training-domain validation (iid, inD) = 79.762%
[37m[36mINFO[0m[0m 03/25 02:21:25 | === Summary ===
[37m[36mINFO[0m[0m 03/25 02:21:25 | Command: /jsm0707/GENIE/train_all.py resnet50_Sign_GENIE config/resnet50_Sign_GENIE.yaml --algorithm ERM --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 0 --hparams_seed 8
[37m[36mINFO[0m[0m 03/25 02:21:25 | Unique name: 250325_01-03-16_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 02:21:25 | Out path: train_output/TerraIncognita/ERM/[0, 1, 2]/250325_01-03-16_resnet50_Sign_GENIE
[37m[36mINFO[0m[0m 03/25 02:21:25 | Algorithm: ERM
[37m[36mINFO[0m[0m 03/25 02:21:25 | Dataset: TerraIncognita

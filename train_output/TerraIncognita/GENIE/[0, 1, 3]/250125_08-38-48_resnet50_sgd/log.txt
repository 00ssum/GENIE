[37m[36mINFO[0m[0m 01/25 08:38:48 | Command :: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 0 1 3 --dataset TerraIncognita --trial_seed 0 --hparams_seed 15
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 15
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/TerraIncognita/GENIE/[0, 1, 3]/250125_08-38-48_resnet50_sgd
	out_root: train_output/TerraIncognita/GENIE/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 0
	unique_name: 250125_08-38-48_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 0.00010661763546249327
	batch_size: 14
	weight_decay: 9.086452814323981e-06
	momentum: 0.846320346520143
	convergence_rate: 0.001625681705546367
	moving_avg: 0.9229441284737897
	p: 0.5950371143099659
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/25 08:38:48 | n_steps = 5001
[37m[36mINFO[0m[0m 01/25 08:38:48 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/25 08:38:48 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/25 08:38:48 | 
[37m[36mINFO[0m[0m 01/25 08:38:48 | Testenv name escaping te_L100_L38_L46 -> te_L100_L38_L46
[37m[36mINFO[0m[0m 01/25 08:38:48 | Test envs = [0, 1, 3], name = te_L100_L38_L46
[37m[36mINFO[0m[0m 01/25 08:38:48 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 01/25 08:38:48 | Batch sizes for each domain: [0, 0, 14, 0] (total=14)
[37m[36mINFO[0m[0m 01/25 08:38:48 | steps-per-epoch for each domain: 226.86 -> min = 226.86
[37m[36mINFO[0m[0m 01/25 08:38:49 | # of params = 23528522
[37m[36mINFO[0m[0m 01/25 08:41:27 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/25 08:41:27 | 0.078782    0.080764    0.156171    0.161209    2.274312    0.066965    0.059072    0.097574    0.110940    0.156171    0.161209    0.071808    0.072279    0           0.000000    2.526581    1.191368    156.909669 
[37m[36mINFO[0m[0m 01/25 08:44:39 | 0.113482    0.115182    0.427897    0.406801    1.467075    0.009755    0.018987    0.141610    0.158192    0.427897    0.406801    0.189080    0.168367    200         0.881612    1.636789    0.197129    151.449039 
[37m[36mINFO[0m[0m 01/25 08:47:56 | 0.217224    0.215874    0.552267    0.569270    1.226658    0.019510    0.029536    0.404416    0.419106    0.552267    0.569270    0.227746    0.198980    400         1.763224    1.428341    0.178508    161.491369 
[37m[36mINFO[0m[0m 01/25 08:51:06 | 0.212693    0.214035    0.606738    0.610831    1.092703    0.023201    0.032700    0.399666    0.418079    0.606738    0.610831    0.215211    0.191327    600         2.644836    1.233994    0.152270    158.868661 
[37m[36mINFO[0m[0m 01/25 08:54:05 | 0.392512    0.392924    0.663728    0.666247    0.955504    0.456367    0.445148    0.403133    0.428351    0.663728    0.666247    0.318037    0.305272    800         3.526448    1.029603    0.144910    149.686673 
[37m[36mINFO[0m[0m 01/25 08:57:04 | 0.330560    0.339195    0.696788    0.698992    0.858033    0.357764    0.361814    0.298883    0.331793    0.696788    0.698992    0.335033    0.323980    1000        4.408060    0.922394    0.144170    149.946754 
[37m[36mINFO[0m[0m 01/25 09:00:01 | 0.310992    0.330968    0.709698    0.721662    0.837237    0.275244    0.302743    0.349467    0.388290    0.709698    0.721662    0.308264    0.301871    1200        5.289673    0.842556    0.148314    147.493276 
[37m[36mINFO[0m[0m 01/25 09:03:11 | 0.393037    0.399673    0.738980    0.748111    0.682126    0.512523    0.498945    0.310309    0.344633    0.738980    0.748111    0.356278    0.355442    1400        6.171285    0.808251    0.151261    159.416798 
[37m[36mINFO[0m[0m 01/25 09:06:27 | 0.383701    0.396647    0.755982    0.755668    0.675222    0.416030    0.428270    0.321222    0.349255    0.755982    0.755668    0.413852    0.412415    1600        7.052897    0.728058    0.193953    156.575504 
[37m[36mINFO[0m[0m 01/25 09:09:36 | 0.424146    0.428804    0.757557    0.778338    0.627963    0.468495    0.471519    0.373732    0.399076    0.757557    0.778338    0.430210    0.415816    1800        7.934509    0.718762    0.205220    148.081932 
[37m[36mINFO[0m[0m 01/25 09:12:37 | 0.430207    0.440752    0.784320    0.812343    0.555888    0.511468    0.524262    0.371036    0.389831    0.784320    0.812343    0.408116    0.408163    2000        8.816121    0.645805    0.156749    149.128381 
[37m[36mINFO[0m[0m 01/25 09:15:38 | 0.404457    0.417053    0.789987    0.779597    0.593581    0.533878    0.547468    0.255232    0.274268    0.789987    0.779597    0.424262    0.429422    2200        9.697733    0.652338    0.143937    151.682194 
[37m[36mINFO[0m[0m 01/25 09:18:43 | 0.413745    0.427892    0.805730    0.804786    0.534259    0.491168    0.495781    0.296700    0.328711    0.805730    0.804786    0.453367    0.459184    2400        10.579345   0.623487    0.152561    154.631207 
[37m[36mINFO[0m[0m 01/25 09:21:45 | 0.413313    0.427526    0.804471    0.790932    0.558864    0.465067    0.468354    0.348697    0.375449    0.804471    0.790932    0.426174    0.438776    2600        11.460957   0.606821    0.145420    153.053404 
[37m[36mINFO[0m[0m 01/25 09:24:54 | 0.452668    0.461186    0.784320    0.787154    0.635341    0.518587    0.530591    0.426627    0.447355    0.784320    0.787154    0.412789    0.405612    2800        12.342569   0.531755    0.151339    158.544929 
[37m[36mINFO[0m[0m 01/25 09:27:50 | 0.414514    0.423299    0.801952    0.792191    0.583263    0.439230    0.450422    0.395558    0.423215    0.801952    0.792191    0.408753    0.396259    3000        13.224181   0.551457    0.141866    147.534577 
[37m[36mINFO[0m[0m 01/25 09:30:47 | 0.408103    0.415162    0.829345    0.814861    0.501764    0.403375    0.394515    0.397098    0.428351    0.829345    0.814861    0.423837    0.422619    3200        14.105793   0.523745    0.139661    148.872730 
[37m[36mINFO[0m[0m 01/25 09:33:42 | 0.411896    0.424337    0.816751    0.803526    0.534243    0.386238    0.405063    0.445372    0.475090    0.816751    0.803526    0.404079    0.392857    3400        14.987406   0.522609    0.142043    146.088119 
[37m[36mINFO[0m[0m 01/25 09:36:44 | 0.421787    0.430924    0.840680    0.827456    0.520100    0.426312    0.435654    0.404802    0.431947    0.840680    0.827456    0.434247    0.425170    3600        15.869018   0.477782    0.148844    152.099555 
[37m[36mINFO[0m[0m 01/25 09:39:38 | 0.401737    0.411538    0.826511    0.801008    0.547923    0.371737    0.381857    0.415586    0.441192    0.826511    0.801008    0.417888    0.411565    3800        16.750630   0.475769    0.141752    145.211926 
[37m[36mINFO[0m[0m 01/25 09:42:36 | 0.377903    0.385216    0.840995    0.817380    0.479872    0.353810    0.347046    0.368597    0.399589    0.840995    0.817380    0.411302    0.409014    4000        17.632242   0.427766    0.150960    147.652757 
[37m[36mINFO[0m[0m 01/25 09:45:31 | 0.422274    0.428345    0.835327    0.813602    0.516773    0.445821    0.445148    0.370394    0.398562    0.835327    0.813602    0.450605    0.441327    4200        18.513854   0.459528    0.149701    145.533335 
[37m[36mINFO[0m[0m 01/25 09:48:35 | 0.332090    0.341285    0.851700    0.813602    0.503532    0.313999    0.321730    0.263320    0.294813    0.851700    0.813602    0.418950    0.407313    4400        19.395466   0.430613    0.172395    149.446390 
[37m[36mINFO[0m[0m 01/25 09:51:37 | 0.411297    0.426791    0.838476    0.806045    0.533181    0.488532    0.506329    0.286044    0.317411    0.838476    0.806045    0.459316    0.456633    4600        20.277078   0.443695    0.175126    146.536469 
[37m[36mINFO[0m[0m 01/25 09:54:38 | 0.434622    0.441832    0.864924    0.842569    0.429221    0.471658    0.478903    0.410707    0.435028    0.864924    0.842569    0.421500    0.411565    4800        21.158690   0.424052    0.166931    148.187968 
[37m[36mINFO[0m[0m 01/25 09:57:37 | 0.415698    0.424401    0.858942    0.811083    0.510958    0.548906    0.554852    0.273077    0.305085    0.858942    0.811083    0.425112    0.413265    5000        22.040302   0.394441    0.155610    147.167077 
[37m[36mINFO[0m[0m 01/25 09:57:37 | Cumulative gradient change saved at train_output/TerraIncognita/GENIE/[0, 1, 3]/250125_08-38-48_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/25 09:57:38 | ---
[37m[36mINFO[0m[0m 01/25 09:57:38 | test-domain validation(oracle) = 45.267%
[37m[36mINFO[0m[0m 01/25 09:57:38 | training-domain validation(iid) = 43.462%
[37m[36mINFO[0m[0m 01/25 09:57:38 | last = 41.570%
[37m[36mINFO[0m[0m 01/25 09:57:38 | last (inD) = 81.108%
[37m[36mINFO[0m[0m 01/25 09:57:38 | training-domain validation (iid, inD) = 84.257%
[37m[36mINFO[0m[0m 01/25 09:57:39 | === Summary ===
[37m[36mINFO[0m[0m 01/25 09:57:39 | Command: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 0 1 3 --dataset TerraIncognita --trial_seed 0 --hparams_seed 15
[37m[36mINFO[0m[0m 01/25 09:57:39 | Unique name: 250125_08-38-48_resnet50_sgd
[37m[36mINFO[0m[0m 01/25 09:57:39 | Out path: train_output/TerraIncognita/GENIE/[0, 1, 3]/250125_08-38-48_resnet50_sgd
[37m[36mINFO[0m[0m 01/25 09:57:39 | Algorithm: GENIE
[37m[36mINFO[0m[0m 01/25 09:57:39 | Dataset: TerraIncognita

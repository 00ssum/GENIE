[37m[36mINFO[0m[0m 03/15 11:55:33 | Command :: /jsm0707/GENIE/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm GENIE --test_envs 0 2 3 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_adam.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_adam
	out_dir: train_output/TerraIncognita/GENIE/[0, 2, 3]/250315_11-55-33_resnet50_adam
	out_root: train_output/TerraIncognita/GENIE/[0, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 2, 3]
	trial_seed: 0
	unique_name: 250315_11-55-33_resnet50_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	momentum: 0.9
	convergence_rate: 0.015
	moving_avg: 0.95
	p: 0.4
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/15 11:55:33 | n_steps = 5001
[37m[36mINFO[0m[0m 03/15 11:55:33 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/15 11:55:33 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/15 11:55:33 | 
[37m[36mINFO[0m[0m 03/15 11:55:33 | Testenv name escaping te_L100_L43_L46 -> te_L100_L43_L46
[37m[36mINFO[0m[0m 03/15 11:55:33 | Test envs = [0, 2, 3], name = te_L100_L43_L46
[37m[36mINFO[0m[0m 03/15 11:55:33 | Train environments: [1], Test environments: [0, 2, 3]
[37m[36mINFO[0m[0m 03/15 11:55:33 | Batch sizes for each domain: [0, 32, 0, 0] (total=32)
[37m[36mINFO[0m[0m 03/15 11:55:33 | steps-per-epoch for each domain: 243.41 -> min = 243.41
[37m[36mINFO[0m[0m 03/15 11:55:34 | # of params = 23528522
[37m[36mINFO[0m[0m 03/15 11:58:10 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/15 11:58:10 | 0.203084    0.213519    0.455514    0.481253    2.508185    0.200633    0.208861    0.455514    0.481253    0.186398    0.221662    0.222222    0.210034    0           0.000000    2.210606    0.915489    154.595215 
[37m[36mINFO[0m[0m 03/15 12:01:29 | 0.218009    0.225980    0.588522    0.599384    1.057841    0.208542    0.217300    0.588522    0.599384    0.186083    0.219144    0.259401    0.241497    200         0.821672    1.176909    0.220672    154.923779 
[37m[36mINFO[0m[0m 03/15 12:04:46 | 0.193979    0.203867    0.595969    0.617360    1.032756    0.186396    0.193038    0.595969    0.617360    0.178841    0.217884    0.216699    0.200680    400         1.643343    1.108878    0.220586    152.743351 
[37m[36mINFO[0m[0m 03/15 12:08:02 | 0.196232    0.201894    0.617409    0.630714    1.019022    0.191669    0.188819    0.617409    0.630714    0.178841    0.217884    0.218186    0.198980    600         2.465015    1.099049    0.219662    152.561168 
[37m[36mINFO[0m[0m 03/15 12:11:25 | 0.135332    0.141692    0.636410    0.658963    1.020592    0.047456    0.048523    0.636410    0.658963    0.172859    0.211587    0.185681    0.164966    800         3.286686    1.065527    0.222375    157.805597 
[37m[36mINFO[0m[0m 03/15 12:14:43 | 0.200181    0.208065    0.659905    0.670262    0.976434    0.205642    0.214135    0.659905    0.670262    0.178841    0.217884    0.216061    0.192177    1000        4.108358    1.003142    0.227294    153.132447 
[37m[36mINFO[0m[0m 03/15 12:18:03 | 0.116459    0.130397    0.716908    0.726759    0.811630    0.123385    0.131857    0.716908    0.726759    0.162469    0.201511    0.063522    0.057823    1200        4.930030    0.924764    0.227296    154.785738 
[37m[36mINFO[0m[0m 03/15 12:21:26 | 0.110099    0.122148    0.764283    0.776066    0.728868    0.097021    0.098101    0.764283    0.776066    0.157431    0.195214    0.075844    0.073129    1400        5.751701    0.838280    0.229634    156.522467 
[37m[36mINFO[0m[0m 03/15 12:24:39 | 0.158506    0.176398    0.773784    0.787879    0.641579    0.213024    0.229958    0.773784    0.787879    0.165617    0.206549    0.096877    0.092687    1600        6.573373    0.712059    0.226189    147.567447 
[37m[36mINFO[0m[0m 03/15 12:27:58 | 0.134847    0.146980    0.808191    0.819209    0.542002    0.152386    0.164557    0.808191    0.819209    0.142317    0.164987    0.109836    0.111395    1800        7.395044    0.648728    0.221940    155.193639 
[37m[36mINFO[0m[0m 03/15 12:31:21 | 0.098492    0.097371    0.785852    0.806882    0.551305    0.147640    0.152954    0.785852    0.806882    0.063917    0.056675    0.083918    0.082483    2000        8.216716    0.586495    0.230479    157.173090 
[37m[36mINFO[0m[0m 03/15 12:34:48 | 0.282561    0.296375    0.795096    0.810991    0.569724    0.426839    0.443038    0.795096    0.810991    0.194584    0.226700    0.226259    0.219388    2200        9.038387    0.555296    0.231482    160.382014 
[37m[36mINFO[0m[0m 03/15 12:38:08 | 0.144830    0.158580    0.831429    0.831022    0.488813    0.194833    0.199367    0.831429    0.831022    0.156801    0.198992    0.082855    0.077381    2400        9.860059    0.522360    0.229296    153.977397 
[37m[36mINFO[0m[0m 03/15 12:41:25 | 0.243263    0.255085    0.838619    0.855675    0.421141    0.406538    0.431435    0.838619    0.855675    0.192380    0.195214    0.130869    0.138605    2600        10.681731   0.471168    0.226042    151.968029 
[37m[36mINFO[0m[0m 03/15 12:44:47 | 0.128831    0.137148    0.848119    0.855675    0.471727    0.202742    0.207806    0.848119    0.855675    0.115554    0.134761    0.068196    0.068878    2800        11.503402   0.474565    0.231876    154.976299 
[37m[36mINFO[0m[0m 03/15 12:48:06 | 0.168189    0.173616    0.848504    0.852080    0.460571    0.295281    0.308017    0.848504    0.852080    0.138539    0.147355    0.070746    0.065476    3000        12.325074   0.483568    0.225943    154.190336 
[37m[36mINFO[0m[0m 03/15 12:51:32 | 0.208456    0.212120    0.852228    0.852594    0.444221    0.282626    0.265823    0.852228    0.852594    0.179156    0.216625    0.163586    0.153912    3200        13.146745   0.460654    0.232255    159.656539 
[37m[36mINFO[0m[0m 03/15 12:54:52 | 0.126218    0.128643    0.836693    0.851567    0.454239    0.272080    0.274262    0.836693    0.851567    0.050063    0.045340    0.056512    0.066327    3400        13.968417   0.399738    0.228927    154.558641 
[37m[36mINFO[0m[0m 03/15 12:58:15 | 0.237249    0.242653    0.837720    0.820236    0.531282    0.310572    0.306962    0.837720    0.820236    0.178526    0.193955    0.222647    0.227041    3600        14.790089   0.385619    0.229698    156.757181 
[37m[36mINFO[0m[0m 03/15 13:01:40 | 0.205120    0.205885    0.886892    0.887519    0.361962    0.383865    0.390295    0.886892    0.887519    0.111461    0.108312    0.120034    0.119048    3800        15.611760   0.382118    0.226305    159.468329 
[37m[36mINFO[0m[0m 03/15 13:04:59 | 0.211530    0.231627    0.881500    0.885978    0.349966    0.292117    0.319620    0.881500    0.885978    0.175063    0.212846    0.167410    0.162415    4000        16.433432   0.361904    0.226324    153.943952 
[37m[36mINFO[0m[0m 03/15 13:08:27 | 0.213426    0.230604    0.896521    0.896251    0.316058    0.334036    0.348101    0.896521    0.896251    0.158375    0.186398    0.147865    0.157313    4200        17.255103   0.359166    0.232583    160.925310 
[37m[36mINFO[0m[0m 03/15 13:11:46 | 0.148046    0.151606    0.897419    0.890087    0.340121    0.339837    0.360759    0.897419    0.890087    0.071159    0.059194    0.033142    0.034864    4400        18.076775   0.341931    0.239189    151.361094 
[37m[36mINFO[0m[0m 03/15 13:15:05 | 0.254833    0.269430    0.900757    0.896764    0.299820    0.374374    0.392405    0.900757    0.896764    0.196159    0.227960    0.193966    0.187925    4600        18.898447   0.313819    0.231011    152.647042 
[37m[36mINFO[0m[0m 03/15 13:18:28 | 0.228684    0.245197    0.909231    0.906009    0.281381    0.347482    0.370253    0.909231    0.906009    0.190491    0.224181    0.148077    0.141156    4800        19.720118   0.285219    0.228203    157.516907 
[37m[36mINFO[0m[0m 03/15 13:21:43 | 0.179422    0.185273    0.892541    0.885978    0.389168    0.218561    0.234177    0.892541    0.885978    0.142947    0.149874    0.176758    0.171769    5000        20.541790   0.283899    0.226175    149.876426 
[37m[36mINFO[0m[0m 03/15 13:21:43 | Cumulative gradient change saved at train_output/TerraIncognita/GENIE/[0, 2, 3]/250315_11-55-33_resnet50_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/15 13:21:44 | ---
[37m[36mINFO[0m[0m 03/15 13:21:44 | test-domain validation(oracle) = 28.256%
[37m[36mINFO[0m[0m 03/15 13:21:44 | training-domain validation(iid) = 22.868%
[37m[36mINFO[0m[0m 03/15 13:21:44 | last = 17.942%
[37m[36mINFO[0m[0m 03/15 13:21:44 | last (inD) = 88.598%
[37m[36mINFO[0m[0m 03/15 13:21:44 | training-domain validation (iid, inD) = 90.601%
[37m[36mINFO[0m[0m 03/15 13:21:45 | === Summary ===
[37m[36mINFO[0m[0m 03/15 13:21:45 | Command: /jsm0707/GENIE/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm GENIE --test_envs 0 2 3 --dataset TerraIncognita
[37m[36mINFO[0m[0m 03/15 13:21:45 | Unique name: 250315_11-55-33_resnet50_adam
[37m[36mINFO[0m[0m 03/15 13:21:45 | Out path: train_output/TerraIncognita/GENIE/[0, 2, 3]/250315_11-55-33_resnet50_adam
[37m[36mINFO[0m[0m 03/15 13:21:45 | Algorithm: GENIE
[37m[36mINFO[0m[0m 03/15 13:21:45 | Dataset: TerraIncognita

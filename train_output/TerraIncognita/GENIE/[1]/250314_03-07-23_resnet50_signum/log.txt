[37m[36mINFO[0m[0m 03/14 03:07:23 | Command :: /jsm0707/GENIE/train_all.py resnet50_signum config/resnet50_signum.yaml --algorithm GENIE --test_envs 1 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_signum.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_signum
	out_dir: train_output/TerraIncognita/GENIE/[1]/250314_03-07-23_resnet50_signum
	out_root: train_output/TerraIncognita/GENIE/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250314_03-07-23_resnet50_signum
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: signum
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	momentum: 0.9
	convergence_rate: 0.015
	moving_avg: 0.95
	p: 0.4
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/14 03:07:23 | n_steps = 5001
[37m[36mINFO[0m[0m 03/14 03:07:23 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/14 03:07:23 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/14 03:07:23 | 
[37m[36mINFO[0m[0m 03/14 03:07:23 | Testenv name escaping te_L38 -> te_L38
[37m[36mINFO[0m[0m 03/14 03:07:23 | Test envs = [1], name = te_L38
[37m[36mINFO[0m[0m 03/14 03:07:23 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/14 03:07:23 | Batch sizes for each domain: [32, 0, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/14 03:07:23 | steps-per-epoch for each domain: 118.53, 99.25, 147.09 -> min = 99.25
[37m[36mINFO[0m[0m 03/14 03:07:25 | # of params = 23528522
[37m[36mINFO[0m[0m 03/14 03:10:04 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/14 03:10:04 | 0.019258    0.023112    0.284710    0.289972    2.046340    0.522278    0.520042    0.019258    0.023112    0.096033    0.103275    0.235819    0.246599    0           0.000000    2.384155    1.404809    157.970035 
[37m[36mINFO[0m[0m 03/14 03:13:40 | 0.077417    0.081664    0.589482    0.582436    1.122233    0.767730    0.755274    0.077417    0.081664    0.493388    0.491184    0.507330    0.500850    200         2.015113    1.330877    0.288209    157.985006 
[37m[36mINFO[0m[0m 03/14 03:17:08 | 0.134035    0.148947    0.721695    0.733586    0.758523    0.827577    0.829114    0.134035    0.148947    0.681675    0.696474    0.655832    0.675170    400         4.030227    0.914445    0.236096    161.434398 
[37m[36mINFO[0m[0m 03/14 03:20:41 | 0.222108    0.230611    0.752369    0.746298    0.667610    0.854996    0.856540    0.222108    0.230611    0.715050    0.690176    0.687062    0.692177    600         6.045340    0.681815    0.286116    155.516390 
[37m[36mINFO[0m[0m 03/14 03:24:14 | 0.369624    0.376990    0.797025    0.805292    0.537044    0.892697    0.889241    0.369624    0.376990    0.765428    0.778338    0.732951    0.748299    800         8.060453    0.578118    0.251275    162.881700 
[37m[36mINFO[0m[0m 03/14 03:27:48 | 0.278983    0.306626    0.817024    0.808522    0.536025    0.888479    0.879747    0.278983    0.306626    0.787154    0.774559    0.775441    0.771259    1000        10.075567   0.515077    0.274661    158.327891 
[37m[36mINFO[0m[0m 03/14 03:31:24 | 0.385672    0.403184    0.843297    0.834111    0.477663    0.918007    0.896624    0.385672    0.403184    0.813287    0.812343    0.798598    0.793367    1200        12.090680   0.462063    0.290691    158.205651 
[37m[36mINFO[0m[0m 03/14 03:34:57 | 0.412248    0.422188    0.851308    0.838342    0.458337    0.898497    0.888186    0.412248    0.422188    0.849181    0.822418    0.806246    0.804422    1400        14.105793   0.443003    0.250555    162.708099 
[37m[36mINFO[0m[0m 03/14 03:38:35 | 0.427654    0.440164    0.859675    0.836494    0.466424    0.925389    0.900844    0.427654    0.440164    0.839106    0.816121    0.814532    0.792517    1600        16.120907   0.401119    0.283971    160.983229 
[37m[36mINFO[0m[0m 03/14 03:42:12 | 0.394274    0.412943    0.868532    0.851262    0.438094    0.936462    0.919831    0.394274    0.412943    0.848866    0.831234    0.820268    0.802721    1800        18.136020   0.377567    0.287001    159.677152 
[37m[36mINFO[0m[0m 03/14 03:45:40 | 0.409295    0.419620    0.871182    0.855234    0.402639    0.946480    0.931435    0.409295    0.419620    0.852960    0.840050    0.814107    0.794218    2000        20.151134   0.349053    0.241022    159.928844 
[37m[36mINFO[0m[0m 03/14 03:49:21 | 0.350879    0.361068    0.886609    0.856690    0.420076    0.947799    0.926160    0.350879    0.361068    0.876889    0.817380    0.835139    0.826531    2200        22.166247   0.328506    0.289328    162.935157 
[37m[36mINFO[0m[0m 03/14 03:53:00 | 0.411606    0.424756    0.896442    0.868880    0.376705    0.953599    0.927215    0.411606    0.424756    0.893577    0.866499    0.842150    0.812925    2400        24.181360   0.312393    0.277573    163.416009 
[37m[36mINFO[0m[0m 03/14 03:56:29 | 0.416870    0.428351    0.886459    0.858804    0.403191    0.948853    0.912447    0.416870    0.428351    0.869647    0.845088    0.840875    0.818878    2600        26.196474   0.287840    0.247205    160.463205 
[37m[36mINFO[0m[0m 03/14 04:00:01 | 0.392348    0.407807    0.895682    0.872650    0.381935    0.954126    0.925105    0.392348    0.407807    0.879723    0.847607    0.853197    0.845238    2800        28.211587   0.283056    0.286039    154.569678 
[37m[36mINFO[0m[0m 03/14 04:03:31 | 0.411093    0.428865    0.903176    0.869669    0.409209    0.955972    0.927215    0.411093    0.428865    0.894836    0.847607    0.858721    0.834184    3000        30.226700   0.266282    0.253393    158.717012 
[37m[36mINFO[0m[0m 03/14 04:07:11 | 0.387341    0.402157    0.911369    0.884946    0.350285    0.959135    0.934599    0.387341    0.402157    0.907116    0.866499    0.867856    0.853741    3200        32.241814   0.268383    0.283077    163.954545 
[37m[36mINFO[0m[0m 03/14 04:10:44 | 0.455643    0.467386    0.912202    0.881455    0.335105    0.963617    0.941983    0.455643    0.467386    0.904282    0.866499    0.868706    0.835884    3400        34.256927   0.243571    0.282830    156.319643 
[37m[36mINFO[0m[0m 03/14 04:14:13 | 0.388497    0.417565    0.916779    0.889249    0.341929    0.962299    0.936709    0.388497    0.417565    0.915932    0.886650    0.872105    0.844388    3600        36.272040   0.239802    0.244708    159.743212 
[37m[36mINFO[0m[0m 03/14 04:17:53 | 0.345616    0.366718    0.918171    0.880684    0.351432    0.949908    0.915612    0.345616    0.366718    0.925063    0.880353    0.879541    0.846088    3800        38.287154   0.217348    0.288402    162.616702 
[37m[36mINFO[0m[0m 03/14 04:21:30 | 0.452561    0.459682    0.927199    0.882327    0.357188    0.974163    0.941983    0.452561    0.459682    0.919395    0.861461    0.888039    0.843537    4000        40.302267   0.212774    0.286377    159.788085 
[37m[36mINFO[0m[0m 03/14 04:24:59 | 0.421363    0.444273    0.910509    0.884043    0.371890    0.947535    0.926160    0.421363    0.444273    0.916562    0.884131    0.867431    0.841837    4200        42.317380   0.208737    0.241559    160.310362 
[37m[36mINFO[0m[0m 03/14 04:28:34 | 0.360252    0.384694    0.930175    0.893264    0.349432    0.975481    0.946203    0.360252    0.384694    0.922544    0.886650    0.892501    0.846939    4400        44.332494   0.197411    0.248882    165.195680 
[37m[36mINFO[0m[0m 03/14 04:32:07 | 0.401464    0.419106    0.935349    0.897268    0.326438    0.976272    0.945148    0.401464    0.419106    0.943010    0.895466    0.886764    0.851190    4600        46.347607   0.183790    0.280821    156.974593 
[37m[36mINFO[0m[0m 03/14 04:35:45 | 0.427012    0.444273    0.933708    0.897752    0.308448    0.971526    0.949367    0.427012    0.444273    0.931360    0.879093    0.898237    0.864796    4800        48.362720   0.193134    0.282328    161.754274 
[37m[36mINFO[0m[0m 03/14 04:39:16 | 0.364617    0.380586    0.938066    0.905761    0.316448    0.974427    0.949367    0.364617    0.380586    0.933249    0.895466    0.906522    0.872449    5000        50.377834   0.178549    0.241643    162.313284 
[37m[36mINFO[0m[0m 03/14 04:39:16 | Cumulative gradient change saved at train_output/TerraIncognita/GENIE/[1]/250314_03-07-23_resnet50_signum/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/14 04:39:17 | ---
[37m[36mINFO[0m[0m 03/14 04:39:17 | test-domain validation(oracle) = 45.564%
[37m[36mINFO[0m[0m 03/14 04:39:17 | training-domain validation(iid) = 36.462%
[37m[36mINFO[0m[0m 03/14 04:39:17 | last = 36.462%
[37m[36mINFO[0m[0m 03/14 04:39:17 | last (inD) = 90.576%
[37m[36mINFO[0m[0m 03/14 04:39:17 | training-domain validation (iid, inD) = 90.576%
[37m[36mINFO[0m[0m 03/14 04:39:17 | === Summary ===
[37m[36mINFO[0m[0m 03/14 04:39:17 | Command: /jsm0707/GENIE/train_all.py resnet50_signum config/resnet50_signum.yaml --algorithm GENIE --test_envs 1 --dataset TerraIncognita
[37m[36mINFO[0m[0m 03/14 04:39:17 | Unique name: 250314_03-07-23_resnet50_signum
[37m[36mINFO[0m[0m 03/14 04:39:17 | Out path: train_output/TerraIncognita/GENIE/[1]/250314_03-07-23_resnet50_signum
[37m[36mINFO[0m[0m 03/14 04:39:17 | Algorithm: GENIE
[37m[36mINFO[0m[0m 03/14 04:39:17 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 03/15 15:03:00 | Command :: /jsm0707/GENIE/train_all.py B_Tera1_adam config/resnet50_adam.yaml --trial_seed 2 --hparams_seed 14 --algorithm GENIE --test_envs 1 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_adam.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 14
	in_domain: False
	model_save: None
	mpa: False
	name: B_Tera1_adam
	out_dir: train_output/TerraIncognita/GENIE/[1]/250315_15-03-00_B_Tera1_adam
	out_root: train_output/TerraIncognita/GENIE/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 2
	unique_name: 250315_15-03-00_B_Tera1_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 4.223376545632674e-05
	batch_size: 27
	weight_decay: 1.4009530778122364e-05
	momentum: 0.97624308836667
	convergence_rate: 0.007433824219408728
	moving_avg: 0.9835243535862955
	p: 0.4547494637981545
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/15 15:03:00 | n_steps = 5001
[37m[36mINFO[0m[0m 03/15 15:03:00 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/15 15:03:00 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/15 15:03:00 | 
[37m[36mINFO[0m[0m 03/15 15:03:00 | Testenv name escaping te_L38 -> te_L38
[37m[36mINFO[0m[0m 03/15 15:03:00 | Test envs = [1], name = te_L38
[37m[36mINFO[0m[0m 03/15 15:03:00 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 03/15 15:03:00 | Batch sizes for each domain: [27, 0, 27, 27] (total=81)
[37m[36mINFO[0m[0m 03/15 15:03:00 | steps-per-epoch for each domain: 140.48, 117.63, 174.33 -> min = 117.63
[37m[36mINFO[0m[0m 03/15 15:03:01 | # of params = 23528522
[37m[36mINFO[0m[0m 03/15 15:05:37 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/15 15:05:37 | 0.021184    0.015408    0.284322    0.291525    2.078406    0.518587    0.534810    0.021184    0.015408    0.097922    0.095718    0.236456    0.244048    0           0.000000    2.439070    1.320067    155.318614 
[37m[36mINFO[0m[0m 03/15 15:09:02 | 0.275260    0.265537    0.528614    0.537895    1.300902    0.695755    0.703586    0.275260    0.265537    0.436083    0.448363    0.454005    0.461735    200         1.700252    1.497915    0.224354    159.979430 
[37m[36mINFO[0m[0m 03/15 15:12:28 | 0.126717    0.115049    0.618624    0.614850    1.053200    0.774057    0.784810    0.126717    0.115049    0.542191    0.516373    0.539622    0.543367    400         3.400504    1.191156    0.222990    161.200896 
[37m[36mINFO[0m[0m 03/15 15:15:56 | 0.102709    0.101181    0.669015    0.678729    0.889174    0.814131    0.820675    0.102709    0.101181    0.613350    0.637280    0.579562    0.578231    600         5.100756    1.024509    0.233718    160.651409 
[37m[36mINFO[0m[0m 03/15 15:19:24 | 0.165618    0.174628    0.739231    0.744584    0.736463    0.855523    0.837553    0.165618    0.174628    0.706549    0.738035    0.655619    0.658163    800         6.801008    0.837412    0.247942    159.139576 
[37m[36mINFO[0m[0m 03/15 15:22:57 | 0.139042    0.140729    0.760629    0.767091    0.640758    0.859214    0.858650    0.139042    0.140729    0.736461    0.731738    0.686212    0.710884    1000        8.501259    0.728337    0.268749    159.355559 
[37m[36mINFO[0m[0m 03/15 15:26:41 | 0.161381    0.157165    0.757892    0.771881    0.610596    0.855787    0.857595    0.161381    0.157165    0.736776    0.755668    0.681113    0.702381    1200        10.201511   0.640098    0.289937    165.386214 
[37m[36mINFO[0m[0m 03/15 15:30:17 | 0.365901    0.360555    0.802046    0.795432    0.552001    0.880042    0.873418    0.365901    0.360555    0.774874    0.756927    0.751222    0.755952    1400        11.901763   0.570501    0.273453    161.434901 
[37m[36mINFO[0m[0m 03/15 15:33:53 | 0.417383    0.415511    0.820362    0.812505    0.507868    0.891906    0.863924    0.417383    0.415511    0.804786    0.797229    0.764393    0.776361    1600        13.602015   0.548860    0.257569    164.124521 
[37m[36mINFO[0m[0m 03/15 15:37:16 | 0.402234    0.395480    0.837531    0.820014    0.478425    0.915634    0.894515    0.402234    0.395480    0.817695    0.795970    0.779265    0.769558    1800        15.302267   0.494973    0.238232    155.848065 
[37m[36mINFO[0m[0m 03/15 15:40:49 | 0.385672    0.365691    0.821072    0.809917    0.487872    0.909043    0.881857    0.385672    0.365691    0.780856    0.778338    0.773316    0.769558    2000        17.002519   0.471782    0.235210    165.456203 
[37m[36mINFO[0m[0m 03/15 15:44:17 | 0.450764    0.440164    0.840484    0.822881    0.482211    0.900870    0.888186    0.450764    0.440164    0.823048    0.792191    0.797536    0.788265    2200        18.702771   0.452227    0.229565    162.880711 
[37m[36mINFO[0m[0m 03/15 15:47:42 | 0.404802    0.390858    0.855554    0.837119    0.450856    0.913525    0.885021    0.404802    0.390858    0.845403    0.828715    0.807733    0.797619    2400        20.403023   0.432826    0.235287    158.082427 
[37m[36mINFO[0m[0m 03/15 15:51:12 | 0.439338    0.411916    0.853403    0.836401    0.461382    0.920116    0.892405    0.439338    0.411916    0.834698    0.809824    0.805396    0.806973    2600        22.103275   0.420466    0.228730    164.187154 
[37m[36mINFO[0m[0m 03/15 15:54:40 | 0.296187    0.285054    0.873317    0.853651    0.420392    0.934353    0.920886    0.296187    0.285054    0.857683    0.818640    0.827916    0.821429    2800        23.803526   0.395518    0.220520    163.661984 
[37m[36mINFO[0m[0m 03/15 15:58:03 | 0.397997    0.387776    0.859674    0.842184    0.456448    0.933298    0.905063    0.397997    0.387776    0.843514    0.808564    0.802209    0.812925    3000        25.503778   0.374785    0.224579    157.574859 
[37m[36mINFO[0m[0m 03/15 16:01:29 | 0.366414    0.347201    0.875115    0.856784    0.411519    0.936989    0.915612    0.366414    0.347201    0.866814    0.835013    0.821542    0.819728    3200        27.204030   0.341163    0.223146    161.670377 
[37m[36mINFO[0m[0m 03/15 16:04:58 | 0.400822    0.384181    0.887845    0.857204    0.389539    0.940417    0.913502    0.400822    0.384181    0.882242    0.837531    0.840875    0.820578    3400        28.904282   0.348862    0.231551    162.751730 
[37m[36mINFO[0m[0m 03/15 16:08:25 | 0.447297    0.417565    0.890122    0.861233    0.407211    0.947799    0.924051    0.447297    0.417565    0.883816    0.850126    0.838751    0.809524    3600        30.604534   0.319073    0.247147    157.642821 
[37m[36mINFO[0m[0m 03/15 16:11:55 | 0.390936    0.370313    0.885207    0.848392    0.451947    0.938044    0.899789    0.390936    0.370313    0.883501    0.835013    0.834077    0.810374    3800        32.304786   0.324982    0.256437    159.070545 
[37m[36mINFO[0m[0m 03/15 16:15:20 | 0.397227    0.385722    0.893399    0.865654    0.390273    0.955444    0.924051    0.397227    0.385722    0.878778    0.843829    0.845974    0.829082    4000        34.005038   0.295576    0.214056    161.287182 
[37m[36mINFO[0m[0m 03/15 16:18:37 | 0.379381    0.364150    0.905408    0.871147    0.371189    0.957290    0.918776    0.379381    0.364150    0.898300    0.871537    0.860633    0.823129    4200        35.705290   0.289470    0.203384    156.752915 
[37m[36mINFO[0m[0m 03/15 16:21:59 | 0.353190    0.325629    0.895692    0.867161    0.401129    0.946217    0.920886    0.353190    0.325629    0.881927    0.841310    0.858934    0.839286    4400        37.405542   0.283040    0.206736    160.428643 
[37m[36mINFO[0m[0m 03/15 16:25:22 | 0.382334    0.369800    0.894837    0.871962    0.382518    0.957290    0.930380    0.382334    0.369800    0.876574    0.856423    0.850648    0.829082    4600        39.105793   0.271808    0.206894    162.298854 
[37m[36mINFO[0m[0m 03/15 16:28:45 | 0.493902    0.486389    0.905076    0.874649    0.356481    0.958081    0.930380    0.493902    0.486389    0.896725    0.857683    0.860421    0.835884    4800        40.806045   0.255380    0.205974    161.417082 
[37m[36mINFO[0m[0m 03/15 16:32:04 | 0.428040    0.417565    0.895161    0.866536    0.412982    0.941998    0.913502    0.428040    0.417565    0.893262    0.842569    0.850223    0.843537    5000        42.506297   0.273206    0.207668    157.404081 
[37m[36mINFO[0m[0m 03/15 16:32:04 | Cumulative gradient change saved at train_output/TerraIncognita/GENIE/[1]/250315_15-03-00_B_Tera1_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/15 16:32:06 | ---
[37m[36mINFO[0m[0m 03/15 16:32:06 | test-domain validation(oracle) = 49.390%
[37m[36mINFO[0m[0m 03/15 16:32:06 | training-domain validation(iid) = 49.390%
[37m[36mINFO[0m[0m 03/15 16:32:06 | last = 42.804%
[37m[36mINFO[0m[0m 03/15 16:32:06 | last (inD) = 86.654%
[37m[36mINFO[0m[0m 03/15 16:32:06 | training-domain validation (iid, inD) = 87.465%
[37m[36mINFO[0m[0m 03/15 16:32:06 | === Summary ===
[37m[36mINFO[0m[0m 03/15 16:32:06 | Command: /jsm0707/GENIE/train_all.py B_Tera1_adam config/resnet50_adam.yaml --trial_seed 2 --hparams_seed 14 --algorithm GENIE --test_envs 1 --dataset TerraIncognita
[37m[36mINFO[0m[0m 03/15 16:32:06 | Unique name: 250315_15-03-00_B_Tera1_adam
[37m[36mINFO[0m[0m 03/15 16:32:06 | Out path: train_output/TerraIncognita/GENIE/[1]/250315_15-03-00_B_Tera1_adam
[37m[36mINFO[0m[0m 03/15 16:32:06 | Algorithm: GENIE
[37m[36mINFO[0m[0m 03/15 16:32:06 | Dataset: TerraIncognita

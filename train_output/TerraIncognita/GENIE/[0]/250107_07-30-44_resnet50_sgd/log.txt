[37m[36mINFO[0m[0m 01/07 07:30:44 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm gnsr1224 --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 19
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: gnsr1224
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 19
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/TerraIncognita/gnsr1224/[0]/250107_07-30-44_resnet50_sgd
	out_root: train_output/TerraIncognita/gnsr1224/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250107_07-30-44_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5.513854977685438e-05
	batch_size: 27
	weight_decay: 0.0014556716107047517
	momentum: 0.9825164146767955
	convergence_rate: 0.00783236199583624
	moving_avg: 0.9545414323763227
	p: 0.7520697104227815
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/07 07:30:44 | n_steps = 5001
[37m[36mINFO[0m[0m 01/07 07:30:44 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/07 07:30:44 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/07 07:30:44 | Target test envs = [[0]]
[37m[36mINFO[0m[0m 01/07 07:30:44 | 
[37m[36mINFO[0m[0m 01/07 07:30:44 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 01/07 07:30:44 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 01/07 07:30:44 | Batch sizes for each domain: [0, 27, 27, 27] (total=81)
[37m[36mINFO[0m[0m 01/07 07:30:44 | steps-per-epoch for each domain: 288.48, 117.63, 174.33 -> min = 117.63
[37m[36mINFO[0m[0m 01/07 07:30:46 | # of params = 23528522
[37m[36mINFO[0m[0m 01/07 07:33:35 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/07 07:33:35 | 0.209597    0.221519    0.265608    0.293846    2.085001    0.209597    0.221519    0.446912    0.488444    0.122166    0.181360    0.227746    0.211735    0           0.000000    2.371385    2.085035    166.915732 
[37m[36mINFO[0m[0m 01/07 07:37:17 | 0.342209    0.347046    0.651389    0.670048    0.922359    0.342209    0.347046    0.740532    0.748844    0.603904    0.647355    0.609730    0.613946    200         1.700252    1.290967    0.292140    164.050229 
[37m[36mINFO[0m[0m 01/07 07:41:06 | 0.498023    0.491561    0.726491    0.749012    0.710387    0.498023    0.491561    0.771601    0.787879    0.713161    0.735516    0.694710    0.723639    400         3.400504    0.829805    0.288008    170.782717 
[37m[36mINFO[0m[0m 01/07 07:45:02 | 0.465331    0.454641    0.759193    0.773762    0.632104    0.465331    0.454641    0.802799    0.829481    0.740554    0.775819    0.734226    0.715986    600         5.100756    0.709703    0.317928    172.433542 
[37m[36mINFO[0m[0m 01/07 07:48:49 | 0.406538    0.406118    0.768205    0.771689    0.622174    0.406538    0.406118    0.817563    0.826913    0.753463    0.761965    0.733588    0.726190    800         6.801008    0.658484    0.323635    161.956621 
[37m[36mINFO[0m[0m 01/07 07:52:35 | 0.465858    0.471519    0.788856    0.797098    0.566384    0.465858    0.471519    0.823726    0.845917    0.778023    0.775819    0.764818    0.769558    1000        8.501259    0.610240    0.304078    164.505236 
[37m[36mINFO[0m[0m 01/07 07:56:24 | 0.399684    0.417722    0.793192    0.800904    0.550446    0.399684    0.417722    0.838105    0.853621    0.777078    0.784635    0.764393    0.764456    1200        10.201511   0.581894    0.312639    165.963317 
[37m[36mINFO[0m[0m 01/07 08:00:22 | 0.570261    0.577004    0.800376    0.798016    0.556758    0.570261    0.577004    0.832456    0.835131    0.794081    0.780856    0.774591    0.778061    1400        11.901763   0.529749    0.316537    175.062147 
[37m[36mINFO[0m[0m 01/07 08:04:00 | 0.243343    0.247890    0.804806    0.820358    0.511293    0.243343    0.247890    0.834895    0.857730    0.818955    0.831234    0.760569    0.772109    1600        13.602015   0.489989    0.230490    171.385579 
[37m[36mINFO[0m[0m 01/07 08:07:38 | 0.362246    0.388186    0.830038    0.815084    0.505662    0.362246    0.388186    0.856079    0.871597    0.835013    0.792191    0.799023    0.781463    1800        15.302267   0.478679    0.247065    169.019645 
[37m[36mINFO[0m[0m 01/07 08:11:23 | 0.451621    0.465190    0.826414    0.837189    0.468609    0.451621    0.465190    0.864167    0.888033    0.821788    0.814861    0.793287    0.808673    2000        17.002519   0.472731    0.236332    177.353969 
[37m[36mINFO[0m[0m 01/07 08:15:00 | 0.508832    0.509494    0.839091    0.830760    0.481414    0.508832    0.509494    0.856079    0.877247    0.846662    0.814861    0.814532    0.800170    2200        18.702771   0.441452    0.229400    171.099536 
[37m[36mINFO[0m[0m 01/07 08:18:35 | 0.550224    0.565401    0.856094    0.844641    0.438093    0.550224    0.565401    0.871871    0.882897    0.859572    0.826196    0.836839    0.824830    2400        20.403023   0.435381    0.220699    170.840184 
[37m[36mINFO[0m[0m 01/07 08:22:09 | 0.413129    0.433544    0.857573    0.835810    0.445954    0.413129    0.433544    0.877776    0.889060    0.866814    0.819899    0.828128    0.798469    2600        22.103275   0.394192    0.226534    167.960358 
[37m[36mINFO[0m[0m 01/07 08:25:46 | 0.494595    0.518987    0.858671    0.850157    0.421019    0.494595    0.518987    0.872384    0.882383    0.868703    0.855164    0.834927    0.812925    2800        23.803526   0.397200    0.225105    172.122572 
[37m[36mINFO[0m[0m 01/07 08:29:22 | 0.587398    0.608650    0.863409    0.858542    0.404635    0.587398    0.608650    0.883169    0.895223    0.866184    0.856423    0.840875    0.823980    3000        25.503778   0.374108    0.227361    169.633468 
[37m[36mINFO[0m[0m 01/07 08:32:59 | 0.588452    0.598101    0.870465    0.851983    0.418299    0.588452    0.598101    0.875979    0.895223    0.884131    0.832494    0.851285    0.828231    3200        27.204030   0.375472    0.226247    172.144612 
[37m[36mINFO[0m[0m 01/07 08:36:40 | 0.542315    0.536920    0.864440    0.854672    0.405641    0.542315    0.536920    0.874182    0.889060    0.868703    0.850126    0.850436    0.824830    3400        28.904282   0.362828    0.240476    172.505785 
[37m[36mINFO[0m[0m 01/07 08:40:22 | 0.506196    0.534810    0.869807    0.846911    0.426845    0.506196    0.534810    0.880216    0.883410    0.879408    0.832494    0.849798    0.824830    3600        30.604534   0.346640    0.249370    172.206276 
[37m[36mINFO[0m[0m 01/07 08:44:13 | 0.467440    0.469409    0.881232    0.861244    0.401030    0.467440    0.469409    0.892798    0.903955    0.895151    0.838791    0.855747    0.840986    3800        32.304786   0.344237    0.283109    174.491501 
[37m[36mINFO[0m[0m 01/07 08:48:10 | 0.442921    0.454641    0.874758    0.850425    0.442760    0.442921    0.454641    0.879189    0.882897    0.883816    0.832494    0.861270    0.835884    4000        34.005038   0.312045    0.320272    172.773811 
[37m[36mINFO[0m[0m 01/07 08:52:07 | 0.544688    0.547468    0.877265    0.864774    0.401710    0.544688    0.547468    0.889459    0.909605    0.891688    0.851385    0.850648    0.833333    4200        35.705290   0.317696    0.317876    173.380715 
[37m[36mINFO[0m[0m 01/07 08:56:04 | 0.528342    0.554852    0.889064    0.875303    0.367179    0.528342    0.554852    0.877776    0.899846    0.916247    0.876574    0.873168    0.849490    4400        37.405542   0.312236    0.316939    172.771796 
[37m[36mINFO[0m[0m 01/07 08:59:58 | 0.586871    0.602321    0.892156    0.883958    0.356705    0.586871    0.602321    0.899474    0.910632    0.906801    0.886650    0.870193    0.854592    4600        39.105793   0.318907    0.302498    173.054107 
[37m[36mINFO[0m[0m 01/07 09:03:41 | 0.516741    0.531646    0.895712    0.875370    0.372577    0.516741    0.531646    0.899730    0.898819    0.906801    0.880353    0.880603    0.846939    4800        40.806045   0.296329    0.282529    166.114089 
[37m[36mINFO[0m[0m 01/07 09:07:14 | 0.439494    0.451477    0.904268    0.873974    0.369515    0.439494    0.451477    0.913339    0.915254    0.919710    0.863980    0.879754    0.842687    5000        42.506297   0.272300    0.238714    165.151181 
[37m[36mINFO[0m[0m 01/07 09:07:14 | ---
[37m[36mINFO[0m[0m 01/07 09:07:14 | test-domain validation(oracle) = 58.740%
[37m[36mINFO[0m[0m 01/07 09:07:14 | training-domain validation(iid) = 58.687%
[37m[36mINFO[0m[0m 01/07 09:07:14 | last = 43.949%
[37m[36mINFO[0m[0m 01/07 09:07:14 | last (inD) = 87.397%
[37m[36mINFO[0m[0m 01/07 09:07:14 | training-domain validation (iid, inD) = 88.396%
[37m[36mINFO[0m[0m 01/07 09:07:14 | === Summary ===
[37m[36mINFO[0m[0m 01/07 09:07:14 | Command: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm gnsr1224 --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 19
[37m[36mINFO[0m[0m 01/07 09:07:14 | Unique name: 250107_07-30-44_resnet50_sgd
[37m[36mINFO[0m[0m 01/07 09:07:14 | Out path: train_output/TerraIncognita/gnsr1224/[0]/250107_07-30-44_resnet50_sgd
[37m[36mINFO[0m[0m 01/07 09:07:14 | Algorithm: gnsr1224
[37m[36mINFO[0m[0m 01/07 09:07:14 | Dataset: TerraIncognita
[37m[36mINFO[0m[0m 01/07 09:07:14 | Max test_in: 0.5885

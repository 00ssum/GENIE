[37m[36mINFO[0m[0m 03/15 04:08:35 | Command :: /jsm0707/GENIE/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm GENIE --test_envs 0 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_adam.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_adam
	out_dir: train_output/TerraIncognita/GENIE/[0]/250315_04-08-35_resnet50_adam
	out_root: train_output/TerraIncognita/GENIE/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250315_04-08-35_resnet50_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	momentum: 0.9
	convergence_rate: 0.015
	moving_avg: 0.95
	p: 0.4
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/15 04:08:35 | n_steps = 5001
[37m[36mINFO[0m[0m 03/15 04:08:35 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/15 04:08:35 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/15 04:08:35 | 
[37m[36mINFO[0m[0m 03/15 04:08:35 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 03/15 04:08:35 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 03/15 04:08:35 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/15 04:08:35 | Batch sizes for each domain: [0, 32, 32, 32] (total=96)
[37m[36mINFO[0m[0m 03/15 04:08:35 | steps-per-epoch for each domain: 243.41, 99.25, 147.09 -> min = 99.25
[37m[36mINFO[0m[0m 03/15 04:08:36 | # of params = 23528522
[37m[36mINFO[0m[0m 03/15 04:11:36 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/15 04:11:36 | 0.200633    0.208861    0.288045    0.304317    2.034136    0.200633    0.208861    0.455514    0.481253    0.186398    0.221662    0.222222    0.210034    0           0.000000    2.387133    1.136705    178.607812 
[37m[36mINFO[0m[0m 03/15 04:15:52 | 0.314263    0.328059    0.664571    0.683920    0.882910    0.314263    0.328059    0.736552    0.761171    0.623426    0.651134    0.633737    0.639456    200         2.015113    1.288145    0.407023    174.085848 
[37m[36mINFO[0m[0m 03/15 04:20:02 | 0.439230    0.450422    0.735759    0.729041    0.728105    0.439230    0.450422    0.780203    0.782229    0.723866    0.722922    0.703208    0.681973    400         4.030227    0.794623    0.368468    176.484015 
[37m[36mINFO[0m[0m 03/15 04:23:42 | 0.547588    0.561181    0.735913    0.741919    0.686917    0.547588    0.561181    0.791758    0.798151    0.710013    0.709068    0.705970    0.718537    600         6.045340    0.682678    0.242899    171.417428 
[37m[36mINFO[0m[0m 03/15 04:27:26 | 0.529924    0.528481    0.789414    0.793745    0.553763    0.529924    0.528481    0.831942    0.848998    0.791877    0.806045    0.744423    0.726190    800         8.060453    0.624546    0.253357    173.592907 
[37m[36mINFO[0m[0m 03/15 04:31:13 | 0.587134    0.601266    0.799441    0.802105    0.542878    0.587134    0.601266    0.836179    0.854135    0.780542    0.775819    0.781602    0.776361    1000        10.075567   0.565416    0.261240    174.148615 
[37m[36mINFO[0m[0m 03/15 04:35:25 | 0.409175    0.433544    0.820146    0.820627    0.496975    0.409175    0.433544    0.851329    0.875193    0.814547    0.803526    0.794561    0.783163    1200        12.090680   0.530649    0.376737    177.577708 
[37m[36mINFO[0m[0m 03/15 04:39:28 | 0.485368    0.493671    0.820229    0.818186    0.503332    0.485368    0.493671    0.837720    0.852594    0.819270    0.806045    0.803697    0.795918    1400        14.105793   0.490663    0.348509    172.584491 
[37m[36mINFO[0m[0m 03/15 04:43:08 | 0.465595    0.489451    0.836799    0.828780    0.481204    0.465595    0.489451    0.858133    0.874679    0.829660    0.812343    0.822605    0.799320    1600        16.120907   0.464450    0.258722    168.072483 
[37m[36mINFO[0m[0m 03/15 04:46:58 | 0.503296    0.525316    0.853532    0.852711    0.431052    0.503296    0.525316    0.871614    0.879301    0.858942    0.846348    0.830040    0.832483    1800        18.136020   0.460240    0.288098    172.792795 
[37m[36mINFO[0m[0m 03/15 04:50:46 | 0.447139    0.475738    0.859951    0.843550    0.436067    0.447139    0.475738    0.872898    0.886492    0.865869    0.831234    0.841088    0.812925    2000        20.151134   0.442713    0.285840    171.207578 
[37m[36mINFO[0m[0m 03/15 04:54:27 | 0.547060    0.552743    0.847498    0.831773    0.447829    0.547060    0.552743    0.859674    0.876733    0.858942    0.836272    0.823879    0.782313    2200        22.166247   0.404979    0.255963    169.867009 
[37m[36mINFO[0m[0m 03/15 04:58:21 | 0.523332    0.540084    0.862946    0.844493    0.425959    0.523332    0.540084    0.881243    0.894196    0.865869    0.813602    0.841725    0.825680    2400        24.181360   0.387617    0.289295    175.950321 
[37m[36mINFO[0m[0m 03/15 05:02:03 | 0.401002    0.406118    0.873741    0.862719    0.393674    0.401002    0.406118    0.884196    0.896764    0.882557    0.861461    0.854472    0.829932    2600        26.196474   0.377912    0.275758    166.703030 
[37m[36mINFO[0m[0m 03/15 05:05:45 | 0.470076    0.508439    0.876181    0.857408    0.391476    0.470076    0.508439    0.873925    0.890087    0.894836    0.853904    0.859783    0.828231    2800        28.211587   0.363414    0.258009    170.736796 
[37m[36mINFO[0m[0m 03/15 05:09:34 | 0.408120    0.421941    0.884466    0.867319    0.379806    0.408120    0.421941    0.893953    0.905496    0.899874    0.863980    0.859571    0.832483    3000        30.226700   0.336783    0.286862    171.174361 
[37m[36mINFO[0m[0m 03/15 05:13:12 | 0.527023    0.537975    0.886717    0.856736    0.393191    0.527023    0.537975    0.897034    0.890087    0.894836    0.845088    0.868281    0.835034    3200        32.241814   0.316556    0.251598    167.404191 
[37m[36mINFO[0m[0m 03/15 05:16:56 | 0.407857    0.424051    0.889558    0.856961    0.415412    0.407857    0.424051    0.891899    0.892655    0.907431    0.860202    0.869344    0.818027    3400        34.256927   0.302744    0.283864    167.643389 
[37m[36mINFO[0m[0m 03/15 05:20:41 | 0.480359    0.494726    0.888509    0.872950    0.366003    0.480359    0.494726    0.901399    0.901387    0.899244    0.884131    0.864882    0.833333    3600        36.272040   0.315013    0.288701    167.218488 
[37m[36mINFO[0m[0m 03/15 05:24:14 | 0.466385    0.472574    0.901540    0.882139    0.347909    0.466385    0.472574    0.904224    0.908577    0.912783    0.886650    0.887614    0.851190    3800        38.287154   0.308272    0.243129    163.963729 
[37m[36mINFO[0m[0m 03/15 05:28:00 | 0.422621    0.445148    0.906161    0.883887    0.354157    0.422621    0.445148    0.901528    0.899332    0.922544    0.884131    0.894413    0.868197    4000        40.302267   0.283962    0.291974    167.717649 
[37m[36mINFO[0m[0m 03/15 05:31:40 | 0.430530    0.433544    0.880048    0.863158    0.405456    0.430530    0.433544    0.873540    0.878274    0.896411    0.875315    0.870193    0.835884    4200        42.317380   0.278655    0.265021    166.998311 
[37m[36mINFO[0m[0m 03/15 05:35:18 | 0.460849    0.467300    0.893905    0.877799    0.370955    0.460849    0.467300    0.909873    0.906009    0.893577    0.872796    0.878266    0.854592    4400        44.332494   0.274044    0.262315    165.447855 
[37m[36mINFO[0m[0m 03/15 05:39:01 | 0.500923    0.524262    0.908527    0.886543    0.335924    0.500923    0.524262    0.909231    0.909605    0.920025    0.897985    0.896325    0.852041    4600        46.347607   0.257479    0.284031    166.820649 
[37m[36mINFO[0m[0m 03/15 05:42:42 | 0.533351    0.532700    0.910580    0.882013    0.347237    0.533351    0.532700    0.908589    0.901900    0.928526    0.892947    0.894625    0.851190    4800        48.362720   0.244581    0.253059    170.208755 
[37m[36mINFO[0m[0m 03/15 05:46:25 | 0.543897    0.547468    0.916089    0.884220    0.346880    0.543897    0.547468    0.914752    0.910632    0.932305    0.891688    0.901211    0.850340    5000        50.377834   0.241195    0.284819    165.810239 
[37m[36mINFO[0m[0m 03/15 05:46:25 | Cumulative gradient change saved at train_output/TerraIncognita/GENIE/[0]/250315_04-08-35_resnet50_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/15 05:46:26 | ---
[37m[36mINFO[0m[0m 03/15 05:46:26 | test-domain validation(oracle) = 58.713%
[37m[36mINFO[0m[0m 03/15 05:46:26 | training-domain validation(iid) = 50.092%
[37m[36mINFO[0m[0m 03/15 05:46:26 | last = 54.390%
[37m[36mINFO[0m[0m 03/15 05:46:26 | last (inD) = 88.422%
[37m[36mINFO[0m[0m 03/15 05:46:26 | training-domain validation (iid, inD) = 88.654%
[37m[36mINFO[0m[0m 03/15 05:46:26 | === Summary ===
[37m[36mINFO[0m[0m 03/15 05:46:26 | Command: /jsm0707/GENIE/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm GENIE --test_envs 0 --dataset TerraIncognita
[37m[36mINFO[0m[0m 03/15 05:46:26 | Unique name: 250315_04-08-35_resnet50_adam
[37m[36mINFO[0m[0m 03/15 05:46:26 | Out path: train_output/TerraIncognita/GENIE/[0]/250315_04-08-35_resnet50_adam
[37m[36mINFO[0m[0m 03/15 05:46:26 | Algorithm: GENIE
[37m[36mINFO[0m[0m 03/15 05:46:26 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 03/15 13:29:33 | Command :: /jsm0707/GENIE/train_all.py B_Tera0_adam config/resnet50_adam.yaml --trial_seed 0 --hparams_seed 19 --algorithm GENIE --test_envs 0 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_adam.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 19
	in_domain: False
	model_save: None
	mpa: False
	name: B_Tera0_adam
	out_dir: train_output/TerraIncognita/GENIE/[0]/250315_13-29-33_B_Tera0_adam
	out_root: train_output/TerraIncognita/GENIE/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250315_13-29-33_B_Tera0_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5.513854977685438e-05
	batch_size: 27
	weight_decay: 0.0014556716107047517
	momentum: 0.9825164146767955
	convergence_rate: 0.00783236199583624
	moving_avg: 0.9545414323763227
	p: 0.7520697104227815
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 03/15 13:29:33 | n_steps = 5001
[37m[36mINFO[0m[0m 03/15 13:29:33 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 03/15 13:29:33 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 03/15 13:29:33 | 
[37m[36mINFO[0m[0m 03/15 13:29:33 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 03/15 13:29:33 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 03/15 13:29:33 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 03/15 13:29:33 | Batch sizes for each domain: [0, 27, 27, 27] (total=81)
[37m[36mINFO[0m[0m 03/15 13:29:33 | steps-per-epoch for each domain: 288.48, 117.63, 174.33 -> min = 117.63
[37m[36mINFO[0m[0m 03/15 13:29:34 | # of params = 23528522
[37m[36mINFO[0m[0m 03/15 13:32:24 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 03/15 13:32:24 | 0.209597    0.221519    0.265608    0.293846    2.085001    0.209597    0.221519    0.446912    0.488444    0.122166    0.181360    0.227746    0.211735    0           0.000000    2.371385    1.088524    168.264324 
[37m[36mINFO[0m[0m 03/15 13:35:57 | 0.342209    0.347046    0.651389    0.670048    0.922359    0.342209    0.347046    0.740532    0.748844    0.603904    0.647355    0.609730    0.613946    200         1.700252    1.290967    0.228851    167.406928 
[37m[36mINFO[0m[0m 03/15 13:39:36 | 0.498023    0.491561    0.726491    0.749012    0.710387    0.498023    0.491561    0.771601    0.787879    0.713161    0.735516    0.694710    0.723639    400         3.400504    0.829805    0.223112    174.262971 
[37m[36mINFO[0m[0m 03/15 13:43:03 | 0.465331    0.454641    0.759193    0.773762    0.632104    0.465331    0.454641    0.802799    0.829481    0.740554    0.775819    0.734226    0.715986    600         5.100756    0.709703    0.227634    162.229743 
[37m[36mINFO[0m[0m 03/15 13:46:35 | 0.406538    0.406118    0.768205    0.771689    0.622174    0.406538    0.406118    0.817563    0.826913    0.753463    0.761965    0.733588    0.726190    800         6.801008    0.658484    0.229522    165.418937 
[37m[36mINFO[0m[0m 03/15 13:50:13 | 0.465858    0.471519    0.788856    0.797098    0.566384    0.465858    0.471519    0.823726    0.845917    0.778023    0.775819    0.764818    0.769558    1000        8.501259    0.610240    0.245319    169.632482 
[37m[36mINFO[0m[0m 03/15 13:54:04 | 0.399684    0.417722    0.793192    0.800904    0.550446    0.399684    0.417722    0.838105    0.853621    0.777078    0.784635    0.764393    0.764456    1200        10.201511   0.581894    0.278067    175.126244 
[37m[36mINFO[0m[0m 03/15 13:57:46 | 0.570261    0.577004    0.800376    0.798016    0.556758    0.570261    0.577004    0.832456    0.835131    0.794081    0.780856    0.774591    0.778061    1400        11.901763   0.529749    0.288326    164.366759 
[37m[36mINFO[0m[0m 03/15 14:01:34 | 0.243343    0.247890    0.804806    0.820358    0.511293    0.243343    0.247890    0.834895    0.857730    0.818955    0.831234    0.760569    0.772109    1600        13.602015   0.489989    0.272259    173.164660 
[37m[36mINFO[0m[0m 03/15 14:05:10 | 0.362246    0.388186    0.830038    0.815084    0.505662    0.362246    0.388186    0.856079    0.871597    0.835013    0.792191    0.799023    0.781463    1800        15.302267   0.478679    0.246029    166.540415 
[37m[36mINFO[0m[0m 03/15 14:08:53 | 0.451621    0.465190    0.826414    0.837189    0.468609    0.451621    0.465190    0.864167    0.888033    0.821788    0.814861    0.793287    0.808673    2000        17.002519   0.472731    0.234317    176.563913 
[37m[36mINFO[0m[0m 03/15 14:12:33 | 0.508832    0.509494    0.839091    0.830760    0.481414    0.508832    0.509494    0.856079    0.877247    0.846662    0.814861    0.814532    0.800170    2200        18.702771   0.441452    0.237927    172.742440 
[37m[36mINFO[0m[0m 03/15 14:16:15 | 0.550224    0.565401    0.856094    0.844641    0.438093    0.550224    0.565401    0.871871    0.882897    0.859572    0.826196    0.836839    0.824830    2400        20.403023   0.435381    0.238448    173.542035 
[37m[36mINFO[0m[0m 03/15 14:19:49 | 0.413129    0.433544    0.857573    0.835810    0.445954    0.413129    0.433544    0.877776    0.889060    0.866814    0.819899    0.828128    0.798469    2600        22.103275   0.394192    0.232748    167.626655 
[37m[36mINFO[0m[0m 03/15 14:23:23 | 0.494595    0.518987    0.858671    0.850157    0.421019    0.494595    0.518987    0.872384    0.882383    0.868703    0.855164    0.834927    0.812925    2800        23.803526   0.397200    0.236226    166.934956 
[37m[36mINFO[0m[0m 03/15 14:27:00 | 0.587398    0.608650    0.863409    0.858542    0.404635    0.587398    0.608650    0.883169    0.895223    0.866184    0.856423    0.840875    0.823980    3000        25.503778   0.374108    0.230591    170.628216 
[37m[36mINFO[0m[0m 03/15 14:30:41 | 0.588452    0.598101    0.870465    0.851983    0.418299    0.588452    0.598101    0.875979    0.895223    0.884131    0.832494    0.851285    0.828231    3200        27.204030   0.375472    0.259186    169.758999 
[37m[36mINFO[0m[0m 03/15 14:34:28 | 0.542315    0.536920    0.864440    0.854672    0.405641    0.542315    0.536920    0.874182    0.889060    0.868703    0.850126    0.850436    0.824830    3400        28.904282   0.362828    0.286045    169.578904 
[37m[36mINFO[0m[0m 03/15 14:38:17 | 0.506196    0.534810    0.869807    0.846911    0.426845    0.506196    0.534810    0.880216    0.883410    0.879408    0.832494    0.849798    0.824830    3600        30.604534   0.346640    0.296560    169.916775 
[37m[36mINFO[0m[0m 03/15 14:41:54 | 0.467440    0.469409    0.881232    0.861244    0.401030    0.467440    0.469409    0.892798    0.903955    0.895151    0.838791    0.855747    0.840986    3800        32.304786   0.344237    0.262817    163.917832 
[37m[36mINFO[0m[0m 03/15 14:45:22 | 0.442921    0.454641    0.874758    0.850425    0.442760    0.442921    0.454641    0.879189    0.882897    0.883816    0.832494    0.861270    0.835884    4000        34.005038   0.312045    0.242519    159.730274 
[37m[36mINFO[0m[0m 03/15 14:48:53 | 0.544688    0.547468    0.877265    0.864774    0.401710    0.544688    0.547468    0.889459    0.909605    0.891688    0.851385    0.850648    0.833333    4200        35.705290   0.317696    0.236466    163.436493 
[37m[36mINFO[0m[0m 03/15 14:52:20 | 0.528342    0.554852    0.889064    0.875303    0.367179    0.528342    0.554852    0.877776    0.899846    0.916247    0.876574    0.873168    0.849490    4400        37.405542   0.312236    0.227162    162.079417 
[37m[36mINFO[0m[0m 03/15 14:55:54 | 0.586871    0.602321    0.892156    0.883958    0.356705    0.586871    0.602321    0.899474    0.910632    0.906801    0.886650    0.870193    0.854592    4600        39.105793   0.318907    0.225473    169.010006 
[37m[36mINFO[0m[0m 03/15 14:59:22 | 0.516741    0.531646    0.895712    0.875370    0.372577    0.516741    0.531646    0.899730    0.898819    0.906801    0.880353    0.880603    0.846939    4800        40.806045   0.296329    0.221162    162.825036 
[37m[36mINFO[0m[0m 03/15 15:02:54 | 0.439494    0.451477    0.904268    0.873974    0.369515    0.439494    0.451477    0.913339    0.915254    0.919710    0.863980    0.879754    0.842687    5000        42.506297   0.272300    0.225285    167.767894 
[37m[36mINFO[0m[0m 03/15 15:02:54 | Cumulative gradient change saved at train_output/TerraIncognita/GENIE/[0]/250315_13-29-33_B_Tera0_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 03/15 15:02:55 | ---
[37m[36mINFO[0m[0m 03/15 15:02:55 | test-domain validation(oracle) = 58.740%
[37m[36mINFO[0m[0m 03/15 15:02:55 | training-domain validation(iid) = 58.687%
[37m[36mINFO[0m[0m 03/15 15:02:55 | last = 43.949%
[37m[36mINFO[0m[0m 03/15 15:02:55 | last (inD) = 87.397%
[37m[36mINFO[0m[0m 03/15 15:02:55 | training-domain validation (iid, inD) = 88.396%
[37m[36mINFO[0m[0m 03/15 15:02:56 | === Summary ===
[37m[36mINFO[0m[0m 03/15 15:02:56 | Command: /jsm0707/GENIE/train_all.py B_Tera0_adam config/resnet50_adam.yaml --trial_seed 0 --hparams_seed 19 --algorithm GENIE --test_envs 0 --dataset TerraIncognita
[37m[36mINFO[0m[0m 03/15 15:02:56 | Unique name: 250315_13-29-33_B_Tera0_adam
[37m[36mINFO[0m[0m 03/15 15:02:56 | Out path: train_output/TerraIncognita/GENIE/[0]/250315_13-29-33_B_Tera0_adam
[37m[36mINFO[0m[0m 03/15 15:02:56 | Algorithm: GENIE
[37m[36mINFO[0m[0m 03/15 15:02:56 | Dataset: TerraIncognita

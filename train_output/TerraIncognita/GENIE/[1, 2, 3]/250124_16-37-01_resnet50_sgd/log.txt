[37m[36mINFO[0m[0m 01/24 16:37:01 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 1 2 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: GENIE
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/TerraIncognita/GENIE/[1, 2, 3]/250124_16-37-01_resnet50_sgd
	out_root: train_output/TerraIncognita/GENIE/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 2
	unique_name: 250124_16-37-01_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 3.1159521264763664e-05
	batch_size: 11
	weight_decay: 1.4650833494643601e-05
	momentum: 0.8489654784568189
	convergence_rate: 0.0014662523646731694
	moving_avg: 0.9055169203703878
	p: 0.5984347546894057
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/24 16:37:01 | n_steps = 5001
[37m[36mINFO[0m[0m 01/24 16:37:01 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/24 16:37:01 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/24 16:37:01 | 
[37m[36mINFO[0m[0m 01/24 16:37:01 | Testenv name escaping te_L38_L43_L46 -> te_L38_L43_L46
[37m[36mINFO[0m[0m 01/24 16:37:01 | Test envs = [1, 2, 3], name = te_L38_L43_L46
[37m[36mINFO[0m[0m 01/24 16:37:01 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 01/24 16:37:01 | Batch sizes for each domain: [11, 0, 0, 0] (total=11)
[37m[36mINFO[0m[0m 01/24 16:37:01 | steps-per-epoch for each domain: 344.82 -> min = 344.82
[37m[36mINFO[0m[0m 01/24 16:37:02 | # of params = 23528522
[37m[36mINFO[0m[0m 01/24 16:40:09 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/24 16:40:09 | 0.271791    0.251091    0.238861    0.232068    2.199538    0.238861    0.232068    0.445372    0.421674    0.164987    0.136020    0.205014    0.195578    0           0.000000    3.251575    1.290071    184.856595 
[37m[36mINFO[0m[0m 01/24 16:43:46 | 0.235303    0.235664    0.727656    0.738397    0.875648    0.727656    0.738397    0.305816    0.297894    0.153652    0.159950    0.246441    0.249150    200         0.580016    1.153900    0.166179    183.624844 
[37m[36mINFO[0m[0m 01/24 16:47:27 | 0.172828    0.176876    0.746375    0.752110    0.743124    0.746375    0.752110    0.138144    0.151002    0.144521    0.137280    0.235819    0.242347    400         1.160032    0.822144    0.198497    181.636759 
[37m[36mINFO[0m[0m 01/24 16:50:52 | 0.289617    0.283734    0.784867    0.768987    0.660241    0.784867    0.768987    0.376300    0.353364    0.202771    0.202771    0.289781    0.295068    600         1.740047    0.701420    0.144635    175.748895 
[37m[36mINFO[0m[0m 01/24 16:54:02 | 0.286273    0.282691    0.819931    0.820675    0.575090    0.819931    0.820675    0.338683    0.331279    0.214421    0.216625    0.305715    0.300170    800         2.320063    0.616171    0.159133    157.744144 
[37m[36mINFO[0m[0m 01/24 16:57:13 | 0.229210    0.230910    0.829423    0.823840    0.511195    0.829423    0.823840    0.188214    0.193631    0.206234    0.204030    0.293180    0.295068    1000        2.900079    0.572193    0.136890    162.795101 
[37m[36mINFO[0m[0m 01/24 17:00:27 | 0.212010    0.214755    0.853151    0.839662    0.477814    0.853151    0.839662    0.224034    0.228043    0.126889    0.134761    0.285107    0.281463    1200        3.480095    0.487766    0.160405    161.741958 
[37m[36mINFO[0m[0m 01/24 17:03:41 | 0.220665    0.226472    0.824941    0.825949    0.486090    0.824941    0.825949    0.170368    0.177196    0.191436    0.192695    0.300191    0.309524    1400        4.060111    0.476893    0.167969    160.394934 
[37m[36mINFO[0m[0m 01/24 17:07:08 | 0.222560    0.219633    0.870024    0.857595    0.416473    0.870024    0.857595    0.222622    0.231125    0.159950    0.162469    0.285107    0.265306    1600        4.640127    0.461342    0.232932    160.962931 
[37m[36mINFO[0m[0m 01/24 17:10:31 | 0.238027    0.237209    0.866596    0.855485    0.410607    0.866596    0.855485    0.216973    0.230098    0.186083    0.181360    0.311026    0.300170    1800        5.220142    0.477601    0.203259    162.658411 
[37m[36mINFO[0m[0m 01/24 17:13:38 | 0.248571    0.251477    0.869760    0.857595    0.386140    0.869760    0.857595    0.242393    0.247047    0.190806    0.187657    0.312513    0.319728    2000        5.800158    0.416228    0.157983    155.451334 
[37m[36mINFO[0m[0m 01/24 17:16:52 | 0.267042    0.260213    0.885051    0.858650    0.379224    0.885051    0.858650    0.279497    0.284027    0.213791    0.198992    0.307839    0.297619    2200        6.380174    0.364991    0.163078    160.586810 
[37m[36mINFO[0m[0m 01/24 17:20:06 | 0.182154    0.184139    0.872660    0.855485    0.438806    0.872660    0.855485    0.192708    0.194145    0.147040    0.144836    0.206713    0.213435    2400        6.960190    0.375254    0.176586    158.826581 
[37m[36mINFO[0m[0m 01/24 17:23:26 | 0.289151    0.279411    0.844450    0.782700    0.651207    0.844450    0.782700    0.382591    0.355419    0.215050    0.214106    0.269811    0.268707    2600        7.540206    0.345068    0.216373    156.717034 
[37m[36mINFO[0m[0m 01/24 17:26:35 | 0.241870    0.247430    0.888479    0.883966    0.344329    0.888479    0.883966    0.188728    0.198254    0.217569    0.214106    0.319312    0.329932    2800        8.120221    0.372159    0.180085    153.017344 
[37m[36mINFO[0m[0m 01/24 17:29:49 | 0.289939    0.287504    0.894015    0.864979    0.341823    0.894015    0.864979    0.282064    0.285568    0.244647    0.234257    0.343106    0.342687    3000        8.700237    0.342697    0.157956    161.711668 
[37m[36mINFO[0m[0m 01/24 17:33:06 | 0.288598    0.285323    0.904561    0.882911    0.327453    0.904561    0.882911    0.302606    0.295840    0.220718    0.219144    0.342469    0.340986    3200        9.280253    0.320359    0.158124    164.508433 
[37m[36mINFO[0m[0m 01/24 17:36:21 | 0.301968    0.297149    0.898234    0.883966    0.342644    0.898234    0.883966    0.343048    0.328197    0.204030    0.207809    0.358827    0.355442    3400        9.860269    0.353857    0.200316    154.901175 
[37m[36mINFO[0m[0m 01/24 17:39:34 | 0.296209    0.285840    0.908779    0.873418    0.329860    0.908779    0.873418    0.352035    0.343092    0.241499    0.235516    0.295092    0.278912    3600        10.440285   0.309714    0.205806    151.185542 
[37m[36mINFO[0m[0m 01/24 17:42:39 | 0.296659    0.285346    0.910361    0.883966    0.318986    0.910361    0.883966    0.339325    0.331279    0.238350    0.225441    0.312301    0.299320    3800        11.020301   0.293457    0.138270    157.586014 
[37m[36mINFO[0m[0m 01/24 17:45:45 | 0.289451    0.284980    0.920116    0.895570    0.301741    0.920116    0.895570    0.290538    0.286595    0.240869    0.241814    0.336945    0.326531    4000        11.600316   0.261758    0.148031    156.464329 
[37m[36mINFO[0m[0m 01/24 17:48:48 | 0.288974    0.277222    0.902188    0.877637    0.305193    0.902188    0.877637    0.360508    0.344633    0.215995    0.216625    0.290419    0.270408    4200        12.180332   0.250146    0.150465    152.589924 
[37m[36mINFO[0m[0m 01/24 17:51:45 | 0.240219    0.238044    0.900870    0.892405    0.320179    0.900870    0.892405    0.250738    0.257833    0.194584    0.192695    0.275335    0.263605    4400        12.760348   0.246051    0.142499    148.219506 
[37m[36mINFO[0m[0m 01/24 17:54:52 | 0.302106    0.291698    0.908252    0.887131    0.330572    0.908252    0.887131    0.376428    0.354391    0.207179    0.210327    0.322711    0.310374    4600        13.340364   0.245998    0.156745    156.324643 
[37m[36mINFO[0m[0m 01/24 17:57:54 | 0.283517    0.268014    0.900606    0.873418    0.301314    0.900606    0.873418    0.281294    0.274782    0.254408    0.239295    0.314850    0.289966    4800        13.920380   0.237045    0.151819    151.774383 
[37m[36mINFO[0m[0m 01/24 18:00:58 | 0.290309    0.278023    0.916952    0.895570    0.282661    0.916952    0.895570    0.290923    0.275295    0.244332    0.225441    0.335670    0.333333    5000        14.500395   0.238483    0.144277    154.277778 
[37m[36mINFO[0m[0m 01/24 18:00:58 | Cumulative gradient change saved at train_output/TerraIncognita/GENIE/[1, 2, 3]/250124_16-37-01_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/24 18:00:59 | ---
[37m[36mINFO[0m[0m 01/24 18:00:59 | test-domain validation(oracle) = 30.197%
[37m[36mINFO[0m[0m 01/24 18:00:59 | training-domain validation(iid) = 28.945%
[37m[36mINFO[0m[0m 01/24 18:00:59 | last = 29.031%
[37m[36mINFO[0m[0m 01/24 18:00:59 | last (inD) = 89.557%
[37m[36mINFO[0m[0m 01/24 18:00:59 | training-domain validation (iid, inD) = 89.557%
[37m[36mINFO[0m[0m 01/24 18:00:59 | === Summary ===
[37m[36mINFO[0m[0m 01/24 18:00:59 | Command: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm GENIE --test_envs 1 2 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 1
[37m[36mINFO[0m[0m 01/24 18:00:59 | Unique name: 250124_16-37-01_resnet50_sgd
[37m[36mINFO[0m[0m 01/24 18:00:59 | Out path: train_output/TerraIncognita/GENIE/[1, 2, 3]/250124_16-37-01_resnet50_sgd
[37m[36mINFO[0m[0m 01/24 18:00:59 | Algorithm: GENIE
[37m[36mINFO[0m[0m 01/24 18:00:59 | Dataset: TerraIncognita

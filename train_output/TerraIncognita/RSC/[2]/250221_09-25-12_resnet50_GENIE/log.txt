[37m[36mINFO[0m[0m 02/21 09:25:12 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 2 --dataset TerraIncognita --trial_seed 1 --hparams_seed 8
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 8
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[2]/250221_09-25-12_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 1
	unique_name: 250221_09-25-12_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 3.335053008064847e-05
	batch_size: 18
	weight_decay: 0.00011109601170966198
	rsc_f_drop_factor: 0.18129063791925754
	rsc_b_drop_factor: 0.03567706337646076
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/21 09:25:12 | n_steps = 5001
[37m[36mINFO[0m[0m 02/21 09:25:12 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/21 09:25:12 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/21 09:25:12 | 
[37m[36mINFO[0m[0m 02/21 09:25:12 | Testenv name escaping te_L43 -> te_L43
[37m[36mINFO[0m[0m 02/21 09:25:12 | Test envs = [2], name = te_L43
[37m[36mINFO[0m[0m 02/21 09:25:12 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 02/21 09:25:12 | Batch sizes for each domain: [18, 18, 0, 18] (total=54)
[37m[36mINFO[0m[0m 02/21 09:25:12 | steps-per-epoch for each domain: 210.72, 432.72, 261.50 -> min = 210.72
[37m[36mINFO[0m[0m 02/21 09:25:15 | # of params = 23528522
[37m[36mINFO[0m[0m 02/21 09:28:31 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/21 09:28:31 | 0.098866    0.095718    0.253282    0.258535    1.989372    0.515423    0.540084    0.020927    0.022085    0.098866    0.095718    0.223497    0.213435    0           0.000000    2.539998    2.112880    194.415328 
[37m[36mINFO[0m[0m 02/21 09:32:38 | 0.300693    0.313602    0.572746    0.582951    1.200067    0.694437    0.715190    0.596354    0.588084    0.300693    0.313602    0.427448    0.445578    200         0.949117    1.455211    0.280234    190.835363 
[37m[36mINFO[0m[0m 02/21 09:36:43 | 0.277393    0.301008    0.609154    0.609438    1.071442    0.756657    0.762658    0.603415    0.591166    0.277393    0.301008    0.467389    0.474490    400         1.898234    1.196995    0.265438    191.423767 
[37m[36mINFO[0m[0m 02/21 09:40:47 | 0.284005    0.282116    0.655767    0.669126    0.968208    0.779858    0.801688    0.663757    0.678480    0.284005    0.282116    0.523688    0.527211    600         2.847350    1.083314    0.258243    192.727679 
[37m[36mINFO[0m[0m 02/21 09:44:51 | 0.353904    0.356423    0.678920    0.671662    0.871828    0.804640    0.814346    0.696110    0.686184    0.353904    0.356423    0.536010    0.514456    800         3.796467    0.958843    0.257560    192.513071 
[37m[36mINFO[0m[0m 02/21 09:48:53 | 0.396096    0.408060    0.744787    0.744622    0.723912    0.832059    0.835443    0.774939    0.787879    0.396096    0.408060    0.627364    0.610544    1000        4.745584    0.829841    0.291996    183.417128 
[37m[36mINFO[0m[0m 02/21 09:52:53 | 0.373111    0.396725    0.718032    0.720834    0.779055    0.800158    0.789030    0.731673    0.744222    0.373111    0.396725    0.622265    0.629252    1200        5.694701    0.743691    0.240694    192.156320 
[37m[36mINFO[0m[0m 02/21 09:57:02 | 0.426322    0.439547    0.780740    0.774224    0.634543    0.866069    0.849156    0.792913    0.801746    0.426322    0.439547    0.683238    0.671769    1400        6.643818    0.692908    0.214576    205.440377 
[37m[36mINFO[0m[0m 02/21 10:01:13 | 0.490869    0.497481    0.793796    0.778726    0.592423    0.872133    0.864979    0.799461    0.785824    0.490869    0.497481    0.709794    0.685374    1600        7.592934    0.635627    0.223269    206.535083 
[37m[36mINFO[0m[0m 02/21 10:05:29 | 0.518262    0.516373    0.797824    0.783400    0.598748    0.886106    0.855485    0.808833    0.818695    0.518262    0.516373    0.698534    0.676020    1800        8.542051    0.605950    0.219784    212.383209 
[37m[36mINFO[0m[0m 02/21 10:09:38 | 0.501574    0.521411    0.811146    0.806399    0.554231    0.889270    0.888186    0.809732    0.829481    0.501574    0.521411    0.734438    0.701531    2000        9.491168    0.560022    0.216728    205.207621 
[37m[36mINFO[0m[0m 02/21 10:13:53 | 0.484257    0.488665    0.816427    0.815448    0.525699    0.888742    0.875527    0.817178    0.831022    0.484257    0.488665    0.743361    0.739796    2200        10.440285   0.541414    0.279284    198.835963 
[37m[36mINFO[0m[0m 02/21 10:18:09 | 0.493703    0.483627    0.796397    0.790201    0.609709    0.877933    0.850211    0.770446    0.792501    0.493703    0.483627    0.740812    0.727891    2400        11.389402   0.523187    0.261796    204.308185 
[37m[36mINFO[0m[0m 02/21 10:22:26 | 0.526448    0.526448    0.834352    0.826451    0.501067    0.898761    0.876582    0.833740    0.853621    0.526448    0.526448    0.770554    0.749150    2600        12.338518   0.506353    0.281505    200.645145 
[37m[36mINFO[0m[0m 02/21 10:26:49 | 0.498111    0.478589    0.839603    0.838957    0.476125    0.913789    0.883966    0.834253    0.858243    0.498111    0.478589    0.770767    0.774660    2800        13.287635   0.493469    0.309463    201.024109 
[37m[36mINFO[0m[0m 02/21 10:31:00 | 0.544395    0.564232    0.851656    0.847126    0.456915    0.915634    0.898734    0.843497    0.865434    0.544395    0.564232    0.795836    0.777211    3000        14.236752   0.476573    0.264395    198.355109 
[37m[36mINFO[0m[0m 02/21 10:35:14 | 0.506612    0.525189    0.847479    0.843145    0.453045    0.918270    0.904008    0.831942    0.859271    0.506612    0.525189    0.792224    0.766156    3200        15.185869   0.473677    0.238520    206.221336 
[37m[36mINFO[0m[0m 02/21 10:39:15 | 0.538413    0.556675    0.856400    0.850572    0.437875    0.922489    0.901899    0.847477    0.870056    0.538413    0.556675    0.799235    0.779762    3400        16.134985   0.433865    0.224690    196.075712 
[37m[36mINFO[0m[0m 02/21 10:43:23 | 0.539987    0.531486    0.865610    0.854698    0.416039    0.927498    0.909283    0.861600    0.879301    0.539987    0.531486    0.807733    0.775510    3600        17.084102   0.413976    0.269883    193.828969 
[37m[36mINFO[0m[0m 02/21 10:47:42 | 0.558879    0.578086    0.855659    0.839792    0.438640    0.921698    0.896624    0.855180    0.865948    0.558879    0.578086    0.790100    0.756803    3800        18.033219   0.426711    0.276855    203.772197 
[37m[36mINFO[0m[0m 02/21 10:51:51 | 0.535264    0.525189    0.871083    0.857690    0.408012    0.916689    0.891350    0.872256    0.884951    0.535264    0.525189    0.824304    0.796769    4000        18.982336   0.412692    0.230145    202.734038 
[37m[36mINFO[0m[0m 02/21 10:56:00 | 0.502834    0.516373    0.869341    0.851716    0.434762    0.927234    0.895570    0.871357    0.879815    0.502834    0.516373    0.809433    0.779762    4200        19.931453   0.395314    0.271988    194.213220 
[37m[36mINFO[0m[0m 02/21 11:00:00 | 0.538728    0.555416    0.874236    0.855874    0.424534    0.944108    0.909283    0.862370    0.872625    0.538728    0.555416    0.816231    0.785714    4400        20.880569   0.387286    0.228594    194.480254 
[37m[36mINFO[0m[0m 02/21 11:04:07 | 0.560139    0.557935    0.884207    0.866679    0.379214    0.935144    0.909283    0.885736    0.888033    0.560139    0.557935    0.831740    0.802721    4600        21.829686   0.371549    0.212686    204.589498 
[37m[36mINFO[0m[0m 02/21 11:08:08 | 0.518577    0.523929    0.862036    0.845186    0.433221    0.914579    0.886076    0.865708    0.870570    0.518577    0.523929    0.805821    0.778912    4800        22.778803   0.364442    0.219965    196.735531 
[37m[36mINFO[0m[0m 02/21 11:12:13 | 0.568640    0.573048    0.884085    0.869135    0.382084    0.938835    0.916667    0.883169    0.885465    0.568640    0.573048    0.830253    0.805272    5000        23.727920   0.357506    0.229881    199.327774 
[37m[36mINFO[0m[0m 02/21 11:12:13 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[2]/250221_09-25-12_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/21 11:12:15 | ---
[37m[36mINFO[0m[0m 02/21 11:12:15 | test-domain validation(oracle) = 55.888%
[37m[36mINFO[0m[0m 02/21 11:12:15 | training-domain validation(iid) = 56.864%
[37m[36mINFO[0m[0m 02/21 11:12:15 | last = 56.864%
[37m[36mINFO[0m[0m 02/21 11:12:15 | last (inD) = 86.913%
[37m[36mINFO[0m[0m 02/21 11:12:15 | training-domain validation (iid, inD) = 86.913%
[37m[36mINFO[0m[0m 02/21 11:12:15 | === Summary ===
[37m[36mINFO[0m[0m 02/21 11:12:15 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 2 --dataset TerraIncognita --trial_seed 1 --hparams_seed 8
[37m[36mINFO[0m[0m 02/21 11:12:15 | Unique name: 250221_09-25-12_resnet50_GENIE
[37m[36mINFO[0m[0m 02/21 11:12:15 | Out path: train_output/TerraIncognita/RSC/[2]/250221_09-25-12_resnet50_GENIE
[37m[36mINFO[0m[0m 02/21 11:12:15 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/21 11:12:15 | Dataset: TerraIncognita

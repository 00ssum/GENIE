[37m[36mINFO[0m[0m 01/31 15:18:27 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm RSC --test_envs 2 --dataset TerraIncognita --trial_seed 0 --hparams_seed 4
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 4
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/TerraIncognita/RSC/[2]/250131_15-18-27_resnet50_EVE
	out_root: train_output/TerraIncognita/RSC/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250131_15-18-27_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: EVE
	freeze_bn: False
	pretrained: True
	lr: 2.0793009436922532e-05
	batch_size: 30
	weight_decay: 0.0007980067844361917
	rsc_f_drop_factor: 0.00568084739259922
	rsc_b_drop_factor: 0.21660562421584156
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/31 15:18:27 | n_steps = 5001
[37m[36mINFO[0m[0m 01/31 15:18:27 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/31 15:18:27 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/31 15:18:27 | Target test envs = [[2]]
[37m[36mINFO[0m[0m 01/31 15:18:27 | 
[37m[36mINFO[0m[0m 01/31 15:18:27 | Testenv name escaping te_L43 -> te_L43
[37m[36mINFO[0m[0m 01/31 15:18:27 | Test envs = [2], name = te_L43
[37m[36mINFO[0m[0m 01/31 15:18:27 | Batch sizes for each domain: [30, 30, 0, 30] (total=90)
[37m[36mINFO[0m[0m 01/31 15:18:27 | steps-per-epoch for each domain: 126.43, 259.63, 156.90 -> min = 126.43
[37m[36mINFO[0m[0m 01/31 15:18:29 | # of params = 23528522
[37m[36mINFO[0m[0m 01/31 15:21:21 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/31 15:21:21 | 0.121537    0.130982    0.357595    0.361929    1.914159    0.522805    0.518987    0.332007    0.353364    0.121537    0.130982    0.217973    0.213435    0           0.000000    2.495058    1.045633    171.553963 
[37m[36mINFO[0m[0m 01/31 15:25:12 | 0.263224    0.288413    0.570637    0.572213    1.151617    0.684682    0.678270    0.582360    0.605547    0.263224    0.288413    0.444869    0.432823    200         1.581861    1.413439    0.292079    171.578318 
[37m[36mINFO[0m[0m 01/31 15:29:00 | 0.323363    0.346348    0.656661    0.656782    0.928302    0.801213    0.775316    0.636795    0.661017    0.323363    0.346348    0.531974    0.534014    400         3.163723    1.117978    0.261592    175.380332 
[37m[36mINFO[0m[0m 01/31 15:32:45 | 0.344773    0.327456    0.734934    0.747111    0.734045    0.845505    0.839662    0.750417    0.764766    0.344773    0.327456    0.608880    0.636905    600         4.745584    0.892308    0.265250    172.041319 
[37m[36mINFO[0m[0m 01/31 15:36:30 | 0.409005    0.413098    0.772659    0.788369    0.615717    0.868178    0.861814    0.773784    0.804314    0.409005    0.413098    0.676014    0.698980    800         6.327445    0.751253    0.261938    172.327490 
[37m[36mINFO[0m[0m 01/31 15:40:23 | 0.474496    0.482368    0.781908    0.792805    0.599910    0.872397    0.870253    0.790089    0.820236    0.474496    0.482368    0.683238    0.687925    1000        7.909307    0.672764    0.284120    176.405572 
[37m[36mINFO[0m[0m 01/31 15:44:31 | 0.453086    0.450882    0.783103    0.798360    0.566677    0.870024    0.875527    0.791372    0.819723    0.453086    0.450882    0.687912    0.699830    1200        9.491168    0.612847    0.346343    177.943521 
[37m[36mINFO[0m[0m 01/31 15:48:41 | 0.456864    0.465995    0.814719    0.822200    0.517604    0.882942    0.874473    0.816793    0.838726    0.456864    0.465995    0.744423    0.753401    1400        11.073029   0.562303    0.349529    179.879178 
[37m[36mINFO[0m[0m 01/31 15:52:42 | 0.507242    0.521411    0.820794    0.819384    0.513301    0.894543    0.876582    0.821928    0.836672    0.507242    0.521411    0.745910    0.744898    1600        12.654891   0.534963    0.318977    176.557643 
[37m[36mINFO[0m[0m 01/31 15:56:35 | 0.520781    0.545340    0.830465    0.836745    0.512864    0.889533    0.880802    0.826422    0.847971    0.520781    0.545340    0.775441    0.781463    1800        14.236752   0.501941    0.266449    180.344634 
[37m[36mINFO[0m[0m 01/31 16:00:25 | 0.510390    0.494962    0.839446    0.839333    0.452460    0.895070    0.896624    0.831044    0.838213    0.510390    0.494962    0.792224    0.783163    2000        15.818613   0.465561    0.257511    177.619657 
[37m[36mINFO[0m[0m 01/31 16:04:12 | 0.501259    0.506297    0.849879    0.841088    0.449497    0.913261    0.889241    0.839902    0.847458    0.501259    0.506297    0.796473    0.786565    2200        17.400475   0.443613    0.263880    173.743881 
[37m[36mINFO[0m[0m 01/31 16:08:24 | 0.510705    0.494962    0.857827    0.850292    0.420420    0.918534    0.906118    0.852099    0.850539    0.510705    0.494962    0.802847    0.794218    2400        18.982336   0.431194    0.342321    182.966074 
[37m[36mINFO[0m[0m 01/31 16:12:11 | 0.510390    0.513854    0.862630    0.849297    0.434890    0.922752    0.899789    0.863140    0.867488    0.510390    0.513854    0.801997    0.780612    2600        20.564197   0.397773    0.259943    174.744771 
[37m[36mINFO[0m[0m 01/31 16:15:55 | 0.544395    0.544081    0.853838    0.837571    0.443408    0.916952    0.885021    0.849788    0.867488    0.544395    0.544081    0.794774    0.760204    2800        22.146059   0.382676    0.270326    170.240656 
[37m[36mINFO[0m[0m 01/31 16:20:02 | 0.511020    0.502519    0.878406    0.857803    0.406433    0.945162    0.914557    0.865965    0.873138    0.511020    0.502519    0.824092    0.785714    3000        23.727920   0.392220    0.357115    175.528002 
[37m[36mINFO[0m[0m 01/31 16:23:57 | 0.488035    0.507557    0.878684    0.861078    0.404072    0.941207    0.917722    0.875851    0.877247    0.488035    0.507557    0.818993    0.788265    3200        25.309781   0.368142    0.303852    173.919370 
[37m[36mINFO[0m[0m 01/31 16:27:52 | 0.546285    0.573048    0.878204    0.869545    0.378763    0.925125    0.911392    0.867762    0.866461    0.546285    0.573048    0.841725    0.830782    3400        26.891642   0.341065    0.273152    180.107794 
[37m[36mINFO[0m[0m 01/31 16:31:59 | 0.537783    0.549118    0.895302    0.881095    0.372928    0.945426    0.919831    0.887919    0.895223    0.537783    0.549118    0.852560    0.828231    3600        28.473504   0.339585    0.345238    177.848666 
[37m[36mINFO[0m[0m 01/31 16:35:55 | 0.520781    0.555416    0.883822    0.870871    0.379507    0.946480    0.916667    0.879831    0.876220    0.520781    0.555416    0.825154    0.819728    3800        30.055365   0.327423    0.322799    171.318930 
[37m[36mINFO[0m[0m 01/31 16:39:50 | 0.565491    0.576826    0.894223    0.876710    0.375582    0.950699    0.914557    0.880472    0.886492    0.565491    0.576826    0.851498    0.829082    4000        31.637226   0.314244    0.293113    175.759748 
[37m[36mINFO[0m[0m 01/31 16:43:55 | 0.534320    0.556675    0.901246    0.885123    0.358503    0.955181    0.924051    0.894723    0.901387    0.534320    0.556675    0.853835    0.829932    4200        33.219088   0.307820    0.298742    185.078177 
[37m[36mINFO[0m[0m 01/31 16:47:55 | 0.548174    0.579345    0.895408    0.887308    0.337273    0.956499    0.945148    0.875465    0.888546    0.548174    0.579345    0.854260    0.828231    4400        34.800949   0.308071    0.346056    170.507500 
[37m[36mINFO[0m[0m 01/31 16:51:46 | 0.542506    0.574307    0.890972    0.877041    0.374479    0.947271    0.921941    0.875209    0.871597    0.542506    0.574307    0.850436    0.837585    4600        36.382810   0.298411    0.295336    171.779498 
[37m[36mINFO[0m[0m 01/31 16:55:34 | 0.538098    0.552897    0.910746    0.890205    0.339593    0.965199    0.927215    0.900244    0.902414    0.538098    0.552897    0.866794    0.840986    4800        37.964672   0.276750    0.290910    169.645426 
[37m[36mINFO[0m[0m 01/31 16:59:43 | 0.552267    0.550378    0.913294    0.890356    0.342111    0.964672    0.930380    0.902041    0.903955    0.552267    0.550378    0.873168    0.836735    5000        39.546533   0.264760    0.381244    172.485061 
[37m[36mINFO[0m[0m 01/31 16:59:43 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[2]/250131_15-18-27_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/31 16:59:45 | ---
[37m[36mINFO[0m[0m 01/31 16:59:45 | test-domain validation(oracle) = 54.817%
[37m[36mINFO[0m[0m 01/31 16:59:45 | training-domain validation(iid) = 55.227%
[37m[36mINFO[0m[0m 01/31 16:59:45 | last = 55.227%
[37m[36mINFO[0m[0m 01/31 16:59:45 | last (inD) = 89.036%
[37m[36mINFO[0m[0m 01/31 16:59:45 | training-domain validation (iid, inD) = 89.036%
[37m[36mINFO[0m[0m 01/31 16:59:45 | === Summary ===
[37m[36mINFO[0m[0m 01/31 16:59:45 | Command: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm RSC --test_envs 2 --dataset TerraIncognita --trial_seed 0 --hparams_seed 4
[37m[36mINFO[0m[0m 01/31 16:59:45 | Unique name: 250131_15-18-27_resnet50_EVE
[37m[36mINFO[0m[0m 01/31 16:59:45 | Out path: train_output/TerraIncognita/RSC/[2]/250131_15-18-27_resnet50_EVE
[37m[36mINFO[0m[0m 01/31 16:59:45 | Algorithm: RSC
[37m[36mINFO[0m[0m 01/31 16:59:45 | Dataset: TerraIncognita
[37m[36mINFO[0m[0m 01/31 16:59:45 | Max test_in: 0.5655

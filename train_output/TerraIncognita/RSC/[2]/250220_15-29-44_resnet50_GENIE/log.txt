[37m[36mINFO[0m[0m 02/20 15:29:44 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 2 --dataset TerraIncognita --trial_seed 0 --hparams_seed 18
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 18
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[2]/250220_15-29-44_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [2]
	trial_seed: 0
	unique_name: 250220_15-29-44_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.00021894640154701087
	batch_size: 13
	weight_decay: 7.1565884139944e-05
	rsc_f_drop_factor: 0.17180978572145622
	rsc_b_drop_factor: 0.27683104155644905
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/20 15:29:44 | n_steps = 5001
[37m[36mINFO[0m[0m 02/20 15:29:44 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/20 15:29:44 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/20 15:29:44 | 
[37m[36mINFO[0m[0m 02/20 15:29:44 | Testenv name escaping te_L43 -> te_L43
[37m[36mINFO[0m[0m 02/20 15:29:44 | Test envs = [2], name = te_L43
[37m[36mINFO[0m[0m 02/20 15:29:44 | Train environments: [0, 1, 3], Test environments: [2]
[37m[36mINFO[0m[0m 02/20 15:29:44 | Batch sizes for each domain: [13, 13, 0, 13] (total=39)
[37m[36mINFO[0m[0m 02/20 15:29:44 | steps-per-epoch for each domain: 291.77, 599.15, 362.08 -> min = 291.77
[37m[36mINFO[0m[0m 02/20 15:29:45 | # of params = 23528522
[37m[36mINFO[0m[0m 02/20 15:33:01 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/20 15:33:01 | 0.096033    0.103275    0.259520    0.263251    2.045438    0.522542    0.520042    0.020413    0.023112    0.096033    0.103275    0.235607    0.246599    0           0.000000    3.044880    0.979720    195.350678 
[37m[36mINFO[0m[0m 02/20 15:36:48 | 0.171285    0.193955    0.432847    0.441679    1.436884    0.519114    0.534810    0.534472    0.552131    0.171285    0.193955    0.244954    0.238095    200         0.685473    1.713563    0.187778    189.224295 
[37m[36mINFO[0m[0m 02/20 15:40:34 | 0.265113    0.308564    0.520395    0.515599    1.260650    0.614553    0.580169    0.553601    0.583975    0.265113    0.308564    0.393032    0.382653    400         1.370946    1.539065    0.194858    187.355132 
[37m[36mINFO[0m[0m 02/20 15:44:13 | 0.256297    0.288413    0.526416    0.521326    1.226671    0.620881    0.582278    0.572346    0.599897    0.256297    0.288413    0.386021    0.381803    600         2.056420    1.353250    0.183814    181.671050 
[37m[36mINFO[0m[0m 02/20 15:48:00 | 0.283060    0.308564    0.566632    0.584054    1.163292    0.653572    0.682489    0.584671    0.607088    0.283060    0.308564    0.461653    0.462585    800         2.741893    1.262280    0.186011    190.665106 
[37m[36mINFO[0m[0m 02/20 15:51:51 | 0.296599    0.331234    0.592532    0.594961    1.090636    0.719220    0.705696    0.582488    0.605547    0.296599    0.331234    0.475887    0.473639    1000        3.427366    1.237265    0.190517    192.490200 
[37m[36mINFO[0m[0m 02/20 15:55:27 | 0.317380    0.385390    0.616075    0.620679    1.045811    0.757712    0.753165    0.602516    0.619928    0.317380    0.385390    0.487997    0.488946    1200        4.112839    1.208294    0.179540    179.839857 
[37m[36mINFO[0m[0m 02/20 15:59:15 | 0.305101    0.363980    0.594924    0.602853    1.060089    0.682573    0.701477    0.620362    0.631741    0.305101    0.363980    0.481836    0.475340    1400        4.798313    1.169223    0.175127    192.721444 
[37m[36mINFO[0m[0m 02/20 16:02:57 | 0.326511    0.384131    0.676116    0.674962    0.862765    0.824150    0.814346    0.671588    0.691834    0.326511    0.384131    0.532611    0.518707    1600        5.483786    1.068067    0.176166    187.232104 
[37m[36mINFO[0m[0m 02/20 16:06:38 | 0.337531    0.374055    0.703652    0.711836    0.777647    0.835486    0.820675    0.739248    0.749358    0.337531    0.374055    0.536223    0.565476    1800        6.169259    0.964597    0.188402    183.202371 
[37m[36mINFO[0m[0m 02/20 16:10:19 | 0.307935    0.337531    0.691865    0.684898    0.870940    0.832586    0.814346    0.721659    0.724191    0.307935    0.337531    0.521351    0.516156    2000        6.854732    0.895418    0.173868    186.643025 
[37m[36mINFO[0m[0m 02/20 16:14:06 | 0.370907    0.397985    0.718237    0.733318    0.723642    0.830477    0.843882    0.742971    0.761685    0.370907    0.397985    0.581262    0.594388    2200        7.540206    0.845965    0.173758    192.378067 
[37m[36mINFO[0m[0m 02/20 16:17:50 | 0.408375    0.387909    0.729265    0.752583    0.722997    0.850250    0.864979    0.714854    0.730354    0.408375    0.387909    0.622690    0.662415    2400        8.225679    0.821554    0.172985    189.275718 
[37m[36mINFO[0m[0m 02/20 16:21:27 | 0.374055    0.400504    0.762749    0.769628    0.642292    0.872660    0.873418    0.766979    0.783256    0.374055    0.400504    0.648608    0.652211    2600        8.911152    0.818248    0.182544    179.724305 
[37m[36mINFO[0m[0m 02/20 16:25:12 | 0.405856    0.410579    0.763394    0.764285    0.630533    0.879515    0.873418    0.756323    0.776579    0.405856    0.410579    0.654345    0.642857    2800        9.596625    0.782734    0.178433    190.038749 
[37m[36mINFO[0m[0m 02/20 16:29:01 | 0.400189    0.395466    0.760148    0.770381    0.643820    0.884260    0.868143    0.727179    0.765280    0.400189    0.395466    0.669004    0.677721    3000        10.282099   0.719161    0.205622    187.338346 
[37m[36mINFO[0m[0m 02/20 16:32:50 | 0.366499    0.365239    0.790307    0.801506    0.558364    0.891906    0.882911    0.789190    0.821777    0.366499    0.365239    0.689824    0.699830    3200        10.967572   0.702804    0.168564    195.007056 
[37m[36mINFO[0m[0m 02/20 16:36:32 | 0.441436    0.443325    0.790904    0.791543    0.576664    0.888215    0.879747    0.783413    0.792501    0.441436    0.443325    0.701083    0.702381    3400        11.653045   0.728128    0.170190    188.112028 
[37m[36mINFO[0m[0m 02/20 16:40:33 | 0.428526    0.416877    0.777607    0.778475    0.630424    0.866860    0.856540    0.776351    0.790960    0.428526    0.416877    0.689611    0.687925    3600        12.338518   0.710071    0.211774    198.580490 
[37m[36mINFO[0m[0m 02/20 16:44:25 | 0.489924    0.518892    0.794382    0.796458    0.566347    0.890324    0.880802    0.789190    0.805342    0.489924    0.518892    0.703633    0.703231    3800        13.023992   0.662944    0.210077    190.073261 
[37m[36mINFO[0m[0m 02/20 16:48:27 | 0.487091    0.522670    0.807976    0.819113    0.507717    0.891379    0.881857    0.794710    0.816127    0.487091    0.522670    0.737837    0.759354    4000        13.709465   0.640384    0.224178    197.339202 
[37m[36mINFO[0m[0m 02/20 16:52:42 | 0.517317    0.560453    0.814458    0.820888    0.509979    0.902716    0.887131    0.806008    0.823832    0.517317    0.560453    0.734651    0.751701    4200        14.394938   0.647177    0.240719    207.179463 
[37m[36mINFO[0m[0m 02/20 16:56:58 | 0.500630    0.492443    0.799630    0.804495    0.523894    0.877406    0.869198    0.780460    0.805342    0.500630    0.492443    0.741024    0.738946    4400        15.080411   0.633849    0.264713    202.822324 
[37m[36mINFO[0m[0m 02/20 17:00:56 | 0.487091    0.492443    0.810629    0.812607    0.526665    0.892697    0.892405    0.808576    0.821777    0.487091    0.492443    0.730614    0.723639    4600        15.765885   0.650138    0.206521    196.540522 
[37m[36mINFO[0m[0m 02/20 17:04:54 | 0.521411    0.503778    0.814318    0.816930    0.496212    0.882415    0.878692    0.799332    0.818695    0.521411    0.503778    0.761207    0.753401    4800        16.451358   0.631348    0.205769    197.392185 
[37m[36mINFO[0m[0m 02/20 17:09:12 | 0.456549    0.476071    0.818734    0.827227    0.498834    0.898497    0.882911    0.813070    0.840267    0.456549    0.476071    0.744636    0.758503    5000        17.136831   0.592958    0.234325    210.562619 
[37m[36mINFO[0m[0m 02/20 17:09:12 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[2]/250220_15-29-44_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/20 17:09:13 | ---
[37m[36mINFO[0m[0m 02/20 17:09:13 | test-domain validation(oracle) = 51.732%
[37m[36mINFO[0m[0m 02/20 17:09:13 | training-domain validation(iid) = 45.655%
[37m[36mINFO[0m[0m 02/20 17:09:13 | last = 45.655%
[37m[36mINFO[0m[0m 02/20 17:09:13 | last (inD) = 82.723%
[37m[36mINFO[0m[0m 02/20 17:09:13 | training-domain validation (iid, inD) = 82.723%
[37m[36mINFO[0m[0m 02/20 17:09:14 | === Summary ===
[37m[36mINFO[0m[0m 02/20 17:09:14 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 2 --dataset TerraIncognita --trial_seed 0 --hparams_seed 18
[37m[36mINFO[0m[0m 02/20 17:09:14 | Unique name: 250220_15-29-44_resnet50_GENIE
[37m[36mINFO[0m[0m 02/20 17:09:14 | Out path: train_output/TerraIncognita/RSC/[2]/250220_15-29-44_resnet50_GENIE
[37m[36mINFO[0m[0m 02/20 17:09:14 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/20 17:09:14 | Dataset: TerraIncognita

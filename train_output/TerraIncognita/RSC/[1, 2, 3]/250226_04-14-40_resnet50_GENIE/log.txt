[37m[36mINFO[0m[0m 02/26 04:14:40 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 1 2 3 --dataset TerraIncognita --trial_seed 0 --hparams_seed 14
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 14
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[1, 2, 3]/250226_04-14-40_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 0
	unique_name: 250226_04-14-40_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.1399727535070965e-05
	batch_size: 16
	weight_decay: 0.00022842646099519332
	rsc_f_drop_factor: 0.03663071938022161
	rsc_b_drop_factor: 0.4317269967185047
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/26 04:14:40 | n_steps = 5001
[37m[36mINFO[0m[0m 02/26 04:14:40 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/26 04:14:40 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/26 04:14:40 | 
[37m[36mINFO[0m[0m 02/26 04:14:40 | Testenv name escaping te_L38_L43_L46 -> te_L38_L43_L46
[37m[36mINFO[0m[0m 02/26 04:14:40 | Test envs = [1, 2, 3], name = te_L38_L43_L46
[37m[36mINFO[0m[0m 02/26 04:14:40 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 02/26 04:14:40 | Batch sizes for each domain: [16, 0, 0, 0] (total=16)
[37m[36mINFO[0m[0m 02/26 04:14:40 | steps-per-epoch for each domain: 237.06 -> min = 237.06
[37m[36mINFO[0m[0m 02/26 04:14:41 | # of params = 23528522
[37m[36mINFO[0m[0m 02/26 04:17:23 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/26 04:17:23 | 0.117037    0.124329    0.522278    0.520042    1.689218    0.522278    0.520042    0.019258    0.023112    0.096033    0.103275    0.235819    0.246599    0           0.000000    3.358848    1.329788    160.290988 
[37m[36mINFO[0m[0m 02/26 04:20:29 | 0.145434    0.147155    0.600580    0.590717    1.136542    0.600580    0.590717    0.052767    0.050847    0.143892    0.142317    0.239643    0.248299    200         0.843659    1.287472    0.146737    156.822392 
[37m[36mINFO[0m[0m 02/26 04:23:30 | 0.145961    0.150600    0.609017    0.595992    1.118146    0.609017    0.595992    0.071768    0.077555    0.126259    0.125945    0.239856    0.248299    400         1.687319    1.125791    0.134677    154.103966 
[37m[36mINFO[0m[0m 02/26 04:26:31 | 0.141027    0.143315    0.621144    0.628692    1.058531    0.621144    0.628692    0.055078    0.054443    0.128149    0.127204    0.239856    0.248299    600         2.530978    1.094191    0.136370    153.190793 
[37m[36mINFO[0m[0m 02/26 04:29:34 | 0.135249    0.142944    0.620617    0.613924    1.003947    0.620617    0.613924    0.069457    0.073446    0.097922    0.104534    0.238368    0.250850    800         3.374637    1.076629    0.121929    158.929945 
[37m[36mINFO[0m[0m 02/26 04:32:39 | 0.137116    0.140738    0.632745    0.624473    1.002784    0.632745    0.624473    0.051098    0.053416    0.119332    0.119647    0.240918    0.249150    1000        4.218297    0.980686    0.126400    159.340738 
[37m[36mINFO[0m[0m 02/26 04:35:44 | 0.176190    0.181329    0.691537    0.697257    0.963081    0.691537    0.697257    0.186417    0.197740    0.122481    0.120907    0.219673    0.225340    1200        5.061956    0.978131    0.131977    158.406889 
[37m[36mINFO[0m[0m 02/26 04:38:55 | 0.207286    0.214112    0.714738    0.713080    0.927747    0.714738    0.713080    0.282064    0.297381    0.124370    0.122166    0.215424    0.222789    1400        5.905616    0.919242    0.139683    163.080476 
[37m[36mINFO[0m[0m 02/26 04:41:59 | 0.208538    0.220288    0.729238    0.726793    0.836715    0.729238    0.726793    0.281037    0.311248    0.124055    0.123426    0.220523    0.226190    1600        6.749275    0.911060    0.138179    156.380897 
[37m[36mINFO[0m[0m 02/26 04:45:01 | 0.227336    0.242020    0.733984    0.724684    0.848953    0.733984    0.724684    0.347156    0.372881    0.102645    0.110831    0.232207    0.242347    1800        7.592934    0.868174    0.138803    154.605623 
[37m[36mINFO[0m[0m 02/26 04:48:11 | 0.254649    0.268557    0.738202    0.725738    0.819023    0.738202    0.725738    0.413917    0.437596    0.103589    0.109572    0.246441    0.258503    2000        8.436594    0.902079    0.140915    161.467018 
[37m[36mINFO[0m[0m 02/26 04:51:16 | 0.224931    0.232122    0.721065    0.706751    0.888524    0.721065    0.706751    0.323918    0.340010    0.130353    0.128463    0.220523    0.227891    2200        9.280253    0.876669    0.151810    154.725341 
[37m[36mINFO[0m[0m 02/26 04:54:19 | 0.153497    0.165251    0.740047    0.729958    0.897430    0.740047    0.729958    0.103736    0.125321    0.118388    0.124685    0.238368    0.245748    2400        10.123912   0.791643    0.145770    153.712363 
[37m[36mINFO[0m[0m 02/26 04:57:25 | 0.168624    0.175716    0.726338    0.725738    0.839832    0.726338    0.725738    0.149570    0.171546    0.120907    0.120907    0.235394    0.234694    2600        10.967572   0.862603    0.164030    154.049869 
[37m[36mINFO[0m[0m 02/26 05:00:37 | 0.166163    0.180441    0.743211    0.729958    0.809686    0.743211    0.729958    0.151367    0.176682    0.107053    0.112091    0.240068    0.252551    2800        11.811231   0.868168    0.153297    160.748353 
[37m[36mINFO[0m[0m 02/26 05:03:40 | 0.182746    0.191476    0.739257    0.732068    0.817277    0.739257    0.732068    0.196431    0.213662    0.114924    0.115869    0.236881    0.244898    3000        12.654891   0.805419    0.133759    156.767673 
[37m[36mINFO[0m[0m 02/26 05:06:41 | 0.220199    0.225962    0.735829    0.720464    0.776666    0.735829    0.720464    0.315316    0.328711    0.127519    0.124685    0.217761    0.224490    3200        13.498550   0.804349    0.132897    154.247549 
[37m[36mINFO[0m[0m 02/26 05:09:40 | 0.237957    0.248706    0.758766    0.759494    0.763502    0.758766    0.759494    0.364488    0.381099    0.113350    0.115869    0.236031    0.249150    3400        14.342209   0.756233    0.155794    147.912472 
[37m[36mINFO[0m[0m 02/26 05:12:46 | 0.137838    0.139254    0.727656    0.683544    0.864554    0.727656    0.683544    0.053280    0.054443    0.120592    0.115869    0.239643    0.247449    3600        15.185869   0.751116    0.154777    154.892280 
[37m[36mINFO[0m[0m 02/26 05:15:45 | 0.204814    0.215808    0.793040    0.785865    0.635181    0.793040    0.785865    0.262165    0.279918    0.111146    0.120907    0.241130    0.246599    3800        16.029528   0.706594    0.134300    151.767235 
[37m[36mINFO[0m[0m 02/26 05:18:49 | 0.149260    0.166651    0.755339    0.709916    0.770321    0.755339    0.709916    0.058416    0.069337    0.118703    0.139798    0.270661    0.290816    4000        16.873187   0.673313    0.136091    157.182200 
[37m[36mINFO[0m[0m 02/26 05:21:48 | 0.224615    0.235967    0.831004    0.825949    0.529184    0.831004    0.825949    0.263063    0.278891    0.121851    0.132242    0.288931    0.296769    4200        17.716847   0.578085    0.127116    153.780842 
[37m[36mINFO[0m[0m 02/26 05:24:48 | 0.258636    0.269266    0.845505    0.837553    0.567688    0.845505    0.837553    0.338041    0.355932    0.165932    0.173804    0.271935    0.278061    4400        18.560506   0.533661    0.136528    152.455535 
[37m[36mINFO[0m[0m 02/26 05:27:46 | 0.279888    0.296097    0.869233    0.860759    0.429901    0.869233    0.860759    0.353576    0.377504    0.175063    0.187657    0.311026    0.323129    4600        19.404166   0.518652    0.136970    150.647967 
[37m[36mINFO[0m[0m 02/26 05:30:56 | 0.268424    0.289295    0.810177    0.823840    0.525091    0.810177    0.823840    0.428681    0.465331    0.129723    0.139798    0.246866    0.262755    4800        20.247825   0.505975    0.157573    158.519036 
[37m[36mINFO[0m[0m 02/26 05:34:03 | 0.263740    0.277337    0.859478    0.858650    0.419919    0.859478    0.858650    0.301708    0.325629    0.173174    0.166247    0.316337    0.340136    5000        21.091484   0.459056    0.154430    156.142585 
[37m[36mINFO[0m[0m 02/26 05:34:03 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[1, 2, 3]/250226_04-14-40_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/26 05:34:05 | ---
[37m[36mINFO[0m[0m 02/26 05:34:05 | test-domain validation(oracle) = 27.989%
[37m[36mINFO[0m[0m 02/26 05:34:05 | training-domain validation(iid) = 27.989%
[37m[36mINFO[0m[0m 02/26 05:34:05 | last = 26.374%
[37m[36mINFO[0m[0m 02/26 05:34:05 | last (inD) = 85.865%
[37m[36mINFO[0m[0m 02/26 05:34:05 | training-domain validation (iid, inD) = 86.076%
[37m[36mINFO[0m[0m 02/26 05:34:05 | === Summary ===
[37m[36mINFO[0m[0m 02/26 05:34:05 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 1 2 3 --dataset TerraIncognita --trial_seed 0 --hparams_seed 14
[37m[36mINFO[0m[0m 02/26 05:34:05 | Unique name: 250226_04-14-40_resnet50_GENIE
[37m[36mINFO[0m[0m 02/26 05:34:05 | Out path: train_output/TerraIncognita/RSC/[1, 2, 3]/250226_04-14-40_resnet50_GENIE
[37m[36mINFO[0m[0m 02/26 05:34:05 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/26 05:34:05 | Dataset: TerraIncognita

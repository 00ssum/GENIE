[37m[36mINFO[0m[0m 02/20 22:31:52 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 1 2 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 3
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 3
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[1, 2, 3]/250220_22-31-52_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 2
	unique_name: 250220_22-31-52_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.0002649077542048787
	batch_size: 21
	weight_decay: 0.0023111806563778695
	rsc_f_drop_factor: 0.03146145565044939
	rsc_b_drop_factor: 0.0371714794770715
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/20 22:31:52 | n_steps = 5001
[37m[36mINFO[0m[0m 02/20 22:31:52 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/20 22:31:52 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/20 22:31:52 | 
[37m[36mINFO[0m[0m 02/20 22:31:52 | Testenv name escaping te_L38_L43_L46 -> te_L38_L43_L46
[37m[36mINFO[0m[0m 02/20 22:31:52 | Test envs = [1, 2, 3], name = te_L38_L43_L46
[37m[36mINFO[0m[0m 02/20 22:31:52 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 02/20 22:31:52 | Batch sizes for each domain: [21, 0, 0, 0] (total=21)
[37m[36mINFO[0m[0m 02/20 22:31:52 | steps-per-epoch for each domain: 180.62 -> min = 180.62
[37m[36mINFO[0m[0m 02/20 22:31:54 | # of params = 23528522
[37m[36mINFO[0m[0m 02/20 22:34:51 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/20 22:34:51 | 0.118521    0.118391    0.518587    0.534810    1.715744    0.518587    0.534810    0.021184    0.015408    0.097922    0.095718    0.236456    0.244048    0           0.000000    2.943255    1.488939    175.038106 
[37m[36mINFO[0m[0m 02/20 22:38:28 | 0.144644    0.150599    0.596098    0.608650    1.048142    0.596098    0.608650    0.051868    0.054443    0.142632    0.147355    0.239431    0.250000    200         1.107303    1.165730    0.259324    165.006075 
[37m[36mINFO[0m[0m 02/20 22:42:14 | 0.135945    0.142625    0.613762    0.640295    1.011952    0.613762    0.640295    0.046861    0.049820    0.120907    0.127204    0.240068    0.250850    400         2.214606    1.099772    0.251027    175.576246 
[37m[36mINFO[0m[0m 02/20 22:45:40 | 0.250698    0.255926    0.635117    0.656118    0.967692    0.635117    0.656118    0.420336    0.422702    0.138854    0.146096    0.192904    0.198980    600         3.321909    1.053378    0.219061    162.167460 
[37m[36mINFO[0m[0m 02/20 22:49:17 | 0.144902    0.151882    0.644608    0.659283    0.952798    0.644608    0.659283    0.048658    0.051361    0.129408    0.137280    0.256639    0.267007    800         4.429212    1.021129    0.241355    169.379537 
[37m[36mINFO[0m[0m 02/20 22:53:03 | 0.223097    0.222992    0.692064    0.726793    0.872664    0.692064    0.726793    0.365259    0.356959    0.103904    0.104534    0.200127    0.207483    1000        5.536515    0.955540    0.222543    181.540093 
[37m[36mINFO[0m[0m 02/20 22:56:42 | 0.308323    0.297963    0.692592    0.726793    0.858963    0.692592    0.726793    0.494158    0.480740    0.213476    0.209068    0.217336    0.204082    1200        6.643818    0.886968    0.200015    178.692230 
[37m[36mINFO[0m[0m 02/20 23:00:16 | 0.281686    0.270917    0.717110    0.732068    0.810851    0.717110    0.732068    0.479522    0.467899    0.174118    0.163728    0.191417    0.181122    1400        7.751120    0.880228    0.190021    176.013725 
[37m[36mINFO[0m[0m 02/20 23:03:47 | 0.264706    0.257137    0.757184    0.757384    0.697159    0.757184    0.757384    0.347541    0.336929    0.165932    0.170025    0.280646    0.264456    1600        8.858423    0.727050    0.196293    171.987556 
[37m[36mINFO[0m[0m 02/20 23:07:32 | 0.170706    0.172577    0.805167    0.782700    0.611831    0.805167    0.782700    0.140326    0.133539    0.139798    0.146096    0.231995    0.238095    1800        9.965726    0.633774    0.239224    177.196537 
[37m[36mINFO[0m[0m 02/20 23:11:15 | 0.150248    0.149309    0.792513    0.784810    0.630447    0.792513    0.784810    0.156503    0.148947    0.096662    0.093199    0.197578    0.205782    2000        11.073029   0.559410    0.198356    182.504893 
[37m[36mINFO[0m[0m 02/20 23:15:00 | 0.205188    0.200912    0.866069    0.850211    0.478427    0.866069    0.850211    0.162537    0.165383    0.159635    0.144836    0.293393    0.292517    2200        12.180332   0.528220    0.190023    187.559956 
[37m[36mINFO[0m[0m 02/20 23:18:44 | 0.210078    0.208591    0.838387    0.829114    0.510484    0.838387    0.829114    0.159584    0.158192    0.169395    0.175063    0.301253    0.292517    2400        13.287635   0.470804    0.196560    184.133590 
[37m[36mINFO[0m[0m 02/20 23:22:31 | 0.153031    0.159807    0.877406    0.866034    0.402897    0.877406    0.866034    0.140454    0.148433    0.169710    0.183879    0.148927    0.147109    2600        14.394938   0.399936    0.234258    180.615930 
[37m[36mINFO[0m[0m 02/20 23:26:07 | 0.225294    0.231953    0.887688    0.857595    0.405117    0.887688    0.857595    0.214533    0.217257    0.174118    0.177582    0.287232    0.301020    2800        15.502241   0.429296    0.227046    170.260430 
[37m[36mINFO[0m[0m 02/20 23:30:00 | 0.212073    0.216629    0.882942    0.860759    0.351723    0.882942    0.860759    0.185133    0.182845    0.162154    0.183879    0.288931    0.283163    3000        16.609544   0.378239    0.236361    185.917752 
[37m[36mINFO[0m[0m 02/20 23:33:53 | 0.286967    0.282782    0.893488    0.850211    0.383264    0.893488    0.850211    0.321479    0.308680    0.192065    0.190176    0.347355    0.349490    3200        17.716847   0.337795    0.268386    179.652645 
[37m[36mINFO[0m[0m 02/20 23:37:25 | 0.280716    0.269024    0.875297    0.861814    0.381666    0.875297    0.861814    0.247657    0.228557    0.249685    0.244332    0.344806    0.334184    3400        18.824150   0.330878    0.226729    166.340863 
[37m[36mINFO[0m[0m 02/20 23:41:12 | 0.226251    0.231171    0.895334    0.864979    0.373833    0.895334    0.864979    0.136731    0.128916    0.222922    0.235516    0.319099    0.329082    3600        19.931453   0.322039    0.236664    179.909551 
[37m[36mINFO[0m[0m 02/20 23:45:07 | 0.287612    0.283349    0.897179    0.878692    0.322516    0.897179    0.878692    0.236873    0.231125    0.247166    0.243073    0.378798    0.375850    3800        21.038756   0.307633    0.190930    196.551132 
[37m[36mINFO[0m[0m 02/20 23:48:46 | 0.268934    0.266531    0.902188    0.850211    0.402616    0.902188    0.850211    0.260624    0.259373    0.248111    0.246851    0.298067    0.293367    4000        22.146059   0.282675    0.202134    178.382674 
[37m[36mINFO[0m[0m 02/20 23:52:34 | 0.278186    0.277279    0.916425    0.894515    0.297586    0.916425    0.894515    0.336629    0.328711    0.214736    0.221662    0.283195    0.281463    4200        23.253361   0.313132    0.217817    184.565352 
[37m[36mINFO[0m[0m 02/20 23:56:16 | 0.273746    0.268485    0.915634    0.891350    0.283092    0.915634    0.891350    0.305302    0.292244    0.201511    0.197733    0.314425    0.315476    4400        24.360664   0.274789    0.268182    168.320732 
[37m[36mINFO[0m[0m 02/21 00:00:19 | 0.264517    0.258717    0.915370    0.889241    0.295337    0.915370    0.889241    0.297214    0.278377    0.205919    0.207809    0.290419    0.289966    4600        25.467967   0.246317    0.212115    200.394505 
[37m[36mINFO[0m[0m 02/21 00:04:09 | 0.304644    0.296384    0.906407    0.877637    0.324425    0.906407    0.877637    0.306586    0.287622    0.267003    0.273300    0.340344    0.328231    4800        26.575270   0.230415    0.192144    191.807840 
[37m[36mINFO[0m[0m 02/21 00:08:03 | 0.298195    0.298797    0.875824    0.839662    0.518125    0.875824    0.839662    0.383746    0.376477    0.201511    0.205290    0.309327    0.314626    5000        27.682573   0.255158    0.196726    194.440864 
[37m[36mINFO[0m[0m 02/21 00:08:03 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[1, 2, 3]/250220_22-31-52_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/21 00:08:04 | ---
[37m[36mINFO[0m[0m 02/21 00:08:04 | test-domain validation(oracle) = 29.819%
[37m[36mINFO[0m[0m 02/21 00:08:04 | training-domain validation(iid) = 27.819%
[37m[36mINFO[0m[0m 02/21 00:08:04 | last = 29.819%
[37m[36mINFO[0m[0m 02/21 00:08:04 | last (inD) = 83.966%
[37m[36mINFO[0m[0m 02/21 00:08:04 | training-domain validation (iid, inD) = 89.451%
[37m[36mINFO[0m[0m 02/21 00:08:04 | === Summary ===
[37m[36mINFO[0m[0m 02/21 00:08:04 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 1 2 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 3
[37m[36mINFO[0m[0m 02/21 00:08:04 | Unique name: 250220_22-31-52_resnet50_GENIE
[37m[36mINFO[0m[0m 02/21 00:08:04 | Out path: train_output/TerraIncognita/RSC/[1, 2, 3]/250220_22-31-52_resnet50_GENIE
[37m[36mINFO[0m[0m 02/21 00:08:04 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/21 00:08:04 | Dataset: TerraIncognita

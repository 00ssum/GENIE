[37m[36mINFO[0m[0m 02/21 13:07:28 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 1 2 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 10
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 10
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[1, 2, 3]/250221_13-07-28_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 1
	unique_name: 250221_13-07-28_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.2128485336217652e-05
	batch_size: 9
	weight_decay: 0.00030907441430549757
	rsc_f_drop_factor: 0.11930737869274544
	rsc_b_drop_factor: 0.16188382214285657
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/21 13:07:28 | n_steps = 5001
[37m[36mINFO[0m[0m 02/21 13:07:28 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/21 13:07:28 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/21 13:07:28 | 
[37m[36mINFO[0m[0m 02/21 13:07:28 | Testenv name escaping te_L38_L43_L46 -> te_L38_L43_L46
[37m[36mINFO[0m[0m 02/21 13:07:28 | Test envs = [1, 2, 3], name = te_L38_L43_L46
[37m[36mINFO[0m[0m 02/21 13:07:28 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 02/21 13:07:28 | Batch sizes for each domain: [9, 0, 0, 0] (total=9)
[37m[36mINFO[0m[0m 02/21 13:07:28 | steps-per-epoch for each domain: 421.44 -> min = 421.44
[37m[36mINFO[0m[0m 02/21 13:07:29 | # of params = 23528522
[37m[36mINFO[0m[0m 02/21 13:10:23 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/21 13:10:23 | 0.120335    0.111127    0.517005    0.541139    1.610093    0.517005    0.541139    0.019515    0.022085    0.098237    0.094458    0.243255    0.216837    0           0.000000    3.353267    1.144422    172.207375 
[37m[36mINFO[0m[0m 02/21 13:13:52 | 0.148538    0.135298    0.596098    0.610759    1.102062    0.596098    0.610759    0.052125    0.053416    0.146411    0.132242    0.247079    0.220238    200         0.474558    1.442921    0.136262    182.244855 
[37m[36mINFO[0m[0m 02/21 13:17:24 | 0.147457    0.138639    0.583707    0.602321    1.101915    0.583707    0.602321    0.097188    0.101695    0.100441    0.098237    0.244742    0.215986    400         0.949117    1.221138    0.155193    181.129987 
[37m[36mINFO[0m[0m 02/21 13:20:49 | 0.144179    0.137305    0.595571    0.610759    1.064912    0.595571    0.610759    0.087559    0.098100    0.099811    0.096977    0.245167    0.216837    600         1.423675    1.203530    0.183951    167.593834 
[37m[36mINFO[0m[0m 02/21 13:24:09 | 0.148113    0.135298    0.595834    0.610759    1.067519    0.595834    0.610759    0.052125    0.053416    0.146411    0.132242    0.245804    0.220238    800         1.898234    1.160381    0.137879    172.851495 
[37m[36mINFO[0m[0m 02/21 13:27:31 | 0.135157    0.122015    0.613235    0.652954    1.062054    0.613235    0.652954    0.035691    0.037494    0.121851    0.108312    0.247929    0.220238    1000        2.372792    1.181460    0.139261    173.472468 
[37m[36mINFO[0m[0m 02/21 13:30:54 | 0.145350    0.137425    0.620353    0.641350    1.085349    0.620353    0.641350    0.090897    0.095532    0.102960    0.100756    0.242192    0.215986    1200        2.847350    1.090640    0.138176    175.657689 
[37m[36mINFO[0m[0m 02/21 13:34:19 | 0.139357    0.130131    0.612708    0.618143    1.028433    0.612708    0.618143    0.080883    0.084232    0.102645    0.096977    0.234544    0.209184    1400        3.321909    1.126016    0.138244    177.368939 
[37m[36mINFO[0m[0m 02/21 13:37:45 | 0.148538    0.135298    0.597416    0.610759    1.083494    0.597416    0.610759    0.052125    0.053416    0.146411    0.132242    0.247079    0.220238    1600        3.796467    1.140305    0.136267    178.876564 
[37m[36mINFO[0m[0m 02/21 13:41:05 | 0.187787    0.184824    0.665173    0.713080    0.998523    0.665173    0.713080    0.174477    0.180277    0.184509    0.196474    0.204376    0.177721    1800        4.271026    1.128349    0.127030    174.825227 
[37m[36mINFO[0m[0m 02/21 13:44:32 | 0.152923    0.158891    0.676509    0.696203    0.921265    0.676509    0.696203    0.119913    0.132512    0.122796    0.151134    0.216061    0.193027    2000        4.745584    1.037388    0.156589    175.106167 
[37m[36mINFO[0m[0m 02/21 13:47:49 | 0.160298    0.158681    0.715001    0.725738    0.873533    0.715001    0.725738    0.104378    0.106317    0.162154    0.180101    0.214362    0.189626    2200        5.220142    1.006767    0.153124    167.014972 
[37m[36mINFO[0m[0m 02/21 13:51:12 | 0.159761    0.158182    0.721592    0.724684    0.837234    0.721592    0.724684    0.100398    0.108885    0.185768    0.198992    0.193117    0.166667    2400        5.694701    1.037116    0.176781    167.393436 
[37m[36mINFO[0m[0m 02/21 13:54:31 | 0.156863    0.162322    0.734247    0.725738    0.813588    0.734247    0.725738    0.078444    0.078069    0.169710    0.209068    0.222435    0.199830    2600        6.169259    0.929964    0.136887    171.225596 
[37m[36mINFO[0m[0m 02/21 13:58:04 | 0.216570    0.217653    0.727129    0.721519    0.812533    0.727129    0.721519    0.255745    0.263996    0.194899    0.205290    0.199065    0.183673    2800        6.643818    0.922590    0.133614    186.988596 
[37m[36mINFO[0m[0m 02/21 14:01:27 | 0.154039    0.145214    0.736884    0.728903    0.816177    0.736884    0.728903    0.092952    0.099640    0.163728    0.157431    0.205439    0.178571    3000        7.118376    0.912013    0.122135    178.089096 
[37m[36mINFO[0m[0m 02/21 14:04:54 | 0.171211    0.163600    0.748220    0.752110    0.731401    0.748220    0.752110    0.130569    0.138675    0.165302    0.159950    0.217761    0.192177    3200        7.592934    0.876008    0.143328    178.539449 
[37m[36mINFO[0m[0m 02/21 14:08:13 | 0.150004    0.140363    0.778539    0.786920    0.673868    0.778539    0.786920    0.101425    0.112481    0.152708    0.138539    0.195878    0.170068    3400        8.067493    0.913452    0.156783    167.818999 
[37m[36mINFO[0m[0m 02/21 14:11:35 | 0.166061    0.152876    0.785394    0.784810    0.629333    0.785394    0.784810    0.078829    0.081150    0.186083    0.172544    0.233270    0.204932    3600        8.542051    0.788149    0.130315    175.793550 
[37m[36mINFO[0m[0m 02/21 14:14:55 | 0.179212    0.183363    0.806486    0.803797    0.637840    0.806486    0.803797    0.126846    0.133539    0.182620    0.209068    0.228171    0.207483    3800        9.016610    0.706673    0.122772    174.890792 
[37m[36mINFO[0m[0m 02/21 14:18:20 | 0.211716    0.209866    0.717638    0.726793    0.912148    0.717638    0.726793    0.260496    0.259373    0.184509    0.207809    0.190142    0.162415    4000        9.491168    0.805047    0.138990    177.055714 
[37m[36mINFO[0m[0m 02/21 14:21:44 | 0.167056    0.163039    0.836014    0.823840    0.540697    0.836014    0.823840    0.090384    0.098613    0.209383    0.217884    0.201402    0.172619    4200        9.965726    0.711001    0.135632    177.768528 
[37m[36mINFO[0m[0m 02/21 14:24:57 | 0.163853    0.161661    0.820986    0.800633    0.588248    0.820986    0.800633    0.088330    0.095018    0.201826    0.226700    0.201402    0.163265    4400        10.440285   0.638450    0.151328    162.284834 
[37m[36mINFO[0m[0m 02/21 14:28:23 | 0.172595    0.173468    0.836541    0.824895    0.574942    0.836541    0.824895    0.154834    0.163842    0.168136    0.178841    0.194816    0.177721    4600        10.914843   0.614043    0.149849    176.392931 
[37m[36mINFO[0m[0m 02/21 14:31:48 | 0.166611    0.159339    0.810968    0.811181    0.623962    0.810968    0.811181    0.104892    0.105804    0.175693    0.185139    0.219248    0.187075    4800        11.389402   0.628615    0.135746    177.471132 
[37m[36mINFO[0m[0m 02/21 14:35:09 | 0.186466    0.182078    0.840496    0.834388    0.523148    0.840496    0.834388    0.127487    0.140729    0.184194    0.175063    0.247716    0.230442    5000        11.863960   0.612044    0.132941    174.229113 
[37m[36mINFO[0m[0m 02/21 14:35:09 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[1, 2, 3]/250221_13-07-28_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/21 14:35:11 | ---
[37m[36mINFO[0m[0m 02/21 14:35:11 | test-domain validation(oracle) = 21.657%
[37m[36mINFO[0m[0m 02/21 14:35:11 | training-domain validation(iid) = 18.647%
[37m[36mINFO[0m[0m 02/21 14:35:11 | last = 18.647%
[37m[36mINFO[0m[0m 02/21 14:35:11 | last (inD) = 83.439%
[37m[36mINFO[0m[0m 02/21 14:35:11 | training-domain validation (iid, inD) = 83.439%
[37m[36mINFO[0m[0m 02/21 14:35:11 | === Summary ===
[37m[36mINFO[0m[0m 02/21 14:35:11 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 1 2 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 10
[37m[36mINFO[0m[0m 02/21 14:35:11 | Unique name: 250221_13-07-28_resnet50_GENIE
[37m[36mINFO[0m[0m 02/21 14:35:11 | Out path: train_output/TerraIncognita/RSC/[1, 2, 3]/250221_13-07-28_resnet50_GENIE
[37m[36mINFO[0m[0m 02/21 14:35:11 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/21 14:35:11 | Dataset: TerraIncognita

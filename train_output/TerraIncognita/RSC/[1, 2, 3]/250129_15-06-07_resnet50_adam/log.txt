[37m[36mINFO[0m[0m 01/29 15:06:07 | Command :: /jsm0707/Large-scale/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm RSC --test_envs 1 2 3 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_adam.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_adam
	out_dir: train_output/TerraIncognita/RSC/[1, 2, 3]/250129_15-06-07_resnet50_adam
	out_root: train_output/TerraIncognita/RSC/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 0
	unique_name: 250129_15-06-07_resnet50_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	rsc_f_drop_factor: 0.3333333333333333
	rsc_b_drop_factor: 0.3333333333333333
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/29 15:06:07 | n_steps = 5001
[37m[36mINFO[0m[0m 01/29 15:06:07 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/29 15:06:07 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/29 15:06:07 | 
[37m[36mINFO[0m[0m 01/29 15:06:07 | Testenv name escaping te_L38_L43_L46 -> te_L38_L43_L46
[37m[36mINFO[0m[0m 01/29 15:06:07 | Test envs = [1, 2, 3], name = te_L38_L43_L46
[37m[36mINFO[0m[0m 01/29 15:06:07 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 01/29 15:06:07 | Batch sizes for each domain: [32, 0, 0, 0] (total=32)
[37m[36mINFO[0m[0m 01/29 15:06:07 | steps-per-epoch for each domain: 118.53 -> min = 118.53
[37m[36mINFO[0m[0m 01/29 15:06:09 | # of params = 23528522
[37m[36mINFO[0m[0m 01/29 15:09:10 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/29 15:09:10 | 0.081010    0.084192    0.136040    0.105485    2.274380    0.136040    0.105485    0.182437    0.191577    0.013854    0.017632    0.046739    0.043367    0           0.000000    4.232222    1.761412    179.066318 
[37m[36mINFO[0m[0m 01/29 15:13:12 | 0.150508    0.162456    0.700765    0.694093    0.871336    0.700765    0.694093    0.050327    0.053929    0.159005    0.185139    0.242192    0.248299    200         1.687319    1.303665    0.340983    173.786587 
[37m[36mINFO[0m[0m 01/29 15:17:22 | 0.193528    0.199583    0.749802    0.731013    0.707035    0.749802    0.731013    0.127102    0.130971    0.236146    0.259446    0.217336    0.208333    400         3.374637    0.783011    0.326952    184.286002 
[37m[36mINFO[0m[0m 01/29 15:21:17 | 0.194968    0.207839    0.860269    0.854430    0.505873    0.860269    0.854430    0.086917    0.095018    0.236461    0.265743    0.261525    0.262755    600         5.061956    0.563529    0.324457    170.056598 
[37m[36mINFO[0m[0m 01/29 15:25:23 | 0.221805    0.238608    0.868442    0.866034    0.403174    0.868442    0.866034    0.196688    0.214176    0.187657    0.204030    0.281071    0.297619    800         6.749275    0.462966    0.340797    177.491239 
[37m[36mINFO[0m[0m 01/29 15:29:30 | 0.167765    0.180874    0.823622    0.839662    0.573721    0.823622    0.839662    0.156118    0.176168    0.154912    0.170025    0.192267    0.196429    1000        8.436594    0.401661    0.296886    187.672941 
[37m[36mINFO[0m[0m 01/29 15:33:35 | 0.208287    0.228643    0.894015    0.885021    0.327095    0.894015    0.885021    0.140968    0.157678    0.233627    0.251889    0.250266    0.276361    1200        10.123912   0.360508    0.281103    188.436841 
[37m[36mINFO[0m[0m 01/29 15:37:37 | 0.255784    0.279934    0.880042    0.855485    0.370132    0.880042    0.855485    0.298113    0.311248    0.250630    0.294710    0.218611    0.233844    1400        11.811231   0.330470    0.290559    183.669172 
[37m[36mINFO[0m[0m 01/29 15:41:50 | 0.246070    0.268475    0.890588    0.878692    0.341832    0.890588    0.878692    0.140840    0.156651    0.248741    0.269521    0.348630    0.379252    1600        13.498550   0.323652    0.311556    190.943011 
[37m[36mINFO[0m[0m 01/29 15:46:00 | 0.311235    0.328260    0.907461    0.894515    0.279572    0.907461    0.894515    0.325459    0.338469    0.271725    0.295970    0.336520    0.350340    1800        15.185869   0.309477    0.317870    185.092358 
[37m[36mINFO[0m[0m 01/29 15:50:06 | 0.255408    0.281297    0.907461    0.904008    0.292444    0.907461    0.904008    0.183592    0.199795    0.290302    0.336272    0.292331    0.307823    2000        16.873187   0.272255    0.300550    185.444904 
[37m[36mINFO[0m[0m 01/29 15:54:15 | 0.307108    0.326276    0.918007    0.896624    0.328981    0.918007    0.896624    0.360508    0.364150    0.293766    0.342569    0.267049    0.272109    2200        18.560506   0.256676    0.314905    185.667766 
[37m[36mINFO[0m[0m 01/29 15:58:06 | 0.264977    0.271222    0.923543    0.906118    0.264946    0.923543    0.906118    0.242778    0.263996    0.237091    0.239295    0.315063    0.310374    2400        20.247825   0.258695    0.312671    168.945421 
[37m[36mINFO[0m[0m 01/29 16:02:07 | 0.232318    0.251308    0.917480    0.908228    0.237180    0.917480    0.908228    0.234176    0.244479    0.240554    0.259446    0.222222    0.250000    2600        21.935144   0.218514    0.342981    172.016145 
[37m[36mINFO[0m[0m 01/29 16:06:39 | 0.253857    0.269173    0.923016    0.905063    0.283404    0.923016    0.905063    0.335858    0.347201    0.213476    0.244332    0.212237    0.215986    2800        23.622462   0.217357    0.372371    197.498825 
[37m[36mINFO[0m[0m 01/29 16:10:42 | 0.256940    0.271097    0.941735    0.920886    0.227590    0.941735    0.920886    0.315830    0.335901    0.225756    0.239295    0.229233    0.238095    3000        25.309781   0.191098    0.288341    186.075434 
[37m[36mINFO[0m[0m 01/29 16:14:47 | 0.274688    0.294924    0.936198    0.904008    0.254633    0.936198    0.904008    0.331365    0.347714    0.260705    0.294710    0.231995    0.242347    3200        26.997100   0.180803    0.307876    183.510518 
[37m[36mINFO[0m[0m 01/29 16:18:57 | 0.286684    0.288384    0.941207    0.920886    0.235844    0.941207    0.920886    0.285659    0.294299    0.268892    0.278338    0.305502    0.292517    3400        28.684419   0.193741    0.310619    187.634608 
[37m[36mINFO[0m[0m 01/29 16:23:00 | 0.260556    0.276339    0.944898    0.926160    0.194245    0.944898    0.926160    0.265374    0.281972    0.268577    0.278338    0.247716    0.268707    3600        30.371737   0.163803    0.308940    181.460996 
[37m[36mINFO[0m[0m 01/29 16:27:15 | 0.222153    0.233251    0.949117    0.935654    0.182164    0.949117    0.935654    0.217871    0.231125    0.254408    0.259446    0.194179    0.209184    3800        32.059056   0.148206    0.356101    182.851623 
[37m[36mINFO[0m[0m 01/29 16:31:33 | 0.240123    0.255275    0.961244    0.938819    0.167350    0.961244    0.938819    0.234433    0.254237    0.249055    0.258186    0.236881    0.253401    4000        33.746375   0.139292    0.346765    188.925927 
[37m[36mINFO[0m[0m 01/29 16:35:44 | 0.226698    0.238698    0.929080    0.911392    0.262097    0.929080    0.911392    0.250225    0.268618    0.221033    0.217884    0.208838    0.229592    4200        35.433694   0.161430    0.324381    186.182713 
[37m[36mINFO[0m[0m 01/29 16:39:49 | 0.232934    0.248452    0.916952    0.906118    0.274768    0.916952    0.906118    0.289639    0.304058    0.203086    0.235516    0.206076    0.205782    4400        37.121012   0.142796    0.303879    183.968601 
[37m[36mINFO[0m[0m 01/29 16:43:55 | 0.240012    0.248567    0.957553    0.937764    0.158095    0.957553    0.937764    0.234690    0.242424    0.245277    0.243073    0.240068    0.260204    4600        38.808331   0.144252    0.301230    186.182743 
[37m[36mINFO[0m[0m 01/29 16:47:55 | 0.267728    0.283771    0.964408    0.946203    0.181092    0.964408    0.946203    0.362948    0.368259    0.250945    0.261965    0.189293    0.221088    4800        40.495650   0.123380    0.268616    186.621075 
[37m[36mINFO[0m[0m 01/29 16:52:04 | 0.196252    0.203495    0.957817    0.936709    0.199427    0.957817    0.936709    0.176274    0.186954    0.262280    0.261965    0.150202    0.161565    5000        42.182969   0.120525    0.315527    185.370292 
[37m[36mINFO[0m[0m 01/29 16:52:04 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[1, 2, 3]/250129_15-06-07_resnet50_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/29 16:52:06 | ---
[37m[36mINFO[0m[0m 01/29 16:52:06 | test-domain validation(oracle) = 31.123%
[37m[36mINFO[0m[0m 01/29 16:52:06 | training-domain validation(iid) = 26.773%
[37m[36mINFO[0m[0m 01/29 16:52:06 | last = 19.625%
[37m[36mINFO[0m[0m 01/29 16:52:06 | last (inD) = 93.671%
[37m[36mINFO[0m[0m 01/29 16:52:06 | training-domain validation (iid, inD) = 94.620%
[37m[36mINFO[0m[0m 01/29 16:52:06 | === Summary ===
[37m[36mINFO[0m[0m 01/29 16:52:06 | Command: /jsm0707/Large-scale/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm RSC --test_envs 1 2 3 --dataset TerraIncognita
[37m[36mINFO[0m[0m 01/29 16:52:06 | Unique name: 250129_15-06-07_resnet50_adam
[37m[36mINFO[0m[0m 01/29 16:52:06 | Out path: train_output/TerraIncognita/RSC/[1, 2, 3]/250129_15-06-07_resnet50_adam
[37m[36mINFO[0m[0m 01/29 16:52:06 | Algorithm: RSC
[37m[36mINFO[0m[0m 01/29 16:52:06 | Dataset: TerraIncognita

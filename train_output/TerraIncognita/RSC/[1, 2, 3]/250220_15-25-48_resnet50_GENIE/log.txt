[37m[36mINFO[0m[0m 02/20 15:25:48 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 1 2 3 --dataset TerraIncognita --trial_seed 0 --hparams_seed 20
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 20
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[1, 2, 3]/250220_15-25-48_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 0
	unique_name: 250220_15-25-48_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.6157673767852512e-05
	batch_size: 32
	weight_decay: 1.110622050999988e-05
	rsc_f_drop_factor: 0.011558843074644498
	rsc_b_drop_factor: 0.009443205254898168
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/20 15:25:48 | n_steps = 5001
[37m[36mINFO[0m[0m 02/20 15:25:48 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/20 15:25:48 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/20 15:25:48 | 
[37m[36mINFO[0m[0m 02/20 15:25:48 | Testenv name escaping te_L38_L43_L46 -> te_L38_L43_L46
[37m[36mINFO[0m[0m 02/20 15:25:48 | Test envs = [1, 2, 3], name = te_L38_L43_L46
[37m[36mINFO[0m[0m 02/20 15:25:48 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 02/20 15:25:48 | Batch sizes for each domain: [32, 0, 0, 0] (total=32)
[37m[36mINFO[0m[0m 02/20 15:25:48 | steps-per-epoch for each domain: 118.53 -> min = 118.53
[37m[36mINFO[0m[0m 02/20 15:25:49 | # of params = 23528522
[37m[36mINFO[0m[0m 02/20 15:28:38 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/20 15:28:38 | 0.117037    0.124329    0.522278    0.520042    1.718067    0.522278    0.520042    0.019258    0.023112    0.096033    0.103275    0.235819    0.246599    0           0.000000    2.963951    1.369320    167.122194 
[37m[36mINFO[0m[0m 02/20 15:32:29 | 0.126621    0.131866    0.610335    0.613924    1.106934    0.610335    0.613924    0.060342    0.063174    0.096662    0.104534    0.222860    0.227891    200         1.687319    1.219492    0.263258    177.987033 
[37m[36mINFO[0m[0m 02/20 15:36:12 | 0.139087    0.140029    0.599525    0.590717    1.118673    0.599525    0.590717    0.034151    0.032871    0.143892    0.142317    0.239218    0.244898    400         3.374637    1.075768    0.282662    167.224308 
[37m[36mINFO[0m[0m 02/20 15:39:53 | 0.173835    0.182756    0.653836    0.679325    0.950945    0.653836    0.679325    0.191039    0.211608    0.157746    0.172544    0.172721    0.164116    600         5.061956    1.031605    0.279579    164.898972 
[37m[36mINFO[0m[0m 02/20 15:43:33 | 0.132967    0.135017    0.721065    0.712025    0.871101    0.721065    0.712025    0.078444    0.090395    0.133501    0.130982    0.186956    0.183673    800         6.749275    0.931651    0.265208    166.776408 
[37m[36mINFO[0m[0m 02/20 15:47:19 | 0.116926    0.120224    0.717901    0.715190    0.840425    0.717901    0.715190    0.041854    0.046739    0.120907    0.120907    0.188018    0.193027    1000        8.436594    0.906358    0.293317    167.511597 
[37m[36mINFO[0m[0m 02/20 15:51:02 | 0.122342    0.125841    0.735302    0.735232    0.798663    0.735302    0.735232    0.066376    0.074987    0.111146    0.114610    0.189505    0.187925    1200        10.123912   0.842292    0.289226    165.212713 
[37m[36mINFO[0m[0m 02/20 15:54:33 | 0.123725    0.123469    0.744793    0.723629    0.771947    0.744793    0.723629    0.055976    0.057011    0.129093    0.129723    0.186106    0.183673    1400        11.811231   0.796653    0.268101    157.556005 
[37m[36mINFO[0m[0m 02/20 15:58:15 | 0.142417    0.143418    0.806222    0.802743    0.597254    0.806222    0.802743    0.100141    0.104263    0.145466    0.142317    0.181644    0.183673    1600        13.498550   0.685522    0.260006    169.407144 
[37m[36mINFO[0m[0m 02/20 16:01:48 | 0.185831    0.200195    0.851832    0.845992    0.504732    0.851832    0.845992    0.158172    0.186954    0.173489    0.171285    0.225834    0.242347    1800        15.185869   0.561272    0.256609    161.403847 
[37m[36mINFO[0m[0m 02/20 16:05:27 | 0.170097    0.178326    0.854996    0.838608    0.483434    0.854996    0.838608    0.170882    0.194658    0.164987    0.152393    0.174421    0.187925    2000        16.873187   0.471278    0.261046    167.317552 
[37m[36mINFO[0m[0m 02/20 16:09:14 | 0.233032    0.250536    0.868178    0.864979    0.390310    0.868178    0.864979    0.245474    0.271186    0.189547    0.201511    0.264075    0.278912    2200        18.560506   0.416807    0.258927    175.114069 
[37m[36mINFO[0m[0m 02/20 16:12:51 | 0.260204    0.274542    0.872924    0.863924    0.405267    0.872924    0.863924    0.300424    0.317411    0.197418    0.212846    0.282770    0.293367    2400        20.247825   0.408456    0.253359    166.701434 
[37m[36mINFO[0m[0m 02/20 16:16:45 | 0.235080    0.251250    0.892433    0.887131    0.346711    0.892433    0.887131    0.238542    0.249615    0.188602    0.209068    0.278096    0.295068    2600        21.935144   0.343350    0.280156    177.296672 
[37m[36mINFO[0m[0m 02/20 16:20:29 | 0.168234    0.172103    0.829159    0.827004    0.523293    0.829159    0.827004    0.208628    0.214689    0.120592    0.119647    0.175483    0.181973    2800        23.622462   0.374495    0.261713    171.903039 
[37m[36mINFO[0m[0m 02/20 16:24:14 | 0.224716    0.237759    0.881097    0.864979    0.384162    0.881097    0.864979    0.182950    0.204417    0.200567    0.205290    0.290631    0.303571    3000        25.309781   0.352790    0.268132    171.255721 
[37m[36mINFO[0m[0m 02/20 16:28:06 | 0.276516    0.286700    0.900606    0.889241    0.294814    0.900606    0.889241    0.344717    0.355932    0.199937    0.206549    0.284895    0.297619    3200        26.997100   0.317063    0.260982    180.196067 
[37m[36mINFO[0m[0m 02/20 16:31:58 | 0.252283    0.257844    0.905879    0.893460    0.310132    0.905879    0.893460    0.284119    0.289676    0.199307    0.198992    0.273423    0.284864    3400        28.684419   0.290162    0.286919    174.265874 
[37m[36mINFO[0m[0m 02/20 16:35:39 | 0.267365    0.276426    0.914579    0.917722    0.246940    0.914579    0.917722    0.281294    0.291731    0.229534    0.222922    0.291268    0.314626    3600        30.371737   0.263603    0.249827    170.931524 
[37m[36mINFO[0m[0m 02/20 16:39:33 | 0.199886    0.200310    0.911152    0.909283    0.280864    0.911152    0.909283    0.164976    0.183873    0.209698    0.202771    0.224984    0.214286    3800        32.059056   0.267162    0.273989    178.963620 
[37m[36mINFO[0m[0m 02/20 16:43:35 | 0.275910    0.294197    0.923280    0.916667    0.247077    0.923280    0.916667    0.313776    0.328197    0.224811    0.235516    0.289144    0.318878    4000        33.746375   0.233870    0.304662    181.882735 
[37m[36mINFO[0m[0m 02/20 16:47:30 | 0.286436    0.298051    0.935407    0.911392    0.266561    0.935407    0.911392    0.362563    0.374936    0.224811    0.226700    0.271935    0.292517    4200        35.433694   0.219367    0.283578    178.297855 
[37m[36mINFO[0m[0m 02/20 16:51:29 | 0.301007    0.319975    0.934353    0.920886    0.236223    0.934353    0.920886    0.368468    0.393939    0.216940    0.226700    0.317612    0.339286    4400        37.121012   0.233946    0.247838    189.472255 
[37m[36mINFO[0m[0m 02/20 16:55:45 | 0.226412    0.248669    0.926443    0.904008    0.270905    0.926443    0.904008    0.183977    0.201849    0.224811    0.238035    0.270448    0.306122    4600        38.808331   0.215364    0.293404    196.870296 
[37m[36mINFO[0m[0m 02/20 16:59:49 | 0.266154    0.286874    0.936989    0.921941    0.244071    0.936989    0.921941    0.343433    0.358500    0.187343    0.200252    0.267686    0.301871    4800        40.495650   0.184364    0.329976    177.612712 
[37m[36mINFO[0m[0m 02/20 17:03:43 | 0.274674    0.281820    0.941471    0.925105    0.242936    0.941471    0.925105    0.295031    0.298408    0.246222    0.244332    0.282770    0.302721    5000        42.182969   0.201664    0.303143    173.338320 
[37m[36mINFO[0m[0m 02/20 17:03:43 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[1, 2, 3]/250220_15-25-48_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/20 17:03:44 | ---
[37m[36mINFO[0m[0m 02/20 17:03:44 | test-domain validation(oracle) = 30.101%
[37m[36mINFO[0m[0m 02/20 17:03:44 | training-domain validation(iid) = 27.467%
[37m[36mINFO[0m[0m 02/20 17:03:44 | last = 27.467%
[37m[36mINFO[0m[0m 02/20 17:03:44 | last (inD) = 92.511%
[37m[36mINFO[0m[0m 02/20 17:03:44 | training-domain validation (iid, inD) = 92.511%
[37m[36mINFO[0m[0m 02/20 17:03:44 | === Summary ===
[37m[36mINFO[0m[0m 02/20 17:03:44 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 1 2 3 --dataset TerraIncognita --trial_seed 0 --hparams_seed 20
[37m[36mINFO[0m[0m 02/20 17:03:44 | Unique name: 250220_15-25-48_resnet50_GENIE
[37m[36mINFO[0m[0m 02/20 17:03:44 | Out path: train_output/TerraIncognita/RSC/[1, 2, 3]/250220_15-25-48_resnet50_GENIE
[37m[36mINFO[0m[0m 02/20 17:03:44 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/20 17:03:44 | Dataset: TerraIncognita

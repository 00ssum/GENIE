[37m[36mINFO[0m[0m 01/31 15:38:00 | Command :: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm RSC --test_envs 1 2 3 --dataset TerraIncognita --trial_seed 0 --hparams_seed 4
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 4
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/TerraIncognita/RSC/[1, 2, 3]/250131_15-38-00_resnet50_EVE
	out_root: train_output/TerraIncognita/RSC/[1, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1, 2, 3]
	trial_seed: 0
	unique_name: 250131_15-38-00_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: GENIE
	freeze_bn: False
	pretrained: True
	lr: 2.0793009436922532e-05
	batch_size: 30
	weight_decay: 0.0007980067844361917
	rsc_f_drop_factor: 0.00568084739259922
	rsc_b_drop_factor: 0.21660562421584156
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/31 15:38:00 | n_steps = 5001
[37m[36mINFO[0m[0m 01/31 15:38:00 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/31 15:38:00 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/31 15:38:00 | 
[37m[36mINFO[0m[0m 01/31 15:38:00 | Testenv name escaping te_L38_L43_L46 -> te_L38_L43_L46
[37m[36mINFO[0m[0m 01/31 15:38:00 | Test envs = [1, 2, 3], name = te_L38_L43_L46
[37m[36mINFO[0m[0m 01/31 15:38:00 | Train environments: [0], Test environments: [1, 2, 3]
[37m[36mINFO[0m[0m 01/31 15:38:00 | Batch sizes for each domain: [30, 0, 0, 0] (total=30)
[37m[36mINFO[0m[0m 01/31 15:38:00 | steps-per-epoch for each domain: 126.43 -> min = 126.43
[37m[36mINFO[0m[0m 01/31 15:38:02 | # of params = 23528522
[37m[36mINFO[0m[0m 01/31 15:41:27 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/31 15:41:27 | 0.117037    0.124329    0.522278    0.520042    1.705834    0.522278    0.520042    0.019258    0.023112    0.096033    0.103275    0.235819    0.246599    0           0.000000    2.993886    1.561620    204.167836 
[37m[36mINFO[0m[0m 01/31 15:45:54 | 0.145361    0.146984    0.600053    0.590717    1.095674    0.600053    0.590717    0.052125    0.050334    0.143892    0.142317    0.240068    0.248299    200         1.581861    1.233914    0.358616    194.973595 
[37m[36mINFO[0m[0m 01/31 15:50:35 | 0.135633    0.139239    0.609808    0.617089    1.083520    0.609808    0.617089    0.044036    0.047252    0.122796    0.122166    0.240068    0.248299    400         3.163723    1.089589    0.341546    211.916045 
[37m[36mINFO[0m[0m 01/31 15:55:12 | 0.264322    0.277561    0.669655    0.701477    0.985675    0.669655    0.701477    0.481320    0.505393    0.097922    0.107053    0.213724    0.220238    600         4.745584    1.047424    0.303818    215.640856 
[37m[36mINFO[0m[0m 01/31 15:59:58 | 0.250253    0.261795    0.712101    0.724684    0.907851    0.712101    0.724684    0.476826    0.502311    0.098237    0.107053    0.175696    0.176020    800         6.327445    0.950808    0.348556    216.092869 
[37m[36mINFO[0m[0m 01/31 16:05:07 | 0.273684    0.285269    0.716320    0.701477    0.909059    0.716320    0.701477    0.491077    0.517720    0.128149    0.127204    0.201827    0.210884    1000        7.909307    0.916951    0.431508    222.177876 
[37m[36mINFO[0m[0m 01/31 16:09:43 | 0.265969    0.273886    0.726602    0.722574    0.860435    0.726602    0.722574    0.489793    0.518747    0.117758    0.118388    0.190355    0.184524    1200        9.491168    0.875477    0.310774    213.545475 
[37m[36mINFO[0m[0m 01/31 16:14:33 | 0.148221    0.151900    0.733456    0.728903    0.831715    0.733456    0.728903    0.079086    0.085773    0.135705    0.130982    0.229870    0.238946    1400        11.073029   0.867523    0.421716    205.982698 
[37m[36mINFO[0m[0m 01/31 16:19:15 | 0.263014    0.266962    0.743738    0.729958    0.782751    0.743738    0.729958    0.466427    0.493066    0.139484    0.133501    0.183132    0.174320    1600        12.654891   0.795819    0.397153    202.126514 
[37m[36mINFO[0m[0m 01/31 16:23:44 | 0.134685    0.140103    0.757712    0.750000    0.749613    0.757712    0.750000    0.098087    0.105804    0.102015    0.109572    0.203952    0.204932    1800        14.236752   0.764594    0.309919    206.482131 
[37m[36mINFO[0m[0m 01/31 16:28:30 | 0.151722    0.156811    0.820722    0.805907    0.548091    0.820722    0.805907    0.104635    0.111967    0.132557    0.129723    0.217973    0.228741    2000        15.818613   0.668705    0.331060    219.548903 
[37m[36mINFO[0m[0m 01/31 16:33:14 | 0.149039    0.155554    0.833377    0.827004    0.487748    0.833377    0.827004    0.142124    0.154083    0.129723    0.127204    0.175271    0.185374    2200        17.400475   0.542717    0.317928    220.726770 
[37m[36mINFO[0m[0m 01/31 16:38:01 | 0.219026    0.227366    0.837596    0.819620    0.576036    0.837596    0.819620    0.140711    0.162301    0.192380    0.181360    0.323986    0.338435    2400        18.982336   0.468744    0.338126    219.451980 
[37m[36mINFO[0m[0m 01/31 16:42:56 | 0.222094    0.230219    0.879515    0.877637    0.356677    0.879515    0.877637    0.202850    0.206985    0.186398    0.180101    0.277034    0.303571    2600        20.564197   0.441053    0.360497    222.007182 
[37m[36mINFO[0m[0m 01/31 16:47:44 | 0.235872    0.238557    0.879779    0.877637    0.375496    0.879779    0.877637    0.217101    0.227530    0.204345    0.196474    0.286170    0.291667    2800        22.146059   0.396996    0.321467    222.984999 
[37m[36mINFO[0m[0m 01/31 16:52:36 | 0.232813    0.240297    0.882942    0.880802    0.347657    0.882942    0.880802    0.251252    0.261941    0.194584    0.185139    0.252603    0.273810    3000        23.727920   0.362680    0.335981    224.884970 
[37m[36mINFO[0m[0m 01/31 16:57:27 | 0.191661    0.195716    0.863960    0.835443    0.470846    0.863960    0.835443    0.185646    0.184386    0.191121    0.190176    0.198215    0.212585    3200        25.309781   0.356431    0.266084    237.451893 
[37m[36mINFO[0m[0m 01/31 17:02:22 | 0.261931    0.273238    0.899815    0.890295    0.322156    0.899815    0.890295    0.331878    0.347201    0.217884    0.221662    0.236031    0.250850    3400        26.891642   0.323015    0.294104    236.383795 
[37m[36mINFO[0m[0m 01/31 17:07:56 | 0.259057    0.274976    0.903770    0.889241    0.321594    0.903770    0.889241    0.227244    0.243451    0.236776    0.245592    0.313151    0.335884    3600        28.473504   0.364892    0.353605    263.440928 
[37m[36mINFO[0m[0m 01/31 17:13:05 | 0.275416    0.277600    0.905879    0.905063    0.289186    0.905879    0.905063    0.263834    0.271186    0.214421    0.202771    0.347992    0.358844    3800        30.055365   0.327379    0.298062    248.517641 
[37m[36mINFO[0m[0m 01/31 17:18:36 | 0.195959    0.201020    0.895861    0.878692    0.342609    0.895861    0.878692    0.183335    0.196713    0.216310    0.209068    0.188230    0.197279    4000        31.637226   0.284040    0.382325    254.602018 
[37m[36mINFO[0m[0m 01/31 17:23:48 | 0.256835    0.267797    0.913525    0.888186    0.302247    0.913525    0.888186    0.187315    0.206985    0.244332    0.241814    0.338857    0.354592    4200        33.219088   0.280887    0.369963    238.086402 
[37m[36mINFO[0m[0m 01/31 17:29:24 | 0.292916    0.307235    0.889270    0.863924    0.408832    0.889270    0.863924    0.300680    0.324602    0.228589    0.220403    0.349479    0.376701    4400        34.800949   0.281135    0.338929    267.907071 
[37m[36mINFO[0m[0m 01/31 17:34:51 | 0.263798    0.275448    0.924071    0.911392    0.244540    0.924071    0.911392    0.338169    0.360041    0.239924    0.241814    0.213299    0.224490    4600        36.382810   0.263701    0.388861    248.777322 
[37m[36mINFO[0m[0m 01/31 17:40:15 | 0.268678    0.284672    0.903506    0.880802    0.308071    0.903506    0.880802    0.227115    0.244479    0.246222    0.245592    0.332696    0.363946    4800        37.964672   0.229927    0.311737    261.666304 
[37m[36mINFO[0m[0m 01/31 17:45:58 | 0.213747    0.219920    0.903506    0.897679    0.267863    0.903506    0.897679    0.250995    0.262455    0.221348    0.217884    0.168897    0.179422    5000        39.546533   0.256801    0.442381    253.896795 
[37m[36mINFO[0m[0m 01/31 17:45:58 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[1, 2, 3]/250131_15-38-00_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/31 17:45:59 | ---
[37m[36mINFO[0m[0m 01/31 17:45:59 | test-domain validation(oracle) = 29.292%
[37m[36mINFO[0m[0m 01/31 17:45:59 | training-domain validation(iid) = 26.380%
[37m[36mINFO[0m[0m 01/31 17:45:59 | last = 21.375%
[37m[36mINFO[0m[0m 01/31 17:45:59 | last (inD) = 89.768%
[37m[36mINFO[0m[0m 01/31 17:45:59 | training-domain validation (iid, inD) = 91.139%
[37m[36mINFO[0m[0m 01/31 17:45:59 | === Summary ===
[37m[36mINFO[0m[0m 01/31 17:45:59 | Command: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm RSC --test_envs 1 2 3 --dataset TerraIncognita --trial_seed 0 --hparams_seed 4
[37m[36mINFO[0m[0m 01/31 17:45:59 | Unique name: 250131_15-38-00_resnet50_EVE
[37m[36mINFO[0m[0m 01/31 17:45:59 | Out path: train_output/TerraIncognita/RSC/[1, 2, 3]/250131_15-38-00_resnet50_EVE
[37m[36mINFO[0m[0m 01/31 17:45:59 | Algorithm: RSC
[37m[36mINFO[0m[0m 01/31 17:45:59 | Dataset: TerraIncognita

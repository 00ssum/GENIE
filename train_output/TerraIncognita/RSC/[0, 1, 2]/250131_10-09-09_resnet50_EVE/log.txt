[37m[36mINFO[0m[0m 01/31 10:09:10 | Command :: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm RSC --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 0 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/TerraIncognita/RSC/[0, 1, 2]/250131_10-09-09_resnet50_EVE
	out_root: train_output/TerraIncognita/RSC/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 0
	unique_name: 250131_10-09-09_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: GENIE
	freeze_bn: False
	pretrained: True
	lr: 5.0781288859686544e-05
	batch_size: 44
	weight_decay: 0.00046410133598234803
	rsc_f_drop_factor: 0.2665134852412123
	rsc_b_drop_factor: 0.28056710878365126
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/31 10:09:10 | n_steps = 5001
[37m[36mINFO[0m[0m 01/31 10:09:10 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/31 10:09:10 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/31 10:09:10 | 
[37m[36mINFO[0m[0m 01/31 10:09:10 | Testenv name escaping te_L100_L38_L43 -> te_L100_L38_L43
[37m[36mINFO[0m[0m 01/31 10:09:10 | Test envs = [0, 1, 2], name = te_L100_L38_L43
[37m[36mINFO[0m[0m 01/31 10:09:10 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 01/31 10:09:10 | Batch sizes for each domain: [0, 0, 0, 44] (total=44)
[37m[36mINFO[0m[0m 01/31 10:09:10 | steps-per-epoch for each domain: 106.98 -> min = 106.98
[37m[36mINFO[0m[0m 01/31 10:09:12 | # of params = 23528522
[37m[36mINFO[0m[0m 01/31 10:13:15 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/31 10:13:15 | 0.280848    0.303925    0.222222    0.210034    2.192491    0.200633    0.208861    0.455514    0.481253    0.186398    0.221662    0.222222    0.210034    0           0.000000    3.501482    1.951072    240.514726 
[37m[36mINFO[0m[0m 01/31 10:19:17 | 0.323882    0.351818    0.386233    0.375850    1.572216    0.201424    0.205696    0.454102    0.480740    0.316121    0.369018    0.386233    0.375850    200         1.869556    1.892475    0.576093    247.236240 
[37m[36mINFO[0m[0m 01/31 10:25:15 | 0.258847    0.269076    0.361589    0.369048    1.450935    0.521487    0.522152    0.020799    0.023112    0.234257    0.261965    0.361589    0.369048    400         3.739112    1.774269    0.572934    242.699528 
[37m[36mINFO[0m[0m 01/31 10:31:16 | 0.252870    0.261829    0.358190    0.371599    1.432701    0.506459    0.497890    0.020413    0.023112    0.231738    0.264484    0.358190    0.371599    600         5.608668    1.678243    0.624151    235.894493 
[37m[36mINFO[0m[0m 01/31 10:37:20 | 0.278810    0.306123    0.455917    0.450680    1.409000    0.200369    0.205696    0.323405    0.346174    0.312657    0.366499    0.455917    0.450680    800         7.478224    1.621078    0.677816    228.932287 
[37m[36mINFO[0m[0m 01/31 10:43:19 | 0.279162    0.309314    0.480348    0.477891    1.351732    0.202215    0.209916    0.311593    0.336415    0.323678    0.381612    0.480348    0.477891    1000        9.347780    1.587421    0.595465    239.381947 
[37m[36mINFO[0m[0m 01/31 10:49:19 | 0.303417    0.330832    0.500319    0.497449    1.312056    0.427366    0.411392    0.196046    0.223421    0.286839    0.357683    0.500319    0.497449    1200        11.217336   1.531114    0.645250    231.452893 
[37m[36mINFO[0m[0m 01/31 10:55:30 | 0.342970    0.370591    0.493095    0.507653    1.306141    0.460849    0.467300    0.277443    0.296867    0.290617    0.347607    0.493095    0.507653    1400        13.086892   1.474638    0.687869    233.088472 
[37m[36mINFO[0m[0m 01/31 11:01:34 | 0.368384    0.394471    0.514765    0.521259    1.257879    0.458476    0.465190    0.325202    0.346687    0.321474    0.371537    0.514765    0.521259    1600        14.956448   1.475044    0.643544    235.264599 
[37m[36mINFO[0m[0m 01/31 11:07:14 | 0.314052    0.338599    0.519439    0.517857    1.246094    0.322963    0.328059    0.300552    0.319979    0.318640    0.367758    0.519439    0.517857    1800        16.826004   1.417266    0.537374    232.212918 
[37m[36mINFO[0m[0m 01/31 11:12:47 | 0.357804    0.377407    0.530699    0.527211    1.249171    0.448721    0.439873    0.281808    0.310734    0.342884    0.381612    0.530699    0.527211    2000        18.695560   1.388851    0.565810    219.825136 
[37m[36mINFO[0m[0m 01/31 11:18:17 | 0.354923    0.381729    0.548545    0.549320    1.137376    0.329027    0.339662    0.402619    0.420134    0.333123    0.385390    0.548545    0.549320    2200        20.565116   1.365858    0.519554    225.823497 
[37m[36mINFO[0m[0m 01/31 11:23:53 | 0.338194    0.367049    0.555980    0.540816    1.087039    0.315054    0.330169    0.356015    0.391885    0.343514    0.379093    0.555980    0.540816    2400        22.434672   1.327448    0.539450    227.671202 
[37m[36mINFO[0m[0m 01/31 11:29:25 | 0.296987    0.319464    0.624177    0.617347    0.986431    0.196942    0.242616    0.307998    0.324088    0.386020    0.391688    0.624177    0.617347    2600        24.304228   1.246167    0.538245    224.192163 
[37m[36mINFO[0m[0m 01/31 11:34:38 | 0.230290    0.238606    0.665180    0.664966    0.906060    0.152122    0.176160    0.146745    0.150488    0.392003    0.389169    0.665180    0.664966    2800        26.173784   1.188450    0.520434    209.103037 
[37m[36mINFO[0m[0m 01/31 11:39:52 | 0.239086    0.250703    0.611855    0.630952    0.909924    0.253361    0.271097    0.124791    0.139702    0.339106    0.341310    0.611855    0.630952    3000        28.043340   1.129446    0.491972    214.879123 
[37m[36mINFO[0m[0m 01/31 11:45:10 | 0.241919    0.251534    0.664755    0.644558    0.959633    0.077511    0.097046    0.252150    0.269646    0.396096    0.387909    0.664755    0.644558    3200        29.912896   1.156860    0.505565    217.077814 
[37m[36mINFO[0m[0m 01/31 11:50:24 | 0.271504    0.275089    0.722966    0.723639    0.745522    0.160032    0.177215    0.219027    0.233693    0.435453    0.414358    0.722966    0.723639    3400        31.782452   1.039466    0.506715    213.131729 
[37m[36mINFO[0m[0m 01/31 11:55:29 | 0.291191    0.311013    0.700871    0.703231    0.758161    0.206169    0.222574    0.249583    0.283513    0.417821    0.426952    0.700871    0.703231    3600        33.652008   0.975622    0.503359    203.689032 
[37m[36mINFO[0m[0m 01/31 12:00:35 | 0.318663    0.326450    0.768218    0.755102    0.809471    0.315581    0.335443    0.224162    0.240883    0.416247    0.403023    0.768218    0.755102    3800        35.521564   0.938369    0.486584    208.017666 
[37m[36mINFO[0m[0m 01/31 12:05:37 | 0.421491    0.442595    0.751009    0.745748    0.765337    0.427366    0.435654    0.378354    0.404725    0.458753    0.487406    0.751009    0.745748    4000        37.391120   0.910825    0.505892    200.621702 
[37m[36mINFO[0m[0m 01/31 12:10:42 | 0.327172    0.350534    0.776716    0.774660    0.744430    0.254943    0.278481    0.274746    0.293272    0.451826    0.479849    0.776716    0.774660    4200        39.260676   0.835228    0.531340    198.278991 
[37m[36mINFO[0m[0m 01/31 12:15:46 | 0.343925    0.358602    0.764181    0.759354    0.662322    0.347746    0.371308    0.272821    0.287622    0.411209    0.416877    0.764181    0.759354    4400        41.130232   0.818067    0.501580    203.819037 
[37m[36mINFO[0m[0m 01/31 12:20:17 | 0.372268    0.394299    0.740174    0.738946    0.735401    0.337991    0.349156    0.339581    0.367745    0.439232    0.465995    0.740174    0.738946    4600        42.999788   0.790471    0.482931    174.565029 
[37m[36mINFO[0m[0m 01/31 12:24:48 | 0.348038    0.364695    0.785214    0.794218    0.600983    0.226206    0.250000    0.332392    0.355419    0.485516    0.488665    0.785214    0.794218    4800        44.869344   0.774938    0.468822    177.275228 
[37m[36mINFO[0m[0m 01/31 12:29:11 | 0.301647    0.309612    0.803697    0.785714    0.593126    0.148168    0.147679    0.286686    0.305085    0.470088    0.476071    0.803697    0.785714    5000        46.738900   0.702760    0.443910    173.301763 
[37m[36mINFO[0m[0m 01/31 12:29:11 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[0, 1, 2]/250131_10-09-09_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/31 12:29:12 | ---
[37m[36mINFO[0m[0m 01/31 12:29:12 | test-domain validation(oracle) = 42.149%
[37m[36mINFO[0m[0m 01/31 12:29:12 | training-domain validation(iid) = 34.804%
[37m[36mINFO[0m[0m 01/31 12:29:12 | last = 30.165%
[37m[36mINFO[0m[0m 01/31 12:29:12 | last (inD) = 78.571%
[37m[36mINFO[0m[0m 01/31 12:29:12 | training-domain validation (iid, inD) = 79.422%
[37m[36mINFO[0m[0m 01/31 12:29:12 | === Summary ===
[37m[36mINFO[0m[0m 01/31 12:29:12 | Command: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm RSC --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 0 --hparams_seed 1
[37m[36mINFO[0m[0m 01/31 12:29:12 | Unique name: 250131_10-09-09_resnet50_EVE
[37m[36mINFO[0m[0m 01/31 12:29:12 | Out path: train_output/TerraIncognita/RSC/[0, 1, 2]/250131_10-09-09_resnet50_EVE
[37m[36mINFO[0m[0m 01/31 12:29:12 | Algorithm: RSC
[37m[36mINFO[0m[0m 01/31 12:29:12 | Dataset: TerraIncognita

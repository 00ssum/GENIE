[37m[36mINFO[0m[0m 01/30 19:46:30 | Command :: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm RSC --test_envs 0 1 2 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_sgd.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_sgd
	out_dir: train_output/TerraIncognita/RSC/[0, 1, 2]/250130_19-46-30_resnet50_sgd
	out_root: train_output/TerraIncognita/RSC/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 0
	unique_name: 250130_19-46-30_resnet50_sgd
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: sgd
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	rsc_f_drop_factor: 0.3333333333333333
	rsc_b_drop_factor: 0.3333333333333333
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/30 19:46:30 | n_steps = 5001
[37m[36mINFO[0m[0m 01/30 19:46:30 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/30 19:46:30 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/30 19:46:30 | 
[37m[36mINFO[0m[0m 01/30 19:46:30 | Testenv name escaping te_L100_L38_L43 -> te_L100_L38_L43
[37m[36mINFO[0m[0m 01/30 19:46:30 | Test envs = [0, 1, 2], name = te_L100_L38_L43
[37m[36mINFO[0m[0m 01/30 19:46:30 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 01/30 19:46:30 | Batch sizes for each domain: [0, 0, 0, 32] (total=32)
[37m[36mINFO[0m[0m 01/30 19:46:30 | steps-per-epoch for each domain: 147.09 -> min = 147.09
[37m[36mINFO[0m[0m 01/30 19:46:32 | # of params = 23528522
[37m[36mINFO[0m[0m 01/30 19:49:52 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/30 19:49:52 | 0.053128    0.048481    0.029530    0.006803    2.519471    0.069866    0.060127    0.044807    0.048793    0.044710    0.036524    0.029530    0.006803    0           0.000000    3.704107    1.433967    197.974653 
[37m[36mINFO[0m[0m 01/30 19:53:58 | 0.221949    0.228633    0.231358    0.213435    2.241420    0.170577    0.154008    0.251252    0.271186    0.244018    0.260705    0.231358    0.213435    200         1.359677    2.996480    0.294589    186.633337 
[37m[36mINFO[0m[0m 01/30 19:58:18 | 0.284712    0.304312    0.288082    0.295068    2.190750    0.215133    0.220464    0.325716    0.343606    0.313287    0.348866    0.288082    0.295068    400         2.719354    2.643634    0.360858    187.647832 
[37m[36mINFO[0m[0m 01/30 20:02:39 | 0.249334    0.257493    0.320586    0.320578    2.156825    0.216979    0.232068    0.250481    0.255778    0.280542    0.284635    0.320586    0.320578    600         4.079031    2.488127    0.346108    191.381540 
[37m[36mINFO[0m[0m 01/30 20:07:05 | 0.214777    0.223868    0.320374    0.330782    2.127231    0.284735    0.297468    0.070869    0.083205    0.288728    0.290932    0.320374    0.330782    800         5.438708    2.407198    0.320084    202.078204 
[37m[36mINFO[0m[0m 01/30 20:11:21 | 0.256807    0.267623    0.325473    0.312075    2.099098    0.440285    0.460970    0.025035    0.030817    0.305101    0.311083    0.325473    0.312075    1000        6.798385    2.356968    0.291351    197.249032 
[37m[36mINFO[0m[0m 01/30 20:15:37 | 0.270108    0.278408    0.330571    0.319728    2.068921    0.487213    0.500000    0.019900    0.024140    0.303212    0.311083    0.330571    0.319728    1200        8.158062    2.311433    0.332954    189.361436 
[37m[36mINFO[0m[0m 01/30 20:19:52 | 0.271292    0.279576    0.346718    0.321429    2.038480    0.494859    0.510549    0.019900    0.024653    0.299118    0.303526    0.346718    0.321429    1400        9.517740    2.274782    0.345591    185.755686 
[37m[36mINFO[0m[0m 01/30 20:24:14 | 0.194612    0.201321    0.360314    0.350340    2.007213    0.274717    0.283755    0.022596    0.029276    0.286524    0.290932    0.360314    0.350340    1600        10.877417   2.244393    0.325174    197.517648 
[37m[36mINFO[0m[0m 01/30 20:28:41 | 0.179407    0.187766    0.383259    0.394558    1.974932    0.201951    0.208861    0.052895    0.067283    0.283375    0.287154    0.383259    0.394558    1800        12.237094   2.213918    0.333163    199.889944 
[37m[36mINFO[0m[0m 01/30 20:32:48 | 0.165239    0.171248    0.383684    0.378401    1.943741    0.202742    0.210970    0.031326    0.039548    0.261650    0.263224    0.383684    0.378401    2000        13.596771   2.195255    0.304884    186.262073 
[37m[36mINFO[0m[0m 01/30 20:37:02 | 0.164073    0.170971    0.393669    0.393707    1.910418    0.202215    0.207806    0.034022    0.043143    0.255982    0.261965    0.393669    0.393707    2200        14.956448   2.165109    0.343363    185.091951 
[37m[36mINFO[0m[0m 01/30 20:41:38 | 0.169603    0.180250    0.407691    0.431122    1.880677    0.199578    0.204641    0.058287    0.070365    0.250945    0.265743    0.407691    0.431122    2400        16.316125   2.148050    0.340491    208.459081 
[37m[36mINFO[0m[0m 01/30 20:46:32 | 0.178443    0.188955    0.405991    0.432823    1.851666    0.200105    0.203586    0.083965    0.095018    0.251259    0.268262    0.405991    0.432823    2600        17.675802   2.129209    0.351725    223.020155 
[37m[36mINFO[0m[0m 01/30 20:51:20 | 0.184429    0.196772    0.407053    0.419218    1.822280    0.196942    0.202532    0.101939    0.111967    0.254408    0.275819    0.407053    0.419218    2800        19.035479   2.104305    0.346085    219.225744 
[37m[36mINFO[0m[0m 01/30 20:56:08 | 0.194652    0.204136    0.411302    0.410714    1.795326    0.195360    0.204641    0.122224    0.129430    0.266373    0.278338    0.411302    0.410714    3000        20.395156   2.083584    0.425778    202.401975 
[37m[36mINFO[0m[0m 01/30 21:00:59 | 0.222065    0.243048    0.409390    0.402211    1.773678    0.191142    0.201477    0.174990    0.195172    0.300063    0.332494    0.409390    0.402211    3200        21.754833   2.076034    0.374945    215.873507 
[37m[36mINFO[0m[0m 01/30 21:05:50 | 0.260428    0.288706    0.404929    0.398810    1.752574    0.187978    0.198312    0.277186    0.305085    0.316121    0.362720    0.404929    0.398810    3400        23.114510   2.050887    0.393717    212.408237 
[37m[36mINFO[0m[0m 01/30 21:10:29 | 0.279948    0.310247    0.404291    0.390306    1.731970    0.190087    0.200422    0.328283    0.360041    0.321474    0.370277    0.404291    0.390306    3600        24.474187   2.035466    0.374653    204.070138 
[37m[36mINFO[0m[0m 01/30 21:15:37 | 0.294561    0.326022    0.394306    0.384354    1.714654    0.185341    0.196203    0.373090    0.407807    0.325252    0.374055    0.394306    0.384354    3800        25.833864   2.014463    0.421926    222.847516 
[37m[36mINFO[0m[0m 01/30 21:20:33 | 0.320984    0.349771    0.389208    0.369048    1.696745    0.190614    0.201477    0.446142    0.472522    0.326196    0.375315    0.389208    0.369048    4000        27.193542   1.992794    0.545712    185.866143 
[37m[36mINFO[0m[0m 01/30 21:24:56 | 0.323783    0.354762    0.379860    0.357993    1.682281    0.189032    0.199367    0.454230    0.483308    0.328086    0.381612    0.379860    0.357993    4200        28.553219   1.976349    0.358215    191.487592 
[37m[36mINFO[0m[0m 01/30 21:29:02 | 0.323266    0.353639    0.370300    0.331633    1.671012    0.188241    0.197257    0.454102    0.483308    0.327456    0.380353    0.370300    0.331633    4400        29.912896   1.965995    0.306197    184.493739 
[37m[36mINFO[0m[0m 01/30 21:33:07 | 0.318453    0.350758    0.371149    0.331633    1.663781    0.175059    0.189873    0.454102    0.483308    0.326196    0.379093    0.371149    0.331633    4600        31.272573   1.965933    0.315245    181.216140 
[37m[36mINFO[0m[0m 01/30 21:37:10 | 0.317225    0.349068    0.381347    0.344388    1.658418    0.171632    0.183544    0.453845    0.483308    0.326196    0.380353    0.381347    0.344388    4800        32.632250   1.970002    0.336164    176.452512 
[37m[36mINFO[0m[0m 01/30 21:41:21 | 0.313644    0.342886    0.387296    0.347789    1.649366    0.163723    0.168776    0.453845    0.483308    0.323363    0.376574    0.387296    0.347789    5000        33.991927   1.941283    0.357176    179.101107 
[37m[36mINFO[0m[0m 01/30 21:41:21 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[0, 1, 2]/250130_19-46-30_resnet50_sgd/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/30 21:41:22 | ---
[37m[36mINFO[0m[0m 01/30 21:41:22 | test-domain validation(oracle) = 32.378%
[37m[36mINFO[0m[0m 01/30 21:41:22 | training-domain validation(iid) = 17.844%
[37m[36mINFO[0m[0m 01/30 21:41:22 | last = 31.364%
[37m[36mINFO[0m[0m 01/30 21:41:22 | last (inD) = 34.779%
[37m[36mINFO[0m[0m 01/30 21:41:22 | training-domain validation (iid, inD) = 43.282%
[37m[36mINFO[0m[0m 01/30 21:41:22 | === Summary ===
[37m[36mINFO[0m[0m 01/30 21:41:22 | Command: /jsm0707/Large-scale/train_all.py resnet50_sgd config/resnet50_sgd.yaml --algorithm RSC --test_envs 0 1 2 --dataset TerraIncognita
[37m[36mINFO[0m[0m 01/30 21:41:22 | Unique name: 250130_19-46-30_resnet50_sgd
[37m[36mINFO[0m[0m 01/30 21:41:22 | Out path: train_output/TerraIncognita/RSC/[0, 1, 2]/250130_19-46-30_resnet50_sgd
[37m[36mINFO[0m[0m 01/30 21:41:22 | Algorithm: RSC
[37m[36mINFO[0m[0m 01/30 21:41:22 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 02/25 01:22:18 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 2 --hparams_seed 7
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 7
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[0, 1, 2]/250225_01-22-18_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 2
	unique_name: 250225_01-22-18_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.00023761560100715143
	batch_size: 20
	weight_decay: 4.1733891298839565e-05
	rsc_f_drop_factor: 0.44601479980567205
	rsc_b_drop_factor: 0.18901588283189613
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/25 01:22:18 | n_steps = 5001
[37m[36mINFO[0m[0m 02/25 01:22:18 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/25 01:22:18 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/25 01:22:18 | 
[37m[36mINFO[0m[0m 02/25 01:22:18 | Testenv name escaping te_L100_L38_L43 -> te_L100_L38_L43
[37m[36mINFO[0m[0m 02/25 01:22:18 | Test envs = [0, 1, 2], name = te_L100_L38_L43
[37m[36mINFO[0m[0m 02/25 01:22:18 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 02/25 01:22:18 | Batch sizes for each domain: [0, 0, 0, 20] (total=20)
[37m[36mINFO[0m[0m 02/25 01:22:18 | steps-per-epoch for each domain: 235.35 -> min = 235.35
[37m[36mINFO[0m[0m 02/25 01:22:19 | # of params = 23528522
[37m[36mINFO[0m[0m 02/25 01:25:01 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/25 01:25:01 | 0.288403    0.273706    0.226896    0.210884    2.144689    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.226896    0.210884    0           0.000000    3.396486    1.236613    160.997329 
[37m[36mINFO[0m[0m 02/25 01:28:22 | 0.275921    0.278703    0.322074    0.321429    1.644467    0.534142    0.556962    0.022211    0.015922    0.271411    0.263224    0.322074    0.321429    200         0.849798    1.904878    0.179933    165.027268 
[37m[36mINFO[0m[0m 02/25 01:31:46 | 0.272505    0.273292    0.379222    0.387755    1.590897    0.519905    0.543249    0.023366    0.015922    0.274244    0.260705    0.379222    0.387755    400         1.699596    1.797019    0.187322    166.530002 
[37m[36mINFO[0m[0m 02/25 01:35:03 | 0.190179    0.180000    0.415126    0.437075    1.529790    0.201424    0.195148    0.110926    0.092964    0.258186    0.251889    0.415126    0.437075    600         2.549395    1.774727    0.172144    162.219056 
[37m[36mINFO[0m[0m 02/25 01:38:31 | 0.320914    0.307364    0.429573    0.442177    1.530413    0.201424    0.198312    0.419694    0.400103    0.341625    0.323678    0.429573    0.442177    800         3.399193    1.729342    0.213812    165.212268 
[37m[36mINFO[0m[0m 02/25 01:41:51 | 0.252554    0.241233    0.449331    0.466837    1.445789    0.201424    0.195148    0.255232    0.241397    0.301008    0.287154    0.449331    0.466837    1000        4.248991    1.716445    0.177301    164.922839 
[37m[36mINFO[0m[0m 02/25 01:45:20 | 0.308323    0.299730    0.459741    0.468537    1.405676    0.173741    0.186709    0.402362    0.388803    0.348866    0.323678    0.459741    0.468537    1200        5.098789    1.676199    0.195364    169.520926 
[37m[36mINFO[0m[0m 02/25 01:48:42 | 0.266089    0.272033    0.370300    0.396259    1.427248    0.522278    0.543249    0.022211    0.015922    0.253778    0.256927    0.370300    0.396259    1400        5.948587    1.695935    0.172682    168.091750 
[37m[36mINFO[0m[0m 02/25 01:52:01 | 0.192212    0.192879    0.459316    0.483844    1.372661    0.283944    0.302743    0.039543    0.030303    0.253149    0.245592    0.459316    0.483844    1600        6.798385    1.621936    0.187379    161.378829 
[37m[36mINFO[0m[0m 02/25 01:55:24 | 0.288250    0.277463    0.487147    0.496599    1.370041    0.169786    0.175105    0.390808    0.373909    0.304156    0.283375    0.487147    0.496599    1800        7.648184    1.594999    0.183224    166.231545 
[37m[36mINFO[0m[0m 02/25 01:58:47 | 0.313577    0.300194    0.483748    0.501701    1.329624    0.203796    0.201477    0.418924    0.400616    0.318010    0.298489    0.483748    0.501701    2000        8.497982    1.572626    0.182854    165.917629 
[37m[36mINFO[0m[0m 02/25 02:02:01 | 0.286029    0.272173    0.498194    0.511905    1.268298    0.078829    0.084388    0.422519    0.402157    0.356738    0.329975    0.498194    0.511905    2200        9.347780    1.540565    0.174302    159.112825 
[37m[36mINFO[0m[0m 02/25 02:05:27 | 0.348142    0.357631    0.501381    0.520408    1.248038    0.388611    0.424051    0.348825    0.327684    0.306990    0.321159    0.501381    0.520408    2400        10.197578   1.489220    0.214477    163.419307 
[37m[36mINFO[0m[0m 02/25 02:08:41 | 0.354634    0.356924    0.561292    0.568027    1.148120    0.362774    0.386076    0.370523    0.358500    0.330605    0.326196    0.561292    0.568027    2600        11.047376   1.474303    0.179295    158.520297 
[37m[36mINFO[0m[0m 02/25 02:12:05 | 0.344633    0.346021    0.584874    0.601190    1.100121    0.458212    0.475738    0.251380    0.242424    0.324307    0.319899    0.584874    0.601190    2800        11.897174   1.396971    0.182335    167.136617 
[37m[36mINFO[0m[0m 02/25 02:15:20 | 0.396189    0.386165    0.623539    0.638605    1.038259    0.472186    0.489451    0.344845    0.330252    0.371537    0.338791    0.623539    0.638605    3000        12.746973   1.367622    0.197179    156.039726 
[37m[36mINFO[0m[0m 02/25 02:18:43 | 0.308931    0.303513    0.631188    0.643707    1.042196    0.192196    0.212025    0.385415    0.369800    0.349181    0.328715    0.631188    0.643707    3200        13.596771   1.333322    0.182125    165.833398 
[37m[36mINFO[0m[0m 02/25 02:22:03 | 0.336215    0.326225    0.663267    0.659864    0.969236    0.217242    0.228903    0.389010    0.363123    0.402393    0.386650    0.663267    0.659864    3400        14.446569   1.280284    0.176798    164.862536 
[37m[36mINFO[0m[0m 02/25 02:25:26 | 0.295328    0.287640    0.673040    0.681122    0.952479    0.326918    0.334388    0.191937    0.174628    0.367128    0.353904    0.673040    0.681122    3600        15.296367   1.234624    0.210400    160.656716 
[37m[36mINFO[0m[0m 02/25 02:28:47 | 0.427812    0.426011    0.667729    0.696429    0.950113    0.551542    0.571730    0.375786    0.368772    0.356108    0.337531    0.667729    0.696429    3800        16.146165   1.226075    0.175815    166.133236 
[37m[36mINFO[0m[0m 02/25 02:32:03 | 0.300203    0.281103    0.725303    0.722789    0.796542    0.162932    0.168776    0.345359    0.314330    0.392317    0.360202    0.725303    0.722789    4000        16.995963   1.189546    0.171980    161.370573 
[37m[36mINFO[0m[0m 02/25 02:35:33 | 0.222471    0.219597    0.708307    0.743197    0.885006    0.121276    0.145570    0.167672    0.164355    0.378463    0.348866    0.708307    0.743197    4200        17.845762   1.137006    0.208068    168.733899 
[37m[36mINFO[0m[0m 02/25 02:38:54 | 0.349766    0.342306    0.730402    0.725340    0.817471    0.320854    0.324895    0.253948    0.237288    0.474496    0.464736    0.730402    0.725340    4400        18.695560   1.139867    0.180578    164.813711 
[37m[36mINFO[0m[0m 02/25 02:42:04 | 0.255411    0.242002    0.729977    0.746599    0.945000    0.095175    0.101266    0.213249    0.200308    0.457809    0.424433    0.729977    0.746599    4600        19.545358   1.143614    0.184587    153.063325 
[37m[36mINFO[0m[0m 02/25 02:45:19 | 0.394441    0.385551    0.739324    0.744898    0.743382    0.471922    0.505274    0.261779    0.249615    0.449622    0.401763    0.739324    0.744898    4800        20.395156   1.066413    0.168840    160.773639 
[37m[36mINFO[0m[0m 02/25 02:48:29 | 0.436741    0.417421    0.743573    0.768707    0.674327    0.453203    0.474684    0.398896    0.368259    0.458123    0.409320    0.743573    0.768707    5000        21.244954   1.045358    0.171205    156.475008 
[37m[36mINFO[0m[0m 02/25 02:48:29 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[0, 1, 2]/250225_01-22-18_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/25 02:48:31 | ---
[37m[36mINFO[0m[0m 02/25 02:48:31 | test-domain validation(oracle) = 42.781%
[37m[36mINFO[0m[0m 02/25 02:48:31 | training-domain validation(iid) = 43.674%
[37m[36mINFO[0m[0m 02/25 02:48:31 | last = 43.674%
[37m[36mINFO[0m[0m 02/25 02:48:31 | last (inD) = 76.871%
[37m[36mINFO[0m[0m 02/25 02:48:31 | training-domain validation (iid, inD) = 76.871%
[37m[36mINFO[0m[0m 02/25 02:48:31 | === Summary ===
[37m[36mINFO[0m[0m 02/25 02:48:31 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 2 --hparams_seed 7
[37m[36mINFO[0m[0m 02/25 02:48:31 | Unique name: 250225_01-22-18_resnet50_GENIE
[37m[36mINFO[0m[0m 02/25 02:48:31 | Out path: train_output/TerraIncognita/RSC/[0, 1, 2]/250225_01-22-18_resnet50_GENIE
[37m[36mINFO[0m[0m 02/25 02:48:31 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/25 02:48:31 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 01/29 20:28:57 | Command :: /jsm0707/Large-scale/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm RSC --test_envs 0 1 2 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_adam.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_adam
	out_dir: train_output/TerraIncognita/RSC/[0, 1, 2]/250129_20-28-57_resnet50_adam
	out_root: train_output/TerraIncognita/RSC/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 0
	unique_name: 250129_20-28-57_resnet50_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	rsc_f_drop_factor: 0.3333333333333333
	rsc_b_drop_factor: 0.3333333333333333
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/29 20:28:57 | n_steps = 5001
[37m[36mINFO[0m[0m 01/29 20:28:57 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/29 20:28:57 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/29 20:28:57 | 
[37m[36mINFO[0m[0m 01/29 20:28:58 | Testenv name escaping te_L100_L38_L43 -> te_L100_L38_L43
[37m[36mINFO[0m[0m 01/29 20:28:58 | Test envs = [0, 1, 2], name = te_L100_L38_L43
[37m[36mINFO[0m[0m 01/29 20:28:58 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 01/29 20:28:58 | Batch sizes for each domain: [0, 0, 0, 32] (total=32)
[37m[36mINFO[0m[0m 01/29 20:28:58 | steps-per-epoch for each domain: 147.09 -> min = 147.09
[37m[36mINFO[0m[0m 01/29 20:29:00 | # of params = 23528522
[37m[36mINFO[0m[0m 01/29 20:32:06 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/29 20:32:06 | 0.084057    0.081752    0.134481    0.159014    2.319457    0.082520    0.068565    0.122737    0.137648    0.046914    0.039043    0.134481    0.159014    0           0.000000    3.704107    2.446022    183.617050 
[37m[36mINFO[0m[0m 01/29 20:36:08 | 0.221163    0.241499    0.459953    0.454082    1.449509    0.220933    0.233122    0.178072    0.194145    0.264484    0.297229    0.459953    0.454082    200         1.359677    1.847095    0.377980    165.624812 
[37m[36mINFO[0m[0m 01/29 20:40:24 | 0.308831    0.332826    0.470363    0.471939    1.409577    0.209333    0.220464    0.408910    0.430406    0.308249    0.347607    0.470363    0.471939    400         2.719354    1.476241    0.386649    178.723751 
[37m[36mINFO[0m[0m 01/29 20:44:42 | 0.323960    0.348554    0.486085    0.491497    1.293476    0.220406    0.231013    0.428425    0.449409    0.323048    0.365239    0.486085    0.491497    600         4.079031    1.381228    0.345566    188.402282 
[37m[36mINFO[0m[0m 01/29 20:48:40 | 0.275855    0.302542    0.541959    0.562075    1.156412    0.146586    0.159283    0.347541    0.380586    0.333438    0.367758    0.541959    0.562075    800         5.438708    1.311645    0.288144    179.647501 
[37m[36mINFO[0m[0m 01/29 20:52:48 | 0.254958    0.272698    0.586786    0.585884    1.111653    0.060902    0.080169    0.344717    0.362609    0.359257    0.375315    0.586786    0.585884    1000        6.798385    1.292474    0.289266    189.667583 
[37m[36mINFO[0m[0m 01/29 20:57:01 | 0.389965    0.410744    0.672190    0.684524    0.872797    0.314263    0.317511    0.441905    0.466359    0.413728    0.448363    0.672190    0.684524    1200        8.158062    1.015310    0.300585    192.408432 
[37m[36mINFO[0m[0m 01/29 21:01:18 | 0.350415    0.347165    0.727002    0.743197    0.738312    0.355919    0.352321    0.254205    0.263482    0.441121    0.425693    0.727002    0.743197    1400        9.517740    0.800026    0.321384    192.143307 
[37m[36mINFO[0m[0m 01/29 21:05:23 | 0.391542    0.403648    0.766306    0.767007    0.669029    0.374637    0.376582    0.310695    0.334361    0.489295    0.500000    0.766306    0.767007    1600        10.877417   0.712541    0.338628    177.902164 
[37m[36mINFO[0m[0m 01/29 21:09:45 | 0.471757    0.483537    0.772042    0.782313    0.649823    0.495650    0.517932    0.402619    0.417565    0.517003    0.515113    0.772042    0.782313    1800        12.237094   0.682668    0.345685    192.328620 
[37m[36mINFO[0m[0m 01/29 21:14:10 | 0.302050    0.317810    0.787975    0.788265    0.623203    0.220406    0.238397    0.217229    0.232666    0.468514    0.482368    0.787975    0.788265    2000        13.596771   0.649256    0.349938    193.837116 
[37m[36mINFO[0m[0m 01/29 21:18:28 | 0.323921    0.336449    0.800297    0.792517    0.630995    0.272344    0.277426    0.227757    0.233179    0.471662    0.498741    0.800297    0.792517    2200        14.956448   0.590498    0.315741    195.547901 
[37m[36mINFO[0m[0m 01/29 21:22:18 | 0.319618    0.331640    0.822180    0.802721    0.580500    0.180596    0.193038    0.303762    0.322034    0.474496    0.479849    0.822180    0.802721    2400        16.316125   0.534574    0.274407    174.466364 
[37m[36mINFO[0m[0m 01/29 21:26:19 | 0.336804    0.339903    0.817081    0.800170    0.576041    0.330345    0.336498    0.163692    0.175655    0.516373    0.507557    0.817081    0.800170    2600        17.675802   0.499174    0.309731    179.715269 
[37m[36mINFO[0m[0m 01/29 21:30:22 | 0.412411    0.424234    0.833652    0.803571    0.575391    0.431848    0.464135    0.279882    0.289676    0.525504    0.518892    0.833652    0.803571    2800        19.035479   0.505395    0.318307    179.130854 
[37m[36mINFO[0m[0m 01/29 21:34:28 | 0.419958    0.443572    0.849161    0.825680    0.536274    0.411548    0.428270    0.339196    0.364664    0.509131    0.537783    0.849161    0.825680    3000        20.395156   0.475477    0.296161    186.007747 
[37m[36mINFO[0m[0m 01/29 21:38:35 | 0.370969    0.385029    0.851710    0.816327    0.544907    0.273662    0.274262    0.315316    0.340524    0.523929    0.540302    0.851710    0.816327    3200        21.754833   0.470268    0.333447    180.680569 
[37m[36mINFO[0m[0m 01/29 21:42:42 | 0.374983    0.399128    0.830253    0.811224    0.521585    0.322172    0.333333    0.338041    0.359014    0.464736    0.505038    0.830253    0.811224    3400        23.114510   0.443388    0.326676    181.720923 
[37m[36mINFO[0m[0m 01/29 21:46:54 | 0.393368    0.412351    0.848948    0.819728    0.557532    0.285790    0.293249    0.373219    0.393426    0.521096    0.550378    0.848948    0.819728    3600        24.474187   0.449925    0.334563    184.529315 
[37m[36mINFO[0m[0m 01/29 21:51:13 | 0.370848    0.382277    0.872743    0.852041    0.511662    0.276562    0.297468    0.302606    0.315357    0.533375    0.534005    0.872743    0.852041    3800        25.833864   0.392123    0.307246    197.152674 
[37m[36mINFO[0m[0m 01/29 21:55:16 | 0.408755    0.421703    0.882515    0.844388    0.521256    0.357501    0.371308    0.330980    0.347201    0.537783    0.546599    0.882515    0.844388    4000        27.193542   0.373498    0.314438    180.243029 
[37m[36mINFO[0m[0m 01/29 21:59:22 | 0.372252    0.383388    0.868919    0.840986    0.500859    0.264698    0.282700    0.349852    0.366204    0.502204    0.501259    0.868919    0.840986    4200        28.553219   0.357534    0.261433    193.887703 
[37m[36mINFO[0m[0m 01/29 22:03:18 | 0.365744    0.377000    0.879329    0.838435    0.485803    0.326127    0.352321    0.242136    0.254751    0.528967    0.523929    0.879329    0.838435    4400        29.912896   0.351354    0.268084    182.336604 
[37m[36mINFO[0m[0m 01/29 22:07:19 | 0.368287    0.383365    0.870618    0.817177    0.563620    0.310308    0.325949    0.266530    0.287622    0.528023    0.536524    0.870618    0.817177    4600        31.272573   0.345600    0.329672    174.954032 
[37m[36mINFO[0m[0m 01/29 22:11:25 | 0.385503    0.398006    0.876354    0.854592    0.473981    0.302136    0.315401    0.359096    0.369800    0.495277    0.508816    0.876354    0.854592    4800        32.632250   0.346515    0.329118    180.497932 
[37m[36mINFO[0m[0m 01/29 22:15:43 | 0.356148    0.365317    0.881453    0.833333    0.544799    0.259953    0.274262    0.297471    0.304058    0.511020    0.517632    0.881453    0.833333    5000        33.991927   0.328648    0.295698    198.633351 
[37m[36mINFO[0m[0m 01/29 22:15:43 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[0, 1, 2]/250129_20-28-57_resnet50_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/29 22:15:45 | ---
[37m[36mINFO[0m[0m 01/29 22:15:45 | test-domain validation(oracle) = 47.176%
[37m[36mINFO[0m[0m 01/29 22:15:45 | training-domain validation(iid) = 38.550%
[37m[36mINFO[0m[0m 01/29 22:15:45 | last = 35.615%
[37m[36mINFO[0m[0m 01/29 22:15:45 | last (inD) = 83.333%
[37m[36mINFO[0m[0m 01/29 22:15:45 | training-domain validation (iid, inD) = 85.459%
[37m[36mINFO[0m[0m 01/29 22:15:45 | === Summary ===
[37m[36mINFO[0m[0m 01/29 22:15:45 | Command: /jsm0707/Large-scale/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm RSC --test_envs 0 1 2 --dataset TerraIncognita
[37m[36mINFO[0m[0m 01/29 22:15:45 | Unique name: 250129_20-28-57_resnet50_adam
[37m[36mINFO[0m[0m 01/29 22:15:45 | Out path: train_output/TerraIncognita/RSC/[0, 1, 2]/250129_20-28-57_resnet50_adam
[37m[36mINFO[0m[0m 01/29 22:15:45 | Algorithm: RSC
[37m[36mINFO[0m[0m 01/29 22:15:45 | Dataset: TerraIncognita

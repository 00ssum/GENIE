[37m[36mINFO[0m[0m 02/25 12:52:03 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 2 --hparams_seed 15
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 15
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[0, 1, 2]/250225_12-52-03_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 2
	unique_name: 250225_12-52-03_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.00023237243746776078
	batch_size: 13
	weight_decay: 1.8132449266758068e-05
	rsc_f_drop_factor: 0.24183226524778567
	rsc_b_drop_factor: 0.3096137712605297
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/25 12:52:03 | n_steps = 5001
[37m[36mINFO[0m[0m 02/25 12:52:03 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/25 12:52:03 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/25 12:52:03 | 
[37m[36mINFO[0m[0m 02/25 12:52:03 | Testenv name escaping te_L100_L38_L43 -> te_L100_L38_L43
[37m[36mINFO[0m[0m 02/25 12:52:03 | Test envs = [0, 1, 2], name = te_L100_L38_L43
[37m[36mINFO[0m[0m 02/25 12:52:03 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 02/25 12:52:03 | Batch sizes for each domain: [0, 0, 0, 13] (total=13)
[37m[36mINFO[0m[0m 02/25 12:52:03 | steps-per-epoch for each domain: 362.08 -> min = 362.08
[37m[36mINFO[0m[0m 02/25 12:52:04 | # of params = 23528522
[37m[36mINFO[0m[0m 02/25 12:54:41 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/25 12:54:41 | 0.288193    0.273286    0.227958    0.208333    2.159689    0.203533    0.197257    0.464886    0.443760    0.196159    0.178841    0.227958    0.208333    0           0.000000    3.461463    1.056531    155.155096 
[37m[36mINFO[0m[0m 02/25 12:57:52 | 0.258713    0.260711    0.328235    0.361395    1.634181    0.515950    0.532700    0.022468    0.016436    0.237720    0.232997    0.328235    0.361395    200         0.552369    1.920516    0.136182    164.345288 
[37m[36mINFO[0m[0m 02/25 13:01:03 | 0.194602    0.183034    0.429785    0.448980    1.538677    0.172950    0.172996    0.107331    0.093991    0.303526    0.282116    0.429785    0.448980    400         1.104738    1.780598    0.135742    163.595522 
[37m[36mINFO[0m[0m 02/25 13:04:18 | 0.337815    0.320511    0.421712    0.455782    1.477679    0.245716    0.231013    0.442162    0.423215    0.325567    0.307305    0.421712    0.455782    600         1.657106    1.707952    0.160240    163.098230 
[37m[36mINFO[0m[0m 02/25 13:07:26 | 0.341051    0.327788    0.448269    0.481293    1.419736    0.219351    0.217300    0.444858    0.424756    0.358942    0.341310    0.448269    0.481293    800         2.209475    1.625700    0.150925    157.747654 
[37m[36mINFO[0m[0m 02/25 13:10:27 | 0.324110    0.308501    0.456129    0.477041    1.420038    0.209597    0.205696    0.411349    0.389831    0.351385    0.329975    0.456129    0.477041    1000        2.761844    1.601463    0.137340    153.629552 
[37m[36mINFO[0m[0m 02/25 13:13:35 | 0.324599    0.310681    0.441045    0.458333    1.402831    0.201951    0.196203    0.443446    0.424756    0.328401    0.311083    0.441045    0.458333    1200        3.314213    1.575127    0.131297    161.364883 
[37m[36mINFO[0m[0m 02/25 13:16:39 | 0.323577    0.310426    0.459528    0.486395    1.403876    0.189032    0.190928    0.428425    0.410375    0.353275    0.329975    0.459528    0.486395    1400        3.866582    1.526231    0.137226    157.088179 
[37m[36mINFO[0m[0m 02/25 13:19:43 | 0.336567    0.322443    0.468026    0.485544    1.383177    0.222252    0.219409    0.442676    0.424242    0.344773    0.323678    0.468026    0.485544    1600        4.418950    1.491794    0.126797    158.749840 
[37m[36mINFO[0m[0m 02/25 13:23:00 | 0.220111    0.205047    0.421712    0.460884    1.403251    0.025046    0.024262    0.315702    0.299949    0.319584    0.290932    0.421712    0.460884    1800        4.971319    1.544178    0.155570    165.562078 
[37m[36mINFO[0m[0m 02/25 13:26:11 | 0.292784    0.278806    0.477162    0.493197    1.360941    0.217242    0.214135    0.322634    0.308680    0.338476    0.313602    0.477162    0.493197    2000        5.523688    1.500276    0.132234    164.448386 
[37m[36mINFO[0m[0m 02/25 13:29:24 | 0.336573    0.322611    0.467601    0.492347    1.381256    0.211706    0.208861    0.441905    0.422702    0.356108    0.336272    0.467601    0.492347    2200        6.076057    1.464951    0.138166    164.911289 
[37m[36mINFO[0m[0m 02/25 13:32:42 | 0.324745    0.309489    0.459103    0.478741    1.374951    0.201687    0.195148    0.443831    0.424756    0.328715    0.308564    0.459103    0.478741    2400        6.628426    1.464828    0.154343    167.513155 
[37m[36mINFO[0m[0m 02/25 13:35:49 | 0.326713    0.311691    0.453580    0.484694    1.375293    0.201424    0.196203    0.443703    0.425270    0.335013    0.313602    0.453580    0.484694    2600        7.180795    1.475582    0.123349    162.515089 
[37m[36mINFO[0m[0m 02/25 13:38:58 | 0.334339    0.320770    0.496707    0.508503    1.318096    0.283417    0.282700    0.371678    0.355932    0.347922    0.323678    0.496707    0.508503    2800        7.733163    1.487505    0.138543    160.968382 
[37m[36mINFO[0m[0m 02/25 13:42:26 | 0.345084    0.332414    0.476949    0.478741    1.369854    0.272080    0.267932    0.444216    0.425783    0.318955    0.303526    0.476949    0.478741    3000        8.285532    1.436189    0.138583    180.856283 
[37m[36mINFO[0m[0m 02/25 13:45:34 | 0.331359    0.316712    0.509029    0.526361    1.310638    0.381756    0.387131    0.243934    0.225475    0.368388    0.337531    0.509029    0.526361    3200        8.837901    1.447777    0.131369    161.309190 
[37m[36mINFO[0m[0m 02/25 13:48:51 | 0.375761    0.364898    0.488421    0.504252    1.333358    0.459531    0.458861    0.344075    0.332306    0.323678    0.303526    0.488421    0.504252    3400        9.390270    1.464366    0.139178    168.905396 
[37m[36mINFO[0m[0m 02/25 13:52:08 | 0.386810    0.378051    0.507330    0.519558    1.302664    0.410229    0.422996    0.388111    0.372368    0.362091    0.338791    0.507330    0.519558    3600        9.942639    1.427166    0.150989    167.174593 
[37m[36mINFO[0m[0m 02/25 13:55:15 | 0.324973    0.312956    0.511579    0.524660    1.280433    0.420775    0.425105    0.217871    0.192604    0.336272    0.321159    0.511579    0.524660    3800        10.495007   1.422285    0.136845    159.760351 
[37m[36mINFO[0m[0m 02/25 13:58:20 | 0.337435    0.330819    0.514128    0.529762    1.290390    0.483786    0.503165    0.185004    0.164355    0.343514    0.324937    0.514128    0.529762    4000        11.047376   1.413898    0.147486    155.547659 
[37m[36mINFO[0m[0m 02/25 14:01:50 | 0.391846    0.378157    0.520714    0.522109    1.335197    0.365674    0.377637    0.445885    0.429379    0.363980    0.327456    0.520714    0.522109    4200        11.599745   1.405417    0.164642    176.580416 
[37m[36mINFO[0m[0m 02/25 14:04:57 | 0.396917    0.392355    0.520501    0.527211    1.290614    0.428421    0.451477    0.403389    0.389317    0.358942    0.336272    0.520501    0.527211    4400        12.152114   1.449791    0.142554    158.436737 
[37m[36mINFO[0m[0m 02/25 14:08:10 | 0.391447    0.385097    0.535160    0.536565    1.269376    0.457685    0.481013    0.352677    0.340524    0.363980    0.333753    0.535160    0.536565    4600        12.704483   1.386362    0.130567    167.557685 
[37m[36mINFO[0m[0m 02/25 14:11:19 | 0.401577    0.386599    0.528362    0.533163    1.239903    0.437385    0.455696    0.388882    0.359014    0.378463    0.345088    0.528362    0.533163    4800        13.256851   1.361556    0.130208    162.359113 
[37m[36mINFO[0m[0m 02/25 14:14:25 | 0.326875    0.321126    0.524113    0.531463    1.282164    0.476140    0.503165    0.172936    0.145352    0.331549    0.314861    0.524113    0.531463    5000        13.809220   1.369793    0.135720    158.580213 
[37m[36mINFO[0m[0m 02/25 14:14:25 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[0, 1, 2]/250225_12-52-03_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/25 14:14:26 | ---
[37m[36mINFO[0m[0m 02/25 14:14:26 | test-domain validation(oracle) = 39.692%
[37m[36mINFO[0m[0m 02/25 14:14:26 | training-domain validation(iid) = 39.145%
[37m[36mINFO[0m[0m 02/25 14:14:26 | last = 32.688%
[37m[36mINFO[0m[0m 02/25 14:14:26 | last (inD) = 53.146%
[37m[36mINFO[0m[0m 02/25 14:14:26 | training-domain validation (iid, inD) = 53.656%
[37m[36mINFO[0m[0m 02/25 14:14:26 | === Summary ===
[37m[36mINFO[0m[0m 02/25 14:14:26 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 2 --hparams_seed 15
[37m[36mINFO[0m[0m 02/25 14:14:26 | Unique name: 250225_12-52-03_resnet50_GENIE
[37m[36mINFO[0m[0m 02/25 14:14:26 | Out path: train_output/TerraIncognita/RSC/[0, 1, 2]/250225_12-52-03_resnet50_GENIE
[37m[36mINFO[0m[0m 02/25 14:14:26 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/25 14:14:26 | Dataset: TerraIncognita

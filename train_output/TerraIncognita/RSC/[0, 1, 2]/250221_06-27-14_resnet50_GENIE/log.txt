[37m[36mINFO[0m[0m 02/21 06:27:14 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 0 --hparams_seed 20
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 20
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[0, 1, 2]/250221_06-27-14_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 0
	unique_name: 250221_06-27-14_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.6157673767852512e-05
	batch_size: 32
	weight_decay: 1.110622050999988e-05
	rsc_f_drop_factor: 0.011558843074644498
	rsc_b_drop_factor: 0.009443205254898168
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/21 06:27:14 | n_steps = 5001
[37m[36mINFO[0m[0m 02/21 06:27:14 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/21 06:27:14 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/21 06:27:14 | 
[37m[36mINFO[0m[0m 02/21 06:27:14 | Testenv name escaping te_L100_L38_L43 -> te_L100_L38_L43
[37m[36mINFO[0m[0m 02/21 06:27:14 | Test envs = [0, 1, 2], name = te_L100_L38_L43
[37m[36mINFO[0m[0m 02/21 06:27:14 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 02/21 06:27:14 | Batch sizes for each domain: [0, 0, 0, 32] (total=32)
[37m[36mINFO[0m[0m 02/21 06:27:14 | steps-per-epoch for each domain: 147.09 -> min = 147.09
[37m[36mINFO[0m[0m 02/21 06:27:16 | # of params = 23528522
[37m[36mINFO[0m[0m 02/21 06:30:07 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/21 06:30:07 | 0.280848    0.303925    0.222222    0.210034    2.218211    0.200633    0.208861    0.455514    0.481253    0.186398    0.221662    0.222222    0.210034    0           0.000000    2.603086    1.073093    170.814968 
[37m[36mINFO[0m[0m 02/21 06:33:44 | 0.322767    0.344799    0.446144    0.454082    1.406487    0.224624    0.234177    0.409295    0.432460    0.334383    0.367758    0.446144    0.454082    200         1.359677    1.596841    0.269812    162.893240 
[37m[36mINFO[0m[0m 02/21 06:37:32 | 0.335315    0.360358    0.482048    0.499150    1.367426    0.219615    0.231013    0.430222    0.457114    0.356108    0.392947    0.482048    0.499150    400         2.719354    1.427146    0.288903    170.018896 
[37m[36mINFO[0m[0m 02/21 06:41:14 | 0.291430    0.322271    0.523263    0.515306    1.258477    0.202215    0.226793    0.395943    0.406266    0.276134    0.333753    0.523263    0.515306    600         4.079031    1.346640    0.295258    162.563512 
[37m[36mINFO[0m[0m 02/21 06:44:57 | 0.244820    0.249462    0.611855    0.619048    1.036908    0.255207    0.260549    0.150854    0.154083    0.328401    0.333753    0.611855    0.619048    800         5.438708    1.192177    0.273141    168.776549 
[37m[36mINFO[0m[0m 02/21 06:48:37 | 0.275470    0.282653    0.690249    0.709184    0.789127    0.119958    0.129747    0.243292    0.240883    0.463161    0.477330    0.690249    0.709184    1000        6.798385    1.004923    0.297191    160.474660 
[37m[36mINFO[0m[0m 02/21 06:52:22 | 0.336197    0.352534    0.733376    0.749150    0.713204    0.293699    0.322785    0.240082    0.239856    0.474811    0.494962    0.733376    0.749150    1200        8.158062    0.894152    0.282056    168.420742 
[37m[36mINFO[0m[0m 02/21 06:56:03 | 0.278458    0.281753    0.722541    0.711735    0.755969    0.210915    0.238397    0.186802    0.187468    0.437657    0.419395    0.722541    0.711735    1400        9.517740    0.818776    0.274942    166.174765 
[37m[36mINFO[0m[0m 02/21 06:59:49 | 0.430575    0.440031    0.750372    0.761905    0.695888    0.447403    0.464135    0.373604    0.383667    0.470718    0.472292    0.750372    0.761905    1600        10.877417   0.759003    0.273563    170.748067 
[37m[36mINFO[0m[0m 02/21 07:03:25 | 0.369502    0.374835    0.767155    0.766156    0.645173    0.335091    0.350211    0.287585    0.302003    0.485831    0.472292    0.767155    0.766156    1800        12.237094   0.717422    0.273060    162.217612 
[37m[36mINFO[0m[0m 02/21 07:07:16 | 0.267238    0.280733    0.745485    0.760204    0.676738    0.116267    0.124473    0.251252    0.268105    0.434194    0.449622    0.745485    0.760204    2000        13.596771   0.681969    0.279053    174.984729 
[37m[36mINFO[0m[0m 02/21 07:11:00 | 0.350155    0.370925    0.762269    0.733844    0.698963    0.143949    0.155063    0.432020    0.448896    0.474496    0.508816    0.762269    0.733844    2200        14.956448   0.608704    0.268979    170.138326 
[37m[36mINFO[0m[0m 02/21 07:14:45 | 0.293303    0.305748    0.799873    0.779762    0.647399    0.116267    0.125527    0.270253    0.277863    0.493388    0.513854    0.799873    0.779762    2400        16.316125   0.592775    0.281033    168.489670 
[37m[36mINFO[0m[0m 02/21 07:18:37 | 0.421323    0.427002    0.792224    0.775510    0.663048    0.446876    0.458861    0.319296    0.341037    0.497796    0.481108    0.792224    0.775510    2600        17.675802   0.555215    0.269024    178.728995 
[37m[36mINFO[0m[0m 02/21 07:22:33 | 0.397291    0.413474    0.820693    0.818027    0.558489    0.348800    0.379747    0.317884    0.340524    0.525189    0.520151    0.820693    0.818027    2800        19.035479   0.566416    0.258161    183.518076 
[37m[36mINFO[0m[0m 02/21 07:26:11 | 0.342920    0.357533    0.830040    0.811224    0.543879    0.279989    0.287975    0.253178    0.275809    0.495592    0.508816    0.830040    0.811224    3000        20.395156   0.535121    0.290482    160.009490 
[37m[36mINFO[0m[0m 02/21 07:30:06 | 0.307971    0.313795    0.832802    0.801871    0.582152    0.264962    0.282700    0.169341    0.183873    0.489610    0.474811    0.832802    0.801871    3200        21.754833   0.549332    0.264147    182.315988 
[37m[36mINFO[0m[0m 02/21 07:33:57 | 0.295363    0.293650    0.834289    0.812925    0.563415    0.176905    0.184599    0.244447    0.256805    0.464736    0.439547    0.834289    0.812925    3400        23.114510   0.483089    0.260101    179.407631 
[37m[36mINFO[0m[0m 02/21 07:37:50 | 0.348554    0.370793    0.835564    0.829082    0.517865    0.205378    0.231013    0.343433    0.368772    0.496851    0.512594    0.835564    0.829082    3600        24.474187   0.454290    0.258914    181.207048 
[37m[36mINFO[0m[0m 02/21 07:41:43 | 0.320677    0.337805    0.837051    0.801871    0.563410    0.293963    0.301688    0.168699    0.191577    0.499370    0.520151    0.837051    0.801871    3800        25.833864   0.452798    0.292888    174.586030 
[37m[36mINFO[0m[0m 02/21 07:45:38 | 0.433517    0.445516    0.838326    0.814626    0.558210    0.440812    0.474684    0.333291    0.363123    0.526448    0.498741    0.838326    0.814626    4000        27.193542   0.431932    0.299503    175.173336 
[37m[36mINFO[0m[0m 02/21 07:49:34 | 0.263886    0.263289    0.832377    0.828231    0.546702    0.082784    0.083333    0.224933    0.222907    0.483942    0.483627    0.832377    0.828231    4200        28.553219   0.437672    0.308507    173.698663 
[37m[36mINFO[0m[0m 02/21 07:53:33 | 0.378212    0.392649    0.864670    0.853741    0.473278    0.304508    0.330169    0.342406    0.364150    0.487720    0.483627    0.864670    0.853741    4400        29.912896   0.425925    0.291487    181.297517 
[37m[36mINFO[0m[0m 02/21 07:57:30 | 0.357425    0.376468    0.858296    0.840986    0.462947    0.218033    0.247890    0.355501    0.376477    0.498741    0.505038    0.858296    0.840986    4600        31.272573   0.399922    0.283280    179.972291 
[37m[36mINFO[0m[0m 02/21 08:01:36 | 0.400427    0.416222    0.862545    0.844388    0.483224    0.293963    0.312236    0.374888    0.389831    0.532431    0.546599    0.862545    0.844388    4800        32.632250   0.387101    0.268110    191.876168 
[37m[36mINFO[0m[0m 02/21 08:05:44 | 0.334891    0.348755    0.863820    0.835034    0.496529    0.168732    0.183544    0.363333    0.381613    0.472607    0.481108    0.863820    0.835034    5000        33.991927   0.392270    0.265109    195.298200 
[37m[36mINFO[0m[0m 02/21 08:05:44 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[0, 1, 2]/250221_06-27-14_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/21 08:05:47 | ---
[37m[36mINFO[0m[0m 02/21 08:05:47 | test-domain validation(oracle) = 43.352%
[37m[36mINFO[0m[0m 02/21 08:05:47 | training-domain validation(iid) = 37.821%
[37m[36mINFO[0m[0m 02/21 08:05:47 | last = 33.489%
[37m[36mINFO[0m[0m 02/21 08:05:47 | last (inD) = 83.503%
[37m[36mINFO[0m[0m 02/21 08:05:47 | training-domain validation (iid, inD) = 85.374%
[37m[36mINFO[0m[0m 02/21 08:05:47 | === Summary ===
[37m[36mINFO[0m[0m 02/21 08:05:47 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 0 --hparams_seed 20
[37m[36mINFO[0m[0m 02/21 08:05:47 | Unique name: 250221_06-27-14_resnet50_GENIE
[37m[36mINFO[0m[0m 02/21 08:05:47 | Out path: train_output/TerraIncognita/RSC/[0, 1, 2]/250221_06-27-14_resnet50_GENIE
[37m[36mINFO[0m[0m 02/21 08:05:47 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/21 08:05:47 | Dataset: TerraIncognita

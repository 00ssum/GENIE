[37m[36mINFO[0m[0m 02/25 11:53:00 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 1 --hparams_seed 11
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 11
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[0, 1, 2]/250225_11-53-00_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[0, 1, 2]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 2]
	trial_seed: 1
	unique_name: 250225_11-53-00_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5.340583028754034e-05
	batch_size: 10
	weight_decay: 2.5000172438864113e-05
	rsc_f_drop_factor: 0.19287321200430957
	rsc_b_drop_factor: 0.49008261935429626
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/25 11:53:00 | n_steps = 5001
[37m[36mINFO[0m[0m 02/25 11:53:00 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/25 11:53:00 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/25 11:53:00 | 
[37m[36mINFO[0m[0m 02/25 11:53:00 | Testenv name escaping te_L100_L38_L43 -> te_L100_L38_L43
[37m[36mINFO[0m[0m 02/25 11:53:00 | Test envs = [0, 1, 2], name = te_L100_L38_L43
[37m[36mINFO[0m[0m 02/25 11:53:00 | Train environments: [3], Test environments: [0, 1, 2]
[37m[36mINFO[0m[0m 02/25 11:53:00 | Batch sizes for each domain: [0, 0, 0, 10] (total=10)
[37m[36mINFO[0m[0m 02/25 11:53:00 | steps-per-epoch for each domain: 470.70 -> min = 470.70
[37m[36mINFO[0m[0m 02/25 11:53:01 | # of params = 23528522
[37m[36mINFO[0m[0m 02/25 11:55:40 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/25 11:55:40 | 0.221641    0.231205    0.250266    0.227891    2.198794    0.509359    0.542194    0.054179    0.054443    0.101385    0.096977    0.250266    0.227891    0           0.000000    3.875504    0.960856    158.532312 
[37m[36mINFO[0m[0m 02/25 11:58:50 | 0.254534    0.266885    0.329934    0.320578    1.670180    0.506459    0.527426    0.021312    0.022599    0.235831    0.250630    0.329934    0.320578    200         0.424899    1.981967    0.120434    165.436813 
[37m[36mINFO[0m[0m 02/25 12:01:49 | 0.255165    0.267632    0.322923    0.313776    1.719760    0.509623    0.532700    0.020670    0.022085    0.235202    0.248111    0.322923    0.313776    400         0.849798    1.828512    0.115605    155.941860 
[37m[36mINFO[0m[0m 02/25 12:04:55 | 0.257143    0.275415    0.338857    0.331633    1.625453    0.514369    0.542194    0.020285    0.022085    0.236776    0.261965    0.338857    0.331633    600         1.274697    1.810432    0.124337    161.623379 
[37m[36mINFO[0m[0m 02/25 12:07:56 | 0.253617    0.267349    0.361164    0.334184    1.589955    0.504350    0.530591    0.020670    0.022085    0.235831    0.249370    0.361164    0.334184    800         1.699596    1.721221    0.119133    157.129480 
[37m[36mINFO[0m[0m 02/25 12:11:01 | 0.252461    0.259178    0.340769    0.329082    1.620992    0.514105    0.540084    0.020670    0.022085    0.222607    0.215365    0.340769    0.329082    1000        2.124495    1.756247    0.123924    160.234569 
[37m[36mINFO[0m[0m 02/25 12:14:12 | 0.260248    0.272362    0.343106    0.333333    1.546809    0.512787    0.537975    0.027089    0.027221    0.240869    0.251889    0.343106    0.333333    1200        2.549395    1.668957    0.160073    158.914795 
[37m[36mINFO[0m[0m 02/25 12:17:17 | 0.187098    0.182250    0.409178    0.373299    1.556280    0.205378    0.179325    0.089228    0.087827    0.266688    0.279597    0.409178    0.373299    1400        2.974294    1.623209    0.121557    160.109318 
[37m[36mINFO[0m[0m 02/25 12:20:24 | 0.261308    0.258618    0.400042    0.446429    1.554396    0.218561    0.195148    0.301194    0.294813    0.264169    0.285894    0.400042    0.446429    1600        3.399193    1.560261    0.133671    159.978901 
[37m[36mINFO[0m[0m 02/25 12:23:35 | 0.315636    0.321269    0.435309    0.462585    1.472369    0.196942    0.171941    0.438567    0.430406    0.311398    0.361461    0.435309    0.462585    1800        3.824092    1.539234    0.125805    166.605539 
[37m[36mINFO[0m[0m 02/25 12:26:37 | 0.325175    0.328935    0.420863    0.447279    1.511304    0.205642    0.178270    0.452818    0.445814    0.317065    0.362720    0.420863    0.447279    2000        4.248991    1.650838    0.131414    155.764106 
[37m[36mINFO[0m[0m 02/25 12:29:54 | 0.269267    0.274506    0.431697    0.462585    1.495240    0.164250    0.147679    0.326486    0.316898    0.317065    0.358942    0.431697    0.462585    2200        4.673890    1.537650    0.129092    170.453330 
[37m[36mINFO[0m[0m 02/25 12:32:55 | 0.321806    0.323037    0.444232    0.461735    1.482022    0.205642    0.178270    0.441135    0.429379    0.318640    0.361461    0.444232    0.461735    2400        5.098789    1.518329    0.121532    157.341480 
[37m[36mINFO[0m[0m 02/25 12:36:05 | 0.321896    0.324760    0.445294    0.466837    1.443595    0.208015    0.181435    0.439979    0.428865    0.317695    0.363980    0.445294    0.466837    2600        5.523688    1.515743    0.120411    165.911190 
[37m[36mINFO[0m[0m 02/25 12:39:20 | 0.331529    0.328779    0.458466    0.491497    1.466721    0.229634    0.213080    0.441905    0.431947    0.323048    0.341310    0.458466    0.491497    2800        5.948587    1.491479    0.134763    168.026101 
[37m[36mINFO[0m[0m 02/25 12:42:39 | 0.342302    0.343460    0.462290    0.491497    1.426983    0.224624    0.201477    0.441135    0.430919    0.361146    0.397985    0.462290    0.491497    3000        6.373486    1.501378    0.146840    169.026330 
[37m[36mINFO[0m[0m 02/25 12:45:49 | 0.334031    0.331619    0.457616    0.482143    1.443655    0.223042    0.200422    0.441520    0.432974    0.337531    0.361461    0.457616    0.482143    3200        6.798385    1.477931    0.118937    166.166649 
[37m[36mINFO[0m[0m 02/25 12:48:54 | 0.321540    0.324913    0.452305    0.465986    1.434720    0.206433    0.179325    0.440493    0.431433    0.317695    0.363980    0.452305    0.465986    3400        7.223284    1.472836    0.126232    160.151107 
[37m[36mINFO[0m[0m 02/25 12:52:07 | 0.339938    0.344120    0.465902    0.486395    1.435010    0.221988    0.200422    0.442034    0.431433    0.355793    0.400504    0.465902    0.486395    3600        7.648184    1.505149    0.155939    161.703545 
[37m[36mINFO[0m[0m 02/25 12:55:08 | 0.324300    0.327971    0.447419    0.460034    1.429111    0.205906    0.180380    0.443317    0.434515    0.323678    0.369018    0.447419    0.460034    3800        8.073083    1.482167    0.131213    155.048693 
[37m[36mINFO[0m[0m 02/25 12:58:18 | 0.331262    0.328877    0.461440    0.476190    1.430286    0.230688    0.213080    0.453588    0.447355    0.309509    0.326196    0.461440    0.476190    4000        8.497982    1.482382    0.120667    165.391085 
[37m[36mINFO[0m[0m 02/25 13:01:20 | 0.333961    0.332200    0.472700    0.498299    1.394892    0.222779    0.202532    0.447554    0.440164    0.331549    0.353904    0.472700    0.498299    4200        8.922881    1.431060    0.132551    155.399157 
[37m[36mINFO[0m[0m 02/25 13:04:28 | 0.327086    0.322589    0.455067    0.456633    1.448766    0.232270    0.214135    0.453332    0.446328    0.295655    0.307305    0.455067    0.456633    4400        9.347780    1.441957    0.139761    160.906849 
[37m[36mINFO[0m[0m 02/25 13:07:32 | 0.327281    0.323645    0.470576    0.488946    1.418035    0.210124    0.183544    0.443317    0.433487    0.328401    0.353904    0.470576    0.488946    4600        9.772679    1.396001    0.131703    157.020577 
[37m[36mINFO[0m[0m 02/25 13:10:34 | 0.329379    0.326490    0.470788    0.484694    1.384570    0.229897    0.214135    0.446527    0.439137    0.311713    0.326196    0.470788    0.484694    4800        10.197578   1.454667    0.126133    157.058680 
[37m[36mINFO[0m[0m 02/25 13:13:42 | 0.341927    0.343010    0.454854    0.482993    1.437713    0.221461    0.199367    0.452305    0.444273    0.352015    0.385390    0.454854    0.482993    5000        10.622477   1.441211    0.135528    161.171947 
[37m[36mINFO[0m[0m 02/25 13:13:43 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[0, 1, 2]/250225_11-53-00_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/25 13:13:45 | ---
[37m[36mINFO[0m[0m 02/25 13:13:45 | test-domain validation(oracle) = 33.994%
[37m[36mINFO[0m[0m 02/25 13:13:45 | training-domain validation(iid) = 33.396%
[37m[36mINFO[0m[0m 02/25 13:13:45 | last = 34.193%
[37m[36mINFO[0m[0m 02/25 13:13:45 | last (inD) = 48.299%
[37m[36mINFO[0m[0m 02/25 13:13:45 | training-domain validation (iid, inD) = 49.830%
[37m[36mINFO[0m[0m 02/25 13:13:45 | === Summary ===
[37m[36mINFO[0m[0m 02/25 13:13:45 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 2 --dataset TerraIncognita --trial_seed 1 --hparams_seed 11
[37m[36mINFO[0m[0m 02/25 13:13:45 | Unique name: 250225_11-53-00_resnet50_GENIE
[37m[36mINFO[0m[0m 02/25 13:13:45 | Out path: train_output/TerraIncognita/RSC/[0, 1, 2]/250225_11-53-00_resnet50_GENIE
[37m[36mINFO[0m[0m 02/25 13:13:45 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/25 13:13:45 | Dataset: TerraIncognita

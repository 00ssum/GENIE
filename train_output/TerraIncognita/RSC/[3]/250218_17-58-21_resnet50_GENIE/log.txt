[37m[36mINFO[0m[0m 02/18 17:58:21 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 13
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 13
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[3]/250218_17-58-21_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250218_17-58-21_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.00010514591448387436
	batch_size: 9
	weight_decay: 2.4366015497066046e-05
	rsc_f_drop_factor: 0.01448541980108109
	rsc_b_drop_factor: 0.13409305572855784
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/18 17:58:21 | n_steps = 5001
[37m[36mINFO[0m[0m 02/18 17:58:21 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/18 17:58:21 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/18 17:58:21 | 
[37m[36mINFO[0m[0m 02/18 17:58:21 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 02/18 17:58:21 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 02/18 17:58:21 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/18 17:58:21 | Batch sizes for each domain: [9, 9, 9, 0] (total=27)
[37m[36mINFO[0m[0m 02/18 17:58:21 | steps-per-epoch for each domain: 421.44, 865.44, 352.89 -> min = 352.89
[37m[36mINFO[0m[0m 02/18 17:58:22 | # of params = 23528522
[37m[36mINFO[0m[0m 02/18 18:01:29 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/18 18:01:29 | 0.222860    0.207483    0.288403    0.273706    2.110132    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.222860    0.207483    0           0.000000    2.501514    1.110028    186.002201 
[37m[36mINFO[0m[0m 02/18 18:05:04 | 0.209688    0.196429    0.512299    0.502901    1.296317    0.595571    0.610759    0.610091    0.576785    0.331234    0.321159    0.209688    0.196429    200         0.566751    1.532056    0.211543    172.825825 
[37m[36mINFO[0m[0m 02/18 18:08:46 | 0.240705    0.231293    0.537187    0.537750    1.280694    0.633799    0.669831    0.588907    0.570621    0.388854    0.372796    0.240705    0.231293    400         1.133501    1.268708    0.213169    179.282821 
[37m[36mINFO[0m[0m 02/18 18:12:30 | 0.284257    0.279762    0.634101    0.636762    1.046897    0.749539    0.752110    0.628836    0.617874    0.523929    0.540302    0.284257    0.279762    600         1.700252    1.195901    0.212012    181.737668 
[37m[36mINFO[0m[0m 02/18 18:16:04 | 0.248778    0.244898    0.608291    0.591025    1.057026    0.743211    0.702532    0.651560    0.632255    0.430101    0.438287    0.248778    0.244898    800         2.267003    1.034098    0.195546    174.196464 
[37m[36mINFO[0m[0m 02/18 18:19:48 | 0.296155    0.286565    0.724973    0.717727    0.793864    0.808858    0.777426    0.745153    0.733436    0.620907    0.642317    0.296155    0.286565    1000        2.833753    0.905299    0.245443    174.725393 
[37m[36mINFO[0m[0m 02/18 18:23:30 | 0.312938    0.288265    0.724456    0.729339    0.760741    0.799367    0.801688    0.728848    0.720082    0.645151    0.666247    0.312938    0.288265    1200        3.400504    0.792201    0.216837    178.804928 
[37m[36mINFO[0m[0m 02/18 18:26:59 | 0.287232    0.273810    0.766913    0.761848    0.664046    0.844450    0.835443    0.777764    0.775039    0.678526    0.675063    0.287232    0.273810    1400        3.967254    0.712268    0.202767    169.060752 
[37m[36mINFO[0m[0m 02/18 18:30:35 | 0.351392    0.343537    0.743050    0.743319    0.721553    0.845769    0.828059    0.748620    0.757062    0.634761    0.644836    0.351392    0.343537    1600        4.534005    0.684825    0.214526    172.873507 
[37m[36mINFO[0m[0m 02/18 18:34:17 | 0.395581    0.395408    0.789286    0.785302    0.580392    0.868442    0.856540    0.780588    0.782743    0.718829    0.716625    0.395581    0.395408    1800        5.100756    0.671434    0.213414    178.847574 
[37m[36mINFO[0m[0m 02/18 18:37:49 | 0.378373    0.368197    0.786581    0.781409    0.594270    0.881624    0.856540    0.750160    0.764766    0.727960    0.722922    0.378373    0.368197    2000        5.667506    0.621011    0.231950    165.932695 
[37m[36mINFO[0m[0m 02/18 18:41:34 | 0.307414    0.305272    0.811485    0.802333    0.549424    0.878988    0.849156    0.800745    0.810991    0.754723    0.746851    0.307414    0.305272    2200        6.234257    0.603744    0.225920    179.796710 
[37m[36mINFO[0m[0m 02/18 18:45:22 | 0.276822    0.269558    0.783570    0.777756    0.599588    0.873187    0.854430    0.775067    0.776066    0.702456    0.702771    0.276822    0.269558    2400        6.801008    0.590155    0.199486    187.952560 
[37m[36mINFO[0m[0m 02/18 18:48:57 | 0.363714    0.354592    0.811427    0.807949    0.555686    0.885051    0.856540    0.800488    0.805342    0.748741    0.761965    0.363714    0.354592    2600        7.367758    0.560803    0.167415    181.785614 
[37m[36mINFO[0m[0m 02/18 18:52:42 | 0.280008    0.275510    0.818185    0.819066    0.513613    0.889006    0.866034    0.807677    0.827940    0.757872    0.763224    0.280008    0.275510    2800        7.934509    0.556199    0.170012    191.045913 
[37m[36mINFO[0m[0m 02/18 18:56:27 | 0.295730    0.282313    0.815158    0.816410    0.505310    0.884788    0.859705    0.820131    0.821263    0.740554    0.768262    0.295730    0.282313    3000        8.501259    0.559966    0.183612    187.944754 
[37m[36mINFO[0m[0m 02/18 19:00:07 | 0.289781    0.263605    0.832054    0.817519    0.531824    0.892961    0.860759    0.817306    0.808423    0.785894    0.783375    0.289781    0.263605    3200        9.068010    0.514278    0.184365    182.894344 
[37m[36mINFO[0m[0m 02/18 19:03:43 | 0.270023    0.258503    0.810108    0.806483    0.545693    0.890852    0.869198    0.807421    0.822291    0.732053    0.727960    0.270023    0.258503    3400        9.634761    0.486096    0.197165    176.680447 
[37m[36mINFO[0m[0m 02/18 19:07:28 | 0.322286    0.301020    0.830660    0.813473    0.497258    0.893752    0.861814    0.810759    0.816641    0.787469    0.761965    0.322286    0.301020    3600        10.201511   0.480887    0.200440    185.264686 
[37m[36mINFO[0m[0m 02/18 19:10:59 | 0.295942    0.294218    0.840819    0.837612    0.468163    0.902716    0.870253    0.836051    0.842835    0.783690    0.799748    0.295942    0.294218    3800        10.768262   0.485134    0.178743    175.349192 
[37m[36mINFO[0m[0m 02/18 19:14:38 | 0.336095    0.329082    0.835760    0.820011    0.502388    0.909570    0.881857    0.806779    0.807396    0.790932    0.770781    0.336095    0.329082    4000        11.335013   0.474387    0.178687    183.052641 
[37m[36mINFO[0m[0m 02/18 19:18:19 | 0.291906    0.278061    0.829730    0.820547    0.512357    0.896124    0.862869    0.817563    0.830508    0.775504    0.768262    0.291906    0.278061    4200        11.901763   0.462290    0.180510    185.119101 
[37m[36mINFO[0m[0m 02/18 19:21:59 | 0.377310    0.395408    0.856763    0.844667    0.450518    0.914316    0.897679    0.837335    0.831536    0.818640    0.804786    0.377310    0.395408    4400        12.468514   0.452057    0.195284    180.718087 
[37m[36mINFO[0m[0m 02/18 19:25:33 | 0.355003    0.350340    0.852377    0.839727    0.442277    0.915107    0.889241    0.848889    0.840267    0.793136    0.789673    0.355003    0.350340    4600        13.035264   0.453227    0.217176    170.978291 
[37m[36mINFO[0m[0m 02/18 19:29:15 | 0.365838    0.352041    0.861905    0.859471    0.420526    0.916161    0.896624    0.855951    0.864407    0.813602    0.817380    0.365838    0.352041    4800        13.602015   0.411152    0.229640    175.376333 
[37m[36mINFO[0m[0m 02/18 19:32:52 | 0.305502    0.292517    0.820469    0.812005    0.512816    0.878197    0.864979    0.799204    0.802773    0.784005    0.768262    0.305502    0.292517    5000        14.168766   0.453286    0.199081    177.179235 
[37m[36mINFO[0m[0m 02/18 19:32:52 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[3]/250218_17-58-21_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/18 19:32:53 | ---
[37m[36mINFO[0m[0m 02/18 19:32:53 | test-domain validation(oracle) = 39.558%
[37m[36mINFO[0m[0m 02/18 19:32:53 | training-domain validation(iid) = 36.584%
[37m[36mINFO[0m[0m 02/18 19:32:53 | last = 30.550%
[37m[36mINFO[0m[0m 02/18 19:32:53 | last (inD) = 81.200%
[37m[36mINFO[0m[0m 02/18 19:32:53 | training-domain validation (iid, inD) = 85.947%
[37m[36mINFO[0m[0m 02/18 19:32:53 | === Summary ===
[37m[36mINFO[0m[0m 02/18 19:32:53 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 13
[37m[36mINFO[0m[0m 02/18 19:32:53 | Unique name: 250218_17-58-21_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 19:32:53 | Out path: train_output/TerraIncognita/RSC/[3]/250218_17-58-21_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 19:32:53 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/18 19:32:53 | Dataset: TerraIncognita

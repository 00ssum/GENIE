[37m[36mINFO[0m[0m 02/18 16:04:19 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 12
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 12
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[3]/250218_16-04-19_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250218_16-04-19_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5.346798771850428e-05
	batch_size: 44
	weight_decay: 1.8352299015720086e-05
	rsc_f_drop_factor: 0.3799895564860098
	rsc_b_drop_factor: 0.03414045373033975
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/18 16:04:19 | n_steps = 5001
[37m[36mINFO[0m[0m 02/18 16:04:19 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/18 16:04:19 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/18 16:04:19 | 
[37m[36mINFO[0m[0m 02/18 16:04:19 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 02/18 16:04:19 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 02/18 16:04:19 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/18 16:04:19 | Batch sizes for each domain: [44, 44, 44, 0] (total=132)
[37m[36mINFO[0m[0m 02/18 16:04:19 | steps-per-epoch for each domain: 86.20, 177.02, 72.18 -> min = 72.18
[37m[36mINFO[0m[0m 02/18 16:04:21 | # of params = 23528522
[37m[36mINFO[0m[0m 02/18 16:07:12 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/18 16:07:12 | 0.222860    0.207483    0.288403    0.273706    2.063410    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.222860    0.207483    0           0.000000    2.580115    1.281677    169.984059 
[37m[36mINFO[0m[0m 02/18 16:11:36 | 0.184619    0.181122    0.553833    0.537388    1.187955    0.674400    0.659283    0.586596    0.564972    0.400504    0.387909    0.184619    0.181122    200         2.770781    1.423294    0.420577    179.463338 
[37m[36mINFO[0m[0m 02/18 16:16:00 | 0.247079    0.247449    0.674605    0.671286    0.938205    0.770630    0.744726    0.657466    0.650745    0.595718    0.618388    0.247079    0.247449    400         5.541562    1.142966    0.421816    180.477283 
[37m[36mINFO[0m[0m 02/18 16:20:27 | 0.280646    0.273810    0.741535    0.747926    0.710639    0.818350    0.813291    0.742842    0.750385    0.663413    0.680101    0.280646    0.273810    600         8.312343    0.923031    0.389476    188.952544 
[37m[36mINFO[0m[0m 02/18 16:24:44 | 0.297004    0.286565    0.781466    0.768538    0.632843    0.860269    0.844937    0.781358    0.761685    0.702771    0.698992    0.297004    0.286565    800         11.083123   0.750006    0.452212    166.575538 
[37m[36mINFO[0m[0m 02/18 16:29:16 | 0.306565    0.303571    0.812172    0.791230    0.567389    0.891642    0.861814    0.806522    0.791474    0.738350    0.720403    0.306565    0.303571    1000        13.853904   0.666392    0.443263    182.838857 
[37m[36mINFO[0m[0m 02/18 16:33:54 | 0.314850    0.306973    0.834441    0.821966    0.488540    0.896124    0.875527    0.815637    0.825886    0.791562    0.764484    0.314850    0.306973    1200        16.624685   0.605328    0.451686    187.540211 
[37m[36mINFO[0m[0m 02/18 16:38:21 | 0.370087    0.347789    0.829731    0.817353    0.500592    0.907461    0.885021    0.804339    0.817668    0.777393    0.749370    0.370087    0.347789    1400        19.395466   0.553692    0.399357    187.712604 
[37m[36mINFO[0m[0m 02/18 16:42:54 | 0.349055    0.327381    0.849566    0.827123    0.489687    0.906143    0.873418    0.827064    0.823318    0.815491    0.784635    0.349055    0.327381    1600        22.166247   0.521402    0.411284    190.285511 
[37m[36mINFO[0m[0m 02/18 16:47:20 | 0.359465    0.345238    0.871290    0.846427    0.437531    0.926443    0.892405    0.838875    0.843349    0.848552    0.803526    0.359465    0.345238    1800        24.937028   0.474467    0.415512    183.353991 
[37m[36mINFO[0m[0m 02/18 16:51:37 | 0.385383    0.375850    0.882651    0.859954    0.389441    0.936726    0.907173    0.865195    0.862866    0.846033    0.809824    0.385383    0.375850    2000        27.707809   0.457863    0.410805    174.417954 
[37m[36mINFO[0m[0m 02/18 16:55:59 | 0.368388    0.360544    0.887300    0.859947    0.410510    0.934880    0.896624    0.854538    0.846944    0.872481    0.836272    0.368388    0.360544    2200        30.478589   0.426276    0.426901    176.907659 
[37m[36mINFO[0m[0m 02/18 17:00:32 | 0.361802    0.352891    0.882864    0.867201    0.395922    0.930398    0.907173    0.870587    0.866975    0.847607    0.827456    0.361802    0.352891    2400        33.249370   0.406300    0.477389    177.457890 
[37m[36mINFO[0m[0m 02/18 17:05:02 | 0.370087    0.354592    0.887543    0.871483    0.403631    0.929080    0.900844    0.866735    0.868516    0.866814    0.845088    0.370087    0.354592    2600        36.020151   0.386094    0.456975    178.270295 
[37m[36mINFO[0m[0m 02/18 17:09:40 | 0.380072    0.362245    0.905032    0.877261    0.346980    0.943053    0.918776    0.880986    0.876733    0.891058    0.836272    0.380072    0.362245    2800        38.790932   0.391718    0.481221    181.676282 
[37m[36mINFO[0m[0m 02/18 17:13:58 | 0.362439    0.339286    0.908553    0.880723    0.349309    0.958608    0.916667    0.880087    0.871597    0.886965    0.853904    0.362439    0.339286    3000        41.561713   0.340243    0.365322    185.530681 
[37m[36mINFO[0m[0m 02/18 17:18:23 | 0.378373    0.380952    0.913980    0.888793    0.344360    0.958872    0.928270    0.884452    0.885465    0.898615    0.852645    0.378373    0.380952    3200        44.332494   0.329704    0.417644    181.587286 
[37m[36mINFO[0m[0m 02/18 17:22:42 | 0.340344    0.344388    0.905488    0.884330    0.343834    0.953335    0.928270    0.875851    0.883410    0.887280    0.841310    0.340344    0.344388    3400        47.103275   0.323555    0.379895    182.936929 
[37m[36mINFO[0m[0m 02/18 17:27:04 | 0.375611    0.375850    0.928510    0.906698    0.301296    0.965199    0.938819    0.903454    0.903441    0.916877    0.877834    0.375611    0.375850    3600        49.874055   0.314234    0.438817    173.592128 
[37m[36mINFO[0m[0m 02/18 17:31:24 | 0.393881    0.376701    0.903321    0.874866    0.372338    0.936462    0.917722    0.868276    0.859271    0.905227    0.847607    0.393881    0.376701    3800        52.644836   0.322676    0.392263    182.217398 
[37m[36mINFO[0m[0m 02/18 17:35:45 | 0.409815    0.390306    0.923334    0.891196    0.324011    0.965990    0.937764    0.886507    0.884438    0.917506    0.851385    0.409815    0.390306    4000        55.415617   0.300575    0.400934    180.361599 
[37m[36mINFO[0m[0m 02/18 17:40:16 | 0.370300    0.358844    0.937802    0.910882    0.303644    0.974163    0.949367    0.914495    0.902928    0.924748    0.880353    0.370300    0.358844    4200        58.186398   0.279255    0.451128    181.087320 
[37m[36mINFO[0m[0m 02/18 17:44:48 | 0.370937    0.354592    0.933502    0.909141    0.285896    0.970999    0.940928    0.902555    0.899846    0.926952    0.886650    0.370937    0.354592    4400        60.957179   0.277556    0.495384    173.067383 
[37m[36mINFO[0m[0m 02/18 17:49:26 | 0.410665    0.395408    0.938405    0.914033    0.274234    0.975218    0.945148    0.911157    0.906523    0.928841    0.890428    0.410665    0.395408    4600        63.727960   0.267150    0.472315    183.206849 
[37m[36mINFO[0m[0m 02/18 17:53:41 | 0.424687    0.402211    0.935136    0.906418    0.313770    0.969417    0.940928    0.915650    0.894196    0.920340    0.884131    0.424687    0.402211    4800        66.498741   0.255594    0.399493    175.376933 
[37m[36mINFO[0m[0m 02/18 17:58:15 | 0.401317    0.380952    0.940492    0.912232    0.286215    0.974427    0.945148    0.921042    0.913713    0.926008    0.877834    0.401317    0.380952    5000        69.269521   0.246555    0.449262    183.791349 
[37m[36mINFO[0m[0m 02/18 17:58:15 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[3]/250218_16-04-19_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/18 17:58:16 | ---
[37m[36mINFO[0m[0m 02/18 17:58:16 | test-domain validation(oracle) = 42.469%
[37m[36mINFO[0m[0m 02/18 17:58:16 | training-domain validation(iid) = 41.066%
[37m[36mINFO[0m[0m 02/18 17:58:16 | last = 40.132%
[37m[36mINFO[0m[0m 02/18 17:58:16 | last (inD) = 91.223%
[37m[36mINFO[0m[0m 02/18 17:58:16 | training-domain validation (iid, inD) = 91.403%
[37m[36mINFO[0m[0m 02/18 17:58:16 | === Summary ===
[37m[36mINFO[0m[0m 02/18 17:58:16 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 12
[37m[36mINFO[0m[0m 02/18 17:58:16 | Unique name: 250218_16-04-19_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 17:58:16 | Out path: train_output/TerraIncognita/RSC/[3]/250218_16-04-19_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 17:58:16 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/18 17:58:16 | Dataset: TerraIncognita

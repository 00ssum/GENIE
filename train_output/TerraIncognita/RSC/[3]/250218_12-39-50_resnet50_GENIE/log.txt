[37m[36mINFO[0m[0m 02/18 12:39:50 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 10
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 10
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[3]/250218_12-39-50_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [3]
	trial_seed: 2
	unique_name: 250218_12-39-50_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 7.494887873901297e-05
	batch_size: 23
	weight_decay: 0.000495139494108363
	rsc_f_drop_factor: 0.29193136203847314
	rsc_b_drop_factor: 0.14246376157034246
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/18 12:39:50 | n_steps = 5001
[37m[36mINFO[0m[0m 02/18 12:39:50 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/18 12:39:50 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/18 12:39:50 | 
[37m[36mINFO[0m[0m 02/18 12:39:50 | Testenv name escaping te_L46 -> te_L46
[37m[36mINFO[0m[0m 02/18 12:39:50 | Test envs = [3], name = te_L46
[37m[36mINFO[0m[0m 02/18 12:39:50 | Train environments: [0, 1, 2], Test environments: [3]
[37m[36mINFO[0m[0m 02/18 12:39:50 | Batch sizes for each domain: [23, 23, 23, 0] (total=69)
[37m[36mINFO[0m[0m 02/18 12:39:50 | steps-per-epoch for each domain: 164.91, 338.65, 138.09 -> min = 138.09
[37m[36mINFO[0m[0m 02/18 12:39:51 | # of params = 23528522
[37m[36mINFO[0m[0m 02/18 12:42:42 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/18 12:42:42 | 0.222860    0.207483    0.288403    0.273706    2.102510    0.203533    0.197257    0.464886    0.443760    0.196788    0.180101    0.222860    0.207483    0           0.000000    2.908897    0.968029    170.164918 
[37m[36mINFO[0m[0m 02/18 12:46:44 | 0.213299    0.207483    0.498249    0.508412    1.339716    0.581334    0.627637    0.562973    0.558808    0.350441    0.338791    0.213299    0.207483    200         1.448363    1.767118    0.271005    187.449803 
[37m[36mINFO[0m[0m 02/18 12:50:50 | 0.193117    0.198980    0.495458    0.502534    1.266319    0.639072    0.646624    0.546925    0.553672    0.300378    0.307305    0.193117    0.198980    400         2.896725    1.456111    0.288047    188.166661 
[37m[36mINFO[0m[0m 02/18 12:54:44 | 0.221585    0.209184    0.575517    0.564811    1.177087    0.681782    0.718354    0.602388    0.579353    0.442380    0.396725    0.221585    0.209184    600         4.345088    1.365949    0.245086    184.968229 
[37m[36mINFO[0m[0m 02/18 12:58:47 | 0.199065    0.193027    0.594760    0.582069    1.138338    0.694173    0.696203    0.598922    0.572676    0.491184    0.477330    0.199065    0.193027    800         5.793451    1.304175    0.324310    178.525324 
[37m[36mINFO[0m[0m 02/18 13:02:36 | 0.238793    0.240646    0.629376    0.649236    1.000585    0.700765    0.757384    0.640134    0.626091    0.547229    0.564232    0.238793    0.240646    1000        7.241814    1.211428    0.265279    176.287528 
[37m[36mINFO[0m[0m 02/18 13:06:46 | 0.240493    0.240646    0.688697    0.670150    0.907833    0.790403    0.790084    0.695083    0.629687    0.580605    0.590680    0.240493    0.240646    1200        8.690176    1.109207    0.319832    185.486604 
[37m[36mINFO[0m[0m 02/18 13:10:45 | 0.239006    0.229592    0.722339    0.722803    0.824062    0.818613    0.799578    0.717422    0.713919    0.630982    0.654912    0.239006    0.229592    1400        10.138539   1.030876    0.265799    186.041001 
[37m[36mINFO[0m[0m 02/18 13:14:49 | 0.286170    0.272109    0.736987    0.734650    0.771741    0.853678    0.848101    0.763769    0.746276    0.593514    0.609572    0.286170    0.272109    1600        11.586902   0.927408    0.270178    189.852963 
[37m[36mINFO[0m[0m 02/18 13:19:02 | 0.311451    0.290816    0.784077    0.782370    0.612754    0.878988    0.850211    0.775196    0.785311    0.698048    0.711587    0.311451    0.290816    1800        13.035264   0.845419    0.292929    194.114253 
[37m[36mINFO[0m[0m 02/18 13:23:06 | 0.353091    0.346088    0.790001    0.781238    0.614576    0.869496    0.855485    0.788291    0.793015    0.712217    0.695214    0.353091    0.346088    2000        14.483627   0.827434    0.241538    196.305883 
[37m[36mINFO[0m[0m 02/18 13:27:28 | 0.375398    0.364796    0.807456    0.800104    0.637059    0.881888    0.866034    0.797407    0.803801    0.743073    0.730479    0.375398    0.364796    2200        15.931990   0.778282    0.287875    204.060379 
[37m[36mINFO[0m[0m 02/18 13:31:36 | 0.323773    0.322279    0.791851    0.782092    0.637481    0.882679    0.869198    0.794197    0.789420    0.698678    0.687657    0.323773    0.322279    2400        17.380353   0.773589    0.270240    194.149173 
[37m[36mINFO[0m[0m 02/18 13:35:41 | 0.355641    0.345238    0.807179    0.803719    0.594237    0.892961    0.873418    0.800616    0.813559    0.727960    0.724181    0.355641    0.345238    2600        18.828715   0.715649    0.244403    196.408683 
[37m[36mINFO[0m[0m 02/18 13:39:43 | 0.369875    0.357143    0.824370    0.819787    0.496991    0.900079    0.874473    0.800359    0.802773    0.772670    0.782116    0.369875    0.357143    2800        20.277078   0.719282    0.240058    193.998384 
[37m[36mINFO[0m[0m 02/18 13:44:03 | 0.362864    0.354592    0.828314    0.820799    0.489749    0.896915    0.883966    0.800873    0.781202    0.787154    0.797229    0.362864    0.354592    3000        21.725441   0.664648    0.282006    203.222692 
[37m[36mINFO[0m[0m 02/18 13:48:06 | 0.329084    0.314626    0.832309    0.827009    0.520489    0.900870    0.885021    0.822442    0.817668    0.773615    0.778338    0.329084    0.314626    3200        23.173804   0.658891    0.243357    194.172878 
[37m[36mINFO[0m[0m 02/18 13:52:18 | 0.332059    0.332483    0.835756    0.830601    0.501908    0.896915    0.877637    0.822570    0.832049    0.787783    0.782116    0.332059    0.332483    3400        24.622166   0.634012    0.255698    200.550123 
[37m[36mINFO[0m[0m 02/18 13:56:32 | 0.313363    0.297619    0.827874    0.814384    0.545629    0.893488    0.875527    0.795738    0.795583    0.794395    0.772040    0.313363    0.297619    3600        26.070529   0.633424    0.279902    198.867711 
[37m[36mINFO[0m[0m 02/18 14:00:34 | 0.290631    0.272109    0.834391    0.822048    0.552926    0.891906    0.876582    0.814354    0.809964    0.796914    0.779597    0.290631    0.272109    3800        27.518892   0.633993    0.244904    192.454665 
[37m[36mINFO[0m[0m 02/18 14:04:58 | 0.380285    0.363095    0.850393    0.838740    0.455018    0.905088    0.889241    0.830915    0.817155    0.815176    0.809824    0.380285    0.363095    4000        28.967254   0.595069    0.290522    205.727530 
[37m[36mINFO[0m[0m 02/18 14:09:03 | 0.359252    0.356293    0.840369    0.827607    0.474377    0.897970    0.871308    0.825908    0.838213    0.797229    0.773300    0.359252    0.356293    4200        30.415617   0.603259    0.277409    190.018533 
[37m[36mINFO[0m[0m 02/18 14:13:10 | 0.315063    0.304422    0.846883    0.825003    0.496817    0.899815    0.863924    0.819361    0.828968    0.821474    0.782116    0.315063    0.304422    4400        31.863980   0.584679    0.305941    185.600209 
[37m[36mINFO[0m[0m 02/18 14:17:26 | 0.387083    0.377551    0.844864    0.831284    0.500483    0.902452    0.872363    0.839004    0.833077    0.793136    0.788413    0.387083    0.377551    4600        33.312343   0.575452    0.340948    187.931823 
[37m[36mINFO[0m[0m 02/18 14:21:21 | 0.377310    0.363095    0.864208    0.854462    0.460319    0.910361    0.890295    0.842213    0.844376    0.840050    0.828715    0.377310    0.363095    4800        34.760705   0.543510    0.239048    187.055579 
[37m[36mINFO[0m[0m 02/18 14:25:37 | 0.376036    0.367347    0.863000    0.859252    0.460350    0.919852    0.901899    0.844524    0.857216    0.824622    0.818640    0.376036    0.367347    5000        36.209068   0.524153    0.301482    195.505676 
[37m[36mINFO[0m[0m 02/18 14:25:37 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[3]/250218_12-39-50_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/18 14:25:40 | ---
[37m[36mINFO[0m[0m 02/18 14:25:40 | test-domain validation(oracle) = 38.708%
[37m[36mINFO[0m[0m 02/18 14:25:40 | training-domain validation(iid) = 37.604%
[37m[36mINFO[0m[0m 02/18 14:25:40 | last = 37.604%
[37m[36mINFO[0m[0m 02/18 14:25:40 | last (inD) = 85.925%
[37m[36mINFO[0m[0m 02/18 14:25:40 | training-domain validation (iid, inD) = 85.925%
[37m[36mINFO[0m[0m 02/18 14:25:41 | === Summary ===
[37m[36mINFO[0m[0m 02/18 14:25:41 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 10
[37m[36mINFO[0m[0m 02/18 14:25:41 | Unique name: 250218_12-39-50_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 14:25:41 | Out path: train_output/TerraIncognita/RSC/[3]/250218_12-39-50_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 14:25:41 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/18 14:25:41 | Dataset: TerraIncognita

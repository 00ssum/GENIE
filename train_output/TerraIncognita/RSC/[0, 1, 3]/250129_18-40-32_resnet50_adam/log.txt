[37m[36mINFO[0m[0m 01/29 18:40:32 | Command :: /jsm0707/Large-scale/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm RSC --test_envs 0 1 3 --dataset TerraIncognita
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_adam.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_adam
	out_dir: train_output/TerraIncognita/RSC/[0, 1, 3]/250129_18-40-32_resnet50_adam
	out_root: train_output/TerraIncognita/RSC/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 0
	unique_name: 250129_18-40-32_resnet50_adam
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: adam
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	rsc_f_drop_factor: 0.3333333333333333
	rsc_b_drop_factor: 0.3333333333333333
	swad: False
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	ld: 0.1
	lr_mult: 10.0
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/29 18:40:32 | n_steps = 5001
[37m[36mINFO[0m[0m 01/29 18:40:32 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/29 18:40:32 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/29 18:40:32 | 
[37m[36mINFO[0m[0m 01/29 18:40:32 | Testenv name escaping te_L100_L38_L46 -> te_L100_L38_L46
[37m[36mINFO[0m[0m 01/29 18:40:32 | Test envs = [0, 1, 3], name = te_L100_L38_L46
[37m[36mINFO[0m[0m 01/29 18:40:32 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 01/29 18:40:32 | Batch sizes for each domain: [0, 0, 32, 0] (total=32)
[37m[36mINFO[0m[0m 01/29 18:40:32 | steps-per-epoch for each domain: 99.25 -> min = 99.25
[37m[36mINFO[0m[0m 01/29 18:40:33 | # of params = 23528522
[37m[36mINFO[0m[0m 01/29 18:43:38 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/29 18:43:38 | 0.065775    0.063407    0.146096    0.141058    2.248015    0.080148    0.065401    0.064065    0.075501    0.146096    0.141058    0.053112    0.049320    0           0.000000    3.591527    1.094754    183.923993 
[37m[36mINFO[0m[0m 01/29 18:47:39 | 0.215725    0.222188    0.367758    0.372796    1.524959    0.008700    0.017932    0.372063    0.408834    0.367758    0.372796    0.266412    0.239796    200         2.015113    1.830131    0.292219    182.152870 
[37m[36mINFO[0m[0m 01/29 18:51:46 | 0.200260    0.209879    0.505353    0.523929    1.307500    0.029264    0.044304    0.378611    0.404212    0.505353    0.523929    0.192904    0.181122    400         4.030227    1.499182    0.397287    166.545765 
[37m[36mINFO[0m[0m 01/29 18:55:49 | 0.327406    0.339332    0.551322    0.539043    1.263308    0.214606    0.228903    0.456798    0.483821    0.551322    0.539043    0.310814    0.305272    600         6.045340    1.168507    0.295617    182.901354 
[37m[36mINFO[0m[0m 01/29 18:59:52 | 0.279052    0.285048    0.655227    0.656171    0.949222    0.077511    0.074895    0.406342    0.432460    0.655227    0.656171    0.353304    0.347789    800         8.060453    1.012898    0.314881    179.913600 
[37m[36mINFO[0m[0m 01/29 19:03:59 | 0.373771    0.388977    0.730164    0.704030    0.806399    0.493804    0.525316    0.252536    0.274268    0.730164    0.704030    0.374973    0.367347    1000        10.075567   0.865184    0.361791    173.930540 
[37m[36mINFO[0m[0m 01/29 19:08:27 | 0.327503    0.343052    0.728904    0.724181    0.758982    0.300817    0.314346    0.336885    0.361068    0.728904    0.724181    0.344806    0.353741    1200        12.090680   0.723749    0.369939    194.285594 
[37m[36mINFO[0m[0m 01/29 19:12:47 | 0.326633    0.345697    0.794081    0.777078    0.567751    0.267071    0.298523    0.335730    0.353364    0.794081    0.777078    0.377098    0.385204    1400        14.105793   0.620472    0.323831    194.838110 
[37m[36mINFO[0m[0m 01/29 19:16:53 | 0.328080    0.341080    0.718199    0.715365    0.772071    0.458212    0.477848    0.155091    0.177196    0.718199    0.715365    0.370937    0.368197    1600        16.120907   0.626194    0.295843    186.173192 
[37m[36mINFO[0m[0m 01/29 19:21:01 | 0.400484    0.418443    0.826511    0.807305    0.546792    0.390456    0.415612    0.343818    0.372881    0.826511    0.807305    0.467177    0.466837    1800        18.136020   0.544276    0.341558    179.389878 
[37m[36mINFO[0m[0m 01/29 19:25:19 | 0.379021    0.385304    0.824937    0.812343    0.534036    0.399420    0.414557    0.312107    0.337442    0.824937    0.812343    0.425536    0.403912    2000        20.151134   0.462768    0.348827    188.096603 
[37m[36mINFO[0m[0m 01/29 19:29:23 | 0.413958    0.424617    0.858627    0.856423    0.400682    0.412866    0.405063    0.414944    0.447869    0.858627    0.856423    0.414064    0.420918    2200        22.166247   0.437110    0.331170    177.797813 
[37m[36mINFO[0m[0m 01/29 19:33:28 | 0.394600    0.392517    0.832494    0.827456    0.438573    0.470604    0.459916    0.304018    0.325629    0.832494    0.827456    0.409178    0.392007    2400        24.181360   0.409203    0.284872    188.202914 
[37m[36mINFO[0m[0m 01/29 19:38:48 | 0.398101    0.408719    0.863980    0.848866    0.416083    0.352755    0.361814    0.415586    0.444273    0.863980    0.848866    0.425961    0.420068    2600        26.196474   0.374812    0.316424    256.391325 
[37m[36mINFO[0m[0m 01/29 19:43:00 | 0.432305    0.442145    0.874055    0.863980    0.426573    0.480095    0.502110    0.415714    0.436569    0.874055    0.863980    0.401105    0.387755    2800        28.211587   0.335225    0.353293    181.639166 
[37m[36mINFO[0m[0m 01/29 19:47:10 | 0.371471    0.383112    0.892947    0.858942    0.381008    0.406538    0.399789    0.338426    0.367745    0.892947    0.858942    0.369450    0.381803    3000        30.226700   0.322860    0.306086    188.514859 
[37m[36mINFO[0m[0m 01/29 19:51:18 | 0.411239    0.414231    0.893892    0.882872    0.332565    0.470604    0.460970    0.398126    0.423729    0.893892    0.882872    0.364988    0.357993    3200        32.241814   0.310376    0.297076    188.616767 
[37m[36mINFO[0m[0m 01/29 19:55:42 | 0.370450    0.377717    0.906486    0.881612    0.318096    0.368574    0.361814    0.346771    0.370827    0.906486    0.881612    0.396006    0.400510    3400        34.256927   0.280151    0.345342    195.134359 
[37m[36mINFO[0m[0m 01/29 19:59:55 | 0.340209    0.352031    0.909635    0.885390    0.344220    0.252571    0.267932    0.370137    0.394453    0.909635    0.885390    0.397918    0.393707    3600        36.272040   0.270882    0.321423    188.122852 
[37m[36mINFO[0m[0m 01/29 20:04:08 | 0.217097    0.233080    0.902393    0.870277    0.344937    0.132613    0.141350    0.196816    0.215203    0.902393    0.870277    0.321861    0.342687    3800        38.287154   0.284735    0.332399    186.243424 
[37m[36mINFO[0m[0m 01/29 20:08:08 | 0.307833    0.314864    0.926637    0.877834    0.319159    0.303717    0.310127    0.235460    0.247560    0.926637    0.877834    0.384321    0.386905    4000        40.302267   0.235236    0.329726    174.595075 
[37m[36mINFO[0m[0m 01/29 20:12:32 | 0.361946    0.373688    0.921914    0.890428    0.345775    0.274717    0.287975    0.427012    0.450437    0.921914    0.890428    0.384109    0.382653    4200        42.317380   0.244860    0.351134    193.506656 
[37m[36mINFO[0m[0m 01/29 20:16:40 | 0.250255    0.250280    0.912783    0.867758    0.391795    0.123912    0.124473    0.243805    0.257319    0.912783    0.867758    0.383047    0.369048    4400        44.332494   0.206316    0.312649    185.137232 
[37m[36mINFO[0m[0m 01/29 20:20:35 | 0.400874    0.403166    0.934824    0.906801    0.290566    0.432639    0.420886    0.342534    0.360041    0.934824    0.906801    0.427448    0.428571    4600        46.347607   0.201215    0.315175    172.777991 
[37m[36mINFO[0m[0m 01/29 20:24:52 | 0.400413    0.404925    0.937972    0.905542    0.305363    0.408648    0.404008    0.367056    0.392399    0.937972    0.905542    0.425536    0.418367    4800        48.362720   0.194652    0.360977    184.356259 
[37m[36mINFO[0m[0m 01/29 20:28:49 | 0.398952    0.398966    0.940806    0.874055    0.327233    0.496177    0.481013    0.300424    0.317925    0.940806    0.874055    0.400255    0.397959    5000        50.377834   0.192915    0.344163    168.373414 
[37m[36mINFO[0m[0m 01/29 20:28:49 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[0, 1, 3]/250129_18-40-32_resnet50_adam/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/29 20:28:51 | ---
[37m[36mINFO[0m[0m 01/29 20:28:51 | test-domain validation(oracle) = 43.230%
[37m[36mINFO[0m[0m 01/29 20:28:51 | training-domain validation(iid) = 40.087%
[37m[36mINFO[0m[0m 01/29 20:28:51 | last = 39.895%
[37m[36mINFO[0m[0m 01/29 20:28:51 | last (inD) = 87.406%
[37m[36mINFO[0m[0m 01/29 20:28:51 | training-domain validation (iid, inD) = 90.680%
[37m[36mINFO[0m[0m 01/29 20:28:51 | === Summary ===
[37m[36mINFO[0m[0m 01/29 20:28:51 | Command: /jsm0707/Large-scale/train_all.py resnet50_adam config/resnet50_adam.yaml --algorithm RSC --test_envs 0 1 3 --dataset TerraIncognita
[37m[36mINFO[0m[0m 01/29 20:28:51 | Unique name: 250129_18-40-32_resnet50_adam
[37m[36mINFO[0m[0m 01/29 20:28:51 | Out path: train_output/TerraIncognita/RSC/[0, 1, 3]/250129_18-40-32_resnet50_adam
[37m[36mINFO[0m[0m 01/29 20:28:51 | Algorithm: RSC
[37m[36mINFO[0m[0m 01/29 20:28:51 | Dataset: TerraIncognita

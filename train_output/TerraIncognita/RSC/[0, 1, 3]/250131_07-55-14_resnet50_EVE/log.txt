[37m[36mINFO[0m[0m 01/31 07:55:14 | Command :: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm RSC --test_envs 0 1 3 --dataset TerraIncognita --trial_seed 0 --hparams_seed 0
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/TerraIncognita/RSC/[0, 1, 3]/250131_07-55-14_resnet50_EVE
	out_root: train_output/TerraIncognita/RSC/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 0
	unique_name: 250131_07-55-14_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: GENIE
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	rsc_f_drop_factor: 0.3333333333333333
	rsc_b_drop_factor: 0.3333333333333333
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/31 07:55:14 | n_steps = 5001
[37m[36mINFO[0m[0m 01/31 07:55:14 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/31 07:55:14 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/31 07:55:14 | 
[37m[36mINFO[0m[0m 01/31 07:55:14 | Testenv name escaping te_L100_L38_L46 -> te_L100_L38_L46
[37m[36mINFO[0m[0m 01/31 07:55:14 | Test envs = [0, 1, 3], name = te_L100_L38_L46
[37m[36mINFO[0m[0m 01/31 07:55:14 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 01/31 07:55:14 | Batch sizes for each domain: [0, 0, 32, 0] (total=32)
[37m[36mINFO[0m[0m 01/31 07:55:14 | steps-per-epoch for each domain: 99.25 -> min = 99.25
[37m[36mINFO[0m[0m 01/31 07:55:16 | # of params = 23528522
[37m[36mINFO[0m[0m 01/31 07:59:19 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/31 07:59:19 | 0.105547    0.105440    0.201511    0.151134    2.183974    0.176905    0.185654    0.010143    0.008218    0.201511    0.151134    0.129594    0.122449    0           0.000000    3.591527    1.247796    242.026402 
[37m[36mINFO[0m[0m 01/31 08:05:20 | 0.058009    0.059056    0.285264    0.235516    1.595107    0.009755    0.018987    0.000899    0.002568    0.285264    0.235516    0.163374    0.155612    200         2.015113    1.928580    0.426770    274.940400 
[37m[36mINFO[0m[0m 01/31 08:10:30 | 0.058009    0.059056    0.287469    0.235516    1.541986    0.009755    0.018987    0.000899    0.002568    0.287469    0.235516    0.163374    0.155612    400         4.030227    1.825161    0.371034    235.953464 
[37m[36mINFO[0m[0m 01/31 08:15:51 | 0.058009    0.059056    0.303841    0.244332    1.522346    0.009755    0.018987    0.000899    0.002568    0.303841    0.244332    0.163374    0.155612    600         6.045340    1.778976    0.415112    237.396845 
[37m[36mINFO[0m[0m 01/31 08:21:14 | 0.173539    0.184215    0.359572    0.350126    1.490460    0.012655    0.020042    0.344589    0.376990    0.359572    0.350126    0.163374    0.155612    800         8.060453    1.728034    0.467728    229.608505 
[37m[36mINFO[0m[0m 01/31 08:27:00 | 0.167894    0.175362    0.393262    0.370277    1.465552    0.009755    0.018987    0.330980    0.352337    0.393262    0.370277    0.162949    0.154762    1000        10.075567   1.708421    0.447786    254.952908 
[37m[36mINFO[0m[0m 01/31 08:32:17 | 0.184646    0.196730    0.443010    0.420655    1.390300    0.024519    0.040084    0.356272    0.374936    0.443010    0.420655    0.173146    0.175170    1200        12.090680   1.661722    0.449250    227.152213 
[37m[36mINFO[0m[0m 01/31 08:38:12 | 0.198189    0.207365    0.451826    0.439547    1.347969    0.032165    0.048523    0.381821    0.400103    0.451826    0.439547    0.180582    0.173469    1400        14.105793   1.640150    0.489462    255.648544 
[37m[36mINFO[0m[0m 01/31 08:43:39 | 0.244649    0.247640    0.471348    0.477330    1.337730    0.052465    0.056962    0.444601    0.472522    0.471348    0.477330    0.236881    0.213435    1600        16.120907   1.618853    0.403323    246.389369 
[37m[36mINFO[0m[0m 01/31 08:49:22 | 0.215646    0.214614    0.548174    0.532746    1.246792    0.080148    0.078059    0.365387    0.379558    0.548174    0.532746    0.201402    0.186224    1800        18.136020   1.538921    0.426728    257.383729 
[37m[36mINFO[0m[0m 01/31 08:54:18 | 0.256318    0.260132    0.546914    0.540302    1.400586    0.093066    0.090717    0.440493    0.469440    0.546914    0.540302    0.235394    0.220238    2000        20.151134   1.481632    0.382047    219.584756 
[37m[36mINFO[0m[0m 01/31 08:59:12 | 0.176036    0.179631    0.576511    0.561713    1.206703    0.053783    0.052743    0.293106    0.322034    0.576511    0.561713    0.181219    0.164116    2200        22.166247   1.498332    0.324946    228.387260 
[37m[36mINFO[0m[0m 01/31 09:04:19 | 0.161234    0.170428    0.628149    0.605793    1.084011    0.045610    0.050633    0.246887    0.272727    0.628149    0.605793    0.191205    0.187925    2400        24.181360   1.386703    0.443615    218.297018 
[37m[36mINFO[0m[0m 01/31 09:09:15 | 0.211577    0.221665    0.649244    0.646096    1.027547    0.063802    0.072785    0.373989    0.389831    0.649244    0.646096    0.196941    0.202381    2600        26.196474   1.322112    0.457591    204.261724 
[37m[36mINFO[0m[0m 01/31 09:14:27 | 0.274472    0.274592    0.650819    0.653652    0.934210    0.142895    0.141350    0.405187    0.427324    0.650819    0.653652    0.275335    0.255102    2800        28.211587   1.249256    0.455197    220.863680 
[37m[36mINFO[0m[0m 01/31 09:19:19 | 0.240097    0.255236    0.685768    0.691436    0.871675    0.121540    0.129747    0.390551    0.421674    0.685768    0.691436    0.208201    0.214286    3000        30.226700   1.247597    0.495216    192.378636 
[37m[36mINFO[0m[0m 01/31 09:24:00 | 0.323322    0.332194    0.676322    0.664987    0.880853    0.209597    0.219409    0.454230    0.481253    0.676322    0.664987    0.306140    0.295918    3200        32.241814   1.177209    0.433695    193.878038 
[37m[36mINFO[0m[0m 01/31 09:28:41 | 0.296479    0.296293    0.727330    0.726700    0.761149    0.181123    0.169831    0.393889    0.410375    0.727330    0.726700    0.314425    0.308673    3400        34.256927   1.107035    0.454834    189.882103 
[37m[36mINFO[0m[0m 01/31 09:33:31 | 0.206108    0.211562    0.679156    0.633501    0.836211    0.103876    0.103376    0.223392    0.233693    0.679156    0.633501    0.291056    0.297619    3600        36.272040   1.087817    0.424097    204.683029 
[37m[36mINFO[0m[0m 01/31 09:38:20 | 0.252190    0.261679    0.732368    0.732997    0.715027    0.110203    0.110759    0.406086    0.429379    0.732368    0.732997    0.240280    0.244898    3800        38.287154   1.043161    0.387406    211.240096 
[37m[36mINFO[0m[0m 01/31 09:43:20 | 0.223662    0.229246    0.735202    0.709068    0.774718    0.150277    0.149789    0.249198    0.259887    0.735202    0.709068    0.271511    0.278061    4000        40.302267   0.999044    0.511427    197.326357 
[37m[36mINFO[0m[0m 01/31 09:48:10 | 0.246391    0.254726    0.770781    0.765743    0.734881    0.116267    0.118143    0.357556    0.376477    0.770781    0.765743    0.265349    0.269558    4200        42.317380   0.990437    0.459748    198.064922 
[37m[36mINFO[0m[0m 01/31 09:53:02 | 0.329579    0.328476    0.792821    0.780856    0.595324    0.388874    0.389241    0.266530    0.296867    0.792821    0.780856    0.333333    0.299320    4400        44.332494   0.979236    0.429367    206.414052 
[37m[36mINFO[0m[0m 01/31 09:58:21 | 0.267625    0.278026    0.787154    0.760705    0.729290    0.136567    0.140295    0.396071    0.421674    0.787154    0.760705    0.270236    0.272109    4600        46.347607   0.939816    0.524328    213.733066 
[37m[36mINFO[0m[0m 01/31 10:04:07 | 0.286893    0.300602    0.797544    0.770781    0.632459    0.271026    0.285865    0.324304    0.352337    0.797544    0.770781    0.265349    0.263605    4800        48.362720   0.907878    0.567038    231.848666 
[37m[36mINFO[0m[0m 01/31 10:09:34 | 0.395631    0.410414    0.788413    0.782116    0.868013    0.449512    0.468354    0.400437    0.430406    0.788413    0.782116    0.336945    0.332483    5000        50.377834   0.943632    0.413161    244.546611 
[37m[36mINFO[0m[0m 01/31 10:09:34 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[0, 1, 3]/250131_07-55-14_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/31 10:09:37 | ---
[37m[36mINFO[0m[0m 01/31 10:09:37 | test-domain validation(oracle) = 39.563%
[37m[36mINFO[0m[0m 01/31 10:09:37 | training-domain validation(iid) = 39.563%
[37m[36mINFO[0m[0m 01/31 10:09:37 | last = 39.563%
[37m[36mINFO[0m[0m 01/31 10:09:37 | last (inD) = 78.212%
[37m[36mINFO[0m[0m 01/31 10:09:37 | training-domain validation (iid, inD) = 78.212%
[37m[36mINFO[0m[0m 01/31 10:09:37 | === Summary ===
[37m[36mINFO[0m[0m 01/31 10:09:37 | Command: /jsm0707/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm RSC --test_envs 0 1 3 --dataset TerraIncognita --trial_seed 0 --hparams_seed 0
[37m[36mINFO[0m[0m 01/31 10:09:37 | Unique name: 250131_07-55-14_resnet50_EVE
[37m[36mINFO[0m[0m 01/31 10:09:37 | Out path: train_output/TerraIncognita/RSC/[0, 1, 3]/250131_07-55-14_resnet50_EVE
[37m[36mINFO[0m[0m 01/31 10:09:37 | Algorithm: RSC
[37m[36mINFO[0m[0m 01/31 10:09:37 | Dataset: TerraIncognita

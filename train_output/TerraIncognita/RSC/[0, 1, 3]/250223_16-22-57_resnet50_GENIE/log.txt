[37m[36mINFO[0m[0m 02/23 16:22:57 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 2
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 2
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[0, 1, 3]/250223_16-22-57_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 1
	unique_name: 250223_16-22-57_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.0001126313085293539
	batch_size: 38
	weight_decay: 0.006639128805224463
	rsc_f_drop_factor: 0.1125843742743669
	rsc_b_drop_factor: 0.2152114809950767
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/23 16:22:57 | n_steps = 5001
[37m[36mINFO[0m[0m 02/23 16:22:57 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/23 16:22:57 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/23 16:22:57 | 
[37m[36mINFO[0m[0m 02/23 16:22:57 | Testenv name escaping te_L100_L38_L46 -> te_L100_L38_L46
[37m[36mINFO[0m[0m 02/23 16:22:57 | Test envs = [0, 1, 3], name = te_L100_L38_L46
[37m[36mINFO[0m[0m 02/23 16:22:57 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 02/23 16:22:57 | Batch sizes for each domain: [0, 0, 38, 0] (total=38)
[37m[36mINFO[0m[0m 02/23 16:22:57 | steps-per-epoch for each domain: 83.58 -> min = 83.58
[37m[36mINFO[0m[0m 02/23 16:22:58 | # of params = 23528522
[37m[36mINFO[0m[0m 02/23 16:25:46 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/23 16:25:46 | 0.057165    0.065310    0.108627    0.147355    2.182460    0.035328    0.039030    0.015920    0.014895    0.108627    0.147355    0.120246    0.142007    0           0.000000    2.977024    1.100784    167.112744 
[37m[36mINFO[0m[0m 02/23 16:29:45 | 0.311745    0.308056    0.348237    0.372796    1.508550    0.206697    0.180380    0.453203    0.447869    0.348237    0.372796    0.275335    0.295918    200         2.392947    1.724322    0.334316    171.619049 
[37m[36mINFO[0m[0m 02/23 16:33:36 | 0.183803    0.184658    0.382557    0.396725    1.428543    0.027419    0.040084    0.334061    0.325116    0.382557    0.396725    0.189930    0.188776    400         4.785894    1.582372    0.314271    168.509789 
[37m[36mINFO[0m[0m 02/23 16:37:27 | 0.318613    0.312890    0.474811    0.534005    1.267835    0.220406    0.197257    0.455001    0.448896    0.474811    0.534005    0.280433    0.292517    600         7.178841    1.461801    0.323231    166.451760 
[37m[36mINFO[0m[0m 02/23 16:41:20 | 0.321211    0.317402    0.527708    0.579345    1.195576    0.213815    0.199367    0.458339    0.453518    0.527708    0.579345    0.291481    0.299320    800         9.571788    1.433009    0.314484    170.171417 
[37m[36mINFO[0m[0m 02/23 16:45:13 | 0.173477    0.167750    0.590365    0.620907    1.100510    0.044028    0.047468    0.209141    0.204931    0.590365    0.620907    0.267262    0.250850    1000        11.964736   1.286413    0.326505    167.220826 
[37m[36mINFO[0m[0m 02/23 16:49:14 | 0.312770    0.309880    0.613980    0.634761    1.015135    0.207751    0.191983    0.450764    0.446841    0.613980    0.634761    0.279796    0.290816    1200        14.357683   1.168479    0.360724    169.546146 
[37m[36mINFO[0m[0m 02/23 16:53:17 | 0.287450    0.281081    0.658375    0.661209    0.944701    0.158977    0.141350    0.445885    0.439137    0.658375    0.661209    0.257489    0.262755    1400        16.750630   1.108862    0.347616    172.641526 
[37m[36mINFO[0m[0m 02/23 16:57:21 | 0.240236    0.247460    0.649244    0.672544    0.945276    0.060374    0.068565    0.440236    0.436569    0.649244    0.672544    0.220098    0.237245    1600        19.143577   1.037161    0.334916    177.351536 
[37m[36mINFO[0m[0m 02/23 17:01:25 | 0.227611    0.243781    0.706549    0.693955    0.845127    0.211178    0.231013    0.216716    0.229070    0.706549    0.693955    0.254939    0.271259    1800        21.536524   0.972407    0.324105    179.363965 
[37m[36mINFO[0m[0m 02/23 17:05:23 | 0.235929    0.237052    0.761335    0.767003    0.676656    0.156604    0.160338    0.232507    0.225989    0.761335    0.767003    0.318674    0.324830    2000        23.929471   0.839155    0.332644    171.408149 
[37m[36mINFO[0m[0m 02/23 17:09:24 | 0.303401    0.301269    0.706549    0.716625    0.787281    0.198787    0.177215    0.423546    0.419620    0.706549    0.716625    0.287869    0.306973    2200        26.322418   0.792504    0.376053    165.318481 
[37m[36mINFO[0m[0m 02/23 17:13:25 | 0.339561    0.341778    0.719773    0.729219    0.720290    0.240707    0.245781    0.456541    0.455573    0.719773    0.729219    0.321436    0.323980    2400        28.715365   0.719771    0.389249    163.286604 
[37m[36mINFO[0m[0m 02/23 17:17:24 | 0.282301    0.280875    0.788098    0.799748    0.585322    0.146586    0.146624    0.356785    0.345660    0.788098    0.799748    0.343531    0.350340    2600        31.108312   0.771810    0.385518    162.213382 
[37m[36mINFO[0m[0m 02/23 17:21:20 | 0.295723    0.299617    0.774244    0.789673    0.563822    0.147640    0.149789    0.397484    0.397021    0.774244    0.789673    0.342044    0.352041    2800        33.501259   0.645786    0.371767    161.878068 
[37m[36mINFO[0m[0m 02/23 17:25:22 | 0.215831    0.218392    0.765113    0.784635    0.629606    0.044556    0.049578    0.292335    0.279918    0.765113    0.784635    0.310601    0.325680    3000        35.894207   0.648158    0.371170    167.035872 
[37m[36mINFO[0m[0m 02/23 17:29:33 | 0.347510    0.348019    0.794395    0.795970    0.560223    0.340364    0.333333    0.342278    0.334874    0.794395    0.795970    0.359890    0.375850    3200        38.287154   0.613976    0.366051    177.932718 
[37m[36mINFO[0m[0m 02/23 17:33:24 | 0.200603    0.200677    0.747166    0.735516    0.697347    0.048510    0.050633    0.326614    0.313303    0.747166    0.735516    0.226684    0.238095    3400        40.680101   0.575894    0.380120    154.764086 
[37m[36mINFO[0m[0m 02/23 17:37:06 | 0.406014    0.405990    0.828401    0.819899    0.534424    0.450567    0.455696    0.419694    0.414484    0.828401    0.819899    0.347780    0.347789    3600        43.073048   0.590870    0.326541    157.601374 
[37m[36mINFO[0m[0m 02/23 17:40:48 | 0.308934    0.310759    0.838161    0.841310    0.455161    0.165041    0.175105    0.422904    0.414484    0.838161    0.841310    0.338857    0.342687    3800        45.465995   0.533577    0.317445    158.361440 
[37m[36mINFO[0m[0m 02/23 17:44:27 | 0.329764    0.331210    0.833438    0.827456    0.485555    0.181123    0.182489    0.448068    0.448896    0.833438    0.827456    0.360102    0.362245    4000        47.858942   0.547841    0.314716    156.193201 
[37m[36mINFO[0m[0m 02/23 17:48:08 | 0.290990    0.283042    0.818010    0.822418    0.510080    0.195624    0.195148    0.365259    0.343606    0.818010    0.822418    0.312088    0.310374    4200        50.251889   0.546656    0.320067    156.229545 
[37m[36mINFO[0m[0m 02/23 17:51:51 | 0.308361    0.306834    0.840365    0.833753    0.479179    0.179014    0.181435    0.415073    0.403184    0.840365    0.833753    0.330996    0.335884    4400        52.644836   0.537190    0.337729    155.569952 
[37m[36mINFO[0m[0m 02/23 17:55:38 | 0.358605    0.360660    0.815491    0.823678    0.522421    0.323754    0.331224    0.427012    0.421674    0.815491    0.823678    0.325048    0.329082    4600        55.037783   0.522350    0.360102    155.083914 
[37m[36mINFO[0m[0m 02/23 17:59:32 | 0.280039    0.272646    0.814547    0.832494    0.508464    0.170314    0.176160    0.344332    0.324602    0.814547    0.832494    0.325473    0.317177    4800        57.430730   0.528519    0.362484    161.269496 
[37m[36mINFO[0m[0m 02/23 18:03:30 | 0.321475    0.320616    0.864924    0.846348    0.436106    0.225152    0.228903    0.385544    0.377504    0.864924    0.846348    0.353728    0.355442    5000        59.823678   0.491137    0.338290    170.919096 
[37m[36mINFO[0m[0m 02/23 18:03:30 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[0, 1, 3]/250223_16-22-57_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/23 18:03:32 | ---
[37m[36mINFO[0m[0m 02/23 18:03:32 | test-domain validation(oracle) = 40.601%
[37m[36mINFO[0m[0m 02/23 18:03:32 | training-domain validation(iid) = 32.147%
[37m[36mINFO[0m[0m 02/23 18:03:32 | last = 32.147%
[37m[36mINFO[0m[0m 02/23 18:03:32 | last (inD) = 84.635%
[37m[36mINFO[0m[0m 02/23 18:03:32 | training-domain validation (iid, inD) = 84.635%
[37m[36mINFO[0m[0m 02/23 18:03:32 | === Summary ===
[37m[36mINFO[0m[0m 02/23 18:03:32 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 3 --dataset TerraIncognita --trial_seed 1 --hparams_seed 2
[37m[36mINFO[0m[0m 02/23 18:03:32 | Unique name: 250223_16-22-57_resnet50_GENIE
[37m[36mINFO[0m[0m 02/23 18:03:32 | Out path: train_output/TerraIncognita/RSC/[0, 1, 3]/250223_16-22-57_resnet50_GENIE
[37m[36mINFO[0m[0m 02/23 18:03:32 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/23 18:03:32 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 02/23 16:33:33 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 5
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 5
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[0, 1, 3]/250223_16-33-33_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 2
	unique_name: 250223_16-33-33_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 0.0002982828768978312
	batch_size: 9
	weight_decay: 0.0003180957897867641
	rsc_f_drop_factor: 0.22729325817372148
	rsc_b_drop_factor: 0.134901679846891
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/23 16:33:33 | n_steps = 5001
[37m[36mINFO[0m[0m 02/23 16:33:33 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/23 16:33:33 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/23 16:33:33 | 
[37m[36mINFO[0m[0m 02/23 16:33:33 | Testenv name escaping te_L100_L38_L46 -> te_L100_L38_L46
[37m[36mINFO[0m[0m 02/23 16:33:33 | Test envs = [0, 1, 3], name = te_L100_L38_L46
[37m[36mINFO[0m[0m 02/23 16:33:33 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 02/23 16:33:33 | Batch sizes for each domain: [0, 0, 9, 0] (total=9)
[37m[36mINFO[0m[0m 02/23 16:33:33 | steps-per-epoch for each domain: 352.89 -> min = 352.89
[37m[36mINFO[0m[0m 02/23 16:33:34 | # of params = 23528522
[37m[36mINFO[0m[0m 02/23 16:36:18 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/23 16:36:18 | 0.093108    0.091671    0.156801    0.133501    2.175459    0.129713    0.140295    0.030428    0.029276    0.156801    0.133501    0.119184    0.105442    0           0.000000    2.932753    1.207156    162.676637 
[37m[36mINFO[0m[0m 02/23 16:39:29 | 0.120843    0.118082    0.313602    0.294710    1.672830    0.010546    0.015823    0.189883    0.177709    0.313602    0.294710    0.162099    0.160714    200         0.566751    1.867115    0.171304    157.092549 
[37m[36mINFO[0m[0m 02/23 16:42:46 | 0.316627    0.303528    0.330919    0.314861    1.602153    0.201424    0.198312    0.463988    0.440164    0.330919    0.314861    0.284470    0.272109    400         1.133501    1.751615    0.129603    170.467136 
[37m[36mINFO[0m[0m 02/23 16:46:12 | 0.315703    0.299608    0.353275    0.337531    1.584737    0.202215    0.198312    0.458724    0.436055    0.353275    0.337531    0.286170    0.264456    600         1.700252    1.717770    0.118911    182.231481 
[37m[36mINFO[0m[0m 02/23 16:49:35 | 0.316906    0.300411    0.352645    0.335013    1.583403    0.202215    0.198312    0.464244    0.440164    0.352645    0.335013    0.284257    0.262755    800         2.267003    1.660083    0.136702    175.909907 
[37m[36mINFO[0m[0m 02/23 16:52:53 | 0.315289    0.299041    0.371537    0.367758    1.533140    0.202215    0.198312    0.457697    0.436055    0.371537    0.367758    0.285957    0.262755    1000        2.833753    1.664893    0.137424    170.360990 
[37m[36mINFO[0m[0m 02/23 16:56:11 | 0.314332    0.298752    0.376889    0.345088    1.545304    0.202215    0.198312    0.453974    0.433487    0.376889    0.345088    0.286807    0.264456    1200        3.400504    1.659001    0.131671    171.963567 
[37m[36mINFO[0m[0m 02/23 16:59:36 | 0.162587    0.160693    0.440491    0.458438    1.457008    0.051410    0.062236    0.265117    0.248074    0.440491    0.458438    0.171234    0.171769    1400        3.967254    1.640463    0.127484    179.724295 
[37m[36mINFO[0m[0m 02/23 17:02:50 | 0.302331    0.288620    0.407746    0.420655    1.465747    0.162932    0.167722    0.461292    0.437083    0.407746    0.420655    0.282770    0.261054    1600        4.534005    1.608257    0.133660    167.220141 
[37m[36mINFO[0m[0m 02/23 17:06:17 | 0.318042    0.310779    0.459068    0.434509    1.375099    0.196414    0.203586    0.456670    0.437083    0.459068    0.434509    0.301041    0.291667    1800        5.100756    1.582850    0.185710    169.041837 
[37m[36mINFO[0m[0m 02/23 17:09:38 | 0.330958    0.316292    0.523300    0.517632    1.309991    0.225415    0.220464    0.458981    0.437596    0.523300    0.517632    0.308477    0.290816    2000        5.667506    1.535035    0.185908    164.311948 
[37m[36mINFO[0m[0m 02/23 17:13:03 | 0.316878    0.302548    0.444899    0.435768    1.474023    0.237279    0.233122    0.463089    0.440678    0.444899    0.435768    0.250266    0.233844    2200        6.234257    1.570652    0.163498    171.748397 
[37m[36mINFO[0m[0m 02/23 17:16:28 | 0.329471    0.318599    0.458123    0.437028    1.358891    0.205115    0.198312    0.457825    0.436055    0.458123    0.437028    0.325473    0.321429    2400        6.801008    1.492564    0.139344    177.536635 
[37m[36mINFO[0m[0m 02/23 17:19:51 | 0.294545    0.280139    0.551008    0.571788    1.180273    0.204851    0.202532    0.400051    0.378531    0.551008    0.571788    0.278734    0.259354    2600        7.367758    1.430031    0.138373    174.893081 
[37m[36mINFO[0m[0m 02/23 17:23:08 | 0.314645    0.302089    0.544395    0.550378    1.269977    0.204324    0.198312    0.450892    0.429892    0.544395    0.550378    0.288719    0.278061    2800        7.934509    1.380348    0.142070    169.126177 
[37m[36mINFO[0m[0m 02/23 17:26:34 | 0.297056    0.291511    0.540617    0.549118    1.207618    0.182178    0.180380    0.447041    0.426297    0.540617    0.549118    0.261950    0.267857    3000        8.501259    1.437802    0.147843    175.871628 
[37m[36mINFO[0m[0m 02/23 17:29:50 | 0.260813    0.252145    0.461902    0.473552    1.326240    0.136831    0.135021    0.454615    0.433487    0.461902    0.473552    0.190992    0.187925    3200        9.068010    1.385702    0.150821    166.056455 
[37m[36mINFO[0m[0m 02/23 17:33:02 | 0.231069    0.225960    0.543451    0.565491    1.494969    0.094121    0.100211    0.390037    0.376990    0.543451    0.565491    0.209050    0.200680    3400        9.634761    1.344557    0.170451    157.723794 
[37m[36mINFO[0m[0m 02/23 17:36:16 | 0.333804    0.318612    0.589736    0.573048    1.103550    0.222252    0.218354    0.467711    0.445814    0.589736    0.573048    0.311451    0.291667    3600        10.201511   1.297202    0.139513    166.551407 
[37m[36mINFO[0m[0m 02/23 17:39:31 | 0.299128    0.283947    0.570844    0.562972    1.183254    0.158713    0.170886    0.455899    0.436055    0.570844    0.562972    0.282770    0.244898    3800        10.768262   1.267097    0.148991    165.244946 
[37m[36mINFO[0m[0m 02/23 17:42:42 | 0.329313    0.320697    0.653338    0.646096    0.996739    0.177696    0.186709    0.434844    0.416538    0.653338    0.646096    0.375398    0.358844    4000        11.335013   1.236815    0.148782    160.897178 
[37m[36mINFO[0m[0m 02/23 17:45:49 | 0.336330    0.319477    0.646725    0.638539    0.986372    0.228579    0.220464    0.440493    0.416538    0.646725    0.638539    0.339919    0.321429    4200        11.901763   1.184788    0.132524    160.724059 
[37m[36mINFO[0m[0m 02/23 17:48:58 | 0.339605    0.326160    0.647040    0.641058    0.990352    0.233325    0.225738    0.431763    0.413457    0.647040    0.641058    0.353728    0.339286    4400        12.468514   1.137890    0.140421    160.831765 
[37m[36mINFO[0m[0m 02/23 17:52:00 | 0.239242    0.230260    0.562343    0.575567    1.189149    0.091221    0.091772    0.433175    0.414484    0.562343    0.575567    0.193329    0.184524    4600        13.035264   1.132881    0.159061    149.888526 
[37m[36mINFO[0m[0m 02/23 17:55:18 | 0.277150    0.269847    0.636020    0.623426    1.042454    0.185341    0.193038    0.328283    0.308680    0.636020    0.623426    0.317825    0.307823    4800        13.602015   1.179773    0.169350    164.237864 
[37m[36mINFO[0m[0m 02/23 17:58:35 | 0.291789    0.284783    0.602645    0.607053    1.040137    0.104666    0.114979    0.413147    0.397535    0.602645    0.607053    0.357553    0.341837    5000        14.168766   1.244426    0.165532    163.650635 
[37m[36mINFO[0m[0m 02/23 17:58:35 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[0, 1, 3]/250223_16-33-33_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/23 17:58:37 | ---
[37m[36mINFO[0m[0m 02/23 17:58:37 | test-domain validation(oracle) = 33.961%
[37m[36mINFO[0m[0m 02/23 17:58:37 | training-domain validation(iid) = 32.931%
[37m[36mINFO[0m[0m 02/23 17:58:37 | last = 29.179%
[37m[36mINFO[0m[0m 02/23 17:58:37 | last (inD) = 60.705%
[37m[36mINFO[0m[0m 02/23 17:58:37 | training-domain validation (iid, inD) = 64.610%
[37m[36mINFO[0m[0m 02/23 17:58:37 | === Summary ===
[37m[36mINFO[0m[0m 02/23 17:58:37 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 3 --dataset TerraIncognita --trial_seed 2 --hparams_seed 5
[37m[36mINFO[0m[0m 02/23 17:58:37 | Unique name: 250223_16-33-33_resnet50_GENIE
[37m[36mINFO[0m[0m 02/23 17:58:37 | Out path: train_output/TerraIncognita/RSC/[0, 1, 3]/250223_16-33-33_resnet50_GENIE
[37m[36mINFO[0m[0m 02/23 17:58:37 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/23 17:58:37 | Dataset: TerraIncognita

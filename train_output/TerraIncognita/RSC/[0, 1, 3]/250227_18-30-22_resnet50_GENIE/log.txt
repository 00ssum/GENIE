[37m[36mINFO[0m[0m 02/27 18:30:22 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 3 --dataset TerraIncognita --trial_seed 0 --hparams_seed 4
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 4
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[0, 1, 3]/250227_18-30-22_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[0, 1, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 1, 3]
	trial_seed: 0
	unique_name: 250227_18-30-22_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.0793009436922532e-05
	batch_size: 30
	weight_decay: 0.0007980067844361917
	rsc_f_drop_factor: 0.00568084739259922
	rsc_b_drop_factor: 0.21660562421584156
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/27 18:30:22 | n_steps = 5001
[37m[36mINFO[0m[0m 02/27 18:30:22 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/27 18:30:22 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/27 18:30:22 | 
[37m[36mINFO[0m[0m 02/27 18:30:22 | Testenv name escaping te_L100_L38_L46 -> te_L100_L38_L46
[37m[36mINFO[0m[0m 02/27 18:30:22 | Test envs = [0, 1, 3], name = te_L100_L38_L46
[37m[36mINFO[0m[0m 02/27 18:30:22 | Train environments: [2], Test environments: [0, 1, 3]
[37m[36mINFO[0m[0m 02/27 18:30:22 | Batch sizes for each domain: [0, 0, 30, 0] (total=30)
[37m[36mINFO[0m[0m 02/27 18:30:22 | steps-per-epoch for each domain: 105.87 -> min = 105.87
[37m[36mINFO[0m[0m 02/27 18:30:23 | # of params = 23528522
[37m[36mINFO[0m[0m 02/27 18:33:04 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/27 18:33:04 | 0.095415    0.091423    0.296285    0.230479    2.053623    0.126549    0.118143    0.002696    0.000514    0.296285    0.230479    0.157000    0.155612    0           0.000000    2.512321    1.256209    159.745847 
[37m[36mINFO[0m[0m 02/27 18:36:51 | 0.300114    0.309907    0.498741    0.521411    1.379374    0.221197    0.228903    0.456285    0.482280    0.498741    0.521411    0.222860    0.218537    200         1.889169    1.603164    0.300305    166.475415 
[37m[36mINFO[0m[0m 02/27 18:40:26 | 0.329846    0.339559    0.516058    0.528967    1.268572    0.229897    0.239451    0.459237    0.483308    0.516058    0.528967    0.300404    0.295918    400         3.778338    1.353879    0.249957    165.392267 
[37m[36mINFO[0m[0m 02/27 18:44:01 | 0.240849    0.255155    0.684509    0.687657    0.882785    0.131294    0.144515    0.280652    0.312275    0.684509    0.687657    0.310601    0.308673    600         5.667506    1.055408    0.267919    160.642323 
[37m[36mINFO[0m[0m 02/27 18:47:35 | 0.397294    0.413962    0.716310    0.709068    0.757390    0.382810    0.416667    0.443446    0.468927    0.716310    0.709068    0.365626    0.356293    800         7.556675    0.869664    0.298069    155.158705 
[37m[36mINFO[0m[0m 02/27 18:51:11 | 0.369132    0.392569    0.765113    0.725441    0.758770    0.341418    0.362869    0.436256    0.467899    0.765113    0.725441    0.329722    0.346939    1000        9.445844    0.709560    0.260839    163.617619 
[37m[36mINFO[0m[0m 02/27 18:54:34 | 0.363380    0.379555    0.787469    0.778338    0.668156    0.326391    0.339662    0.439338    0.464818    0.787469    0.778338    0.324410    0.334184    1200        11.335013   0.620842    0.239975    154.683803 
[37m[36mINFO[0m[0m 02/27 18:57:53 | 0.414868    0.421280    0.818010    0.822418    0.502448    0.438703    0.445148    0.415843    0.433487    0.818010    0.822418    0.390057    0.385204    1400        13.224181   0.567753    0.237454    151.564709 
[37m[36mINFO[0m[0m 02/27 19:01:14 | 0.388820    0.397895    0.816751    0.792191    0.566766    0.332718    0.351266    0.447297    0.472522    0.816751    0.792191    0.386446    0.369898    1600        15.113350   0.544376    0.230419    154.966209 
[37m[36mINFO[0m[0m 02/27 19:04:39 | 0.379089    0.388977    0.850441    0.819899    0.502721    0.321909    0.331224    0.437412    0.460709    0.850441    0.819899    0.377948    0.375000    1800        17.002519   0.475918    0.234236    158.065764 
[37m[36mINFO[0m[0m 02/27 19:08:05 | 0.410201    0.422692    0.854534    0.833753    0.484570    0.462694    0.475738    0.379124    0.408834    0.854534    0.833753    0.388783    0.383503    2000        18.891688   0.509792    0.272948    151.834205 
[37m[36mINFO[0m[0m 02/27 19:11:32 | 0.399448    0.410535    0.845718    0.808564    0.510139    0.408384    0.413502    0.420722    0.447355    0.845718    0.808564    0.369237    0.370748    2200        20.780856   0.448108    0.262516    154.110842 
[37m[36mINFO[0m[0m 02/27 19:14:50 | 0.394091    0.405892    0.861776    0.840050    0.469639    0.411548    0.430380    0.416998    0.443760    0.861776    0.840050    0.353728    0.343537    2400        22.670025   0.415168    0.245425    148.817467 
[37m[36mINFO[0m[0m 02/27 19:18:08 | 0.405394    0.408444    0.844458    0.819899    0.510413    0.435803    0.428270    0.400308    0.428865    0.844458    0.819899    0.380072    0.368197    2600        24.559194   0.371398    0.248867    148.238580 
[37m[36mINFO[0m[0m 02/27 19:21:28 | 0.363109    0.370790    0.875945    0.823678    0.503750    0.380965    0.382911    0.335088    0.364664    0.875945    0.823678    0.373274    0.364796    2800        26.448363   0.377600    0.234320    153.298201 
[37m[36mINFO[0m[0m 02/27 19:24:45 | 0.361484    0.377627    0.884446    0.843829    0.452514    0.272871    0.285865    0.419823    0.447355    0.884446    0.843829    0.391757    0.399660    3000        28.337531   0.321749    0.235080    149.595768 
[37m[36mINFO[0m[0m 02/27 19:28:10 | 0.390955    0.403608    0.873741    0.819899    0.509567    0.415239    0.430380    0.414944    0.436055    0.873741    0.819899    0.342681    0.344388    3200        30.226700   0.335203    0.237082    157.452864 
[37m[36mINFO[0m[0m 02/27 19:31:43 | 0.392528    0.398447    0.890743    0.858942    0.412374    0.393620    0.391350    0.390294    0.422188    0.890743    0.858942    0.393669    0.381803    3400        32.115869   0.353691    0.273561    158.800492 
[37m[36mINFO[0m[0m 02/27 19:35:13 | 0.428129    0.429214    0.904912    0.862720    0.376182    0.494595    0.478903    0.391449    0.420134    0.904912    0.862720    0.398343    0.388605    3600        34.005038   0.314602    0.260674    157.551698 
[37m[36mINFO[0m[0m 02/27 19:38:43 | 0.397419    0.405425    0.896411    0.860202    0.403998    0.418402    0.422996    0.372962    0.397021    0.896411    0.860202    0.400892    0.396259    3800        35.894207   0.303955    0.282075    153.395453 
[37m[36mINFO[0m[0m 02/27 19:42:08 | 0.345804    0.366353    0.906171    0.851385    0.405586    0.383601    0.406118    0.300295    0.320493    0.906171    0.851385    0.353516    0.372449    4000        37.783375   0.278551    0.263449    152.977844 
[37m[36mINFO[0m[0m 02/27 19:45:42 | 0.395291    0.399819    0.910264    0.872796    0.382293    0.399420    0.394515    0.417640    0.437596    0.910264    0.872796    0.368812    0.367347    4200        39.672544   0.280276    0.246843    164.208031 
[37m[36mINFO[0m[0m 02/27 19:49:16 | 0.413741    0.422578    0.902393    0.876574    0.372300    0.515687    0.535865    0.342278    0.368772    0.902393    0.876574    0.383259    0.363095    4400        41.561713   0.272098    0.257153    162.433451 
[37m[36mINFO[0m[0m 02/27 19:52:46 | 0.354653    0.364018    0.923174    0.876574    0.376285    0.367519    0.378692    0.325716    0.347714    0.923174    0.876574    0.370724    0.365646    4600        43.450882   0.223436    0.236298    162.657132 
[37m[36mINFO[0m[0m 02/27 19:56:24 | 0.397288    0.391188    0.914358    0.860202    0.371449    0.448194    0.444093    0.382719    0.391885    0.914358    0.860202    0.360952    0.337585    4800        45.340050   0.259341    0.282962    161.472425 
[37m[36mINFO[0m[0m 02/27 20:00:01 | 0.424388    0.433977    0.927267    0.877834    0.413298    0.488532    0.487342    0.376942    0.404725    0.927267    0.877834    0.407691    0.409864    5000        47.229219   0.236032    0.263297    164.532811 
[37m[36mINFO[0m[0m 02/27 20:00:01 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[0, 1, 3]/250227_18-30-22_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/27 20:00:02 | ---
[37m[36mINFO[0m[0m 02/27 20:00:02 | test-domain validation(oracle) = 42.439%
[37m[36mINFO[0m[0m 02/27 20:00:02 | training-domain validation(iid) = 42.439%
[37m[36mINFO[0m[0m 02/27 20:00:02 | last = 42.439%
[37m[36mINFO[0m[0m 02/27 20:00:02 | last (inD) = 87.783%
[37m[36mINFO[0m[0m 02/27 20:00:02 | training-domain validation (iid, inD) = 87.783%
[37m[36mINFO[0m[0m 02/27 20:00:02 | === Summary ===
[37m[36mINFO[0m[0m 02/27 20:00:02 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 1 3 --dataset TerraIncognita --trial_seed 0 --hparams_seed 4
[37m[36mINFO[0m[0m 02/27 20:00:02 | Unique name: 250227_18-30-22_resnet50_GENIE
[37m[36mINFO[0m[0m 02/27 20:00:02 | Out path: train_output/TerraIncognita/RSC/[0, 1, 3]/250227_18-30-22_resnet50_GENIE
[37m[36mINFO[0m[0m 02/27 20:00:02 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/27 20:00:02 | Dataset: TerraIncognita

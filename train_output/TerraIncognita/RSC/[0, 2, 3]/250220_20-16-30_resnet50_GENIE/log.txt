[37m[36mINFO[0m[0m 02/20 20:16:30 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 2 3 --dataset TerraIncognita --trial_seed 0 --hparams_seed 20
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 20
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[0, 2, 3]/250220_20-16-30_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[0, 2, 3]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0, 2, 3]
	trial_seed: 0
	unique_name: 250220_20-16-30_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.6157673767852512e-05
	batch_size: 32
	weight_decay: 1.110622050999988e-05
	rsc_f_drop_factor: 0.011558843074644498
	rsc_b_drop_factor: 0.009443205254898168
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/20 20:16:30 | n_steps = 5001
[37m[36mINFO[0m[0m 02/20 20:16:30 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/20 20:16:30 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/20 20:16:30 | 
[37m[36mINFO[0m[0m 02/20 20:16:30 | Testenv name escaping te_L100_L43_L46 -> te_L100_L43_L46
[37m[36mINFO[0m[0m 02/20 20:16:30 | Test envs = [0, 2, 3], name = te_L100_L43_L46
[37m[36mINFO[0m[0m 02/20 20:16:30 | Train environments: [1], Test environments: [0, 2, 3]
[37m[36mINFO[0m[0m 02/20 20:16:30 | Batch sizes for each domain: [0, 32, 0, 0] (total=32)
[37m[36mINFO[0m[0m 02/20 20:16:30 | steps-per-epoch for each domain: 243.41 -> min = 243.41
[37m[36mINFO[0m[0m 02/20 20:16:31 | # of params = 23528522
[37m[36mINFO[0m[0m 02/20 20:19:36 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/20 20:19:36 | 0.203084    0.213519    0.455514    0.481253    2.102630    0.200633    0.208861    0.455514    0.481253    0.186398    0.221662    0.222222    0.210034    0           0.000000    2.235929    1.343410    183.551151 
[37m[36mINFO[0m[0m 02/20 20:23:42 | 0.204605    0.213813    0.579664    0.600411    1.068112    0.207487    0.210970    0.579664    0.600411    0.182620    0.217884    0.223709    0.212585    200         0.821672    1.206834    0.293335    187.420129 
[37m[36mINFO[0m[0m 02/20 20:27:32 | 0.200626    0.211058    0.612145    0.631741    1.035635    0.203796    0.207806    0.612145    0.631741    0.179471    0.217884    0.218611    0.207483    400         1.643343    1.125211    0.284328    173.350745 
[37m[36mINFO[0m[0m 02/20 20:31:29 | 0.196297    0.201657    0.634613    0.649204    0.996632    0.201424    0.198312    0.634613    0.649204    0.178841    0.217884    0.208625    0.188776    600         2.465015    1.110384    0.283836    179.999696 
[37m[36mINFO[0m[0m 02/20 20:35:25 | 0.108205    0.127261    0.705867    0.710837    0.853218    0.152122    0.166667    0.705867    0.710837    0.159320    0.201511    0.013172    0.013605    800         3.286686    1.018791    0.263025    183.461787 
[37m[36mINFO[0m[0m 02/20 20:39:39 | 0.093579    0.101552    0.751573    0.789933    0.731617    0.111785    0.126582    0.751573    0.789933    0.083123    0.105793    0.085830    0.072279    1000        4.108358    0.798754    0.330176    187.597129 
[37m[36mINFO[0m[0m 02/20 20:43:56 | 0.133362    0.133953    0.766722    0.779147    0.618491    0.168468    0.190928    0.766722    0.779147    0.066121    0.062972    0.165498    0.147959    1200        4.930030    0.703787    0.273635    202.759464 
[37m[36mINFO[0m[0m 02/20 20:47:59 | 0.132910    0.146494    0.770574    0.794556    0.710212    0.136567    0.167722    0.770574    0.794556    0.105164    0.127204    0.157000    0.144558    1400        5.751701    0.663509    0.282966    186.438404 
[37m[36mINFO[0m[0m 02/20 20:52:07 | 0.257585    0.261967    0.802799    0.818182    0.546496    0.385183    0.373418    0.802799    0.818182    0.187657    0.227960    0.199915    0.184524    1600        6.573373    0.589155    0.369376    173.230053 
[37m[36mINFO[0m[0m 02/20 20:56:07 | 0.168514    0.187111    0.800873    0.814587    0.575684    0.257580    0.279536    0.800873    0.814587    0.146411    0.173804    0.101551    0.107993    1800        7.395044    0.598315    0.263356    188.192255 
[37m[36mINFO[0m[0m 02/20 21:00:11 | 0.211454    0.214460    0.806779    0.809964    0.498933    0.385974    0.405063    0.806779    0.809964    0.111146    0.115869    0.137242    0.122449    2000        8.216716    0.582842    0.287440    185.991210 
[37m[36mINFO[0m[0m 02/20 21:04:37 | 0.253243    0.253001    0.826807    0.842322    0.471937    0.396520    0.381857    0.826807    0.842322    0.199622    0.231738    0.163586    0.145408    2200        9.038387    0.536305    0.338781    198.432136 
[37m[36mINFO[0m[0m 02/20 21:08:49 | 0.218082    0.227541    0.832841    0.826400    0.465822    0.324809    0.323840    0.832841    0.826400    0.198992    0.238035    0.130444    0.120748    2400        9.860059    0.483075    0.268341    198.073795 
[37m[36mINFO[0m[0m 02/20 21:13:00 | 0.211122    0.217835    0.826293    0.830508    0.484384    0.398365    0.405063    0.826293    0.830508    0.181675    0.188917    0.053325    0.059524    2600        10.681731   0.477431    0.288387    193.366780 
[37m[36mINFO[0m[0m 02/20 21:17:13 | 0.168671    0.176630    0.850687    0.851053    0.471971    0.250989    0.259494    0.850687    0.851053    0.142003    0.167506    0.113023    0.102891    2800        11.503402   0.466668    0.287541    195.482026 
[37m[36mINFO[0m[0m 02/20 21:21:32 | 0.204280    0.219636    0.862627    0.859784    0.452458    0.286053    0.301688    0.862627    0.859784    0.163413    0.193955    0.163374    0.163265    3000        12.325074   0.447304    0.307309    198.127428 
[37m[36mINFO[0m[0m 02/20 21:25:47 | 0.204994    0.217214    0.869688    0.870056    0.390572    0.302399    0.300633    0.869688    0.870056    0.178526    0.214106    0.134056    0.136905    3200        13.146745   0.434144    0.277672    199.355055 
[37m[36mINFO[0m[0m 02/20 21:30:02 | 0.153527    0.156809    0.846450    0.852594    0.436774    0.271289    0.283755    0.846450    0.852594    0.096662    0.098237    0.092628    0.088435    3400        13.968417   0.406989    0.300468    194.848752 
[37m[36mINFO[0m[0m 02/20 21:34:24 | 0.210033    0.229668    0.880216    0.883924    0.369388    0.325073    0.348101    0.880216    0.883924    0.170970    0.206549    0.134056    0.134354    3600        14.790089   0.406086    0.315340    198.321475 
[37m[36mINFO[0m[0m 02/20 21:38:31 | 0.287347    0.293465    0.881628    0.897278    0.335636    0.474822    0.478903    0.881628    0.897278    0.190491    0.222922    0.196728    0.178571    3800        15.611760   0.370193    0.270459    192.952877 
[37m[36mINFO[0m[0m 02/20 21:42:39 | 0.228386    0.238497    0.891899    0.887006    0.334809    0.413129    0.440928    0.891899    0.887006    0.141373    0.141058    0.130656    0.133503    4000        16.433432   0.380686    0.292248    190.074525 
[37m[36mINFO[0m[0m 02/20 21:47:07 | 0.238262    0.255835    0.894595    0.892142    0.310786    0.391774    0.411392    0.894595    0.892142    0.185768    0.214106    0.137242    0.142007    4200        17.255103   0.370921    0.348052    198.365785 
[37m[36mINFO[0m[0m 02/20 21:51:13 | 0.235194    0.244490    0.902555    0.897791    0.302410    0.372792    0.390295    0.902555    0.897791    0.185139    0.195214    0.147652    0.147959    4400        18.076775   0.338259    0.264922    193.016245 
[37m[36mINFO[0m[0m 02/20 21:55:23 | 0.246442    0.268921    0.868918    0.879301    0.373572    0.417084    0.428270    0.868918    0.879301    0.214106    0.259446    0.108137    0.119048    4600        18.898447   0.365677    0.283132    193.486718 
[37m[36mINFO[0m[0m 02/20 21:59:28 | 0.207226    0.222173    0.902940    0.910118    0.282237    0.308990    0.331224    0.902940    0.910118    0.187343    0.212846    0.125345    0.122449    4800        19.720118   0.306838    0.296960    185.343514 
[37m[36mINFO[0m[0m 02/20 22:03:24 | 0.227496    0.241891    0.905893    0.905496    0.293628    0.381756    0.416667    0.905893    0.905496    0.157116    0.173804    0.143616    0.135204    5000        20.541790   0.300131    0.301966    175.578328 
[37m[36mINFO[0m[0m 02/20 22:03:24 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[0, 2, 3]/250220_20-16-30_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/20 22:03:26 | ---
[37m[36mINFO[0m[0m 02/20 22:03:26 | test-domain validation(oracle) = 28.735%
[37m[36mINFO[0m[0m 02/20 22:03:26 | training-domain validation(iid) = 20.723%
[37m[36mINFO[0m[0m 02/20 22:03:26 | last = 22.750%
[37m[36mINFO[0m[0m 02/20 22:03:26 | last (inD) = 90.550%
[37m[36mINFO[0m[0m 02/20 22:03:26 | training-domain validation (iid, inD) = 91.012%
[37m[36mINFO[0m[0m 02/20 22:03:26 | === Summary ===
[37m[36mINFO[0m[0m 02/20 22:03:26 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 2 3 --dataset TerraIncognita --trial_seed 0 --hparams_seed 20
[37m[36mINFO[0m[0m 02/20 22:03:26 | Unique name: 250220_20-16-30_resnet50_GENIE
[37m[36mINFO[0m[0m 02/20 22:03:26 | Out path: train_output/TerraIncognita/RSC/[0, 2, 3]/250220_20-16-30_resnet50_GENIE
[37m[36mINFO[0m[0m 02/20 22:03:26 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/20 22:03:26 | Dataset: TerraIncognita

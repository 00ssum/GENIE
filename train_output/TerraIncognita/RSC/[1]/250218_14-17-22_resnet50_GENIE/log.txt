[37m[36mINFO[0m[0m 02/18 14:17:22 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 1 --dataset TerraIncognita --trial_seed 1 --hparams_seed 9
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 9
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[1]/250218_14-17-22_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250218_14-17-22_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.7532223448653515e-05
	batch_size: 36
	weight_decay: 0.007511403320794324
	rsc_f_drop_factor: 0.47049384666007127
	rsc_b_drop_factor: 0.32275146960807627
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/18 14:17:22 | n_steps = 5001
[37m[36mINFO[0m[0m 02/18 14:17:22 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/18 14:17:22 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/18 14:17:22 | 
[37m[36mINFO[0m[0m 02/18 14:17:22 | Testenv name escaping te_L38 -> te_L38
[37m[36mINFO[0m[0m 02/18 14:17:22 | Test envs = [1], name = te_L38
[37m[36mINFO[0m[0m 02/18 14:17:22 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 02/18 14:17:22 | Batch sizes for each domain: [36, 0, 36, 36] (total=108)
[37m[36mINFO[0m[0m 02/18 14:17:22 | steps-per-epoch for each domain: 105.36, 88.22, 130.75 -> min = 88.22
[37m[36mINFO[0m[0m 02/18 14:17:24 | # of params = 23528522
[37m[36mINFO[0m[0m 02/18 14:20:25 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/18 14:20:25 | 0.460650    0.453518    0.211637    0.208140    2.168891    0.215133    0.199367    0.460650    0.453518    0.186083    0.209068    0.233694    0.215986    0           0.000000    3.783014    1.386547    179.460897 
[37m[36mINFO[0m[0m 02/18 14:24:59 | 0.020413    0.022085    0.352516    0.370452    1.661418    0.503559    0.542194    0.020413    0.022085    0.243388    0.244332    0.310601    0.324830    200         2.267003    2.053814    0.434272    187.441794 
[37m[36mINFO[0m[0m 02/18 14:29:24 | 0.040313    0.037494    0.390516    0.398944    1.582406    0.592934    0.621308    0.040313    0.037494    0.236146    0.245592    0.342469    0.329932    400         4.534005    1.893181    0.400365    185.508350 
[37m[36mINFO[0m[0m 02/18 14:33:52 | 0.026448    0.032357    0.408435    0.410149    1.515854    0.597416    0.622363    0.026448    0.032357    0.263539    0.259446    0.364351    0.348639    600         6.801008    1.810173    0.360496    195.900771 
[37m[36mINFO[0m[0m 02/18 14:38:27 | 0.052125    0.051361    0.456628    0.478828    1.447995    0.605853    0.641350    0.052125    0.051361    0.345718    0.361461    0.418313    0.433673    800         9.068010    1.750229    0.393252    195.913818 
[37m[36mINFO[0m[0m 02/18 14:42:37 | 0.040955    0.042630    0.450375    0.473694    1.419854    0.609280    0.641350    0.040955    0.042630    0.335642    0.369018    0.406204    0.410714    1000        11.335013   1.742443    0.317733    186.337047 
[37m[36mINFO[0m[0m 02/18 14:47:05 | 0.028117    0.035953    0.445455    0.456784    1.418556    0.584761    0.605485    0.028117    0.035953    0.354534    0.367758    0.397068    0.397109    1200        13.602015   1.710859    0.382215    192.115094 
[37m[36mINFO[0m[0m 02/18 14:51:00 | 0.045577    0.043143    0.452070    0.468274    1.417398    0.609808    0.645570    0.045577    0.043143    0.380353    0.408060    0.366051    0.351190    1400        15.869018   1.709113    0.333811    167.267792 
[37m[36mINFO[0m[0m 02/18 14:55:11 | 0.033766    0.036466    0.426125    0.440133    1.395215    0.593989    0.616034    0.033766    0.036466    0.343829    0.377834    0.340557    0.326531    1600        18.136020   1.686110    0.316804    188.300589 
[37m[36mINFO[0m[0m 02/18 14:59:19 | 0.072025    0.077555    0.472737    0.487440    1.387667    0.591616    0.617089    0.072025    0.077555    0.389798    0.400504    0.436796    0.444728    1800        20.403023   1.697578    0.339951    179.847994 
[37m[36mINFO[0m[0m 02/18 15:03:20 | 0.052510    0.051361    0.466116    0.470573    1.369363    0.596625    0.612869    0.052510    0.051361    0.373426    0.370277    0.428298    0.428571    2000        22.670025   1.681348    0.313644    178.303339 
[37m[36mINFO[0m[0m 02/18 15:07:30 | 0.053537    0.053416    0.473414    0.489607    1.378607    0.600316    0.618143    0.053537    0.053416    0.396725    0.406801    0.423199    0.443878    2200        24.937028   1.683639    0.373481    174.950194 
[37m[36mINFO[0m[0m 02/18 15:11:51 | 0.047246    0.046225    0.462067    0.481453    1.389950    0.597153    0.617089    0.047246    0.046225    0.393892    0.442065    0.395156    0.385204    2400        27.204030   1.686074    0.423972    176.399909 
[37m[36mINFO[0m[0m 02/18 15:16:09 | 0.033766    0.038007    0.447201    0.480529    1.375513    0.606117    0.637131    0.033766    0.038007    0.334383    0.363980    0.401105    0.440476    2600        29.471033   1.682182    0.434217    170.975695 
[37m[36mINFO[0m[0m 02/18 15:20:14 | 0.044422    0.046225    0.465034    0.496593    1.369542    0.602953    0.629747    0.044422    0.046225    0.357053    0.406801    0.435097    0.453231    2800        31.738035   1.671587    0.398022    165.919368 
[37m[36mINFO[0m[0m 02/18 15:24:35 | 0.046476    0.044684    0.459189    0.480006    1.378796    0.601898    0.619198    0.046476    0.044684    0.384761    0.414358    0.390907    0.406463    3000        34.005038   1.673714    0.384876    184.072584 
[37m[36mINFO[0m[0m 02/18 15:28:39 | 0.046347    0.047766    0.432981    0.451413    1.398563    0.601898    0.636076    0.046347    0.047766    0.324622    0.362720    0.372424    0.355442    3200        36.272040   1.678403    0.332787    176.715253 
[37m[36mINFO[0m[0m 02/18 15:32:39 | 0.065990    0.065742    0.470927    0.483845    1.374092    0.595834    0.611814    0.065990    0.065742    0.388224    0.399244    0.428723    0.440476    3400        38.539043   1.687096    0.337210    172.969953 
[37m[36mINFO[0m[0m 02/18 15:36:42 | 0.053409    0.055984    0.459657    0.472995    1.378759    0.598735    0.623418    0.053409    0.055984    0.393577    0.394207    0.386658    0.401361    3600        40.806045   1.671113    0.328118    177.747509 
[37m[36mINFO[0m[0m 02/18 15:40:50 | 0.052510    0.053416    0.449875    0.467369    1.402495    0.612708    0.636076    0.052510    0.053416    0.347922    0.376574    0.388995    0.389456    3800        43.073048   1.679352    0.346685    177.841037 
[37m[36mINFO[0m[0m 02/18 15:44:56 | 0.048787    0.050847    0.450598    0.462787    1.377911    0.601635    0.624473    0.048787    0.050847    0.368388    0.377834    0.381772    0.386054    4000        45.340050   1.683099    0.380541    170.454741 
[37m[36mINFO[0m[0m 02/18 15:49:01 | 0.031455    0.034926    0.447281    0.481631    1.380434    0.592671    0.620253    0.031455    0.034926    0.335957    0.381612    0.413214    0.443027    4200        47.607053   1.682994    0.367779    171.186792 
[37m[36mINFO[0m[0m 02/18 15:53:10 | 0.056490    0.055470    0.468291    0.494775    1.378273    0.595044    0.619198    0.056490    0.055470    0.397040    0.440806    0.412789    0.424320    4400        49.874055   1.681556    0.375564    174.371193 
[37m[36mINFO[0m[0m 02/18 15:57:06 | 0.053409    0.055470    0.474903    0.497085    1.380511    0.597680    0.623418    0.053409    0.055470    0.397670    0.428212    0.429361    0.439626    4600        52.141058   1.663862    0.333183    168.749918 
[37m[36mINFO[0m[0m 02/18 16:01:08 | 0.046604    0.044171    0.453279    0.484085    1.378673    0.591616    0.620253    0.046604    0.044171    0.359257    0.404282    0.408965    0.427721    4800        54.408060   1.668120    0.331997    176.016861 
[37m[36mINFO[0m[0m 02/18 16:05:04 | 0.092566    0.100668    0.443590    0.457373    1.402585    0.595307    0.612869    0.092566    0.100668    0.371537    0.408060    0.363926    0.351190    5000        56.675063   1.680171    0.323501    171.221711 
[37m[36mINFO[0m[0m 02/18 16:05:04 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[1]/250218_14-17-22_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/18 16:05:06 | ---
[37m[36mINFO[0m[0m 02/18 16:05:06 | test-domain validation(oracle) = 46.065%
[37m[36mINFO[0m[0m 02/18 16:05:06 | training-domain validation(iid) = 5.341%
[37m[36mINFO[0m[0m 02/18 16:05:06 | last = 9.257%
[37m[36mINFO[0m[0m 02/18 16:05:06 | last (inD) = 45.737%
[37m[36mINFO[0m[0m 02/18 16:05:06 | training-domain validation (iid, inD) = 49.709%
[37m[36mINFO[0m[0m 02/18 16:05:06 | === Summary ===
[37m[36mINFO[0m[0m 02/18 16:05:06 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 1 --dataset TerraIncognita --trial_seed 1 --hparams_seed 9
[37m[36mINFO[0m[0m 02/18 16:05:06 | Unique name: 250218_14-17-22_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 16:05:06 | Out path: train_output/TerraIncognita/RSC/[1]/250218_14-17-22_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 16:05:06 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/18 16:05:06 | Dataset: TerraIncognita

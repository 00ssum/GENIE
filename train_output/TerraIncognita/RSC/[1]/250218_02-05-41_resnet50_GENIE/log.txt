[37m[36mINFO[0m[0m 02/18 02:05:41 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 1 --dataset TerraIncognita --trial_seed 1 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[1]/250218_02-05-41_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250218_02-05-41_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.2332416678311953e-05
	batch_size: 13
	weight_decay: 0.0018634819595667504
	rsc_f_drop_factor: 0.157459736969642
	rsc_b_drop_factor: 0.14769128459366804
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/18 02:05:42 | n_steps = 5001
[37m[36mINFO[0m[0m 02/18 02:05:42 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/18 02:05:42 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/18 02:05:42 | 
[37m[36mINFO[0m[0m 02/18 02:05:42 | Testenv name escaping te_L38 -> te_L38
[37m[36mINFO[0m[0m 02/18 02:05:42 | Test envs = [1], name = te_L38
[37m[36mINFO[0m[0m 02/18 02:05:42 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 02/18 02:05:42 | Batch sizes for each domain: [13, 0, 13, 13] (total=39)
[37m[36mINFO[0m[0m 02/18 02:05:42 | steps-per-epoch for each domain: 291.77, 244.31, 362.08 -> min = 244.31
[37m[36mINFO[0m[0m 02/18 02:05:43 | # of params = 23528522
[37m[36mINFO[0m[0m 02/18 02:08:39 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/18 02:08:39 | 0.019515    0.022085    0.285811    0.284145    2.073501    0.517005    0.541139    0.019515    0.022085    0.098237    0.094458    0.242192    0.216837    0           0.000000    2.761631    1.549643    174.016069 
[37m[36mINFO[0m[0m 02/18 02:12:16 | 0.025420    0.031844    0.410580    0.433197    1.457645    0.543897    0.578059    0.025420    0.031844    0.330290    0.365239    0.357553    0.356293    200         0.818640    1.710260    0.195326    178.450653 
[37m[36mINFO[0m[0m 02/18 02:15:47 | 0.036847    0.038521    0.476770    0.499123    1.347348    0.598471    0.614979    0.036847    0.038521    0.377834    0.420655    0.454005    0.461735    400         1.637280    1.511939    0.173823    176.192909 
[37m[36mINFO[0m[0m 02/18 02:19:19 | 0.036333    0.037494    0.459886    0.466396    1.330228    0.601371    0.619198    0.036333    0.037494    0.361461    0.348866    0.416826    0.431122    600         2.455919    1.430859    0.176076    176.520518 
[37m[36mINFO[0m[0m 02/18 02:22:55 | 0.055334    0.054956    0.540466    0.558810    1.281468    0.676509    0.679325    0.055334    0.054956    0.471977    0.493703    0.472913    0.503401    800         3.274559    1.362593    0.197513    176.695138 
[37m[36mINFO[0m[0m 02/18 02:26:38 | 0.136603    0.137134    0.569704    0.586954    1.151051    0.726338    0.737342    0.136603    0.137134    0.483942    0.522670    0.498832    0.500850    1000        4.093199    1.292275    0.205716    182.202527 
[37m[36mINFO[0m[0m 02/18 02:30:16 | 0.112595    0.115049    0.590264    0.585211    1.078296    0.699446    0.682489    0.112595    0.115049    0.573363    0.565491    0.497982    0.507653    1200        4.911839    1.178972    0.177965    182.308739 
[37m[36mINFO[0m[0m 02/18 02:33:51 | 0.297342    0.295326    0.623503    0.636060    0.999537    0.762457    0.751055    0.297342    0.295326    0.577141    0.614610    0.530911    0.542517    1400        5.730479    1.063660    0.183553    178.195265 
[37m[36mINFO[0m[0m 02/18 02:37:34 | 0.302606    0.295840    0.705385    0.709069    0.807956    0.826786    0.834388    0.302606    0.295840    0.647985    0.676322    0.641385    0.616497    1600        6.549118    0.963539    0.189649    185.006040 
[37m[36mINFO[0m[0m 02/18 02:41:13 | 0.219412    0.222907    0.722700    0.720296    0.789915    0.848669    0.848101    0.219412    0.222907    0.656801    0.677582    0.662630    0.635204    1800        7.367758    0.886753    0.217264    175.579250 
[37m[36mINFO[0m[0m 02/18 02:44:55 | 0.266915    0.270673    0.721416    0.714418    0.787644    0.869760    0.860759    0.266915    0.270673    0.637594    0.652393    0.656894    0.630102    2000        8.186398    0.852803    0.189626    184.038985 
[37m[36mINFO[0m[0m 02/18 02:48:21 | 0.240852    0.247560    0.755656    0.756492    0.672596    0.873451    0.870253    0.240852    0.247560    0.705605    0.734257    0.687912    0.664966    2200        9.005038    0.739847    0.150029    175.816866 
[37m[36mINFO[0m[0m 02/18 02:51:58 | 0.340609    0.352851    0.772912    0.760812    0.641234    0.875033    0.860759    0.340609    0.352851    0.727960    0.740554    0.715743    0.681122    2400        9.823678    0.738143    0.174174    181.690147 
[37m[36mINFO[0m[0m 02/18 02:55:26 | 0.296829    0.309194    0.748684    0.737583    0.724252    0.848932    0.833333    0.296829    0.309194    0.706234    0.720403    0.690886    0.659014    2600        10.642317   0.740724    0.168824    174.719525 
[37m[36mINFO[0m[0m 02/18 02:58:52 | 0.466555    0.486389    0.780464    0.768842    0.650157    0.870815    0.854430    0.466555    0.486389    0.736776    0.755668    0.733801    0.696429    2800        11.460957   0.708027    0.211336    163.510520 
[37m[36mINFO[0m[0m 02/18 03:02:39 | 0.279497    0.284540    0.780792    0.774941    0.644106    0.869760    0.867089    0.279497    0.284540    0.743703    0.746851    0.728914    0.710884    3000        12.279597   0.674078    0.258219    175.199847 
[37m[36mINFO[0m[0m 02/18 03:06:22 | 0.293362    0.301489    0.796225    0.783951    0.603248    0.879515    0.866034    0.293362    0.301489    0.769836    0.778338    0.739324    0.707483    3200        13.098237   0.667385    0.253939    172.580040 
[37m[36mINFO[0m[0m 02/18 03:10:04 | 0.377455    0.374422    0.802250    0.797482    0.575334    0.889533    0.872363    0.377455    0.374422    0.762594    0.792191    0.754621    0.727891    3400        13.916877   0.649634    0.209271    179.889507 
[37m[36mINFO[0m[0m 02/18 03:13:40 | 0.371678    0.373395    0.792718    0.783994    0.592373    0.895070    0.876582    0.371678    0.373395    0.747796    0.761965    0.735288    0.713435    3600        14.735516   0.607002    0.189459    178.119182 
[37m[36mINFO[0m[0m 02/18 03:17:16 | 0.372063    0.387776    0.813901    0.808698    0.549411    0.898761    0.894515    0.372063    0.387776    0.778338    0.790932    0.764606    0.740646    3800        15.554156   0.596067    0.211274    173.583073 
[37m[36mINFO[0m[0m 02/18 03:20:52 | 0.361921    0.387262    0.801628    0.782986    0.639827    0.895334    0.887131    0.361921    0.387262    0.763854    0.759446    0.745698    0.702381    4000        16.372796   0.575210    0.200309    176.099454 
[37m[36mINFO[0m[0m 02/18 03:24:36 | 0.362948    0.383667    0.823009    0.809408    0.524271    0.902716    0.874473    0.362948    0.383667    0.778338    0.785894    0.787975    0.767857    4200        17.191436   0.575703    0.224261    179.081842 
[37m[36mINFO[0m[0m 02/18 03:28:27 | 0.481833    0.494607    0.815371    0.813861    0.568799    0.892433    0.869198    0.481833    0.494607    0.786524    0.824937    0.767155    0.747449    4400        18.010076   0.570899    0.233508    184.889576 
[37m[36mINFO[0m[0m 02/18 03:32:04 | 0.414302    0.426297    0.808527    0.798623    0.625151    0.879515    0.858650    0.414302    0.426297    0.774874    0.782116    0.771192    0.755102    4600        18.828715   0.566206    0.204759    175.216147 
[37m[36mINFO[0m[0m 02/18 03:35:37 | 0.389909    0.389317    0.828796    0.813674    0.542585    0.902452    0.892405    0.389909    0.389317    0.796599    0.788413    0.787338    0.760204    4800        19.647355   0.529544    0.159814    181.491146 
[37m[36mINFO[0m[0m 02/18 03:39:12 | 0.316472    0.327684    0.815659    0.807582    0.564568    0.886370    0.882911    0.316472    0.327684    0.775819    0.777078    0.784789    0.762755    5000        20.465995   0.528592    0.179297    178.970325 
[37m[36mINFO[0m[0m 02/18 03:39:12 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[1]/250218_02-05-41_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/18 03:39:13 | ---
[37m[36mINFO[0m[0m 02/18 03:39:13 | test-domain validation(oracle) = 48.183%
[37m[36mINFO[0m[0m 02/18 03:39:13 | training-domain validation(iid) = 48.183%
[37m[36mINFO[0m[0m 02/18 03:39:13 | last = 31.647%
[37m[36mINFO[0m[0m 02/18 03:39:13 | last (inD) = 80.758%
[37m[36mINFO[0m[0m 02/18 03:39:13 | training-domain validation (iid, inD) = 81.386%
[37m[36mINFO[0m[0m 02/18 03:39:14 | === Summary ===
[37m[36mINFO[0m[0m 02/18 03:39:14 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 1 --dataset TerraIncognita --trial_seed 1 --hparams_seed 1
[37m[36mINFO[0m[0m 02/18 03:39:14 | Unique name: 250218_02-05-41_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 03:39:14 | Out path: train_output/TerraIncognita/RSC/[1]/250218_02-05-41_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 03:39:14 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/18 03:39:14 | Dataset: TerraIncognita

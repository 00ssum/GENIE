[37m[36mINFO[0m[0m 02/18 16:05:10 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 1 --dataset TerraIncognita --trial_seed 1 --hparams_seed 10
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 10
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[1]/250218_16-05-10_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250218_16-05-10_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.2128485336217652e-05
	batch_size: 9
	weight_decay: 0.00030907441430549757
	rsc_f_drop_factor: 0.11930737869274544
	rsc_b_drop_factor: 0.16188382214285657
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/18 16:05:10 | n_steps = 5001
[37m[36mINFO[0m[0m 02/18 16:05:10 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/18 16:05:10 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/18 16:05:10 | 
[37m[36mINFO[0m[0m 02/18 16:05:11 | Testenv name escaping te_L38 -> te_L38
[37m[36mINFO[0m[0m 02/18 16:05:11 | Test envs = [1], name = te_L38
[37m[36mINFO[0m[0m 02/18 16:05:11 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 02/18 16:05:11 | Batch sizes for each domain: [9, 0, 9, 9] (total=27)
[37m[36mINFO[0m[0m 02/18 16:05:11 | steps-per-epoch for each domain: 421.44, 352.89, 523.00 -> min = 352.89
[37m[36mINFO[0m[0m 02/18 16:05:12 | # of params = 23528522
[37m[36mINFO[0m[0m 02/18 16:08:12 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/18 16:08:12 | 0.019515    0.022085    0.284236    0.283431    2.083699    0.516214    0.541139    0.019515    0.022085    0.098552    0.095718    0.237943    0.213435    0           0.000000    2.817549    1.137103    178.168570 
[37m[36mINFO[0m[0m 02/18 16:11:46 | 0.019900    0.022599    0.406096    0.442540    1.478960    0.524914    0.550633    0.019900    0.022599    0.347292    0.384131    0.346080    0.392857    200         0.566751    1.763474    0.188949    177.076791 
[37m[36mINFO[0m[0m 02/18 16:15:17 | 0.173707    0.178223    0.480007    0.498764    1.382673    0.616399    0.627637    0.173707    0.178223    0.398300    0.430730    0.425324    0.437925    400         1.133501    1.543906    0.191146    172.834870 
[37m[36mINFO[0m[0m 02/18 16:18:51 | 0.297342    0.288136    0.491397    0.509448    1.332712    0.662536    0.677215    0.297342    0.288136    0.351700    0.371537    0.459953    0.479592    600         1.700252    1.458958    0.166125    180.549102 
[37m[36mINFO[0m[0m 02/18 16:22:32 | 0.178328    0.173600    0.492503    0.514632    1.316375    0.688637    0.715190    0.178328    0.173600    0.346977    0.362720    0.441895    0.465986    800         2.267003    1.413068    0.167250    186.942262 
[37m[36mINFO[0m[0m 02/18 16:26:13 | 0.259212    0.246533    0.522249    0.536007    1.258464    0.696283    0.705696    0.259212    0.246533    0.416247    0.424433    0.454217    0.477891    1000        2.833753    1.400011    0.166391    188.157664 
[37m[36mINFO[0m[0m 02/18 16:29:49 | 0.326486    0.316384    0.505994    0.499639    1.248000    0.707356    0.717300    0.326486    0.316384    0.401448    0.387909    0.409178    0.393707    1200        3.400504    1.366331    0.170288    182.249489 
[37m[36mINFO[0m[0m 02/18 16:33:30 | 0.381692    0.360555    0.547238    0.562294    1.182908    0.696019    0.700422    0.381692    0.360555    0.475756    0.494962    0.469938    0.491497    1400        3.967254    1.321888    0.201658    180.576020 
[37m[36mINFO[0m[0m 02/18 16:37:10 | 0.136860    0.140216    0.574484    0.578857    1.152220    0.696283    0.670886    0.136860    0.140216    0.528338    0.550378    0.498832    0.515306    1600        4.534005    1.257485    0.184607    182.832141 
[37m[36mINFO[0m[0m 02/18 16:40:43 | 0.106817    0.102722    0.629403    0.628504    1.050611    0.763248    0.753165    0.106817    0.102722    0.575567    0.590680    0.549395    0.541667    1800        5.100756    1.221486    0.175680    177.433275 
[37m[36mINFO[0m[0m 02/18 16:44:12 | 0.081782    0.089882    0.645839    0.637865    0.969637    0.798313    0.793249    0.081782    0.089882    0.574937    0.598237    0.564266    0.522109    2000        5.667506    1.058305    0.208313    167.851463 
[37m[36mINFO[0m[0m 02/18 16:47:39 | 0.248042    0.252696    0.683946    0.700429    0.815631    0.824413    0.819620    0.248042    0.252696    0.614295    0.683879    0.613129    0.597789    2200        6.234257    0.991766    0.193748    168.042097 
[37m[36mINFO[0m[0m 02/18 16:51:10 | 0.292207    0.291731    0.663805    0.659723    0.900666    0.815186    0.809072    0.292207    0.291731    0.605164    0.630982    0.571064    0.539116    2400        6.801008    0.941251    0.187848    173.441188 
[37m[36mINFO[0m[0m 02/18 16:54:48 | 0.218128    0.225989    0.702992    0.707899    0.792120    0.796204    0.818565    0.218128    0.225989    0.653967    0.677582    0.658806    0.627551    2600        7.367758    0.896949    0.163263    185.661206 
[37m[36mINFO[0m[0m 02/18 16:58:19 | 0.258698    0.274268    0.738892    0.731868    0.748548    0.848669    0.828059    0.258698    0.274268    0.689232    0.717884    0.678776    0.649660    2800        7.934509    0.842477    0.172836    176.018072 
[37m[36mINFO[0m[0m 02/18 17:01:59 | 0.430094    0.432460    0.702115    0.707096    0.863858    0.804113    0.804852    0.430094    0.432460    0.664673    0.691436    0.637561    0.625000    3000        8.501259    0.787940    0.176247    184.828244 
[37m[36mINFO[0m[0m 02/18 17:05:35 | 0.315573    0.335901    0.741838    0.746471    0.728668    0.854996    0.843882    0.315573    0.335901    0.710013    0.756927    0.660506    0.638605    3200        9.068010    0.796302    0.175142    181.466877 
[37m[36mINFO[0m[0m 02/18 17:09:06 | 0.233920    0.236261    0.748267    0.758498    0.691489    0.862642    0.857595    0.233920    0.236261    0.696159    0.736776    0.686000    0.681122    3400        9.634761    0.781304    0.197240    171.409492 
[37m[36mINFO[0m[0m 02/18 17:12:34 | 0.248299    0.263996    0.758192    0.758114    0.671004    0.854732    0.860759    0.248299    0.263996    0.706864    0.741814    0.712981    0.671769    3600        10.201511   0.765310    0.192256    169.583707 
[37m[36mINFO[0m[0m 02/18 17:16:14 | 0.321864    0.340524    0.744673    0.732520    0.692884    0.874769    0.857595    0.321864    0.340524    0.666877    0.680101    0.692373    0.659864    3800        10.768262   0.712360    0.204410    178.714782 
[37m[36mINFO[0m[0m 02/18 17:19:48 | 0.326614    0.329738    0.774464    0.764318    0.632520    0.885315    0.867089    0.326614    0.329738    0.727645    0.745592    0.710431    0.680272    4000        11.335013   0.709354    0.189764    176.524612 
[37m[36mINFO[0m[0m 02/18 17:23:18 | 0.261651    0.269132    0.793943    0.795907    0.587525    0.878724    0.882911    0.261651    0.269132    0.761020    0.789673    0.742086    0.715136    4200        11.901763   0.674293    0.157810    178.164210 
[37m[36mINFO[0m[0m 02/18 17:26:52 | 0.383746    0.405239    0.792690    0.798658    0.590334    0.879515    0.878692    0.383746    0.405239    0.750945    0.778338    0.747610    0.738946    4400        12.468514   0.667032    0.203583    172.758068 
[37m[36mINFO[0m[0m 02/18 17:30:25 | 0.321736    0.329224    0.792559    0.794123    0.607710    0.877933    0.863924    0.321736    0.329224    0.757872    0.787154    0.741874    0.731293    4600        13.035264   0.635247    0.191723    174.956799 
[37m[36mINFO[0m[0m 02/18 17:33:55 | 0.364360    0.371854    0.805259    0.796789    0.561384    0.899025    0.870253    0.364360    0.371854    0.765743    0.789673    0.751009    0.730442    4800        13.602015   0.636514    0.169016    175.985086 
[37m[36mINFO[0m[0m 02/18 17:37:28 | 0.366543    0.376477    0.789116    0.788056    0.602877    0.879515    0.863924    0.366543    0.376477    0.741499    0.780856    0.746335    0.719388    5000        14.168766   0.610542    0.166774    180.328894 
[37m[36mINFO[0m[0m 02/18 17:37:29 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[1]/250218_16-05-10_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/18 17:37:30 | ---
[37m[36mINFO[0m[0m 02/18 17:37:30 | test-domain validation(oracle) = 43.009%
[37m[36mINFO[0m[0m 02/18 17:37:30 | training-domain validation(iid) = 38.375%
[37m[36mINFO[0m[0m 02/18 17:37:30 | last = 36.654%
[37m[36mINFO[0m[0m 02/18 17:37:30 | last (inD) = 78.806%
[37m[36mINFO[0m[0m 02/18 17:37:30 | training-domain validation (iid, inD) = 79.866%
[37m[36mINFO[0m[0m 02/18 17:37:30 | === Summary ===
[37m[36mINFO[0m[0m 02/18 17:37:30 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 1 --dataset TerraIncognita --trial_seed 1 --hparams_seed 10
[37m[36mINFO[0m[0m 02/18 17:37:30 | Unique name: 250218_16-05-10_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 17:37:30 | Out path: train_output/TerraIncognita/RSC/[1]/250218_16-05-10_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 17:37:30 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/18 17:37:30 | Dataset: TerraIncognita

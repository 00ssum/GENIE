[37m[36mINFO[0m[0m 02/18 12:37:24 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 1 --dataset TerraIncognita --trial_seed 1 --hparams_seed 8
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 8
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[1]/250218_12-37-24_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 1
	unique_name: 250218_12-37-24_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 3.335053008064847e-05
	batch_size: 18
	weight_decay: 0.00011109601170966198
	rsc_f_drop_factor: 0.18129063791925754
	rsc_b_drop_factor: 0.03567706337646076
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/18 12:37:24 | n_steps = 5001
[37m[36mINFO[0m[0m 02/18 12:37:24 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/18 12:37:24 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/18 12:37:24 | 
[37m[36mINFO[0m[0m 02/18 12:37:24 | Testenv name escaping te_L38 -> te_L38
[37m[36mINFO[0m[0m 02/18 12:37:24 | Test envs = [1], name = te_L38
[37m[36mINFO[0m[0m 02/18 12:37:24 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 02/18 12:37:24 | Batch sizes for each domain: [18, 0, 18, 18] (total=54)
[37m[36mINFO[0m[0m 02/18 12:37:24 | steps-per-epoch for each domain: 210.72, 176.44, 261.50 -> min = 176.44
[37m[36mINFO[0m[0m 02/18 12:37:25 | # of params = 23528522
[37m[36mINFO[0m[0m 02/18 12:40:20 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/18 12:40:20 | 0.020157    0.023112    0.281367    0.283861    2.064489    0.516741    0.541139    0.020157    0.023112    0.098552    0.094458    0.228808    0.215986    0           0.000000    2.523756    0.990107    174.089538 
[37m[36mINFO[0m[0m 02/18 12:43:55 | 0.033124    0.039548    0.463938    0.444549    1.342956    0.607435    0.606540    0.033124    0.039548    0.384761    0.361461    0.399618    0.365646    200         1.133501    1.571513    0.177042    179.276460 
[37m[36mINFO[0m[0m 02/18 12:47:54 | 0.044678    0.048279    0.557838    0.566076    1.243743    0.716847    0.726793    0.044678    0.048279    0.490554    0.506297    0.466114    0.465136    400         2.267003    1.345397    0.220849    194.898900 
[37m[36mINFO[0m[0m 02/18 12:51:33 | 0.062267    0.066256    0.638803    0.639867    0.994170    0.780121    0.785865    0.062267    0.066256    0.587531    0.581864    0.548757    0.551871    600         3.400504    1.180392    0.198651    178.915433 
[37m[36mINFO[0m[0m 02/18 12:55:16 | 0.265503    0.282486    0.699185    0.695524    0.851845    0.824941    0.818565    0.265503    0.282486    0.636965    0.654912    0.635649    0.613095    800         4.534005    0.973318    0.195020    184.415147 
[37m[36mINFO[0m[0m 02/18 12:59:08 | 0.436513    0.435542    0.726317    0.732812    0.757827    0.809122    0.787975    0.436513    0.435542    0.696788    0.753149    0.673040    0.657313    1000        5.667506    0.848223    0.247239    182.372558 
[37m[36mINFO[0m[0m 02/18 13:02:48 | 0.318398    0.325629    0.754310    0.747486    0.699428    0.868969    0.853376    0.318398    0.325629    0.695214    0.729219    0.698747    0.659864    1200        6.801008    0.751109    0.228150    174.688085 
[37m[36mINFO[0m[0m 02/18 13:06:44 | 0.390037    0.388803    0.775416    0.769015    0.667607    0.865278    0.849156    0.390037    0.388803    0.740554    0.768262    0.720416    0.689626    1400        7.934509    0.690644    0.286475    178.697105 
[37m[36mINFO[0m[0m 02/18 13:10:30 | 0.404545    0.414997    0.791795    0.772043    0.627662    0.883470    0.871308    0.404545    0.414997    0.755353    0.759446    0.736563    0.685374    1600        9.068010    0.625240    0.240248    177.631201 
[37m[36mINFO[0m[0m 02/18 13:14:06 | 0.158814    0.166923    0.788376    0.786613    0.602350    0.870287    0.867089    0.158814    0.166923    0.750630    0.768262    0.744211    0.724490    1800        10.201511   0.576185    0.221028    172.074314 
[37m[36mINFO[0m[0m 02/18 13:18:09 | 0.314546    0.318952    0.815312    0.808551    0.535725    0.886897    0.879747    0.314546    0.318952    0.791247    0.801008    0.767793    0.744898    2000        11.335013   0.562468    0.252258    191.926300 
[37m[36mINFO[0m[0m 02/18 13:21:51 | 0.357684    0.361582    0.810866    0.806531    0.572448    0.889797    0.878692    0.357684    0.361582    0.772670    0.793451    0.770130    0.747449    2200        12.468514   0.548066    0.206667    181.331928 
[37m[36mINFO[0m[0m 02/18 13:25:58 | 0.369110    0.374422    0.833365    0.819856    0.507465    0.912470    0.886076    0.369110    0.374422    0.790302    0.804786    0.797323    0.768707    2400        13.602015   0.549869    0.251060    196.215425 
[37m[36mINFO[0m[0m 02/18 13:30:04 | 0.371550    0.391885    0.830664    0.825235    0.502128    0.903506    0.889241    0.371550    0.391885    0.798174    0.821159    0.790312    0.765306    2600        14.735516   0.498629    0.307681    184.673940 
[37m[36mINFO[0m[0m 02/18 13:33:58 | 0.237386    0.228557    0.832365    0.823340    0.508711    0.915898    0.898734    0.237386    0.228557    0.794710    0.811083    0.786488    0.760204    2800        15.869018   0.491938    0.269847    179.541084 
[37m[36mINFO[0m[0m 02/18 13:38:03 | 0.369752    0.364150    0.828782    0.823782    0.488409    0.878988    0.864979    0.369752    0.364150    0.809824    0.827456    0.797536    0.778912    3000        17.002519   0.469848    0.292631    187.384082 
[37m[36mINFO[0m[0m 02/18 13:41:52 | 0.415329    0.425783    0.843211    0.833968    0.478704    0.916425    0.897679    0.415329    0.425783    0.818010    0.828715    0.795199    0.775510    3200        18.136020   0.464751    0.206413    187.055151 
[37m[36mINFO[0m[0m 02/18 13:45:46 | 0.472076    0.482280    0.864236    0.841920    0.471885    0.924071    0.883966    0.472076    0.482280    0.846033    0.850126    0.822605    0.791667    3400        19.269521   0.432111    0.197050    194.674606 
[37m[36mINFO[0m[0m 02/18 13:49:43 | 0.375273    0.370827    0.842730    0.833355    0.458297    0.910361    0.898734    0.375273    0.370827    0.822418    0.822418    0.795411    0.778912    3600        20.403023   0.425160    0.230963    190.414230 
[37m[36mINFO[0m[0m 02/18 13:53:40 | 0.510207    0.507961    0.840832    0.827718    0.532130    0.907725    0.883966    0.510207    0.507961    0.811713    0.823678    0.803059    0.775510    3800        21.536524   0.403758    0.220151    193.925726 
[37m[36mINFO[0m[0m 02/18 13:57:28 | 0.403004    0.418079    0.857145    0.837858    0.482844    0.905879    0.890295    0.403004    0.418079    0.854849    0.835013    0.810707    0.788265    4000        22.670025   0.401459    0.203008    187.005144 
[37m[36mINFO[0m[0m 02/18 14:01:30 | 0.447939    0.449923    0.869607    0.841934    0.425126    0.933035    0.887131    0.447939    0.449923    0.860831    0.861461    0.814956    0.777211    4200        23.803526   0.405541    0.204668    201.035100 
[37m[36mINFO[0m[0m 02/18 14:05:24 | 0.393504    0.400616    0.868951    0.853996    0.417853    0.934880    0.925105    0.393504    0.400616    0.842569    0.835013    0.829403    0.801871    4400        24.937028   0.385779    0.228164    187.968636 
[37m[36mINFO[0m[0m 02/18 14:09:12 | 0.463731    0.473035    0.873574    0.860897    0.403148    0.935407    0.917722    0.463731    0.473035    0.854849    0.866499    0.830465    0.798469    4600        26.070529   0.374030    0.238874    180.727289 
[37m[36mINFO[0m[0m 02/18 14:13:00 | 0.401592    0.397021    0.872496    0.857255    0.430957    0.936989    0.919831    0.401592    0.397021    0.857683    0.855164    0.822817    0.796769    4800        27.204030   0.362372    0.255695    177.079996 
[37m[36mINFO[0m[0m 02/18 14:17:16 | 0.276672    0.272727    0.882630    0.858152    0.411508    0.929344    0.910338    0.276672    0.272727    0.882557    0.866499    0.835989    0.797619    5000        28.337531   0.356612    0.309403    194.040985 
[37m[36mINFO[0m[0m 02/18 14:17:16 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[1]/250218_12-37-24_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/18 14:17:18 | ---
[37m[36mINFO[0m[0m 02/18 14:17:18 | test-domain validation(oracle) = 51.021%
[37m[36mINFO[0m[0m 02/18 14:17:18 | training-domain validation(iid) = 46.373%
[37m[36mINFO[0m[0m 02/18 14:17:18 | last = 27.667%
[37m[36mINFO[0m[0m 02/18 14:17:18 | last (inD) = 85.815%
[37m[36mINFO[0m[0m 02/18 14:17:18 | training-domain validation (iid, inD) = 86.090%
[37m[36mINFO[0m[0m 02/18 14:17:18 | === Summary ===
[37m[36mINFO[0m[0m 02/18 14:17:18 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 1 --dataset TerraIncognita --trial_seed 1 --hparams_seed 8
[37m[36mINFO[0m[0m 02/18 14:17:18 | Unique name: 250218_12-37-24_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 14:17:18 | Out path: train_output/TerraIncognita/RSC/[1]/250218_12-37-24_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 14:17:18 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/18 14:17:18 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 02/18 16:28:58 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 1 --dataset TerraIncognita --trial_seed 0 --hparams_seed 0
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[1]/250218_16-28-58_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250218_16-28-58_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	rsc_f_drop_factor: 0.3333333333333333
	rsc_b_drop_factor: 0.3333333333333333
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/18 16:28:58 | n_steps = 5001
[37m[36mINFO[0m[0m 02/18 16:28:58 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/18 16:28:58 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/18 16:28:58 | 
[37m[36mINFO[0m[0m 02/18 16:28:58 | Testenv name escaping te_L38 -> te_L38
[37m[36mINFO[0m[0m 02/18 16:28:58 | Test envs = [1], name = te_L38
[37m[36mINFO[0m[0m 02/18 16:28:58 | Train environments: [0, 2, 3], Test environments: [1]
[37m[36mINFO[0m[0m 02/18 16:28:58 | Batch sizes for each domain: [32, 0, 32, 32] (total=96)
[37m[36mINFO[0m[0m 02/18 16:28:58 | steps-per-epoch for each domain: 118.53, 99.25, 147.09 -> min = 99.25
[37m[36mINFO[0m[0m 02/18 16:28:59 | # of params = 23528522
[37m[36mINFO[0m[0m 02/18 16:32:08 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/18 16:32:08 | 0.019258    0.023112    0.284922    0.289972    2.152593    0.522278    0.520042    0.019258    0.023112    0.096033    0.103275    0.236456    0.246599    0           0.000000    3.627316    1.192338    187.120996 
[37m[36mINFO[0m[0m 02/18 16:36:12 | 0.047631    0.046739    0.391606    0.398930    1.634489    0.592407    0.584388    0.047631    0.046739    0.264798    0.254408    0.317612    0.357993    200         2.015113    2.014127    0.302905    183.543114 
[37m[36mINFO[0m[0m 02/18 16:40:16 | 0.039800    0.040575    0.403417    0.403741    1.486031    0.601898    0.595992    0.039800    0.040575    0.262909    0.265743    0.345443    0.349490    400         4.030227    1.837507    0.327075    179.270129 
[37m[36mINFO[0m[0m 02/18 16:44:31 | 0.039158    0.046739    0.465393    0.468757    1.386843    0.605589    0.595992    0.039158    0.046739    0.371851    0.374055    0.418738    0.436224    600         6.045340    1.709838    0.362253    181.753293 
[37m[36mINFO[0m[0m 02/18 16:48:38 | 0.041726    0.041602    0.449882    0.460024    1.390869    0.603480    0.591772    0.041726    0.041602    0.338476    0.363980    0.407691    0.424320    800         8.060453    1.687830    0.336124    180.298119 
[37m[36mINFO[0m[0m 02/18 16:52:32 | 0.050841    0.055470    0.441705    0.418367    1.379793    0.594516    0.580169    0.050841    0.055470    0.369647    0.318640    0.360952    0.356293    1000        10.075567   1.639457    0.299698    173.921361 
[37m[36mINFO[0m[0m 02/18 16:56:28 | 0.041084    0.041602    0.443547    0.427017    1.323696    0.601371    0.592827    0.041084    0.041602    0.347922    0.309824    0.381347    0.378401    1200        12.090680   1.609834    0.331104    169.547039 
[37m[36mINFO[0m[0m 02/18 17:00:24 | 0.025164    0.026194    0.496699    0.491724    1.265627    0.610862    0.591772    0.025164    0.026194    0.411209    0.408060    0.468026    0.475340    1400        14.105793   1.584762    0.329237    170.323663 
[37m[36mINFO[0m[0m 02/18 17:04:28 | 0.022468    0.025167    0.506063    0.490914    1.248382    0.634854    0.602321    0.022468    0.025167    0.432305    0.425693    0.451030    0.444728    1600        16.120907   1.550437    0.337298    177.146333 
[37m[36mINFO[0m[0m 02/18 17:08:23 | 0.024393    0.031330    0.538589    0.541957    1.152262    0.662273    0.665612    0.024393    0.031330    0.463161    0.482368    0.490334    0.477891    1800        18.136020   1.525857    0.305428    173.043948 
[37m[36mINFO[0m[0m 02/18 17:12:22 | 0.041469    0.048793    0.636159    0.639055    1.021886    0.768257    0.774262    0.041469    0.048793    0.561083    0.562972    0.579137    0.579932    2000        20.151134   1.456876    0.313206    176.566302 
[37m[36mINFO[0m[0m 02/18 17:16:30 | 0.032867    0.040062    0.660753    0.659748    0.963936    0.786976    0.785865    0.032867    0.040062    0.601700    0.605793    0.593584    0.587585    2200        22.166247   1.377410    0.343499    179.803683 
[37m[36mINFO[0m[0m 02/18 17:20:35 | 0.139042    0.146379    0.658241    0.658427    0.965614    0.815450    0.813291    0.139042    0.146379    0.566751    0.566751    0.592522    0.595238    2400        24.181360   1.326210    0.340154    176.787760 
[37m[36mINFO[0m[0m 02/18 17:24:40 | 0.166388    0.183359    0.649644    0.648958    0.889160    0.777485    0.781646    0.166388    0.183359    0.596348    0.579345    0.575101    0.585884    2600        26.196474   1.319596    0.313922    181.812484 
[37m[36mINFO[0m[0m 02/18 17:28:41 | 0.102709    0.118130    0.666194    0.657551    0.847756    0.833641    0.831224    0.102709    0.118130    0.554786    0.545340    0.610155    0.596088    2800        28.211587   1.217960    0.317984    177.377461 
[37m[36mINFO[0m[0m 02/18 17:32:40 | 0.213635    0.227016    0.683596    0.694178    0.834321    0.823095    0.823840    0.213635    0.227016    0.618388    0.618388    0.609305    0.640306    3000        30.226700   1.190303    0.292466    181.083592 
[37m[36mINFO[0m[0m 02/18 17:36:38 | 0.260624    0.274782    0.672208    0.683744    0.829058    0.832850    0.844937    0.260624    0.274782    0.587217    0.593199    0.596558    0.613095    3200        32.241814   1.203989    0.304262    176.378241 
[37m[36mINFO[0m[0m 02/18 17:40:31 | 0.245218    0.257833    0.700511    0.700292    0.825105    0.812813    0.797468    0.245218    0.257833    0.631612    0.646096    0.657106    0.657313    3400        34.256927   1.160653    0.335113    166.665566 
[37m[36mINFO[0m[0m 02/18 17:44:47 | 0.263192    0.272727    0.667303    0.658196    0.805300    0.840232    0.840717    0.263192    0.272727    0.561083    0.537783    0.600595    0.596088    3600        36.272040   1.140450    0.423145    171.338260 
[37m[36mINFO[0m[0m 02/18 17:48:58 | 0.110412    0.118644    0.731513    0.737608    0.729792    0.816768    0.816456    0.110412    0.118644    0.681360    0.691436    0.696410    0.704932    3800        38.287154   1.083320    0.376521    175.657582 
[37m[36mINFO[0m[0m 02/18 17:52:59 | 0.289896    0.298408    0.739622    0.739570    0.722053    0.841550    0.835443    0.289896    0.298408    0.683879    0.685139    0.693435    0.698129    4000        40.302267   1.081190    0.329719    175.266357 
[37m[36mINFO[0m[0m 02/18 17:57:09 | 0.143921    0.149974    0.683870    0.686608    0.838535    0.812286    0.811181    0.143921    0.149974    0.622796    0.639798    0.616529    0.608844    4200        42.317380   1.050008    0.330765    182.929349 
[37m[36mINFO[0m[0m 02/18 18:01:02 | 0.056362    0.058038    0.722622    0.730192    0.772167    0.786712    0.790084    0.056362    0.058038    0.682620    0.701511    0.698534    0.698980    4400        44.332494   1.055373    0.318339    169.450015 
[37m[36mINFO[0m[0m 02/18 18:05:02 | 0.179484    0.194145    0.773551    0.773395    0.672262    0.841814    0.847046    0.179484    0.194145    0.756297    0.739295    0.722541    0.733844    4600        46.347607   1.033541    0.367202    166.450762 
[37m[36mINFO[0m[0m 02/18 18:09:07 | 0.218898    0.227530    0.782910    0.781802    0.624702    0.853941    0.859705    0.218898    0.227530    0.755038    0.754408    0.739749    0.731293    4800        48.362720   0.990774    0.393117    166.972919 
[37m[36mINFO[0m[0m 02/18 18:13:16 | 0.342406    0.358500    0.780213    0.768702    0.686763    0.872660    0.840717    0.342406    0.358500    0.758186    0.746851    0.709794    0.718537    5000        50.377834   0.966306    0.379634    172.819880 
[37m[36mINFO[0m[0m 02/18 18:13:16 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[1]/250218_16-28-58_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/18 18:13:18 | ---
[37m[36mINFO[0m[0m 02/18 18:13:18 | test-domain validation(oracle) = 34.241%
[37m[36mINFO[0m[0m 02/18 18:13:18 | training-domain validation(iid) = 21.890%
[37m[36mINFO[0m[0m 02/18 18:13:18 | last = 34.241%
[37m[36mINFO[0m[0m 02/18 18:13:18 | last (inD) = 76.870%
[37m[36mINFO[0m[0m 02/18 18:13:18 | training-domain validation (iid, inD) = 78.180%
[37m[36mINFO[0m[0m 02/18 18:13:18 | === Summary ===
[37m[36mINFO[0m[0m 02/18 18:13:18 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 1 --dataset TerraIncognita --trial_seed 0 --hparams_seed 0
[37m[36mINFO[0m[0m 02/18 18:13:18 | Unique name: 250218_16-28-58_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 18:13:18 | Out path: train_output/TerraIncognita/RSC/[1]/250218_16-28-58_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 18:13:18 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/18 18:13:18 | Dataset: TerraIncognita

[37m[36mINFO[0m[0m 01/31 04:48:49 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm RSC --test_envs 1 --dataset TerraIncognita --trial_seed 0 --hparams_seed 19
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 19
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/TerraIncognita/RSC/[1]/250131_04-48-49_resnet50_EVE
	out_root: train_output/TerraIncognita/RSC/[1]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [1]
	trial_seed: 0
	unique_name: 250131_04-48-49_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: EVE
	freeze_bn: False
	pretrained: True
	lr: 5.513854977685438e-05
	batch_size: 27
	weight_decay: 0.0014556716107047517
	rsc_f_drop_factor: 0.4585839564743606
	rsc_b_drop_factor: 0.22347318786657766
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/31 04:48:49 | n_steps = 5001
[37m[36mINFO[0m[0m 01/31 04:48:49 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/31 04:48:49 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/31 04:48:49 | Target test envs = [[1]]
[37m[36mINFO[0m[0m 01/31 04:48:49 | 
[37m[36mINFO[0m[0m 01/31 04:48:49 | Testenv name escaping te_L38 -> te_L38
[37m[36mINFO[0m[0m 01/31 04:48:49 | Test envs = [1], name = te_L38
[37m[36mINFO[0m[0m 01/31 04:48:49 | Batch sizes for each domain: [27, 0, 27, 27] (total=81)
[37m[36mINFO[0m[0m 01/31 04:48:49 | steps-per-epoch for each domain: 140.48, 117.63, 174.33 -> min = 117.63
[37m[36mINFO[0m[0m 01/31 04:48:50 | # of params = 23528522
[37m[36mINFO[0m[0m 01/31 04:51:44 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/31 04:51:44 | 0.019258    0.023112    0.284710    0.289972    2.130851    0.522278    0.520042    0.019258    0.023112    0.096033    0.103275    0.235819    0.246599    0           0.000000    3.310236    1.396729    172.391600 
[37m[36mINFO[0m[0m 01/31 04:55:30 | 0.044678    0.045198    0.386861    0.403447    1.577261    0.586871    0.591772    0.044678    0.045198    0.272670    0.270781    0.301041    0.347789    200         1.700252    1.923011    0.274431    171.602794 
[37m[36mINFO[0m[0m 01/31 04:59:21 | 0.042367    0.041089    0.449181    0.454908    1.460922    0.617980    0.619198    0.042367    0.041089    0.376259    0.384131    0.353304    0.361395    400         3.400504    1.749514    0.305237    169.424995 
[37m[36mINFO[0m[0m 01/31 05:03:18 | 0.035178    0.037494    0.467954    0.480698    1.376951    0.603744    0.588608    0.035178    0.037494    0.374370    0.386650    0.425749    0.466837    600         5.100756    1.660719    0.322143    171.708184 
[37m[36mINFO[0m[0m 01/31 05:07:24 | 0.062524    0.068310    0.478276    0.493350    1.359202    0.614289    0.602321    0.062524    0.068310    0.398615    0.419395    0.421925    0.458333    800         6.801008    1.615010    0.397421    166.540863 
[37m[36mINFO[0m[0m 01/31 05:11:29 | 0.044678    0.047766    0.514477    0.516529    1.306844    0.624835    0.618143    0.044678    0.047766    0.476700    0.474811    0.441895    0.456633    1000        8.501259    1.590611    0.380155    168.031086 
[37m[36mINFO[0m[0m 01/31 05:15:16 | 0.064835    0.060092    0.499711    0.493932    1.303788    0.601635    0.590717    0.064835    0.060092    0.455605    0.439547    0.441895    0.451531    1200        10.201511   1.564110    0.320365    162.782596 
[37m[36mINFO[0m[0m 01/31 05:19:07 | 0.058929    0.058038    0.524907    0.519801    1.233579    0.654627    0.644515    0.058929    0.058038    0.449307    0.439547    0.470788    0.475340    1400        11.901763   1.531823    0.328623    164.947500 
[37m[36mINFO[0m[0m 01/31 05:22:57 | 0.065477    0.069337    0.596687    0.595874    1.150329    0.738202    0.735232    0.065477    0.069337    0.542191    0.559194    0.509666    0.493197    1600        13.602015   1.507782    0.332670    163.890896 
[37m[36mINFO[0m[0m 01/31 05:26:46 | 0.066119    0.070365    0.631263    0.637305    1.055468    0.763248    0.760549    0.066119    0.070365    0.597292    0.599496    0.533248    0.551871    1800        15.302267   1.440042    0.306251    167.277781 
[37m[36mINFO[0m[0m 01/31 05:30:49 | 0.071383    0.070878    0.684081    0.680285    0.878092    0.819668    0.810127    0.071383    0.070878    0.627519    0.610831    0.605056    0.619898    2000        17.002519   1.319450    0.375718    166.710730 
[37m[36mINFO[0m[0m 01/31 05:34:40 | 0.115291    0.121212    0.709148    0.710551    0.779645    0.806486    0.809072    0.115291    0.121212    0.679786    0.676322    0.641173    0.646259    2200        18.702771   1.262146    0.316779    167.489678 
[37m[36mINFO[0m[0m 01/31 05:38:34 | 0.231352    0.241911    0.743237    0.750396    0.730468    0.837332    0.834388    0.231352    0.241911    0.711902    0.722922    0.680476    0.693878    2400        20.403023   1.221846    0.321317    169.308709 
[37m[36mINFO[0m[0m 01/31 05:42:19 | 0.307357    0.327684    0.768268    0.763485    0.681207    0.867651    0.847046    0.307357    0.327684    0.742443    0.736776    0.694710    0.706633    2600        22.103275   1.158594    0.319434    161.185273 
[37m[36mINFO[0m[0m 01/31 05:46:31 | 0.324817    0.340010    0.788500    0.793226    0.599831    0.882151    0.873418    0.324817    0.340010    0.761020    0.775819    0.722328    0.730442    2800        23.803526   1.098256    0.387324    174.216362 
[37m[36mINFO[0m[0m 01/31 05:50:45 | 0.315445    0.326656    0.773540    0.763538    0.650586    0.879779    0.874473    0.315445    0.326656    0.718514    0.707809    0.722328    0.708333    3000        25.503778   1.081067    0.434653    166.995682 
[37m[36mINFO[0m[0m 01/31 05:54:52 | 0.268969    0.279918    0.769132    0.766886    0.688523    0.872397    0.872363    0.268969    0.279918    0.727330    0.721662    0.707669    0.706633    3200        27.204030   1.053052    0.353487    175.982972 
[37m[36mINFO[0m[0m 01/31 05:58:37 | 0.372320    0.365691    0.802177    0.789527    0.572177    0.887951    0.880802    0.372320    0.365691    0.772670    0.758186    0.745910    0.729592    3400        28.904282   1.029377    0.304578    164.051023 
[37m[36mINFO[0m[0m 01/31 06:02:28 | 0.376685    0.399076    0.819763    0.808238    0.555580    0.895597    0.875527    0.376685    0.399076    0.793136    0.777078    0.770554    0.772109    3600        30.604534   0.979634    0.320451    167.347978 
[37m[36mINFO[0m[0m 01/31 06:06:29 | 0.303633    0.317411    0.807139    0.800872    0.555402    0.880042    0.876582    0.303633    0.317411    0.793766    0.792191    0.747610    0.733844    3800        32.304786   0.964004    0.356123    169.085126 
[37m[36mINFO[0m[0m 01/31 06:10:43 | 0.331622    0.345146    0.819870    0.812110    0.534116    0.894543    0.869198    0.331622    0.345146    0.793451    0.803526    0.771617    0.763605    4000        34.005038   0.958298    0.391657    175.546283 
[37m[36mINFO[0m[0m 01/31 06:14:44 | 0.371550    0.382640    0.833274    0.826150    0.485306    0.898761    0.889241    0.371550    0.382640    0.821159    0.806045    0.779902    0.783163    4200        35.705290   0.934697    0.384360    163.301140 
[37m[36mINFO[0m[0m 01/31 06:18:46 | 0.368212    0.371854    0.843331    0.836673    0.461067    0.908252    0.892405    0.368212    0.371854    0.823992    0.812343    0.797748    0.805272    4400        37.405542   0.925466    0.339972    173.666729 
[37m[36mINFO[0m[0m 01/31 06:22:36 | 0.437412    0.434515    0.843666    0.819085    0.528492    0.906407    0.887131    0.437412    0.434515    0.834068    0.802267    0.790525    0.767857    4600        39.105793   0.878034    0.301068    169.329669 
[37m[36mINFO[0m[0m 01/31 06:26:26 | 0.430864    0.450437    0.855412    0.839888    0.472397    0.917743    0.901899    0.430864    0.450437    0.842884    0.833753    0.805609    0.784014    4800        40.806045   0.875009    0.302188    170.361710 
[37m[36mINFO[0m[0m 01/31 06:30:26 | 0.326486    0.355932    0.856020    0.838026    0.453161    0.919589    0.902954    0.326486    0.355932    0.844773    0.821159    0.803697    0.789966    5000        42.506297   0.847199    0.312087    177.179935 
[37m[36mINFO[0m[0m 01/31 06:30:26 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[1]/250131_04-48-49_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/31 06:30:28 | ---
[37m[36mINFO[0m[0m 01/31 06:30:28 | test-domain validation(oracle) = 43.086%
[37m[36mINFO[0m[0m 01/31 06:30:28 | training-domain validation(iid) = 43.086%
[37m[36mINFO[0m[0m 01/31 06:30:28 | last = 32.649%
[37m[36mINFO[0m[0m 01/31 06:30:28 | last (inD) = 83.803%
[37m[36mINFO[0m[0m 01/31 06:30:28 | training-domain validation (iid, inD) = 83.989%
[37m[36mINFO[0m[0m 01/31 06:30:28 | === Summary ===
[37m[36mINFO[0m[0m 01/31 06:30:28 | Command: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm RSC --test_envs 1 --dataset TerraIncognita --trial_seed 0 --hparams_seed 19
[37m[36mINFO[0m[0m 01/31 06:30:28 | Unique name: 250131_04-48-49_resnet50_EVE
[37m[36mINFO[0m[0m 01/31 06:30:28 | Out path: train_output/TerraIncognita/RSC/[1]/250131_04-48-49_resnet50_EVE
[37m[36mINFO[0m[0m 01/31 06:30:28 | Algorithm: RSC
[37m[36mINFO[0m[0m 01/31 06:30:28 | Dataset: TerraIncognita
[37m[36mINFO[0m[0m 01/31 06:30:28 | Max test_in: 0.4374

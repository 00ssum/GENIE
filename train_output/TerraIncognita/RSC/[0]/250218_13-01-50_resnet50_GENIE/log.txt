[37m[36mINFO[0m[0m 02/18 13:01:50 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 5
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 5
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[0]/250218_13-01-50_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250218_13-01-50_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.6343540304927548e-05
	batch_size: 23
	weight_decay: 3.844578840738432e-05
	rsc_f_drop_factor: 0.20901381480683512
	rsc_b_drop_factor: 0.395018743820514
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/18 13:01:50 | n_steps = 5001
[37m[36mINFO[0m[0m 02/18 13:01:50 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/18 13:01:50 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/18 13:01:50 | 
[37m[36mINFO[0m[0m 02/18 13:01:50 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 02/18 13:01:50 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 02/18 13:01:50 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 02/18 13:01:50 | Batch sizes for each domain: [0, 23, 23, 23] (total=69)
[37m[36mINFO[0m[0m 02/18 13:01:50 | steps-per-epoch for each domain: 338.65, 138.09, 204.65 -> min = 138.09
[37m[36mINFO[0m[0m 02/18 13:01:51 | # of params = 23528522
[37m[36mINFO[0m[0m 02/18 13:05:11 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/18 13:05:11 | 0.204060    0.212025    0.290915    0.310137    2.150958    0.204060    0.212025    0.461292    0.498716    0.189232    0.221662    0.222222    0.210034    0           0.000000    3.414970    1.061447    199.002350 
[37m[36mINFO[0m[0m 02/18 13:09:22 | 0.210124    0.219409    0.399624    0.422250    1.494002    0.210124    0.219409    0.574400    0.601438    0.317695    0.372796    0.306777    0.292517    200         1.448363    1.927545    0.232706    203.638318 
[37m[36mINFO[0m[0m 02/18 13:13:12 | 0.211442    0.220464    0.403825    0.424598    1.427381    0.211442    0.220464    0.578380    0.602465    0.316121    0.367758    0.316975    0.303571    400         2.896725    1.642465    0.209093    188.653314 
[37m[36mINFO[0m[0m 02/18 13:17:14 | 0.211969    0.227848    0.431749    0.454189    1.373003    0.211969    0.227848    0.581204    0.604520    0.386020    0.435768    0.328022    0.322279    600         4.345088    1.586331    0.226684    196.155902 
[37m[36mINFO[0m[0m 02/18 13:21:29 | 0.218561    0.226793    0.430814    0.438615    1.447877    0.218561    0.226793    0.555527    0.573703    0.304156    0.316121    0.432760    0.426020    800         5.793451    1.538637    0.282299    199.155956 
[37m[36mINFO[0m[0m 02/18 13:25:42 | 0.225152    0.235232    0.485476    0.504271    1.292831    0.225152    0.235232    0.576454    0.605547    0.429156    0.437028    0.450818    0.470238    1000        7.241814    1.523602    0.296411    193.677260 
[37m[36mINFO[0m[0m 02/18 13:30:06 | 0.207487    0.209916    0.521486    0.523944    1.227259    0.207487    0.209916    0.589293    0.611197    0.506927    0.486146    0.468239    0.474490    1200        8.690176    1.482087    0.368571    190.333805 
[37m[36mINFO[0m[0m 02/18 13:34:18 | 0.210915    0.217300    0.510848    0.526494    1.260798    0.210915    0.217300    0.581975    0.602979    0.485516    0.508816    0.465052    0.467687    1400        10.138539   1.463049    0.304970    191.240972 
[37m[36mINFO[0m[0m 02/18 13:38:42 | 0.208542    0.213080    0.565384    0.582512    1.117172    0.208542    0.213080    0.615483    0.624037    0.549118    0.584383    0.531549    0.539116    1600        11.586902   1.411906    0.323402    198.900960 
[37m[36mINFO[0m[0m 02/18 13:42:46 | 0.233852    0.240506    0.604335    0.602129    1.059053    0.233852    0.240506    0.649121    0.632255    0.607053    0.614610    0.556830    0.559524    1800        13.035264   1.344281    0.249649    193.876348 
[37m[36mINFO[0m[0m 02/18 13:47:09 | 0.192196    0.203586    0.624356    0.614599    1.064779    0.192196    0.203586    0.685069    0.676939    0.624370    0.618388    0.563629    0.548469    2000        14.483627   1.260619    0.289453    205.039038 
[37m[36mINFO[0m[0m 02/18 13:51:21 | 0.412339    0.421941    0.671324    0.674541    0.891340    0.412339    0.421941    0.734626    0.730868    0.651134    0.681360    0.628213    0.611395    2200        15.931990   1.226060    0.240569    204.397756 
[37m[36mINFO[0m[0m 02/18 13:55:33 | 0.533087    0.545359    0.716439    0.725928    0.747948    0.533087    0.545359    0.754269    0.756549    0.719458    0.741814    0.675590    0.679422    2400        17.380353   1.107981    0.242383    203.124480 
[37m[36mINFO[0m[0m 02/18 13:59:39 | 0.363564    0.370253    0.709280    0.713884    0.751335    0.363564    0.370253    0.752215    0.756035    0.709383    0.734257    0.666242    0.651361    2600        18.828715   1.072458    0.259854    194.216141 
[37m[36mINFO[0m[0m 02/18 14:03:49 | 0.592143    0.599156    0.702852    0.696957    0.789745    0.592143    0.599156    0.745282    0.752953    0.694270    0.673804    0.669004    0.664116    2800        20.277078   1.010521    0.244809    201.374032 
[37m[36mINFO[0m[0m 02/18 14:08:00 | 0.489850    0.487342    0.736067    0.740535    0.685045    0.489850    0.487342    0.765695    0.770930    0.747796    0.767003    0.694710    0.683673    3000        21.725441   0.971918    0.290378    192.193813 
[37m[36mINFO[0m[0m 02/18 14:12:05 | 0.567888    0.574895    0.718693    0.725192    0.725964    0.567888    0.574895    0.767107    0.774525    0.712531    0.724181    0.676439    0.676871    3200        23.173804   0.888461    0.236082    197.613755 
[37m[36mINFO[0m[0m 02/18 14:16:18 | 0.480886    0.489451    0.752803    0.769632    0.644157    0.480886    0.489451    0.782129    0.795583    0.756927    0.789673    0.719354    0.723639    3400        24.622166   0.869469    0.232516    206.901748 
[37m[36mINFO[0m[0m 02/18 14:20:19 | 0.527551    0.548523    0.754259    0.760135    0.666970    0.527551    0.548523    0.781102    0.785824    0.750000    0.758186    0.731676    0.736395    3600        26.070529   0.866931    0.258990    189.405388 
[37m[36mINFO[0m[0m 02/18 14:24:34 | 0.455840    0.448312    0.738827    0.741991    0.673745    0.455840    0.448312    0.787521    0.796610    0.734887    0.738035    0.694073    0.691327    3800        27.518892   0.815981    0.306093    193.512509 
[37m[36mINFO[0m[0m 02/18 14:28:47 | 0.540997    0.570675    0.773884    0.779094    0.658306    0.540997    0.570675    0.783027    0.787879    0.784005    0.793451    0.754621    0.755952    4000        28.967254   0.797931    0.326268    188.164942 
[37m[36mINFO[0m[0m 02/18 14:32:58 | 0.383338    0.398734    0.763296    0.759172    0.706710    0.383338    0.398734    0.796251    0.801233    0.771096    0.759446    0.722541    0.716837    4200        30.415617   0.792583    0.312347    187.950961 
[37m[36mINFO[0m[0m 02/18 14:37:15 | 0.601371    0.616034    0.763035    0.761624    0.671141    0.601371    0.616034    0.791886    0.805342    0.755982    0.738035    0.741236    0.741497    4400        31.863980   0.789391    0.283524    200.362113 
[37m[36mINFO[0m[0m 02/18 14:41:34 | 0.568943    0.587553    0.770746    0.769898    0.642308    0.568943    0.587553    0.791501    0.789420    0.778652    0.777078    0.742086    0.743197    4600        33.312343   0.742573    0.313003    196.819676 
[37m[36mINFO[0m[0m 02/18 14:45:41 | 0.489059    0.486287    0.802259    0.800441    0.588207    0.489059    0.486287    0.806137    0.810478    0.812028    0.811083    0.788613    0.779762    4800        34.760705   0.740894    0.257609    195.706535 
[37m[36mINFO[0m[0m 02/18 14:49:55 | 0.527551    0.540084    0.794634    0.785348    0.640014    0.527551    0.540084    0.797792    0.802260    0.801322    0.783375    0.784789    0.770408    5000        36.209068   0.710212    0.302419    193.055625 
[37m[36mINFO[0m[0m 02/18 14:49:55 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[0]/250218_13-01-50_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/18 14:49:57 | ---
[37m[36mINFO[0m[0m 02/18 14:49:57 | test-domain validation(oracle) = 60.137%
[37m[36mINFO[0m[0m 02/18 14:49:57 | training-domain validation(iid) = 48.906%
[37m[36mINFO[0m[0m 02/18 14:49:57 | last = 52.755%
[37m[36mINFO[0m[0m 02/18 14:49:57 | last (inD) = 78.535%
[37m[36mINFO[0m[0m 02/18 14:49:57 | training-domain validation (iid, inD) = 80.044%
[37m[36mINFO[0m[0m 02/18 14:49:57 | === Summary ===
[37m[36mINFO[0m[0m 02/18 14:49:57 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 5
[37m[36mINFO[0m[0m 02/18 14:49:57 | Unique name: 250218_13-01-50_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 14:49:57 | Out path: train_output/TerraIncognita/RSC/[0]/250218_13-01-50_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 14:49:57 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/18 14:49:57 | Dataset: TerraIncognita

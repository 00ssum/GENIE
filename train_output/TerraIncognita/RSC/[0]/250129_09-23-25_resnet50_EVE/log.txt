[37m[36mINFO[0m[0m 01/29 09:23:25 | Command :: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm RSC --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 14
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 9.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_EVE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 14
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_EVE
	out_dir: train_output/TerraIncognita/RSC/[0]/250129_09-23-25_resnet50_EVE
	out_root: train_output/TerraIncognita/RSC/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250129_09-23-25_resnet50_EVE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: GENIE
	freeze_bn: False
	pretrained: True
	lr: 2.1399727535070965e-05
	batch_size: 16
	weight_decay: 0.00022842646099519332
	rsc_f_drop_factor: 0.03663071938022161
	rsc_b_drop_factor: 0.4317269967185047
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 01/29 09:23:26 | n_steps = 5001
[37m[36mINFO[0m[0m 01/29 09:23:26 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 01/29 09:23:26 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 01/29 09:23:26 | Target test envs = [[0]]
[37m[36mINFO[0m[0m 01/29 09:23:26 | 
[37m[36mINFO[0m[0m 01/29 09:23:26 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 01/29 09:23:26 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 01/29 09:23:26 | Batch sizes for each domain: [0, 16, 16, 16] (total=48)
[37m[36mINFO[0m[0m 01/29 09:23:26 | steps-per-epoch for each domain: 486.81, 198.50, 294.19 -> min = 198.50
[37m[36mINFO[0m[0m 01/29 09:23:27 | # of params = 23528522
[37m[36mINFO[0m[0m 01/29 09:26:29 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 01/29 09:26:29 | 0.201424    0.209916    0.291839    0.304317    2.075383    0.201424    0.209916    0.455643    0.481253    0.195529    0.221662    0.224347    0.210034    0           0.000000    2.603747    1.433784    180.199058 
[37m[36mINFO[0m[0m 01/29 09:30:10 | 0.210651    0.224684    0.450998    0.463770    1.360355    0.210651    0.224684    0.583258    0.604520    0.348237    0.348866    0.421500    0.437925    200         1.007557    1.689239    0.209937    179.234321 
[37m[36mINFO[0m[0m 01/29 09:33:54 | 0.209860    0.214135    0.510457    0.527179    1.257434    0.209860    0.214135    0.594942    0.624551    0.468829    0.472292    0.467601    0.484694    400         2.015113    1.415885    0.213994    180.909175 
[37m[36mINFO[0m[0m 01/29 09:37:40 | 0.234115    0.238397    0.592055    0.593950    1.081135    0.234115    0.238397    0.640904    0.651258    0.593514    0.561713    0.541746    0.568878    600         3.022670    1.257301    0.238917    177.643334 
[37m[36mINFO[0m[0m 01/29 09:41:25 | 0.457949    0.472574    0.647677    0.634122    0.953840    0.457949    0.472574    0.710104    0.713919    0.598552    0.559194    0.634374    0.629252    800         4.030227    1.056408    0.227149    179.345472 
[37m[36mINFO[0m[0m 01/29 09:45:16 | 0.392038    0.398734    0.680662    0.690515    0.844847    0.392038    0.398734    0.739504    0.766307    0.653023    0.636020    0.649458    0.669218    1000        5.037783    0.906388    0.279081    174.814546 
[37m[36mINFO[0m[0m 01/29 09:49:06 | 0.527023    0.539030    0.720772    0.727974    0.738217    0.527023    0.539030    0.757735    0.777607    0.712846    0.711587    0.691736    0.694728    1200        6.045340    0.828752    0.265408    175.907982 
[37m[36mINFO[0m[0m 01/29 09:52:53 | 0.517532    0.536920    0.744175    0.758984    0.676424    0.517532    0.536920    0.776993    0.799692    0.733627    0.749370    0.721904    0.727891    1400        7.052897    0.782398    0.230655    181.233687 
[37m[36mINFO[0m[0m 01/29 09:56:44 | 0.384392    0.411392    0.754918    0.777005    0.617125    0.384392    0.411392    0.795224    0.820750    0.735516    0.761965    0.734013    0.748299    1600        8.060453    0.704484    0.225465    185.711388 
[37m[36mINFO[0m[0m 01/29 10:00:37 | 0.585025    0.575949    0.758320    0.771785    0.622990    0.585025    0.575949    0.761844    0.780688    0.767632    0.782116    0.745485    0.752551    1800        9.068010    0.696339    0.224154    187.148789 
[37m[36mINFO[0m[0m 01/29 10:04:20 | 0.547588    0.563291    0.768692    0.766599    0.598065    0.547588    0.563291    0.801258    0.810478    0.768892    0.770781    0.735925    0.718537    2000        10.075567   0.650857    0.221304    178.823928 
[37m[36mINFO[0m[0m 01/29 10:08:01 | 0.508832    0.523207    0.786340    0.794217    0.567789    0.508832    0.523207    0.823341    0.843862    0.772985    0.792191    0.762694    0.746599    2200        11.083123   0.643090    0.213799    178.755038 
[37m[36mINFO[0m[0m 01/29 10:11:38 | 0.563670    0.565401    0.793402    0.792325    0.558872    0.563670    0.565401    0.806394    0.808423    0.799433    0.792191    0.774379    0.776361    2400        12.090680   0.616432    0.236158    169.335090 
[37m[36mINFO[0m[0m 01/29 10:15:24 | 0.617717    0.595992    0.764232    0.762601    0.604757    0.617717    0.595992    0.804339    0.806882    0.733312    0.729219    0.755046    0.751701    2600        13.098237   0.570624    0.267423    172.257393 
[37m[36mINFO[0m[0m 01/29 10:19:14 | 0.515160    0.523207    0.806852    0.813543    0.517352    0.515160    0.523207    0.839646    0.850539    0.801008    0.803526    0.779902    0.786565    2800        14.105793   0.578982    0.276944    174.660393 
[37m[36mINFO[0m[0m 01/29 10:22:59 | 0.369365    0.385021    0.808149    0.793568    0.565684    0.369365    0.385021    0.834125    0.843862    0.804471    0.778338    0.785851    0.758503    3000        15.113350   0.550664    0.234151    177.485653 
[37m[36mINFO[0m[0m 01/29 10:26:47 | 0.596889    0.588608    0.817462    0.824374    0.503419    0.596889    0.588608    0.829375    0.860298    0.833123    0.821159    0.789887    0.791667    3200        16.120907   0.538275    0.211798    186.017708 
[37m[36mINFO[0m[0m 01/29 10:30:35 | 0.435803    0.460970    0.823697    0.817241    0.503989    0.435803    0.460970    0.846065    0.867488    0.815806    0.795970    0.809220    0.788265    3400        17.128463   0.522477    0.229401    181.261577 
[37m[36mINFO[0m[0m 01/29 10:34:21 | 0.525442    0.521097    0.830551    0.818759    0.500184    0.525442    0.521097    0.840288    0.858757    0.842569    0.821159    0.808795    0.776361    3600        18.136020   0.499229    0.216527    183.343638 
[37m[36mINFO[0m[0m 01/29 10:38:07 | 0.566306    0.602321    0.830232    0.830693    0.491533    0.566306    0.602321    0.845551    0.861839    0.829975    0.822418    0.815169    0.807823    3800        19.143577   0.495270    0.218168    181.887153 
[37m[36mINFO[0m[0m 01/29 10:41:50 | 0.592934    0.597046    0.842865    0.843956    0.459376    0.592934    0.597046    0.861985    0.882897    0.855479    0.853904    0.811132    0.795068    4000        20.151134   0.481313    0.222583    178.251100 
[37m[36mINFO[0m[0m 01/29 10:45:35 | 0.522805    0.534810    0.849629    0.830670    0.478883    0.522805    0.534810    0.862498    0.864920    0.862720    0.836272    0.823667    0.790816    4200        21.158690   0.459392    0.250552    174.770467 
[37m[36mINFO[0m[0m 01/29 10:49:09 | 0.523860    0.545359    0.835721    0.829110    0.471192    0.523860    0.545359    0.854410    0.858757    0.833123    0.819899    0.819630    0.808673    4400        22.166247   0.474815    0.206591    171.975384 
[37m[36mINFO[0m[0m 01/29 10:52:55 | 0.478513    0.505274    0.841256    0.821706    0.479574    0.478513    0.505274    0.858390    0.843349    0.843199    0.819899    0.822180    0.801871    4600        23.173804   0.455399    0.287573    169.137699 
[37m[36mINFO[0m[0m 01/29 10:56:36 | 0.464804    0.493671    0.845142    0.830681    0.471506    0.464804    0.493671    0.860316    0.871597    0.855479    0.823678    0.819630    0.796769    4800        24.181360   0.444402    0.216820    177.525918 
[37m[36mINFO[0m[0m 01/29 11:00:26 | 0.474031    0.477848    0.847156    0.838931    0.454363    0.474031    0.477848    0.850045    0.858243    0.859257    0.836272    0.832165    0.822279    5000        25.188917   0.420053    0.232785    183.489797 
[37m[36mINFO[0m[0m 01/29 11:00:26 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[0]/250129_09-23-25_resnet50_EVE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 01/29 11:00:27 | ---
[37m[36mINFO[0m[0m 01/29 11:00:27 | test-domain validation(oracle) = 56.631%
[37m[36mINFO[0m[0m 01/29 11:00:27 | training-domain validation(iid) = 59.293%
[37m[36mINFO[0m[0m 01/29 11:00:27 | last = 47.403%
[37m[36mINFO[0m[0m 01/29 11:00:27 | last (inD) = 83.893%
[37m[36mINFO[0m[0m 01/29 11:00:27 | training-domain validation (iid, inD) = 84.396%
[37m[36mINFO[0m[0m 01/29 11:00:27 | === Summary ===
[37m[36mINFO[0m[0m 01/29 11:00:27 | Command: /jsm0707/DomainBed/Large-scale/train_all.py resnet50_EVE config/resnet50_EVE.yaml --algorithm RSC --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 14
[37m[36mINFO[0m[0m 01/29 11:00:27 | Unique name: 250129_09-23-25_resnet50_EVE
[37m[36mINFO[0m[0m 01/29 11:00:27 | Out path: train_output/TerraIncognita/RSC/[0]/250129_09-23-25_resnet50_EVE
[37m[36mINFO[0m[0m 01/29 11:00:27 | Algorithm: RSC
[37m[36mINFO[0m[0m 01/29 11:00:27 | Dataset: TerraIncognita
[37m[36mINFO[0m[0m 01/29 11:00:27 | Max test_in: 0.6177

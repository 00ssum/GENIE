[37m[36mINFO[0m[0m 02/18 14:50:01 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 6
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 6
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[0]/250218_14-50-01_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250218_14-50-01_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.5764387170443743e-05
	batch_size: 19
	weight_decay: 0.0006024239579587198
	rsc_f_drop_factor: 0.19876770246536363
	rsc_b_drop_factor: 0.08199629172100226
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/18 14:50:01 | n_steps = 5001
[37m[36mINFO[0m[0m 02/18 14:50:01 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/18 14:50:01 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/18 14:50:01 | 
[37m[36mINFO[0m[0m 02/18 14:50:01 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 02/18 14:50:01 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 02/18 14:50:01 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 02/18 14:50:01 | Batch sizes for each domain: [0, 19, 19, 19] (total=57)
[37m[36mINFO[0m[0m 02/18 14:50:01 | steps-per-epoch for each domain: 409.95, 167.16, 247.74 -> min = 167.16
[37m[36mINFO[0m[0m 02/18 14:50:02 | # of params = 23528522
[37m[36mINFO[0m[0m 02/18 14:53:10 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/18 14:53:10 | 0.200633    0.208861    0.288298    0.304317    2.062246    0.200633    0.208861    0.455643    0.481253    0.187028    0.221662    0.222222    0.210034    0           0.000000    2.598782    1.114587    186.463361 
[37m[36mINFO[0m[0m 02/18 14:57:00 | 0.210388    0.219409    0.474913    0.498809    1.342935    0.210388    0.219409    0.578765    0.596816    0.386020    0.437028    0.459953    0.462585    200         1.196474    1.640175    0.228130    184.656161 
[37m[36mINFO[0m[0m 02/18 15:00:50 | 0.208806    0.215190    0.532492    0.541757    1.189705    0.208806    0.215190    0.595969    0.617874    0.524559    0.520151    0.476949    0.487245    400         2.392947    1.392122    0.226219    184.523778 
[37m[36mINFO[0m[0m 02/18 15:04:48 | 0.235434    0.229958    0.617215    0.625194    0.982577    0.235434    0.229958    0.662601    0.685670    0.617128    0.610831    0.571914    0.579082    600         3.589421    1.222339    0.235524    190.857823 
[37m[36mINFO[0m[0m 02/18 15:08:44 | 0.343000    0.351266    0.686522    0.703845    0.815024    0.343000    0.351266    0.730004    0.745249    0.688602    0.716625    0.640960    0.649660    800         4.785894    1.028353    0.204302    195.628616 
[37m[36mINFO[0m[0m 02/18 15:12:30 | 0.331664    0.332278    0.703805    0.719837    0.820580    0.331664    0.332278    0.742714    0.759117    0.693325    0.709068    0.675377    0.691327    1000        5.982368    0.920666    0.208470    184.614518 
[37m[36mINFO[0m[0m 02/18 15:16:28 | 0.434748    0.432489    0.735583    0.734573    0.714021    0.434748    0.432489    0.760945    0.759117    0.747481    0.743073    0.698322    0.701531    1200        7.178841    0.847429    0.261002    184.902386 
[37m[36mINFO[0m[0m 02/18 15:20:15 | 0.531769    0.515823    0.733958    0.738503    0.708110    0.531769    0.515823    0.779561    0.790960    0.722292    0.715365    0.700021    0.709184    1400        8.375315    0.805033    0.268147    173.628580 
[37m[36mINFO[0m[0m 02/18 15:24:08 | 0.447930    0.463080    0.764638    0.778191    0.598478    0.447930    0.463080    0.773912    0.790960    0.769207    0.780856    0.750797    0.762755    1600        9.571788    0.720268    0.273553    178.874170 
[37m[36mINFO[0m[0m 02/18 15:27:56 | 0.459794    0.462025    0.791572    0.786116    0.580449    0.459794    0.462025    0.810759    0.827427    0.788728    0.775819    0.775228    0.755102    1800        10.768262   0.699957    0.220385    183.693630 
[37m[36mINFO[0m[0m 02/18 15:31:37 | 0.440021    0.433544    0.800346    0.801681    0.554804    0.440021    0.433544    0.825138    0.841808    0.784950    0.775819    0.790950    0.787415    2000        11.964736   0.653774    0.198595    181.019348 
[37m[36mINFO[0m[0m 02/18 15:35:23 | 0.310308    0.349156    0.784406    0.776212    0.609159    0.310308    0.349156    0.816536    0.831536    0.786524    0.760705    0.750159    0.736395    2200        13.161209   0.646571    0.199904    186.428302 
[37m[36mINFO[0m[0m 02/18 15:39:05 | 0.538096    0.524262    0.778535    0.777754    0.583391    0.538096    0.524262    0.807292    0.823318    0.793451    0.787154    0.734863    0.722789    2400        14.357683   0.661899    0.200037    181.452844 
[37m[36mINFO[0m[0m 02/18 15:42:56 | 0.416820    0.409283    0.801509    0.797836    0.537642    0.416820    0.409283    0.817563    0.829995    0.809824    0.787154    0.777140    0.776361    2600        15.554156   0.619665    0.194192    192.386863 
[37m[36mINFO[0m[0m 02/18 15:46:45 | 0.362510    0.383966    0.810602    0.807845    0.569357    0.362510    0.383966    0.828219    0.831022    0.823048    0.813602    0.780540    0.778912    2800        16.750630   0.579910    0.197066    189.430557 
[37m[36mINFO[0m[0m 02/18 15:50:46 | 0.449249    0.463080    0.826696    0.834718    0.476838    0.449249    0.463080    0.848633    0.860812    0.819899    0.828715    0.811557    0.814626    3000        17.947103   0.571671    0.206754    199.518795 
[37m[36mINFO[0m[0m 02/18 15:54:35 | 0.418666    0.411392    0.825290    0.815105    0.521616    0.418666    0.411392    0.841571    0.848485    0.822103    0.808564    0.812195    0.788265    3200        19.143577   0.561451    0.203431    188.315510 
[37m[36mINFO[0m[0m 02/18 15:58:25 | 0.544424    0.550633    0.832823    0.834582    0.454377    0.544424    0.550633    0.854153    0.865948    0.828086    0.829975    0.816231    0.807823    3400        20.340050   0.533252    0.208028    188.566512 
[37m[36mINFO[0m[0m 02/18 16:02:19 | 0.531769    0.540084    0.830641    0.830427    0.485561    0.531769    0.540084    0.859802    0.869543    0.826511    0.822418    0.805609    0.799320    3600        21.536524   0.529500    0.207546    192.280369 
[37m[36mINFO[0m[0m 02/18 16:05:56 | 0.534933    0.531646    0.843781    0.832418    0.482114    0.534933    0.531646    0.857235    0.860812    0.850441    0.836272    0.823667    0.800170    3800        22.732997   0.524363    0.210039    174.783821 
[37m[36mINFO[0m[0m 02/18 16:09:41 | 0.428157    0.455696    0.840972    0.841092    0.454136    0.428157    0.455696    0.860059    0.876220    0.832179    0.837531    0.830678    0.809524    4000        23.929471   0.503008    0.204360    184.832431 
[37m[36mINFO[0m[0m 02/18 16:13:27 | 0.450303    0.430380    0.841147    0.836703    0.450683    0.450303    0.430380    0.856464    0.872625    0.842884    0.821159    0.824092    0.816327    4200        25.125945   0.510385    0.207927    184.465768 
[37m[36mINFO[0m[0m 02/18 16:17:19 | 0.465595    0.482068    0.854849    0.843817    0.442380    0.465595    0.482068    0.869046    0.882383    0.864610    0.846348    0.830890    0.802721    4400        26.322418   0.485501    0.207377    189.873256 
[37m[36mINFO[0m[0m 02/18 16:21:05 | 0.446612    0.462025    0.849639    0.837789    0.449457    0.446612    0.462025    0.864167    0.875193    0.857683    0.833753    0.827066    0.804422    4600        27.518892   0.487738    0.202965    185.306194 
[37m[36mINFO[0m[0m 02/18 16:25:00 | 0.350382    0.373418    0.852042    0.843934    0.434008    0.350382    0.373418    0.859417    0.875706    0.861146    0.828715    0.835564    0.827381    4800        28.715365   0.460236    0.255123    184.355215 
[37m[36mINFO[0m[0m 02/18 16:28:51 | 0.489059    0.485232    0.866736    0.853795    0.409271    0.489059    0.485232    0.876107    0.893169    0.880038    0.845088    0.844062    0.823129    5000        29.911839   0.447079    0.251688    181.184012 
[37m[36mINFO[0m[0m 02/18 16:28:52 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[0]/250218_14-50-01_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/18 16:28:53 | ---
[37m[36mINFO[0m[0m 02/18 16:28:53 | test-domain validation(oracle) = 54.442%
[37m[36mINFO[0m[0m 02/18 16:28:53 | training-domain validation(iid) = 48.906%
[37m[36mINFO[0m[0m 02/18 16:28:53 | last = 48.906%
[37m[36mINFO[0m[0m 02/18 16:28:53 | last (inD) = 85.380%
[37m[36mINFO[0m[0m 02/18 16:28:53 | training-domain validation (iid, inD) = 85.380%
[37m[36mINFO[0m[0m 02/18 16:28:53 | === Summary ===
[37m[36mINFO[0m[0m 02/18 16:28:53 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 6
[37m[36mINFO[0m[0m 02/18 16:28:53 | Unique name: 250218_14-50-01_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 16:28:53 | Out path: train_output/TerraIncognita/RSC/[0]/250218_14-50-01_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 16:28:53 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/18 16:28:53 | Dataset: TerraIncognita

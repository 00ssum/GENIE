[37m[36mINFO[0m[0m 02/26 12:13:20 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 --dataset TerraIncognita --trial_seed 1 --hparams_seed 20
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 20
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[0]/250226_12-13-20_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 1
	unique_name: 250226_12-13-20_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.6701621650738547e-05
	batch_size: 28
	weight_decay: 2.09977539257237e-05
	rsc_f_drop_factor: 0.3326621721270262
	rsc_b_drop_factor: 0.45527554959503275
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/26 12:13:20 | n_steps = 5001
[37m[36mINFO[0m[0m 02/26 12:13:20 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/26 12:13:20 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/26 12:13:20 | 
[37m[36mINFO[0m[0m 02/26 12:13:20 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 02/26 12:13:20 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 02/26 12:13:20 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 02/26 12:13:20 | Batch sizes for each domain: [0, 28, 28, 28] (total=84)
[37m[36mINFO[0m[0m 02/26 12:13:20 | steps-per-epoch for each domain: 278.18, 113.43, 168.11 -> min = 113.43
[37m[36mINFO[0m[0m 02/26 12:13:22 | # of params = 23528522
[37m[36mINFO[0m[0m 02/26 12:16:26 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/26 12:16:26 | 0.208015    0.179325    0.289186    0.299757    2.144739    0.208015    0.179325    0.461933    0.455573    0.188287    0.214106    0.217336    0.229592    0           0.000000    3.907364    1.363256    183.150454 
[37m[36mINFO[0m[0m 02/26 12:20:37 | 0.206697    0.180380    0.388462    0.412863    1.745843    0.206697    0.180380    0.543587    0.571135    0.345403    0.371537    0.276397    0.295918    200         1.763224    2.136664    0.363077    177.774056 
[37m[36mINFO[0m[0m 02/26 12:24:44 | 0.254152    0.215190    0.400282    0.421627    1.611638    0.254152    0.215190    0.582360    0.577298    0.320844    0.360202    0.297642    0.327381    400         3.526448    1.943454    0.342208    178.935266 
[37m[36mINFO[0m[0m 02/26 12:28:48 | 0.210651    0.182489    0.399127    0.414310    1.509284    0.210651    0.182489    0.575684    0.574217    0.345088    0.372796    0.276609    0.295918    600         5.289673    1.886972    0.327308    178.007651 
[37m[36mINFO[0m[0m 02/26 12:32:47 | 0.232797    0.214135    0.414519    0.424518    1.466167    0.232797    0.214135    0.585441    0.581407    0.355164    0.369018    0.302953    0.323129    800         7.052897    1.829728    0.320963    175.277948 
[37m[36mINFO[0m[0m 02/26 12:36:48 | 0.224361    0.207806    0.405417    0.420569    1.444523    0.224361    0.207806    0.592759    0.584489    0.346033    0.372796    0.277459    0.304422    1000        8.816121    1.799393    0.336739    173.598924 
[37m[36mINFO[0m[0m 02/26 12:41:00 | 0.225943    0.209916    0.416378    0.427011    1.438346    0.225943    0.209916    0.591989    0.585003    0.321474    0.331234    0.335670    0.364796    1200        10.579345   1.768453    0.323749    187.003161 
[37m[36mINFO[0m[0m 02/26 12:45:10 | 0.216979    0.197257    0.423943    0.438305    1.430946    0.216979    0.197257    0.591604    0.582435    0.371537    0.406801    0.308689    0.325680    1400        12.342569   1.757015    0.358957    178.562374 
[37m[36mINFO[0m[0m 02/26 12:49:08 | 0.214342    0.196203    0.441673    0.449422    1.411774    0.214342    0.196203    0.594942    0.585516    0.403967    0.400504    0.326110    0.362245    1600        14.105793   1.739082    0.324141    172.914237 
[37m[36mINFO[0m[0m 02/26 12:53:11 | 0.213551    0.199367    0.451928    0.466070    1.372745    0.213551    0.199367    0.590705    0.583975    0.408375    0.430730    0.356703    0.383503    1800        15.869018   1.703166    0.314800    180.463560 
[37m[36mINFO[0m[0m 02/26 12:57:12 | 0.215133    0.199367    0.442006    0.454323    1.370596    0.215133    0.199367    0.593016    0.583975    0.399244    0.426952    0.333758    0.352041    2000        17.632242   1.701855    0.313773    178.289580 
[37m[36mINFO[0m[0m 02/26 13:01:12 | 0.206169    0.179325    0.453516    0.471693    1.349452    0.206169    0.179325    0.597381    0.603493    0.408375    0.438287    0.354791    0.373299    2200        19.395466   1.697409    0.331549    173.229309 
[37m[36mINFO[0m[0m 02/26 13:05:24 | 0.199578    0.181435    0.438667    0.455468    1.338127    0.199578    0.181435    0.592759    0.585516    0.371851    0.411839    0.351392    0.369048    2400        21.158690   1.679731    0.305834    191.078531 
[37m[36mINFO[0m[0m 02/26 13:09:27 | 0.157659    0.150844    0.480846    0.484316    1.292994    0.157659    0.150844    0.595840    0.592707    0.448992    0.457179    0.397706    0.403061    2600        22.921914   1.645787    0.328914    177.369273 
[37m[36mINFO[0m[0m 02/26 13:13:38 | 0.130504    0.122363    0.512780    0.506368    1.275090    0.130504    0.122363    0.603158    0.592193    0.475441    0.463476    0.459741    0.463435    2800        24.685139   1.630795    0.357288    179.246464 
[37m[36mINFO[0m[0m 02/26 13:17:39 | 0.216188    0.200422    0.483922    0.487412    1.285823    0.216188    0.200422    0.596482    0.588598    0.389169    0.406801    0.466114    0.466837    3000        26.448363   1.619746    0.286417    183.792969 
[37m[36mINFO[0m[0m 02/26 13:21:42 | 0.224888    0.199367    0.540052    0.537997    1.218127    0.224888    0.199367    0.601618    0.593734    0.469144    0.478589    0.549395    0.541667    3200        28.211587   1.566384    0.345012    173.973661 
[37m[36mINFO[0m[0m 02/26 13:25:43 | 0.208542    0.188819    0.552482    0.562939    1.144578    0.208542    0.188819    0.614713    0.609142    0.488665    0.520151    0.554068    0.559524    3400        29.974811   1.552239    0.355931    169.792087 
[37m[36mINFO[0m[0m 02/26 13:29:47 | 0.211706    0.189873    0.541443    0.538270    1.111976    0.211706    0.189873    0.609321    0.597329    0.479849    0.496222    0.535160    0.521259    3600        31.738035   1.529600    0.334584    176.458126 
[37m[36mINFO[0m[0m 02/26 13:33:51 | 0.209069    0.183544    0.533662    0.535122    1.167460    0.209069    0.183544    0.605341    0.595788    0.456234    0.482368    0.539409    0.527211    3800        33.501259   1.489186    0.337069    177.045820 
[37m[36mINFO[0m[0m 02/26 13:37:52 | 0.187978    0.184599    0.565887    0.562863    1.137462    0.187978    0.184599    0.616896    0.600924    0.540932    0.560453    0.539834    0.527211    4000        35.264484   1.517015    0.332111    174.968760 
[37m[36mINFO[0m[0m 02/26 13:41:45 | 0.128394    0.127637    0.519304    0.508995    1.164280    0.128394    0.127637    0.622031    0.602465    0.435139    0.450882    0.500744    0.473639    4200        37.027708   1.474307    0.311374    170.397586 
[37m[36mINFO[0m[0m 02/26 13:45:38 | 0.206433    0.195148    0.499042    0.506610    1.218916    0.206433    0.195148    0.579022    0.577298    0.447103    0.472292    0.471001    0.470238    4400        38.790932   1.480203    0.313899    170.345525 
[37m[36mINFO[0m[0m 02/26 13:49:40 | 0.219351    0.199367    0.592155    0.586591    1.024808    0.219351    0.199367    0.621389    0.611710    0.579975    0.591940    0.575101    0.556122    4600        40.554156   1.448417    0.337546    174.489944 
[37m[36mINFO[0m[0m 02/26 13:53:42 | 0.277353    0.279536    0.598285    0.598831    1.052723    0.277353    0.279536    0.627423    0.619928    0.568325    0.590680    0.599108    0.585884    4800        42.317380   1.412227    0.322803    176.983413 
[37m[36mINFO[0m[0m 02/26 13:57:36 | 0.305563    0.333333    0.599217    0.608280    0.998839    0.305563    0.333333    0.664784    0.656908    0.554156    0.600756    0.578713    0.567177    5000        44.080605   1.389462    0.312038    171.669759 
[37m[36mINFO[0m[0m 02/26 13:57:36 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[0]/250226_12-13-20_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/26 13:57:37 | ---
[37m[36mINFO[0m[0m 02/26 13:57:37 | test-domain validation(oracle) = 30.556%
[37m[36mINFO[0m[0m 02/26 13:57:37 | training-domain validation(iid) = 30.556%
[37m[36mINFO[0m[0m 02/26 13:57:37 | last = 30.556%
[37m[36mINFO[0m[0m 02/26 13:57:37 | last (inD) = 60.828%
[37m[36mINFO[0m[0m 02/26 13:57:37 | training-domain validation (iid, inD) = 60.828%
[37m[36mINFO[0m[0m 02/26 13:57:37 | === Summary ===
[37m[36mINFO[0m[0m 02/26 13:57:37 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 --dataset TerraIncognita --trial_seed 1 --hparams_seed 20
[37m[36mINFO[0m[0m 02/26 13:57:37 | Unique name: 250226_12-13-20_resnet50_GENIE
[37m[36mINFO[0m[0m 02/26 13:57:37 | Out path: train_output/TerraIncognita/RSC/[0]/250226_12-13-20_resnet50_GENIE
[37m[36mINFO[0m[0m 02/26 13:57:37 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/26 13:57:37 | Dataset: TerraIncognita

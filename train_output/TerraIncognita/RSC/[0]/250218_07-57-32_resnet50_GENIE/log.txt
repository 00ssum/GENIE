[37m[36mINFO[0m[0m 02/18 07:57:32 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 1
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 1
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[0]/250218_07-57-32_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250218_07-57-32_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.1
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5.0781288859686544e-05
	batch_size: 44
	weight_decay: 0.00046410133598234803
	rsc_f_drop_factor: 0.2665134852412123
	rsc_b_drop_factor: 0.28056710878365126
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/18 07:57:32 | n_steps = 5001
[37m[36mINFO[0m[0m 02/18 07:57:32 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/18 07:57:32 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/18 07:57:32 | 
[37m[36mINFO[0m[0m 02/18 07:57:32 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 02/18 07:57:32 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 02/18 07:57:32 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 02/18 07:57:32 | Batch sizes for each domain: [0, 44, 44, 44] (total=132)
[37m[36mINFO[0m[0m 02/18 07:57:32 | steps-per-epoch for each domain: 177.02, 72.18, 106.98 -> min = 72.18
[37m[36mINFO[0m[0m 02/18 07:57:34 | # of params = 23528522
[37m[36mINFO[0m[0m 02/18 08:00:32 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/18 08:00:32 | 0.200633    0.208861    0.288803    0.304317    2.113702    0.200633    0.208861    0.455899    0.481253    0.188287    0.221662    0.222222    0.210034    0           0.000000    3.297939    1.954340    175.633526 
[37m[36mINFO[0m[0m 02/18 08:05:01 | 0.210651    0.217300    0.409867    0.440081    1.435712    0.210651    0.217300    0.579920    0.604520    0.350126    0.420655    0.299554    0.295068    200         2.770781    1.885098    0.466607    176.015019 
[37m[36mINFO[0m[0m 02/18 08:09:26 | 0.211178    0.221519    0.452516    0.460070    1.377780    0.211178    0.221519    0.582488    0.609656    0.417506    0.421914    0.357553    0.348639    400         5.541562    1.633919    0.446657    175.789365 
[37m[36mINFO[0m[0m 02/18 08:13:58 | 0.207751    0.220464    0.461270    0.474083    1.345743    0.207751    0.220464    0.535884    0.574217    0.426637    0.414358    0.421287    0.433673    600         8.312343    1.564830    0.461337    179.308686 
[37m[36mINFO[0m[0m 02/18 08:18:18 | 0.210651    0.220464    0.497384    0.497311    1.292284    0.210651    0.220464    0.577609    0.588084    0.495592    0.505038    0.418950    0.398810    800         11.083123   1.537102    0.416144    176.856271 
[37m[36mINFO[0m[0m 02/18 08:22:39 | 0.216979    0.225738    0.511215    0.511794    1.226369    0.216979    0.225738    0.593016    0.616846    0.464106    0.453401    0.476524    0.465136    1000        13.853904   1.513686    0.422431    176.003603 
[37m[36mINFO[0m[0m 02/18 08:26:59 | 0.108358    0.121308    0.575886    0.591129    1.117062    0.108358    0.121308    0.628065    0.655367    0.556360    0.580605    0.543233    0.537415    1200        16.624685   1.454515    0.396722    180.716888 
[37m[36mINFO[0m[0m 02/18 08:31:14 | 0.155813    0.158228    0.572558    0.576269    1.116632    0.155813    0.158228    0.598151    0.632768    0.568640    0.570529    0.550882    0.525510    1400        19.395466   1.401236    0.383202    179.108690 
[37m[36mINFO[0m[0m 02/18 08:35:45 | 0.259425    0.262658    0.609383    0.619623    1.012214    0.259425    0.262658    0.645269    0.654340    0.573363    0.598237    0.609518    0.606293    1600        22.166247   1.271998    0.510348    168.945630 
[37m[36mINFO[0m[0m 02/18 08:40:07 | 0.293435    0.295359    0.691492    0.697447    0.839968    0.293435    0.295359    0.729105    0.730868    0.690176    0.693955    0.655194    0.667517    1800        24.937028   1.222215    0.424539    177.174634 
[37m[36mINFO[0m[0m 02/18 08:44:28 | 0.309781    0.317511    0.684713    0.679670    0.877279    0.309781    0.317511    0.720118    0.734977    0.680101    0.663728    0.653920    0.640306    2000        27.707809   1.140718    0.400131    180.885037 
[37m[36mINFO[0m[0m 02/18 08:48:45 | 0.264171    0.282700    0.702128    0.705756    0.802653    0.264171    0.282700    0.735781    0.736518    0.685453    0.682620    0.685150    0.698129    2200        30.478589   1.084338    0.389652    178.777957 
[37m[36mINFO[0m[0m 02/18 08:53:12 | 0.308463    0.311181    0.736965    0.742812    0.722538    0.308463    0.311181    0.749390    0.762198    0.740239    0.746851    0.721266    0.719388    2400        33.249370   1.028532    0.445328    178.182654 
[37m[36mINFO[0m[0m 02/18 08:57:37 | 0.406275    0.402954    0.764548    0.768489    0.652187    0.406275    0.402954    0.778919    0.788906    0.775189    0.768262    0.739537    0.748299    2600        36.020151   0.980295    0.400457    184.969485 
[37m[36mINFO[0m[0m 02/18 09:02:01 | 0.478249    0.488397    0.778513    0.787148    0.605829    0.478249    0.488397    0.783669    0.804828    0.786839    0.794710    0.765031    0.761905    2800        38.790932   0.943463    0.445411    174.914907 
[37m[36mINFO[0m[0m 02/18 09:06:36 | 0.533351    0.544304    0.795345    0.796416    0.573694    0.533351    0.544304    0.791372    0.804828    0.814547    0.814861    0.780115    0.769558    3000        41.561713   0.874891    0.445732    184.929239 
[37m[36mINFO[0m[0m 02/18 09:11:06 | 0.526233    0.528481    0.801827    0.797955    0.591311    0.526233    0.528481    0.802029    0.820750    0.816751    0.801008    0.786701    0.772109    3200        44.332494   0.838089    0.446020    180.940748 
[37m[36mINFO[0m[0m 02/18 09:15:19 | 0.397838    0.412447    0.791979    0.782413    0.626521    0.397838    0.412447    0.798049    0.809450    0.804786    0.770781    0.773104    0.767007    3400        47.103275   0.819710    0.378794    177.920042 
[37m[36mINFO[0m[0m 02/18 09:19:29 | 0.484840    0.476793    0.798497    0.803673    0.585621    0.484840    0.476793    0.796765    0.806882    0.803526    0.802267    0.795199    0.801871    3600        49.874055   0.796458    0.383349    172.716476 
[37m[36mINFO[0m[0m 02/18 09:23:50 | 0.353019    0.388186    0.805056    0.791227    0.598259    0.353019    0.388186    0.793940    0.797637    0.840050    0.804786    0.781177    0.771259    3800        52.644836   0.770564    0.410520    178.880845 
[37m[36mINFO[0m[0m 02/18 09:28:27 | 0.559188    0.559072    0.810028    0.803421    0.578008    0.559188    0.559072    0.795994    0.798665    0.830605    0.817380    0.803484    0.794218    4000        55.415617   0.770728    0.485360    180.133735 
[37m[36mINFO[0m[0m 02/18 09:32:41 | 0.525969    0.549578    0.828538    0.823299    0.530115    0.525969    0.549578    0.820644    0.833077    0.859572    0.840050    0.805396    0.796769    4200        58.186398   0.740685    0.376016    178.773588 
[37m[36mINFO[0m[0m 02/18 09:36:55 | 0.438439    0.434599    0.827389    0.817422    0.566527    0.438439    0.434599    0.807421    0.821777    0.850441    0.836272    0.824304    0.794218    4400        60.957179   0.700962    0.368447    180.019604 
[37m[36mINFO[0m[0m 02/18 09:41:06 | 0.393883    0.408228    0.827835    0.818916    0.524806    0.393883    0.408228    0.809860    0.815614    0.853589    0.835013    0.820055    0.806122    4600        63.727960   0.715912    0.376244    176.391123 
[37m[36mINFO[0m[0m 02/18 09:45:35 | 0.573425    0.568565    0.833394    0.828974    0.488256    0.573425    0.568565    0.816023    0.824345    0.862406    0.853904    0.821755    0.808673    4800        66.498741   0.701593    0.457523    177.099202 
[37m[36mINFO[0m[0m 02/18 09:50:08 | 0.488004    0.507384    0.727037    0.736386    0.637015    0.488004    0.507384    0.802285    0.814587    0.681990    0.698992    0.696835    0.695578    5000        69.269521   0.664266    0.428161    187.463580 
[37m[36mINFO[0m[0m 02/18 09:50:08 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[0]/250218_07-57-32_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/18 09:50:09 | ---
[37m[36mINFO[0m[0m 02/18 09:50:09 | test-domain validation(oracle) = 57.342%
[37m[36mINFO[0m[0m 02/18 09:50:09 | training-domain validation(iid) = 57.342%
[37m[36mINFO[0m[0m 02/18 09:50:09 | last = 48.800%
[37m[36mINFO[0m[0m 02/18 09:50:09 | last (inD) = 73.639%
[37m[36mINFO[0m[0m 02/18 09:50:09 | training-domain validation (iid, inD) = 82.897%
[37m[36mINFO[0m[0m 02/18 09:50:10 | === Summary ===
[37m[36mINFO[0m[0m 02/18 09:50:10 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 1
[37m[36mINFO[0m[0m 02/18 09:50:10 | Unique name: 250218_07-57-32_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 09:50:10 | Out path: train_output/TerraIncognita/RSC/[0]/250218_07-57-32_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 09:50:10 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/18 09:50:10 | Dataset: TerraIncognita

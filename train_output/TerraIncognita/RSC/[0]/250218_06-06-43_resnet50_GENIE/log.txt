[37m[36mINFO[0m[0m 02/18 06:06:43 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 0
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 0
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[0]/250218_06-06-43_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250218_06-06-43_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 5e-05
	batch_size: 32
	weight_decay: 0.0
	rsc_f_drop_factor: 0.3333333333333333
	rsc_b_drop_factor: 0.3333333333333333
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/18 06:06:43 | n_steps = 5001
[37m[36mINFO[0m[0m 02/18 06:06:43 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/18 06:06:43 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/18 06:06:43 | 
[37m[36mINFO[0m[0m 02/18 06:06:43 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 02/18 06:06:43 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 02/18 06:06:43 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 02/18 06:06:43 | Batch sizes for each domain: [0, 32, 32, 32] (total=96)
[37m[36mINFO[0m[0m 02/18 06:06:43 | steps-per-epoch for each domain: 243.41, 99.25, 147.09 -> min = 99.25
[37m[36mINFO[0m[0m 02/18 06:06:44 | # of params = 23528522
[37m[36mINFO[0m[0m 02/18 06:10:04 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/18 06:10:04 | 0.203796    0.212025    0.290632    0.308939    2.135415    0.203796    0.212025    0.462961    0.495121    0.186713    0.221662    0.222222    0.210034    0           0.000000    3.586347    1.047884    198.832327 
[37m[36mINFO[0m[0m 02/18 06:14:20 | 0.208806    0.217300    0.394931    0.410230    1.588495    0.208806    0.217300    0.572474    0.590652    0.286209    0.321159    0.326110    0.318878    200         2.015113    2.036595    0.317505    193.288227 
[37m[36mINFO[0m[0m 02/18 06:18:37 | 0.215397    0.222574    0.414507    0.406307    1.485753    0.215397    0.222574    0.574400    0.591680    0.367443    0.357683    0.301678    0.269558    400         4.030227    1.831942    0.348218    187.144916 
[37m[36mINFO[0m[0m 02/18 06:23:11 | 0.205115    0.210970    0.432999    0.428220    1.445882    0.205115    0.210970    0.575940    0.585516    0.360831    0.353904    0.362226    0.345238    600         6.045340    1.749699    0.437627    186.495727 
[37m[36mINFO[0m[0m 02/18 06:27:50 | 0.221461    0.223629    0.446924    0.452756    1.390496    0.221461    0.223629    0.589164    0.608629    0.406801    0.428212    0.344806    0.321429    800         8.060453    1.719215    0.436020    191.566627 
[37m[36mINFO[0m[0m 02/18 06:32:23 | 0.223833    0.226793    0.448209    0.444390    1.378116    0.223833    0.226793    0.563872    0.593220    0.394521    0.387909    0.386233    0.352041    1000        10.075567   1.706088    0.373209    198.196348 
[37m[36mINFO[0m[0m 02/18 06:36:47 | 0.222779    0.227848    0.473768    0.481542    1.311548    0.222779    0.227848    0.586211    0.607088    0.433564    0.437028    0.401530    0.400510    1200        12.090680   1.683426    0.344486    195.077638 
[37m[36mINFO[0m[0m 02/18 06:41:03 | 0.221197    0.222574    0.492861    0.498889    1.257014    0.221197    0.222574    0.584542    0.609142    0.443010    0.418136    0.451030    0.469388    1400        14.105793   1.662269    0.343574    187.866969 
[37m[36mINFO[0m[0m 02/18 06:45:22 | 0.163195    0.164557    0.511004    0.506788    1.223032    0.163195    0.164557    0.590576    0.608115    0.455290    0.413098    0.487147    0.499150    1600        16.120907   1.621771    0.383606    181.629476 
[37m[36mINFO[0m[0m 02/18 06:49:47 | 0.125231    0.126582    0.570774    0.581348    1.112139    0.125231    0.126582    0.658493    0.681561    0.511020    0.501259    0.542809    0.561224    1800        18.136020   1.562167    0.433975    178.636017 
[37m[36mINFO[0m[0m 02/18 06:54:17 | 0.226470    0.237342    0.565599    0.544873    1.105676    0.226470    0.237342    0.666196    0.646636    0.490554    0.442065    0.540047    0.545918    2000        20.151134   1.506271    0.384602    193.301900 
[37m[36mINFO[0m[0m 02/18 06:58:40 | 0.236488    0.246835    0.582123    0.592733    1.045722    0.236488    0.246835    0.663243    0.672830    0.521411    0.539043    0.561717    0.566327    2200        22.166247   1.483198    0.334177    196.142474 
[37m[36mINFO[0m[0m 02/18 07:03:03 | 0.343264    0.337553    0.659158    0.650788    0.877138    0.343264    0.337553    0.752086    0.751926    0.598237    0.585642    0.627151    0.614796    2400        24.181360   1.435491    0.326831    196.711600 
[37m[36mINFO[0m[0m 02/18 07:07:09 | 0.312418    0.325949    0.618206    0.615340    0.926496    0.312418    0.325949    0.712287    0.720082    0.527078    0.526448    0.615254    0.599490    2600        26.196474   1.382655    0.295175    187.020933 
[37m[36mINFO[0m[0m 02/18 07:11:23 | 0.353546    0.350211    0.665436    0.676099    0.852764    0.353546    0.350211    0.715111    0.744222    0.630038    0.628463    0.651158    0.655612    2800        28.211587   1.337063    0.321629    189.967151 
[37m[36mINFO[0m[0m 02/18 07:15:47 | 0.431057    0.428270    0.684224    0.689507    0.796232    0.431057    0.428270    0.774297    0.789420    0.617443    0.618388    0.660931    0.660714    3000        30.226700   1.302809    0.391224    186.063403 
[37m[36mINFO[0m[0m 02/18 07:20:13 | 0.394674    0.378692    0.703406    0.707759    0.786966    0.394674    0.378692    0.755424    0.759630    0.683879    0.690176    0.670916    0.673469    3200        32.241814   1.286512    0.359728    193.361813 
[37m[36mINFO[0m[0m 02/18 07:24:34 | 0.561561    0.561181    0.687795    0.698761    0.779941    0.561561    0.561181    0.752728    0.782229    0.653338    0.644836    0.657319    0.669218    3400        34.256927   1.271762    0.334554    194.914060 
[37m[36mINFO[0m[0m 02/18 07:28:41 | 0.469286    0.478903    0.696601    0.692607    0.785795    0.469286    0.478903    0.764283    0.775552    0.671599    0.668766    0.653920    0.633503    3600        36.272040   1.235157    0.342930    178.090750 
[37m[36mINFO[0m[0m 02/18 07:32:40 | 0.480622    0.484177    0.734264    0.734334    0.723011    0.480622    0.484177    0.787007    0.808937    0.726385    0.705290    0.689399    0.688776    3800        38.287154   1.225592    0.284054    182.012661 
[37m[36mINFO[0m[0m 02/18 07:36:49 | 0.513841    0.509494    0.758623    0.765054    0.689116    0.513841    0.509494    0.785210    0.800205    0.762594    0.761965    0.728065    0.732993    4000        40.302267   1.189282    0.346307    179.599584 
[37m[36mINFO[0m[0m 02/18 07:40:55 | 0.575270    0.575949    0.726923    0.729578    0.752597    0.575270    0.575949    0.774425    0.797124    0.707809    0.697733    0.698534    0.693878    4200        42.317380   1.145449    0.305573    184.784755 
[37m[36mINFO[0m[0m 02/18 07:45:02 | 0.505668    0.515823    0.761176    0.767021    0.693404    0.505668    0.515823    0.783413    0.808937    0.762280    0.750630    0.737837    0.741497    4400        44.332494   1.103994    0.333849    180.109571 
[37m[36mINFO[0m[0m 02/18 07:49:12 | 0.486422    0.485232    0.753204    0.749157    0.671090    0.486422    0.485232    0.777764    0.778120    0.770781    0.769521    0.711069    0.699830    4600        46.347607   1.124101    0.322842    185.997717 
[37m[36mINFO[0m[0m 02/18 07:53:16 | 0.552333    0.560127    0.767386    0.765590    0.699948    0.552333    0.560127    0.787264    0.803801    0.778967    0.784635    0.735925    0.708333    4800        48.362720   1.085077    0.317125    180.449180 
[37m[36mINFO[0m[0m 02/18 07:57:25 | 0.449776    0.466245    0.768525    0.771795    0.741497    0.449776    0.466245    0.802157    0.817155    0.770466    0.772040    0.732951    0.726190    5000        50.377834   1.038503    0.322170    184.144843 
[37m[36mINFO[0m[0m 02/18 07:57:25 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[0]/250218_06-06-43_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/18 07:57:26 | ---
[37m[36mINFO[0m[0m 02/18 07:57:26 | test-domain validation(oracle) = 57.527%
[37m[36mINFO[0m[0m 02/18 07:57:26 | training-domain validation(iid) = 44.978%
[37m[36mINFO[0m[0m 02/18 07:57:26 | last = 44.978%
[37m[36mINFO[0m[0m 02/18 07:57:26 | last (inD) = 77.180%
[37m[36mINFO[0m[0m 02/18 07:57:26 | training-domain validation (iid, inD) = 77.180%
[37m[36mINFO[0m[0m 02/18 07:57:26 | === Summary ===
[37m[36mINFO[0m[0m 02/18 07:57:26 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 0
[37m[36mINFO[0m[0m 02/18 07:57:26 | Unique name: 250218_06-06-43_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 07:57:26 | Out path: train_output/TerraIncognita/RSC/[0]/250218_06-06-43_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 07:57:26 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/18 07:57:26 | Dataset: TerraIncognita

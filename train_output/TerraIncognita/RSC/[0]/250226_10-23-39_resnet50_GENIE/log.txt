[37m[36mINFO[0m[0m 02/26 10:23:39 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 20
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 20
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[0]/250226_10-23-39_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250226_10-23-39_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.5
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 2.6157673767852512e-05
	batch_size: 32
	weight_decay: 1.110622050999988e-05
	rsc_f_drop_factor: 0.011558843074644498
	rsc_b_drop_factor: 0.009443205254898168
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/26 10:23:39 | n_steps = 5001
[37m[36mINFO[0m[0m 02/26 10:23:39 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/26 10:23:39 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/26 10:23:39 | 
[37m[36mINFO[0m[0m 02/26 10:23:39 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 02/26 10:23:39 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 02/26 10:23:39 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 02/26 10:23:39 | Batch sizes for each domain: [0, 32, 32, 32] (total=96)
[37m[36mINFO[0m[0m 02/26 10:23:39 | steps-per-epoch for each domain: 243.41, 99.25, 147.09 -> min = 99.25
[37m[36mINFO[0m[0m 02/26 10:23:41 | # of params = 23528522
[37m[36mINFO[0m[0m 02/26 10:26:42 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/26 10:26:42 | 0.200633    0.208861    0.288045    0.304317    2.062546    0.200633    0.208861    0.455514    0.481253    0.186398    0.221662    0.222222    0.210034    0           0.000000    2.439734    1.312390    179.785399 
[37m[36mINFO[0m[0m 02/26 10:30:48 | 0.215397    0.221519    0.541379    0.561040    1.235228    0.215397    0.221519    0.599178    0.624551    0.509131    0.541562    0.515827    0.517007    200         2.015113    1.491354    0.365947    172.855333 
[37m[36mINFO[0m[0m 02/26 10:34:55 | 0.326918    0.344937    0.703564    0.719230    0.775654    0.326918    0.344937    0.756195    0.776066    0.690806    0.714106    0.663692    0.667517    400         4.030227    1.029631    0.370121    173.042622 
[37m[36mINFO[0m[0m 02/26 10:39:06 | 0.395993    0.411392    0.741084    0.758230    0.665979    0.395993    0.411392    0.780588    0.796610    0.726071    0.751889    0.716592    0.726190    600         6.045340    0.794244    0.388488    173.796797 
[37m[36mINFO[0m[0m 02/26 10:43:15 | 0.534669    0.536920    0.765199    0.775954    0.618536    0.534669    0.536920    0.788034    0.799178    0.770151    0.784635    0.737412    0.744048    800         8.060453    0.699090    0.351235    178.965149 
[37m[36mINFO[0m[0m 02/26 10:47:17 | 0.366992    0.393460    0.778196    0.784509    0.622732    0.366992    0.393460    0.818719    0.846944    0.759761    0.750630    0.756108    0.755952    1000        10.075567   0.637840    0.363590    168.920535 
[37m[36mINFO[0m[0m 02/26 10:51:25 | 0.517269    0.520042    0.797725    0.805533    0.547136    0.517269    0.520042    0.821928    0.837185    0.800693    0.807305    0.770554    0.772109    1200        12.090680   0.591036    0.395096    168.866053 
[37m[36mINFO[0m[0m 02/26 10:55:49 | 0.520432    0.524262    0.813261    0.806705    0.540156    0.520432    0.524262    0.831429    0.839753    0.815491    0.799748    0.792862    0.780612    1400        14.105793   0.553375    0.372919    189.539629 
[37m[36mINFO[0m[0m 02/26 10:59:54 | 0.413393    0.422996    0.816480    0.817751    0.513907    0.413393    0.422996    0.845166    0.863893    0.827771    0.827456    0.776503    0.761905    1600        16.120907   0.529743    0.344975    175.588021 
[37m[36mINFO[0m[0m 02/26 11:04:09 | 0.525969    0.529536    0.837267    0.834286    0.468855    0.525969    0.529536    0.849788    0.870570    0.849181    0.828715    0.812832    0.803571    1800        18.136020   0.498793    0.410087    172.840028 
[37m[36mINFO[0m[0m 02/26 11:08:19 | 0.464804    0.472574    0.834043    0.830010    0.483811    0.464804    0.472574    0.857876    0.871597    0.824622    0.814861    0.819630    0.803571    2000        20.151134   0.476848    0.364734    177.949637 
[37m[36mINFO[0m[0m 02/26 11:12:52 | 0.522014    0.537975    0.838954    0.834913    0.484493    0.522014    0.537975    0.859289    0.881870    0.847292    0.833753    0.810283    0.789116    2200        22.166247   0.455174    0.365379    199.763811 
[37m[36mINFO[0m[0m 02/26 11:17:13 | 0.435276    0.459916    0.847694    0.844877    0.446290    0.435276    0.459916    0.871229    0.885465    0.843514    0.838791    0.828341    0.810374    2400        24.181360   0.431825    0.393645    181.513636 
[37m[36mINFO[0m[0m 02/26 11:21:40 | 0.466913    0.490506    0.869578    0.849008    0.396716    0.466913    0.490506    0.873411    0.886492    0.883186    0.847607    0.852135    0.812925    2600        26.196474   0.423623    0.396995    187.580164 
[37m[36mINFO[0m[0m 02/26 11:26:08 | 0.388347    0.399789    0.864774    0.852313    0.407765    0.388347    0.399789    0.867249    0.888033    0.880038    0.857683    0.847036    0.811224    2800        28.211587   0.398315    0.379218    192.680426 
[37m[36mINFO[0m[0m 02/26 11:30:22 | 0.501977    0.520042    0.873711    0.859619    0.392573    0.501977    0.520042    0.881500    0.889574    0.886650    0.860202    0.852985    0.829082    3000        30.226700   0.384799    0.368111    180.424809 
[37m[36mINFO[0m[0m 02/26 11:34:37 | 0.476668    0.490506    0.878967    0.862368    0.380957    0.476668    0.490506    0.880472    0.892655    0.894521    0.855164    0.861908    0.839286    3200        32.241814   0.361907    0.402709    174.167441 
[37m[36mINFO[0m[0m 02/26 11:38:51 | 0.507777    0.506329    0.883833    0.862876    0.411710    0.507777    0.506329    0.886378    0.890087    0.904912    0.867758    0.860208    0.830782    3400        34.256927   0.342312    0.377828    178.484764 
[37m[36mINFO[0m[0m 02/26 11:43:08 | 0.335355    0.375527    0.893404    0.873523    0.379091    0.335355    0.375527    0.894723    0.900360    0.915932    0.869018    0.869556    0.851190    3600        36.272040   0.333323    0.382535    180.935192 
[37m[36mINFO[0m[0m 02/26 11:47:28 | 0.499868    0.509494    0.896020    0.879039    0.348517    0.499868    0.509494    0.901143    0.901387    0.911839    0.885390    0.875080    0.850340    3800        38.287154   0.338710    0.381105    183.451307 
[37m[36mINFO[0m[0m 02/26 11:51:47 | 0.425521    0.445148    0.897188    0.877072    0.367376    0.425521    0.445148    0.898703    0.905496    0.912469    0.870277    0.880391    0.855442    4000        40.302267   0.320413    0.380098    182.854815 
[37m[36mINFO[0m[0m 02/26 11:56:01 | 0.454785    0.439873    0.896406    0.874689    0.374496    0.454785    0.439873    0.890615    0.903955    0.929471    0.876574    0.869131    0.843537    4200        42.317380   0.316843    0.390143    176.545201 
[37m[36mINFO[0m[0m 02/26 12:00:19 | 0.493277    0.488397    0.900137    0.882350    0.347630    0.493277    0.488397    0.907434    0.907036    0.911524    0.882872    0.881453    0.857143    4400        44.332494   0.307292    0.400580    177.557281 
[37m[36mINFO[0m[0m 02/26 12:04:38 | 0.432639    0.449367    0.890118    0.866826    0.410801    0.432639    0.449367    0.891385    0.897278    0.901763    0.869018    0.877204    0.834184    4600        46.347607   0.282598    0.380692    182.721609 
[37m[36mINFO[0m[0m 02/26 12:08:55 | 0.579752    0.578059    0.910583    0.887966    0.329831    0.579752    0.578059    0.915779    0.912173    0.933879    0.897985    0.882091    0.853741    4800        48.362720   0.288818    0.377465    181.921130 
[37m[36mINFO[0m[0m 02/26 12:13:14 | 0.414184    0.428270    0.914992    0.886615    0.326474    0.414184    0.428270    0.915779    0.906009    0.937972    0.899244    0.891226    0.854592    5000        50.377834   0.262633    0.397570    179.367390 
[37m[36mINFO[0m[0m 02/26 12:13:14 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[0]/250226_10-23-39_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/26 12:13:16 | ---
[37m[36mINFO[0m[0m 02/26 12:13:16 | test-domain validation(oracle) = 57.975%
[37m[36mINFO[0m[0m 02/26 12:13:16 | training-domain validation(iid) = 57.975%
[37m[36mINFO[0m[0m 02/26 12:13:16 | last = 41.418%
[37m[36mINFO[0m[0m 02/26 12:13:16 | last (inD) = 88.662%
[37m[36mINFO[0m[0m 02/26 12:13:16 | training-domain validation (iid, inD) = 88.797%
[37m[36mINFO[0m[0m 02/26 12:13:16 | === Summary ===
[37m[36mINFO[0m[0m 02/26 12:13:16 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 20
[37m[36mINFO[0m[0m 02/26 12:13:16 | Unique name: 250226_10-23-39_resnet50_GENIE
[37m[36mINFO[0m[0m 02/26 12:13:16 | Out path: train_output/TerraIncognita/RSC/[0]/250226_10-23-39_resnet50_GENIE
[37m[36mINFO[0m[0m 02/26 12:13:16 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/26 12:13:16 | Dataset: TerraIncognita

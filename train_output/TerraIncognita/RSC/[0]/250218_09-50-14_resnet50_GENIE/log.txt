[37m[36mINFO[0m[0m 02/18 09:50:14 | Command :: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 2
Environment:
	Python: 3.8.10
	PyTorch: 1.13.1+cu117
	Torchvision: 0.14.1+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.24.4
	PIL: 10.4.0
Args:
	algorithm: RSC
	attn_tune: False
	auto_lr: False
	checkpoint_freq: None
	configs: ['config/resnet50_GENIE.yaml']
	data_dir: data
	dataset: TerraIncognita
	debug: False
	deterministic: True
	dump_scores: False
	dump_similarities: False
	evalmode: all
	evaluate: False
	full_data: False
	holdout_fraction: 0.2
	hparams_seed: 2
	in_domain: False
	model_save: None
	mpa: False
	name: resnet50_GENIE
	out_dir: train_output/TerraIncognita/RSC/[0]/250218_09-50-14_resnet50_GENIE
	out_root: train_output/TerraIncognita/RSC/[0]
	prebuild_loader: False
	resume_path: checkpoints/
	seed: 0
	show: False
	small_bs: False
	steps: None
	tb_freq: 10
	test_envs: [0]
	trial_seed: 0
	unique_name: 250218_09-50-14_resnet50_GENIE
	warmup: False
	work_dir: .
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	linear_steps: -1
	resnet_dropout: 0.0
	class_balanced: False
	optimizer: genie
	freeze_bn: False
	pretrained: True
	lr: 1.9041073434446342e-05
	batch_size: 9
	weight_decay: 0.0006566989842279891
	rsc_f_drop_factor: 0.2998869208594543
	rsc_b_drop_factor: 0.46590533469384005
	swad: False
	test_batchsize: 128
	model: resnet50
	feat_layers: stem_block
	attn_tune: False
	auto_lr: False
Dataset:
	[TerraIncognita] #envs=4, #classes=10
	env0: L100 (#4741)
	env1: L38 (#9736)
	env2: L43 (#3970)
	env3: L46 (#5883)

[37m[36mINFO[0m[0m 02/18 09:50:14 | n_steps = 5001
[37m[36mINFO[0m[0m 02/18 09:50:14 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 02/18 09:50:14 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 02/18 09:50:14 | 
[37m[36mINFO[0m[0m 02/18 09:50:14 | Testenv name escaping te_L100 -> te_L100
[37m[36mINFO[0m[0m 02/18 09:50:14 | Test envs = [0], name = te_L100
[37m[36mINFO[0m[0m 02/18 09:50:14 | Train environments: [1, 2, 3], Test environments: [0]
[37m[36mINFO[0m[0m 02/18 09:50:14 | Batch sizes for each domain: [0, 9, 9, 9] (total=27)
[37m[36mINFO[0m[0m 02/18 09:50:14 | steps-per-epoch for each domain: 865.44, 352.89, 523.00 -> min = 352.89
[37m[36mINFO[0m[0m 02/18 09:50:15 | # of params = 23528522
[37m[36mINFO[0m[0m 02/18 09:53:17 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_in     env1_out    env2_in     env2_out    env3_in     env3_out    step        epoch       loss        step_time   eval_time  
[37m[36mINFO[0m[0m 02/18 09:53:17 | 0.194042    0.204641    0.315414    0.354635    2.193824    0.194042    0.204641    0.446399    0.534155    0.293766    0.301008    0.206076    0.228741    0           0.000000    3.829060    1.011242    180.692576 
[37m[36mINFO[0m[0m 02/18 09:57:05 | 0.200369    0.205696    0.358054    0.363770    1.799980    0.200369    0.205696    0.453332    0.481767    0.337846    0.345088    0.282983    0.264456    200         0.566751    2.155865    0.182601    191.272411 
[37m[36mINFO[0m[0m 02/18 10:00:38 | 0.204060    0.209916    0.400941    0.401226    1.733469    0.204060    0.209916    0.571832    0.591680    0.349496    0.352645    0.281496    0.259354    400         1.133501    2.016035    0.169468    179.280961 
[37m[36mINFO[0m[0m 02/18 10:04:03 | 0.201160    0.206751    0.400978    0.403371    1.665762    0.201160    0.206751    0.568622    0.575758    0.347292    0.366499    0.287019    0.267857    600         1.700252    1.953788    0.153047    174.559411 
[37m[36mINFO[0m[0m 02/18 10:07:33 | 0.200369    0.205696    0.401152    0.402472    1.643013    0.200369    0.205696    0.570677    0.591166    0.351071    0.352645    0.281708    0.263605    800         2.267003    1.924478    0.186724    172.384958 
[37m[36mINFO[0m[0m 02/18 10:11:10 | 0.211706    0.218354    0.387549    0.394939    1.526072    0.211706    0.218354    0.532931    0.568567    0.349496    0.352645    0.280221    0.263605    1000        2.833753    1.857859    0.183533    179.852669 
[37m[36mINFO[0m[0m 02/18 10:14:41 | 0.204324    0.209916    0.408013    0.413708    1.473724    0.204324    0.209916    0.574785    0.590139    0.350126    0.362720    0.299129    0.288265    1200        3.400504    1.807928    0.171095    177.356151 
[37m[36mINFO[0m[0m 02/18 10:18:18 | 0.210915    0.220464    0.400635    0.405758    1.482925    0.210915    0.220464    0.582617    0.606061    0.342254    0.347607    0.277034    0.263605    1400        3.967254    1.827049    0.164696    184.026886 
[37m[36mINFO[0m[0m 02/18 10:22:01 | 0.209069    0.217300    0.403993    0.401669    1.452186    0.209069    0.217300    0.572731    0.587057    0.352015    0.352645    0.287232    0.265306    1600        4.534005    1.811794    0.153599    191.947227 
[37m[36mINFO[0m[0m 02/18 10:25:40 | 0.200633    0.206751    0.392553    0.399160    1.482010    0.200633    0.206751    0.570035    0.596816    0.331864    0.341310    0.275760    0.259354    1800        5.100756    1.799207    0.161901    187.212147 
[37m[36mINFO[0m[0m 02/18 10:29:14 | 0.214869    0.219409    0.405740    0.408175    1.469149    0.214869    0.219409    0.579664    0.606574    0.351385    0.352645    0.286170    0.265306    2000        5.667506    1.779058    0.149853    183.161034 
[37m[36mINFO[0m[0m 02/18 10:32:58 | 0.207224    0.213080    0.399791    0.397646    1.441249    0.207224    0.213080    0.564257    0.578326    0.351071    0.347607    0.284045    0.267007    2200        6.234257    1.745147    0.173365    189.523772 
[37m[36mINFO[0m[0m 02/18 10:36:32 | 0.201951    0.207806    0.404609    0.408028    1.417429    0.201951    0.207806    0.580177    0.606574    0.349181    0.353904    0.284470    0.263605    2400        6.801008    1.711825    0.175603    179.302397 
[37m[36mINFO[0m[0m 02/18 10:40:08 | 0.214606    0.224684    0.406008    0.407325    1.433959    0.214606    0.224684    0.581846    0.606574    0.351071    0.352645    0.285107    0.262755    2600        7.367758    1.727993    0.174148    180.774612 
[37m[36mINFO[0m[0m 02/18 10:43:46 | 0.199842    0.205696    0.401261    0.406227    1.399069    0.199842    0.205696    0.565284    0.597329    0.352330    0.352645    0.286170    0.268707    2800        7.934509    1.715436    0.164992    185.249706 
[37m[36mINFO[0m[0m 02/18 10:47:24 | 0.201951    0.206751    0.402575    0.405625    1.399683    0.201951    0.206751    0.567980    0.596816    0.354849    0.353904    0.284895    0.266156    3000        8.501259    1.692073    0.161684    185.474096 
[37m[36mINFO[0m[0m 02/18 10:50:59 | 0.206697    0.210970    0.408710    0.413006    1.378047    0.206697    0.210970    0.568237    0.596816    0.347292    0.351385    0.310601    0.290816    3200        9.068010    1.704602    0.163979    182.154860 
[37m[36mINFO[0m[0m 02/18 10:54:40 | 0.204851    0.209916    0.427646    0.432608    1.390664    0.204851    0.209916    0.583900    0.607088    0.344458    0.346348    0.354578    0.344388    3400        9.634761    1.702502    0.155181    190.034189 
[37m[36mINFO[0m[0m 02/18 10:58:20 | 0.211969    0.218354    0.410735    0.411884    1.385879    0.211969    0.218354    0.583515    0.607088    0.352960    0.353904    0.295730    0.274660    3600        10.201511   1.665000    0.157771    189.066163 
[37m[36mINFO[0m[0m 02/18 11:01:59 | 0.212760    0.222574    0.427956    0.437264    1.338269    0.212760    0.222574    0.581975    0.613251    0.363035    0.367758    0.338857    0.330782    3800        10.768262   1.679043    0.192391    179.701864 
[37m[36mINFO[0m[0m 02/18 11:05:31 | 0.212233    0.222574    0.433807    0.439454    1.327813    0.212233    0.222574    0.576839    0.590652    0.331549    0.347607    0.393032    0.380102    4000        11.335013   1.628291    0.160221    179.886847 
[37m[36mINFO[0m[0m 02/18 11:09:14 | 0.203533    0.209916    0.433858    0.439624    1.328536    0.203533    0.209916    0.581589    0.606061    0.351385    0.348866    0.368600    0.363946    4200        11.901763   1.616818    0.168261    189.738932 
[37m[36mINFO[0m[0m 02/18 11:13:06 | 0.211442    0.220464    0.435173    0.444026    1.305403    0.211442    0.220464    0.581975    0.606574    0.355793    0.353904    0.367750    0.371599    4400        12.468514   1.617654    0.215329    189.211079 
[37m[36mINFO[0m[0m 02/18 11:16:48 | 0.248352    0.252110    0.469230    0.473146    1.286680    0.248352    0.252110    0.574785    0.590139    0.386335    0.382872    0.446569    0.446429    4600        13.035264   1.563564    0.179344    185.389744 
[37m[36mINFO[0m[0m 02/18 11:20:29 | 0.206169    0.210970    0.452890    0.449377    1.220488    0.206169    0.210970    0.577866    0.589625    0.381612    0.366499    0.399193    0.392007    4800        13.602015   1.560327    0.170065    186.995001 
[37m[36mINFO[0m[0m 02/18 11:24:05 | 0.206169    0.212025    0.461276    0.464870    1.323591    0.206169    0.212025    0.580562    0.606061    0.395151    0.377834    0.408116    0.410714    5000        14.168766   1.537382    0.184373    179.354618 
[37m[36mINFO[0m[0m 02/18 11:24:05 | Cumulative gradient change saved at train_output/TerraIncognita/RSC/[0]/250218_09-50-14_resnet50_GENIE/sum_cumulative_g_change.npy
[37m[36mINFO[0m[0m 02/18 11:24:06 | ---
[37m[36mINFO[0m[0m 02/18 11:24:06 | test-domain validation(oracle) = 24.835%
[37m[36mINFO[0m[0m 02/18 11:24:06 | training-domain validation(iid) = 24.835%
[37m[36mINFO[0m[0m 02/18 11:24:06 | last = 20.617%
[37m[36mINFO[0m[0m 02/18 11:24:06 | last (inD) = 46.487%
[37m[36mINFO[0m[0m 02/18 11:24:06 | training-domain validation (iid, inD) = 47.315%
[37m[36mINFO[0m[0m 02/18 11:24:06 | === Summary ===
[37m[36mINFO[0m[0m 02/18 11:24:06 | Command: /jsm0707/GENIE/train_all.py resnet50_GENIE config/resnet50_GENIE.yaml --algorithm RSC --test_envs 0 --dataset TerraIncognita --trial_seed 0 --hparams_seed 2
[37m[36mINFO[0m[0m 02/18 11:24:06 | Unique name: 250218_09-50-14_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 11:24:06 | Out path: train_output/TerraIncognita/RSC/[0]/250218_09-50-14_resnet50_GENIE
[37m[36mINFO[0m[0m 02/18 11:24:06 | Algorithm: RSC
[37m[36mINFO[0m[0m 02/18 11:24:06 | Dataset: TerraIncognita
